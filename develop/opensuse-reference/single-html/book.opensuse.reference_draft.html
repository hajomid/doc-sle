<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang=""><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Reference | openSUSE Leap 42.3</title><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" /><link rel="stylesheet" type="text/css" href="static/css/style.css" /><link rel="stylesheet" type="text/css" href="static/css/highlight.css" /><link rel="stylesheet" type="text/css" href="static/css/brand.css" /><meta name="generator" content="DAPS 2.4.0 using openSUSE XSL Stylesheets 2.0.8 (based on DocBook XSL Stylesheets 1.78.1)" /><meta name="product-name" content="openSUSE Leap" /><meta name="product-number" content="42.3" /><meta name="book-title" content="Reference" /><meta name="tracker-url" content="https://bugzilla.opensuse.org/enter_bug.cgi" /><meta name="tracker-type" content="bsc" /><meta name="tracker-bsc-assignee" content="fs@suse.com" /><meta name="tracker-bsc-component" content="Documentation" /><meta name="tracker-bsc-product" content="openSUSE Distribution" /><meta name="tracker-bsc-version" content="Leap 42.2" /><script type="text/javascript">

var protocol = window.location.protocol.toLowerCase();
if ( protocol != 'file:' ) {
  var agent = navigator.userAgent.toLowerCase();
  var wanted = ( protocol == 'https:') ? 'https' : 'http';
  var file = 'fonts.css';
  document.write('<link rel="stylesheet" type="text/css" href="' + wanted + '://static.opensuse.org/fonts/'+ file +'"></link>');
}
else {
   document.write('<link rel="stylesheet" type="text/css" href="static/css/fonts-onlylocal.css"></link>');
}

</script><noscript><link rel="stylesheet" type="text/css" href="http://static.opensuse.org/fonts/fonts.css" /></noscript><script src="static/js/jquery-1.10.2.min.js" type="text/javascript"></script><script src="static/js/script.js" type="text/javascript"></script><script src="static/js/highlight.min.js" type="text/javascript"></script><script>

$(document).ready(function() {
  $('.verbatim-wrap.highlight').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});
hljs.configure({
  useBR: false
});

</script></head><body class="draft single offline js-off"><div id="_outer-wrap"><div id="_white-bg"><div id="_header"><div id="_logo"><img src="static/images/logo.png" alt="Logo" /></div><div class="crumbs inactive"><a class="single-crumb" href="#book.opensuse.reference" accesskey="c"><span class="single-contents-icon"></span>Reference</a><div class="bubble-corner active-contents"></div></div><div class="clearme"></div></div></div><div id="_fixed-header-wrap" class="inactive"><div id="_fixed-header"><div class="crumbs inactive"><a class="single-crumb" href="#book.opensuse.reference" accesskey="c"><span class="single-contents-icon"></span>Show Contents: Reference</a></div><div class="buttons"><a class="top-button button" href="#">Top</a><div class="clearme"></div></div><div class="clearme"></div></div><div class="active-contents bubble"><div class="bubble-container"><div id="_bubble-toc"><ol><li class="inactive"><a href="#preface.reference"><span class="number"> </span><span class="name">About This Guide</span></a></li><li class="inactive"><a href="#part.reference.adv_admin"><span class="number">I </span><span class="name">Advanced Administration</span></a><ol><li class="inactive"><a href="#cha.yast.text"><span class="number">1 </span><span class="name">YaST in Text Mode</span></a></li><li class="inactive"><a href="#cha.sw_cl"><span class="number">2 </span><span class="name">Managing Software with Command Line Tools</span></a></li><li class="inactive"><a href="#cha.snapper"><span class="number">3 </span><span class="name">System Recovery and Snapshot Management with Snapper</span></a></li><li class="inactive"><a href="#cha.vnc"><span class="number">4 </span><span class="name">Remote Access with VNC</span></a></li><li class="inactive"><a href="#cha.expert_partitioner"><span class="number">5 </span><span class="name">Expert Partitioner</span></a></li><li class="inactive"><a href="#cha.tuning.multikernel"><span class="number">6 </span><span class="name">Installing Multiple Kernel Versions</span></a></li><li class="inactive"><a href="#cha.gnome.gconf"><span class="number">7 </span><span class="name">GNOME Configuration for Administrators</span></a></li></ol></li><li class="inactive"><a href="#part.reference.system"><span class="number">II </span><span class="name">System</span></a><ol><li class="inactive"><a href="#cha.64bit"><span class="number">8 </span><span class="name">32-Bit and 64-Bit Applications in a 64-Bit System Environment</span></a></li><li class="inactive"><a href="#cha.boot"><span class="number">9 </span><span class="name">Introduction to the Booting Process</span></a></li><li class="inactive"><a href="#cha.systemd"><span class="number">10 </span><span class="name">The <code class="systemitem">systemd</code> Daemon</span></a></li><li class="inactive"><a href="#cha.journalctl"><span class="number">11 </span><span class="name"><code class="command">journalctl</code>: Query the <code class="systemitem">systemd</code> Journal</span></a></li><li class="inactive"><a href="#cha.grub2"><span class="number">12 </span><span class="name">The Boot Loader GRUB 2</span></a></li><li class="inactive"><a href="#cha.network"><span class="number">13 </span><span class="name">Basic Networking</span></a></li><li class="inactive"><a href="#cha.uefi"><span class="number">14 </span><span class="name">UEFI (Unified Extensible Firmware Interface)</span></a></li><li class="inactive"><a href="#cha.suse"><span class="number">15 </span><span class="name">Special System Features</span></a></li><li class="inactive"><a href="#cha.udev"><span class="number">16 </span><span class="name">Dynamic Kernel Device Management with <code class="systemitem">udev</code></span></a></li></ol></li><li class="inactive"><a href="#part.reference.services"><span class="number">III </span><span class="name">Services</span></a><ol><li class="inactive"><a href="#cha.slp"><span class="number">17 </span><span class="name">SLP</span></a></li><li class="inactive"><a href="#cha.ntp"><span class="number">18 </span><span class="name">Time Synchronization with NTP</span></a></li><li class="inactive"><a href="#cha.dns"><span class="number">19 </span><span class="name">The Domain Name System</span></a></li><li class="inactive"><a href="#cha.dhcp"><span class="number">20 </span><span class="name">DHCP</span></a></li><li class="inactive"><a href="#cha.samba"><span class="number">21 </span><span class="name">Samba</span></a></li><li class="inactive"><a href="#cha.nfs"><span class="number">22 </span><span class="name">Sharing File Systems with NFS</span></a></li><li class="inactive"><a href="#cha.autofs"><span class="number">23 </span><span class="name">On-Demand Mounting with Autofs</span></a></li><li class="inactive"><a href="#cha.apache2"><span class="number">24 </span><span class="name">The Apache HTTP Server</span></a></li><li class="inactive"><a href="#cha.ftp"><span class="number">25 </span><span class="name">Setting Up an FTP Server with YaST</span></a></li><li class="inactive"><a href="#cha.squid"><span class="number">26 </span><span class="name">The Proxy Server Squid</span></a></li></ol></li><li class="inactive"><a href="#part.reference.mobility"><span class="number">IV </span><span class="name">Mobile Computers</span></a><ol><li class="inactive"><a href="#cha.mobile"><span class="number">27 </span><span class="name">Mobile Computing with Linux</span></a></li><li class="inactive"><a href="#cha.nm"><span class="number">28 </span><span class="name">Using NetworkManager</span></a></li><li class="inactive"><a href="#cha.power-mgmt"><span class="number">29 </span><span class="name">Power Management</span></a></li></ol></li><li class="inactive"><a href="#app.nwscheme"><span class="number">A </span><span class="name">An Example Network</span></a></li><li class="inactive"><a href="#idm140019134120304"><span class="number">B </span><span class="name">GNU Licenses</span></a></li></ol></div><div class="clearme"></div></div></div></div><div id="_toc-bubble-wrap"></div><div id="_content" class="draft "><div class="documentation"><div xml:lang="en" class="book" id="book.opensuse.reference" lang="en"><div class="titlepage"><div><h6 class="version-info"><span class="productname"><span class="productname"><span class="phrase">openSUSE Leap</span></span></span> <span class="productnumber"><span class="productnumber"><span class="phrase">42.3</span></span></span></h6><div><h1 class="title"><em class="citetitle ">Reference</em></h1></div><div class="date"><span class="imprint-label">Publication Date: </span>
   March 28, 2018

  </div></div></div><div class="toc"><dl><dt><span class="preface"><a href="#preface.reference"><span class="name">About This Guide</span></a></span></dt><dd><dl><dt><span class="sect1"><a href="#idm140019143810848"><span class="name">Available Documentation</span></a></span></dt><dt><span class="sect1"><a href="#idm140019143793648"><span class="name">Feedback</span></a></span></dt><dt><span class="sect1"><a href="#idm140019143772848"><span class="name">Documentation Conventions</span></a></span></dt><dt><span class="sect1"><a href="#idm140019143739408"><span class="name">About the Making of This Documentation</span></a></span></dt><dt><span class="sect1"><a href="#idm140019143729200"><span class="name">Source Code</span></a></span></dt><dt><span class="sect1"><a href="#idm140019143724688"><span class="name">Acknowledgments</span></a></span></dt></dl></dd><dt><span class="part"><a href="#part.reference.adv_admin"><span class="number">I </span><span class="name">Advanced Administration</span></a></span></dt><dd><dl><dt><span class="chapter"><a href="#cha.yast.text"><span class="number">1 </span><span class="name">YaST in Text Mode</span></a></span></dt><dd><dl><dt><span class="sect1"><a href="#sec.yast.cli.navigate"><span class="number">1.1 </span><span class="name">Navigation in Modules</span></a></span></dt><dt><span class="sect1"><a href="#sec.yast.cli.key_combination"><span class="number">1.2 </span><span class="name">Advanced Key Combinations</span></a></span></dt><dt><span class="sect1"><a href="#sec.yast.cli.restricted_keys"><span class="number">1.3 </span><span class="name">Restriction of Key Combinations</span></a></span></dt><dt><span class="sect1"><a href="#sec.yast.cli.options"><span class="number">1.4 </span><span class="name">YaST Command Line Options</span></a></span></dt></dl></dd><dt><span class="chapter"><a href="#cha.sw_cl"><span class="number">2 </span><span class="name">Managing Software with Command Line Tools</span></a></span></dt><dd><dl><dt><span class="sect1"><a href="#sec.zypper"><span class="number">2.1 </span><span class="name">Using Zypper</span></a></span></dt><dt><span class="sect1"><a href="#sec.rpm"><span class="number">2.2 </span><span class="name">RPM—the Package Manager</span></a></span></dt></dl></dd><dt><span class="chapter"><a href="#cha.snapper"><span class="number">3 </span><span class="name">System Recovery and Snapshot Management with Snapper</span></a></span></dt><dd><dl><dt><span class="sect1"><a href="#sec.snapper.setup"><span class="number">3.1 </span><span class="name">Default Setup</span></a></span></dt><dt><span class="sect1"><a href="#sec.snapper.undo"><span class="number">3.2 </span><span class="name">Using Snapper to Undo Changes</span></a></span></dt><dt><span class="sect1"><a href="#sec.snapper.snapshot-boot"><span class="number">3.3 </span><span class="name">System Rollback by Booting from Snapshots</span></a></span></dt><dt><span class="sect1"><a href="#sec.snapper.config"><span class="number">3.4 </span><span class="name">Creating and Modifying Snapper Configurations</span></a></span></dt><dt><span class="sect1"><a href="#sec.snapper.manage"><span class="number">3.5 </span><span class="name">Manually Creating and Managing Snapshots</span></a></span></dt><dt><span class="sect1"><a href="#sec.snapper.clean-up"><span class="number">3.6 </span><span class="name">Automatic Snapshot Clean-Up</span></a></span></dt><dt><span class="sect1"><a href="#sec.snapper.faqs"><span class="number">3.7 </span><span class="name">Frequently Asked Questions</span></a></span></dt></dl></dd><dt><span class="chapter"><a href="#cha.vnc"><span class="number">4 </span><span class="name">Remote Access with VNC</span></a></span></dt><dd><dl><dt><span class="sect1"><a href="#sec.vnc.viewer"><span class="number">4.1 </span><span class="name">The <code class="command">vncviewer</code> Client</span></a></span></dt><dt><span class="sect1"><a href="#vnc.remmina"><span class="number">4.2 </span><span class="name">Remmina: the Remote Desktop Client</span></a></span></dt><dt><span class="sect1"><a href="#sec.vnc.one-time"><span class="number">4.3 </span><span class="name">One-time VNC Sessions</span></a></span></dt><dt><span class="sect1"><a href="#sec.vnc.persistent"><span class="number">4.4 </span><span class="name">Persistent VNC Sessions</span></a></span></dt><dt><span class="sect1"><a href="#sec.vnc.encrypt"><span class="number">4.5 </span><span class="name">Encrypted VNC Communication</span></a></span></dt></dl></dd><dt><span class="chapter"><a href="#cha.expert_partitioner"><span class="number">5 </span><span class="name">Expert Partitioner</span></a></span></dt><dd><dl><dt><span class="sect1"><a href="#sec.expert_partitioner"><span class="number">5.1 </span><span class="name">Using the Expert Partitioner</span></a></span></dt><dt><span class="sect1"><a href="#sec.yast.system.lvm"><span class="number">5.2 </span><span class="name">LVM Configuration</span></a></span></dt><dt><span class="sect1"><a href="#sec.yast.system.raid"><span class="number">5.3 </span><span class="name">Soft RAID</span></a></span></dt></dl></dd><dt><span class="chapter"><a href="#cha.tuning.multikernel"><span class="number">6 </span><span class="name">Installing Multiple Kernel Versions</span></a></span></dt><dd><dl><dt><span class="sect1"><a href="#sec.tuning.multikernel.enable"><span class="number">6.1 </span><span class="name">Enabling and Configuring Multiversion Support</span></a></span></dt><dt><span class="sect1"><a href="#sec.tuning.multikernel.yast"><span class="number">6.2 </span><span class="name">Installing/Removing Multiple Kernel Versions with YaST</span></a></span></dt><dt><span class="sect1"><a href="#sec.tuning.multikernel.zypper"><span class="number">6.3 </span><span class="name">Installing/Removing Multiple Kernel Versions with Zypper</span></a></span></dt><dt><span class="sect1"><a href="#sec.tuning.multikernel.latest"><span class="number">6.4 </span><span class="name">
   Installing the Latest Kernel Version from the Repository <code class="literal">Kernel:HEAD</code>
  </span></a></span></dt></dl></dd><dt><span class="chapter"><a href="#cha.gnome.gconf"><span class="number">7 </span><span class="name">GNOME Configuration for Administrators</span></a></span></dt><dd><dl><dt><span class="sect1"><a href="#sec.gnome.gconf.autostart"><span class="number">7.1 </span><span class="name">Starting Applications Automatically</span></a></span></dt><dt><span class="sect1"><a href="#sec.gnome.gconf.automount"><span class="number">7.2 </span><span class="name">Automounting and Managing Media Devices</span></a></span></dt><dt><span class="sect1"><a href="#sec.gnome.gconf.pref_app"><span class="number">7.3 </span><span class="name">Changing Preferred Applications</span></a></span></dt><dt><span class="sect1"><a href="#sec.gnome.gconf.templates"><span class="number">7.4 </span><span class="name">Adding Document Templates</span></a></span></dt><dt><span class="sect1"><a href="#sec.gnome.gconf.info"><span class="number">7.5 </span><span class="name">For More Information</span></a></span></dt></dl></dd></dl></dd><dt><span class="part"><a href="#part.reference.system"><span class="number">II </span><span class="name">System</span></a></span></dt><dd><dl><dt><span class="chapter"><a href="#cha.64bit"><span class="number">8 </span><span class="name">32-Bit and 64-Bit Applications in a 64-Bit System Environment</span></a></span></dt><dd><dl><dt><span class="sect1"><a href="#sec.64bit.runt"><span class="number">8.1 </span><span class="name">Runtime Support</span></a></span></dt><dt><span class="sect1"><a href="#sec.64bit.devel"><span class="number">8.2 </span><span class="name">Software Development</span></a></span></dt><dt><span class="sect1"><a href="#sec.64bit.biarch"><span class="number">8.3 </span><span class="name">Software Compilation on Biarch Platforms</span></a></span></dt><dt><span class="sect1"><a href="#sec.64bit.kernel"><span class="number">8.4 </span><span class="name">Kernel Specifications</span></a></span></dt></dl></dd><dt><span class="chapter"><a href="#cha.boot"><span class="number">9 </span><span class="name">Introduction to the Booting Process</span></a></span></dt><dd><dl><dt><span class="sect1"><a href="#sec.boot.proc"><span class="number">9.1 </span><span class="name">The Linux Boot Process</span></a></span></dt><dt><span class="sect1"><a href="#sec.boot.initrd"><span class="number">9.2 </span><span class="name"><code class="systemitem">initramfs</code></span></a></span></dt><dt><span class="sect1"><a href="#sec.boot.linuxrc"><span class="number">9.3 </span><span class="name">Init on <code class="systemitem">initramfs</code></span></a></span></dt></dl></dd><dt><span class="chapter"><a href="#cha.systemd"><span class="number">10 </span><span class="name">The <code class="systemitem">systemd</code> Daemon</span></a></span></dt><dd><dl><dt><span class="sect1"><a href="#sec.boot.systemd.concept"><span class="number">10.1 </span><span class="name">The systemd Concept</span></a></span></dt><dt><span class="sect1"><a href="#sec.boot.systemd.basics"><span class="number">10.2 </span><span class="name">Basic Usage</span></a></span></dt><dt><span class="sect1"><a href="#sec.boot.systemd.boot"><span class="number">10.3 </span><span class="name">System Start and Target Management</span></a></span></dt><dt><span class="sect1"><a href="#sec.boot.runlevel.edit"><span class="number">10.4 </span><span class="name">Managing Services with YaST</span></a></span></dt><dt><span class="sect1"><a href="#sec.boot.systemd.custom"><span class="number">10.5 </span><span class="name">Customization of <code class="systemitem">systemd</code></span></a></span></dt><dt><span class="sect1"><a href="#sec.boot.systemd.advanced"><span class="number">10.6 </span><span class="name">Advanced Usage</span></a></span></dt><dt><span class="sect1"><a href="#sec.boot.systemd.info"><span class="number">10.7 </span><span class="name">More Information</span></a></span></dt></dl></dd><dt><span class="chapter"><a href="#cha.journalctl"><span class="number">11 </span><span class="name"><code class="command">journalctl</code>: Query the <code class="systemitem">systemd</code> Journal</span></a></span></dt><dd><dl><dt><span class="sect1"><a href="#sec.journalctl.persistent"><span class="number">11.1 </span><span class="name">Making the Journal Persistent</span></a></span></dt><dt><span class="sect1"><a href="#sec.journalctl.switches"><span class="number">11.2 </span><span class="name"><code class="command">journalctl</code> Useful Switches</span></a></span></dt><dt><span class="sect1"><a href="#sec.journalctl.filter"><span class="number">11.3 </span><span class="name">Filtering the Journal Output</span></a></span></dt><dt><span class="sect1"><a href="#sec.journalctl.investigate"><span class="number">11.4 </span><span class="name">Investigating <code class="systemitem">systemd</code> Errors</span></a></span></dt><dt><span class="sect1"><a href="#sec.journalctl.config"><span class="number">11.5 </span><span class="name">Journald Configuration</span></a></span></dt><dt><span class="sect1"><a href="#sec.journalctl.yast"><span class="number">11.6 </span><span class="name">Using YaST to Filter the <code class="systemitem">systemd</code> Journal</span></a></span></dt></dl></dd><dt><span class="chapter"><a href="#cha.grub2"><span class="number">12 </span><span class="name">The Boot Loader GRUB 2</span></a></span></dt><dd><dl><dt><span class="sect1"><a href="#sec.grub2.new.features"><span class="number">12.1 </span><span class="name">Main Differences between GRUB Legacy and GRUB 2</span></a></span></dt><dt><span class="sect1"><a href="#sec.grub2.file_structure"><span class="number">12.2 </span><span class="name">Configuration File Structure</span></a></span></dt><dt><span class="sect1"><a href="#sec.grub2.yast2.config"><span class="number">12.3 </span><span class="name">Configuring the Boot Loader with YaST</span></a></span></dt><dt><span class="sect1"><a href="#sec.grub2.zseries"><span class="number">12.4 </span><span class="name">Differences in Terminal Usage on IBM Z</span></a></span></dt><dt><span class="sect1"><a href="#sec.grub2.commands"><span class="number">12.5 </span><span class="name">Helpful GRUB 2 Commands</span></a></span></dt><dt><span class="sect1"><a href="#sec.grub2.info"><span class="number">12.6 </span><span class="name">More Information</span></a></span></dt></dl></dd><dt><span class="chapter"><a href="#cha.network"><span class="number">13 </span><span class="name">Basic Networking</span></a></span></dt><dd><dl><dt><span class="sect1"><a href="#sec.network.addresses"><span class="number">13.1 </span><span class="name">IP Addresses and Routing</span></a></span></dt><dt><span class="sect1"><a href="#sec.network.ipv6"><span class="number">13.2 </span><span class="name">IPv6—The Next Generation Internet</span></a></span></dt><dt><span class="sect1"><a href="#sec.network.nameres"><span class="number">13.3 </span><span class="name">Name Resolution</span></a></span></dt><dt><span class="sect1"><a href="#sec.network.yast"><span class="number">13.4 </span><span class="name">Configuring a Network Connection with YaST</span></a></span></dt><dt><span class="sect1"><a href="#sec.network.nm"><span class="number">13.5 </span><span class="name">NetworkManager</span></a></span></dt><dt><span class="sect1"><a href="#sec.network.manconf"><span class="number">13.6 </span><span class="name">Configuring a Network Connection Manually</span></a></span></dt><dt><span class="sect1"><a href="#sec.network.router"><span class="number">13.7 </span><span class="name">Basic Router Setup</span></a></span></dt><dt><span class="sect1"><a href="#sec.network.iface-bonding"><span class="number">13.8 </span><span class="name">Setting Up Bonding Devices</span></a></span></dt><dt><span class="sect1"><a href="#sec.network.iface-teaming"><span class="number">13.9 </span><span class="name">Setting Up Team Devices for Network Teaming</span></a></span></dt><dt><span class="sect1"><a href="#sec.network.openvswitch"><span class="number">13.10 </span><span class="name">Software-Defined Networking with <span class="productname">Open vSwitch</span></span></a></span></dt></dl></dd><dt><span class="chapter"><a href="#cha.uefi"><span class="number">14 </span><span class="name">UEFI (Unified Extensible Firmware Interface)</span></a></span></dt><dd><dl><dt><span class="sect1"><a href="#sec.uefi.secboot"><span class="number">14.1 </span><span class="name">Secure Boot</span></a></span></dt><dt><span class="sect1"><a href="#sec.uefi.moreinfo"><span class="number">14.2 </span><span class="name">For More Information</span></a></span></dt></dl></dd><dt><span class="chapter"><a href="#cha.suse"><span class="number">15 </span><span class="name">Special System Features</span></a></span></dt><dd><dl><dt><span class="sect1"><a href="#sec.suse.packages"><span class="number">15.1 </span><span class="name">Information about Special Software Packages</span></a></span></dt><dt><span class="sect1"><a href="#sec.suse.virt.konsolen"><span class="number">15.2 </span><span class="name">Virtual Consoles</span></a></span></dt><dt><span class="sect1"><a href="#sec.suse.kb"><span class="number">15.3 </span><span class="name">Keyboard Mapping</span></a></span></dt><dt><span class="sect1"><a href="#sec.suse.l10n"><span class="number">15.4 </span><span class="name">Language and Country-Specific Settings</span></a></span></dt></dl></dd><dt><span class="chapter"><a href="#cha.udev"><span class="number">16 </span><span class="name">Dynamic Kernel Device Management with <code class="systemitem">udev</code></span></a></span></dt><dd><dl><dt><span class="sect1"><a href="#sec.udev.devdir"><span class="number">16.1 </span><span class="name">The <code class="filename">/dev</code> Directory</span></a></span></dt><dt><span class="sect1"><a href="#sec.udev.kernel"><span class="number">16.2 </span><span class="name">Kernel <code class="systemitem">uevents</code> and <code class="systemitem">udev</code></span></a></span></dt><dt><span class="sect1"><a href="#sec.udev.drivers"><span class="number">16.3 </span><span class="name">Drivers, Kernel Modules and Devices</span></a></span></dt><dt><span class="sect1"><a href="#sec.udev.boot"><span class="number">16.4 </span><span class="name">Booting and Initial Device Setup</span></a></span></dt><dt><span class="sect1"><a href="#sec.udev.debug"><span class="number">16.5 </span><span class="name">Monitoring the Running <code class="systemitem">udev</code> Daemon</span></a></span></dt><dt><span class="sect1"><a href="#sec.udev.rules"><span class="number">16.6 </span><span class="name">Influencing Kernel Device Event Handling with <code class="systemitem">udev</code> Rules</span></a></span></dt><dt><span class="sect1"><a href="#sec.udev.persdev"><span class="number">16.7 </span><span class="name">Persistent Device Naming</span></a></span></dt><dt><span class="sect1"><a href="#sec.udev.files"><span class="number">16.8 </span><span class="name">Files used by <code class="systemitem">udev</code></span></a></span></dt><dt><span class="sect1"><a href="#sec.udev.moreinfo"><span class="number">16.9 </span><span class="name">For More Information</span></a></span></dt></dl></dd></dl></dd><dt><span class="part"><a href="#part.reference.services"><span class="number">III </span><span class="name">Services</span></a></span></dt><dd><dl><dt><span class="chapter"><a href="#cha.slp"><span class="number">17 </span><span class="name">SLP</span></a></span></dt><dd><dl><dt><span class="sect1"><a href="#sec.slp.sl.fend"><span class="number">17.1 </span><span class="name">The SLP Front-End <code class="command">slptool</code></span></a></span></dt><dt><span class="sect1"><a href="#sec.slp.sl.reg"><span class="number">17.2 </span><span class="name">Providing Services via SLP</span></a></span></dt><dt><span class="sect1"><a href="#sec.slp.info"><span class="number">17.3 </span><span class="name">For More Information</span></a></span></dt></dl></dd><dt><span class="chapter"><a href="#cha.ntp"><span class="number">18 </span><span class="name">Time Synchronization with NTP</span></a></span></dt><dd><dl><dt><span class="sect1"><a href="#sec.ntp.yast"><span class="number">18.1 </span><span class="name">Configuring an NTP Client with YaST</span></a></span></dt><dt><span class="sect1"><a href="#sec.netz.xntp.netconf"><span class="number">18.2 </span><span class="name">Manually Configuring NTP in the Network</span></a></span></dt><dt><span class="sect1"><a href="#ntp.chronyc"><span class="number">18.3 </span><span class="name">Configure <code class="systemitem">chronyd</code> at Runtime using <code class="command">chronyc</code></span></a></span></dt><dt><span class="sect1"><a href="#sec.netz.xntp.dynamic"><span class="number">18.4 </span><span class="name">Dynamic Time Synchronization at Runtime</span></a></span></dt><dt><span class="sect1"><a href="#sec.netz.xntp.normal"><span class="number">18.5 </span><span class="name">Setting Up a Local Reference Clock</span></a></span></dt></dl></dd><dt><span class="chapter"><a href="#cha.dns"><span class="number">19 </span><span class="name">The Domain Name System</span></a></span></dt><dd><dl><dt><span class="sect1"><a href="#sec.dns.basic"><span class="number">19.1 </span><span class="name">DNS Terminology</span></a></span></dt><dt><span class="sect1"><a href="#sec.dns.install"><span class="number">19.2 </span><span class="name">Installation</span></a></span></dt><dt><span class="sect1"><a href="#sec.dns.yast"><span class="number">19.3 </span><span class="name">Configuration with YaST</span></a></span></dt><dt><span class="sect1"><a href="#sec.dns.bind"><span class="number">19.4 </span><span class="name">Starting the BIND Name Server</span></a></span></dt><dt><span class="sect1"><a href="#sec.dns.named"><span class="number">19.5 </span><span class="name">The /etc/named.conf Configuration File</span></a></span></dt><dt><span class="sect1"><a href="#sec.dns.zonefile"><span class="number">19.6 </span><span class="name">Zone Files</span></a></span></dt><dt><span class="sect1"><a href="#sec.dns.dynupdate"><span class="number">19.7 </span><span class="name">Dynamic Update of Zone Data</span></a></span></dt><dt><span class="sect1"><a href="#sec.dns.tsig"><span class="number">19.8 </span><span class="name">Secure Transactions</span></a></span></dt><dt><span class="sect1"><a href="#sec.dns.dnssec"><span class="number">19.9 </span><span class="name">DNS Security</span></a></span></dt><dt><span class="sect1"><a href="#sec.dns.info"><span class="number">19.10 </span><span class="name">For More Information</span></a></span></dt></dl></dd><dt><span class="chapter"><a href="#cha.dhcp"><span class="number">20 </span><span class="name">DHCP</span></a></span></dt><dd><dl><dt><span class="sect1"><a href="#sec.dhcp.yast"><span class="number">20.1 </span><span class="name">Configuring a DHCP Server with YaST</span></a></span></dt><dt><span class="sect1"><a href="#sec.dhcp.soft"><span class="number">20.2 </span><span class="name">DHCP Software Packages</span></a></span></dt><dt><span class="sect1"><a href="#sec.dhcp.server"><span class="number">20.3 </span><span class="name">The DHCP Server dhcpd</span></a></span></dt><dt><span class="sect1"><a href="#sec.dhcp.addinfo"><span class="number">20.4 </span><span class="name">For More Information</span></a></span></dt></dl></dd><dt><span class="chapter"><a href="#cha.samba"><span class="number">21 </span><span class="name">Samba</span></a></span></dt><dd><dl><dt><span class="sect1"><a href="#sec.samba.term"><span class="number">21.1 </span><span class="name">Terminology</span></a></span></dt><dt><span class="sect1"><a href="#sec.samba.install"><span class="number">21.2 </span><span class="name">Installing a Samba Server</span></a></span></dt><dt><span class="sect1"><a href="#sec.samba.serv.start"><span class="number">21.3 </span><span class="name">Starting and Stopping Samba</span></a></span></dt><dt><span class="sect1"><a href="#sec.samba.serv.inst"><span class="number">21.4 </span><span class="name">Configuring a Samba Server</span></a></span></dt><dt><span class="sect1"><a href="#sec.samba.client.inst"><span class="number">21.5 </span><span class="name">Configuring Clients</span></a></span></dt><dt><span class="sect1"><a href="#sec.samba.anmeld.serv"><span class="number">21.6 </span><span class="name">Samba as Login Server</span></a></span></dt><dt><span class="sect1"><a href="#sec.samba.adnet"><span class="number">21.7 </span><span class="name">Samba Server in the Network with Active Directory</span></a></span></dt><dt><span class="sect1"><a href="#sec.samba.advanced"><span class="number">21.8 </span><span class="name">Advanced Topics</span></a></span></dt><dt><span class="sect1"><a href="#sec.samba.info"><span class="number">21.9 </span><span class="name">For More Information</span></a></span></dt></dl></dd><dt><span class="chapter"><a href="#cha.nfs"><span class="number">22 </span><span class="name">Sharing File Systems with NFS</span></a></span></dt><dd><dl><dt><span class="sect1"><a href="#sec.nfs.overview"><span class="number">22.1 </span><span class="name">Overview</span></a></span></dt><dt><span class="sect1"><a href="#sec.nfs.installation"><span class="number">22.2 </span><span class="name">Installing NFS Server</span></a></span></dt><dt><span class="sect1"><a href="#sec.nfs.configuring-nfs-server"><span class="number">22.3 </span><span class="name">Configuring NFS Server</span></a></span></dt><dt><span class="sect1"><a href="#sec.nfs.configuring-nfs-clients"><span class="number">22.4 </span><span class="name">Configuring Clients</span></a></span></dt><dt><span class="sect1"><a href="#sec.nfs.info"><span class="number">22.5 </span><span class="name">For More Information</span></a></span></dt></dl></dd><dt><span class="chapter"><a href="#cha.autofs"><span class="number">23 </span><span class="name">On-Demand Mounting with Autofs</span></a></span></dt><dd><dl><dt><span class="sect1"><a href="#sec.autofs.installation"><span class="number">23.1 </span><span class="name">Installation</span></a></span></dt><dt><span class="sect1"><a href="#sec.autofs.configuration"><span class="number">23.2 </span><span class="name">Configuration</span></a></span></dt><dt><span class="sect1"><a href="#sec.autofs.debugging"><span class="number">23.3 </span><span class="name">Operation and Debugging</span></a></span></dt><dt><span class="sect1"><a href="#sec.autofs.nfs"><span class="number">23.4 </span><span class="name">Auto-Mounting an NFS Share</span></a></span></dt><dt><span class="sect1"><a href="#sec.autofs.advanced"><span class="number">23.5 </span><span class="name">Advanced Topics</span></a></span></dt></dl></dd><dt><span class="chapter"><a href="#cha.apache2"><span class="number">24 </span><span class="name">The Apache HTTP Server</span></a></span></dt><dd><dl><dt><span class="sect1"><a href="#sec.apache2.quickstart"><span class="number">24.1 </span><span class="name">Quick Start</span></a></span></dt><dt><span class="sect1"><a href="#sec.apache2.configuration"><span class="number">24.2 </span><span class="name">Configuring Apache</span></a></span></dt><dt><span class="sect1"><a href="#sec.apache2.start_stop"><span class="number">24.3 </span><span class="name">Starting and Stopping Apache</span></a></span></dt><dt><span class="sect1"><a href="#sec.apache2.modules"><span class="number">24.4 </span><span class="name">Installing, Activating, and Configuring Modules</span></a></span></dt><dt><span class="sect1"><a href="#sec.apache2.cgi"><span class="number">24.5 </span><span class="name">Enabling CGI Scripts</span></a></span></dt><dt><span class="sect1"><a href="#sec.apache2.ssl"><span class="number">24.6 </span><span class="name">Setting Up a Secure Web Server with SSL</span></a></span></dt><dt><span class="sect1"><a href="#sec.apache2.multiple_instances"><span class="number">24.7 </span><span class="name">Running Multiple Apache Instances on the Same Server</span></a></span></dt><dt><span class="sect1"><a href="#sec.apache2.security"><span class="number">24.8 </span><span class="name">Avoiding Security Problems</span></a></span></dt><dt><span class="sect1"><a href="#sec.apache2.troubleeshooting"><span class="number">24.9 </span><span class="name">Troubleshooting</span></a></span></dt><dt><span class="sect1"><a href="#sec.apache2.more_information"><span class="number">24.10 </span><span class="name">For More Information</span></a></span></dt></dl></dd><dt><span class="chapter"><a href="#cha.ftp"><span class="number">25 </span><span class="name">Setting Up an FTP Server with YaST</span></a></span></dt><dd><dl><dt><span class="sect1"><a href="#sec.ftp.start"><span class="number">25.1 </span><span class="name">Starting the FTP Server</span></a></span></dt><dt><span class="sect1"><a href="#sec.ftp.general"><span class="number">25.2 </span><span class="name">FTP General Settings</span></a></span></dt><dt><span class="sect1"><a href="#sec.ftp.performance"><span class="number">25.3 </span><span class="name">FTP Performance Settings</span></a></span></dt><dt><span class="sect1"><a href="#sec.ftp.auth"><span class="number">25.4 </span><span class="name">Authentication</span></a></span></dt><dt><span class="sect1"><a href="#sec.ftp.expert"><span class="number">25.5 </span><span class="name">Expert Settings</span></a></span></dt><dt><span class="sect1"><a href="#sec.ftp.info"><span class="number">25.6 </span><span class="name">For More Information</span></a></span></dt></dl></dd><dt><span class="chapter"><a href="#cha.squid"><span class="number">26 </span><span class="name">The Proxy Server Squid</span></a></span></dt><dd><dl><dt><span class="sect1"><a href="#sec.squid.cacheinfos"><span class="number">26.1 </span><span class="name">Some Facts about Proxy Caches</span></a></span></dt><dt><span class="sect1"><a href="#sec.squid.sysneeds"><span class="number">26.2 </span><span class="name">System Requirements</span></a></span></dt><dt><span class="sect1"><a href="#sec.squid.start"><span class="number">26.3 </span><span class="name">Basic Usage of Squid</span></a></span></dt><dt><span class="sect1"><a href="#sec.squid.yast"><span class="number">26.4 </span><span class="name">The YaST Squid Module</span></a></span></dt><dt><span class="sect1"><a href="#sec.squid.configfile"><span class="number">26.5 </span><span class="name">The Squid Configuration File</span></a></span></dt><dt><span class="sect1"><a href="#sec.squid.proxyconfigtrans"><span class="number">26.6 </span><span class="name">Configuring a Transparent Proxy</span></a></span></dt><dt><span class="sect1"><a href="#sec.squid.cachemgr"><span class="number">26.7 </span><span class="name">Using the Squid Cache Manager CGI Interface (<code class="systemitem">cachemgr.cgi</code>)</span></a></span></dt><dt><span class="sect1"><a href="#sec.squid.calamaris"><span class="number">26.8 </span><span class="name">Cache Report Generation with Calamaris</span></a></span></dt><dt><span class="sect1"><a href="#sec.squid.moreinfo"><span class="number">26.9 </span><span class="name">For More Information</span></a></span></dt></dl></dd></dl></dd><dt><span class="part"><a href="#part.reference.mobility"><span class="number">IV </span><span class="name">Mobile Computers</span></a></span></dt><dd><dl><dt><span class="chapter"><a href="#cha.mobile"><span class="number">27 </span><span class="name">Mobile Computing with Linux</span></a></span></dt><dd><dl><dt><span class="sect1"><a href="#sec.mobile.nbook"><span class="number">27.1 </span><span class="name">Laptops</span></a></span></dt><dt><span class="sect1"><a href="#sec.mobile.hw"><span class="number">27.2 </span><span class="name">Mobile Hardware</span></a></span></dt><dt><span class="sect1"><a href="#sec.mobile.comm"><span class="number">27.3 </span><span class="name">Cellular Phones and PDAs</span></a></span></dt><dt><span class="sect1"><a href="#sec.mobile.info"><span class="number">27.4 </span><span class="name">For More Information</span></a></span></dt></dl></dd><dt><span class="chapter"><a href="#cha.nm"><span class="number">28 </span><span class="name">Using NetworkManager</span></a></span></dt><dd><dl><dt><span class="sect1"><a href="#sec.nm.usecase"><span class="number">28.1 </span><span class="name">Use Cases for NetworkManager</span></a></span></dt><dt><span class="sect1"><a href="#sec.nm.activate"><span class="number">28.2 </span><span class="name">Enabling or Disabling NetworkManager</span></a></span></dt><dt><span class="sect1"><a href="#sec.nm.configure"><span class="number">28.3 </span><span class="name">Configuring Network Connections</span></a></span></dt><dt><span class="sect1"><a href="#sec.nm.security"><span class="number">28.4 </span><span class="name">NetworkManager and Security</span></a></span></dt><dt><span class="sect1"><a href="#sec.nm.faq"><span class="number">28.5 </span><span class="name">Frequently Asked Questions</span></a></span></dt><dt><span class="sect1"><a href="#sec.nm.trouble"><span class="number">28.6 </span><span class="name">Troubleshooting</span></a></span></dt><dt><span class="sect1"><a href="#sec.nm.more"><span class="number">28.7 </span><span class="name">For More Information</span></a></span></dt></dl></dd><dt><span class="chapter"><a href="#cha.power-mgmt"><span class="number">29 </span><span class="name">Power Management</span></a></span></dt><dd><dl><dt><span class="sect1"><a href="#sec.power-mgmt.save"><span class="number">29.1 </span><span class="name">Power Saving Functions</span></a></span></dt><dt><span class="sect1"><a href="#sec.power-mgmt.acpi"><span class="number">29.2 </span><span class="name">Advanced Configuration and Power Interface (ACPI)</span></a></span></dt><dt><span class="sect1"><a href="#sec.power-mgmt.silenthd"><span class="number">29.3 </span><span class="name">Rest for the Hard Disk</span></a></span></dt><dt><span class="sect1"><a href="#sec.power-mgmt.faq"><span class="number">29.4 </span><span class="name">Troubleshooting</span></a></span></dt><dt><span class="sect1"><a href="#sec.power-mgmt.info"><span class="number">29.5 </span><span class="name">For More Information</span></a></span></dt></dl></dd></dl></dd><dt><span class="appendix"><a href="#app.nwscheme"><span class="number">A </span><span class="name">An Example Network</span></a></span></dt><dt><span class="appendix"><a href="#idm140019134120304"><span class="number">B </span><span class="name">GNU Licenses</span></a></span></dt><dd><dl><dt><span class="sect1"><a href="#idm140019134115664"><span class="number">B.1 </span><span class="name">GNU Free Documentation License</span></a></span></dt></dl></dd></dl></div><div class="list-of-figures"><div class="toc-title">List of Figures</div><dl><dt><span class="figure"><a href="#fig.yast2.ncurses"><span class="number">1.1 </span><span class="name">Main Window of YaST in Text Mode</span></a></span></dt><dt><span class="figure"><a href="#fig.yast2.ncurses_inst"><span class="number">1.2 </span><span class="name">The Software Installation Module</span></a></span></dt><dt><span class="figure"><a href="#fig.snapper.snapshot-boot.identify"><span class="number">3.1 </span><span class="name">Boot Loader: Snapshots</span></a></span></dt><dt><span class="figure"><a href="#fig.vnc.viewer.connectgui"><span class="number">4.1 </span><span class="name">vncviewer</span></a></span></dt><dt><span class="figure"><a href="#idm140019141694432"><span class="number">4.2 </span><span class="name">Remmina's Main Window</span></a></span></dt><dt><span class="figure"><a href="#idm140019141681344"><span class="number">4.3 </span><span class="name">Remote Desktop Preference</span></a></span></dt><dt><span class="figure"><a href="#idm140019141657648"><span class="number">4.4 </span><span class="name">Quick-starting</span></a></span></dt><dt><span class="figure"><a href="#idm140019141648320"><span class="number">4.5 </span><span class="name">Remmina Viewing SLES 15 Remote Session</span></a></span></dt><dt><span class="figure"><a href="#idm140019141630960"><span class="number">4.6 </span><span class="name">Reading Path to the Profile File</span></a></span></dt><dt><span class="figure"><a href="#idm140019141609184"><span class="number">4.7 </span><span class="name">Remote Administration</span></a></span></dt><dt><span class="figure"><a href="#idm140019141519680"><span class="number">4.8 </span><span class="name">VNC Session Settings</span></a></span></dt><dt><span class="figure"><a href="#idm140019141493824"><span class="number">4.9 </span><span class="name">Joining a Persistent VNC Session</span></a></span></dt><dt><span class="figure"><a href="#fig.expert_partitioner.overview"><span class="number">5.1 </span><span class="name">The YaST Partitioner</span></a></span></dt><dt><span class="figure"><a href="#fig.yast2.btrfs.subvolumes"><span class="number">5.2 </span><span class="name">Btrfs Subvolumes in YaST Partitioner</span></a></span></dt><dt><span class="figure"><a href="#fig.lvm.yast.volgrp"><span class="number">5.3 </span><span class="name">Creating a Volume Group</span></a></span></dt><dt><span class="figure"><a href="#fig.lvm.yast.mgmt"><span class="number">5.4 </span><span class="name">Logical Volume Management</span></a></span></dt><dt><span class="figure"><a href="#fig.yast2.system.raid.conf"><span class="number">5.5 </span><span class="name">RAID Partitions</span></a></span></dt><dt><span class="figure"><a href="#idm140019141048752"><span class="number">6.1 </span><span class="name">The YaST Software Manager: Multiversion View</span></a></span></dt><dt><span class="figure"><a href="#fig.yast2.runlevel"><span class="number">10.1 </span><span class="name">Services Manager</span></a></span></dt><dt><span class="figure"><a href="#fig.journalctl.yast"><span class="number">11.1 </span><span class="name">YaST systemd Journal</span></a></span></dt><dt><span class="figure"><a href="#fig.grub2.boot.editor"><span class="number">12.1 </span><span class="name">GRUB 2 Boot Editor</span></a></span></dt><dt><span class="figure"><a href="#fig.grub2.yast.boot.code.options0"><span class="number">12.2 </span><span class="name">Boot Code Options</span></a></span></dt><dt><span class="figure"><a href="#fig.grub2.yast.boot.code.options"><span class="number">12.3 </span><span class="name">Code Options</span></a></span></dt><dt><span class="figure"><a href="#fig.grub2.yast.bootloader.options"><span class="number">12.4 </span><span class="name">Boot loader Options</span></a></span></dt><dt><span class="figure"><a href="#fig.grub2.yast.kernel.parameters"><span class="number">12.5 </span><span class="name">Kernel Parameters</span></a></span></dt><dt><span class="figure"><a href="#fig.net.basic.OSI"><span class="number">13.1 </span><span class="name">Simplified Layer Model for TCP/IP</span></a></span></dt><dt><span class="figure"><a href="#fig.net.basic.TCPPaket"><span class="number">13.2 </span><span class="name">TCP/IP Ethernet Packet</span></a></span></dt><dt><span class="figure"><a href="#fig.yast2.neticard"><span class="number">13.3 </span><span class="name">Configuring Network Settings</span></a></span></dt><dt><span class="figure"><a href="#wicked.architecture"><span class="number">13.4 </span><span class="name"><code class="literal">wicked</code> architecture</span></a></span></dt><dt><span class="figure"><a href="#idm140019138181152"><span class="number">14.1 </span><span class="name">Secure Boot Support</span></a></span></dt><dt><span class="figure"><a href="#fig.uefi.secure.boot.mok2"><span class="number">14.2 </span><span class="name">UEFI: Secure Boot Process</span></a></span></dt><dt><span class="figure"><a href="#idm140019137389808"><span class="number">18.1 </span><span class="name">NTP Configuration Window</span></a></span></dt><dt><span class="figure"><a href="#idm140019137364320"><span class="number">18.2 </span><span class="name">Adding a Time Server</span></a></span></dt><dt><span class="figure"><a href="#fig.yast2.dnsinst.forwarders"><span class="number">19.1 </span><span class="name">DNS Server Installation: Forwarder Settings</span></a></span></dt><dt><span class="figure"><a href="#fig.yast2.dnsinst.zones"><span class="number">19.2 </span><span class="name">DNS Server Installation: DNS Zones</span></a></span></dt><dt><span class="figure"><a href="#fig.yast2.dnsinst.finish"><span class="number">19.3 </span><span class="name">DNS Server Installation: Finish Wizard</span></a></span></dt><dt><span class="figure"><a href="#fig.yast2.dns.logging"><span class="number">19.4 </span><span class="name">DNS Server: Logging</span></a></span></dt><dt><span class="figure"><a href="#fig.yast2.dns.ddns"><span class="number">19.5 </span><span class="name">DNS Server: Zone Editor (Basics)</span></a></span></dt><dt><span class="figure"><a href="#fig.yast2.dns.nsrec"><span class="number">19.6 </span><span class="name">DNS Server: Zone Editor (NS Records)</span></a></span></dt><dt><span class="figure"><a href="#fig.yast2.dns.mxrec"><span class="number">19.7 </span><span class="name">DNS Server: Zone Editor (MX Records)</span></a></span></dt><dt><span class="figure"><a href="#fig.yast2.dns.soa"><span class="number">19.8 </span><span class="name">DNS Server: Zone Editor (SOA)</span></a></span></dt><dt><span class="figure"><a href="#idm140019137111200"><span class="number">19.9 </span><span class="name">Adding a Record for a Master Zone</span></a></span></dt><dt><span class="figure"><a href="#idm140019137104816"><span class="number">19.10 </span><span class="name">Adding a Reverse Zone</span></a></span></dt><dt><span class="figure"><a href="#idm140019137095728"><span class="number">19.11 </span><span class="name">Adding a Reverse Record</span></a></span></dt><dt><span class="figure"><a href="#fig.yast2.dhcp.wiz1"><span class="number">20.1 </span><span class="name">DHCP Server: Card Selection</span></a></span></dt><dt><span class="figure"><a href="#fig.yast2.dhcp.wiz2"><span class="number">20.2 </span><span class="name">DHCP Server: Global Settings</span></a></span></dt><dt><span class="figure"><a href="#fig.yast2.dhcp.wiz3"><span class="number">20.3 </span><span class="name">DHCP Server: Dynamic DHCP</span></a></span></dt><dt><span class="figure"><a href="#fig.yast2.dhcp.start"><span class="number">20.4 </span><span class="name">DHCP Server: Start-Up</span></a></span></dt><dt><span class="figure"><a href="#fig.yast2.dhcp.statdhcp"><span class="number">20.5 </span><span class="name">DHCP Server: Host Management</span></a></span></dt><dt><span class="figure"><a href="#fig.yast2.dhcp.chroot"><span class="number">20.6 </span><span class="name">DHCP Server: Chroot Jail and Declarations</span></a></span></dt><dt><span class="figure"><a href="#fig.yast2.dhcp.newdec"><span class="number">20.7 </span><span class="name">DHCP Server: Selecting a Declaration Type</span></a></span></dt><dt><span class="figure"><a href="#fig.yast2.dhcp.sub"><span class="number">20.8 </span><span class="name">DHCP Server: Configuring Subnets</span></a></span></dt><dt><span class="figure"><a href="#fig.yast2.dhcp.tsig"><span class="number">20.9 </span><span class="name">DHCP Server: TSIG Configuration</span></a></span></dt><dt><span class="figure"><a href="#fig.yast2.dhcp.dyndns"><span class="number">20.10 </span><span class="name">DHCP Server: Interface Configuration for Dynamic DNS</span></a></span></dt><dt><span class="figure"><a href="#fig.yast2.dhcp.fire"><span class="number">20.11 </span><span class="name">DHCP Server: Network Interface and Firewall</span></a></span></dt><dt><span class="figure"><a href="#idm140019136452128"><span class="number">21.1 </span><span class="name">Determining Windows Domain Membership</span></a></span></dt><dt><span class="figure"><a href="#idm140019136434768"><span class="number">21.2 </span><span class="name">Windows Explorer <span class="guimenu">Advanced Attributes</span> Dialog</span></a></span></dt><dt><span class="figure"><a href="#idm140019136427904"><span class="number">21.3 </span><span class="name">Windows Explorer Directory Listing with Compressed Files</span></a></span></dt><dt><span class="figure"><a href="#fig.yast2.samba.snapshot"><span class="number">21.4 </span><span class="name">Adding a New Samba Share with Snapshotting Enabled</span></a></span></dt><dt><span class="figure"><a href="#fig.samba.win_explorer"><span class="number">21.5 </span><span class="name">The <span class="guimenu">Previous Versions</span> tab in Windows Explorer</span></a></span></dt><dt><span class="figure"><a href="#fig.inst.nfsserver1"><span class="number">22.1 </span><span class="name">NFS Server Configuration Tool</span></a></span></dt><dt><span class="figure"><a href="#fig.apache2.configuration.yast.host"><span class="number">24.1 </span><span class="name">HTTP Server Wizard: Default Host</span></a></span></dt><dt><span class="figure"><a href="#fig.apache2.configuration.yast.summary"><span class="number">24.2 </span><span class="name">HTTP Server Wizard: Summary</span></a></span></dt><dt><span class="figure"><a href="#fig.apache2.configuration.yast.server_configuration.listen"><span class="number">24.3 </span><span class="name">HTTP Server Configuration: Listen Ports and Addresses</span></a></span></dt><dt><span class="figure"><a href="#fig.apache2.configuration.yast.server_configuration.modules"><span class="number">24.4 </span><span class="name">HTTP Server Configuration: Server Modules</span></a></span></dt><dt><span class="figure"><a href="#fig.yast2.ftp-start-up"><span class="number">25.1 </span><span class="name">FTP Server Configuration — Start-Up</span></a></span></dt><dt><span class="figure"><a href="#fig.mobile.scpm"><span class="number">27.1 </span><span class="name">Integrating a Mobile Computer in an Existing Environment</span></a></span></dt><dt><span class="figure"><a href="#idm140019134427472"><span class="number">28.1 </span><span class="name">GNOME Network Connections Dialog</span></a></span></dt></dl></div><div class="list-of-tables"><div class="toc-title">List of Tables</div><dl><dt><span class="table"><a href="#tab.rpm.query"><span class="number">2.1 </span><span class="name">The Most Important RPM Query Options</span></a></span></dt><dt><span class="table"><a href="#tab.rpm.verify"><span class="number">2.2 </span><span class="name">RPM Verify Options</span></a></span></dt><dt><span class="table"><a href="#idm140019140735104"><span class="number">10.1 </span><span class="name">Service Management Commands</span></a></span></dt><dt><span class="table"><a href="#idm140019140671616"><span class="number">10.2 </span><span class="name">Commands for Enabling and Disabling Services</span></a></span></dt><dt><span class="table"><a href="#idm140019140587920"><span class="number">10.3 </span><span class="name">System V Runlevels and <code class="systemitem">systemd</code> Target Units</span></a></span></dt><dt><span class="table"><a href="#tab.net.basic.privat.net"><span class="number">13.1 </span><span class="name">Private IP Address Domains</span></a></span></dt><dt><span class="table"><a href="#tab.netz.param.hostconf"><span class="number">13.2 </span><span class="name">Parameters for /etc/host.conf</span></a></span></dt><dt><span class="table"><a href="#tab.netz.nnswitch.db"><span class="number">13.3 </span><span class="name">Databases Available via /etc/nsswitch.conf</span></a></span></dt><dt><span class="table"><a href="#tab.netz.nnswitch.conf"><span class="number">13.4 </span><span class="name">Configuration Options for NSS <span class="quote">“<span class="quote">Databases</span>”</span></span></a></span></dt><dt><span class="table"><a href="#tab.team.comparison"><span class="number">13.5 </span><span class="name">Feature Comparison between Bonding and Team</span></a></span></dt><dt><span class="table"><a href="#tab.suse.packages.ulimit"><span class="number">15.1 </span><span class="name"><code class="command">ulimit</code>: Setting Resources for the User</span></a></span></dt><dt><span class="table"><a href="#idm140019134618784"><span class="number">27.1 </span><span class="name">Use Cases for NetworkManager</span></a></span></dt><dt><span class="table"><a href="#tab.mobile.wifistd"><span class="number">27.2 </span><span class="name">Overview of Various Wi-Fi Standards</span></a></span></dt></dl></div><div class="list-of-examples"><div class="toc-title">List of Examples</div><dl><dt><span class="example"><a href="#ex.zypper.repos"><span class="number">2.1 </span><span class="name">Zypper—List of Known Repositories</span></a></span></dt><dt><span class="example"><a href="#aus.update.rpm-i"><span class="number">2.2 </span><span class="name"><code class="command">rpm -q -i wget</code></span></a></span></dt><dt><span class="example"><a href="#dat.rpm.search"><span class="number">2.3 </span><span class="name">Script to Search for Packages</span></a></span></dt><dt><span class="example"><a href="#ex.snapper.config.timeline"><span class="number">3.1 </span><span class="name">Example timeline configuration</span></a></span></dt><dt><span class="example"><a href="#idm140019140490480"><span class="number">10.1 </span><span class="name">List Active Services</span></a></span></dt><dt><span class="example"><a href="#idm140019140486496"><span class="number">10.2 </span><span class="name">List Failed Services</span></a></span></dt><dt><span class="example"><a href="#idm140019140298912"><span class="number">10.3 </span><span class="name">List all Processes Belonging to a Service</span></a></span></dt><dt><span class="example"><a href="#idm140019139655760"><span class="number">12.1 </span><span class="name">Usage of grub2-mkconfig</span></a></span></dt><dt><span class="example"><a href="#idm140019139646176"><span class="number">12.2 </span><span class="name">Usage of grub2-mkrescue</span></a></span></dt><dt><span class="example"><a href="#idm140019139642256"><span class="number">12.3 </span><span class="name">Usage of grub2-script-check</span></a></span></dt><dt><span class="example"><a href="#idm140019139638256"><span class="number">12.4 </span><span class="name">Usage of grub2-once</span></a></span></dt><dt><span class="example"><a href="#aus.net.basic.ipaddress"><span class="number">13.1 </span><span class="name">Writing IP Addresses</span></a></span></dt><dt><span class="example"><a href="#tab.net.basic.netmask"><span class="number">13.2 </span><span class="name">Linking IP Addresses to the Netmask</span></a></span></dt><dt><span class="example"><a href="#aus.netz.ipv6.add"><span class="number">13.3 </span><span class="name">Sample IPv6 Address</span></a></span></dt><dt><span class="example"><a href="#aus.netz.ipv6.addpre"><span class="number">13.4 </span><span class="name">IPv6 Address Specifying the Prefix Length</span></a></span></dt><dt><span class="example"><a href="#idm140019138923616"><span class="number">13.5 </span><span class="name">Common Network Interfaces and Some Static Routes</span></a></span></dt><dt><span class="example"><a href="#dat.netz.etc.resolv.conf"><span class="number">13.6 </span><span class="name"><code class="filename">/etc/resolv.conf</code></span></a></span></dt><dt><span class="example"><a href="#dat.netz.etc.hosts"><span class="number">13.7 </span><span class="name"><code class="filename">/etc/hosts</code></span></a></span></dt><dt><span class="example"><a href="#dat.netz.networks"><span class="number">13.8 </span><span class="name"><code class="filename">/etc/networks</code></span></a></span></dt><dt><span class="example"><a href="#dat.netz.etc.hostconf"><span class="number">13.9 </span><span class="name"><code class="filename">/etc/host.conf</code></span></a></span></dt><dt><span class="example"><a href="#dat.netz.nsswitchconf"><span class="number">13.10 </span><span class="name"><code class="filename">/etc/nsswitch.conf</code></span></a></span></dt><dt><span class="example"><a href="#ex.basicnet.manconf.ping"><span class="number">13.11 </span><span class="name">Output of the Command ping</span></a></span></dt><dt><span class="example"><a href="#ex.team.lb"><span class="number">13.12 </span><span class="name">Configuration for Loadbalancing with Network Teaming</span></a></span></dt><dt><span class="example"><a href="#ex.team.failover"><span class="number">13.13 </span><span class="name">Configuration for DHCP Network Teaming Device</span></a></span></dt><dt><span class="example"><a href="#ex.suse.packages.cron"><span class="number">15.1 </span><span class="name">Entry in /etc/crontab</span></a></span></dt><dt><span class="example"><a href="#ex.suse.packages.cron.time"><span class="number">15.2 </span><span class="name">/etc/crontab: Remove Time Stamp Files</span></a></span></dt><dt><span class="example"><a href="#ex.u.ulimit.bashrc"><span class="number">15.3 </span><span class="name"><code class="command">ulimit</code>: Settings in <code class="filename">~/.bashrc</code></span></a></span></dt><dt><span class="example"><a href="#ex.rules"><span class="number">16.1 </span><span class="name">Example <code class="systemitem">udev</code> Rules</span></a></span></dt><dt><span class="example"><a href="#ex.forward"><span class="number">19.1 </span><span class="name">Forwarding Options in named.conf</span></a></span></dt><dt><span class="example"><a href="#ex.named.mini"><span class="number">19.2 </span><span class="name">A Basic /etc/named.conf</span></a></span></dt><dt><span class="example"><a href="#ex.no.log"><span class="number">19.3 </span><span class="name">Entry to Disable Logging</span></a></span></dt><dt><span class="example"><a href="#ex.meine.domain"><span class="number">19.4 </span><span class="name">Zone Entry for example.com</span></a></span></dt><dt><span class="example"><a href="#ex.andere.domain"><span class="number">19.5 </span><span class="name">Zone Entry for example.net</span></a></span></dt><dt><span class="example"><a href="#ex.welt.zone"><span class="number">19.6 </span><span class="name">The /var/lib/named/example.com.zone File</span></a></span></dt><dt><span class="example"><a href="#dat.arpa"><span class="number">19.7 </span><span class="name">Reverse Lookup</span></a></span></dt><dt><span class="example"><a href="#dat.dhcp.conf"><span class="number">20.1 </span><span class="name">The Configuration File /etc/dhcpd.conf</span></a></span></dt><dt><span class="example"><a href="#dat.dhcp.conf.add"><span class="number">20.2 </span><span class="name">Additions to the Configuration File</span></a></span></dt><dt><span class="example"><a href="#dat.cd.rom"><span class="number">21.1 </span><span class="name">A CD-ROM Share</span></a></span></dt><dt><span class="example"><a href="#dat.homes.frei"><span class="number">21.2 </span><span class="name">[homes] Share</span></a></span></dt><dt><span class="example"><a href="#dat.samba.smb.conf.dom"><span class="number">21.3 </span><span class="name">Global Section in smb.conf</span></a></span></dt><dt><span class="example"><a href="#idm140019136380400"><span class="number">21.4 </span><span class="name">Using <code class="command">rpcclient</code> to Request a Windows Server 2012 Share Snapshot</span></a></span></dt><dt><span class="example"><a href="#ex.apache2.virtual_hosts.name_based"><span class="number">24.1 </span><span class="name">Basic Examples of Name-Based <code class="systemitem">VirtualHost</code> Entries</span></a></span></dt><dt><span class="example"><a href="#ex.apache.directives.virtualhost.name_based"><span class="number">24.2 </span><span class="name">Name-Based <code class="systemitem">VirtualHost</code> Directives</span></a></span></dt><dt><span class="example"><a href="#ex.apache.directives.virtualhost.ip_based"><span class="number">24.3 </span><span class="name">IP-Based <code class="systemitem">VirtualHost</code> Directives</span></a></span></dt><dt><span class="example"><a href="#ex.apache.directives.virtualhost.basic_configuration"><span class="number">24.4 </span><span class="name">Basic <code class="systemitem">VirtualHost</code> Configuration</span></a></span></dt><dt><span class="example"><a href="#ex.apache2.cgi.configuration"><span class="number">24.5 </span><span class="name">VirtualHost CGI Configuration</span></a></span></dt><dt><span class="example"><a href="#ex.squidclient.request"><span class="number">26.1 </span><span class="name">A Request With <code class="command">squidclient</code></span></a></span></dt><dt><span class="example"><a href="#ex.squid.school"><span class="number">26.2 </span><span class="name">Defining ACL Rules</span></a></span></dt></dl></div><div><div class="legalnotice" id="idm140019143789040"><p>
  Copyright © 2006–
2018

  SUSE LLC and contributors. All rights reserved.
 </p><p>
  Permission is granted to copy, distribute and/or modify this document
  under the terms of the GNU Free Documentation License, Version 1.2 or (at
  your option) version 1.3; with the Invariant Section being this copyright
  notice and license. A copy of the license version 1.2 is included in the
  section entitled <span class="quote">“<span class="quote">GNU Free Documentation License</span>”</span>.
 </p><p>
  For SUSE trademarks, see
  <a class="link" href="http://www.suse.com/company/legal/" target="_blank">http://www.suse.com/company/legal/</a>. All other
  third-party trademarks are the property of their respective owners. Trademark
  symbols (®, ™ etc.) denote trademarks of SUSE and its affiliates.
  Asterisks (*) denote third-party trademarks.
 </p><p>
  All information found in this book has been compiled with utmost attention
  to detail. However, this does not guarantee complete accuracy. Neither
  SUSE LLC, its affiliates, the authors nor the translators shall be held
  liable for possible errors or the consequences thereof.
 </p></div></div><div class="preface " id="preface.reference"><div class="titlepage"><div><div><h1 class="title"><span class="number"> </span><span class="name">About This Guide</span> <a title="Permalink" class="permalink" href="#preface.reference">#</a></h1><div class="doc-status"><ul><li><span class="ds-label">Filename: </span>opensuse_reference_intro.xml</li><li><span class="ds-label">ID: </span>preface.reference</li></ul></div></div></div></div><div class="line"><div class="toc"><dl><dt><span class="sect1"><a href="#idm140019143810848"><span class="name">Available Documentation</span></a></span></dt><dt><span class="sect1"><a href="#idm140019143793648"><span class="name">Feedback</span></a></span></dt><dt><span class="sect1"><a href="#idm140019143772848"><span class="name">Documentation Conventions</span></a></span></dt><dt><span class="sect1"><a href="#idm140019143739408"><span class="name">About the Making of This Documentation</span></a></span></dt><dt><span class="sect1"><a href="#idm140019143729200"><span class="name">Source Code</span></a></span></dt><dt><span class="sect1"><a href="#idm140019143724688"><span class="name">Acknowledgments</span></a></span></dt></dl></div></div><p>
  This manual gives you a general understanding of <span class="productname"><span class="phrase">openSUSE® Leap</span></span>. It is
  intended mainly for system administrators and home users with basic system
  administration knowledge. Check out the various parts of this manual for a
  selection of applications needed in everyday life and in-depth
  descriptions of advanced installation and configuration scenarios.
 </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019143800176"><span class="term ">Advanced Administration</span></dt><dd><p>
     Learn about advanced adminstrations tasks such as using YaST in text
     mode and managing software from the command line. Find out how to do
     system rollbacks with Snapper and how to use advanced storage techniques
     on <span class="productname"><span class="phrase">openSUSE Leap</span></span>.
    </p></dd><dt id="idm140019143803216"><span class="term ">System</span></dt><dd><p>
     Get an introduction to the components of your Linux system and a deeper
     understanding of their interaction.
    </p></dd><dt id="idm140019143805728"><span class="term ">Services</span></dt><dd><p>
     Learn how to configure the various network and file services that come
     with <span class="productname"><span class="phrase">openSUSE Leap</span></span>.
    </p></dd><dt id="idm140019143808416"><span class="term ">Mobile Computers</span></dt><dd><p>
     Get an introduction to mobile computing with <span class="productname"><span class="phrase">openSUSE Leap</span></span>, get to know
     the various options for wireless computing and power management.
    </p></dd></dl></div><div class="sect1 " id="idm140019143810848"><div class="titlepage"><div><div><h2 class="title" id="idm140019143810848"><span class="number">1 </span><span class="name">Available Documentation</span> <a title="Permalink" class="permalink" href="#idm140019143810848">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">Filename: </span>common_intro_available_doc_i.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><div id="idm140019145519888" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note: Online Documentation and Latest Updates</h6><p>
   Documentation for our products is available at
   <span class="phrase"><a class="link" href="http://doc.opensuse.org/" target="_blank">http://doc.opensuse.org/</a></span>, where you can also
   find the latest updates, and browse or download the documentation in various formats.
   
  </p></div><p>
  In addition, the product documentation
  is usually available in your installed system under
  <code class="filename">/usr/share/doc/manual</code>.
 </p><p>
  The following documentation is available for this product:
 </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019145526432"><span class="term "><span class="intraxref">Book “<em class="citetitle ">Start-Up</em>”</span>
   </span></dt><dd><p>
     This manual will see you through your
     initial contact with <span class="productname"><span class="phrase">openSUSE® Leap</span></span>. Check out the various parts of this manual to learn how to install, use and enjoy your system.
    </p></dd><dt id="idm140019144081184"><span class="term "><a class="xref" href="#book.opensuse.reference" title="Reference"><em class="citetitle ">Reference</em></a>
   </span></dt><dd><p>
     Covers system administration tasks like maintaining,
     monitoring and customizing an initially installed system.
    </p></dd><dt id="idm140019145136000"><span class="term "><span class="intraxref">Book “<em class="citetitle ">Virtualization Guide</em>”</span>
   </span></dt><dd><p>
     Describes virtualization technology in
    general, and introduces libvirt—the unified interface to
    virtualization—and detailed information on specific
    hypervisors.
    </p></dd><dt id="idm140019145383472"><span class="term "><span class="intraxref">Book “AutoYaST”</span>
   </span></dt><dd><p>
     AutoYaST is a system for unattended mass deployment <span class="productname"><span class="phrase">openSUSE Leap</span></span>
     systems using an AutoYaST
     profile containing installation and configuration data. The manual
     guides you through the basic steps of auto-installation: preparation,
     installation, and configuration.
    </p></dd><dt id="idm140019153632768"><span class="term "><span class="intraxref">Book “<em class="citetitle ">Security Guide</em>”</span>
   </span></dt><dd><p>
     Introduces basic concepts of system security,
     covering both local and network security aspects. Shows how to use
     the product inherent security software like <span class="phrase">AppArmor</span> or the auditing system
     that reliably collects information about any
     security-relevant events.
    </p></dd><dt id="idm140019145529440"><span class="term "><span class="intraxref">Book “<em class="citetitle ">System Analysis and Tuning Guide</em>”</span>
   </span></dt><dd><p>
     An administrator's guide for problem detection,
     resolution and optimization. Find how to inspect and optimize your system
     by means of monitoring tools and how to efficiently manage
     resources. Also contains an overview of common problems and solutions and
     of additional help and documentation resources.
    </p></dd><dt id="idm140019144081648"><span class="term "><span class="intraxref">Book “<em class="citetitle ">GNOME User Guide</em>”</span>
   </span></dt><dd><p>
     Introduces the GNOME desktop of <span class="productname"><span class="phrase">openSUSE Leap</span></span>. It
     guides you through using and configuring the desktop and helps you
     perform key tasks. It is intended mainly for end users who want to make
     efficient use of GNOME as their default desktop.
    </p></dd></dl></div></div><div class="sect1 " id="idm140019143793648"><div class="titlepage"><div><div><h2 class="title" id="idm140019143793648"><span class="number">2 </span><span class="name">Feedback</span> <a title="Permalink" class="permalink" href="#idm140019143793648">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">Filename: </span>common_intro_feedback_i.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>
  Several feedback channels are available:
 </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019145530384"><span class="term ">Bug Reports</span></dt><dd><p>
     To report bugs for <span class="productname"><span class="phrase">openSUSE Leap</span></span>, go to
     <a class="link" href="https://bugzilla.opensuse.org/" target="_blank">https://bugzilla.opensuse.org/</a>, log in, and
     click <span class="guimenu">New</span>.
    </p></dd><dt id="idm140019143775696"><span class="term ">Mail</span></dt><dd><p>
     For feedback on the documentation of this product, you can also send a
     mail to <code class="literal">doc-team@suse.com</code>. Make sure to include the
     document title, the product version and the publication date of the
     documentation. To report errors or suggest enhancements, provide a concise
     description of the problem and refer to the respective section number and
     page (or URL).
    </p></dd></dl></div></div><div class="sect1 " id="idm140019143772848"><div class="titlepage"><div><div><h2 class="title" id="idm140019143772848"><span class="number">3 </span><span class="name">Documentation Conventions</span> <a title="Permalink" class="permalink" href="#idm140019143772848">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">Filename: </span>common_intro_typografie_i.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>
  The following notices and typographical conventions are used in this
  documentation:
 </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
    <code class="filename">/etc/passwd</code>: directory names and file names
   </p></li><li class="listitem "><p>
    <em class="replaceable ">PLACEHOLDER</em>: replace
    <em class="replaceable ">PLACEHOLDER</em> with the actual value
   </p></li><li class="listitem "><p>
    <code class="envar">PATH</code>: the environment variable PATH
   </p></li><li class="listitem "><p>
    <code class="command">ls</code>, <code class="option">--help</code>: commands, options, and
    parameters
   </p></li><li class="listitem "><p>
    <code class="systemitem">user</code>: users or groups
   </p></li><li class="listitem "><p>
    <span class="package">package name</span>
    : name of a package
   </p></li><li class="listitem "><p>
    <span class="keycap">Alt</span>, <span class="keycap">Alt</span><span class="key-connector">–</span><span class="keycap">F1</span>: a key to press or a key combination; keys
    are shown in uppercase as on a keyboard
   </p></li><li class="listitem "><p>
    <span class="guimenu">File</span>, <span class="guimenu">File</span> › <span class="guimenu">Save
    As</span>: menu items, buttons
   </p></li><li class="listitem "><p>
    <span class="emphasis"><em>Dancing Penguins</em></span> (Chapter
    <span class="emphasis"><em>Penguins</em></span>, ↑Another Manual): This is a reference
    to a chapter in another manual.
   </p></li><li class="listitem "><p>
    Commands that must be run with <code class="systemitem">root</code> privileges. Often you can also
    prefix these commands with the <code class="command">sudo</code> command to run them
    as non-privileged user.
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code><code class="command">command</code>
<code class="prompt user">tux &gt; </code><code class="command">sudo</code> <code class="command">command</code></pre></div></li><li class="listitem "><p>
    Commands that can be run by non-privileged users.
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">command</code></pre></div></li><li class="listitem "><p>
    Notices
   </p><div id="idm140019143745696" class="admonition warning normal"><img class="symbol" alt="Warning" title="Warning" src="static/images/icon-warning.png" /><h6>Warning: Warning Notice</h6><p>
     Vital information you must be aware of before proceeding. Warns you about
     security issues, potential loss of data, damage to hardware, or physical
     hazards.
    </p></div><div id="idm140019143744192" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.png" /><h6>Important: Important Notice</h6><p>
     Important information you should be aware of before proceeding.
    </p></div><div id="idm140019143742880" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note: Note Notice</h6><p>
     Additional information, for example about differences in software
     versions.
    </p></div><div id="idm140019143741456" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.png" /><h6>Tip: Tip Notice</h6><p>
     Helpful information, like a guideline or a piece of practical advice.
    </p></div></li></ul></div></div><div xml:lang="en" class="sect1 " id="idm140019143739408" lang="en"><div class="titlepage"><div><div><h2 class="title" id="idm140019143739408"><span class="number">4 </span><span class="name">About the Making of This Documentation</span> <a title="Permalink" class="permalink" href="#idm140019143739408">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">Filename: </span>common_intro_making_i.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>
  This documentation is written in SUSEDoc, a subset of
  <a class="link" href="http://www.docbook.org" target="_blank">DocBook 5</a>.
  The XML source files were validated by <code class="command">jing</code> (see
  <a class="link" href="https://code.google.com/p/jing-trang/" target="_blank">https://code.google.com/p/jing-trang/</a>), processed by
  <code class="command">xsltproc</code>, and converted into XSL-FO using a customized
  version of Norman Walsh's stylesheets. The final PDF is formatted through FOP
  from
  <a class="link" href="https://xmlgraphics.apache.org/fop" target="_blank">Apache
  Software Foundation</a>. The open source tools and the environment used to
  build this documentation are provided by the DocBook Authoring and Publishing
  Suite (DAPS). The project's home page can be found at
  <a class="link" href="https://github.com/openSUSE/daps" target="_blank">https://github.com/openSUSE/daps</a>.
 </p><p>
  The XML source code of this documentation can be found at
  <a class="link" href="https://github.com/SUSE/doc-sle" target="_blank">https://github.com/SUSE/doc-sle</a>.
 </p></div><div xml:lang="en" class="sect1 " id="idm140019143729200" lang="en"><div class="titlepage"><div><div><h2 class="title" id="idm140019143729200"><span class="number">5 </span><span class="name">Source Code</span> <a title="Permalink" class="permalink" href="#idm140019143729200">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">Filename: </span>common_intro_source_code_i.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>
  The source code of <span class="productname"><span class="phrase">openSUSE Leap</span></span> is publicly available. Refer to <a class="link" href="http://en.opensuse.org/Source_code" target="_blank">http://en.opensuse.org/Source_code</a> for download links and more
  information.
 </p></div><div xml:lang="en" class="sect1 " id="idm140019143724688" lang="en"><div class="titlepage"><div><div><h2 class="title" id="idm140019143724688"><span class="number">6 </span><span class="name">Acknowledgments</span> <a title="Permalink" class="permalink" href="#idm140019143724688">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">Filename: </span>common_intro_acknowl_i.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>
  With a lot of voluntary commitment, the developers of Linux cooperate on a
  global scale to promote the development of Linux. We thank them for their
  efforts—this distribution would not exist without them. Special
  thanks, of course, goes to Linus Torvalds.
 </p></div></div><div class="part" id="part.reference.adv_admin"><div class="titlepage"><div><div><h1 class="title"><span class="number">Part I </span><span class="name">Advanced Administration </span><a title="Permalink" class="permalink" href="#part.reference.adv_admin">#</a></h1></div></div></div><div class="toc"><dl><dt><span class="chapter"><a href="#cha.yast.text"><span class="number">1 </span><span class="name">YaST in Text Mode</span></a></span></dt><dd class="toc-abstract"><p>
  This section is intended for system administrators and experts who do not run
  an X server on their systems and depend on the text-based installation tool.
  It provides basic information about starting and operating YaST in text
  mode.
 </p></dd><dt><span class="chapter"><a href="#cha.sw_cl"><span class="number">2 </span><span class="name">Managing Software with Command Line Tools</span></a></span></dt><dd class="toc-abstract"><p>
    This chapter describes Zypper and RPM, two command line tools for managing
    software. For a definition of the terminology used in this context (for
    example, <code class="literal">repository</code>, <code class="literal">patch</code>, or
    <code class="literal">update</code>) refer to
    <span class="intraxref">Book “<em class="citetitle ">Start-Up</em>”, Chapter 11 “Installing or Removing Software”, Section 11.1 “Definition of Terms”</span>.
   </p></dd><dt><span class="chapter"><a href="#cha.snapper"><span class="number">3 </span><span class="name">System Recovery and Snapshot Management with Snapper</span></a></span></dt><dd class="toc-abstract"><p>
    Being able to do file system snapshots providing the ability to do
    rollbacks on Linux is a feature that was often requested in the past.
    Snapper, with the <code class="literal">Btrfs</code> file system or thin-provisioned
    LVM volumes now fills that gap.
   </p><p>
    <code class="literal">Btrfs</code>, a new copy-on-write file system for Linux,
    supports file system snapshots (a copy of the state of a subvolume at a
    certain point of time) of subvolumes (one or more separately mountable file
    systems within each physical partition). Snapshots are also supported on
    thin-provisioned LVM volumes formatted with XFS, Ext4 or Ext3. Snapper lets
    you create and manage these snapshots. It comes with a command line and a
    YaST interface. Starting with <span class="phrase">openSUSE Leap</span> it is also possible
    to boot from <code class="literal">Btrfs</code> snapshots—see <a class="xref" href="#sec.snapper.snapshot-boot" title="3.3. System Rollback by Booting from Snapshots">Section 3.3, “System Rollback by Booting from Snapshots”</a> for more information.
   </p></dd><dt><span class="chapter"><a href="#cha.vnc"><span class="number">4 </span><span class="name">Remote Access with VNC</span></a></span></dt><dd class="toc-abstract"><p>
    Virtual Network Computing (VNC) enables you to control a remote computer
    via a graphical desktop (as opposed to a remote shell access). VNC is
    platform-independent and lets you access the remote machine from any
    operating system.
   </p><p>
    <span class="productname"><span class="phrase">openSUSE Leap</span></span> supports two different kinds of VNC sessions: One-time
    sessions that <span class="quote">“<span class="quote">live</span>”</span> as long as the VNC connection from the
    client is kept up, and persistent sessions that <span class="quote">“<span class="quote">live</span>”</span> until
    they are explicitly terminated.
   </p></dd><dt><span class="chapter"><a href="#cha.expert_partitioner"><span class="number">5 </span><span class="name">Expert Partitioner</span></a></span></dt><dd class="toc-abstract"><p>Sophisticated system configurations require specific disk setups. All common partitioning tasks can be done during the installation. To get persistent device naming with block devices, use the block devices below /dev/disk/by-id or /dev/disk/by-uuid. Logical Volume Management (LVM) is a disk partiti…</p></dd><dt><span class="chapter"><a href="#cha.tuning.multikernel"><span class="number">6 </span><span class="name">Installing Multiple Kernel Versions</span></a></span></dt><dd class="toc-abstract"><p>
    <span class="productname"><span class="phrase">openSUSE Leap</span></span> supports the parallel installation of multiple kernel
    versions. When installing a second kernel, a boot entry and an initrd are
    automatically created, so no further manual configuration is needed. When
    rebooting the machine, the newly added kernel is available as an additional
    boot parameter.
   </p><p>
    Using this functionality, you can safely test kernel updates while being
    able to always fall back to the proven former kernel. To do this, do not use
    the update tools (such as the YaST Online Update or the updater applet),
    but instead follow the process described in this chapter.
   </p></dd><dt><span class="chapter"><a href="#cha.gnome.gconf"><span class="number">7 </span><span class="name">GNOME Configuration for Administrators</span></a></span></dt><dd class="toc-abstract"><p>
  This chapter introduces GNOME configuration options which administrators
  can use to adjust system-wide settings, such as customizing menus,
  installing themes, configuring fonts, changing preferred applications, and
  locking down capabilities.
 </p></dd></dl></div><div class="chapter " id="cha.yast.text"><div class="titlepage"><div><div><h2 class="title"><span class="number">1 </span><span class="name">YaST in Text Mode</span> <a title="Permalink" class="permalink" href="#cha.yast.text">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">Filename: </span>yast2_ncurses.xml</li><li><span class="ds-label">ID: </span>cha.yast.text</li></ul></div></div></div></div><div class="line"><div class="toc"><dl><dt><span class="sect1"><a href="#sec.yast.cli.navigate"><span class="number">1.1 </span><span class="name">Navigation in Modules</span></a></span></dt><dt><span class="sect1"><a href="#sec.yast.cli.key_combination"><span class="number">1.2 </span><span class="name">Advanced Key Combinations</span></a></span></dt><dt><span class="sect1"><a href="#sec.yast.cli.restricted_keys"><span class="number">1.3 </span><span class="name">Restriction of Key Combinations</span></a></span></dt><dt><span class="sect1"><a href="#sec.yast.cli.options"><span class="number">1.4 </span><span class="name">YaST Command Line Options</span></a></span></dt></dl></div></div><p>
  This section is intended for system administrators and experts who do not run
  an X server on their systems and depend on the text-based installation tool.
  It provides basic information about starting and operating YaST in text
  mode.
 </p><p>
  YaST in text mode uses the ncurses library to provide an easy
  pseudo-graphical user interface. The ncurses library is installed by default.
  The minimum supported size of the terminal emulator in which to run YaST is
  80x25 characters.
 </p><div class="figure" id="fig.yast2.ncurses"><div class="figure-contents"><div class="mediaobject"><a xmlns="" href="images/yast2_ncurses_main.png"><img src="images/yast2_ncurses_main.png" width="" alt="Main Window of YaST in Text Mode" /></a></div></div><div class="figure-title-wrap"><h6 class="figure-title"><span class="number">Figure 1.1: </span><span class="name">Main Window of YaST in Text Mode </span><a title="Permalink" class="permalink" href="#fig.yast2.ncurses">#</a></h6></div></div><p>
  When you start YaST in text mode, the YaST control center appears (see
  <a class="xref" href="#fig.yast2.ncurses" title="Main Window of YaST in Text Mode">Figure 1.1</a>). The
  main window consists of three areas. The left frame features the categories
  to which the various modules belong. This frame is active when YaST is
  started and therefore it is marked by a bold white border. The active
  category is selected. The right frame provides an overview of the modules
  available in the active category. The bottom frame contains the buttons for
  <span class="guimenu">Help</span> and <span class="guimenu">Quit</span>.
 </p><p>
  When you start the YaST control center, the category
  <span class="guimenu">Software</span> is selected automatically. Use
  <span class="keycap">↓</span> and <span class="keycap">↑</span> to change the category.
  To select a module from the category, activate the right frame with
  <span class="keycap">→</span> and then use <span class="keycap">↓</span> and
  <span class="keycap">↑</span> to select the module. Keep the arrow keys pressed to
  scroll through the list of available modules. The selected module is
  selected. Press <span class="keycap">Enter</span> to start the active module.
 </p><p>
  Various buttons or selection fields in the module contain a highlighted
  letter (yellow by default). Use
  <span class="keycap">Alt</span><span class="key-connector">–</span><span class="keycap">highlighted_letter</span>
  to select a button directly instead of navigating there with
  <span class="keycap">→|</span>. Exit the YaST control center by pressing
  <span class="keycap">Alt</span><span class="key-connector">–</span><span class="keycap">Q</span>
  or by selecting <span class="guimenu">Quit</span> and pressing
  <span class="keycap">Enter</span>.
 </p><div id="idm140019143697856" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.png" /><h6>Tip: Refreshing YaST Dialogs</h6><p>
   If a YaST dialog gets corrupted or distorted (for example, while resizing
   the window), press
   <span class="keycap">Ctrl</span><span class="key-connector">–</span><span class="keycap">L</span>
   to refresh and restore its contents.
  </p></div><div class="sect1 " id="sec.yast.cli.navigate"><div class="titlepage"><div><div><h2 class="title" id="sec.yast.cli.navigate"><span class="number">1.1 </span><span class="name">Navigation in Modules</span> <a title="Permalink" class="permalink" href="#sec.yast.cli.navigate">#</a></h2></div></div></div><p>
   The following description of the control elements in the YaST modules
   assumes that all function keys and <span class="keycap">Alt</span> key combinations
   work and are not assigned to different global functions. Read
   <a class="xref" href="#sec.yast.cli.restricted_keys" title="1.3. Restriction of Key Combinations">Section 1.3, “Restriction of Key Combinations”</a> for information about
   possible exceptions.
  </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019143692016"><span class="term ">Navigation among Buttons and Selection Lists</span></dt><dd><p>
      Use <span class="keycap">→|</span> to navigate among the buttons and frames
      containing selection lists. To navigate in reverse order, use
      <span class="keycap">Alt</span><span class="key-connector">–</span><span class="keycap">→|</span> or <span class="keycap">Shift</span><span class="key-connector">–</span><span class="keycap">→|</span>
      combinations.
     </p></dd><dt id="idm140019143685840"><span class="term ">Navigation in Selection Lists</span></dt><dd><p>
      Use the arrow keys (<span class="keycap">↑</span> and
      <span class="keycap">↓</span>) to navigate among the individual elements in
      an active frame containing a selection list. If individual entries within
      a frame exceed its width, use
      <span class="keycap">Shift</span><span class="key-connector">–</span><span class="keycap">→</span> or <span class="keycap">Shift</span><span class="key-connector">–</span><span class="keycap">←</span> to scroll
      horizontally to the right and left. Alternatively, use
      <span class="keycap">Ctrl</span><span class="key-connector">–</span><span class="keycap">E</span> or <span class="keycap">Ctrl</span><span class="key-connector">–</span><span class="keycap">A</span>. This combination can also be used if
      using <span class="keycap">→</span> or <span class="keycap">←</span> results in
      changing the active frame or the current selection list, as in the
      control center.
     </p></dd><dt id="idm140019143677392"><span class="term ">Buttons, Radio Buttons, and Check Boxes</span></dt><dd><p>
      To select buttons with empty square brackets (check boxes) or empty
      parentheses (radio buttons), press <span class="keycap">Space</span> or
      <span class="keycap">Enter</span>. Alternatively, radio buttons and check boxes
      can be selected directly with <span class="keycap">Alt</span><span class="key-connector">–</span><span class="keycap">highlighted_letter</span>.
      In this case, you do not need to confirm with <span class="keycap">Enter</span>.
      If you navigate to an item with <span class="keycap">→|</span>, press
      <span class="keycap">Enter</span> to execute the selected action or activate the
      respective menu item.
     </p></dd><dt id="idm140019143671872"><span class="term ">Function Keys</span></dt><dd><p>
      The function keys (<span class="keycap">F1</span> ... <span class="keycap">F12</span>) enable
      quick access to the various buttons. Available function key combinations
      (<code class="literal">F<em class="replaceable ">X</em></code>) are shown in the
      bottom line of the YaST screen. Which function keys are actually mapped
      to which buttons depend on the active YaST module, because the
      different modules offer different buttons (<span class="guimenu">Details</span>,
      <span class="guimenu">Info</span>, <span class="guimenu">Add</span>,
      <span class="guimenu">Delete</span>, etc.). Use <span class="keycap">F10</span> for
      <span class="guimenu">Accept</span>, <span class="guimenu">OK</span>,
      <span class="guimenu">Next</span>, and <span class="guimenu">Finish</span>. Press
      <span class="keycap">F1</span> to access the YaST help.
     </p></dd><dt id="idm140019143664064"><span class="term ">Using Navigation Tree in ncurses Mode</span></dt><dd><p>
      Some YaST modules use a navigation tree in the left part of the window
      to select configuration dialogs. Use the arrow keys
      (<span class="keycap">↑</span> and <span class="keycap">↓</span>) to navigate in
      the tree. Use <span class="keycap">Space</span> to open or close tree items. In
      ncurses mode, <span class="keycap">Enter</span> must be pressed after a
      selection in the navigation tree to show the selected dialog. This is an
      intentional behavior to save time consuming redraws when browsing through
      the navigation tree.
     </p></dd><dt id="idm140019143659632"><span class="term ">Selecting Software in the Software Installation Module</span></dt><dd><p>
      Use the filters on the left side to limit the amount of displayed
      packages. Installed packages are marked with the letter
      <code class="literal">i</code>. To change the status of a package, press
      <span class="keycap">Space</span> or <span class="keycap">Enter</span>. Alternatively,
      use the <span class="guimenu">Actions</span> menu to select the needed status
      change (install, delete, update, taboo or lock).
     </p></dd></dl></div><div class="figure" id="fig.yast2.ncurses_inst"><div class="figure-contents"><div class="mediaobject"><a xmlns="" href="images/yast2_ncurses_inst.png"><img src="images/yast2_ncurses_inst.png" width="" alt="The Software Installation Module" /></a></div></div><div class="figure-title-wrap"><h6 class="figure-title"><span class="number">Figure 1.2: </span><span class="name">The Software Installation Module </span><a title="Permalink" class="permalink" href="#fig.yast2.ncurses_inst">#</a></h6></div></div></div><div class="sect1 " id="sec.yast.cli.key_combination"><div class="titlepage"><div><div><h2 class="title" id="sec.yast.cli.key_combination"><span class="number">1.2 </span><span class="name">Advanced Key Combinations</span> <a title="Permalink" class="permalink" href="#sec.yast.cli.key_combination">#</a></h2></div></div></div><p>
   YaST in text mode has a set of advanced key combinations.
  </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019143647840"><span class="term "><span class="keycap">Shift</span><span class="key-connector">–</span><span class="keycap">F1</span>
    </span></dt><dd><p>
      Show a list of advanced hotkeys.
     </p></dd><dt id="idm140019143644928"><span class="term "><span class="keycap">Shift</span><span class="key-connector">–</span><span class="keycap">F4</span>
    </span></dt><dd><p>
      Change color schema.
     </p></dd><dt id="idm140019143642032"><span class="term "><span class="keycap">Ctrl</span><span class="key-connector">–</span><span class="keycap">\</span>
    </span></dt><dd><p>
      Quit the application.
     </p></dd><dt id="idm140019143639136"><span class="term "><span class="keycap">Ctrl</span><span class="key-connector">–</span><span class="keycap">L</span>
    </span></dt><dd><p>
      Refresh screen.
     </p></dd><dt id="idm140019143636240"><span class="term "><span class="keycap">Ctrl</span><span class="key-connector">–</span><span class="keycap">D</span><span class="keycap">F1</span>
    </span></dt><dd><p>
      Show a list of advanced hotkeys.
     </p></dd><dt id="idm140019143633040"><span class="term "><span class="keycap">Ctrl</span><span class="key-connector">–</span><span class="keycap">D</span><span class="keycap">Shift</span><span class="key-connector">–</span><span class="keycap">D</span>
    </span></dt><dd><p>
      Dump dialog to the log file as a screenshot.
     </p></dd><dt id="idm140019143629024"><span class="term "><span class="keycap">Ctrl</span><span class="key-connector">–</span><span class="keycap">D</span><span class="keycap">Shift</span><span class="key-connector">–</span><span class="keycap">Y</span>
    </span></dt><dd><p>
      Open YDialogSpy to see the widget hierarchy.
     </p></dd></dl></div></div><div class="sect1 " id="sec.yast.cli.restricted_keys"><div class="titlepage"><div><div><h2 class="title" id="sec.yast.cli.restricted_keys"><span class="number">1.3 </span><span class="name">Restriction of Key Combinations</span> <a title="Permalink" class="permalink" href="#sec.yast.cli.restricted_keys">#</a></h2></div></div></div><p>
   If your window manager uses global <span class="keycap">Alt</span> combinations,
   the <span class="keycap">Alt</span> combinations in YaST might not work. Keys
   like <span class="keycap">Alt</span> or <span class="keycap">Shift</span> can also be
   occupied by the settings of the terminal.
  </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019143620400"><span class="term ">Replacing <span class="keycap">Alt</span> with <span class="keycap">Esc</span>
    </span></dt><dd><p>
      <span class="keycap">Alt</span> shortcuts can be executed with
      <span class="keycap">Esc</span> instead of <span class="keycap">Alt</span>. For
      example, <span class="keycap">Esc</span><span class="key-connector">–</span><span class="keycap">H</span> replaces
      <span class="keycap">Alt</span><span class="key-connector">–</span><span class="keycap">H</span>. (First press
      <span class="keycap">Esc</span>, <span class="emphasis"><em>then</em></span> press
      <span class="keycap">H</span>.)
     </p></dd><dt id="idm140019143611520"><span class="term "> Backward and Forward Navigation with <span class="keycap">Ctrl</span><span class="key-connector">–</span><span class="keycap">F</span> and <span class="keycap">Ctrl</span><span class="key-connector">–</span><span class="keycap">B</span>
    </span></dt><dd><p>
      If the <span class="keycap">Alt</span> and <span class="keycap">Shift</span>
      combinations are occupied by the window manager or the terminal, use the
      combinations <span class="keycap">Ctrl</span><span class="key-connector">–</span><span class="keycap">F</span> (forward) and <span class="keycap">Ctrl</span><span class="key-connector">–</span><span class="keycap">B</span> (backward)
      instead.
     </p></dd><dt id="idm140019143603024"><span class="term ">Restriction of Function Keys</span></dt><dd><p>
      The function keys (<span class="keycap">F1</span> ... <span class="keycap">F12</span>) are also
      used for functions. Certain function keys might be occupied by the
      terminal and may not be available for YaST. However, the
      <span class="keycap">Alt</span> key combinations and function keys should always
      be fully available on a pure text console.
     </p></dd></dl></div></div><div class="sect1 " id="sec.yast.cli.options"><div class="titlepage"><div><div><h2 class="title" id="sec.yast.cli.options"><span class="number">1.4 </span><span class="name">YaST Command Line Options</span> <a title="Permalink" class="permalink" href="#sec.yast.cli.options">#</a></h2></div></div></div><p>
   Besides the text mode interface, YaST provides a pure command line
   interface. To get a list of YaST command line options, enter:
  </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast -h</pre></div><div class="sect2 " id="sec.yast.cli.options.install"><div class="titlepage"><div><div><h3 class="title" id="sec.yast.cli.options.install"><span class="number">1.4.1 </span><span class="name">Installing Packages from the Command Line</span> <a title="Permalink" class="permalink" href="#sec.yast.cli.options.install">#</a></h3></div></div></div><p>
    If you know the package name and the package is provided by any of your
    active installation repositories, you can use the command line option
    <code class="option">-i</code> to install the package:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast <em class="replaceable ">-i package_name</em></pre></div><p>
    or
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast --install <em class="replaceable ">-i package_name</em></pre></div><p>
    <em class="replaceable ">package_name</em> can be a single short package name
    (for example <span class="package">gvim</span>) installed with dependency checking,
    or the full path to an RPM package which is installed without dependency
    checking.
   </p><p>
    If you need a command line based software management utility with
    functionality beyond what YaST provides, consider using Zypper. This
    utility uses the same software management library that is also the
    foundation for the YaST package manager. The basic usage of Zypper is
    covered in <a class="xref" href="#sec.zypper" title="2.1. Using Zypper">Section 2.1, “Using Zypper”</a>.
   </p></div><div class="sect2 " id="sec.yast.cli.options.modules"><div class="titlepage"><div><div><h3 class="title" id="sec.yast.cli.options.modules"><span class="number">1.4.2 </span><span class="name">Starting Individual Modules</span> <a title="Permalink" class="permalink" href="#sec.yast.cli.options.modules">#</a></h3></div></div></div><p>
    To save time, you can start individual YaST modules directly. To start a
    module, enter:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast <em class="replaceable ">module_name</em></pre></div><p>
    View a list of all module names available on your system with <code class="command">yast
    -l</code> or <code class="command">yast --list</code>. Start the network module,
    for example, with <code class="command">yast lan</code>.
   </p></div><div class="sect2 " id="sec.yast.cli.options.module_params"><div class="titlepage"><div><div><h3 class="title" id="sec.yast.cli.options.module_params"><span class="number">1.4.3 </span><span class="name">Command Line Parameters of YaST Modules</span> <a title="Permalink" class="permalink" href="#sec.yast.cli.options.module_params">#</a></h3></div></div></div><p>
    To use YaST functionality in scripts, YaST provides command line
    support for individual modules. Not all modules have command line support.
    To display the available options of a module, enter:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast <em class="replaceable ">module_name</em> help</pre></div><p>
    If a module does not provide command line support, it is started in a text
    mode and the following message appears:
   </p><div class="verbatim-wrap"><pre class="screen">This YaST module does not support the command line interface.</pre></div><p>
    The following sections describe all YaST modules with command line
    support, together with a brief explanation of all their commands and
    available options.
   </p><div class="sect3 " id="idm140019143578208"><div class="titlepage"><div><div><h4 class="title" id="idm140019143578208"><span class="number">1.4.3.1 </span><span class="name">Common YaST Module Commands</span> <a title="Permalink" class="permalink" href="#idm140019143578208">#</a></h4></div></div></div><p>
     All YaST modules support the following commands:
    </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019143576672"><span class="term ">help</span></dt><dd><p>
        Lists all the module's supported commands together with their
        description:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast lan help</pre></div></dd><dt id="idm140019143573616"><span class="term ">longhelp</span></dt><dd><p>
        Same as <code class="command">help</code>, but adds a detailed list of each
        command's options together with their description:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast lan longhelp</pre></div></dd><dt id="idm140019143570112"><span class="term ">xmlhelp</span></dt><dd><p>
        Sames as <code class="command">longhelp</code>, but the output is structured as
        an XML document and redirected to a file:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast lan xmlhelp xmlfile=/tmp/yast_lan.xml</pre></div></dd><dt id="idm140019143566576"><span class="term ">interactive</span></dt><dd><p>
        If you need to spend more time querying a module's settings, run the
        <span class="emphasis"><em>interactive</em></span> mode. The YaST shell opens, where
        you can enter all the module's commands without the <code class="command">sudo yast
        ...</code> prefix. To leave the interactive mode, enter
        <code class="literal">exit</code>.
       </p></dd></dl></div></div><div class="sect3 " id="idm140019143562944"><div class="titlepage"><div><div><h4 class="title" id="idm140019143562944"><span class="number">1.4.3.2 </span><span class="name">yast add-on</span> <a title="Permalink" class="permalink" href="#idm140019143562944">#</a></h4></div></div></div><p>
     Adds a new Add-On product from the specified path:
    </p><div class="verbatim-wrap"><pre class="screen"> <code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast add-on http://server.name/directory/Lang-AddOn-CD1/</pre></div><p>
     You can use the following protocols to specify the source path: http://
     ftp:// nfs:// disk:// cd:// or dvd://.
    </p></div><div class="sect3 " id="idm140019143559760"><div class="titlepage"><div><div><h4 class="title" id="idm140019143559760"><span class="number">1.4.3.3 </span><span class="name">yast audit-laf</span> <a title="Permalink" class="permalink" href="#idm140019143559760">#</a></h4></div></div></div><p>
     Displays and configures the Linux Audit Framework. Refer to the
     <span class="intraxref">Book “<em class="citetitle ">Security Guide</em>”</span> for more details. <code class="command">yast
     audit-laf</code> accepts the following commands:
    </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019143557200"><span class="term ">set</span></dt><dd><p>
        Sets an option:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast audit-laf set log_file=/tmp/audit.log</pre></div><p>
        For a complete list of options, run <code class="command">yast audit-laf set
        help</code>.
       </p></dd><dt id="idm140019143553232"><span class="term ">show</span></dt><dd><p>
        Displays settings of an option:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast audit-laf show diskspace
space_left: 75
space_left_action: SYSLOG
admin_space_left: 50
admin_space_left_action: SUSPEND
action_mail_acct: root
disk_full_action: SUSPEND
disk_error_action: SUSPEND</pre></div><p>
        For a complete list of options, run <code class="command">yast audit-laf show
        help</code>.
       </p></dd></dl></div></div><div class="sect3 " id="idm140019143548768"><div class="titlepage"><div><div><h4 class="title" id="idm140019143548768"><span class="number">1.4.3.4 </span><span class="name">yast dhcp-server</span> <a title="Permalink" class="permalink" href="#idm140019143548768">#</a></h4></div></div></div><p>
     Manages the DHCP server and configures its settings. <code class="command">yast
     dhcp-server</code> accepts the following commands:
    </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019143546784"><span class="term ">disable</span></dt><dd><p>
        Disables the DHCP server service.
       </p></dd><dt id="idm140019143544960"><span class="term ">enable</span></dt><dd><p>
        Enables the DHCP server service.
       </p></dd><dt id="idm140019143543136"><span class="term ">host</span></dt><dd><p>
        Configures settings for individual hosts.
       </p></dd><dt id="idm140019143541296"><span class="term ">interface</span></dt><dd><p>
        Specifies to which network interface to listen:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast dhcp-server interface current
Selected Interfaces: eth0
Other Interfaces: bond0, pbu, eth1</pre></div><p>
        For a complete list of options, run <code class="command">yast dhcp-server interface
        help</code>.
       </p></dd><dt id="idm140019143537248"><span class="term ">options</span></dt><dd><p>
        Manages global DHCP options. For a complete list of options, run
        <code class="command">yast dhcp-server options help</code>.
       </p></dd><dt id="idm140019143534928"><span class="term ">status</span></dt><dd><p>
        Prints the status of the DHCP service.
       </p></dd><dt id="idm140019143533104"><span class="term ">subnet</span></dt><dd><p>
        Manages the DHCP subnet options. For a complete list of options, run
        <code class="command">yast dhcp-server subnet help</code>
       </p></dd></dl></div></div><div class="sect3 " id="idm140019143530464"><div class="titlepage"><div><div><h4 class="title" id="idm140019143530464"><span class="number">1.4.3.5 </span><span class="name">yast dns-server</span> <a title="Permalink" class="permalink" href="#idm140019143530464">#</a></h4></div></div></div><p>
     Manages the DNS server configuration. <code class="command">yast dns-server</code>
     accepts the following commands:
    </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019143528480"><span class="term ">acls</span></dt><dd><p>
        Displays access control list settings:
       </p><div class="verbatim-wrap"><pre class="screen"> <code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast dns-server acls show
 ACLs:
 -----
  Name       Type        Value
  ----------------------------
  any        Predefined
  localips   Predefined
  localnets  Predefined
  none       Predefined</pre></div></dd><dt id="idm140019143525296"><span class="term ">dnsrecord</span></dt><dd><p>
        Configures zone resource records:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast dnsrecord add zone=example.org query=office.example.org type=NS value=ns3</pre></div><p>
        For a complete list of options, run <code class="command">yast dns-server dnsrecord
        help</code>.
       </p></dd><dt id="idm140019143521280"><span class="term ">forwarders</span></dt><dd><p>
        Configures DNS forwarders:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast dns-server forwarders add ip=10.0.0.100
<code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast dns-server forwarders show
[...]
Forwarder IP
------------
10.0.0.100</pre></div><p>
        For a complete list of options, run <code class="command">yast dns-server forwarders
        help</code>.
       </p></dd><dt id="idm140019143516496"><span class="term ">host</span></dt><dd><p>
        Handles 'A' and its related 'PTR' record at once:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast dns-server host show zone=example.org</pre></div><p>
        For a complete list of options, run <code class="command">yast dns-server host
        help</code>.
       </p></dd><dt id="idm140019143512496"><span class="term ">logging</span></dt><dd><p>
        Configures logging settings:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast dns-server logging set updates=no transfers=yes</pre></div><p>
        For a complete list of options, run <code class="command">yast dns-server logging
        help</code>.
       </p></dd><dt id="idm140019143508512"><span class="term ">mailserver</span></dt><dd><p>
        Configures zone mail servers:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast dns-server mailserver add zone=example.org mx=mx1 priority=100</pre></div><p>
        For a complete list of options, run <code class="command">yast dns-server mailserver
        help</code>.
       </p></dd><dt id="idm140019143504512"><span class="term ">nameserver</span></dt><dd><p>
        Configures zone name servers:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast dns-server nameserver add zone=example.com ns=ns1</pre></div><p>
        For a complete list of options, run <code class="command">yast dns-server nameserver
        help</code>.
       </p></dd><dt id="idm140019143500512"><span class="term ">soa</span></dt><dd><p>
        Configures the start of authority (SOA) record:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast dns-server soa set zone=example.org serial=2006081623 ttl=2D3H20S</pre></div><p>
        For a complete list of options, run <code class="command">yast dns-server soa
        help</code>.
       </p></dd><dt id="idm140019143496480"><span class="term ">startup</span></dt><dd><p>
        Manages the DNS server service:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast dns-server startup atboot</pre></div><p>
        For a complete list of options, run <code class="command">yast dns-server startup
        help</code>.
       </p></dd><dt id="idm140019143492512"><span class="term ">transport</span></dt><dd><p>
        Configures zone transport rules. For a complete list of options, run
        <code class="command">yast dns-server transport help</code>.
       </p></dd><dt id="idm140019143490192"><span class="term ">zones</span></dt><dd><p>
        Manages DNS zones:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast dns-server zones add name=example.org zonetype=master</pre></div><p>
        For a complete list of options, run <code class="command">yast dns-server zones
        help</code>.
       </p></dd></dl></div></div><div class="sect3 " id="idm140019143485888"><div class="titlepage"><div><div><h4 class="title" id="idm140019143485888"><span class="number">1.4.3.6 </span><span class="name">yast disk</span> <a title="Permalink" class="permalink" href="#idm140019143485888">#</a></h4></div></div></div><p>
     Prints information about all disks or partitions. The only supported
     command is <code class="command">list</code> followed by either of the following
     options:
    </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019143483856"><span class="term ">disks</span></dt><dd><p>
        Lists all configured disks in the system:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast disk list disks
Device   | Size       | FS Type | Mount Point | Label | Model
---------+------------+---------+-------------+-------+-------------
/dev/sda | 119.24 GiB |         |             |       | SSD 840
/dev/sdb |  60.84 GiB |         |             |       | WD1003FBYX-0</pre></div></dd><dt id="idm140019143480560"><span class="term ">partitions</span></dt><dd><p>
        Lists all partitions in the system:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast disk list partitions
Device         | Size       | FS Type | Mount Point | Label | Model
---------------+------------+---------+-------------+-------+------
/dev/sda1      |   1.00 GiB | Ext2    | /boot       |       |
/dev/sdb1      |   1.00 GiB | Swap    | swap        |       |
/dev/sdc1      | 698.64 GiB | XFS     | /mnt/extra  |       |
/dev/vg00/home | 580.50 GiB | Ext3    | /home       |       |
/dev/vg00/root | 100.00 GiB | Ext3    | /           |       |
[...]</pre></div></dd></dl></div></div><div class="sect3 " id="idm140019143476768"><div class="titlepage"><div><div><h4 class="title" id="idm140019143476768"><span class="number">1.4.3.7 </span><span class="name">yast firewall</span> <a title="Permalink" class="permalink" href="#idm140019143476768">#</a></h4></div></div></div><p>
     Displays information about the firewall settings. <code class="command">yast
     firewall</code> accepts the following commands:
    </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019143474784"><span class="term ">broadcast</span></dt><dd><p>
        Displays settings of broadcast packets.
       </p></dd><dt id="idm140019143472944"><span class="term ">disable</span></dt><dd><p>
        Disables firewall.
       </p></dd><dt id="idm140019143471136"><span class="term ">enable</span></dt><dd><p>
        Enables firewall.
       </p></dd><dt id="idm140019143469328"><span class="term ">interfaces</span></dt><dd><p>
        Displays the configuration related to network interfaces.
       </p></dd><dt id="idm140019143467472"><span class="term ">logging</span></dt><dd><p>
        Displays the logging settings.
       </p></dd><dt id="idm140019143465648"><span class="term ">masqredirect</span></dt><dd><p>
        Redirects requests to masqueraded IP.
       </p></dd><dt id="idm140019143463824"><span class="term ">masquerade</span></dt><dd><p>
        Displays the masquerading settings.
       </p></dd><dt id="idm140019143462000"><span class="term ">services</span></dt><dd><p>
        Displays information about allowed services, ports, and protocols.
       </p></dd><dt id="idm140019143460144"><span class="term ">startup</span></dt><dd><p>
        Displays startup settings.
       </p></dd><dt id="idm140019143458320"><span class="term ">summary</span></dt><dd><p>
        Displays firewall configuration summary.
       </p></dd><dt id="idm140019143456480"><span class="term ">zones</span></dt><dd><p>
        Lists known firewall zones.
       </p></dd></dl></div></div><div class="sect3 " id="idm140019143454336"><div class="titlepage"><div><div><h4 class="title" id="idm140019143454336"><span class="number">1.4.3.8 </span><span class="name">yast ftp-server</span> <a title="Permalink" class="permalink" href="#idm140019143454336">#</a></h4></div></div></div><p>
     Configures FTP server settings. <code class="command">yast ftp-server</code> accepts
     the following options:
    </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019143452368"><span class="term ">SSL, SSLv2, SSLv3, TLS</span></dt><dd><p>
        Controls secure connections via SSL up to SSL version 3, and TLS. SSL
        options are valid for the <code class="systemitem">vsftpd</code> only.
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast ftp-server SSLv2 enable
<code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast ftp-server TLS disable</pre></div></dd><dt id="idm140019143448080"><span class="term ">access</span></dt><dd><p>
        Configures access permissions:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast ftp-server access authen_only</pre></div><p>
        For a complete list of options, run <code class="command">yast ftp-server access
        help</code>.
       </p></dd><dt id="idm140019143444112"><span class="term ">anon_access</span></dt><dd><p>
        Configures access permissions for anonymous users:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast ftp-server anon_access can_upload</pre></div><p>
        For a complete list of options, run <code class="command">yast ftp-server
        anon_access help</code>.
       </p></dd><dt id="idm140019143440096"><span class="term ">anon_dir</span></dt><dd><p>
        Specifies the directory for anonymous users. The directory must already
        exist on the server:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast ftp-server anon_dir set_anon_dir=/srv/ftp</pre></div><p>
        For a complete list of options, run <code class="command">yast ftp-server anon_dir
        help</code>.
       </p></dd><dt id="idm140019143436048"><span class="term ">chroot</span></dt><dd><p>
        Controls <span class="emphasis"><em>change root</em></span> environment (chroot):
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast ftp-server chroot enable
<code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast ftp-server chroot disable</pre></div></dd><dt id="idm140019143431840"><span class="term ">idle-time</span></dt><dd><p>
        Sets the maximum idle time in minutes before FTP server terminates the
        current connection:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast ftp-server idle-time set_idle_time=15</pre></div></dd><dt id="idm140019143428736"><span class="term ">logging</span></dt><dd><p>
        Controls whether to save the log messages into a log file:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast ftp-server logging enable
<code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast ftp-server logging disable</pre></div></dd><dt id="idm140019143424928"><span class="term ">max_clients</span></dt><dd><p>
        Specifies the maximum number of concurrently connected clients:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast ftp-server max_clients set_max_clients=1500</pre></div></dd><dt id="idm140019143421856"><span class="term ">max_clients_ip</span></dt><dd><p>
        Specifies the maximum number of concurrently connected clients via IP:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast ftp-server max_clients_ip set_max_clients=20</pre></div></dd><dt id="idm140019143418784"><span class="term ">max_rate_anon</span></dt><dd><p>
        Specifies the maximum data transfer rate permitted for anonymous
        clients (KB/s):
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast ftp-server max_rate_anon set_max_rate=10000</pre></div></dd><dt id="idm140019143415680"><span class="term ">max_rate_authen</span></dt><dd><p>
        Specifies the maximum data transfer rate permitted for locally
        authenticated users (KB/s):
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast ftp-server max_rate_authen set_max_rate=10000</pre></div></dd><dt id="idm140019143412576"><span class="term ">port_range</span></dt><dd><p>
        Specifies the port range for passive connection replies:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast ftp-server port_range set_min_port=20000 set_max_port=30000</pre></div><p>
        For a complete list of options, run <code class="command">yast help</code>.
       </p></dd><dt id="idm140019143408560"><span class="term ">show</span></dt><dd><p>
        Displays FTP server settings.
       </p></dd><dt id="idm140019143406736"><span class="term ">startup</span></dt><dd><p>
        Controls the FTP startup method:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast ftp-server startup atboot</pre></div><p>
        For a complete list of options, run <code class="command">yast ftp-server startup
        help</code>.
       </p></dd><dt id="idm140019143402768"><span class="term ">umask</span></dt><dd><p>
        Specifies the file umask for <code class="literal">authenticated:anonymous</code>
        users:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast ftp-server umask set_umask=177:077</pre></div></dd><dt id="idm140019143399296"><span class="term ">welcome_message</span></dt><dd><p>
        Specifies the text to display when someone connects to the FTP server:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast ftp-server welcome_message set_message="hello everybody"</pre></div></dd></dl></div></div><div class="sect3 " id="idm140019143395888"><div class="titlepage"><div><div><h4 class="title" id="idm140019143395888"><span class="number">1.4.3.9 </span><span class="name">yast http-server</span> <a title="Permalink" class="permalink" href="#idm140019143395888">#</a></h4></div></div></div><p>
     Configures the HTTP server (Apache2). <code class="command">yast http-server</code>
     accepts the following commands:
    </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019143393904"><span class="term ">configure</span></dt><dd><p>
        Configures the HTTP server host settings.
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast http-server configure host=main servername=www.example.com \
 serveradmin=admin@example.com</pre></div><p>
        For a complete list of options, run <code class="command">yast http-server configure
        help</code>.
       </p></dd></dl></div><div class="variablelist "><dl class="variablelist"><dt id="idm140019143389408"><span class="term ">hosts</span></dt><dd><p>
        Configures virtual hosts:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast http-server hosts create servername=www.example.com \
 serveradmin=admin@example.com documentroot=/var/www</pre></div><p>
        For a complete list of options, run <code class="command">yast http-server hosts
        help</code>.
       </p></dd></dl></div><div class="variablelist "><dl class="variablelist"><dt id="idm140019143384912"><span class="term ">listen</span></dt><dd><p>
        Specifies the ports and network addresses where the HTTP server should
        listen:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast http-server listen add=81
<code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast http-server listen list
Listen Statements:
==================
:80
:81
<code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast http-server delete=80</pre></div><p>
        For a complete list of options, run <code class="command">yast http-server listen
        help</code>.
       </p></dd></dl></div><div class="variablelist "><dl class="variablelist"><dt id="idm140019143378896"><span class="term ">mode</span></dt><dd><p>
        Enables or disables the wizard mode:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast http-server mode wizard=on</pre></div></dd></dl></div><div class="variablelist "><dl class="variablelist"><dt id="idm140019143375424"><span class="term ">modules</span></dt><dd><p>
        Controls the Apache2 server modules:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast http-server modules enable=php5,rewrite
<code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast http-server modules disable=ssl
<code class="prompt user">tux &gt; </code><code class="command">sudo</code> http-server modules list
[...]
Enabled rewrite
Disabled ssl
Enabled php5
[...]</pre></div></dd></dl></div></div><div class="sect3 " id="idm140019143370512"><div class="titlepage"><div><div><h4 class="title" id="idm140019143370512"><span class="number">1.4.3.10 </span><span class="name">yast kdump</span> <a title="Permalink" class="permalink" href="#idm140019143370512">#</a></h4></div></div></div><p>
     Configures <code class="systemitem">kdump</code> settings. For more information
     on <code class="systemitem">kdump</code>, refer to the
     <span class="intraxref">Book “<em class="citetitle ">System Analysis and Tuning Guide</em>”, Chapter 17 “Kexec and Kdump”, Section 17.7 “Basic Kdump Configuration”</span>. <code class="command">yast kdump</code>
     accepts the following commands:
    </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019143367072"><span class="term ">copykernel</span></dt><dd><p>
        Copies the kernel into the dump directory.
       </p></dd><dt id="idm140019143365232"><span class="term ">customkernel</span></dt><dd><p>
        Specifies the <em class="replaceable ">kernel_string</em> part of the name
        of the custom kernel. The naming scheme is
        <code class="filename">/boot/vmlinu[zx]-<em class="replaceable ">kernel_string</em>[.gz]</code>
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast kdump customkernel kernel=kdump</pre></div><p>
        For a complete list of options, run <code class="command">yast kdump customkernel
        help</code>.
       </p></dd><dt id="idm140019143359888"><span class="term ">dumpformat</span></dt><dd><p>
        Specifies the (compression) format of the dump kernel image. Available
        formats are 'none', 'ELF', 'compressed', or 'lzo':
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast kdump dumpformat dump_format=ELF</pre></div></dd><dt id="idm140019143356768"><span class="term ">dumplevel</span></dt><dd><p>
        Specifies the dump level number in the range from 0 to 31:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast kdump dumplevel dump_level=24</pre></div></dd><dt id="idm140019143353712"><span class="term ">dumptarget</span></dt><dd><p>
        Specifies the destination for saving dump images:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> kdump dumptarget taget=ssh server=name_server port=22 \
 dir=/var/log/dump user=user_name</pre></div><p>
        For a complete list of options, run <code class="command">yast kdump dumptarget
        help</code>.
       </p></dd><dt id="idm140019143349664"><span class="term ">immediatereboot</span></dt><dd><p>
        Controls whether the system should reboot immediately after saving the
        core in the kdump kernel:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast kdump immediatereboot enable
<code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast kdump immediatereboot disable</pre></div></dd><dt id="idm140019143345808"><span class="term ">keepolddumps</span></dt><dd><p>
        Specifies how many old dump images are kept. Specify zero to keep them
        all:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast kdump keepolddumps no=5</pre></div></dd><dt id="idm140019143342736"><span class="term ">kernelcommandline</span></dt><dd><p>
        Specifies the command line that needs to be passed off to the kdump
        kernel:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast kdump kernelcommandline command="ro root=LABEL=/"</pre></div></dd><dt id="idm140019143339632"><span class="term ">kernelcommandlineappend</span></dt><dd><p>
        Specifies the command line that you need to <span class="emphasis"><em>append</em></span>
        to the default command line string:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast kdump kernelcommandlineappend command="ro root=LABEL=/"</pre></div></dd><dt id="idm140019143336096"><span class="term ">notificationcc</span></dt><dd><p>
        Specifies an email address for sending copies of notification messages:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast kdump notificationcc email="user1@example.com user2@example.com"</pre></div></dd><dt id="idm140019143332992"><span class="term ">notificationto</span></dt><dd><p>
        Specifies an email address for sending notification messages:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast kdump notificationto email="user1@example.com user2@example.com"</pre></div></dd><dt id="idm140019143329904"><span class="term ">show</span></dt><dd><p>
        Displays <code class="systemitem">kdump</code> settings:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast kdump show
Kdump is disabled
Dump Level: 31
Dump Format: compressed
Dump Target Settings
target: file
file directory: /var/crash
Kdump immediate reboots: Enabled
Numbers of old dumps: 5</pre></div></dd><dt id="idm140019143326304"><span class="term ">smtppass</span></dt><dd><p>
        Specifies the file with the plain text SMTP password used for sending
        notification messages:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast kdump smtppass pass=/path/to/file</pre></div></dd><dt id="idm140019143323200"><span class="term ">smtpserver</span></dt><dd><p>
        Specifies the SMTP server host name used for sending notification
        messages:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast kdump smtpserver server=smtp.server.com</pre></div></dd><dt id="idm140019143320112"><span class="term ">smtpuser</span></dt><dd><p>
        Specifies the SMTP user name used for sending notification messages:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast kdump smtpuser user=smtp_user</pre></div></dd><dt id="idm140019143317056"><span class="term ">startup</span></dt><dd><p>
        Enables or disables start-up options:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast kdump startup enable alloc_mem=128,256
<code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast kdump startup disable</pre></div></dd></dl></div></div><div class="sect3 " id="idm140019143312944"><div class="titlepage"><div><div><h4 class="title" id="idm140019143312944"><span class="number">1.4.3.11 </span><span class="name">yast keyboard</span> <a title="Permalink" class="permalink" href="#idm140019143312944">#</a></h4></div></div></div><p>
     Configures the system keyboard for virtual consoles. It does not affect
     the keyboard settings in graphical desktop environments, such as GNOME
     or KDE. <code class="command">yast keyboard</code> accepts the following commands:
    </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019143310864"><span class="term ">list</span></dt><dd><p>
        Lists all available keyboard layouts.
       </p></dd><dt id="idm140019143309040"><span class="term ">set</span></dt><dd><p>
        Activates new keyboard layout setting:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast keyboard set layout=czech</pre></div></dd><dt id="idm140019143306016"><span class="term ">summary</span></dt><dd><p>
        Displays the current keyboard configuration.
       </p></dd></dl></div></div><div class="sect3 " id="idm140019143303856"><div class="titlepage"><div><div><h4 class="title" id="idm140019143303856"><span class="number">1.4.3.12 </span><span class="name">yast lan</span> <a title="Permalink" class="permalink" href="#idm140019143303856">#</a></h4></div></div></div><p>
     Configures network cards. <code class="command">yast lan</code> accepts the
     following commands:
    </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019143301888"><span class="term ">add</span></dt><dd><p>
        Configures a new network card:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast lan add name=vlan50 ethdevice=eth0 bootproto=dhcp</pre></div><p>
        For a complete list of options, run <code class="command">yast lan add
        help</code>.
       </p></dd><dt id="idm140019143297888"><span class="term ">delete</span></dt><dd><p>
        Deletes an existing network card:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast lan delete id=0</pre></div></dd><dt id="idm140019143294880"><span class="term ">edit</span></dt><dd><p>
        Changes the configuration of an existing network card:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast lan edit id=0 bootproto=dhcp</pre></div></dd><dt id="idm140019143291840"><span class="term ">list</span></dt><dd><p>
        Displays a summary of network card configuration:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast lan list
id name,           bootproto
0 Ethernet Card 0, NONE
1 Network Bridge,  DHCP</pre></div></dd></dl></div></div><div class="sect3 " id="idm140019143288416"><div class="titlepage"><div><div><h4 class="title" id="idm140019143288416"><span class="number">1.4.3.13 </span><span class="name">yast language</span> <a title="Permalink" class="permalink" href="#idm140019143288416">#</a></h4></div></div></div><p>
     Configures system languages. <code class="command">yast language</code> accepts the
     following cpmands:
    </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019143286448"><span class="term ">list</span></dt><dd><p>
        Lists all available languages.
       </p></dd><dt id="idm140019143284624"><span class="term ">set</span></dt><dd><p>
        Specifies the main system languages and secondary languages as well:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast language set lang=cs_CZ languages=en_US,es_ES no_packages</pre></div></dd></dl></div></div><div class="sect3 " id="idm140019143281216"><div class="titlepage"><div><div><h4 class="title" id="idm140019143281216"><span class="number">1.4.3.14 </span><span class="name">yast mail</span> <a title="Permalink" class="permalink" href="#idm140019143281216">#</a></h4></div></div></div><p>
     Displays the configuration of the mail system:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast mail summary</pre></div></div><div class="sect3 " id="idm140019143278640"><div class="titlepage"><div><div><h4 class="title" id="idm140019143278640"><span class="number">1.4.3.15 </span><span class="name">yast nfs</span> <a title="Permalink" class="permalink" href="#idm140019143278640">#</a></h4></div></div></div><p>
     Controls the NFS client. <code class="command">yast nfs</code> accepts the following
     commands:
    </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019143276672"><span class="term ">add</span></dt><dd><p>
        Adds a new NFS mount:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast nfs add spec=remote_host:/path/to/nfs/share file=/local/mount/point</pre></div><p>
        For a complete list of options, run <code class="command">yast nfs add
        help</code>.
       </p></dd><dt id="idm140019143272672"><span class="term ">delete</span></dt><dd><p>
        Deletes an existing NFS mount:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast nfs delete spec=remote_host:/path/to/nfs/share file=/local/mount/point</pre></div><p>
        For a complete list of options, run <code class="command">yast nfs delete
        help</code>.
       </p></dd><dt id="idm140019143268656"><span class="term ">edit</span></dt><dd><p>
        Changes an existing NFS mount:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast nfs edit spec=remote_host:/path/to/nfs/share \
 file=/local/mount/point type=nfs4</pre></div><p>
        For a complete list of options, run <code class="command">yast nfs edit
        help</code>.
       </p></dd><dt id="idm140019143264624"><span class="term ">list</span></dt><dd><p>
        Lists existing NFS mounts:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast nfs list
Server            Remote File System    Mount Point    Options
----------------------------------------------------------------
nfs.example.com   /mnt                  /nfs/mnt       nfs
nfs.example.com   /home/tux/nfs_share   /nfs/tux       nfs</pre></div></dd></dl></div></div><div class="sect3 " id="idm140019143261056"><div class="titlepage"><div><div><h4 class="title" id="idm140019143261056"><span class="number">1.4.3.16 </span><span class="name">yast nfs-server</span> <a title="Permalink" class="permalink" href="#idm140019143261056">#</a></h4></div></div></div><p>
     Configures the NFS server. <code class="command">yast nfs-server</code> accepts the
     following commands:
    </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019143259088"><span class="term ">add</span></dt><dd><p>
        Adds a directory to export:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast nfs-server add mountpoint=/nfs/export hosts=*.allowed_hosts.com</pre></div><p>
        For a complete list of options, run <code class="command">yast nfs-server add
        help</code>.
       </p></dd><dt id="idm140019143255088"><span class="term ">delete</span></dt><dd><p>
        Deletes a directory from the NFS export:
       </p><div class="verbatim-wrap"><pre class="screen"> <code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast nfs-server delete mountpoint=/nfs/export</pre></div></dd><dt id="idm140019143252032"><span class="term ">set</span></dt><dd><p>
        Specifies additional parameters for the NFS server:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast nfs-server set enablev4=yes security=yes</pre></div><p>
        For a complete list of options, run <code class="command">yast nfs-server set
        help</code>.
       </p></dd><dt id="idm140019143248032"><span class="term ">start</span></dt><dd><p>
        Starts the NFS server service:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast nfs-server start</pre></div></dd><dt id="idm140019143245024"><span class="term ">stop</span></dt><dd><p>
        Stops the NFS server service:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast nfs-server stop</pre></div></dd><dt id="idm140019143242016"><span class="term ">summary</span></dt><dd><p>
        Displays a summary of the NFS server configuration:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast nfs-server summary
NFS server is enabled
NFS Exports
* /mnt
* /home

NFSv4 support is enabled.
The NFSv4 domain for idmapping is localdomain.
NFS Security using GSS is enabled.</pre></div></dd></dl></div></div><div class="sect3 " id="idm140019143238512"><div class="titlepage"><div><div><h4 class="title" id="idm140019143238512"><span class="number">1.4.3.17 </span><span class="name">yast nis</span> <a title="Permalink" class="permalink" href="#idm140019143238512">#</a></h4></div></div></div><p>
     Configures the NIS client. <code class="command">yast nis</code> accepts the
     following commands:
    </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019143236544"><span class="term ">configure</span></dt><dd><p>
        Changes global settings of a NIS client:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast nis configure server=nis.example.com broadcast=yes</pre></div><p>
        For a complete list of options, run <code class="command">yast nis configure
        help</code>.
       </p></dd><dt id="idm140019143232528"><span class="term ">disable</span></dt><dd><p>
        Disables the NIS client:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast nis disable</pre></div></dd><dt id="idm140019143229520"><span class="term ">enable</span></dt><dd><p>
        Enables your machine as NIS client:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast nis enable server=nis.example.com broadcast=yes automounter=yes</pre></div><p>
        For a complete list of options, run <code class="command">yast nis enable
        help</code>.
       </p></dd><dt id="idm140019143225520"><span class="term ">find</span></dt><dd><p>
        Shows available NIS servers for a given domain:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast nis find domain=nisdomain.com</pre></div></dd><dt id="idm140019143222480"><span class="term ">summary</span></dt><dd><p>
        Displays a configuration summary of a NIS client.
       </p></dd></dl></div></div><div class="sect3 " id="idm140019143220320"><div class="titlepage"><div><div><h4 class="title" id="idm140019143220320"><span class="number">1.4.3.18 </span><span class="name">yast nis-server</span> <a title="Permalink" class="permalink" href="#idm140019143220320">#</a></h4></div></div></div><p>
     Configures a NIS server. <code class="command">yast nis-server</code> accepts the
     following commands:
    </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019143218352"><span class="term ">master</span></dt><dd><p>
        Configures a NIS master server:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast nis-server master domain=nisdomain.com yppasswd=yes</pre></div><p>
        For a complete list of options, run <code class="command">yast nis-server master
        help</code>.
       </p></dd><dt id="idm140019143214352"><span class="term ">slave</span></dt><dd><p>
        Configures a NIS slave server:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast nis-server slave domain=nisdomain.com master_ip=10.100.51.65</pre></div><p>
        For a complete list of options, run <code class="command">yast nis-server slave
        help</code>.
       </p></dd><dt id="idm140019143210352"><span class="term ">stop</span></dt><dd><p>
        Stops a NIS server:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast nis-server stop</pre></div></dd><dt id="idm140019143207360"><span class="term ">summary</span></dt><dd><p>
        Displays a configuration summary of a NIS server:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast nis-server summary</pre></div></dd></dl></div></div><div class="sect3 " id="idm140019143204000"><div class="titlepage"><div><div><h4 class="title" id="idm140019143204000"><span class="number">1.4.3.19 </span><span class="name">yast proxy</span> <a title="Permalink" class="permalink" href="#idm140019143204000">#</a></h4></div></div></div><p>
     Configures proxy settings. <code class="command">yast proxy</code> accepts the
     following commands:
    </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019143202032"><span class="term ">authentication</span></dt><dd><p>
        Specifies the authentication options for proxy:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast proxy authentication username=tux password=secret</pre></div><p>
        For a complete list of options, run <code class="command">yast proxy authentication
        help</code>.
       </p></dd><dt id="idm140019143198016"><span class="term ">enable, disable</span></dt><dd><p>
        Enables or disable proxy settings.
       </p></dd><dt id="idm140019143196192"><span class="term ">set</span></dt><dd><p>
        Changes the current proxy settings:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast proxy set https=proxy.example.com</pre></div><p>
        For a complete list of options, run <code class="command">yast proxy set
        help</code>.
       </p></dd><dt id="idm140019143192208"><span class="term ">summary</span></dt><dd><p>
        Displays proxy settings.
       </p></dd></dl></div></div><div class="sect3 " id="idm140019143190064"><div class="titlepage"><div><div><h4 class="title" id="idm140019143190064"><span class="number">1.4.3.20 </span><span class="name">yast rdp</span> <a title="Permalink" class="permalink" href="#idm140019143190064">#</a></h4></div></div></div><p>
     Controls remote desktop settings. <code class="command">yast rdp</code> accepts the
     following commands:
    </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019143188080"><span class="term ">allow</span></dt><dd><p>
        Allows remote access to the server's desktop:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast rdp allow set=yes</pre></div></dd><dt id="idm140019143185040"><span class="term ">list</span></dt><dd><p>
        Displays the remote desktop configuration summary.
       </p></dd></dl></div></div><div class="sect3 " id="idm140019143182880"><div class="titlepage"><div><div><h4 class="title" id="idm140019143182880"><span class="number">1.4.3.21 </span><span class="name">yast samba-client</span> <a title="Permalink" class="permalink" href="#idm140019143182880">#</a></h4></div></div></div><p>
     Configures the Samba client settings. <code class="command">yast samba-client</code>
     accepts the following commands:
    </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019143180896"><span class="term ">configure</span></dt><dd><p>
        Changes global settings of Samba:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast samba-client configure workgroup=FAMILY</pre></div></dd><dt id="idm140019143177856"><span class="term ">isdomainmember</span></dt><dd><p>
        Verifies if the machine is a member of a domain:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast samba-client isdomainmember domain=SMB_DOMAIN</pre></div></dd><dt id="idm140019143174800"><span class="term ">joindomain</span></dt><dd><p>
        Makes the machine a member of a domain:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast samba-client joindomain domain=SMB_DOMAIN user=username password=pwd</pre></div></dd><dt id="idm140019143171712"><span class="term ">winbind</span></dt><dd><p>
        Enables or disables Winbind services (the
        <code class="systemitem">winbindd</code> daemon):
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast samba-client winbind enable
<code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast samba-client winbind disable</pre></div></dd></dl></div></div><div class="sect3 " id="idm140019143167152"><div class="titlepage"><div><div><h4 class="title" id="idm140019143167152"><span class="number">1.4.3.22 </span><span class="name">yast samba-server</span> <a title="Permalink" class="permalink" href="#idm140019143167152">#</a></h4></div></div></div><p>
     Configures Samba server settings. <code class="command">yast samba-server</code>
     accepts the following commands:
    </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019143165168"><span class="term ">backend</span></dt><dd><p>
        Specifies the back-end for storing user information:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast samba-server backend smbpasswd</pre></div><p>
        For a complete list of options, run <code class="command">yast samba-server backend
        help</code>.
       </p></dd><dt id="idm140019143161184"><span class="term ">configure</span></dt><dd><p>
        Configures global settings of the Samba server:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast samba-server configure workgroup=FAMILY description='Home server'</pre></div><p>
        For a complete list of options, run <code class="command">yast samba-server
        configure help</code>.
       </p></dd><dt id="idm140019143157136"><span class="term ">list</span></dt><dd><p>
        Displays the list of available shares:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast samba-server list
Status     Type Name
==============================
Disabled   Disk profiles
Enabled    Disk print$
Enabled    Disk homes
Disabled   Disk groups
Enabled    Disk movies
Enabled    Printer printers</pre></div></dd><dt id="idm140019143153920"><span class="term ">role</span></dt><dd><p>
        Specifies the role of the Samba Server:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast samba-server role standalone</pre></div><p>
        For a complete list of options, run <code class="command">yast samba-server role
        help</code>.
       </p></dd><dt id="idm140019143149936"><span class="term ">service</span></dt><dd><p>
        Enables or disables the Samba services (<code class="systemitem">smb</code>
        and <code class="systemitem">nmb</code>):
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast samba-server service enable
<code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast samba-server service disable</pre></div></dd><dt id="idm140019143145264"><span class="term ">share</span></dt><dd><p>
        Manipulates a single Samba share:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast samba-server share name=movies browseable=yes guest_ok=yes</pre></div><p>
        For a complete list of options, run <code class="command">yast samba-server share
        help</code>.
       </p></dd></dl></div></div><div class="sect3 " id="idm140019143140944"><div class="titlepage"><div><div><h4 class="title" id="idm140019143140944"><span class="number">1.4.3.23 </span><span class="name">yast security</span> <a title="Permalink" class="permalink" href="#idm140019143140944">#</a></h4></div></div></div><p>
     Controls the security level of the host. <code class="command">yast security</code>
     accepts the following commands:
    </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019143138960"><span class="term ">level</span></dt><dd><p>
        Specifies the security level of the host:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast security level server</pre></div><p>
        For a complete list of options, run <code class="command">yast security level
        help</code>.
       </p></dd><dt id="idm140019143134976"><span class="term ">set</span></dt><dd><p>
        Sets the value of specific options:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast security set passwd=sha512 crack=yes</pre></div><p>
        For a complete list of options, run <code class="command">yast security set
        help</code>.
       </p></dd><dt id="idm140019143130992"><span class="term ">summary</span></dt><dd><p>
        Displays the summary of the current security configuration:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="command">sudo</code>yast security summary</pre></div></dd></dl></div></div><div class="sect3 " id="idm140019143127920"><div class="titlepage"><div><div><h4 class="title" id="idm140019143127920"><span class="number">1.4.3.24 </span><span class="name">yast sound</span> <a title="Permalink" class="permalink" href="#idm140019143127920">#</a></h4></div></div></div><p>
     Configures sound card settings. <code class="command">yast sound</code> accepts the
     following commands:
    </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019143125952"><span class="term ">add</span></dt><dd><p>
        Configures a new sound card. Without any parameters, the command adds
        the first one detected.
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast sound add card=0 volume=75</pre></div><p>
        For a complete list of options, run <code class="command">yast sound add
        help</code>.
       </p></dd><dt id="idm140019143121920"><span class="term ">channels</span></dt><dd><p>
        Lists available volume channels of a sound card:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast sound channels card=0
Master 75
PCM 100</pre></div></dd><dt id="idm140019143118864"><span class="term ">modules</span></dt><dd><p>
        Lists all available sound kernel modules:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast sound modules
snd-atiixp ATI IXP AC97 controller (snd-atiixp)
snd-atiixp-modem ATI IXP MC97 controller (snd-atiixp-modem)
snd-virtuoso Asus Virtuoso driver (snd-virtuoso)
[...]</pre></div></dd><dt id="idm140019143115680"><span class="term ">playtest</span></dt><dd><p>
        Plays a test sound on a sound card:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast sound playtest card=0</pre></div></dd><dt id="idm140019143112656"><span class="term ">remove</span></dt><dd><p>
        Removes a configured sound card:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast sound remove card=0
<code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast sound remove all</pre></div></dd><dt id="idm140019143108896"><span class="term ">set</span></dt><dd><p>
        Specifies new values for a sound card:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast sound set card=0 volume=80</pre></div></dd><dt id="idm140019143105872"><span class="term ">show</span></dt><dd><p>
        Displays detailed information about a sound card:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast sound show card=0
Parameters of card 'ThinkPad X240' (using module snd-hda-intel):

align_buffer_size
 Force buffer and period sizes to be multiple of 128 bytes.
bdl_pos_adj
 BDL position adjustment offset.
beep_mode
 Select HDA Beep registration mode (0=off, 1=on) (default=1).
 Default Value: 0
enable_msi
 Enable Message Signaled Interrupt (MSI)
[...]</pre></div></dd><dt id="idm140019143102496"><span class="term ">summary</span></dt><dd><p>
        Prints configuration summary for all sound cards on the system:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast sound summary</pre></div></dd><dt id="idm140019143099456"><span class="term ">volume</span></dt><dd><p>
        Specifies the volume level of a sound card:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="command">sudo</code>yast sound volume card=0 play</pre></div></dd></dl></div></div><div class="sect3 " id="idm140019143096384"><div class="titlepage"><div><div><h4 class="title" id="idm140019143096384"><span class="number">1.4.3.25 </span><span class="name">yast sysconfig</span> <a title="Permalink" class="permalink" href="#idm140019143096384">#</a></h4></div></div></div><p>
     Controls the variables in files under <code class="filename">/etc/sysconfig</code>.
     <code class="command">yast sysconfig</code> accepts the following commands:
    </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019143093968"><span class="term ">clear</span></dt><dd><p>
        Sets empty value to a variable:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast sysconfig clear=POSTFIX_LISTEN</pre></div><div id="idm140019143091264" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.png" /><h6>Tip: Variable in Multiple Files</h6><p>
         If the variable is available in several files, use the
         <em class="replaceable ">VARIABLE_NAME</em>$<em class="replaceable ">FILE_NAME</em>
         syntax:
        </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast sysconfig clear=CONFIG_TYPE$/etc/sysconfig/mail</pre></div></div></dd><dt id="idm140019143087392"><span class="term ">details</span></dt><dd><p>
        Displays detailed information about a variable:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast sysconfig details variable=POSTFIX_LISTEN
Description:
Value:
File: /etc/sysconfig/postfix
Possible Values: Any value
Default Value:
Configuration Script: postfix
Description:
 Comma separated list of IP's
 NOTE: If not set, LISTEN on all interfaces</pre></div></dd><dt id="idm140019143084128"><span class="term ">list</span></dt><dd><p>
        Displays summary of modified variables. Use <code class="command">all</code> to
        list all variables and their values:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast sysconfig list all
AOU_AUTO_AGREE_WITH_LICENSES="false"
AOU_ENABLE_CRONJOB="true"
AOU_INCLUDE_RECOMMENDS="false"
[...]</pre></div></dd><dt id="idm140019143080512"><span class="term ">set</span></dt><dd><p>
        Sets a value to a variable:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast sysconfig set DISPLAYMANAGER=gdm</pre></div><div id="idm140019143077808" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.png" /><h6>Tip: Variable in Multiple Files</h6><p>
         If the variable is available in several files, use the
         <em class="replaceable ">VARIABLE_NAME</em>$<em class="replaceable ">FILE_NAME</em>
         syntax:
        </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast sysconfig set CONFIG_TYPE$/etc/sysconfig/mail=advanced</pre></div></div></dd></dl></div></div><div class="sect3 " id="idm140019143073600"><div class="titlepage"><div><div><h4 class="title" id="idm140019143073600"><span class="number">1.4.3.26 </span><span class="name">yast tftp-server</span> <a title="Permalink" class="permalink" href="#idm140019143073600">#</a></h4></div></div></div><p>
     Configure a TFTP server. <code class="command">yast tftp-server</code> accepts the
     following commands:
    </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019143071632"><span class="term ">directory</span></dt><dd><p>
        Specifies the directory of the TFTP server:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast tftp-server directory path=/srv/tftp
<code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast tftp-server directory list
Directory Path: /srv/tftp</pre></div></dd><dt id="idm140019143067792"><span class="term ">status</span></dt><dd><p>
        Controls the status of the TFTP server service:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast tftp-server status disable
<code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast tftp-server status show
Service Status: false
<code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast tftp-server status enable</pre></div></dd></dl></div></div><div class="sect3 " id="idm140019143062912"><div class="titlepage"><div><div><h4 class="title" id="idm140019143062912"><span class="number">1.4.3.27 </span><span class="name">yast timezone</span> <a title="Permalink" class="permalink" href="#idm140019143062912">#</a></h4></div></div></div><p>
     Configures the time zone. <code class="command">yast timezone</code> accepts the
     following commands:
    </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019143060944"><span class="term ">list</span></dt><dd><p>
        Lists all available time zones grouped by region:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast timezone list
Region: Africa
Africa/Abidjan (Abidjan)
Africa/Accra (Accra)
Africa/Addis_Ababa (Addis Ababa)
[...]</pre></div></dd><dt id="idm140019143057808"><span class="term ">set</span></dt><dd><p>
        Specifies new values for the time zone configuration:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast timezone set timezone=Europe/Prague hwclock=local</pre></div></dd><dt id="idm140019143054736"><span class="term ">summary</span></dt><dd><p>
        Displays the time zone configuration summary:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast timezone summary
Current Time Zone: Europe/Prague
Hardware Clock Set To: Local time
Current Time and Date: Mon 12. March 2018, 11:36:21 CET</pre></div></dd></dl></div></div><div class="sect3 " id="idm140019143051264"><div class="titlepage"><div><div><h4 class="title" id="idm140019143051264"><span class="number">1.4.3.28 </span><span class="name">yast users</span> <a title="Permalink" class="permalink" href="#idm140019143051264">#</a></h4></div></div></div><p>
     Manages user accounts. <code class="command">yast users</code> accepts the following
     commands:
    </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019143049296"><span class="term ">add</span></dt><dd><p>
        Adds a new user:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast users add username=user1 password=secret home=/home/user1</pre></div><p>
        For a complete list of options, run <code class="command">yast users add
        help</code>.
       </p></dd><dt id="idm140019143045312"><span class="term ">delete</span></dt><dd><p>
        Deletes an existing user account:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast users delete username=user1 delete_home</pre></div><p>
        For a complete list of options, run <code class="command">yast users delete
        help</code>.
       </p></dd><dt id="idm140019143041328"><span class="term ">edit</span></dt><dd><p>
        Changes an existing user account:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast users edit username=user1 password=new_secret</pre></div><p>
        For a complete list of options, run <code class="command">yast users edit
        help</code>.
       </p></dd><dt id="idm140019143037344"><span class="term ">list</span></dt><dd><p>
        Lists existing users filtered by user type:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast users list system</pre></div><p>
        For a complete list of options, run <code class="command">yast users list
        help</code>.
       </p></dd><dt id="idm140019143033360"><span class="term ">show</span></dt><dd><p>
        Displays details about a user:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> yast users show username=wwwrun
Full Name: WWW daemon apache
List of Groups: www
Default Group: wwwrun
Home Directory: /var/lib/wwwrun
Login Shell: /sbin/nologin
Login Name: wwwrun
UID: 456</pre></div><p>
        For a complete list of options, run <code class="command">yast users show
        help</code>.
       </p></dd></dl></div></div></div></div></div><div class="chapter " id="cha.sw_cl"><div class="titlepage"><div><div><h2 class="title"><span class="number">2 </span><span class="name">Managing Software with Command Line Tools</span> <a title="Permalink" class="permalink" href="#cha.sw_cl">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">Filename: </span>sw_managing_commandline.xml</li><li><span class="ds-label">ID: </span>cha.sw_cl</li></ul></div></div><div><div class="abstract"><div class="abstract-title-wrap"><h6 class="abstract-title">Abstract<a title="Permalink" class="permalink" href="#idm140019143025728">#</a></h6></div><p>
    This chapter describes Zypper and RPM, two command line tools for managing
    software. For a definition of the terminology used in this context (for
    example, <code class="literal">repository</code>, <code class="literal">patch</code>, or
    <code class="literal">update</code>) refer to
    <span class="intraxref">Book “<em class="citetitle ">Start-Up</em>”, Chapter 11 “Installing or Removing Software”, Section 11.1 “Definition of Terms”</span>.
   </p></div></div></div></div><div class="line"><div class="toc"><dl><dt><span class="sect1"><a href="#sec.zypper"><span class="number">2.1 </span><span class="name">Using Zypper</span></a></span></dt><dt><span class="sect1"><a href="#sec.rpm"><span class="number">2.2 </span><span class="name">RPM—the Package Manager</span></a></span></dt></dl></div></div><div class="sect1 " id="sec.zypper"><div class="titlepage"><div><div><h2 class="title" id="sec.zypper"><span class="number">2.1 </span><span class="name">Using Zypper</span> <a title="Permalink" class="permalink" href="#sec.zypper">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">Filename: </span>zypper.xml</li><li><span class="ds-label">ID: </span>sec.zypper</li></ul></div></div></div></div><p>
  Zypper is a command line package manager for installing, updating and
  removing packages as well as for managing repositories. It is especially
  useful for accomplishing remote software management tasks or managing
  software from shell scripts.
 </p><div class="sect2 " id="sec.zypper.usage"><div class="titlepage"><div><div><h3 class="title" id="sec.zypper.usage"><span class="number">2.1.1 </span><span class="name">General Usage</span> <a title="Permalink" class="permalink" href="#sec.zypper.usage">#</a></h3></div></div></div><p>
   The general syntax of Zypper is:
  </p><div class="verbatim-wrap"><pre class="screen">zypper <code class="option">[--global-options]</code> <em class="replaceable ">COMMAND</em> <code class="option"> [--command-options]</code> <code class="option">[arguments]</code></pre></div><p>
   The components enclosed in brackets are not required. See <code class="command">zypper
   help</code> for a list of general options and all commands. To get help
   for a specific command, type <code class="command">zypper help</code>
   <em class="replaceable ">COMMAND</em>.
  </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019143010720"><span class="term ">Zypper Commands</span></dt><dd><p>
      The simplest way to execute Zypper is to type its name, followed by a
      command. For example, to apply all needed patches to the system, use:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> zypper patch</pre></div></dd><dt id="idm140019143007760"><span class="term ">Global Options</span></dt><dd><p>
      Additionally, you can choose from one or more global options by typing
      them immediately before the command:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> zypper --non-interactive patch</pre></div><p>
      In the above example, the option <code class="option">--non-interactive</code> means
      that the command is run without asking anything (automatically applying
      the default answers).
     </p></dd><dt id="idm140019143003792"><span class="term ">Command-Specific Options</span></dt><dd><p>
      To use options that are specific to a particular command, type them
      immediately after the command:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> zypper patch --auto-agree-with-licenses</pre></div><p>
      In the above example, <code class="option">--auto-agree-with-licenses</code> is used
      to apply all needed patches to a system without you being asked to
      confirm any licenses. Instead, license will be accepted automatically.
     </p></dd><dt id="idm140019142999760"><span class="term ">Arguments</span></dt><dd><p>
      Some commands require one or more arguments. For example, when using the
      command <code class="command">install</code>, you need to specify which package or
      which packages you want to <span class="emphasis"><em>install</em></span>:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> zypper install mplayer</pre></div><p>
      Some options also require a single argument. The following command will
      list all known patterns:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>zypper search -t pattern</pre></div></dd></dl></div><p>
   You can combine all of the above. For example, the following command will
   install the <span class="package">mc</span> and <span class="package">vim</span> packages from
   the <code class="literal">factory</code> repository while being verbose:
  </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> zypper -v install --from factory mc vim</pre></div><p>
   The <code class="option">--from</code> option makes sure to keep all repositories
   enabled (for solving any dependencies) while requesting the package from the
   specified repository.
  </p><p>
   Most Zypper commands have a <code class="literal">dry-run</code> option that does a
   simulation of the given command. It can be used for test purposes.
  </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> zypper remove --dry-run MozillaFirefox</pre></div><p>
   Zypper supports the global <code class="option">--userdata
   <em class="replaceable ">STRING</em></code> option. You can specify a string
   with this option, which gets written to Zypper's log files and plug-ins
   (such as the Btrfs plug-in). It can be used to mark and identify
   transactions in log files.
  </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> zypper --userdata <em class="replaceable ">STRING</em> patch</pre></div></div><div class="sect2 " id="sec.zypper.softman"><div class="titlepage"><div><div><h3 class="title" id="sec.zypper.softman"><span class="number">2.1.2 </span><span class="name">Installing and Removing Software with Zypper</span> <a title="Permalink" class="permalink" href="#sec.zypper.softman">#</a></h3></div></div></div><p>
   To install or remove packages, use the following commands:
  </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> zypper install <em class="replaceable ">PACKAGE_NAME</em>
sudo zypper remove <em class="replaceable ">PACKAGE_NAME</em></pre></div><div id="idm140019142981968" class="admonition warning normal"><img class="symbol" alt="Warning" title="Warning" src="static/images/icon-warning.png" /><h6>Warning: Do Not Remove Mandatory System Packages</h6><p>
    Do not remove mandatory system packages like
    <span class="package">glibc</span>
    ,
    <span class="package">zypper</span>
    ,
    <span class="package">kernel</span>
    . If they are removed, the system can become unstable or stop working
    altogether.
   </p></div><div class="sect3 " id="sec.zypper.selectpackage"><div class="titlepage"><div><div><h4 class="title" id="sec.zypper.selectpackage"><span class="number">2.1.2.1 </span><span class="name">Selecting Which Packages to Install or Remove</span> <a title="Permalink" class="permalink" href="#sec.zypper.selectpackage">#</a></h4></div></div></div><p>
    There are various ways to address packages with the commands
    <code class="command">zypper install</code> and <code class="command">zypper remove</code>.
   </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019142976192"><span class="term ">By Exact Package Name</span></dt><dd><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> zypper install MozillaFirefox</pre></div></dd><dt id="idm140019142973856"><span class="term ">By Exact Package Name and Version Number</span></dt><dd><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> zypper install MozillaFirefox-52.2</pre></div></dd><dt id="idm140019142971440"><span class="term ">By Repository Alias and Package Name</span></dt><dd><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> zypper install mozilla:MozillaFirefox</pre></div><p>
       Where <code class="literal">mozilla</code> is the alias of the repository from
       which to install.
      </p></dd><dt id="idm140019142968096"><span class="term ">By Package Name Using Wild Cards</span></dt><dd><p>
       You can select all packages that have names starting or ending with a
       certain string. Use wild cards with care, especially when removing
       packages. The following command will install all packages starting with
       <span class="quote">“<span class="quote">Moz</span>”</span>:
      </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> zypper install 'Moz*'</pre></div><div id="idm140019142964912" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.png" /><h6>Tip: Removing all <code class="filename">-debuginfo</code> Packages</h6><p>
        When debugging a problem, you sometimes need to temporarily install a
        lot of <code class="filename">-debuginfo</code> packages which give you more
        information about running processes. After your debugging session
        finishes and you need to clean the environment, run the following:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> zypper remove '*-debuginfo'</pre></div></div></dd><dt id="idm140019142961056"><span class="term ">By Capability</span></dt><dd><p>
       For example, if you want to install a Perl module without knowing the
       name of the package, capabilities come in handy:
      </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> zypper install firefox</pre></div></dd><dt id="idm140019142958112"><span class="term ">By Capability, Hardware Architecture, or Version</span></dt><dd><p>
       Together with a capability, you can specify a hardware architecture and
       a version:
      </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
         The name of the desired hardware architecture is appended to the
         capability after a full stop. For example, to specify the AMD64/Intel 64
         architectures (which in Zypper is named <code class="literal">x86_64</code>),
         use:
        </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> zypper install 'firefox.x86_64'</pre></div></li><li class="listitem "><p>
         Versions must be appended to the end of the string and must be
         preceded by an operator: <code class="literal">&lt;</code> (lesser than),
         <code class="literal">&lt;=</code> (lesser than or equal), <code class="literal">=</code>
         (equal), <code class="literal">&gt;=</code> (greater than or equal),
         <code class="literal">&gt;</code> (greater than).
        </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> zypper install 'firefox&gt;=52.2'</pre></div></li><li class="listitem "><p>
         You can also combine a hardware architecture and version requirement:
        </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> zypper install 'firefox.x86_64&gt;=52.2'</pre></div></li></ul></div></dd><dt id="idm140019142946800"><span class="term ">By Path to the RPM file</span></dt><dd><p>
       You can also specify a local or remote path to a package:
      </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> zypper install /tmp/install/MozillaFirefox.rpm
<code class="prompt user">tux &gt; </code><code class="command">sudo</code> zypper install http://download.example.com/MozillaFirefox.rpm</pre></div></dd></dl></div></div><div class="sect3 " id="sec.zypper.combineinstall"><div class="titlepage"><div><div><h4 class="title" id="sec.zypper.combineinstall"><span class="number">2.1.2.2 </span><span class="name">Combining Installation and Removal of Packages</span> <a title="Permalink" class="permalink" href="#sec.zypper.combineinstall">#</a></h4></div></div></div><p>
    To install and remove packages simultaneously, use the
    <code class="literal">+/-</code> modifiers. To install
    <span class="package">emacs</span>
    and simultaneously remove
    <span class="package">vim</span>
    , use:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> zypper install emacs -vim</pre></div><p>
    To remove
    <span class="package">emacs</span>
    and simultaneously install
    <span class="package">vim</span>
    , use:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> zypper remove emacs +vim</pre></div><p>
    To prevent the package name starting with the <code class="literal">-</code> being
    interpreted as a command option, always use it as the second argument. If
    this is not possible, precede it with <code class="literal">--</code>:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> zypper install -emacs +vim       # Wrong
<code class="prompt user">tux &gt; </code><code class="command">sudo</code> zypper install vim -emacs        # Correct
<code class="prompt user">tux &gt; </code><code class="command">sudo</code> zypper install -- -emacs +vim    # Correct
<code class="prompt user">tux &gt; </code><code class="command">sudo</code> zypper remove emacs +vim         # Correct</pre></div></div><div class="sect3 " id="sec.zypper.clean"><div class="titlepage"><div><div><h4 class="title" id="sec.zypper.clean"><span class="number">2.1.2.3 </span><span class="name">Cleaning Up Dependencies of Removed Packages</span> <a title="Permalink" class="permalink" href="#sec.zypper.clean">#</a></h4></div></div></div><p>
    If (together with a certain package), you automatically want to remove any
    packages that become unneeded after removing the specified package, use the
    <code class="option">--clean-deps</code> option:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> zypper rm <em class="replaceable ">PACKAGE_NAME</em> --clean-deps</pre></div></div><div class="sect3 " id="sec.zypper.script"><div class="titlepage"><div><div><h4 class="title" id="sec.zypper.script"><span class="number">2.1.2.4 </span><span class="name">Using Zypper in Scripts</span> <a title="Permalink" class="permalink" href="#sec.zypper.script">#</a></h4></div></div></div><p>
    By default, Zypper asks for a confirmation before installing or removing a
    selected package, or when a problem occurs. You can override this behavior
    using the <code class="option">--non-interactive</code> option. This option must be
    given before the actual command (<code class="command">install</code>,
    <code class="command">remove</code>, and <code class="command">patch</code>), as can be seen in
    the following:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> zypper <code class="option">--non-interactive</code> install <em class="replaceable ">PACKAGE_NAME</em></pre></div><p>
    This option allows the use of Zypper in scripts and cron jobs.
   </p></div><div class="sect3 " id="sec.zypper.softman.sources"><div class="titlepage"><div><div><h4 class="title" id="sec.zypper.softman.sources"><span class="number">2.1.2.5 </span><span class="name">Installing or Downloading Source Packages</span> <a title="Permalink" class="permalink" href="#sec.zypper.softman.sources">#</a></h4></div></div></div><p>
    To install the corresponding source package of a package, use:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>zypper source-install <em class="replaceable ">PACKAGE_NAME</em></pre></div><p>
    When executed as <code class="systemitem">root</code>, the default location to install source
    packages is <code class="filename">/usr/src/packages/</code> and
    <code class="filename">~/rpmbuild</code> when run as user. These values can be
    changed in your local <code class="command">rpm</code> configuration.
   </p><p>
    This command will also install the build dependencies of the specified
    package. If you do not want this, add the switch <code class="literal">-D</code>:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> zypper source-install -D <em class="replaceable ">PACKAGE_NAME</em></pre></div><p>
    To install only the build dependencies use <code class="literal">-d</code>.
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> zypper source-install -d <em class="replaceable ">PACKAGE_NAME</em></pre></div><p>
    Of course, this will only work if you have the repository with the source
    packages enabled in your repository list (it is added by default, but not
    enabled). See <a class="xref" href="#sec.zypper.instrepo" title="2.1.5. Managing Repositories with Zypper">Section 2.1.5, “Managing Repositories with Zypper”</a> for details on
    repository management.
   </p><p>
    A list of all source packages available in your repositories can be
    obtained with:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>zypper search -t srcpackage</pre></div><p>
    You can also download source packages for all installed packages to a local
    directory. To download source packages, use:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>zypper source-download</pre></div><p>
    The default download directory is
    <code class="filename">/var/cache/zypper/source-download</code>. You can change it
    using the <code class="option">--directory</code> option. To only show missing or
    extraneous packages without downloading or deleting anything, use the
    <code class="option">--status</code> option. To delete extraneous source packages, use
    the <code class="option">--delete</code> option. To disable deleting, use the
    <code class="option">--no-delete</code> option.
   </p></div><div class="sect3 " id="sec.zypper.softman.pluscontent"><div class="titlepage"><div><div><h4 class="title" id="sec.zypper.softman.pluscontent"><span class="number">2.1.2.6 </span><span class="name">Installing Packages from Disabled Repositories</span> <a title="Permalink" class="permalink" href="#sec.zypper.softman.pluscontent">#</a></h4></div></div></div><p>
    Normally you can only install or refresh packages from enabled
    repositories. The <code class="option">--plus-content
    <em class="replaceable ">TAG</em></code> option helps you specify
    repositories to be refreshed, temporarily enabled during the current Zypper
    session, and disabled after it completes.
   </p><p>
    For example, to enable repositories that may provide additional
    <code class="filename">-debuginfo</code> or <code class="filename">-debugsource</code>
    packages, use <code class="option">--plus-content debug</code>. You can specify this
    option multiple times.
   </p><p>
    To temporarily enable such 'debug' repositories to install a specific
    <code class="filename">-debuginfo</code> package, use the option as follows:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> zypper --plus-content debug \
   install "debuginfo(build-id)=eb844a5c20c70a59fc693cd1061f851fb7d046f4"</pre></div><p>
    The <code class="literal">build-id</code> string is reported by
    <code class="command">gdb</code> for missing debuginfo packages.
   </p></div><div class="sect3 " id="sec.zypper.softman.util"><div class="titlepage"><div><div><h4 class="title" id="sec.zypper.softman.util"><span class="number">2.1.2.7 </span><span class="name">Utilities</span> <a title="Permalink" class="permalink" href="#sec.zypper.softman.util">#</a></h4></div></div></div><p>
    To verify whether all dependencies are still fulfilled and to repair
    missing dependencies, use:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>zypper verify</pre></div><p>
    In addition to dependencies that must be fulfilled, some packages
    <span class="quote">“<span class="quote">recommend</span>”</span> other packages. These recommended packages are
    only installed if actually available and installable. In case recommended
    packages were made available after the recommending package has been
    installed (by adding additional packages or hardware), use the following
    command:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> zypper install-new-recommends</pre></div><p>
    This command is very useful after plugging in a Web cam or Wi-Fi device. It
    will install drivers for the device and related software, if available.
    Drivers and related software are only installable if certain hardware
    dependencies are fulfilled.
   </p></div></div><div class="sect2 " id="sec.zypper.softup"><div class="titlepage"><div><div><h3 class="title" id="sec.zypper.softup"><span class="number">2.1.3 </span><span class="name">Updating Software with Zypper</span> <a title="Permalink" class="permalink" href="#sec.zypper.softup">#</a></h3></div></div></div><p>
   There are three different ways to update software using Zypper: by
   installing patches, by installing a new version of a package or by updating
   the entire distribution. The latter is achieved with <code class="command">zypper
   dist-upgrade</code>. Upgrading <span class="productname"><span class="phrase">openSUSE Leap</span></span> is discussed in
   
   <span class="phrase"><span class="intraxref">Book “<em class="citetitle ">Start-Up</em>”, Chapter 14 “Upgrading the System and System Changes”</span></span>.
  </p><div class="sect3 " id="sec.zypper.softup.patch"><div class="titlepage"><div><div><h4 class="title" id="sec.zypper.softup.patch"><span class="number">2.1.3.1 </span><span class="name">Installing All Needed Patches</span> <a title="Permalink" class="permalink" href="#sec.zypper.softup.patch">#</a></h4></div></div></div><p>
    To install all officially released patches that apply to your system, run:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> zypper patch</pre></div><p>
    All patches available from repositories configured on your computer are
    checked for their relevance to your installation. If they are relevant (and
    not classified as <code class="literal">optional</code> or
    <code class="literal">feature</code>), they are installed immediately.
    
   </p><p>
    If a patch that is about to be installed includes changes that require a
    system reboot, you will be warned before.
   </p><p>
    The plain <code class="command">zypper patch</code> command does not apply patches
    from third party repositories. To update also the third party repositories,
    use the <code class="literal">with-update</code> command option as follows:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> zypper patch --with update</pre></div><p>
    To install also optional patches, use:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> zypper patch --with-optional</pre></div><p>
    To install all patches relating to a specific Bugzilla issue, use:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> zypper patch --bugzilla=<em class="replaceable ">NUMBER</em></pre></div><p>
    To install all patches relating to a specific CVE database entry, use:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> zypper patch --cve=<em class="replaceable ">NUMBER</em></pre></div><p>
    For example, to install a security patch with the CVE number
    <code class="literal">CVE-2010-2713</code>, execute:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> zypper patch --cve=CVE-2010-2713</pre></div><p>
    To install only patches which affect Zypper and the package management
    itself, use:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> zypper patch --updatestack-only</pre></div><p>
    Bear in mind that other command options that would also update other
    repositories will be dropped if you use the
    <code class="literal">updatestack-only</code> command option.
   </p></div><div class="sect3 " id="sec.zypper.softup.listpatch"><div class="titlepage"><div><div><h4 class="title" id="sec.zypper.softup.listpatch"><span class="number">2.1.3.2 </span><span class="name">Listing Patches</span> <a title="Permalink" class="permalink" href="#sec.zypper.softup.listpatch">#</a></h4></div></div></div><p>
    To find out whether patches are available, Zypper allows viewing the
    following information:
   </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019142866304"><span class="term ">Number of Needed Patches</span></dt><dd><p>
       To list the number of needed patches (patches that apply to your system
       but are not yet installed), use <code class="command">patch-check</code>:
      </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>zypper patch-check
Loading repository data...
Reading installed packages...
5 patches needed (1 security patch)</pre></div><p>
       This command can be combined with the
       <code class="option">--updatestack-only</code> option to list only the patches
       which affect Zypper and the package management itself.
      </p></dd><dt id="idm140019142862160"><span class="term ">List of Needed Patches</span></dt><dd><p>
       To list all needed patches (patches that apply to your system but are
       not yet installed), use <code class="command">list-patches</code>:
      </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>zypper list-patches
Repository | Name              | Category | Severity | Interactive | Status | S&gt;
-----------+-------------------+----------+----------+-------------+--------+--&gt;
Update     | openSUSE-2017-828 | security | moderate | ---         | needed | S&gt;

Found 1 applicable patch:
1 patch needed (1 security patch)</pre></div></dd><dt id="idm140019142858192"><span class="term ">List of All Patches</span></dt><dd><p>
       To list all patches available for <span class="productname"><span class="phrase">openSUSE Leap</span></span>, regardless of whether
       they are already installed or apply to your installation, use
       <code class="command">zypper patches</code>.
      </p></dd></dl></div><p>
    It is also possible to list and install patches relevant to specific
    issues. To list specific patches, use the <code class="command">zypper
    list-patches</code> command with the following options:
   </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019142853232"><span class="term ">By Bugzilla Issues</span></dt><dd><p>
       To list all needed patches that relate to Bugzilla issues, use the
       option <code class="option">--bugzilla</code>.
      </p><p>
       To list patches for a specific bug, you can also specify a bug number:
       <code class="option">--bugzilla=<em class="replaceable ">NUMBER</em></code>. To search
       for patches relating to multiple Bugzilla issues, add commas between the
       bug numbers, for example:
      </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>zypper list-patches --bugzilla=972197,956917</pre></div></dd><dt id="idm140019142848784"><span class="term ">By CVE Number</span></dt><dd><p>
       To list all needed patches that relate to an entry in the CVE database
       (Common Vulnerabilities and Exposures), use the option
       <code class="option">--cve</code>.
      </p><p>
       To list patches for a specific CVE database entry, you can also specify
       a CVE number: <code class="option">--cve=<em class="replaceable ">NUMBER</em></code>.
       To search for patches relating to multiple CVE database entries, add
       commas between the CVE numbers, for example:
      </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>zypper list-patches --bugzilla=CVE-2016-2315,CVE-2016-2324</pre></div></dd></dl></div><p>
    To list all patches regardless of whether they are needed, use the option
    <code class="option">--all</code> additionally. For example, to list all patches with
    a CVE number assigned, use:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>zypper list-patches --all --cve
Issue | No.           | Patch             | Category    | Severity  | Status
------+---------------+-------------------+-------------+-----------+----------
cve   | CVE-2015-0287 | SUSE-SLE-Module.. | recommended | moderate  | needed
cve   | CVE-2014-3566 | SUSE-SLE-SERVER.. | recommended | moderate  | not needed
[...]</pre></div></div><div class="sect3 " id="sec.zypper.softup.update"><div class="titlepage"><div><div><h4 class="title" id="sec.zypper.softup.update"><span class="number">2.1.3.3 </span><span class="name">Installing New Package Versions</span> <a title="Permalink" class="permalink" href="#sec.zypper.softup.update">#</a></h4></div></div></div><p>
    If a repository contains only new packages, but does not provide patches,
    <code class="command">zypper patch</code> does not show any effect. To update
    all installed packages with newer available versions (while maintaining
    system integrity), use:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> zypper update</pre></div><p>
    To update individual packages, specify the package with either the update
    or install command:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> zypper update <em class="replaceable ">PACKAGE_NAME</em>
sudo zypper install <em class="replaceable ">PACKAGE_NAME</em></pre></div><p>
    A list of all new installable packages can be obtained with the command:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>zypper list-updates</pre></div><p>
    Note that this command only lists packages that match the following
    criteria:
   </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
      has the same vendor like the already installed package,
     </p></li><li class="listitem "><p>
      is provided by repositories with at least the same priority than the
      already installed package,
     </p></li><li class="listitem "><p>
      is installable (all dependencies are satisfied).
     </p></li></ul></div><p>
    A list of <span class="emphasis"><em>all</em></span> new available packages (regardless
    whether installable or not) can be obtained with:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> zypper list-updates --all</pre></div><p>
    To find out why a new package cannot be installed, use the <code class="command">zypper
    install</code> or <code class="command">zypper update</code> command as described
    above.
   </p></div><div class="sect3 " id="sec.zypper.softup.orphaned"><div class="titlepage"><div><div><h4 class="title" id="sec.zypper.softup.orphaned"><span class="number">2.1.3.4 </span><span class="name">Identifying Orphaned Packages</span> <a title="Permalink" class="permalink" href="#sec.zypper.softup.orphaned">#</a></h4></div></div></div><p>
    Whenever you remove a repository from Zypper or upgrade your system, some
    packages can get in an <span class="quote">“<span class="quote">orphaned</span>”</span> state. These
    <span class="emphasis"><em>orphaned</em></span> packages belong to no active repository
    anymore. The following command gives you a list of these:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> zypper packages --orphaned</pre></div><p>
    With this list, you can decide if a package is still needed or can be
    removed safely.
   </p></div></div><div class="sect2 " id="sec.zypper.ps"><div class="titlepage"><div><div><h3 class="title" id="sec.zypper.ps"><span class="number">2.1.4 </span><span class="name">Identifying Processes and Services Using Deleted Files</span> <a title="Permalink" class="permalink" href="#sec.zypper.ps">#</a></h3></div></div></div><p>
   When patching, updating or removing packages, there may be running processes
   on the system which continue to use files having been deleted by the update
   or removal. Use <code class="command">zypper ps</code> to list processes using deleted
   files. In case the process belongs to a known service, the service name is
   listed, making it easy to restart the service. By default <code class="command">zypper
   ps</code> shows a table:
  </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>zypper ps
PID   | PPID | UID | User  | Command      | Service      | Files
------+------+-----+-------+--------------+--------------+-------------------
814   | 1    | 481 | avahi | avahi-daemon | avahi-daemon | /lib64/ld-2.19.s-&gt;
      |      |     |       |              |              | /lib64/libdl-2.1-&gt;
      |      |     |       |              |              | /lib64/libpthrea-&gt;
      |      |     |       |              |              | /lib64/libc-2.19-&gt;
[...]</pre></div><table border="0" summary="Simple list" class="simplelist "><tr><td><span class="bold"><strong>PID</strong></span>: ID of the process
   </td></tr><tr><td><span class="bold"><strong>PPID</strong></span>: ID of the parent process
   </td></tr><tr><td><span class="bold"><strong>UID</strong></span>: ID of the user running the
    process
   </td></tr><tr><td><span class="bold"><strong>Login</strong></span>: Login name of the user
    running the process
   </td></tr><tr><td><span class="bold"><strong>Command</strong></span>: Command used to
    execute the process
   </td></tr><tr><td><span class="bold"><strong>Service</strong></span>: Service name (only if command
    is associated with a system service)
   </td></tr><tr><td><span class="bold"><strong>Files</strong></span>: The list of the deleted
    files
   </td></tr></table><p>
   The output format of <code class="command">zypper ps</code> can be controlled as
   follows:
  </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019142809376"><span class="term "><code class="command">zypper ps</code><code class="option">-s</code>
    </span></dt><dd><p>
      Create a short table not showing the deleted files.
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>zypper ps -s
PID   | PPID | UID  | User    | Command      | Service
------+------+------+---------+--------------+--------------
814   | 1    | 481  | avahi   | avahi-daemon | avahi-daemon
817   | 1    | 0    | root    | irqbalance   | irqbalance
1567  | 1    | 0    | root    | sshd         | sshd
1761  | 1    | 0    | root    | master       | postfix
1764  | 1761 | 51   | postfix | pickup       | postfix
1765  | 1761 | 51   | postfix | qmgr         | postfix
2031  | 2027 | 1000 | tux     | bash         |</pre></div></dd><dt id="idm140019142805408"><span class="term "><code class="command">zypper ps</code><code class="option">-ss</code>
    </span></dt><dd><p>
      Show only processes associated with a system service.
     </p><div class="verbatim-wrap"><pre class="screen">PID   | PPID | UID  | User    | Command      | Service
------+------+------+---------+--------------+--------------
814   | 1    | 481  | avahi   | avahi-daemon | avahi-daemon
817   | 1    | 0    | root    | irqbalance   | irqbalance
1567  | 1    | 0    | root    | sshd         | sshd
1761  | 1    | 0    | root    | master       | postfix
1764  | 1761 | 51   | postfix | pickup       | postfix
1765  | 1761 | 51   | postfix | qmgr         | postfix</pre></div></dd><dt id="idm140019142802112"><span class="term "><code class="command">zypper ps</code><code class="option">-sss</code>
    </span></dt><dd><p>
      Only show system services using deleted files.
     </p><div class="verbatim-wrap"><pre class="screen">avahi-daemon
irqbalance
postfix
sshd</pre></div></dd><dt id="idm140019142799232"><span class="term "><code class="command">zypper ps</code><code class="option">--print "systemctl status
     %s"</code>
    </span></dt><dd><p>
      Show the commands to retrieve status information for services which might
      need a restart.
     </p><div class="verbatim-wrap"><pre class="screen">systemctl status avahi-daemon
systemctl status irqbalance
systemctl status postfix
systemctl status sshd</pre></div></dd></dl></div><p>
   For more information about service handling refer to
   <a class="xref" href="#cha.systemd" title="Chapter 10. The systemd Daemon">Chapter 10, <em>The <code class="systemitem">systemd</code> Daemon</em></a>.
  </p></div><div class="sect2 " id="sec.zypper.instrepo"><div class="titlepage"><div><div><h3 class="title" id="sec.zypper.instrepo"><span class="number">2.1.5 </span><span class="name">Managing Repositories with Zypper</span> <a title="Permalink" class="permalink" href="#sec.zypper.instrepo">#</a></h3></div></div></div><p>
   All installation or patch commands of Zypper rely on a list of known
   repositories. To list all repositories known to the system, use the command:
  </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>zypper repos</pre></div><p>
   The result will look similar to the following output:
  </p><div class="example" id="ex.zypper.repos"><div class="example-title-wrap"><h6 class="example-title"><span class="number">Example 2.1: </span><span class="name">Zypper—List of Known Repositories </span><a title="Permalink" class="permalink" href="#ex.zypper.repos">#</a></h6></div><div class="example-contents"><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>zypper repos
#  | Alias                 | Name             | Enabled | GPG Check | Refresh
---+-----------------------+------------------+---------+-----------+--------
 1 | Leap-42.3-Main        | Main (OSS)       | Yes     | (r ) Yes  | Yes
 2 | Leap-42.3-Update      | Update (OSS)     | Yes     | (r ) Yes  | Yes
 3 | Leap-42.3-NOSS        | Main (NON-OSS)   | Yes     | (r ) Yes  | Yes
 4 | Leap-42.3-Update-NOSS | Update (NON-OSS) | Yes     | (r ) Yes  | Yes
[...]</pre></div></div></div><p>
   When specifying repositories in various commands, an alias, URI or
   repository number from the <code class="command">zypper repos</code> command output
   can be used. A repository alias is a short version of the repository name
   for use in repository handling commands. Note that the repository numbers
   can change after modifying the list of repositories. The alias will never
   change by itself.
  </p><p>
   By default, details such as the URI or the priority of the repository are
   not displayed. Use the following command to list all details:
  </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>zypper repos -d</pre></div><div class="sect3 " id="sec.zypper.instrepo.add"><div class="titlepage"><div><div><h4 class="title" id="sec.zypper.instrepo.add"><span class="number">2.1.5.1 </span><span class="name">Adding Repositories</span> <a title="Permalink" class="permalink" href="#sec.zypper.instrepo.add">#</a></h4></div></div></div><p>
    To add a repository, run
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> zypper addrepo <em class="replaceable ">URI</em> <em class="replaceable ">ALIAS</em></pre></div><p>
    <em class="replaceable ">URI</em> can either be an Internet repository, a
    network resource, a directory or a CD or DVD (see
    <a class="link" href="http://en.opensuse.org/openSUSE:Libzypp_URIs" target="_blank">http://en.opensuse.org/openSUSE:Libzypp_URIs</a> for
    details). The <em class="replaceable ">ALIAS</em> is a shorthand and unique
    identifier of the repository. You can freely choose it, with the only
    exception that it needs to be unique. Zypper will issue a warning if you
    specify an alias that is already in use.
   </p></div><div class="sect3 " id="sec.zypper.instrepo.refresh"><div class="titlepage"><div><div><h4 class="title" id="sec.zypper.instrepo.refresh"><span class="number">2.1.5.2 </span><span class="name">Refreshing Repositories</span> <a title="Permalink" class="permalink" href="#sec.zypper.instrepo.refresh">#</a></h4></div></div></div><p>
    <code class="command">zypper</code> enables you to fetch changes in packages from
    configured repositories. To fetch the changes, run:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> zypper refresh</pre></div><div id="idm140019142777184" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note: Default Behavior of <code class="command">zypper</code></h6><p>
     By default, some commands perform <code class="command">refresh</code>
     automatically, so you do not need to run the command explicitly.
    </p></div><p>
    The <code class="command">refresh</code> command enables you to view changes also in
    disabled repositories, by using the <code class="literal">--plus-content</code>
    option:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> zypper --plus-content refresh</pre></div><p>
    This option fetches changes in repositories, but keeps the disabled
    repositories in the same state—disabled.
   </p></div><div class="sect3 " id="sec.zypper.instrepo.rm"><div class="titlepage"><div><div><h4 class="title" id="sec.zypper.instrepo.rm"><span class="number">2.1.5.3 </span><span class="name">Removing Repositories</span> <a title="Permalink" class="permalink" href="#sec.zypper.instrepo.rm">#</a></h4></div></div></div><p>
    To remove a repository from the list, use the command
    <code class="command">zypper removerepo</code> together with the alias or number of
    the repository you want to delete. For example, to remove the repository
    <code class="literal">Leap-42.3-NOSS</code> from <a class="xref" href="#ex.zypper.repos" title="Zypper—List of Known Repositories">Example 2.1, “Zypper—List of Known Repositories”</a>,
    use one of the following commands:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> zypper removerepo 4
<code class="prompt user">tux &gt; </code><code class="command">sudo</code> zypper removerepo "Leap-42.3-NOSS"</pre></div></div><div class="sect3 " id="sec.zypper.instrepo.mofify"><div class="titlepage"><div><div><h4 class="title" id="sec.zypper.instrepo.mofify"><span class="number">2.1.5.4 </span><span class="name">Modifying Repositories</span> <a title="Permalink" class="permalink" href="#sec.zypper.instrepo.mofify">#</a></h4></div></div></div><p>
    Enable or disable repositories with <code class="command">zypper modifyrepo</code>.
    You can also alter the repository's properties (such as refreshing
    behavior, name or priority) with this command. The following command will
    enable the repository named <code class="literal">updates</code>, turn on
    auto-refresh and set its priority to 20:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> zypper modifyrepo -er -p 20 'updates'</pre></div><p>
    Modifying repositories is not limited to a single repository—you can
    also operate on groups:
   </p><table border="0" summary="Simple list" class="simplelist "><tr><td><code class="option">-a</code>: all repositories</td></tr><tr><td><code class="option">-l</code>: local repositories</td></tr><tr><td><code class="option">-t</code>: remote repositories</td></tr><tr><td><code class="option">-m <em class="replaceable ">TYPE</em></code>: repositories
     of a certain type (where <em class="replaceable ">TYPE</em> can be one of the
     following: <code class="literal">http</code>, <code class="literal">https</code>, <code class="literal">ftp</code>,
     <code class="literal">cd</code>, <code class="literal">dvd</code>, <code class="literal">dir</code>, <code class="literal">file</code>,
     <code class="literal">cifs</code>, <code class="literal">smb</code>, <code class="literal">nfs</code>, <code class="literal">hd</code>,
     <code class="literal">iso</code>) </td></tr></table><p>
    To rename a repository alias, use the <code class="literal">renamerepo</code>
    command. The following example changes the alias from <code class="literal">Mozilla
    Firefox</code> to <code class="literal">firefox</code>:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> zypper renamerepo 'Mozilla Firefox' firefox</pre></div></div></div><div class="sect2 " id="sec.zypper.query"><div class="titlepage"><div><div><h3 class="title" id="sec.zypper.query"><span class="number">2.1.6 </span><span class="name">Querying Repositories and Packages with Zypper</span> <a title="Permalink" class="permalink" href="#sec.zypper.query">#</a></h3></div></div></div><p>
   Zypper offers various methods to query repositories or packages. To get
   lists of all products, patterns, packages or patches available, use the
   following commands:
  </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>zypper products
<code class="prompt user">tux &gt; </code>zypper patterns
<code class="prompt user">tux &gt; </code>zypper packages
<code class="prompt user">tux &gt; </code>zypper patches</pre></div><p>
   To query all repositories for certain packages, use
   <code class="literal">search</code>. To get information regarding particular packages,
   use the <code class="literal">info</code> command.
  </p><div class="sect3 " id="sec.zypper.query.search"><div class="titlepage"><div><div><h4 class="title" id="sec.zypper.query.search"><span class="number">2.1.6.1 </span><span class="name">Searching for Software</span> <a title="Permalink" class="permalink" href="#sec.zypper.query.search">#</a></h4></div></div></div><p>
    The <code class="command">zypper search</code> command works on package names, or,
    optionally, on package summaries and descriptions. Strings wrapped in
    <code class="literal">/</code> are interpreted as regular expressions. By default,
    the search is not case-sensitive.
   </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019142740688"><span class="term ">Simple search for a package name containing <code class="literal">fire</code>
     </span></dt><dd><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>zypper search "fire"</pre></div></dd><dt id="idm140019142738128"><span class="term ">Simple search for the exact package <code class="literal">MozillaFirefox</code>
     </span></dt><dd><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>zypper search --match-exact "MozillaFirefox"</pre></div></dd><dt id="idm140019142735552"><span class="term ">Also search in package descriptions and summaries</span></dt><dd><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>zypper search -d fire</pre></div></dd><dt id="idm140019142733440"><span class="term ">Only display packages not already installed</span></dt><dd><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>zypper search -u fire</pre></div></dd><dt id="idm140019142731328"><span class="term ">Display packages containing the string <code class="literal">fir</code> not
    followed be <code class="literal">e</code>
     </span></dt><dd><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>zypper se "/fir[^e]/"</pre></div></dd></dl></div></div><div class="sect3 " id="sec.zypper.query.what-provides"><div class="titlepage"><div><div><h4 class="title" id="sec.zypper.query.what-provides"><span class="number">2.1.6.2 </span><span class="name">Searching for Specific Capability</span> <a title="Permalink" class="permalink" href="#sec.zypper.query.what-provides">#</a></h4></div></div></div><p>
    To search for packages which provide a special capability, use the command
    <code class="literal">what-provides</code>. For example, if you want to know which
    package provides the Perl module <code class="literal">SVN::Core</code>, use the
    following command:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>zypper what-provides 'perl(SVN::Core)'</pre></div><p>
    The <code class="literal">what-provides
    <em class="replaceable ">PACKAGE_NAME</em></code> is similar to
    <code class="command">rpm -q --whatprovides</code>
    <em class="replaceable ">PACKAGE_NAME</em>, but RPM is only able to query the
    RPM database (that is the database of all installed packages). Zypper, on
    the other hand, will tell you about providers of the capability from any
    repository, not only those that are installed.
   </p></div><div class="sect3 " id="sec.zypper.query.info"><div class="titlepage"><div><div><h4 class="title" id="sec.zypper.query.info"><span class="number">2.1.6.3 </span><span class="name">Showing Package Information</span> <a title="Permalink" class="permalink" href="#sec.zypper.query.info">#</a></h4></div></div></div><p>
    To query single packages, use <code class="command">info</code> with an exact package
    name as an argument. This displays detailed information about a package. In
    case the package name does not match any package name from repositories,
    the command outputs detailed information for non-package matches. If you
    request a specific type (by using the <code class="literal">-t</code> option) and the
    type does not exist, the command outputs other available matches but
    without detailed information.
   </p><p>
    If you specify a source package, the command displays binary packages built
    from the source package. If you specify a binary package, the command
    outputs the source packages used to build the binary package.
   </p><p>
    To also show what is required/recommended by the package, use the options
    <code class="option">--requires</code> and <code class="option">--recommends</code>:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>zypper info --requires MozillaFirefox</pre></div></div></div><div class="sect2 " id="sec.zypper.lifecycle"><div class="titlepage"><div><div><h3 class="title" id="sec.zypper.lifecycle"><span class="number">2.1.7 </span><span class="name">Showing Life Cycle Information</span> <a title="Permalink" class="permalink" href="#sec.zypper.lifecycle">#</a></h3></div></div></div><p>
   SUSE products are generally supported for 10 years. Often, you
   can extend that standard life cycle by using the extended support
   offerings of SUSE which add 3 years of support.
   Depending on your product find the exact support life cycle at
   <a class="link" href="https://www.suse.com/lifecycle" target="_blank">https://www.suse.com/lifecycle</a>.
  </p><p>
   To check the lifecycle of your product and supported package, use the
   <code class="command">zypper lifecycle</code> command as shown below:
  </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code><code class="command">zypper lifecycle</code>
Product end of support
Codestream: SUSE Linux Enterprise Server 15             2028-04-23
    SUSE Linux Enterprise Server 15                     n/a*

Module end of support
Basesystem Module                                       2021-07-31

No packages with end of support different from product.

*) See https://www.suse.com/lifecycle for latest information</pre></div></div><div class="sect2 " id="sec.zypper.configure"><div class="titlepage"><div><div><h3 class="title" id="sec.zypper.configure"><span class="number">2.1.8 </span><span class="name">Configuring Zypper</span> <a title="Permalink" class="permalink" href="#sec.zypper.configure">#</a></h3></div></div></div><p>
   Zypper now comes with a configuration file, allowing you to permanently
   change Zypper's behavior (either system-wide or user-specific). For
   system-wide changes, edit <code class="filename">/etc/zypp/zypper.conf</code>. For
   user-specific changes, edit <code class="filename">~/.zypper.conf</code>. If
   <code class="filename">~/.zypper.conf</code> does not yet exist, you can use
   <code class="filename">/etc/zypp/zypper.conf</code> as a template: copy it to
   <code class="filename">~/.zypper.conf</code> and adjust it to your liking. Refer to
   the comments in the file for help about the available options.
  </p></div><div class="sect2 " id="sec.zypper.trouble"><div class="titlepage"><div><div><h3 class="title" id="sec.zypper.trouble"><span class="number">2.1.9 </span><span class="name">Troubleshooting</span> <a title="Permalink" class="permalink" href="#sec.zypper.trouble">#</a></h3></div></div></div><p>
   If you have trouble accessing packages from configured repositories
   (for example, Zypper cannot find a certain package even though you know it
   exists in one the repositories), refreshing the repositories may help:
  </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> zypper refresh</pre></div><p>
   If that does not help, try
  </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> zypper refresh -fdb</pre></div><p>
   This forces a complete refresh and rebuild of the database, including a
   forced download of raw metadata.
  </p></div><div class="sect2 " id="sec.zypper.rollback"><div class="titlepage"><div><div><h3 class="title" id="sec.zypper.rollback"><span class="number">2.1.10 </span><span class="name">Zypper Rollback Feature on Btrfs File System</span> <a title="Permalink" class="permalink" href="#sec.zypper.rollback">#</a></h3></div></div></div><p>
   If the Btrfs file system is used on the root partition and
   <code class="command">snapper</code> is installed, Zypper automatically calls
   <code class="command">snapper</code> when committing changes to the file system to
   create appropriate file system snapshots. These snapshots can be used to revert any changes made by Zypper. See <a class="xref" href="#cha.snapper" title="Chapter 3. System Recovery and Snapshot Management with Snapper">Chapter 3, <em>System Recovery and Snapshot Management with Snapper</em></a> for
   more information.
  </p></div><div class="sect2 " id="sec.zypper.more"><div class="titlepage"><div><div><h3 class="title" id="sec.zypper.more"><span class="number">2.1.11 </span><span class="name">For More Information</span> <a title="Permalink" class="permalink" href="#sec.zypper.more">#</a></h3></div></div></div><p>
   For more information on managing software from the command line, enter
   <code class="command">zypper help</code>, <code class="command">zypper help </code>
   <em class="replaceable ">COMMAND</em> or refer to the
   <code class="command">zypper(8)</code> man page. For a complete and detailed command
   reference, <code class="literal">cheat sheets</code> with the most important
   commands, and information on how to use Zypper in scripts and applications,
   refer to <a class="link" href="http://en.opensuse.org/SDB:Zypper_usage" target="_blank">http://en.opensuse.org/SDB:Zypper_usage</a>. A
   list of software changes for the latest <span class="productname"><span class="phrase">openSUSE Leap</span></span> version can be found
   at <a class="link" href="http://en.opensuse.org/openSUSE:Zypper versions" target="_blank">http://en.opensuse.org/openSUSE:Zypper versions</a>.
  </p></div></div><div class="sect1 " id="sec.rpm"><div class="titlepage"><div><div><h2 class="title" id="sec.rpm"><span class="number">2.2 </span><span class="name">RPM—the Package Manager</span> <a title="Permalink" class="permalink" href="#sec.rpm">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">Filename: </span>rpm.xml</li><li><span class="ds-label">ID: </span>sec.rpm</li></ul></div></div></div></div><p>
  RPM (RPM Package Manager) is used for managing software packages. Its main
  commands are <code class="command">rpm</code> and <code class="command">rpmbuild</code>. The
  powerful RPM database can be queried by the users, system administrators and
  package builders for detailed information about the installed software.
 </p><p>
  Essentially, <code class="command">rpm</code> has five modes: installing, uninstalling
  (or updating) software packages, rebuilding the RPM database, querying RPM
  bases or individual RPM archives, integrity checking of packages and signing
  packages. <code class="command">rpmbuild</code> can be used to build installable
  packages from pristine sources.
 </p><p>
  Installable RPM archives are packed in a special binary format. These
  archives consist of the program files to install and certain meta information
  used during the installation by <code class="command">rpm</code> to configure the
  software package or stored in the RPM database for documentation purposes.
  RPM archives normally have the extension <code class="filename">.rpm</code>.
 </p><div id="idm140019142682496" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.png" /><h6>Tip: Software Development Packages</h6><p>
   For several packages, the components needed for software development
   (libraries, headers, include files, etc.) have been put into separate
   packages. These development packages are only needed if you want to compile
   software yourself (for example, the most recent GNOME packages). They can
   be identified by the name extension <code class="literal">-devel</code>, such as the
   packages <code class="systemitem">alsa-devel</code> and
   <code class="systemitem">gimp-devel</code>.
  </p></div><div class="sect2 " id="sec.rpm.package_auth"><div class="titlepage"><div><div><h3 class="title" id="sec.rpm.package_auth"><span class="number">2.2.1 </span><span class="name">Verifying Package Authenticity</span> <a title="Permalink" class="permalink" href="#sec.rpm.package_auth">#</a></h3></div></div></div><p>
   RPM packages have a GPG signature. To verify the signature of an RPM
   package, use the command <code class="command">rpm --checksig </code>
   <em class="replaceable ">PACKAGE</em>-1.2.3.rpm to determine whether the
   package originates from SUSE or from another trustworthy facility. This is
   especially recommended for update packages from the Internet.
  </p></div><div class="sect2 " id="sec.rpm.packages_manage"><div class="titlepage"><div><div><h3 class="title" id="sec.rpm.packages_manage"><span class="number">2.2.2 </span><span class="name">Managing Packages: Install, Update, and Uninstall</span> <a title="Permalink" class="permalink" href="#sec.rpm.packages_manage">#</a></h3></div></div></div><p>
   Normally, the installation of an RPM archive is quite simple: <code class="command">rpm
   -i</code> <em class="replaceable ">PACKAGE</em>.rpm. With this command the
   package is installed, but only if its dependencies are fulfilled and if
   there are no conflicts with other packages. With an error message,
   <code class="command">rpm</code> requests those packages that need to be installed to
   meet dependency requirements. In the background, the RPM database ensures
   that no conflicts arise—a specific file can only belong to one
   package. By choosing different options, you can force <code class="command">rpm</code>
   to ignore these defaults, but this is only for experts. Otherwise, you risk
   compromising the integrity of the system and possibly jeopardize the ability
   to update the system.
  </p><p>
   The options <code class="option">-U</code> or <code class="option">--upgrade</code> and
   <code class="option">-F</code> or <code class="option">--freshen</code> can be used to update a
   package (for example, <code class="command">rpm -F</code>
   <em class="replaceable ">PACKAGE</em>.rpm). This command removes the files of
   the old version and immediately installs the new files. The difference
   between the two versions is that <code class="option">-U</code> installs packages that
   previously did not exist in the system, while <code class="option">-F</code> merely
   updates previously installed packages. When updating, <code class="command">rpm</code>
   updates configuration files carefully using the following strategy:
  </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
     If a configuration file was not changed by the system administrator,
     <code class="command">rpm</code> installs the new version of the appropriate file.
     No action by the system administrator is required.
    </p></li><li class="listitem "><p>
     If a configuration file was changed by the system administrator before the
     update, <code class="command">rpm</code> saves the changed file with the extension
     <code class="filename">.rpmorig</code> or <code class="filename">.rpmsave</code> (backup
     file) and installs the version from the new package. This is done only if
     the originally installed file and the newer version are different. If this is
     the case, compare the backup file (<code class="filename">.rpmorig</code> or
     <code class="filename">.rpmsave</code>) with the newly installed file and make your
     changes again in the new file. Afterward, delete all
     <code class="filename">.rpmorig</code> and <code class="filename">.rpmsave</code> files to
     avoid problems with future updates.
    </p></li><li class="listitem "><p>
     <code class="filename">.rpmnew</code> files appear if the configuration file
     already exists <span class="emphasis"><em>and</em></span> if the <code class="option">noreplace</code>
     label was specified in the <code class="filename">.spec</code> file.
    </p></li></ul></div><p>
   Following an update, <code class="filename">.rpmsave</code> and
   <code class="filename">.rpmnew</code> files should be removed after comparing them,
   so they do not obstruct future updates. The <code class="filename">.rpmorig</code>
   extension is assigned if the file has not previously been recognized by the
   RPM database.
  </p><p>
   Otherwise, <code class="filename">.rpmsave</code> is used. In other words,
   <code class="filename">.rpmorig</code> results from updating from a foreign format to
   RPM. <code class="filename">.rpmsave</code> results from updating from an older RPM
   to a newer RPM. <code class="filename">.rpmnew</code> does not disclose any
   information to whether the system administrator has made any changes to the
   configuration file. A list of these files is available in
   <code class="filename">/var/adm/rpmconfigcheck</code>. Some configuration files (like
   <code class="filename">/etc/httpd/httpd.conf</code>) are not overwritten to allow
   continued operation.
  </p><p>
   The <code class="option">-U</code> switch is <span class="emphasis"><em>not</em></span> just an
   equivalent to uninstalling with the <code class="option">-e</code> option and
   installing with the <code class="option">-i</code> option. Use <code class="option">-U</code>
   whenever possible.
  </p><p>
   To remove a package, enter <code class="command">rpm -e</code>
   <em class="replaceable ">PACKAGE</em>. This command only deletes the package if
   there are no unresolved dependencies. It is theoretically impossible to
   delete Tcl/Tk, for example, as long as another application requires it. Even
   in this case, RPM calls for assistance from the database. If such a deletion
   is, for whatever reason, impossible (even if <span class="emphasis"><em>no</em></span>
   additional dependencies exist), it may be helpful to rebuild the RPM
   database using the option <code class="option">--rebuilddb</code>.
  </p></div><div class="sect2 " id="sec.rpm.delta"><div class="titlepage"><div><div><h3 class="title" id="sec.rpm.delta"><span class="number">2.2.3 </span><span class="name">Delta RPM Packages</span> <a title="Permalink" class="permalink" href="#sec.rpm.delta">#</a></h3></div></div></div><p>
   Delta RPM packages contain the difference between an old and a new version
   of an RPM package. Applying a delta RPM onto an old RPM results in a
   completely new RPM. It is not necessary to have a copy of the old RPM
   because a delta RPM can also work with an installed RPM. The delta RPM
   packages are even smaller in size than patch RPMs, which is an advantage
   when transferring update packages over the Internet. The drawback is that
   update operations with delta RPMs involved consume considerably more CPU
   cycles than plain or patch RPMs.
  </p><p>
   The <code class="command">makedeltarpm</code> and <code class="command">applydelta</code>
   binaries are part of the delta RPM suite (package
   <code class="systemitem">deltarpm</code>) and help you create and apply delta RPM
   packages. With the following commands, you can create a delta RPM called
   <code class="filename">new.delta.rpm</code>. The following command assumes that
   <code class="filename">old.rpm</code> and <code class="filename">new.rpm</code> are present:
  </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> makedeltarpm old.rpm new.rpm new.delta.rpm</pre></div><p>
   Using <code class="command">applydeltarpm</code>, you can reconstruct the new RPM from
   the file system if the old package is already installed:
  </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> applydeltarpm new.delta.rpm new.rpm</pre></div><p>
   To derive it from the old RPM without accessing the file system, use the
   <code class="option">-r</code> option:
  </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> applydeltarpm -r old.rpm new.delta.rpm new.rpm</pre></div><p>
   See <code class="filename">/usr/share/doc/packages/deltarpm/README</code> for
   technical details.
  </p></div><div class="sect2 " id="sec.rpm.query"><div class="titlepage"><div><div><h3 class="title" id="sec.rpm.query"><span class="number">2.2.4 </span><span class="name">RPM Queries</span> <a title="Permalink" class="permalink" href="#sec.rpm.query">#</a></h3></div></div></div><p>
   With the <code class="option">-q</code> option <code class="command">rpm</code> initiates
   queries, making it possible to inspect an RPM archive (by adding the option
   <code class="option">-p</code>) and to query the RPM database of installed packages.
   Several switches are available to specify the type of information required.
   See <a class="xref" href="#tab.rpm.query" title="The Most Important RPM Query Options">Table 2.1, “The Most Important RPM Query Options”</a>.
  </p><div class="table" id="tab.rpm.query"><div class="table-title-wrap"><h6 class="table-title"><span class="number">Table 2.1: </span><span class="name">The Most Important RPM Query Options </span><a title="Permalink" class="permalink" href="#tab.rpm.query">#</a></h6></div><div class="table-contents"><table summary="The Most Important RPM Query Options" border="1"><colgroup><col /><col /></colgroup><tbody><tr><td>
       <p>
        <code class="option">-i</code>
       </p>
      </td><td>
       <p>
        Package information
       </p>
      </td></tr><tr><td>
       <p>
        <code class="option">-l</code>
       </p>
      </td><td>
       <p>
        File list
       </p>
      </td></tr><tr><td>
       <p>
        <code class="option">-f FILE</code>
       </p>
      </td><td>
       <p>
        Query the package that contains the file
        <em class="replaceable ">FILE</em> (the full path must be specified with
        <em class="replaceable ">FILE</em>)
       </p>
      </td></tr><tr><td>
       <p>
        <code class="option">-s</code>
       </p>
      </td><td>
       <p>
        File list with status information (implies <code class="option">-l</code>)
       </p>
      </td></tr><tr><td>
       <p>
        <code class="option">-d</code>
       </p>
      </td><td>
       <p>
        List only documentation files (implies <code class="literal">-l</code>)
       </p>
      </td></tr><tr><td>
       <p>
        <code class="option">-c</code>
       </p>
      </td><td>
       <p>
        List only configuration files (implies <code class="option">-l</code>)
       </p>
      </td></tr><tr><td>
       <p>
        <code class="option">--dump</code>
       </p>
      </td><td>
       <p>
        File list with complete details (to be used with <code class="option">-l</code>,
        <code class="option">-c</code>, or <code class="option">-d</code>)
       </p>
      </td></tr><tr><td>
       <p>
        <code class="option">--provides</code>
       </p>
      </td><td>
       <p>
        List features of the package that another package can request with
        <code class="option">--requires</code>
       </p>
      </td></tr><tr><td>
       <p>
        <code class="option">--requires</code>, <code class="option">-R</code>
       </p>
      </td><td>
       <p>
        Capabilities the package requires
       </p>
      </td></tr><tr><td>
       <p>
        <code class="option">--scripts</code>
       </p>
      </td><td>
       <p>
        Installation scripts (preinstall, postinstall, uninstall)
       </p>
      </td></tr></tbody></table></div></div><p>
   For example, the command <code class="command">rpm -q -i wget</code> displays the
   information shown in <a class="xref" href="#aus.update.rpm-i" title="rpm -q -i wget">Example 2.2, “<code class="command">rpm -q -i wget</code>”</a>.
  </p><div class="example" id="aus.update.rpm-i"><div class="example-title-wrap"><h6 class="example-title"><span class="number">Example 2.2: </span><span class="name"><code class="command">rpm -q -i wget</code> </span><a title="Permalink" class="permalink" href="#aus.update.rpm-i">#</a></h6></div><div class="example-contents"><div class="verbatim-wrap"><pre class="screen">Name        : wget
Version     : 1.14
Release     : 10.3
Architecture: x86_64
Install Date: Fri 14 Jul 2017 04:09:58 PM CEST
Group       : Productivity/Networking/Web/Utilities
Size        : 2046452
License     : GPL-3.0+
Signature   : RSA/SHA256, Wed 10 May 2017 02:40:21 AM CEST, Key ID b88b2fd43dbdc284
Source RPM  : wget-1.14-10.3.src.rpm
Build Date  : Wed 10 May 2017 02:40:12 AM CEST
Build Host  : lamb55
Relocations : (not relocatable)
Packager    : http://bugs.opensuse.org
Vendor      : openSUSE
URL         : http://www.gnu.org/software/wget/
Summary     : A Tool for Mirroring FTP and HTTP Servers
Description :
Wget enables you to retrieve WWW documents or FTP files from a server.
This can be done in script files or via the command line.
Distribution: openSUSE Leap 42.3</pre></div></div></div><p>
   The option <code class="option">-f</code> only works if you specify the complete file
   name with its full path. Provide as many file names as desired. For example:
  </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>rpm -q -f /bin/rpm /usr/bin/wget
rpm-4.11.2-15.1.x86_64
wget-1.14-17.1.x86_64</pre></div><p>
   If only part of the file name is known, use a shell script as shown in
   <a class="xref" href="#dat.rpm.search" title="Script to Search for Packages">Example 2.3, “Script to Search for Packages”</a>. Pass the partial file name to the script
   shown as a parameter when running it.
  </p><div class="example" id="dat.rpm.search"><div class="example-title-wrap"><h6 class="example-title"><span class="number">Example 2.3: </span><span class="name">Script to Search for Packages </span><a title="Permalink" class="permalink" href="#dat.rpm.search">#</a></h6></div><div class="example-contents"><div class="verbatim-wrap"><pre class="screen">#! /bin/sh
for i in $(rpm -q -a -l | grep $1); do
    echo "\"$i\" is in package:"
    rpm -q -f $i
    echo ""
done</pre></div></div></div><p>
   The command <code class="command">rpm -q --changelog</code>
   <em class="replaceable ">PACKAGE</em> displays a detailed list of change
   information about a specific package, sorted by date.
  </p><p>
   With the installed RPM database, verification checks can be made. Initiate
   these with <code class="option">-V</code>, or <code class="option">--verify</code>. With this
   option, <code class="command">rpm</code> shows all files in a package that have been
   changed since installation. <code class="command">rpm</code> uses eight character
   symbols to give some hints about the following changes:
  </p><div class="table" id="tab.rpm.verify"><div class="table-title-wrap"><h6 class="table-title"><span class="number">Table 2.2: </span><span class="name">RPM Verify Options </span><a title="Permalink" class="permalink" href="#tab.rpm.verify">#</a></h6></div><div class="table-contents"><table summary="RPM Verify Options" border="1"><colgroup><col /><col /></colgroup><tbody><tr><td>
       <p>
        <code class="option">5</code>
       </p>
      </td><td>
       <p>
        MD5 check sum
       </p>
      </td></tr><tr><td>
       <p>
        <code class="option">S</code>
       </p>
      </td><td>
       <p>
        File size
       </p>
      </td></tr><tr><td>
       <p>
        <code class="option">L</code>
       </p>
      </td><td>
       <p>
        Symbolic link
       </p>
      </td></tr><tr><td>
       <p>
        <code class="option">T</code>
       </p>
      </td><td>
       <p>
        Modification time
       </p>
      </td></tr><tr><td>
       <p>
        <code class="option">D</code>
       </p>
      </td><td>
       <p>
        Major and minor device numbers
       </p>
      </td></tr><tr><td>
       <p>
        <code class="option">U</code>
       </p>
      </td><td>
       <p>
        Owner
       </p>
      </td></tr><tr><td>
       <p>
        <code class="option">G</code>
       </p>
      </td><td>
       <p>
        Group
       </p>
      </td></tr><tr><td>
       <p>
        <code class="option">M</code>
       </p>
      </td><td>
       <p>
        Mode (permissions and file type)
       </p>
      </td></tr></tbody></table></div></div><p>
   In the case of configuration files, the letter <code class="option">c</code> is
   printed. For example, for changes to <code class="filename">/etc/wgetrc</code>
   (<code class="systemitem">wget</code> package):
  </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>rpm -V wget
S.5....T c /etc/wgetrc</pre></div><p>
   The files of the RPM database are placed in
   <code class="filename">/var/lib/rpm</code>. If the partition
   <code class="filename">/usr</code> has a size of 1 GB, this database can occupy
   nearly 30 MB, especially after a complete update. If the database is
   much larger than expected, it is useful to rebuild the database with the
   option <code class="option">--rebuilddb</code>. Before doing this, make a backup of the
   old database. The <code class="command">cron</code> script
   <code class="command">cron.daily</code> makes daily copies of the database (packed
   with gzip) and stores them in <code class="filename">/var/adm/backup/rpmdb</code>.
   The number of copies is controlled by the variable
   <code class="systemitem">MAX_RPMDB_BACKUPS</code> (default: <code class="option">5</code>) in
   <code class="filename">/etc/sysconfig/backup</code>. The size of a single backup is
   approximately 1 MB for 1 GB in <code class="filename">/usr</code>.
  </p></div><div class="sect2 " id="sec.rpm.sources"><div class="titlepage"><div><div><h3 class="title" id="sec.rpm.sources"><span class="number">2.2.5 </span><span class="name">Installing and Compiling Source Packages</span> <a title="Permalink" class="permalink" href="#sec.rpm.sources">#</a></h3></div></div></div><p>
   All source packages carry a <code class="filename">.src.rpm</code> extension (source
   RPM).
  </p><div id="idm140019142548848" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note: Installed Source Packages</h6><p>
    Source packages can be copied from the installation medium to the hard disk
    and unpacked with YaST. They are not, however, marked as installed
    (<code class="literal">[i]</code>) in the package manager. This is because the source
    packages are not entered in the RPM database. Only
    <span class="emphasis"><em>installed</em></span> operating system software is listed in the
    RPM database. When you <span class="quote">“<span class="quote">install</span>”</span> a source package, only the
    source code is added to the system.
   </p></div><p>
   The following directories must be available for <code class="command">rpm</code> and
   <code class="command">rpmbuild</code> in <code class="filename">/usr/src/packages</code>
   (unless you specified custom settings in a file like
   <code class="filename">/etc/rpmrc</code>):
  </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019142543200"><span class="term "><code class="filename">SOURCES</code>
    </span></dt><dd><p>
      for the original sources (<code class="filename">.tar.bz2</code> or
      <code class="filename">.tar.gz</code> files, etc.) and for distribution-specific
      adjustments (mostly <code class="filename">.diff</code> or
      <code class="filename">.patch</code> files)
     </p></dd><dt id="idm140019142539264"><span class="term "><code class="filename">SPECS</code>
    </span></dt><dd><p>
      for the <code class="filename">.spec</code> files, similar to a meta Makefile,
      which control the <span class="emphasis"><em>build</em></span> process
     </p></dd><dt id="idm140019142536240"><span class="term "><code class="filename">BUILD</code>
    </span></dt><dd><p>
      all the sources are unpacked, patched and compiled in this directory
     </p></dd><dt id="idm140019142534096"><span class="term "><code class="filename">RPMS</code>
    </span></dt><dd><p>
      where the completed binary packages are stored
     </p></dd><dt id="idm140019142531968"><span class="term "><code class="filename">SRPMS</code>
    </span></dt><dd><p>
      here are the source RPMs
     </p></dd></dl></div><p>
   When you install a source package with YaST, all the necessary components
   are installed in <code class="filename">/usr/src/packages</code>: the sources and the
   adjustments in <code class="filename">SOURCES</code> and the relevant
   <code class="filename">.spec</code> file in <code class="filename">SPECS</code>.
  </p><div id="idm140019142527360" class="admonition warning normal"><img class="symbol" alt="Warning" title="Warning" src="static/images/icon-warning.png" /><h6>Warning: System Integrity</h6><p>
    Do not experiment with system components
    (<code class="systemitem">glibc</code>,
    <code class="systemitem">rpm</code>, etc.), because this
    endangers the stability of your system.
   </p></div><p>
   The following example uses the <code class="filename">wget.src.rpm</code> package.
   After installing the source package, you should have files similar to those
   in the following list:
  </p><div class="verbatim-wrap"><pre class="screen">/usr/src/packages/SOURCES/wget-1.11.4.tar.bz2
/usr/src/packages/SOURCES/wgetrc.patch
/usr/src/packages/SPECS/wget.spec</pre></div><p>
   <code class="command">rpmbuild</code> <code class="option">-b<em class="replaceable ">X</em></code>
   <code class="filename">/usr/src/packages/SPECS/wget.spec</code> starts the
   compilation. <em class="replaceable ">X</em> is a wild card for various stages
   of the build process (see the output of <code class="option">--help</code> or the RPM
   documentation for details). The following is merely a brief explanation:
  </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019142519504"><span class="term "><code class="option">-bp</code>
    </span></dt><dd><p>
      Prepare sources in <code class="filename">/usr/src/packages/BUILD</code>: unpack
      and patch.
     </p></dd><dt id="idm140019142516944"><span class="term "><code class="option">-bc</code>
    </span></dt><dd><p>
      Do the same as <code class="option">-bp</code>, but with additional compilation.
     </p></dd><dt id="idm140019142514384"><span class="term "><code class="option">-bi</code>
    </span></dt><dd><p>
      Do the same as <code class="option">-bp</code>, but with additional installation of
      the built software. Caution: if the package does not support the
      BuildRoot feature, you might overwrite configuration files.
     </p></dd><dt id="idm140019142511696"><span class="term "><code class="option">-bb</code>
    </span></dt><dd><p>
      Do the same as <code class="option">-bi</code>, but with the additional creation of
      the binary package. If the compile was successful, the binary should be
      in <code class="filename">/usr/src/packages/RPMS</code>.
     </p></dd><dt id="idm140019142508608"><span class="term "><code class="option">-ba</code>
    </span></dt><dd><p>
      Do the same as <code class="option">-bb</code>, but with the additional creation of
      the source RPM. If the compilation was successful, the binary should be
      in <code class="filename">/usr/src/packages/SRPMS</code>.
     </p></dd><dt id="idm140019142505520"><span class="term "><code class="option">--short-circuit</code>
    </span></dt><dd><p>
      Skip some steps.
     </p></dd></dl></div><p>
   The binary RPM created can now be installed with <code class="command">rpm</code>
   <code class="option">-i</code> or, preferably, with <code class="command">rpm</code>
   <code class="option">-U</code>. Installation with <code class="command">rpm</code> makes it
   appear in the RPM database.
  </p><p>
   Keep in mind, the <code class="literal">BuildRoot</code> directive in the spec file is
   deprecated since <span class="productname"><span class="phrase">openSUSE Leap</span></span> <span class="phrase">42.1</span>. If you still need this feature, use the
   <code class="option">--buildroot</code> option as a workaround.
  </p></div><div class="sect2 " id="sec.rpm.build"><div class="titlepage"><div><div><h3 class="title" id="sec.rpm.build"><span class="number">2.2.6 </span><span class="name">Compiling RPM Packages with build</span> <a title="Permalink" class="permalink" href="#sec.rpm.build">#</a></h3></div></div></div><p>
   The danger with many packages is that unwanted files are added to the
   running system during the build process. To prevent this use
   <code class="systemitem">build</code>, which creates a defined environment in which
   the package is built. To establish this chroot environment, the
   <code class="command">build</code> script must be provided with a complete package
   tree. This tree can be made available on the hard disk, via NFS, or from
   DVD. Set the position with <code class="command">build --rpms</code>
   <em class="replaceable ">DIRECTORY</em>. Unlike <code class="command">rpm</code>, the
   <code class="command">build</code> command looks for the <code class="filename">.spec</code>
   file in the source directory. To build <code class="filename">wget</code> (like in
   the above example) with the DVD mounted in the system under
   <code class="filename">/media/dvd</code>, use the following commands as
   <code class="systemitem">root</code>:
  </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>cd /usr/src/packages/SOURCES/
<code class="prompt root">root # </code>mv ../SPECS/wget.spec .
<code class="prompt root">root # </code>build --rpms /media/dvd/suse/ wget.spec</pre></div><p>
   Subsequently, a minimum environment is established at
   <code class="filename">/var/tmp/build-root</code>. The package is built in this
   environment. Upon completion, the resulting packages are located in
   <code class="filename">/var/tmp/build-root/usr/src/packages/RPMS</code>.
  </p><p>
   The <code class="command">build</code> script offers several additional options. For
   example, cause the script to prefer your own RPMs, omit the initialization
   of the build environment or limit the <code class="command">rpm</code> command to one
   of the above-mentioned stages. Access additional information with
   <code class="command">build</code> <code class="option">--help</code> and by reading the
   <code class="command">build</code> man page.
  </p></div><div class="sect2 " id="sec.rpm.tools"><div class="titlepage"><div><div><h3 class="title" id="sec.rpm.tools"><span class="number">2.2.7 </span><span class="name">Tools for RPM Archives and the RPM Database</span> <a title="Permalink" class="permalink" href="#sec.rpm.tools">#</a></h3></div></div></div><p>
   Midnight Commander (<code class="command">mc</code>) can display the contents of RPM
   archives and copy parts of them. It represents archives as virtual file
   systems, offering all usual menu options of Midnight Commander. Display the
   <code class="filename">HEADER</code> with <span class="keycap">F3</span>. View the archive
   structure with the cursor keys and <span class="keycap">Enter</span>. Copy archive
   components with <span class="keycap">F5</span>.
  </p><p>
   A full-featured package manager is available as a YaST module. For
   details, see <span class="intraxref">Book “<em class="citetitle ">Start-Up</em>”, Chapter 11 “Installing or Removing Software”</span>.
  </p></div></div></div><div class="chapter " id="cha.snapper"><div class="titlepage"><div><div><h2 class="title"><span class="number">3 </span><span class="name">System Recovery and Snapshot Management with Snapper</span> <a title="Permalink" class="permalink" href="#cha.snapper">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">Filename: </span>snapper.xml</li><li><span class="ds-label">ID: </span>cha.snapper</li></ul></div></div><div><div class="abstract"><div class="abstract-title-wrap"><h6 class="abstract-title">Abstract<a title="Permalink" class="permalink" href="#idm140019142473184">#</a></h6></div><p>
    Being able to do file system snapshots providing the ability to do
    rollbacks on Linux is a feature that was often requested in the past.
    Snapper, with the <code class="literal">Btrfs</code> file system or thin-provisioned
    LVM volumes now fills that gap.
   </p><p>
    <code class="literal">Btrfs</code>, a new copy-on-write file system for Linux,
    supports file system snapshots (a copy of the state of a subvolume at a
    certain point of time) of subvolumes (one or more separately mountable file
    systems within each physical partition). Snapshots are also supported on
    thin-provisioned LVM volumes formatted with XFS, Ext4 or Ext3. Snapper lets
    you create and manage these snapshots. It comes with a command line and a
    YaST interface. Starting with <span class="phrase">openSUSE Leap</span> it is also possible
    to boot from <code class="literal">Btrfs</code> snapshots—see <a class="xref" href="#sec.snapper.snapshot-boot" title="3.3. System Rollback by Booting from Snapshots">Section 3.3, “System Rollback by Booting from Snapshots”</a> for more information.
   </p></div></div></div></div><div class="line"><div class="toc"><dl><dt><span class="sect1"><a href="#sec.snapper.setup"><span class="number">3.1 </span><span class="name">Default Setup</span></a></span></dt><dt><span class="sect1"><a href="#sec.snapper.undo"><span class="number">3.2 </span><span class="name">Using Snapper to Undo Changes</span></a></span></dt><dt><span class="sect1"><a href="#sec.snapper.snapshot-boot"><span class="number">3.3 </span><span class="name">System Rollback by Booting from Snapshots</span></a></span></dt><dt><span class="sect1"><a href="#sec.snapper.config"><span class="number">3.4 </span><span class="name">Creating and Modifying Snapper Configurations</span></a></span></dt><dt><span class="sect1"><a href="#sec.snapper.manage"><span class="number">3.5 </span><span class="name">Manually Creating and Managing Snapshots</span></a></span></dt><dt><span class="sect1"><a href="#sec.snapper.clean-up"><span class="number">3.6 </span><span class="name">Automatic Snapshot Clean-Up</span></a></span></dt><dt><span class="sect1"><a href="#sec.snapper.faqs"><span class="number">3.7 </span><span class="name">Frequently Asked Questions</span></a></span></dt></dl></div></div><p>
  Using Snapper you can perform the following tasks:
 </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
    Undo system changes made by <code class="command">zypper</code> and YaST. See
    <a class="xref" href="#sec.snapper.undo" title="3.2. Using Snapper to Undo Changes">Section 3.2, “Using Snapper to Undo Changes”</a> for details.
   </p></li><li class="listitem "><p>
    Restore files from previous snapshots. See
    <a class="xref" href="#sec.snapper.undo.delete_file" title="3.2.2. Using Snapper to Restore Files">Section 3.2.2, “Using Snapper to Restore Files”</a> for details.
   </p></li><li class="listitem "><p>
    Do a system rollback by booting from a snapshot. See
    <a class="xref" href="#sec.snapper.snapshot-boot" title="3.3. System Rollback by Booting from Snapshots">Section 3.3, “System Rollback by Booting from Snapshots”</a> for details.
   </p></li><li class="listitem "><p>
    Manually create snapshots on the fly and manage existing snapshots. See
    <a class="xref" href="#sec.snapper.manage" title="3.5. Manually Creating and Managing Snapshots">Section 3.5, “Manually Creating and Managing Snapshots”</a> for details.
   </p></li></ul></div><div class="sect1 " id="sec.snapper.setup"><div class="titlepage"><div><div><h2 class="title" id="sec.snapper.setup"><span class="number">3.1 </span><span class="name">Default Setup</span> <a title="Permalink" class="permalink" href="#sec.snapper.setup">#</a></h2></div></div></div><p>
   Snapper on <span class="productname"><span class="phrase">openSUSE Leap</span></span> is set up to serve as an <span class="quote">“<span class="quote">undo and recovery
   tool</span>”</span> for system changes. By default, the root partition
   (<code class="filename">/</code>) of <span class="productname"><span class="phrase">openSUSE Leap</span></span> is formatted with
   <code class="literal">Btrfs</code>. Taking snapshots is automatically enabled if the
   root partition (<code class="filename">/</code>) is big enough (approximately more
   than 16 GB). Taking snapshots on partitions other than
   <code class="filename">/</code> is not enabled by default.
  </p><div id="idm140019142454080" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.png" /><h6>Tip: Enabling Snapper in the Installed System</h6><p>
    If you disabled Snapper during the installation, you can enable it at
    any time later. To do so, create a default Snapper configuration for the
    root file system by running
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> snapper -c root create-config /</pre></div><p>
    Afterward enable the different snapshot types as described in <a class="xref" href="#sec.snapper.setup.customize.auto_snapshots" title="3.1.3.1. Disabling/Enabling Snapshots">Section 3.1.3.1, “Disabling/Enabling Snapshots”</a>.
   </p><p>
    Keep in mind that snapshots require a Btrfs root file system with
    subvolumes set up as proposed by the installer and a partition size of at
    least 16 GB.
   </p></div><p>
   When a snapshot is created, both the snapshot and the original point to the
   same blocks in the file system. So, initially a snapshot does not occupy
   additional disk space. If data in the original file system is modified,
   changed data blocks are copied while the old data blocks are kept for the
   snapshot. Therefore, a snapshot occupies the same amount of space as the
   data modified. So, over time, the amount of space a snapshot allocates,
   constantly grows. As a consequence, deleting files from a
   <code class="literal">Btrfs</code> file system containing snapshots may
   <span class="emphasis"><em>not</em></span> free disk space!
  </p><div id="idm140019142447904" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note: Snapshot Location</h6><p>
    Snapshots always reside on the same partition or subvolume on which the
    snapshot has been taken. It is not possible to store snapshots on a
    different partition or subvolume.
   </p></div><p>
   As a result, partitions containing snapshots need to be larger than
   <span class="quote">“<span class="quote">normal</span>”</span> partitions. The exact amount strongly depends on the
   number of snapshots you keep and the amount of data modifications. As a rule
   of thumb you should consider using twice the size than you normally would.
   To prevent disks from running out of space, old snapshots are automatically
   cleaned up. Refer to
   <a class="xref" href="#sec.snapper.setup.customize.archiving" title="3.1.3.4. Controlling Snapshot Archiving">Section 3.1.3.4, “Controlling Snapshot Archiving”</a> for details.
  </p><div class="sect2 " id="snapper.snapshot-type"><div class="titlepage"><div><div><h3 class="title" id="snapper.snapshot-type"><span class="number">3.1.1 </span><span class="name">Types of Snapshots</span> <a title="Permalink" class="permalink" href="#snapper.snapshot-type">#</a></h3></div></div></div><p>
    Although snapshots themselves do not differ in a technical sense, we
    distinguish between three types of snapshots, based on the events that trigger them:
   </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019142442496"><span class="term ">Timeline Snapshots</span></dt><dd><p>
       A single snapshot is created every hour. Old snapshots are automatically
       deleted. By default, the first snapshot of the last ten days, months,
       and years are kept. Timeline snapshots are disabled by default.
      </p></dd><dt id="idm140019142440480"><span class="term ">Installation Snapshots</span></dt><dd><p>
       Whenever one or more packages are installed with YaST or Zypper, a
       pair of snapshots is created: one before the installation starts
       (<span class="quote">“<span class="quote">Pre</span>”</span>) and another one after the installation has finished
       (<span class="quote">“<span class="quote">Post</span>”</span>). In case an important system component such as the
       kernel has been installed, the snapshot pair is marked as important
       (<code class="literal">important=yes</code>). Old snapshots are automatically
       deleted. By default the last ten important snapshots and the last ten
       <span class="quote">“<span class="quote">regular</span>”</span> (including administration snapshots) snapshots
       are kept. Installation snapshots are enabled by default.
      </p></dd><dt id="idm140019142436384"><span class="term ">Administration Snapshots</span></dt><dd><p>
       Whenever you administrate the system with YaST, a pair of snapshots is
       created: one when a YaST module is started (<span class="quote">“<span class="quote">Pre</span>”</span>) and
       another when the module is closed (<span class="quote">“<span class="quote">Post</span>”</span>). Old snapshots
       are automatically deleted. By default the last ten important snapshots
       and the last ten <span class="quote">“<span class="quote">regular</span>”</span> snapshots (including
       installation snapshots) are kept. Administration snapshots are enabled
       by default.
      </p></dd></dl></div></div><div class="sect2 " id="snapper.dir-excludes"><div class="titlepage"><div><div><h3 class="title" id="snapper.dir-excludes"><span class="number">3.1.2 </span><span class="name">Directories That Are Excluded from Snapshots</span> <a title="Permalink" class="permalink" href="#snapper.dir-excludes">#</a></h3></div></div></div><p>
    Some directories need to be excluded from snapshots for different reasons.
    The following list shows all directories that are excluded:
   </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019142427648"><span class="term "><code class="filename">/boot/grub2/i386-pc</code>,
   <code class="filename">/boot/grub2/x86_64-efi</code>,
   <code class="filename">/boot/grub2/powerpc-ieee1275</code>,
   <code class="filename">/boot/grub2/s390x-emu</code>
  </span></dt><dd><p>
    A rollback of the boot loader configuration is not supported. The
    directories listed above are architecture-specific. The first two
    directories are present on AMD64/Intel 64 machines, the latter two on IBM
    POWER and on IBM Z, respectively.
   </p></dd><dt id="idm140019142423968"><span class="term "><code class="filename">/home</code>
  </span></dt><dd><p>
    If <code class="filename">/home</code> does not reside on a separate partition, it
    is excluded to avoid data loss on rollbacks.
   </p></dd><dt id="idm140019142421360"><span class="term "><code class="filename">/opt</code>, <code class="filename">/var/opt</code>
  </span></dt><dd><p>
    Third-party products usually get installed to <code class="filename">/opt</code>. It
    is excluded to avoid uninstalling these applications on rollbacks.
   </p></dd><dt id="idm140019142418288"><span class="term "><code class="filename">/srv</code>
  </span></dt><dd><p>
    Contains data for Web and FTP servers. It is excluded to avoid data loss on
    rollbacks.
   </p></dd><dt id="idm140019142416128"><span class="term "><code class="filename">/tmp</code>, <code class="filename">/var/tmp</code>,
   <code class="filename">/var/cache</code>, <code class="filename">/var/crash</code>
  </span></dt><dd><p>
    All directories containing temporary files and caches are excluded from
    snapshots.
   </p></dd><dt id="idm140019142412624"><span class="term "><code class="filename">/usr/local</code>
  </span></dt><dd><p>
    This directory is used when manually installing software. It is excluded to
    avoid uninstalling these installations on rollbacks.
   </p></dd><dt id="idm140019142410416"><span class="term "><code class="filename">/var/lib/libvirt/images</code>
  </span></dt><dd><p>
    The default location for virtual machine images managed with libvirt.
    Excluded to ensure virtual machine images are not replaced with older
    versions during a rollback. By default, this subvolume is created with the
    option <code class="literal">no copy on write</code>.
   </p></dd><dt id="idm140019142407664"><span class="term "><code class="filename">/var/lib/mailman</code>, <code class="filename">/var/spool</code>
  </span></dt><dd><p>
    Directories containing mails or mail queues are excluded to avoid a loss of
    mails after a rollback.
   </p></dd><dt id="idm140019142405040"><span class="term "><code class="filename">/var/lib/named</code>
  </span></dt><dd><p>
    Contains zone data for the DNS server. Excluded from snapshots to ensure a
    name server can operate after a rollback.
   </p></dd><dt id="idm140019142402848"><span class="term "><code class="filename">/var/lib/mariadb</code>,
   <code class="filename">/var/lib/mysql</code>, <code class="filename">/var/lib/pgqsl</code>
  </span></dt><dd><p>
    These directories contain database data. By default, these subvolumes are
    created with the option <code class="literal">no copy on write</code>.
   </p></dd><dt id="idm140019142399328"><span class="term "><code class="filename">/var/log</code>
  </span></dt><dd><p>
    Log file location. Excluded from snapshots to allow log file analysis after
    the rollback of a broken system.
   </p></dd></dl></div></div><div class="sect2 " id="sec.snapper.setup.customize"><div class="titlepage"><div><div><h3 class="title" id="sec.snapper.setup.customize"><span class="number">3.1.3 </span><span class="name">Customizing the Setup</span> <a title="Permalink" class="permalink" href="#sec.snapper.setup.customize">#</a></h3></div></div></div><p>
    <span class="productname"><span class="phrase">openSUSE Leap</span></span> comes with a reasonable default setup, which should be
    sufficient for most use cases. However, all aspects of taking automatic
    snapshots and snapshot keeping can be configured according to your needs.
   </p><div class="sect3 " id="sec.snapper.setup.customize.auto_snapshots"><div class="titlepage"><div><div><h4 class="title" id="sec.snapper.setup.customize.auto_snapshots"><span class="number">3.1.3.1 </span><span class="name">Disabling/Enabling Snapshots</span> <a title="Permalink" class="permalink" href="#sec.snapper.setup.customize.auto_snapshots">#</a></h4></div></div></div><p>
     Each of the three snapshot types (timeline, installation, administration)
     can be enabled or disabled independently.
    </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019142391568"><span class="term ">Disabling/Enabling Timeline Snapshots</span></dt><dd><p><span class="formalpara-title">Enabling. </span>
         <code class="command">snapper -c root set-config "TIMELINE_CREATE=yes"</code>
        </p><p><span class="formalpara-title">Disabling. </span>
         <code class="command">snapper -c root set-config "TIMELINE_CREATE=no"</code>
        </p><p>
        Timeline snapshots are enabled by default, except for the root
        partition.
       </p></dd><dt id="idm140019142386096"><span class="term ">Disabling/Enabling Installation Snapshots</span></dt><dd><p><span class="formalpara-title">Enabling: </span>
         Install the package
         <code class="systemitem">snapper-zypp-plugin</code>
        </p><p><span class="formalpara-title">Disabling: </span>
         Uninstall the package
         <code class="systemitem">snapper-zypp-plugin</code>
        </p><p>
        Installation snapshots are enabled by default.
       </p></dd><dt id="idm140019142380048"><span class="term ">Disabling/Enabling Administration Snapshots</span></dt><dd><p><span class="formalpara-title">Enabling: </span>
         Set <code class="envar">USE_SNAPPER</code> to <code class="literal">yes</code> in
         <code class="filename">/etc/sysconfig/yast2</code>.
        </p><p><span class="formalpara-title">Disabling: </span>
         Set <code class="envar">USE_SNAPPER</code> to <code class="literal">no</code> in
         <code class="filename">/etc/sysconfig/yast2</code>.
        </p><p>
        Administration snapshots are enabled by default.
       </p></dd></dl></div></div><div class="sect3 " id="sec.snapper.setup.customize.inst_snapshots"><div class="titlepage"><div><div><h4 class="title" id="sec.snapper.setup.customize.inst_snapshots"><span class="number">3.1.3.2 </span><span class="name">Controlling Installation Snapshots</span> <a title="Permalink" class="permalink" href="#sec.snapper.setup.customize.inst_snapshots">#</a></h4></div></div></div><p>
     Taking snapshot pairs upon installing packages with YaST or Zypper is
     handled by the
     <code class="systemitem">snapper-zypp-plugin</code>. An XML
     configuration file, <code class="filename">/etc/snapper/zypp-plugin.conf</code>
     defines, when to make snapshots. By default the file looks like the
     following:
    </p><div class="verbatim-wrap"><pre class="screen"> 1 &lt;?xml version="1.0" encoding="utf-8"?&gt;
 2 &lt;snapper-zypp-plugin-conf&gt;
 3  &lt;solvables&gt;
 4   &lt;solvable match="w"<span id="zypp-conf.match"></span><span class="callout">1</span> important="true"<span id="zypp-conf.important"></span><span class="callout">2</span>&gt;kernel-*<span id="zypp-conf.kernel"></span><span class="callout">3</span>&lt;/solvable&gt;
 5   &lt;solvable match="w" important="true"&gt;dracut&lt;/solvable&gt;
 6   &lt;solvable match="w" important="true"&gt;glibc&lt;/solvable&gt;
 7   &lt;solvable match="w" important="true"&gt;systemd*&lt;/solvable&gt;
 8   &lt;solvable match="w" important="true"&gt;udev&lt;/solvable&gt;
 9   &lt;solvable match="w"&gt;*&lt;/solvable&gt;<span id="zypp-conf.packages"></span><span class="callout">4</span>
10  &lt;/solvables&gt;
11 &lt;/snapper-zypp-plugin-conf&gt;</pre></div><div class="calloutlist "><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#zypp-conf.match"><span class="callout">1</span></a> </p></td><td valign="top" align="left"><p>
       The match attribute defines whether the pattern is a Unix shell-style
       wild card (<code class="literal">w</code>) or a Python regular expression
       (<code class="literal">re</code>).
      </p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#zypp-conf.important"><span class="callout">2</span></a> </p></td><td valign="top" align="left"><p>
       If the given pattern matches and the corresponding package is marked as
       important (for example kernel packages), the snapshot will also be
       marked as important.
      </p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#zypp-conf.kernel"><span class="callout">3</span></a> </p></td><td valign="top" align="left"><p>
       Pattern to match a package name. Based on the setting of the
       <code class="literal">match</code> attribute, special characters are either
       interpreted as shell wild cards or regular expressions. This pattern
       matches all package names starting with <code class="literal">kernel-</code>.
      </p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#zypp-conf.packages"><span class="callout">4</span></a> </p></td><td valign="top" align="left"><p>
       This line unconditionally matches all packages.
      </p></td></tr></table></div><p>
     With this configuration snapshot, pairs are made whenever a package is
     installed (line 9). When the kernel, dracut, glibc, systemd, or udev packages
     marked as important are installed, the snapshot pair will also be marked
     as important (lines 4 to 8). All rules are evaluated.
    </p><p>
     To disable a rule, either delete it or deactivate it using XML comments.
     To prevent the system from making snapshot pairs for every package
     installation for example, comment line 9:
    </p><div class="verbatim-wrap"><pre class="screen"> 1 &lt;?xml version="1.0" encoding="utf-8"?&gt;
 2 &lt;snapper-zypp-plugin-conf&gt;
 3  &lt;solvables&gt;
 4   &lt;solvable match="w" important="true"&gt;kernel-*&lt;/solvable&gt;
 5   &lt;solvable match="w" important="true"&gt;dracut&lt;/solvable&gt;
 6   &lt;solvable match="w" important="true"&gt;glibc&lt;/solvable&gt;
 7   &lt;solvable match="w" important="true"&gt;systemd*&lt;/solvable&gt;
 8   &lt;solvable match="w" important="true"&gt;udev&lt;/solvable&gt;
 9   &lt;!-- &lt;solvable match="w"&gt;*&lt;/solvable&gt; --&gt;
10  &lt;/solvables&gt;
11 &lt;/snapper-zypp-plugin-conf&gt;</pre></div></div><div class="sect3 " id="sec.snapper.setup.customizing.new_subvolume"><div class="titlepage"><div><div><h4 class="title" id="sec.snapper.setup.customizing.new_subvolume"><span class="number">3.1.3.3 </span><span class="name">Creating and Mounting New Subvolumes</span> <a title="Permalink" class="permalink" href="#sec.snapper.setup.customizing.new_subvolume">#</a></h4></div></div></div><p>
     Creating a new subvolume underneath the <code class="filename">/</code> hierarchy
     and permanently mounting it is supported. Such a subvolume will be
     excluded from snapshots. You need to make sure not to create it inside an
     existing snapshot, since you would not be able to delete snapshots anymore
     after a rollback.
    </p><p>
     <span class="productname"><span class="phrase">openSUSE Leap</span></span> is configured with the <code class="filename">/@/</code> subvolume
     which serves as an independent root for permanent subvolumes such as
     <code class="filename">/opt</code>, <code class="filename">/srv</code>,
     <code class="filename">/home</code> and others. Any new subvolumes you create and
     permanently mount need to be created in this initial root file system.
    </p><p>
     To do so, run the following commands. In this example, a new subvolume
     <code class="filename">/usr/important</code> is created from
     <code class="filename">/dev/sda2</code>.
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> mount /dev/sda2 -o subvol=@ /mnt
<code class="prompt user">tux &gt; </code><code class="command">sudo</code> btrfs subvolume create /mnt/usr/important
<code class="prompt user">tux &gt; </code><code class="command">sudo</code> umount /mnt</pre></div><p>
     The corresponding entry in <code class="filename">/etc/fstab</code> needs to look
     like the following:
    </p><div class="verbatim-wrap"><pre class="screen">/dev/sda2 /usr/important btrfs subvol=@/usr/important 0 0</pre></div><div id="idm140019142344592" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.png" /><h6>Tip: Disable Copy-On-Write (cow)</h6><p>
      A subvolume may contain files that constantly change, such as
      virtualized disk images, database files, or log files. If so, consider
      disabling the copy-on-write feature for this volume, to avoid duplication
      of disk blocks. Use the <code class="option">nodatacow</code> mount option in
      <code class="filename">/etc/fstab</code> to do so:
     </p><div class="verbatim-wrap"><pre class="screen">/dev/sda2 /usr/important btrfs nodatacow,subvol=@/usr/important 0 0</pre></div><p>
      To alternatively disable copy-on-write for single files or directories,
      use the command <code class="command">chattr +C
      <em class="replaceable ">PATH</em></code>.
     </p></div></div><div class="sect3 " id="sec.snapper.setup.customize.archiving"><div class="titlepage"><div><div><h4 class="title" id="sec.snapper.setup.customize.archiving"><span class="number">3.1.3.4 </span><span class="name">Controlling Snapshot Archiving</span> <a title="Permalink" class="permalink" href="#sec.snapper.setup.customize.archiving">#</a></h4></div></div></div><p>
     Snapshots occupy disk space. To prevent disks from running out of space
     and thus causing system outages, old snapshots are automatically deleted.
     By default, up to ten important installation and administration snapshots
     and up to ten regular installation and administration snapshots are kept.
     If these snapshots occupy more than 50% of the root file system size,
     additional snapshots will be deleted. A minimum of four important and two
     regular snapshots are always kept.
    </p><p>
     Refer to <a class="xref" href="#sec.snapper.config.modify" title="3.4.1. Managing Existing Configurations">Section 3.4.1, “Managing Existing Configurations”</a> for instructions on
     how to change these values.
    </p></div><div class="sect3 " id="sec.snapper.lvm"><div class="titlepage"><div><div><h4 class="title" id="sec.snapper.lvm"><span class="number">3.1.3.5 </span><span class="name">Using Snapper on Thin-Provisioned LVM Volumes</span> <a title="Permalink" class="permalink" href="#sec.snapper.lvm">#</a></h4></div></div></div><p>
     Apart from snapshots on <code class="literal">Btrfs</code> file systems, Snapper
     also supports taking snapshots on thin-provisioned LVM volumes (snapshots
     on regular LVM volumes are <span class="emphasis"><em>not</em></span> supported) formatted
     with XFS, Ext4 or Ext3. For more information and setup instructions on LVM
     volumes, refer to <a class="xref" href="#sec.yast.system.lvm" title="5.2. LVM Configuration">Section 5.2, “LVM Configuration”</a>.
    </p><p>
     To use Snapper on a thin-provisioned LVM volume you need to create a
     Snapper configuration for it. On LVM it is required to specify the file
     system with
     <code class="option">--fstype=lvm(<em class="replaceable ">FILESYSTEM</em>)</code>.
     <code class="literal">ext3</code>, <code class="literal">etx4</code> or <code class="literal">xfs</code>
     are valid values for <em class="replaceable ">FILESYSTEM</em>. Example:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> snapper -c lvm create-config --fstype="lvm(xfs)" /thin_lvm</pre></div><p>
     You can adjust this configuration according to your needs as described in
     <a class="xref" href="#sec.snapper.config.modify" title="3.4.1. Managing Existing Configurations">Section 3.4.1, “Managing Existing Configurations”</a>.
    </p></div></div></div><div class="sect1 " id="sec.snapper.undo"><div class="titlepage"><div><div><h2 class="title" id="sec.snapper.undo"><span class="number">3.2 </span><span class="name">Using Snapper to Undo Changes</span> <a title="Permalink" class="permalink" href="#sec.snapper.undo">#</a></h2></div></div></div><p>
   Snapper on <span class="productname"><span class="phrase">openSUSE Leap</span></span> is preconfigured to serve as a tool that lets you
   undo changes made by <code class="command">zypper</code> and YaST. For this purpose,
   Snapper is configured to create a pair of snapshots before and after each
   run of <code class="command">zypper</code> and YaST. Snapper also lets you restore
   system files that have been accidentally deleted or modified. Timeline
   snapshots for the root partition need to be enabled for this
   purpose—see
   <a class="xref" href="#sec.snapper.setup.customize.auto_snapshots" title="3.1.3.1. Disabling/Enabling Snapshots">Section 3.1.3.1, “Disabling/Enabling Snapshots”</a> for details.
  </p><p>
   By default, automatic snapshots as described above are configured for the
   root partition and its subvolumes. To make snapshots available for other
   partitions such as <code class="filename">/home</code> for example, you can create
   custom configurations.
  </p><div id="idm140019142321936" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.png" /><h6>Important: Undoing Changes Compared to Rollback</h6><p>
    When working with snapshots to restore data, it is important to know that
    there are two fundamentally different scenarios Snapper can handle:
   </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019142320304"><span class="term ">Undoing Changes</span></dt><dd><p>
       When undoing changes as described in the following, two snapshots are
       being compared and the changes between these two snapshots are made
       undone. Using this method also allows to explicitly select the files
       that should be restored.
      </p></dd><dt id="idm140019142318256"><span class="term ">Rollback</span></dt><dd><p>
       When doing rollbacks as described in
       <a class="xref" href="#sec.snapper.snapshot-boot" title="3.3. System Rollback by Booting from Snapshots">Section 3.3, “System Rollback by Booting from Snapshots”</a>, the system is reset to the
       state at which the snapshot was taken.
      </p></dd></dl></div><p>
    When undoing changes, it is also possible to compare a snapshot against the
    current system. When restoring <span class="emphasis"><em>all</em></span> files from such a
    comparison, this will have the same result as doing a rollback. However,
    using the method described in <a class="xref" href="#sec.snapper.snapshot-boot" title="3.3. System Rollback by Booting from Snapshots">Section 3.3, “System Rollback by Booting from Snapshots”</a>
    for rollbacks should be preferred, since it is faster and allows you to
    review the system before doing the rollback.
   </p></div><div id="idm140019142313680" class="admonition warning normal"><img class="symbol" alt="Warning" title="Warning" src="static/images/icon-warning.png" /><h6>Warning: Data Consistency</h6><p>
    There is no mechanism to ensure data consistency when creating a snapshot.
    Whenever a file (for example, a database) is written at the same time as
    the snapshot is being created, it will result in a corrupted or partly written
    file. Restoring such a file will cause problems. Furthermore, some system
    files such as <code class="filename">/etc/mtab</code> must never be restored.
    Therefore it is strongly recommended to <span class="emphasis"><em>always</em></span> closely
    review the list of changed files and their diffs. Only restore files that
    really belong to the action you want to revert.
   </p></div><div class="sect2 " id="sec.snapper.undo.yast"><div class="titlepage"><div><div><h3 class="title" id="sec.snapper.undo.yast"><span class="number">3.2.1 </span><span class="name">Undoing YaST and Zypper Changes</span> <a title="Permalink" class="permalink" href="#sec.snapper.undo.yast">#</a></h3></div></div></div><p>
    If you set up the root partition with <code class="literal">Btrfs</code> during the
    installation, Snapper—preconfigured for doing rollbacks of YaST or
    Zypper changes—will automatically be installed. Every time you start
    a YaST module or a Zypper transaction, two snapshots are created: a
    <span class="quote">“<span class="quote">pre-snapshot</span>”</span> capturing the state of the file system before
    the start of the module and a <span class="quote">“<span class="quote">post-snapshot</span>”</span> after the module
    has been finished.
   </p><p>
    Using the YaST Snapper module or the <code class="command">snapper</code> command
    line tool, you can undo the changes made by YaST/Zypper by restoring
    files from the <span class="quote">“<span class="quote">pre-snapshot</span>”</span>. Comparing two snapshots the
    tools also allow you to see which files have been changed. You can also
    display the differences between two versions of a file (diff).
   </p><div class="procedure " id="proc.snapper.undo.yast"><div class="procedure-title-wrap"><h6 class="procedure-title"><span class="number">Procedure 3.1: </span><span class="name">Undoing Changes Using the YaST <span class="guimenu">Snapper</span> Module </span><a title="Permalink" class="permalink" href="#proc.snapper.undo.yast">#</a></h6></div><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
      Start the <span class="guimenu">Snapper</span> module from the
      <span class="guimenu">Miscellaneous</span> section in YaST or by entering
      <code class="command">yast2 snapper</code>.
     </p></li><li class="step "><p>
      Make sure <span class="guimenu">Current Configuration</span> is set to
      <span class="guimenu">root</span>. This is always the case unless you have manually
      added own Snapper configurations.
     </p></li><li class="step "><p>
      Choose a pair of pre- and post-snapshots from the list. Both, YaST and
      Zypper snapshot pairs are of the type <span class="guimenu">Pre &amp; Post</span>.
      YaST snapshots are labeled as <code class="literal">zypp(y2base)</code> in the
      <span class="guimenu">Description column</span>; Zypper snapshots are labeled
      <code class="literal">zypp(zypper)</code>.
     </p><div class="informalfigure"><div class="mediaobject"><a xmlns="" href="images/snapper_yast2_list.png"><img src="images/snapper_yast2_list.png" width="" /></a></div></div></li><li class="step "><p>
      Click <span class="guimenu">Show Changes</span> to open the list of files that
      differ between the two snapshots.
     </p><div class="informalfigure"><div class="mediaobject"><a xmlns="" href="images/snapper_yast2_changes.png"><img src="images/snapper_yast2_changes.png" width="" /></a></div></div></li><li class="step "><p>
      Review the list of files. To display a <span class="quote">“<span class="quote">diff</span>”</span> between the
      pre- and post-version of a file, select it from the list.
     </p><div class="informalfigure"><div class="mediaobject"><a xmlns="" href="images/snapper_yast2_diff.png"><img src="images/snapper_yast2_diff.png" width="" /></a></div></div></li><li class="step "><p>
      To restore one or more files, select the relevant files or directories by
      activating the respective check box. Click <span class="guimenu">Restore
      Selected</span> and confirm the action by clicking
      <span class="guimenu">Yes</span>.
     </p><div class="informalfigure"><div class="mediaobject"><a xmlns="" href="images/snapper_yast2_restore.png"><img src="images/snapper_yast2_restore.png" width="" /></a></div></div><p>
      To restore a single file, activate its diff view by clicking its name.
      Click <span class="guimenu">Restore From First</span> and confirm your choice with
      <span class="guimenu">Yes</span>.
     </p></li></ol></div></div><div class="procedure " id="proc.snapper.yast.cmdline"><div class="procedure-title-wrap"><h6 class="procedure-title"><span class="number">Procedure 3.2: </span><span class="name">Undoing Changes Using the <code class="command">snapper</code> Command </span><a title="Permalink" class="permalink" href="#proc.snapper.yast.cmdline">#</a></h6></div><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
      Get a list of YaST and Zypper snapshots by running <code class="command">snapper
      list -t pre-post</code>. YaST snapshots are labeled
      as <code class="literal">yast <em class="replaceable ">MODULE_NAME</em></code> in the
      <span class="guimenu">Description column</span>; Zypper snapshots are labeled
      <code class="literal">zypp(zypper)</code>.
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> snapper list -t pre-post
Pre # | Post # | Pre Date                      | Post Date                     | Description
------+--------+-------------------------------+-------------------------------+--------------
311   | 312    | Tue 06 May 2014 14:05:46 CEST | Tue 06 May 2014 14:05:52 CEST | zypp(y2base)
340   | 341    | Wed 07 May 2014 16:15:10 CEST | Wed 07 May 2014 16:15:16 CEST | zypp(zypper)
342   | 343    | Wed 07 May 2014 16:20:38 CEST | Wed 07 May 2014 16:20:42 CEST | zypp(y2base)
344   | 345    | Wed 07 May 2014 16:21:23 CEST | Wed 07 May 2014 16:21:24 CEST | zypp(zypper)
346   | 347    | Wed 07 May 2014 16:41:06 CEST | Wed 07 May 2014 16:41:10 CEST | zypp(y2base)
348   | 349    | Wed 07 May 2014 16:44:50 CEST | Wed 07 May 2014 16:44:53 CEST | zypp(y2base)
350   | 351    | Wed 07 May 2014 16:46:27 CEST | Wed 07 May 2014 16:46:38 CEST | zypp(y2base)</pre></div></li><li class="step "><p>
      Get a list of changed files for a snapshot pair with <code class="command">snapper
      status</code>
      <em class="replaceable ">PRE</em>..<em class="replaceable ">POST</em>. Files
      with content changes are marked with <span class="guimenu">c</span>, files that
      have been added are marked with <span class="guimenu">+</span> and deleted files
      are marked with <span class="guimenu">-</span>.
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> snapper status 350..351
+..... /usr/share/doc/packages/mikachan-fonts
+..... /usr/share/doc/packages/mikachan-fonts/COPYING
+..... /usr/share/doc/packages/mikachan-fonts/dl.html
c..... /usr/share/fonts/truetype/fonts.dir
c..... /usr/share/fonts/truetype/fonts.scale
+..... /usr/share/fonts/truetype/みかちゃん-p.ttf
+..... /usr/share/fonts/truetype/みかちゃん-pb.ttf
+..... /usr/share/fonts/truetype/みかちゃん-ps.ttf
+..... /usr/share/fonts/truetype/みかちゃん.ttf
c..... /var/cache/fontconfig/7ef2298fde41cc6eeb7af42e48b7d293-x86_64.cache-4
c..... /var/lib/rpm/Basenames
c..... /var/lib/rpm/Dirnames
c..... /var/lib/rpm/Group
c..... /var/lib/rpm/Installtid
c..... /var/lib/rpm/Name
c..... /var/lib/rpm/Packages
c..... /var/lib/rpm/Providename
c..... /var/lib/rpm/Requirename
c..... /var/lib/rpm/Sha1header
c..... /var/lib/rpm/Sigmd5</pre></div></li><li class="step "><p>
      To display the diff for a certain file, run <code class="command">snapper
      diff</code>
      <em class="replaceable ">PRE</em>..<em class="replaceable ">POST</em>
      <em class="replaceable ">FILENAME</em>. If you do not specify
      <em class="replaceable ">FILENAME</em>, a diff for all files will be
      displayed.
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> snapper diff 350..351 /usr/share/fonts/truetype/fonts.scale
--- /.snapshots/350/snapshot/usr/share/fonts/truetype/fonts.scale       2014-04-23 15:58:57.000000000 +0200
+++ /.snapshots/351/snapshot/usr/share/fonts/truetype/fonts.scale       2014-05-07 16:46:31.000000000 +0200
@@ -1,4 +1,4 @@
-1174
+1486
 ds=y:ai=0.2:luximr.ttf -b&amp;h-luxi mono-bold-i-normal--0-0-0-0-c-0-iso10646-1
 ds=y:ai=0.2:luximr.ttf -b&amp;h-luxi mono-bold-i-normal--0-0-0-0-c-0-iso8859-1
[...]</pre></div></li><li class="step "><p>
      To restore one or more files run <code class="command">snapper -v undochange</code>
      <em class="replaceable ">PRE</em>..<em class="replaceable ">POST</em>
      <em class="replaceable ">FILENAMES</em>. If you do not specify a
      <em class="replaceable ">FILENAMES</em>, all changed files will be restored.
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> snapper -v undochange 350..351
     create:0 modify:13 delete:7
     undoing change...
     deleting /usr/share/doc/packages/mikachan-fonts
     deleting /usr/share/doc/packages/mikachan-fonts/COPYING
     deleting /usr/share/doc/packages/mikachan-fonts/dl.html
     deleting /usr/share/fonts/truetype/みかちゃん-p.ttf
     deleting /usr/share/fonts/truetype/みかちゃん-pb.ttf
     deleting /usr/share/fonts/truetype/みかちゃん-ps.ttf
     deleting /usr/share/fonts/truetype/みかちゃん.ttf
     modifying /usr/share/fonts/truetype/fonts.dir
     modifying /usr/share/fonts/truetype/fonts.scale
     modifying /var/cache/fontconfig/7ef2298fde41cc6eeb7af42e48b7d293-x86_64.cache-4
     modifying /var/lib/rpm/Basenames
     modifying /var/lib/rpm/Dirnames
     modifying /var/lib/rpm/Group
     modifying /var/lib/rpm/Installtid
     modifying /var/lib/rpm/Name
     modifying /var/lib/rpm/Packages
     modifying /var/lib/rpm/Providename
     modifying /var/lib/rpm/Requirename
     modifying /var/lib/rpm/Sha1header
     modifying /var/lib/rpm/Sigmd5
     undoing change done</pre></div></li></ol></div></div><div id="idm140019142250208" class="admonition warning normal"><img class="symbol" alt="Warning" title="Warning" src="static/images/icon-warning.png" /><h6>Warning: Reverting User Additions</h6><p>
     Reverting user additions via undoing changes with Snapper is not
     recommended. Since certain directories are excluded from snapshots, files
     belonging to these users will remain in the file system. If a user with
     the same user ID as a deleted user is created, this user will inherit the
     files. Therefore it is strongly recommended to use the YaST
     <span class="guimenu">User and Group Management</span> tool to remove users.
    </p></div></div><div class="sect2 " id="sec.snapper.undo.delete_file"><div class="titlepage"><div><div><h3 class="title" id="sec.snapper.undo.delete_file"><span class="number">3.2.2 </span><span class="name">Using Snapper to Restore Files</span> <a title="Permalink" class="permalink" href="#sec.snapper.undo.delete_file">#</a></h3></div></div></div><p>
    Apart from the installation and administration snapshots, Snapper creates
    timeline snapshots. You can use these backup snapshots to restore files
    that have accidentally been deleted or to restore a previous version of a
    file. By using Snapper's diff feature you can also find out which
    modifications have been made at a certain point of time.
   </p><p>
    Being able to restore files is especially interesting for data, which may
    reside on subvolumes or partitions for which snapshots are not taken by
    default. To be able to restore files from home directories, for example,
    create a separate Snapper configuration for <code class="filename">/home</code>
    doing automatic timeline snapshots. See
    <a class="xref" href="#sec.snapper.config" title="3.4. Creating and Modifying Snapper Configurations">Section 3.4, “Creating and Modifying Snapper Configurations”</a> for instructions.
   </p><div id="idm140019142244128" class="admonition warning normal"><img class="symbol" alt="Warning" title="Warning" src="static/images/icon-warning.png" /><h6>Warning: Restoring Files Compared to Rollback</h6><p>
     Snapshots taken from the root file system (defined by Snapper's root
     configuration), can be used to do a system rollback. The recommended way
     to do such a rollback is to boot from the snapshot and then perform the
     rollback. See <a class="xref" href="#sec.snapper.snapshot-boot" title="3.3. System Rollback by Booting from Snapshots">Section 3.3, “System Rollback by Booting from Snapshots”</a> for details.
    </p><p>
     Performing a rollback would also be possible by restoring all files from a
     root file system snapshot as described below. However, this is not
     recommended. You may restore single files, for example a configuration
     file from the <code class="systemitem">/etc</code> directory, but not the
     complete list of files from the snapshot.
    </p><p>
     This restriction only affects snapshots taken from the root file system!
    </p></div><div class="procedure " id="proc.snapper.restore.yast"><div class="procedure-title-wrap"><h6 class="procedure-title"><span class="number">Procedure 3.3: </span><span class="name">Restoring Files Using the YaST <span class="guimenu">Snapper</span> Module </span><a title="Permalink" class="permalink" href="#proc.snapper.restore.yast">#</a></h6></div><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
      Start the <span class="guimenu">Snapper</span> module from the
      <span class="guimenu">Miscellaneous</span> section in YaST or by entering
      <code class="command">yast2 snapper</code>.
     </p></li><li class="step "><p>
      Choose the <span class="guimenu">Current Configuration</span> from which to choose
      a snapshot.
     </p></li><li class="step "><p>
      Select a timeline snapshot from which to restore a file and choose
      <span class="guimenu">Show Changes</span>. Timeline snapshots are of the type
      <span class="guimenu">Single</span> with a description value of
      <span class="guimenu">timeline</span>.
     </p></li><li class="step "><p>
      Select a file from the text box by clicking the file name. The difference
      between the snapshot version and the current system is shown. Activate
      the check box to select the file for restore. Do so for all files you
      want to restore.
     </p></li><li class="step "><p>
      Click <span class="guimenu">Restore Selected</span> and confirm the action by
      clicking <span class="guimenu">Yes</span>.
     </p></li></ol></div></div><div class="procedure " id="proc.snapper.restore.cmdl"><div class="procedure-title-wrap"><h6 class="procedure-title"><span class="number">Procedure 3.4: </span><span class="name">Restoring Files Using the <code class="command">snapper</code> Command </span><a title="Permalink" class="permalink" href="#proc.snapper.restore.cmdl">#</a></h6></div><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
      Get a list of timeline snapshots for a specific configuration by running
      the following command:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> snapper -c <em class="replaceable ">CONFIG</em> list -t single | grep timeline</pre></div><p>
      <em class="replaceable ">CONFIG</em> needs to be replaced by an existing
      Snapper configuration. Use <code class="command">snapper list-configs</code> to
      display a list.
     </p></li><li class="step "><p>
      Get a list of changed files for a given snapshot by running the following
      command:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> snapper -c <em class="replaceable ">CONFIG</em> status <em class="replaceable ">SNAPSHOT_ID</em>..0</pre></div><p>
      Replace <em class="replaceable ">SNAPSHOT_ID</em> by the ID for the snapshot
      from which you want to restore the file(s).
     </p></li><li class="step "><p>
      Optionally list the differences between the current file version and the
      one from the snapshot by running
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> snapper -c <em class="replaceable ">CONFIG</em> diff <em class="replaceable ">SNAPSHOT_ID</em>..0 <em class="replaceable ">FILE NAME</em></pre></div><p>
      If you do not specify <em class="replaceable ">&lt;FILE NAME&gt;</em>, the
      difference for all files are shown.
     </p></li><li class="step "><p>
      To restore one or more files, run
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> snapper -c <em class="replaceable ">CONFIG</em> -v undochange <em class="replaceable ">SNAPSHOT_ID</em>..0 <em class="replaceable ">FILENAME1</em> <em class="replaceable ">FILENAME2</em></pre></div><p>
      If you do not specify file names, all changed files will be restored.
     </p></li></ol></div></div></div></div><div class="sect1 " id="sec.snapper.snapshot-boot"><div class="titlepage"><div><div><h2 class="title" id="sec.snapper.snapshot-boot"><span class="number">3.3 </span><span class="name">System Rollback by Booting from Snapshots</span> <a title="Permalink" class="permalink" href="#sec.snapper.snapshot-boot">#</a></h2></div></div></div><p>
   The GRUB 2 version included on <span class="productname"><span class="phrase">openSUSE Leap</span></span> can boot from Btrfs snapshots.
   Together with Snapper's rollback feature, this allows to recover a
   misconfigured system. Only snapshots created for the default Snapper
   configuration (<code class="literal">root</code>) are bootable.
  </p><div id="idm140019142207888" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.png" /><h6>Important: Supported Configuration</h6><p>

    As of <span class="productname"><span class="phrase">openSUSE Leap</span></span> <span class="productnumber"><span class="phrase">42.3</span></span> system rollbacks are only supported if
    the default subvolume configuration of the root partition has not been
    changed.
   </p></div><p>
   When booting a snapshot, the parts of the file system included in the
   snapshot are mounted read-only; all other file systems and parts that are
   excluded from snapshots are mounted read-write and can be modified.
  </p><div id="idm140019142203536" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.png" /><h6>Important: Undoing Changes Compared to Rollback</h6><p>
    When working with snapshots to restore data, it is important to know that
    there are two fundamentally different scenarios Snapper can handle:
   </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019142201904"><span class="term ">Undoing Changes</span></dt><dd><p>
       When undoing changes as described in <a class="xref" href="#sec.snapper.undo" title="3.2. Using Snapper to Undo Changes">Section 3.2, “Using Snapper to Undo Changes”</a>,
       two snapshots are compared and the changes between these two snapshots
       are reverted. Using this method also allows to explicitly exclude
       selected files from being restored.
      </p></dd><dt id="idm140019142199328"><span class="term ">Rollback</span></dt><dd><p>
       When doing rollbacks as described in the following, the system is reset
       to the state at which the snapshot was taken.
      </p></dd></dl></div></div><p>
   To do a rollback from a bootable snapshot, the following requirements must
   be met. When doing a default installation, the system is set up accordingly.
  </p><div class="itemizedlist "><div class="itemizedlist-title-wrap"><h6 class="itemizedlist-title"><span class="name">Requirements for a Rollback from a Bootable Snapshot </span><a title="Permalink" class="permalink" href="#idm140019142196496">#</a></h6></div><ul class="itemizedlist"><li class="listitem "><p>
     The root file system needs to be Btrfs. Booting from LVM volume snapshots
     is not supported.
    </p></li><li class="listitem "><p>
     The root file system needs to be on a single device, a single partition
     and a single subvolume. Directories that are excluded from snapshots such
     as <code class="filename">/srv</code> (see <a class="xref" href="#snapper.dir-excludes" title="3.1.2. Directories That Are Excluded from Snapshots">Section 3.1.2, “Directories That Are Excluded from Snapshots”</a>
     for a full list) may reside on separate partitions.
    </p></li><li class="listitem "><p>
     The system needs to be bootable via the installed boot loader.
    </p></li></ul></div><p>
   To perform a rollback from a bootable snapshot, do as follows:
  </p><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
     Boot the system. In the boot menu choose <span class="guimenu">Bootable
     snapshots</span> and select the snapshot you want to boot. The list of
     snapshots is listed by date—the most recent snapshot is listed
     first.
    </p></li><li class="step "><p>
     Log in to the system. Carefully check whether everything works as
     expected. Note that you cannot write to any directory that is part of the
     snapshot. Data you write to other directories will
     <span class="emphasis"><em>not</em></span> get lost, regardless of what you do next.
    </p></li><li class="step "><p>
     Depending on whether you want to perform the rollback or not, choose your
     next step:
    </p><ol type="a" class="substeps "><li class="step "><p>
       If the system is in a state where you do not want to do a rollback,
       reboot to boot into the current system state. You can then choose a different
       snapshot, or start the rescue system.
      </p></li><li class="step "><p>
       To perform the rollback, run
      </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> snapper rollback</pre></div><p>
       and reboot afterward. On the boot screen, choose the default boot entry
       to reboot into the reinstated system. A snapshot of the file system status
       before the rollback is created. The default subvolume for root will
       be replaced with a fresh read-write snapshot.
       For details, see <a class="xref" href="#sec.snapper.snapshot-boot.rollback" title="3.3.1. Snapshots after Rollback">Section 3.3.1, “Snapshots after Rollback”</a>.
       </p><p>
        It is useful to add a description for the snapshot with the <code class="option">-d</code> option.
        For example:
       </p><div class="verbatim-wrap"><pre class="screen">New file system root since rollback on <em class="replaceable ">DATE</em> <em class="replaceable ">TIME</em></pre></div></li></ol></li></ol></div></div><div id="idm140019142178736" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.png" /><h6>Tip: Rolling Back to a Specific Installation State</h6><p>
    If snapshots are not disabled during installation, an initial bootable
    snapshot is created at the end of the initial system installation. You can
    go back to that state at any time by booting this snapshot. The snapshot
    can be identified by the description <code class="literal">after installation</code>.
   </p><p>
    A bootable snapshot is also created when starting a system upgrade to a
    service pack or a new major release (provided snapshots are not disabled).
   </p></div><div class="sect2 " id="sec.snapper.snapshot-boot.rollback"><div class="titlepage"><div><div><h3 class="title" id="sec.snapper.snapshot-boot.rollback"><span class="number">3.3.1 </span><span class="name">Snapshots after Rollback</span> <a title="Permalink" class="permalink" href="#sec.snapper.snapshot-boot.rollback">#</a></h3></div></div></div><p>
    Before a rollback is performed, a snapshot of the running file system
    is created. The description references the ID of the snapshot that
    was restored in the rollback.
   </p><p>
    Snapshots created by rollbacks receive the value <code class="literal">number</code>
    for the <code class="literal">Cleanup</code> attribute. The rollback snapshots are
    therefore automatically deleted when the set number of snapshots is reached.
    Refer to <a class="xref" href="#sec.snapper.clean-up" title="3.6. Automatic Snapshot Clean-Up">Section 3.6, “Automatic Snapshot Clean-Up”</a> for details.
    If the snapshot contains important data, extract the data from the snapshot
    before it is removed.
   </p><div class="sect3 " id="sec.snapper.snapshot-boot.rollback.example"><div class="titlepage"><div><div><h4 class="title" id="sec.snapper.snapshot-boot.rollback.example"><span class="number">3.3.1.1 </span><span class="name">Example of Rollback Snapshot</span> <a title="Permalink" class="permalink" href="#sec.snapper.snapshot-boot.rollback.example">#</a></h4></div></div></div><p>
     For example, after a fresh installation the following snapshots are
     available on the system:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code><code class="command">snapper</code> --iso list
Type   | # |     | Cleanup | Description           | Userdata
-------+---+ ... +---------+-----------------------+--------------
single | 0 |     |         | current               |
single | 1 |     |         | first root filesystem |
single | 2 |     | number  | after installation    | important=yes</pre></div><p>
     After running <code class="command">sudo snapper rollback</code> snapshot
     <code class="literal">3</code> is created and contains the state of the system
     before the rollback was executed. Snapshot <code class="literal">4</code> is
     the new default Btrfs subvolume and thus the system after a reboot.
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code><code class="command">snapper</code> --iso list
Type   | # |     | Cleanup | Description           | Userdata
-------+---+ ... +---------+-----------------------+--------------
single | 0 |     |         | current               |
single | 1 |     | number  | first root filesystem |
single | 2 |     | number  | after installation    | important=yes
single | 3 |     | number  | rollback backup of #1 | important=yes
single | 4 |     |         |                       |</pre></div></div></div><div class="sect2 " id="sec.snapper.snapshot-boot.identify"><div class="titlepage"><div><div><h3 class="title" id="sec.snapper.snapshot-boot.identify"><span class="number">3.3.2 </span><span class="name">Accessing and Identifying Snapshot Boot Entries</span> <a title="Permalink" class="permalink" href="#sec.snapper.snapshot-boot.identify">#</a></h3></div></div></div><p>
    To boot from a snapshot, reboot your machine and choose <span class="guimenu">Start
    Bootloader from a read-only snapshot</span>. A screen listing all
    bootable snapshots opens. The most recent snapshot is listed first, the
    oldest last. Use the keys <span class="keycap">↓</span> and
    <span class="keycap">↑</span> to navigate and press <span class="keycap">Enter</span> to
    activate the selected snapshot. Activating a snapshot from the boot menu
    does not reboot the machine immediately, but rather opens the boot loader
    of the selected snapshot.
   </p><div class="figure" id="fig.snapper.snapshot-boot.identify"><div class="figure-contents"><div class="mediaobject"><a xmlns="" href="images/boot_snapshots.png"><img src="images/boot_snapshots.png" width="" alt="Boot Loader: Snapshots" /></a></div></div><div class="figure-title-wrap"><h6 class="figure-title"><span class="number">Figure 3.1: </span><span class="name">Boot Loader: Snapshots </span><a title="Permalink" class="permalink" href="#fig.snapper.snapshot-boot.identify">#</a></h6></div></div><p>
    Each snapshot entry in the boot loader follows a naming scheme which makes
    it possible to identify it easily:
   </p><div class="verbatim-wrap"><pre class="screen">[*]<span id="snapper.boot.important"></span><span class="callout">1</span><em class="replaceable ">OS</em><span id="snapper.boot.os"></span><span class="callout">2</span> (<em class="replaceable ">KERNEL</em><span id="snapper.boot.kernel"></span><span class="callout">3</span>,<em class="replaceable ">DATE</em><span id="snapper.boot.date"></span><span class="callout">4</span>T<em class="replaceable ">TIME</em><span id="snapper.boot.time"></span><span class="callout">5</span>,<em class="replaceable ">DESCRIPTION</em><span id="snapper.boot.description"></span><span class="callout">6</span>)</pre></div><div class="calloutlist "><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#snapper.boot.important"><span class="callout">1</span></a> </p></td><td valign="top" align="left"><p>
      If the snapshot was marked <code class="literal">important</code>, the entry is
      marked with a <code class="literal">*</code>.
     </p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#snapper.boot.os"><span class="callout">2</span></a> </p></td><td valign="top" align="left"><p>
      Operating system label.
     </p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#snapper.boot.date"><span class="callout">4</span></a> </p></td><td valign="top" align="left"><p>
      Date in the format <code class="literal">YYYY-MM-DD</code>.
     </p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#snapper.boot.time"><span class="callout">5</span></a> </p></td><td valign="top" align="left"><p>
      Time in the format <code class="literal">HH:MM</code>.
     </p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#snapper.boot.description"><span class="callout">6</span></a> </p></td><td valign="top" align="left"><p>
      This field contains a description of the snapshot. In case of a manually
      created snapshot this is the string created with the option
      <code class="option">--description</code> or a custom string (see
      <a class="xref" href="#tip.snapper.snapshot-boot.custom_descr" title="Tip: Setting a Custom Description for Boot Loader Snapshot Entries">Tip: Setting a Custom Description for Boot Loader Snapshot Entries</a>). In case
      of an automatically created snapshot, it is the tool that was called, for
      example <code class="literal">zypp(zypper)</code> or
      <code class="literal">yast_sw_single</code>. Long descriptions may be truncated,
      depending on the size of the boot screen.
     </p></td></tr></table></div><div id="tip.snapper.snapshot-boot.custom_descr" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.png" /><h6>Tip: Setting a Custom Description for Boot Loader Snapshot Entries</h6><p>
     It is possible to replace the default string in the description field of a
     snapshot with a custom string. This is for example useful if an
     automatically created description is not sufficient, or a user-provided
     description is too long. To set a custom string
     <em class="replaceable ">STRING</em> for snapshot
     <em class="replaceable ">NUMBER</em>, use the following command:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> snapper modify --userdata "bootloader=<em class="replaceable ">STRING</em>" <em class="replaceable ">NUMBER</em></pre></div><p>
     The description should be no longer than 25 characters—everything
     that exceeds this size will not be readable on the boot screen.
    </p></div></div><div class="sect2 " id="sec.snapper.snapshot-boot.limits"><div class="titlepage"><div><div><h3 class="title" id="sec.snapper.snapshot-boot.limits"><span class="number">3.3.3 </span><span class="name">Limitations</span> <a title="Permalink" class="permalink" href="#sec.snapper.snapshot-boot.limits">#</a></h3></div></div></div><p>
    A <span class="emphasis"><em>complete</em></span> system rollback, restoring the complete
    system to the identical state as it was in when a snapshot was taken, is
    not possible.
   </p><div class="sect3 " id="sec.snapper.limits.snapshot-boot.excludes"><div class="titlepage"><div><div><h4 class="title" id="sec.snapper.limits.snapshot-boot.excludes"><span class="number">3.3.3.1 </span><span class="name">Directories Excluded from Snapshots</span> <a title="Permalink" class="permalink" href="#sec.snapper.limits.snapshot-boot.excludes">#</a></h4></div></div></div><p>
     Root file system snapshots do not contain all directories. See
     <a class="xref" href="#snapper.dir-excludes" title="3.1.2. Directories That Are Excluded from Snapshots">Section 3.1.2, “Directories That Are Excluded from Snapshots”</a> for details and reasons. As a
     general consequence, data from these directories is not restored,
     resulting in the following limitations.
    </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019142127184"><span class="term ">
       Add-ons and Third Party Software may be Unusable after a Rollback
      </span></dt><dd><p>
        Applications and add-ons installing data in subvolumes excluded from
        the snapshot, such as <code class="filename">/opt</code>, may not work after a
        rollback, if others parts of the application data are also installed on
        subvolumes included in the snapshot. Re-install the application or the
        add-on to solve this problem.
       </p></dd><dt id="idm140019142124576"><span class="term ">File Access Problems</span></dt><dd><p>
        If an application had changed file permissions and/or ownership in
        between snapshot and current system, the application may not be able to
        access these files. Reset permissions and/or ownership for the affected
        files after the rollback.
       </p></dd><dt id="idm140019142122528"><span class="term ">Incompatible Data Formats</span></dt><dd><p>
        If a service or an application has established a new data format in
        between snapshot and current system, the application may not be able to
        read the affected data files after a rollback.
       </p></dd><dt id="idm140019142120512"><span class="term ">Subvolumes with a Mixture of Code and Data</span></dt><dd><p>
        Subvolumes like <code class="filename">/srv</code> may contain a mixture of code
        and data. A rollback may result in non-functional code. A downgrade of
        the PHP version, for example, may result in broken PHP scripts for the
        Web server.
       </p></dd><dt id="idm140019142118080"><span class="term ">User Data</span></dt><dd><p>
        If a rollback removes users from the system, data that is owned by
        these users in directories excluded from the snapshot, is not removed.
        If a user with the same user ID is created, this user will inherit the
        files. Use a tool like <code class="command">find</code> to locate and remove
        orphaned files.
       </p></dd></dl></div></div><div class="sect3 " id="sec.snapper.limits.snapshot-boot.grub"><div class="titlepage"><div><div><h4 class="title" id="sec.snapper.limits.snapshot-boot.grub"><span class="number">3.3.3.2 </span><span class="name">No Rollback of Boot Loader Data</span> <a title="Permalink" class="permalink" href="#sec.snapper.limits.snapshot-boot.grub">#</a></h4></div></div></div><p>
     A rollback of the boot loader is not possible, since all
     <span class="quote">“<span class="quote">stages</span>”</span> of the boot loader must fit together. This cannot be
     guaranteed when doing rollbacks of <code class="filename">/boot</code>.
    </p></div></div></div><div class="sect1 " id="sec.snapper.config"><div class="titlepage"><div><div><h2 class="title" id="sec.snapper.config"><span class="number">3.4 </span><span class="name">Creating and Modifying Snapper Configurations</span> <a title="Permalink" class="permalink" href="#sec.snapper.config">#</a></h2></div></div></div><p>
   The way Snapper behaves is defined in a configuration file that is specific
   for each partition or <code class="literal">Btrfs</code> subvolume. These
   configuration files reside under <code class="filename">/etc/snapper/configs/</code>.
  </p><p>
   In case the root file system is big enough (approximately 12 GB), snapshots
   are automatically enabled for the root file system <code class="filename">/</code>
   upon installation. The corresponding default configuration is named
   <code class="filename">root</code>. It creates and manages the YaST and Zypper
   snapshot. See <a class="xref" href="#sec.snapper.config.modify.values" title="3.4.1.1. Configuration Data">Section 3.4.1.1, “Configuration Data”</a> for a list
   of the default values.
  </p><div id="idm140019142107216" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note: Minimum Root File System Size for Enabling Snapshots</h6><p>
    As explained in <a class="xref" href="#sec.snapper.setup" title="3.1. Default Setup">Section 3.1, “Default Setup”</a>, enabling snapshots
    requires additional free space in the root file system. The amount depends
    on the amount of packages installed and the amount of changes made to the
    volume that is included in snapshots. The snapshot frequency and the number
    of snapshots that get archived also matter.
   </p><p>
    There is a minimum root file system size that is required in order to
    automatically enable snapshots during the installation. As of <span class="productname"><span class="phrase">openSUSE Leap</span></span>
    12 SP3 this size is approximately 12 GB. This value may change in the
    future, depending on architecture and the size of the base system. It
    depends on the values for the following tags in the file
    <code class="filename">/control.xml</code> from the installation media:
   </p><div class="verbatim-wrap"><pre class="screen">&lt;root_base_size&gt;
&lt;btrfs_increase_percentage&gt;</pre></div><p>
    It is calculated with the following formula: <em class="replaceable ">ROOT_BASE_SIZE</em> * (1 + <em class="replaceable ">BTRFS_INCREASE_PERCENTAGE</em>/100)
   </p><p>
    Keep in mind that this value is a minimum size. Consider using more space
    for the root file system. As a rule of thumb, double the size you would use
    when not having enabled snapshots.
   </p></div><p>
   You may create your own configurations for other partitions formatted with
   <code class="literal">Btrfs</code> or existing subvolumes on a
   <code class="literal">Btrfs</code> partition. In the following example we will set up
   a Snapper configuration for backing up the Web server data residing on a
   separate, <code class="literal">Btrfs</code>-formatted partition mounted at
   <code class="filename">/srv/www</code>.
  </p><p>
   After a configuration has been created, you can either use
   <code class="command">snapper</code> itself or the YaST <span class="guimenu">Snapper</span>
   module to restore files from these snapshots. In YaST you need to select
   your <span class="guimenu">Current Configuration</span>, while you need to specify
   your configuration for <code class="command">snapper</code> with the global switch
   <code class="option">-c</code> (for example, <code class="command">snapper -c myconfig
   list</code>).
  </p><p>
   To create a new Snapper configuration, run <code class="command">snapper
   create-config</code>:
  </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> snapper -c www-data<span id="snapper.create.name"></span><span class="callout">1</span> create-config /srv/www<span id="snapper.create.volume"></span><span class="callout">2</span></pre></div><div class="calloutlist "><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#snapper.create.name"><span class="callout">1</span></a> </p></td><td valign="top" align="left"><p>
     Name of configuration file.
    </p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#snapper.create.volume"><span class="callout">2</span></a> </p></td><td valign="top" align="left"><p>
     Mount point of the partition or <code class="literal">Btrfs</code> subvolume on
     which to take snapshots.
    </p></td></tr></table></div><p>
   This command will create a new configuration file
   <code class="filename">/etc/snapper/configs/www-data</code> with reasonable default
   values (taken from
   <code class="filename">/etc/snapper/config-templates/default</code>). Refer to
   <a class="xref" href="#sec.snapper.config.modify" title="3.4.1. Managing Existing Configurations">Section 3.4.1, “Managing Existing Configurations”</a> for instructions on how to
   adjust these defaults.
  </p><div id="idm140019142085728" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.png" /><h6>Tip: Configuration Defaults</h6><p>
    Default values for a new configuration are taken from
    <code class="filename">/etc/snapper/config-templates/default</code>. To use your own
    set of defaults, create a copy of this file in the same directory and
    adjust it to your needs. To use it, specify the <code class="option">-t</code> option
    with the create-config command:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> snapper -c www-data create-config -t <em class="replaceable ">MY_DEFAULTS</em> /srv/www</pre></div></div><div class="sect2 " id="sec.snapper.config.modify"><div class="titlepage"><div><div><h3 class="title" id="sec.snapper.config.modify"><span class="number">3.4.1 </span><span class="name">Managing Existing Configurations</span> <a title="Permalink" class="permalink" href="#sec.snapper.config.modify">#</a></h3></div></div></div><p>
    The <code class="command">snapper</code> offers several subcommands for managing
    existing configurations. You can list, show, delete and modify them:
   </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019142079344"><span class="term ">List Configurations</span></dt><dd><p>
       Use the command <code class="command">snapper list-configs</code> to get all
       existing configurations:
      </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> snapper list-configs
Config | Subvolume
-------+----------
root   | /
usr    | /usr
local  | /local</pre></div></dd><dt id="idm140019142075952"><span class="term ">Show a Configuration</span></dt><dd><p>
       Use the subcommand <code class="command">snapper -c
       <em class="replaceable ">CONFIG</em> get-config</code> to display the
       specified configuration. <em class="replaceable ">Config</em> needs to be
       replaced by a configuration name shown by <code class="command">snapper
       list-configs</code>. See
       <a class="xref" href="#sec.snapper.config.modify.values" title="3.4.1.1. Configuration Data">Section 3.4.1.1, “Configuration Data”</a> for more information
       on the configuration options.
      </p><p>
       To display the default configuration run
      </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> snapper -c root get-config</pre></div></dd><dt id="idm140019142070112"><span class="term ">Modify a Configuration</span></dt><dd><p>
       Use the subcommand <code class="command">snapper -c <em class="replaceable ">CONFIG</em>
       set-config
       <em class="replaceable ">OPTION</em>=<em class="replaceable ">VALUE</em></code>
       to modify an option in the specified configuration.
       <em class="replaceable ">Config</em> needs to be replaced by a
       configuration name shown by <code class="command">snapper list-configs</code>.
       Possible values for <em class="replaceable ">OPTION</em> and
       <em class="replaceable ">VALUE</em> are listed in <a class="xref" href="#sec.snapper.config.modify.values" title="3.4.1.1. Configuration Data">Section 3.4.1.1, “Configuration Data”</a>.
      </p></dd><dt id="idm140019142064176"><span class="term ">Delete a Configuration</span></dt><dd><p>
       Use the subcommand <code class="command">snapper -c
       <em class="replaceable ">CONFIG</em> delete-config</code> to delete a
       configuration. <em class="replaceable ">Config</em> needs to be replaced by
       a configuration name shown by <code class="command">snapper list-configs</code>.
      </p></dd></dl></div><div class="sect3 " id="sec.snapper.config.modify.values"><div class="titlepage"><div><div><h4 class="title" id="sec.snapper.config.modify.values"><span class="number">3.4.1.1 </span><span class="name">Configuration Data</span> <a title="Permalink" class="permalink" href="#sec.snapper.config.modify.values">#</a></h4></div></div></div><p>
     Each configuration contains a list of options that can be modified from
     the command line. The following list provides details for each option. To
     change a value, run <code class="command">snapper -c <em class="replaceable ">CONFIG</em>
     set-config
     "<em class="replaceable ">KEY</em>=<em class="replaceable ">VALUE</em>"</code>.
    </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019142056448"><span class="term "><code class="literal">ALLOW_GROUPS</code>,
      <code class="literal">ALLOW_USERS</code>
      </span></dt><dd><p>
        Granting permissions to use snapshots to regular users. See
        <a class="xref" href="#sec.snapper.config.user" title="3.4.1.2. Using Snapper as Regular User">Section 3.4.1.2, “Using Snapper as Regular User”</a> for more information.
       </p><p>
        The default value is <code class="literal">""</code>.
       </p></dd><dt id="idm140019142052368"><span class="term "><code class="literal">BACKGROUND_COMPARISON</code>
      </span></dt><dd><p>
        Defines whether pre and post snapshots should be compared in the
        background after creation.
       </p><p>
        The default value is <code class="literal">"yes"</code>.
       </p></dd><dt id="idm140019142049280"><span class="term "><code class="literal">EMPTY_*</code>
      </span></dt><dd><p>
        Defines the clean-up algorithm for snapshots pairs with identical pre
        and post snapshots. See <a class="xref" href="#sec.snapper.clean-up.empty" title="3.6.3. Cleaning Up Snapshot Pairs That Do Not Differ">Section 3.6.3, “Cleaning Up Snapshot Pairs That Do Not Differ”</a>
        for details.
       </p></dd><dt id="idm140019142046512"><span class="term "><code class="literal">FSTYPE</code>
      </span></dt><dd><p>
        File system type of the partition. Do not change.
       </p><p>
        The default value is <code class="literal">"btrfs"</code>.
       </p></dd><dt id="idm140019142043472"><span class="term ">NUMBER_*</span></dt><dd><p>
        Defines the clean-up algorithm for installation and admin snapshots.
        See <a class="xref" href="#sec.snapper.clean-up.number" title="3.6.1. Cleaning Up Numbered Snapshots">Section 3.6.1, “Cleaning Up Numbered Snapshots”</a> for details.
       </p></dd><dt id="idm140019142041024"><span class="term "><code class="literal">QGROUP</code> / <code class="literal">SPACE_LIMIT</code>
      </span></dt><dd><p>
        Adds quota support to the clean-up algorithms. See
        <a class="xref" href="#sec.snapper.clean-up.quota" title="3.6.5. Adding Disk Quota Support">Section 3.6.5, “Adding Disk Quota Support”</a> for details.
       </p></dd><dt id="idm140019142037872"><span class="term "><code class="literal">SUBVOLUME</code>
      </span></dt><dd><p>
        Mount point of the partition or subvolume to snapshot. Do not change.
       </p><p>
        The default value is <code class="literal">"/"</code>.
       </p></dd><dt id="idm140019142034816"><span class="term "><code class="literal">SYNC_ACL</code>
      </span></dt><dd><p>
        If Snapper is used by regular users (see
        <a class="xref" href="#sec.snapper.config.user" title="3.4.1.2. Using Snapper as Regular User">Section 3.4.1.2, “Using Snapper as Regular User”</a>), the users must be able to
        access the <code class="filename">.snapshot</code> directories and to read files
        within them. If SYNC_ACL is set to <code class="literal">yes</code>, Snapper
        automatically makes them accessible using ACLs for users and groups
        from the ALLOW_USERS or ALLOW_GROUPS entries.
       </p><p>
        The default value is <code class="literal">"no"</code>.
       </p></dd><dt id="idm140019142030096"><span class="term "><code class="literal">TIMELINE_CREATE</code>
      </span></dt><dd><p>
        If set to <code class="literal">yes</code>, hourly snapshots are created. Valid
        values: <code class="literal">yes</code>, <code class="literal">no</code>.
       </p><p>
        The default value is <code class="literal">"no"</code>.
       </p></dd><dt id="idm140019142025728"><span class="term "><code class="literal">TIMELINE_CLEANUP</code> /
       <code class="literal">TIMELINE_LIMIT_*</code>
      </span></dt><dd><p>
        Defines the clean-up algorithm for timeline snapshots. See
        <a class="xref" href="#sec.snapper.clean-up.timeline" title="3.6.2. Cleaning Up Timeline Snapshots">Section 3.6.2, “Cleaning Up Timeline Snapshots”</a> for details.
       </p></dd></dl></div></div><div class="sect3 " id="sec.snapper.config.user"><div class="titlepage"><div><div><h4 class="title" id="sec.snapper.config.user"><span class="number">3.4.1.2 </span><span class="name">Using Snapper as Regular User</span> <a title="Permalink" class="permalink" href="#sec.snapper.config.user">#</a></h4></div></div></div><p>
     By default Snapper can only be used by <code class="systemitem">root</code>. However, there are
     cases in which certain groups or users need to be able to create snapshots
     or undo changes by reverting to a snapshot:
    </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
       Web site administrators who want to take snapshots of
       <code class="filename">/srv/www</code>
      </p></li><li class="listitem "><p>
       Users who want to take a snapshot of their home directory
      </p></li></ul></div><p>
     For these purposes Snapper configurations that grant permissions to users
     or/and groups can be created. The corresponding
     <code class="filename">.snapshots</code> directory needs to be readable and
     accessible by the specified users. The easiest way to achieve this is to
     set the SYNC_ACL option to <code class="literal">yes</code>.
    </p><div class="procedure " id="idm140019142014768"><div class="procedure-title-wrap"><h6 class="procedure-title"><span class="number">Procedure 3.5: </span><span class="name">Enabling Regular Users to Use Snapper </span><a title="Permalink" class="permalink" href="#idm140019142014768">#</a></h6></div><div class="procedure-contents"><p>
      Note that all steps in this procedure need to be run by <code class="systemitem">root</code>.
     </p><ol class="procedure" type="1"><li class="step "><p>
       If not existing, create a Snapper configuration for the partition or
       subvolume on which the user should be able to use Snapper. Refer to
       <a class="xref" href="#sec.snapper.config" title="3.4. Creating and Modifying Snapper Configurations">Section 3.4, “Creating and Modifying Snapper Configurations”</a> for instructions. Example:
      </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> snapper --config web_data create /srv/www</pre></div></li><li class="step "><p>
       The configuration file is created under
       <code class="filename">/etc/snapper/configs/<em class="replaceable ">CONFIG</em></code>,
       where CONFIG is the value you specified with
       <code class="option">-c/--config</code> in the previous step (for example
       <code class="filename">/etc/snapper/configs/web_data</code>). Adjust it according
       to your needs; see <a class="xref" href="#sec.snapper.config.modify" title="3.4.1. Managing Existing Configurations">Section 3.4.1, “Managing Existing Configurations”</a> for
       details.
      </p></li><li class="step "><p>
       Set values for <code class="envar">ALLOW_USERS</code> and/or
       <code class="envar">ALLOW_GROUPS</code> to grant permissions to users and/or groups,
       respectively. Multiple entries need to be separated by
       <span class="keycap">Space</span>. To grant permissions to the user
       <code class="systemitem">www_admin</code> for example, run:
      </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> snapper -c web_data set-config "ALLOW_USERS=www_admin" SYNC_ACL="yes"</pre></div></li><li class="step "><p>
       The given Snapper configuration can now be used by the specified user(s)
       and/or group(s). You can test it with the <code class="literal">list</code>
       command, for example:
      </p><div class="verbatim-wrap"><pre class="screen">www_admin:~ &gt; snapper -c web_data list</pre></div></li></ol></div></div></div></div></div><div class="sect1 " id="sec.snapper.manage"><div class="titlepage"><div><div><h2 class="title" id="sec.snapper.manage"><span class="number">3.5 </span><span class="name">Manually Creating and Managing Snapshots</span> <a title="Permalink" class="permalink" href="#sec.snapper.manage">#</a></h2></div></div></div><p>
   Snapper is not restricted to creating and managing snapshots automatically
   by configuration; you can also create snapshot pairs (<span class="quote">“<span class="quote">before and
   after</span>”</span>) or single snapshots manually using either the command-line
   tool or the YaST module.
  </p><p>
   All Snapper operations are carried out for an existing configuration (see
   <a class="xref" href="#sec.snapper.config" title="3.4. Creating and Modifying Snapper Configurations">Section 3.4, “Creating and Modifying Snapper Configurations”</a> for details). You can only take
   snapshots of partitions or volumes for which a configuration exists. By
   default the system configuration (<code class="literal">root</code>) is used. If you
   want to create or manage snapshots for your own configuration you need to
   explicitly choose it. Use the <span class="guimenu">Current Configuration</span>
   drop-down box in YaST or specify the <code class="option">-c</code> on the command
   line (<code class="command">snapper -c <em class="replaceable ">MYCONFIG</em>
   <em class="replaceable ">COMMAND</em></code>).
  </p><div class="sect2 " id="sec.snapper.manage.metadata"><div class="titlepage"><div><div><h3 class="title" id="sec.snapper.manage.metadata"><span class="number">3.5.1 </span><span class="name">Snapshot Metadata</span> <a title="Permalink" class="permalink" href="#sec.snapper.manage.metadata">#</a></h3></div></div></div><p>
    Each snapshot consists of the snapshot itself and some metadata. When
    creating a snapshot you also need to specify the metadata. Modifying a
    snapshot means changing its metadata—you cannot modify its content.
    Use <code class="command">snapper list</code> to show existing snapshots and their
    metadata:
   </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019141991168"><span class="term "><code class="command">snapper --config home list</code>
     </span></dt><dd><p>
       Lists snapshots for the configuration <code class="literal">home</code>. To list
       snapshots for the default configuration (root), use <code class="command">snapper -c
       root list</code> or <code class="command">snapper list</code>.
      </p></dd><dt id="idm140019141987680"><span class="term "><code class="command">snapper list -a</code>
     </span></dt><dd><p>
       Lists snapshots for all existing configurations.
      </p></dd><dt id="idm140019141985552"><span class="term "><code class="command">snapper list -t pre-post</code>
     </span></dt><dd><p>
       Lists all pre and post snapshot pairs for the default
       (<code class="literal">root</code>) configuration.
      </p></dd><dt id="idm140019141982960"><span class="term "><code class="command">snapper list -t single</code>
     </span></dt><dd><p>
       Lists all snapshots of the type <code class="literal">single</code> for the
       default (<code class="literal">root</code>) configuration.
      </p></dd></dl></div><p>
    The following metadata is available for each snapshot:
   </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
      <span class="bold"><strong>Type</strong></span>: Snapshot type, see
      <a class="xref" href="#sec.snapper.manage.metadata.type" title="3.5.1.1. Snapshot Types">Section 3.5.1.1, “Snapshot Types”</a> for details. This data
      cannot be changed.
     </p></li><li class="listitem "><p>
      <span class="bold"><strong>Number</strong></span>: Unique number of the snapshot.
      This data cannot be changed.
     </p></li><li class="listitem "><p>
      <span class="bold"><strong>Pre Number</strong></span>: Specifies the number of the
      corresponding pre snapshot. For snapshots of type post only. This data
      cannot be changed.
     </p></li><li class="listitem "><p>
      <span class="bold"><strong>Description</strong></span>: A description of the
      snapshot.
     </p></li><li class="listitem "><p>
      <span class="bold"><strong>Userdata</strong></span>: An extended description where
      you can specify custom data in the form of a comma-separated key=value
      list: <code class="literal">reason=testing, project=foo</code>. This field is also
      used to mark a snapshot as important (<code class="literal">important=yes</code>)
      and to list the user that created the snapshot
      (user=tux).
     </p></li><li class="listitem "><p>
      <span class="bold"><strong>Cleanup-Algorithm</strong></span>: Cleanup-algorithm for
      the snapshot, see <a class="xref" href="#sec.snapper.clean-up" title="3.6. Automatic Snapshot Clean-Up">Section 3.6, “Automatic Snapshot Clean-Up”</a> for details.
     </p></li></ul></div><div class="sect3 " id="sec.snapper.manage.metadata.type"><div class="titlepage"><div><div><h4 class="title" id="sec.snapper.manage.metadata.type"><span class="number">3.5.1.1 </span><span class="name">Snapshot Types</span> <a title="Permalink" class="permalink" href="#sec.snapper.manage.metadata.type">#</a></h4></div></div></div><p>
     Snapper knows three different types of snapshots: pre, post, and single.
     Physically they do not differ, but Snapper handles them differently.
    </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019141963952"><span class="term "><code class="literal">pre</code>
      </span></dt><dd><p>
        Snapshot of a file system <span class="emphasis"><em>before</em></span> a modification.
        Each <code class="literal">pre</code> snapshot has got a corresponding
        <code class="literal">post</code> snapshot. Used for the automatic YaST/Zypper
        snapshots, for example.
       </p></dd><dt id="idm140019141960448"><span class="term "><code class="literal">post</code>
      </span></dt><dd><p>
        Snapshot of a file system <span class="emphasis"><em>after</em></span> a modification.
        Each <code class="literal">post</code> snapshot has got a corresponding
        <code class="literal">pre</code> snapshot. Used for the automatic YaST/Zypper
        snapshots, for example.
       </p></dd><dt id="idm140019141956896"><span class="term "><code class="literal">single</code>
      </span></dt><dd><p>
        Stand-alone snapshot. Used for the automatic hourly snapshots, for
        example. This is the default type when creating snapshots.
       </p></dd></dl></div></div><div class="sect3 " id="sec.snapper.manage.metadata.cleanup"><div class="titlepage"><div><div><h4 class="title" id="sec.snapper.manage.metadata.cleanup"><span class="number">3.5.1.2 </span><span class="name">Cleanup-algorithms</span> <a title="Permalink" class="permalink" href="#sec.snapper.manage.metadata.cleanup">#</a></h4></div></div></div><p>
     Snapper provides three algorithms to clean up old snapshots. The
     algorithms are executed in a daily cron job. It is possible to define the
     number of different types of snapshots to keep in the Snapper
     configuration (see <a class="xref" href="#sec.snapper.config.modify" title="3.4.1. Managing Existing Configurations">Section 3.4.1, “Managing Existing Configurations”</a> for
     details).
    </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019141951680"><span class="term ">number</span></dt><dd><p>
        Deletes old snapshots when a certain snapshot count is reached.
       </p></dd><dt id="idm140019141949824"><span class="term ">timeline</span></dt><dd><p>
        Deletes old snapshots having passed a certain age, but keeps several
        hourly, daily, monthly, and yearly snapshots.
       </p></dd><dt id="idm140019141947904"><span class="term ">empty-pre-post</span></dt><dd><p>
        Deletes pre/post snapshot pairs with empty diffs.
       </p></dd></dl></div></div></div><div class="sect2 " id="sec.snapper.manage.create"><div class="titlepage"><div><div><h3 class="title" id="sec.snapper.manage.create"><span class="number">3.5.2 </span><span class="name">Creating Snapshots</span> <a title="Permalink" class="permalink" href="#sec.snapper.manage.create">#</a></h3></div></div></div><p>
    Creating a snapshot is done by running <code class="command">snapper create</code> or
    by clicking <span class="guimenu">Create</span> in the YaST module
    <span class="guimenu">Snapper</span>. The following examples explain how to create
    snapshots from the command line. It should be easy to adopt them when using
    the YaST interface.
   </p><div id="idm140019141942400" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.png" /><h6>Tip: Snapshot Description</h6><p>
     You should always specify a meaningful description to later be able to
     identify its purpose. Even more information can be specified via the user
     data option.
    </p></div><div class="variablelist "><dl class="variablelist"><dt id="idm140019141940320"><span class="term "><code class="command">snapper create --description "Snapshot for week 2
      2014"</code>
     </span></dt><dd><p>
       Creates a stand-alone snapshot (type single) for the default
       (<code class="literal">root</code>) configuration with a description. Because no
       cleanup-algorithm is specified, the snapshot will never be deleted
       automatically.
      </p></dd><dt id="idm140019141937552"><span class="term "><code class="command">snapper --config home create --description "Cleanup in
     ~tux"</code>
     </span></dt><dd><p>
       Creates a stand-alone snapshot (type single) for a custom configuration
       named <code class="literal">home</code> with a description. Because no
       cleanup-algorithm is specified, the snapshot will never be deleted
       automatically.
      </p></dd><dt id="idm140019141934784"><span class="term "><code class="command">snapper --config home create --description "Daily data
     backup" --cleanup-algorithm timeline</code>&gt;
     </span></dt><dd><p>
       Creates a stand-alone snapshot (type single) for a custom configuration
       named <code class="literal">home</code> with a description. The file will
       automatically be deleted when it meets the criteria specified for the
       timeline cleanup-algorithm in the configuration.
      </p></dd><dt id="idm140019141931936"><span class="term "><code class="command">snapper create --type pre --print-number --description
     "Before the Apache config cleanup" --userdata "important=yes"</code>
     </span></dt><dd><p>
       Creates a snapshot of the type <code class="literal">pre</code> and prints the
       snapshot number. First command needed to create a pair of snapshots used
       to save a <span class="quote">“<span class="quote">before</span>”</span> and <span class="quote">“<span class="quote">after</span>”</span> state. The
       snapshot is marked as important.
      </p></dd><dt id="idm140019141928240"><span class="term "><code class="command">snapper create --type post --pre-number 30 --description
     "After the Apache config cleanup" --userdata "important=yes"</code>
     </span></dt><dd><p>
       Creates a snapshot of the type <code class="literal">post</code> paired with the
       <code class="literal">pre</code> snapshot number <code class="literal">30</code>. Second
       command needed to create a pair of snapshots used to save a
       <span class="quote">“<span class="quote">before</span>”</span> and <span class="quote">“<span class="quote">after</span>”</span> state. The snapshot is
       marked as important.
      </p></dd><dt id="idm140019141923664"><span class="term "><code class="command">snapper create --command <em class="replaceable ">COMMAND</em>
     --description "Before and after COMMAND"</code>
     </span></dt><dd><p>
       Automatically creates a snapshot pair before and after running
       <em class="replaceable ">COMMAND</em>. This option is only available when
       using snapper on the command line.
      </p></dd></dl></div></div><div class="sect2 " id="sec.snapper.manage.modify"><div class="titlepage"><div><div><h3 class="title" id="sec.snapper.manage.modify"><span class="number">3.5.3 </span><span class="name">Modifying Snapshot Metadata</span> <a title="Permalink" class="permalink" href="#sec.snapper.manage.modify">#</a></h3></div></div></div><p>
    Snapper allows you to modify the description, the cleanup algorithm, and
    the user data of a snapshot. All other metadata cannot be changed. The
    following examples explain how to modify snapshots from the command line.
    It should be easy to adopt them when using the YaST interface.
   </p><p>
    To modify a snapshot on the command line, you need to know its number. Use
    <code class="command">snapper list</code> to display all snapshots
    and their numbers.
   </p><p>
    The YaST <span class="guimenu">Snapper</span> module already lists all snapshots.
    Choose one from the list and click <span class="guimenu">Modify</span>.
   </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019141915552"><span class="term "><code class="command">snapper modify --cleanup-algorithm "timeline"</code>
      10
     </span></dt><dd><p>
       Modifies the metadata of snapshot 10 for the default
       (<code class="literal">root</code>) configuration. The cleanup algorithm is set to
       <code class="literal">timeline</code>.
      </p></dd><dt id="idm140019141912448"><span class="term "><code class="command">snapper --config home modify --description "daily backup"
     -cleanup-algorithm "timeline" 120</code>
     </span></dt><dd><p>
       Modifies the metadata of snapshot 120 for a custom configuration named
       <code class="literal">home</code>. A new description is set and the cleanup
       algorithm is unset.
      </p></dd></dl></div></div><div class="sect2 " id="sec.snapper.manage.delete"><div class="titlepage"><div><div><h3 class="title" id="sec.snapper.manage.delete"><span class="number">3.5.4 </span><span class="name">Deleting Snapshots</span> <a title="Permalink" class="permalink" href="#sec.snapper.manage.delete">#</a></h3></div></div></div><p>
    To delete a snapshot with the YaST <span class="guimenu">Snapper</span> module,
    choose a snapshot from the list and click <span class="guimenu">Delete</span>.
   </p><p>
    To delete a snapshot with the command line tool, you need to know its
    number. Get it by running <code class="command">snapper list</code>. To delete a
    snapshot, run <code class="command">snapper delete</code>
    <em class="replaceable ">NUMBER</em>.
   </p><p>
    Deleting the current default subvolume snapshot is not allowed.
   </p><p>
    When deleting snapshots with Snapper, the freed space will be claimed by a
    Btrfs process running in the background. Thus the visibility and the
    availability of free space is delayed. In case you need space freed by
    deleting a snapshot to be available immediately, use the option
    <code class="option">--sync</code> with the delete command.
   </p><div id="idm140019141903232" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.png" /><h6>Tip: Deleting Snapshot Pairs</h6><p>
     When deleting a <code class="literal">pre</code> snapshot, you should always delete
     its corresponding <code class="literal">post</code> snapshot (and vice versa).
    </p></div><div class="variablelist "><dl class="variablelist"><dt id="idm140019141900640"><span class="term "><code class="command">snapper delete 65</code>
     </span></dt><dd><p>
       Deletes snapshot 65 for the default (<code class="literal">root</code>)
       configuration.
      </p></dd><dt id="idm140019141898064"><span class="term "><code class="command">snapper -c home delete 89 90</code>
     </span></dt><dd><p>
       Deletes snapshots 89 and 90 for a custom configuration named
       <code class="literal">home</code>.
      </p></dd><dt id="idm140019141895456"><span class="term "><code class="command">snapper delete --sync 23</code></span></dt><dd><p>
       Deletes snapshot 23 for the default (<code class="literal">root</code>)
       configuration and makes the freed space available immediately.
      </p></dd></dl></div><div id="idm140019141892816" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.png" /><h6>Tip: Delete Unreferenced Snapshots</h6><p>
     Sometimes the Btrfs snapshot is present but the XML file containing the
     metadata for Snapper is missing. In this case the snapshot is not visible
     for Snapper and needs to be deleted manually:
    </p><div class="verbatim-wrap"><pre class="screen">btrfs subvolume delete /.snapshots/<em class="replaceable ">SNAPSHOTNUMBER</em>/snapshot
rm -rf /.snapshots/SNAPSHOTNUMBER</pre></div></div><div id="idm140019141890320" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.png" /><h6>Tip: Old Snapshots Occupy More Disk Space</h6><p>
     If you delete snapshots to free space on your hard disk, make sure to
     delete old snapshots first. The older a snapshot is, the more disk space
     it occupies.
    </p></div><p>
    Snapshots are also automatically deleted by a daily cron job. Refer to
    <a class="xref" href="#sec.snapper.manage.metadata.cleanup" title="3.5.1.2. Cleanup-algorithms">Section 3.5.1.2, “Cleanup-algorithms”</a> for details.
   </p></div></div><div class="sect1 " id="sec.snapper.clean-up"><div class="titlepage"><div><div><h2 class="title" id="sec.snapper.clean-up"><span class="number">3.6 </span><span class="name">Automatic Snapshot Clean-Up</span> <a title="Permalink" class="permalink" href="#sec.snapper.clean-up">#</a></h2></div></div></div><p>
   Snapshots occupy disk space and over time the amount of disk space occupied
   by the snapshots may become large. To prevent disks from running out of
   space, Snapper offers algorithms to automatically delete old snapshots.
   These algorithms differentiate between timeline snapshots and numbered
   snapshots (administration plus installation snapshot pairs). You can specify
   the number of snapshots to keep for each type.
  </p><p>
   In addition to that, you can optionally specify a disk space quota, defining
   the maximum amount of disk space the snapshots may occupy. It is also
   possible to automatically delete pre and post snapshots pairs that do not
   differ.
  </p><p>
   A clean-up algorithm is always bound to a single Snapper configuration, so
   you need to configure algorithms for each configuration. To
   prevent certain snapshots from being automatically deleted, refer to
   <a class="xref" href="#faq.snapper.permanent" title="Q:"><em>
      How to make a snapshot permanent?
     </em></a>.
  </p><p>
   The default setup (<code class="literal">root</code>) is configured to do clean-up
   for numbered snapshots and empty pre and post snapshot pairs. Quota support
   is enabled—snapshots may not occupy more than 50% of the available
   disk space of the root partition. Timeline snapshots are disabled by
   default, therefore the timeline clean-up algorithm is also disabled.
  </p><div class="sect2 " id="sec.snapper.clean-up.number"><div class="titlepage"><div><div><h3 class="title" id="sec.snapper.clean-up.number"><span class="number">3.6.1 </span><span class="name">Cleaning Up Numbered Snapshots</span> <a title="Permalink" class="permalink" href="#sec.snapper.clean-up.number">#</a></h3></div></div></div><p>
    Cleaning up numbered snapshots—administration plus installation
    snapshot pairs—is controlled by the following parameters of a Snapper
    configuration.
   </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019141880128"><span class="term "><code class="literal">NUMBER_CLEANUP</code>
     </span></dt><dd><p>
       Enables or disables clean-up of installation and admin snapshot pairs.
       If enabled, snapshot pairs are deleted when the total snapshot count
       exceeds a number specified with <code class="literal">NUMBER_LIMIT</code> and/or
       <code class="literal">NUMBER_LIMIT_IMPORTANT</code> <span class="emphasis"><em>and</em></span> an
       age specified with <code class="literal">NUMBER_MIN_AGE</code>. Valid values:
       <code class="literal">yes</code> (enable), <code class="literal">no</code> (disable).
      </p><p>
       The default value is <code class="literal">"yes"</code>.
      </p><p>
       Example command to change or set:
      </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> snapper -c <em class="replaceable ">CONFIG</em> set-config "NUMBER_CLEANUP=no"</pre></div></dd><dt id="idm140019141872288"><span class="term "><code class="literal">NUMBER_LIMIT</code> /
      <code class="literal">NUMBER_LIMIT_IMPORTANT</code>
     </span></dt><dd><p>
       Defines how many regular and/or important installation and
       administration snapshot pairs to keep. Only the youngest snapshots will
       be kept. Ignored if <code class="literal">NUMBER_CLEANUP</code> is set to
       <code class="literal">"no"</code>.
      </p><p>
       The default value is <code class="literal">"2-10"</code> for
       <code class="literal">NUMBER_LIMIT</code> and <code class="literal">"4-10"</code> for
       <code class="literal">NUMBER_LIMIT_IMPORTANT</code>.
      </p><p>
       Example command to change or set:
      </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> snapper -c <em class="replaceable ">CONFIG</em> set-config "NUMBER_LIMIT=10"</pre></div><div id="idm140019141864800" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.png" /><h6>Important: Ranged Compared to Constant Values</h6><p>
        In case quota support is enabled (see
        <a class="xref" href="#sec.snapper.clean-up.quota" title="3.6.5. Adding Disk Quota Support">Section 3.6.5, “Adding Disk Quota Support”</a>) the limit needs
        to be specified as a minimum-maximum range, for example
        <code class="literal">2-10</code>. If quota support is disabled, a constant
        value, for example <code class="literal">10</code>, needs to be provided,
        otherwise cleaning-up will fail with an error.
       </p></div></dd><dt id="idm140019141861424"><span class="term "><code class="literal">NUMBER_MIN_AGE</code>
     </span></dt><dd><p>
       Defines the minimum age in seconds a snapshot must have before it can
       automatically be deleted. Snapshots younger than the value specified
       here will not be deleted, regardless of how many exist.
      </p><p>
       The default value is <code class="literal">"1800"</code>.
      </p><p>
       Example command to change or set:
      </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> snapper -c <em class="replaceable ">CONFIG</em> set-config "NUMBER_MIN_AGE=864000"</pre></div></dd></dl></div><div id="idm140019141856096" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note: Limit and Age</h6><p>
     <code class="literal">NUMBER_LIMIT</code>, <code class="literal">NUMBER_LIMIT_IMPORTANT</code>
     and <code class="literal">NUMBER_MIN_AGE</code> are always evaluated. Snapshots are
     only deleted when <span class="emphasis"><em>all</em></span> conditions are met.
    </p><p>
     If you always want to keep the number of snapshots defined with
     <code class="literal">NUMBER_LIMIT*</code> regardless of their age, set
     <code class="literal">NUMBER_MIN_AGE</code> to <code class="literal">0</code>.
    </p><p>
     The following example shows a configuration to keep the last 10 important
     and regular snapshots regardless of age:
    </p><div class="verbatim-wrap"><pre class="screen">NUMBER_CLEANUP=yes
NUMBER_LIMIT_IMPORTANT=10
NUMBER_LIMIT=10
NUMBER_MIN_AGE=0</pre></div><p>
     On the other hand, if you do not want to keep snapshots beyond a certain
     age, set <code class="literal">NUMBER_LIMIT*</code> to <code class="literal">0</code> and
     provide the age with <code class="literal">NUMBER_MIN_AGE</code>.
    </p><p>
     The following example shows a configuration to only keep snapshots younger
     than ten days:
    </p><div class="verbatim-wrap"><pre class="screen">NUMBER_CLEANUP=yes
NUMBER_LIMIT_IMPORTANT=0
NUMBER_LIMIT=0
NUMBER_MIN_AGE=864000</pre></div></div></div><div class="sect2 " id="sec.snapper.clean-up.timeline"><div class="titlepage"><div><div><h3 class="title" id="sec.snapper.clean-up.timeline"><span class="number">3.6.2 </span><span class="name">Cleaning Up Timeline Snapshots</span> <a title="Permalink" class="permalink" href="#sec.snapper.clean-up.timeline">#</a></h3></div></div></div><p>
    Cleaning up timeline snapshots is controlled by the following
    parameters of a Snapper configuration.
   </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019141844800"><span class="term "><code class="literal">TIMELINE_CLEANUP</code>
     </span></dt><dd><p>
       Enables or disables clean-up of timeline snapshots. If enabled,
       snapshots are deleted when the total snapshot count exceeds a number
       specified with <code class="literal">TIMELINE_LIMIT_*</code>
       <span class="emphasis"><em>and</em></span> an age specified with
       <code class="literal">TIMELINE_MIN_AGE</code>. Valid values:
       <code class="literal">yes</code>, <code class="literal">no</code>.
      </p><p>
       The default value is <code class="literal">"yes"</code>.
      </p><p>
       Example command to change or set:
      </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> snapper -c <em class="replaceable ">CONFIG</em> set-config "TIMELINE_CLEANUP=yes"</pre></div></dd><dt id="idm140019141837424"><span class="term "><code class="literal">TIMELINE_LIMIT_DAILY</code>,
      <code class="literal">TIMELINE_LIMIT_HOURLY</code>,
      <code class="literal">TIMELINE_LIMIT_MONTHLY</code>,
      <code class="literal">TIMELINE_LIMIT_WEEKLY</code>,
      <code class="literal">TIMELINE_LIMIT_YEARLY</code>
     </span></dt><dd><p>
       Number of snapshots to keep for hour, day, month, week, and year.
      </p><p>
       The default value for each entry is <code class="literal">"10"</code>, except for
       <code class="literal">TIMELINE_LIMIT_WEEKLY</code>, which is set to
       <code class="literal">"0"</code> by default.
      </p></dd><dt id="idm140019141831648"><span class="term "><code class="literal">TIMELINE_MIN_AGE</code>
     </span></dt><dd><p>
       Defines the minimum age in seconds a snapshot must have before it can
       automatically be deleted.
      </p><p>
       The default value is <code class="literal">"1800"</code>.
      </p></dd></dl></div><div class="complex-example"><div class="example" id="ex.snapper.config.timeline"><div class="example-title-wrap"><h6 class="example-title"><span class="number">Example 3.1: </span><span class="name">Example timeline configuration </span><a title="Permalink" class="permalink" href="#ex.snapper.config.timeline">#</a></h6></div><div class="example-contents"><div class="verbatim-wrap"><pre class="screen">TIMELINE_CLEANUP="yes"
TIMELINE_CREATE="yes"
TIMELINE_LIMIT_DAILY="7"
TIMELINE_LIMIT_HOURLY="24"
TIMELINE_LIMIT_MONTHLY="12"
TIMELINE_LIMIT_WEEKLY="4"
TIMELINE_LIMIT_YEARLY="2"
TIMELINE_MIN_AGE="1800"</pre></div><p>
     This example configuration enables hourly snapshots which are
     automatically cleaned up. <code class="literal">TIMELINE_MIN_AGE</code> and
     <code class="literal">TIMELINE_LIMIT_*</code> are always both evaluated. In this
     example, the minimum age of a snapshot before it can be deleted is set to
     30 minutes (1800 seconds). Since we create hourly snapshots, this ensures
     that only the latest snapshots are kept. If
     <code class="literal">TIMELINE_LIMIT_DAILY</code> is set to not zero, this means
     that the first snapshot of the day is kept, too.
    </p><div class="itemizedlist "><div class="itemizedlist-title-wrap"><h6 class="itemizedlist-title"><span class="name">Snapshots to be Kept </span><a title="Permalink" class="permalink" href="#idm140019141824352">#</a></h6></div><ul class="itemizedlist"><li class="listitem "><p>
       Hourly: The last 24 snapshots that have been made.
      </p></li><li class="listitem "><p>
       Daily: The first daily snapshot that has been made is kept from the last
       seven days.
      </p></li><li class="listitem "><p>
       Monthly: The first snapshot made on the last day of the month is kept
       for the last twelve months.
      </p></li><li class="listitem "><p>
       Weekly: The first snapshot made on the last day of the week is kept from
       the last four weeks.
      </p></li><li class="listitem "><p>
       Yearly: The first snapshot made on the last day of the year is kept for
       the last two years.
      </p></li></ul></div></div></div></div></div><div class="sect2 " id="sec.snapper.clean-up.empty"><div class="titlepage"><div><div><h3 class="title" id="sec.snapper.clean-up.empty"><span class="number">3.6.3 </span><span class="name">Cleaning Up Snapshot Pairs That Do Not Differ</span> <a title="Permalink" class="permalink" href="#sec.snapper.clean-up.empty">#</a></h3></div></div></div><p>
    As explained in <a class="xref" href="#snapper.snapshot-type" title="3.1.1. Types of Snapshots">Section 3.1.1, “Types of Snapshots”</a>, whenever you run a
    YaST module or execute Zypper, a pre snapshot is created on start-up and
    a post snapshot is created when exiting. In case you have not made any
    changes there will be no difference between the pre and post snapshots.
    Such <span class="quote">“<span class="quote">empty</span>”</span> snapshot pairs can be automatically be deleted by
    setting the following parameters in a Snapper configuration:
   </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019141814384"><span class="term "><code class="literal">EMPTY_PRE_POST_CLEANUP</code>
     </span></dt><dd><p>
       If set to <code class="literal">yes</code>, pre and post snapshot pairs that do
       not differ will be deleted.
      </p><p>
       The default value is <code class="literal">"yes"</code>.
      </p></dd><dt id="idm140019141810928"><span class="term "><code class="literal">EMPTY_PRE_POST_MIN_AGE</code>
     </span></dt><dd><p>
       Defines the minimum age in seconds a pre and post snapshot pair that
       does not differ must have before it can automatically be deleted.
      </p><p>
       The default value is <code class="literal">"1800"</code>.
      </p></dd></dl></div></div><div class="sect2 " id="sec.snapper.clean-up.manual"><div class="titlepage"><div><div><h3 class="title" id="sec.snapper.clean-up.manual"><span class="number">3.6.4 </span><span class="name">Cleaning Up Manually Created Snapshots</span> <a title="Permalink" class="permalink" href="#sec.snapper.clean-up.manual">#</a></h3></div></div></div><p>
    Snapper does not offer custom clean-up algorithms for manually created
    snapshots. However, you can assign the number or timeline clean-up
    algorithm to a manually created snapshot. If you do so, the snapshot will
    join the <span class="quote">“<span class="quote">clean-up queue</span>”</span> for the algorithm you specified.
    You can specify a clean-up algorithm when creating a snapshot, or by
    modifying an existing snapshot:
   </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019141804784"><span class="term "><code class="command">snapper create --description "Test" --cleanup-algorithm number</code>
     </span></dt><dd><p>
       Creates a stand-alone snapshot (type single) for the default (root)
       configuration and assigns the <code class="literal">number</code> clean-up
       algorithm.
      </p></dd><dt id="idm140019141802096"><span class="term "><code class="command">snapper modify --cleanup-algorithm "timeline" 25</code>
     </span></dt><dd><p>
       Modifies the snapshot with the number 25 and assigns the clean-up
       algorithm <code class="literal">timeline</code>.
      </p></dd></dl></div></div><div class="sect2 " id="sec.snapper.clean-up.quota"><div class="titlepage"><div><div><h3 class="title" id="sec.snapper.clean-up.quota"><span class="number">3.6.5 </span><span class="name">Adding Disk Quota Support</span> <a title="Permalink" class="permalink" href="#sec.snapper.clean-up.quota">#</a></h3></div></div></div><p>
    In addition to the number and/or timeline clean-up algorithms described
    above, Snapper supports quotas. You can define what percentage of the
    available space snapshots are allowed to occupy. This percentage value
    always applies to the Btrfs subvolume defined in the respective Snapper
    configuration.
   </p><p>
    If Snapper was enabled during the installation, quota support is
    automatically enabled. In case you manually enable Snapper at a later point
    in time, you can enable quota support by running <code class="command">snapper
    setup-quota</code>. This requires a valid configuration (see
    <a class="xref" href="#sec.snapper.config" title="3.4. Creating and Modifying Snapper Configurations">Section 3.4, “Creating and Modifying Snapper Configurations”</a> for more information).
   </p><p>
    Quota support is controlled by the following parameters of a Snapper
    configuration.
   </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019141794656"><span class="term "><code class="literal">QGROUP</code>
     </span></dt><dd><p>
       The Btrfs quota group used by Snapper. If not set, run <code class="command">snapper
       setup-quota</code>. If already set, only change if you are familiar
       with <code class="command">man 8 btrfs-qgroup</code>. This value is set with
       <code class="command">snapper setup-quota</code> and should not be changed.
      </p></dd><dt id="idm140019141791088"><span class="term "><code class="literal">SPACE_LIMIT</code>
     </span></dt><dd><p>
       Limit of space snapshots are allowed to use in fractions of 1 (100%).
       Valid values range from 0 to 1 (0.1 = 10%, 0.2 = 20%, ...).
      </p></dd></dl></div><p>
    The following limitations and guidelines apply:
   </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
      Quotas are only activated in <span class="emphasis"><em>addition</em></span> to an existing
      number and/or timeline clean-up algorithm. If no clean-up algorithm is
      active, quota restrictions are not applied.
     </p></li><li class="listitem "><p>
      With quota support enabled, Snapper will perform two clean-up runs if
      required. The first run will apply the rules specified for number and
      timeline snapshots. Only if the quota is exceeded after this run, the
      quota-specific rules will be applied in a second run.
     </p></li><li class="listitem "><p>
      Even if quota support is enabled, Snapper will always keep the number of
      snapshots specified with the <code class="literal">NUMBER_LIMIT*</code> and
      <code class="literal">TIMELINE_LIMIT*</code> values, even if the quota will be
      exceeded. It is therefore recommended to specify ranged values
      (<code class="literal"><em class="replaceable ">MIN</em>-<em class="replaceable ">MAX</em></code>)
      for <code class="literal">NUMBER_LIMIT*</code> and
      <code class="literal">TIMELINE_LIMIT*</code> to ensure the quota can be applied.
     </p><p>
      If, for example, <code class="literal">NUMBER_LIMIT=5-20</code> is set, Snapper
      will perform a first clean-up run and reduce the number of regular
      numbered snapshots to 20. In case these 20 snapshots exceed the
      quota, Snapper will delete the oldest ones in a second run until the
      quota is met. A minimum of five snapshots will always be kept, regardless
      of the amount of space they occupy.
     </p></li></ul></div></div></div><div class="sect1 " id="sec.snapper.faqs"><div class="titlepage"><div><div><h2 class="title" id="sec.snapper.faqs"><span class="number">3.7 </span><span class="name">Frequently Asked Questions</span> <a title="Permalink" class="permalink" href="#sec.snapper.faqs">#</a></h2></div></div></div><div class="qandaset" id="idm140019141778416"><div class="free-id" id="idm140019141777856"></div><dl class="qandaentry"><dt class="question" id="idm140019141777568">
      Why does Snapper Never Show Changes in <code class="filename">/var/log</code>,
      <code class="filename">/tmp</code> and Other Directories?
     </dt><dd class="answer" id="idm140019141775728"><p>
      For some directories we decided to exclude them from snapshots. See
      <a class="xref" href="#snapper.dir-excludes" title="3.1.2. Directories That Are Excluded from Snapshots">Section 3.1.2, “Directories That Are Excluded from Snapshots”</a> for a list and reasons. To exclude
      a path from snapshots we create a subvolume for that path.
     </p></dd></dl><div class="free-id" id="idm140019141773952"></div><dl class="qandaentry"><dt class="question" id="idm140019141773664">
      How much disk space is used by snapshots? How to free disk space?
     </dt><dd class="answer" id="idm140019141772704"><p>
      Displaying the amount of disk space a snapshot allocates is currently not
      supported by the <code class="literal">Btrfs</code> tools. However, if you have
      quota enabled, it is possible to determine how much space would be freed
      if <span class="emphasis"><em>all</em></span> snapshots would be deleted:
     </p><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
        Get the quota group ID (<code class="literal">1/0</code> in the following
        example):
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> snapper -c root get-config | grep QGROUP
QGROUP                 | 1/0</pre></div></li><li class="step "><p>
        Rescan the subvolume quotas:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> btrfs quota rescan -w /</pre></div></li><li class="step "><p>
        Show the data of the quota group (<code class="literal">1/0</code> in the
        following example):
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> btrfs qgroup show / | grep "1/0"
1/0           4.80GiB    108.82MiB</pre></div><p>
        The third column shows the amount of space that would be freed when
        deleting all snapshots (<code class="literal">108.82MiB</code>).
       </p></li></ol></div></div><p>
      To free space on a <code class="literal">Btrfs</code> partition containing
      snapshots you need to delete unneeded snapshots rather than files. Older
      snapshots occupy more space than recent ones. See
      <a class="xref" href="#sec.snapper.setup.customize.archiving" title="3.1.3.4. Controlling Snapshot Archiving">Section 3.1.3.4, “Controlling Snapshot Archiving”</a> for details.
     </p><p>
      Doing an upgrade from one service pack to another results in snapshots
      occupying a lot of disk space on the system subvolumes, because a lot of
      data gets changed (package updates). Manually deleting these snapshots
      after they are no longer needed is recommended. See
      <a class="xref" href="#sec.snapper.manage.delete" title="3.5.4. Deleting Snapshots">Section 3.5.4, “Deleting Snapshots”</a> for details.
     </p></dd></dl><div class="free-id" id="idm140019141759248"></div><dl class="qandaentry"><dt class="question" id="idm140019141758960">
      Can I Boot a Snapshot from the Boot Loader?
     </dt><dd class="answer" id="idm140019141758016"><p>
      Yes—refer to <a class="xref" href="#sec.snapper.snapshot-boot" title="3.3. System Rollback by Booting from Snapshots">Section 3.3, “System Rollback by Booting from Snapshots”</a> for
      details.
     </p></dd></dl><div class="free-id" id="faq.snapper.permanent"></div><dl class="qandaentry"><dt class="question" id="idm140019141755712">
      How to make a snapshot permanent?
     </dt><dd class="answer" id="idm140019141754784"><p>
      Currently Snapper does not offer means to prevent a snapshot from being
      deleted manually. However, you can prevent snapshots from being
      automatically deleted by clean-up algorithms. Manually created snapshots
      (see <a class="xref" href="#sec.snapper.manage.create" title="3.5.2. Creating Snapshots">Section 3.5.2, “Creating Snapshots”</a>) have no clean-up
      algorithm assigned unless you specify one with
      <code class="option">--cleanup-algorithm</code>. Automatically created snapshots
      always either have the <code class="literal">number</code> or
      <code class="literal">timeline</code> algorithm assigned. To remove such an
      assignment from one or more snapshots, proceed as follows:
     </p><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
        List all available snapshots:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> snapper list -a</pre></div></li><li class="step "><p>
        Memorize the number of the snapshot(s) you want to prevent from being
        deleted.
       </p></li><li class="step "><p>
        Run the following command and replace the number placeholders with the
        number(s) you memorized:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> snapper modify --cleanup-algorithm "" <em class="replaceable ">#1</em> <em class="replaceable ">#2</em> <em class="replaceable ">#n</em></pre></div></li><li class="step "><p>
        Check the result by running <code class="command">snapper list -a</code> again.
        The entry in the column <code class="literal">Cleanup</code> should now be empty
        for the snapshots you modified.
       </p></li></ol></div></div></dd></dl><div class="free-id" id="idm140019141742880"></div><dl class="qandaentry"><dt class="question" id="idm140019141742592">
      Where can I get more information on Snapper?
     </dt><dd class="answer" id="idm140019141741648"><p>
      See the Snapper home page at <a class="link" href="http://snapper.io/" target="_blank">http://snapper.io/</a>.
     </p></dd></dl></div></div></div><div class="chapter " id="cha.vnc"><div class="titlepage"><div><div><h2 class="title"><span class="number">4 </span><span class="name">Remote Access with VNC</span> <a title="Permalink" class="permalink" href="#cha.vnc">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">Filename: </span>vnc.xml</li><li><span class="ds-label">ID: </span>cha.vnc</li></ul></div></div><div><div class="abstract"><div class="abstract-title-wrap"><h6 class="abstract-title">Abstract<a title="Permalink" class="permalink" href="#idm140019141735552">#</a></h6></div><p>
    Virtual Network Computing (VNC) enables you to control a remote computer
    via a graphical desktop (as opposed to a remote shell access). VNC is
    platform-independent and lets you access the remote machine from any
    operating system.
   </p><p>
    <span class="productname"><span class="phrase">openSUSE Leap</span></span> supports two different kinds of VNC sessions: One-time
    sessions that <span class="quote">“<span class="quote">live</span>”</span> as long as the VNC connection from the
    client is kept up, and persistent sessions that <span class="quote">“<span class="quote">live</span>”</span> until
    they are explicitly terminated.
   </p></div></div></div></div><div class="line"><div class="toc"><dl><dt><span class="sect1"><a href="#sec.vnc.viewer"><span class="number">4.1 </span><span class="name">The <code class="command">vncviewer</code> Client</span></a></span></dt><dt><span class="sect1"><a href="#vnc.remmina"><span class="number">4.2 </span><span class="name">Remmina: the Remote Desktop Client</span></a></span></dt><dt><span class="sect1"><a href="#sec.vnc.one-time"><span class="number">4.3 </span><span class="name">One-time VNC Sessions</span></a></span></dt><dt><span class="sect1"><a href="#sec.vnc.persistent"><span class="number">4.4 </span><span class="name">Persistent VNC Sessions</span></a></span></dt><dt><span class="sect1"><a href="#sec.vnc.encrypt"><span class="number">4.5 </span><span class="name">Encrypted VNC Communication</span></a></span></dt></dl></div></div><div id="idm140019141731616" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note: Session Types</h6><p>
   A machine can offer both kinds of sessions simultaneously on different
   ports, but an open session cannot be converted from one type to the other.
  </p></div><div id="idm140019141730128" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.png" /><h6>Important: Supported Display Managers</h6><p>
   A machine can reliably accept VNC connections only if it uses a display
   manager that supports the XDMCP protocol. While
   <code class="systemitem">gdm</code>, <code class="systemitem">lxdm</code>, or
   <code class="systemitem">lightdm</code> support XDMCP, the KDE 5 default display
   manager <code class="systemitem">sddm</code> does not support it. When changing the
   default display manager, remember to log out of the current X session and
   restart the display manager with
  </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>sudo systemctl restart xdm.service</pre></div></div><div class="sect1 " id="sec.vnc.viewer"><div class="titlepage"><div><div><h2 class="title" id="sec.vnc.viewer"><span class="number">4.1 </span><span class="name">The <code class="command">vncviewer</code> Client</span> <a title="Permalink" class="permalink" href="#sec.vnc.viewer">#</a></h2></div></div></div><p>
   To connect to a VNC service provided by a server, a client is needed. The
   default in <span class="productname"><span class="phrase">openSUSE Leap</span></span> is <code class="command">vncviewer</code>, provided by the
   <code class="systemitem">tigervnc</code> package.
  </p><div class="sect2 " id="sec.vnc.viewer.connectcli"><div class="titlepage"><div><div><h3 class="title" id="sec.vnc.viewer.connectcli"><span class="number">4.1.1 </span><span class="name">Connecting Using the vncviewer CLI</span> <a title="Permalink" class="permalink" href="#sec.vnc.viewer.connectcli">#</a></h3></div></div></div><p>
    To start your VNC viewer and initiate a session with the server, use the
    command:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>vncviewer jupiter.example.com:1</pre></div><p>
    Instead of the VNC display number you can also specify the port number with
    two colons:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>vncviewer jupiter.example.com::5901</pre></div><div id="idm140019141717360" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note: Display and Port Number</h6><p>
     The actual display or port number you specify in the VNC client must be
     the same as the display or port number picked by the
     <code class="command">vncserver</code> command on the target machine. See
     <a class="xref" href="#sec.vnc.persistent" title="4.4. Persistent VNC Sessions">Section 4.4, “Persistent VNC Sessions”</a> for further info.
    </p></div></div><div class="sect2 " id="sec.vnc.viewer.connectgui"><div class="titlepage"><div><div><h3 class="title" id="sec.vnc.viewer.connectgui"><span class="number">4.1.2 </span><span class="name">Connecting Using the vncviewer GUI</span> <a title="Permalink" class="permalink" href="#sec.vnc.viewer.connectgui">#</a></h3></div></div></div><p>
    By running <code class="command">vncviewer</code> without specifying
    <code class="command">--listen</code> or a host to connect to, it will show a window
    to ask for connection details. Enter the host into the <span class="guimenu">VNC
    server</span> field like in <a class="xref" href="#sec.vnc.viewer.connectcli" title="4.1.1. Connecting Using the vncviewer CLI">Section 4.1.1, “Connecting Using the vncviewer CLI”</a>
    and click <span class="guimenu">Connect</span>.
   </p><div class="figure" id="fig.vnc.viewer.connectgui"><div class="figure-contents"><div class="mediaobject"><a xmlns="" href="images/vnc_connect.png"><img src="images/vnc_connect.png" width="" alt="vncviewer asking for connection details" /></a></div></div><div class="figure-title-wrap"><h6 class="figure-title"><span class="number">Figure 4.1: </span><span class="name">vncviewer </span><a title="Permalink" class="permalink" href="#fig.vnc.viewer.connectgui">#</a></h6></div></div></div><div class="sect2 " id="sec.vnc.viewer.encrypt"><div class="titlepage"><div><div><h3 class="title" id="sec.vnc.viewer.encrypt"><span class="number">4.1.3 </span><span class="name">Notification of Unencrypted Connections</span> <a title="Permalink" class="permalink" href="#sec.vnc.viewer.encrypt">#</a></h3></div></div></div><p>
    The VNC protocol supports different kinds of encrypted connections, not to
    be confused with password authentication. If a connection does not use TLS,
    the text <span class="quote">“<span class="quote">(Connection not encrypted!)</span>”</span> can be seen in the
    window title of the VNC viewer.
   </p></div></div><div class="sect1 " id="vnc.remmina"><div class="titlepage"><div><div><h2 class="title" id="vnc.remmina"><span class="number">4.2 </span><span class="name">Remmina: the Remote Desktop Client</span> <a title="Permalink" class="permalink" href="#vnc.remmina">#</a></h2></div></div></div><p>
   Remmina is a modern and feature rich remote desktop client. It supports
   several access methods, for example VNC, SSH, RDP, or Spice.
  </p><div class="sect2 " id="vnc.remmina.install"><div class="titlepage"><div><div><h3 class="title" id="vnc.remmina.install"><span class="number">4.2.1 </span><span class="name">Installation</span> <a title="Permalink" class="permalink" href="#vnc.remmina.install">#</a></h3></div></div></div><p>
    To use Remmina, verify whether the <span class="package">remmina</span> package is
    installed on your system, and install it if not. Remember to install the
    VNC plug-in for Remmina as well:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>zypper in remmina remmina-plugin-vnc</pre></div></div><div class="sect2 " id="vnc.remmina.usage"><div class="titlepage"><div><div><h3 class="title" id="vnc.remmina.usage"><span class="number">4.2.2 </span><span class="name">Main Window</span> <a title="Permalink" class="permalink" href="#vnc.remmina.usage">#</a></h3></div></div></div><p>
    Run Remmina by entering the <code class="command">remmina</code> command.
   </p><div class="figure" id="idm140019141694432"><div class="figure-contents"><div class="mediaobject"><a xmlns="" href="images/remmina.png"><img src="images/remmina.png" width="" alt="Remmina's Main Window" /></a></div></div><div class="figure-title-wrap"><h6 class="figure-title"><span class="number">Figure 4.2: </span><span class="name">Remmina's Main Window </span><a title="Permalink" class="permalink" href="#idm140019141694432">#</a></h6></div></div><p>
    The main application window shows the list of stored remote sessions. Here
    you can add and save a new remote session, quick-start a new session
    without saving it, start a previously saved session, or set Remmina's
    global preferences.
   </p></div><div class="sect2 " id="vnc.remmina.addnew"><div class="titlepage"><div><div><h3 class="title" id="vnc.remmina.addnew"><span class="number">4.2.3 </span><span class="name">Adding Remote Sessions</span> <a title="Permalink" class="permalink" href="#vnc.remmina.addnew">#</a></h3></div></div></div><p>
    To add and save a new remote session, click <span class="inlinemediaobject"><img xmlns="" src="images/remmina_plus.png" width="" alt="Add new session" /></span> in the top left of the main window. The
    <span class="guimenu">Remote Desktop Preference</span> window opens.
   </p><div class="figure" id="idm140019141681344"><div class="figure-contents"><div class="mediaobject"><a xmlns="" href="images/remmina_session_details.png"><img src="images/remmina_session_details.png" width="" alt="Remote Desktop Preference" /></a></div></div><div class="figure-title-wrap"><h6 class="figure-title"><span class="number">Figure 4.3: </span><span class="name">Remote Desktop Preference </span><a title="Permalink" class="permalink" href="#idm140019141681344">#</a></h6></div></div><p>
    Complete the fields that specify your newly added remote session profile.
    The most important are:
   </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019141675472"><span class="term ">Name</span></dt><dd><p>
       Name of the profile. It will be listed in the main window.
      </p></dd><dt id="idm140019141673616"><span class="term ">Protocol</span></dt><dd><p>
       The protocol to use when connection to the remote session, for example
       VNC.
      </p></dd><dt id="idm140019141671744"><span class="term ">Server</span></dt><dd><p>
       The IP or DNS address and display number of the remote server.
      </p></dd><dt id="idm140019141669888"><span class="term ">User name, Password</span></dt><dd><p>
       Credentials to use for remote authentication. Leave empty for no
       authentication.
      </p></dd><dt id="idm140019141668016"><span class="term ">Color depth, Quality</span></dt><dd><p>
       Select the best options according to you connection speed and quality.
      </p></dd></dl></div><p>
    Select the <span class="guimenu">Advanced</span> tab to enter more specific settings.
   </p><div id="idm140019141665072" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.png" /><h6>Tip: Disable Encryption</h6><p>
     If the communication between the client and the remote server is not
     encrypted, activate <span class="guimenu">Disable encryption</span>, otherwise the
     connection fails.
    </p></div><p>
    Select the <span class="guimenu">SSH</span> tab for advanced SSH tunneling and
    authentication options.
   </p><p>
    Confirm with <span class="guimenu">Save</span>. Your new profile will be listed in
    the main window.
   </p></div><div class="sect2 " id="vnc.remmina.start"><div class="titlepage"><div><div><h3 class="title" id="vnc.remmina.start"><span class="number">4.2.4 </span><span class="name">Starting Remote Sessions</span> <a title="Permalink" class="permalink" href="#vnc.remmina.start">#</a></h3></div></div></div><p>
    You can either start a previously saved session, or quick-start a remote
    session without saving the connection details.
   </p><div class="sect3 " id="vnc.remmina.quickstart"><div class="titlepage"><div><div><h4 class="title" id="vnc.remmina.quickstart"><span class="number">4.2.4.1 </span><span class="name">Quick-starting Remote Sessions</span> <a title="Permalink" class="permalink" href="#vnc.remmina.quickstart">#</a></h4></div></div></div><p>
     To start a remote session quickly without proper adding and saving
     connection details, use the drop-down box and text field at the top of the
     main window.
    </p><div class="figure" id="idm140019141657648"><div class="figure-contents"><div class="mediaobject"><a xmlns="" href="images/remmina_quickstart.png"><img src="images/remmina_quickstart.png" width="" alt="Quick-starting" /></a></div></div><div class="figure-title-wrap"><h6 class="figure-title"><span class="number">Figure 4.4: </span><span class="name">Quick-starting </span><a title="Permalink" class="permalink" href="#idm140019141657648">#</a></h6></div></div><p>
     Select the communication protocol from the drop-down box, for example
     'VNC', then enter the VNC server DNS or IP address followed by a colon and
     a display number, and confirm with <span class="keycap">Enter</span>.
    </p></div><div class="sect3 " id="idm140019141651312"><div class="titlepage"><div><div><h4 class="title" id="idm140019141651312"><span class="number">4.2.4.2 </span><span class="name">Opening Saved Remote Sessions</span> <a title="Permalink" class="permalink" href="#idm140019141651312">#</a></h4></div></div></div><p>
     To open a specific remote session, double-click it from the list of
     sessions.
    </p></div><div class="sect3 " id="idm140019141649872"><div class="titlepage"><div><div><h4 class="title" id="idm140019141649872"><span class="number">4.2.4.3 </span><span class="name">Remote Sessions Window</span> <a title="Permalink" class="permalink" href="#idm140019141649872">#</a></h4></div></div></div><p>
     Remote sessions are opened in tabs of a separate window. Each tab hosts
     one session. The toolbar on the left of the window helps you manage the
     windows / sessions, such as toggle fullscreen mode, resize the window to
     match the display size of the session, send specific keystrokes to the
     session, take screenshots of the session, or set the image quality.
    </p><div class="figure" id="idm140019141648320"><div class="figure-contents"><div class="mediaobject"><a xmlns="" href="images/remmina_sle15inside.png"><img src="images/remmina_sle15inside.png" width="" alt="Remmina Viewing SLES 15 Remote Session" /></a></div></div><div class="figure-title-wrap"><h6 class="figure-title"><span class="number">Figure 4.5: </span><span class="name">Remmina Viewing SLES 15 Remote Session </span><a title="Permalink" class="permalink" href="#idm140019141648320">#</a></h6></div></div></div></div><div class="sect2 " id="vnc.remmina.edit_delete_clone"><div class="titlepage"><div><div><h3 class="title" id="vnc.remmina.edit_delete_clone"><span class="number">4.2.5 </span><span class="name">Editing, Copying, and Deleting Saved Sessions</span> <a title="Permalink" class="permalink" href="#vnc.remmina.edit_delete_clone">#</a></h3></div></div></div><p>
    To <span class="emphasis"><em>edit</em></span> a saved remote session, right-click its name
    in the Remmina's main window and select <span class="guimenu">Edit</span>. Refer to
    <a class="xref" href="#vnc.remmina.addnew" title="4.2.3. Adding Remote Sessions">Section 4.2.3, “Adding Remote Sessions”</a> for the description of the relevant
    fields.
   </p><p>
    To <span class="emphasis"><em>copy</em></span> a saved remote session, right-click its name
    in the Remmina's main window and select <span class="guimenu">Copy</span>. In the
    <span class="guimenu">Remote Desktop Preference</span> window, change the name of the
    profile, optionally adjust relevant options, and confirm with
    <span class="guimenu">Save</span>.
   </p><p>
    To <span class="emphasis"><em>Delete</em></span> a saved remote session, right-click its name
    in the Remmina's main window and select <span class="guimenu">Delete</span>. Confirm
    with <span class="guimenu">Yes</span> in the next dialog.
   </p></div><div class="sect2 " id="vnc.remmina.cmdline"><div class="titlepage"><div><div><h3 class="title" id="vnc.remmina.cmdline"><span class="number">4.2.6 </span><span class="name">Running Remote Sessions from the Command Line</span> <a title="Permalink" class="permalink" href="#vnc.remmina.cmdline">#</a></h3></div></div></div><p>
    If you need to open a remote session from the command line or from a batch
    file without first opening the main application window, use the following
    syntax:
   </p><div class="verbatim-wrap"><pre class="screen"> <code class="prompt user">tux &gt; </code>remmina -c <em class="replaceable ">profile_name</em>.remmina</pre></div><p>
    Remmina's profile files are stored in the
    <code class="filename">.local/share/remmina/</code> directory in your home
    directory. To determine which profile file belongs to the session you want
    to open, run Remmina, click the session name in the main window, and read
    the path to the profile file in the window's status line at the bottom.
   </p><div class="figure" id="idm140019141630960"><div class="figure-contents"><div class="mediaobject"><a xmlns="" href="images/remmina_status.png"><img src="images/remmina_status.png" width="" alt="Reading Path to the Profile File" /></a></div></div><div class="figure-title-wrap"><h6 class="figure-title"><span class="number">Figure 4.6: </span><span class="name">Reading Path to the Profile File </span><a title="Permalink" class="permalink" href="#idm140019141630960">#</a></h6></div></div><p>
    While Remmina is not running, you can rename the profile file to to a more
    reasonable file name, such as <code class="filename">sle15.remmina</code>. You can
    even copy the profile file to your custom directory and run it using the
    <code class="command">remmina -c</code> command from there.
   </p></div></div><div class="sect1 " id="sec.vnc.one-time"><div class="titlepage"><div><div><h2 class="title" id="sec.vnc.one-time"><span class="number">4.3 </span><span class="name">One-time VNC Sessions</span> <a title="Permalink" class="permalink" href="#sec.vnc.one-time">#</a></h2></div></div></div><p>
   A one-time session is initiated by the remote client. It starts a graphical
   login screen on the server. This way you can choose the user which starts
   the session and, if supported by the login manager, the desktop environment.
   When you terminate the client connection to such a VNC session, all
   applications started within that session will be terminated, too. One-time
   VNC sessions cannot be shared, but it is possible to have multiple sessions
   on a single host at the same time.
  </p><div class="procedure " id="pro.vnc.one-time.activate"><div class="procedure-title-wrap"><h6 class="procedure-title"><span class="number">Procedure 4.1: </span><span class="name">Enabling One-time VNC Sessions </span><a title="Permalink" class="permalink" href="#pro.vnc.one-time.activate">#</a></h6></div><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
     Start <span class="guimenu">YaST</span> › <span class="guimenu">Network
     Services</span> › <span class="guimenu">Remote Administration (VNC)</span>.
    </p></li><li class="step "><p>
     Check <span class="guimenu">Allow Remote Administration Without Session
     Management</span>.
    </p></li><li class="step "><p>
     Activate <span class="guimenu">Enable access using a web browser</span> if you plan
     to access the VNC session in a Web browser window.
    </p></li><li class="step "><p>
     If necessary, also check <span class="guimenu">Open Port in Firewall</span> (for
     example, when your network interface is configured to be in the External
     Zone). If you have more than one network interface, restrict opening the
     firewall ports to a specific interface via <span class="guimenu">Firewall
     Details</span>.
    </p></li><li class="step "><p>
     Confirm your settings with <span class="guimenu">Next</span>.
    </p></li><li class="step "><p>
     In case not all needed packages are available yet, you need to approve the
     installation of missing packages.
    </p><div id="idm140019141611040" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.png" /><h6>Tip: Restart the Display Manager</h6><p>
      YaST makes changes to the display manager settings. You need to log out
      of your current graphical session and restart the display manager for the
      changes to take effect.
     </p></div></li></ol></div></div><div class="figure" id="idm140019141609184"><div class="figure-contents"><div class="mediaobject"><a xmlns="" href="images/vnc_nosession.png"><img src="images/vnc_nosession.png" width="" alt="Remote Administration" /></a></div></div><div class="figure-title-wrap"><h6 class="figure-title"><span class="number">Figure 4.7: </span><span class="name">Remote Administration </span><a title="Permalink" class="permalink" href="#idm140019141609184">#</a></h6></div></div><div class="sect2 " id="sec.vnc.one-time.configs"><div class="titlepage"><div><div><h3 class="title" id="sec.vnc.one-time.configs"><span class="number">4.3.1 </span><span class="name">Available Configurations</span> <a title="Permalink" class="permalink" href="#sec.vnc.one-time.configs">#</a></h3></div></div></div><p>
    The default configuration on <span class="productname"><span class="phrase">openSUSE Leap</span></span> serves sessions with a
    resolution of 1024x768 pixels at a color depth of 16-bit. The sessions are
    available on ports <code class="systemitem">5901</code> for
    <span class="quote">“<span class="quote">regular</span>”</span> VNC viewers (equivalent to VNC display
    <code class="literal">1</code>) and on port
    <code class="systemitem">5801</code> for Web browsers.
   </p><p>
    Other configurations can be made available on different
    ports<span class="phrase">, see
    <a class="xref" href="#sec.vnc.one-time.config" title="4.3.3. Configuring One-time VNC Sessions">Section 4.3.3, “Configuring One-time VNC Sessions”</a></span>.
   </p><p>
    VNC display numbers and X display numbers are independent in one-time
    sessions. A VNC display number is manually assigned to every configuration
    that the server supports (:1 in the example above). Whenever a VNC session
    is initiated with one of the configurations, it automatically gets a free X
    display number.
   </p><p>
    By default, both the VNC client and server try to communicate securely via a
    self-signed SSL certificate, which is generated after installation. You can
    either use the default one, or replace it with your own. When using the
    self-signed certificate, you need to confirm its signature before the first
    connection—both in the VNC viewer and the Web browser.
   </p></div><div class="sect2 " id="sec.vnc.one-time.connect"><div class="titlepage"><div><div><h3 class="title" id="sec.vnc.one-time.connect"><span class="number">4.3.2 </span><span class="name">Initiating a One-time VNC Session</span> <a title="Permalink" class="permalink" href="#sec.vnc.one-time.connect">#</a></h3></div></div></div><p>
    To connect to a one-time VNC session, a VNC viewer must be installed, see
    also <a class="xref" href="#sec.vnc.viewer" title="4.1. The vncviewer Client">Section 4.1, “The <code class="command">vncviewer</code> Client”</a>.  Alternatively use a
    JavaScript-capable Web browser to view the VNC session by entering the
    following URL: <code class="literal">http://jupiter.example.com:5801</code>
   </p></div><div class="sect2 " id="sec.vnc.one-time.config"><div class="titlepage"><div><div><h3 class="title" id="sec.vnc.one-time.config"><span class="number">4.3.3 </span><span class="name">Configuring One-time VNC Sessions</span> <a title="Permalink" class="permalink" href="#sec.vnc.one-time.config">#</a></h3></div></div></div><p>
    You can skip this section, if you do not need or want to modify the default
    configuration.
   </p><p>
    One-time VNC sessions are started via the <code class="systemitem">systemd</code> socket
    <code class="systemitem">xvnc.socket</code>. By default it offers six
    configuration blocks: three for VNC viewers (<code class="literal">vnc1</code> to
    <code class="literal">vnc3</code>), and three serving a JavaScript client
    (<code class="literal">vnchttpd1</code> to <code class="literal">vnchttpd3</code>). By default
    only <code class="literal">vnc1</code> and <code class="literal">vnchttpd1</code> are active.
   </p><p>
    To activate the VNC server socket at boot time, run the following command:
   </p><div class="verbatim-wrap"><pre class="screen">sudo systemctl enable xvnc.socket</pre></div><p>
    To start the socket immediately, run:
   </p><div class="verbatim-wrap"><pre class="screen">sudo systemctl start xvnc.socket</pre></div><p>
    The <code class="command">Xvnc</code> server can be configured via the
    <code class="literal">server_args</code> option. For a list of options, see
    <code class="command">Xvnc --help</code>.
   </p><p>
    When adding custom configurations, make sure they are not using ports that
    are already in use by other configurations, other services, or existing
    persistent VNC sessions on the same host.
   </p><p>
    Activate configuration changes by entering the following command:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> systemctl reload xvnc.socket</pre></div><div id="idm140019141580496" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.png" /><h6>Important: Firewall and VNC Ports</h6><p>
     When activating Remote Administration as described in
     <a class="xref" href="#pro.vnc.one-time.activate" title="Enabling One-time VNC Sessions">Procedure 4.1, “Enabling One-time VNC Sessions”</a>, the ports
     <code class="systemitem">5801</code> and
     <code class="systemitem">5901</code> are opened in the firewall.
     If the network interface serving the VNC sessions is protected by a
     firewall, you need to manually open the respective ports when activating
     additional ports for VNC sessions. See
     <span class="intraxref">Book “<em class="citetitle ">Security Guide</em>”, Chapter 15 “Masquerading and Firewalls”</span> for instructions.
    </p></div></div></div><div class="sect1 " id="sec.vnc.persistent"><div class="titlepage"><div><div><h2 class="title" id="sec.vnc.persistent"><span class="number">4.4 </span><span class="name">Persistent VNC Sessions</span> <a title="Permalink" class="permalink" href="#sec.vnc.persistent">#</a></h2></div></div></div><p>
   A persistent session can be accessed from multiple clients simultaneously.
   This is ideal for demonstration purposes where one client has full access
   and all other clients have view-only access. Another use case are trainings
   where the trainer might need access to the trainee's desktop.
  </p><div id="sec.vnc.persistent.connect" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.png" /><h6>Tip: Connecting to a Persistent VNC Session</h6><p>
    To connect to a persistent VNC session, a VNC viewer must be installed.
    Refer to <a class="xref" href="#sec.vnc.viewer" title="4.1. The vncviewer Client">Section 4.1, “The <code class="command">vncviewer</code> Client”</a> for more details.  Alternatively
    use a JavaScript-capable Web browser to view the VNC session by entering the
    following URL: <code class="literal">http://jupiter.example.com:5801</code>
   </p></div><p>
   There are two types of persistent VNC sessions:
  </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
     <a class="xref" href="#vnc.persistent.vncserver" title="4.4.1. VNC Session Initiated using vncserver">VNC Session Initiated using <code class="systemitem">vncserver</code></a>
    </p></li><li class="listitem "><p>
     <a class="xref" href="#vnc.persistent.vncmanager" title="4.4.2. VNC Session Initiated using vncmanager">VNC Session Initiated using <code class="systemitem">vncmanager</code></a>
    </p></li></ul></div><div class="sect2 " id="vnc.persistent.vncserver"><div class="titlepage"><div><div><h3 class="title" id="vnc.persistent.vncserver"><span class="number">4.4.1 </span><span class="name">VNC Session Initiated using <code class="systemitem">vncserver</code></span> <a title="Permalink" class="permalink" href="#vnc.persistent.vncserver">#</a></h3></div></div></div><p>
    This type of persistent VNC session is initiated on the server. The session
    and all applications started in this session run regardless of client
    connections until the session is terminated. Access to persistent sessions
    is protected by two possible types of passwords:
   </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
      a regular password that grants full access or
     </p></li><li class="listitem "><p>
      an optional view-only password that grants a non-interactive (view-only)
      access.
     </p></li></ul></div><p>
    A session can have multiple client connections of both kinds at once.
   </p><div class="procedure " id="pro.vnc.persistent.activate"><div class="procedure-title-wrap"><h6 class="procedure-title"><span class="number">Procedure 4.2: </span><span class="name">Starting a Persistent VNC Session using <code class="command">vncserver</code> </span><a title="Permalink" class="permalink" href="#pro.vnc.persistent.activate">#</a></h6></div><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
      Open a shell and make sure you are logged in as the user that should own
      the VNC session.

     </p></li><li class="step "><p>
      If the network interface serving the VNC sessions is protected by a
      firewall, you need to manually open the port used by your session in the
      firewall. If starting multiple sessions you may alternatively open a
      range of ports. See <span class="intraxref">Book “<em class="citetitle ">Security Guide</em>”, Chapter 15 “Masquerading and Firewalls”</span> for details
      on how to configure the firewall.
     </p><p>
      <code class="command">vncserver</code> uses the ports
      <code class="systemitem">5901</code> for display
      <code class="literal">:1</code>, <code class="systemitem">5902</code> for
      display <code class="literal">:2</code>, and so on. For persistent sessions, the
      VNC display and the X display usually have the same number.
     </p></li><li class="step "><p>
      To start a session with a resolution of 1024x769 pixel and with a color
      depth of 16-bit, enter the following command:
     </p><div class="verbatim-wrap"><pre class="screen">vncserver -alwaysshared -geometry 1024x768 -depth 16</pre></div><p>
      The <code class="command">vncserver</code> command picks an unused display number
      when none is given and prints its choice. See <code class="command">man 1
      vncserver</code> for more options.
     </p></li></ol></div></div><p>
    When running <code class="command">vncserver</code> for the first time, it asks for a
    password for full access to the session. If needed, you can also provide a
    password for view-only access to the session.
   </p><p>
    The password(s) you are providing here are also used for future sessions
    started by the same user. They can be changed with the
    <code class="command">vncpasswd</code> command.
   </p><div id="idm140019141548240" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.png" /><h6>Important: Security Considerations</h6><p>
     Make sure to use strong passwords of significant length (eight or more
     characters). Do not share these passwords.
    </p></div><p>
    To terminate the session shut down the desktop environment that runs inside
    the VNC session from the VNC viewer as you would shut it down if it was a
    regular local X session.
   </p><p>
    If you prefer to manually terminate a session, open a shell on the VNC
    server and make sure you are logged in as the user that owns the VNC
    session you want to terminate. Run the following command to terminate the
    session that runs on display <code class="literal">:1</code>: <code class="command">vncserver
    -kill :1</code>
   </p><div class="sect3 " id="sec.vnc.persistent.configure"><div class="titlepage"><div><div><h4 class="title" id="sec.vnc.persistent.configure"><span class="number">4.4.1.1 </span><span class="name">Configuring Persistent VNC Sessions</span> <a title="Permalink" class="permalink" href="#sec.vnc.persistent.configure">#</a></h4></div></div></div><p>
     Persistent VNC sessions can be configured by editing
     <code class="filename">$HOME/.vnc/xstartup</code>. By default this shell script
     starts the same GUI/window manager it was started from. In <span class="productname"><span class="phrase">openSUSE Leap</span></span>
     this will either be GNOME or IceWM. If you want to start your session
     with a window manager of your choice, set the variable
     <code class="envar">WINDOWMANAGER</code>:
    </p><div class="verbatim-wrap"><pre class="screen">WINDOWMANAGER=gnome vncserver -geometry 1024x768
WINDOWMANAGER=icewm vncserver -geometry 1024x768</pre></div><div id="idm140019141540112" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note: One Configuration for Each User</h6><p>
      Persistent VNC sessions are configured in a single per-user
      configuration. Multiple sessions started by the same user will all use
      the same start-up and password files.
     </p></div></div></div><div class="sect2 " id="vnc.persistent.vncmanager"><div class="titlepage"><div><div><h3 class="title" id="vnc.persistent.vncmanager"><span class="number">4.4.2 </span><span class="name">VNC Session Initiated using <code class="systemitem">vncmanager</code></span> <a title="Permalink" class="permalink" href="#vnc.persistent.vncmanager">#</a></h3></div></div></div><div class="procedure " id="vnc.persistent.vncmanager.enable"><div class="procedure-title-wrap"><h6 class="procedure-title"><span class="number">Procedure 4.3: </span><span class="name">Enabling Persistent VNC Sessions </span><a title="Permalink" class="permalink" href="#vnc.persistent.vncmanager.enable">#</a></h6></div><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
      Start <span class="guimenu">YaST</span> › <span class="guimenu">Network
      Services</span> › <span class="guimenu">Remote Administration (VNC)</span>.
     </p></li><li class="step "><p>
      Activate <span class="guimenu">Allow Remote Administration With Session
      Management</span>.
     </p></li><li class="step "><p>
      Activate <span class="guimenu">Enable access using a web browser</span> if you plan
      to access the VNC session in a Web browser window.
     </p></li><li class="step "><p>
      If necessary, also check <span class="guimenu">Open Port in Firewall</span> (for
      example, when your network interface is configured to be in the External
      Zone). If you have more than one network interface, restrict opening the
      firewall ports to a specific interface via <span class="guimenu">Firewall
      Details</span>.
     </p></li><li class="step "><p>
      Confirm your settings with <span class="guimenu">Next</span>.
     </p></li><li class="step "><p>
      In case not all needed packages are available yet, you need to approve
      the installation of missing packages.
     </p><div id="idm140019141525520" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.png" /><h6>Tip: Restart the Display Manager</h6><p>
       YaST makes changes to the display manager settings. You need to log
       out of your current graphical session and restart the display manager
       for the changes to take effect.
      </p></div></li></ol></div></div><div class="sect3 " id="vnc.persistent.vncmanager.configure"><div class="titlepage"><div><div><h4 class="title" id="vnc.persistent.vncmanager.configure"><span class="number">4.4.2.1 </span><span class="name">Configuring Persistent VNC Sessions</span> <a title="Permalink" class="permalink" href="#vnc.persistent.vncmanager.configure">#</a></h4></div></div></div><p>
     After you enable the VNC session management as described in
     <a class="xref" href="#vnc.persistent.vncmanager.enable" title="Enabling Persistent VNC Sessions">Procedure 4.3, “Enabling Persistent VNC Sessions”</a>, you can normally
     connect to the remote session with your favorite VNC viewer, such as
     <code class="command">vncviewer</code> or Remmina. You will be presented with login
     screen. After you log in, the 'VNC' icon will appear in the system tray of
     your desktop environment. Click the icon to open the <span class="guimenu">VNC
     Session</span> window. If it does not appear or if your desktop
     environment does not support icons in the system tray, run
     <code class="command">vncmanager-controller</code> manually.
    </p><div class="figure" id="idm140019141519680"><div class="figure-contents"><div class="mediaobject"><a xmlns="" href="images/vncmanager_session.png"><img src="images/vncmanager_session.png" width="" alt="VNC Session Settings" /></a></div></div><div class="figure-title-wrap"><h6 class="figure-title"><span class="number">Figure 4.8: </span><span class="name">VNC Session Settings </span><a title="Permalink" class="permalink" href="#idm140019141519680">#</a></h6></div></div><p>
     There are several settings which influence the VNC session behavior:
    </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019141513888"><span class="term "><span class="guimenu">Non-persistent, private</span>
      </span></dt><dd><p>
        This is equivalent to one-time session. Such session is not visible to
        others and will be terminated after you disconnect from it. Refer to
        <a class="xref" href="#sec.vnc.one-time" title="4.3. One-time VNC Sessions">Section 4.3, “One-time VNC Sessions”</a> for more information.
       </p></dd><dt id="idm140019141511088"><span class="term "><span class="guimenu">Persistent, visible</span>
      </span></dt><dd><p>
        The session is visible to other users and keeps running even after you
        disconnect from it.
       </p></dd><dt id="idm140019141508912"><span class="term "><span class="guimenu">Session name</span>
      </span></dt><dd><p>
        Here you can specify the name of the persistent session so that it is
        easily identified when reconnecting.
       </p></dd><dt id="idm140019141506720"><span class="term "><span class="guimenu">No password required</span>
      </span></dt><dd><p>
        The session will be freely accessible without having to log in under
        user credentials.
       </p></dd><dt id="idm140019141504544"><span class="term "><span class="guimenu">Require user login</span>
      </span></dt><dd><p>
        You need to log in with a valid user name and password to access the
        session. List the valid user names in the <span class="guimenu">Allowed
        users</span> text box.
       </p></dd><dt id="idm140019141501904"><span class="term "><span class="guimenu">Allow one client at time</span>
      </span></dt><dd><p>
        Disables joining the session by multiple users at the same time.
       </p></dd><dt id="idm140019141499744"><span class="term "><span class="guimenu">Allow multiple clients at time</span>
      </span></dt><dd><p>
        Allows multiple users to join the persistent session at the same time.
        Good for example for remote presentations or trainings.
       </p></dd></dl></div><p>
     Confirm with <span class="guimenu">OK</span>.
    </p></div><div class="sect3 " id="vnc.persistent.vncmanager.join"><div class="titlepage"><div><div><h4 class="title" id="vnc.persistent.vncmanager.join"><span class="number">4.4.2.2 </span><span class="name">Joining Persistent VNC Sessions</span> <a title="Permalink" class="permalink" href="#vnc.persistent.vncmanager.join">#</a></h4></div></div></div><p>
     After you set up a persistent VNC session as described in
     <a class="xref" href="#vnc.persistent.vncmanager.configure" title="4.4.2.1. Configuring Persistent VNC Sessions">Section 4.4.2.1, “Configuring Persistent VNC Sessions”</a>, you can join
     it with your VNC viewer. After the your VNC client connects to the server,
     you will be prompted to choose whether you want to create a new session,
     or join the existing one:
    </p><div class="figure" id="idm140019141493824"><div class="figure-contents"><div class="mediaobject"><a xmlns="" href="images/vncmanager_whether.png"><img src="images/vncmanager_whether.png" width="" alt="Joining a Persistent VNC Session" /></a></div></div><div class="figure-title-wrap"><h6 class="figure-title"><span class="number">Figure 4.9: </span><span class="name">Joining a Persistent VNC Session </span><a title="Permalink" class="permalink" href="#idm140019141493824">#</a></h6></div></div><p>
     After you click the name of the existing session, you may be asked for
     login credentials, depending on the persistent session settings.
    </p></div></div></div><div class="sect1 " id="sec.vnc.encrypt"><div class="titlepage"><div><div><h2 class="title" id="sec.vnc.encrypt"><span class="number">4.5 </span><span class="name">Encrypted VNC Communication</span> <a title="Permalink" class="permalink" href="#sec.vnc.encrypt">#</a></h2></div></div></div><p>
   If the VNC server is set up properly, all communication between the VNC
   server and the client is encrypted. The authentication happens at the
   beginning of the session, the actual data transfer only begins afterward.
  </p><p>
   Whether for a one-time or a persistent VNC session, security options are
   configured via the <code class="option">-securitytypes</code> parameter of the
   <code class="command">/usr/bin/Xvnc</code> command located on the
   <code class="literal">server_args</code> line. The <code class="option">-securitytypes</code>
   parameter selects both authentication method and encryption. It has the
   following options:
  </p><div class="variablelist "><div class="variablelist-title-wrap"><h6 class="variablelist-title"><span class="name">Authentications </span><a title="Permalink" class="permalink" href="#idm140019141483504">#</a></h6></div><dl class="variablelist"><dt id="idm140019141482768"><span class="term ">None, TLSNone, X509None</span></dt><dd><p>
      No authentication.
     </p></dd><dt id="idm140019141480960"><span class="term ">VncAuth, TLSVnc, X509Vnc</span></dt><dd><p>
      Authentication using custom password.
     </p></dd><dt id="idm140019141479120"><span class="term ">Plain, TLSPlain, X509Plain</span></dt><dd><p>
      Authentication using PAM to verify user's password.
     </p></dd></dl></div><div class="variablelist "><div class="variablelist-title-wrap"><h6 class="variablelist-title"><span class="name">Encryptions </span><a title="Permalink" class="permalink" href="#idm140019141477104">#</a></h6></div><dl class="variablelist"><dt id="idm140019141476368"><span class="term ">None, VncAuth, Plain</span></dt><dd><p>
      No encryption.
     </p></dd><dt id="idm140019141474560"><span class="term ">TLSNone, TLSVnc, TLSPlain</span></dt><dd><p>
      Anonymous TLS encryption. Everything is encrypted, but there is no
      verification of the remote host. So you are protected against passive
      attackers, but not against man-in-the-middle attackers.
     </p></dd><dt id="idm140019141472544"><span class="term ">X509None, X509Vnc, X509Plain</span></dt><dd><p>
      TLS encryption with certificate. If you use a self-signed certificate,
      you will be asked to verify it on the first connection. On subsequent
      connections you will be warned only if the certificate changed. So you
      are protected against everything except man-in-the-middle on the first
      connection (similar to typical SSH usage). If you use a certificate
      signed by a certificate authority matching the machine name, then you get
      full security (similar to typical HTTPS usage).
     </p><div id="idm140019141470544" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.png" /><h6>Tip: Path to Certificate and Key</h6><p>
       With X509 based encryption, you need to specify the path to the X509
       certificate and the key with <code class="option">-X509Cert</code> and
       <code class="option">-X509Key</code> options.
      </p></div></dd></dl></div><p>
   If you select multiple security types separated by comma, the first one
   supported and allowed by both client and server will be used. That way you
   can configure opportunistic encryption on the server. This is useful if you
   need to support VNC clients that do not support encryption.
  </p><p>
   On the client, you can also specify the allowed security types to prevent a
   downgrade attack if you are connecting to a server which you know has
   encryption enabled (although our vncviewer will warn you with the
   "Connection not encrypted!" message in that case).
  </p></div></div><div class="chapter " id="cha.expert_partitioner"><div class="titlepage"><div><div><h2 class="title"><span class="number">5 </span><span class="name">Expert Partitioner</span> <a title="Permalink" class="permalink" href="#cha.expert_partitioner">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">Filename: </span>deployment_expert_partitioner.xml</li><li><span class="ds-label">ID: </span>cha.expert_partitioner</li></ul></div></div></div></div><div class="line"><div class="toc"><dl><dt><span class="sect1"><a href="#sec.expert_partitioner"><span class="number">5.1 </span><span class="name">Using the Expert Partitioner</span></a></span></dt><dt><span class="sect1"><a href="#sec.yast.system.lvm"><span class="number">5.2 </span><span class="name">LVM Configuration</span></a></span></dt><dt><span class="sect1"><a href="#sec.yast.system.raid"><span class="number">5.3 </span><span class="name">Soft RAID</span></a></span></dt></dl></div></div><p>
  Sophisticated system configurations require specific disk setups. All common
  partitioning tasks can be done during the installation. To get persistent
  device naming with block devices, use the block devices below
  <code class="filename">/dev/disk/by-id</code> or
  <code class="filename">/dev/disk/by-uuid</code>. Logical Volume Management (LVM) is a
  disk partitioning scheme that is designed to be much more flexible than the
  physical partitioning used in standard setups. Its snapshot functionality
  enables easy creation of data backups. Redundant Array of Independent Disks
  (RAID) offers increased data integrity, performance, and fault tolerance.
  <span class="productname"><span class="phrase">openSUSE Leap</span></span> also supports multipath I/O . There is also the
  option to use iSCSI as a networked disk.
 </p><div class="sect1 " id="sec.expert_partitioner"><div class="titlepage"><div><div><h2 class="title" id="sec.expert_partitioner"><span class="number">5.1 </span><span class="name">Using the Expert Partitioner</span> <a title="Permalink" class="permalink" href="#sec.expert_partitioner">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">Filename: </span>deployment_expert_partitioner_overview.xml</li><li><span class="ds-label">ID: </span>sec.expert_partitioner</li></ul></div></div></div></div><p>
  With the Expert Partitioner, shown in
  <a class="xref" href="#fig.expert_partitioner.overview" title="The YaST Partitioner">Figure 5.1, “The YaST Partitioner”</a>, manually modify the partitioning
  of one or several hard disks. You can add, delete, resize, and edit
  partitions, or access the soft RAID, and LVM configuration.
 </p><div id="idm140019141453264" class="admonition warning normal"><img class="symbol" alt="Warning" title="Warning" src="static/images/icon-warning.png" /><h6>Warning: Repartitioning the Running System</h6><p>
   Although it is possible to repartition your system while it is running, the
   risk of making a mistake that causes data loss is very high. Try to avoid
   repartitioning your installed system and always create a complete backup of your
   data before attempting to do so.
  </p></div><div class="figure" id="fig.expert_partitioner.overview"><div class="figure-contents"><div class="mediaobject"><a xmlns="" href="images/install_partitioner_expert.png"><img src="images/install_partitioner_expert.png" width="" alt="The YaST Partitioner" /></a></div></div><div class="figure-title-wrap"><h6 class="figure-title"><span class="number">Figure 5.1: </span><span class="name">The YaST Partitioner </span><a title="Permalink" class="permalink" href="#fig.expert_partitioner.overview">#</a></h6></div></div><p>
  All existing or suggested partitions on all connected hard disks are
  displayed in the list of <span class="guimenu">Available Storage</span> in the YaST
  <span class="guimenu">Expert Partitioner</span> dialog. Entire hard disks are listed as
  devices without numbers, such as
  <code class="filename">/dev/sda</code>. Partitions are listed as parts of
  these devices, such as
  <code class="filename">/dev/sda1</code>. The size, type,
  encryption status, file system, and mount point of the hard disks and their
  partitions are also displayed. The mount point describes where the partition
  appears in the Linux file system tree.
 </p><p>
  Several functional views are available on the left hand <span class="guimenu">System
  View</span>. These views can be used to collect information about
  existing storage configurations, configure functions (like
  <code class="literal">RAID</code>, <code class="literal">Volume Management</code>,
  <code class="literal">Crypt Files</code>), and view file systems with additional
  features, such as Btrfs, NFS, or <code class="literal">TMPFS</code>.
 </p><p>
  If you run the expert dialog during installation, any free hard disk
  space is also listed and automatically selected. To provide more disk
  space to <span class="productname"><span class="phrase">openSUSE Leap</span></span>, free the needed space by going from the
  bottom toward the top in the list of partitions.
 </p><div class="sect2 " id="sec.expert_partitioner.tables"><div class="titlepage"><div><div><h3 class="title" id="sec.expert_partitioner.tables"><span class="number">5.1.1 </span><span class="name">Partition Tables</span> <a title="Permalink" class="permalink" href="#sec.expert_partitioner.tables">#</a></h3></div></div></div><p>
   <span class="productname"><span class="phrase">openSUSE Leap</span></span> allows to use and create different <span class="emphasis"><em>partition
   tables</em></span>. In some cases the partition table is called
   <span class="emphasis"><em>disk label</em></span>. The partition table is important to
   the boot process of your computer. To boot your machine
   from a partition in a newly created partition table, make sure that
   the table format is supported by the firmware.
  </p><p>
   To change the partition table, click the relevant disk name in the
   <span class="guimenu">System View</span> and choose
   <span class="guimenu">Expert</span> › <span class="guimenu">Create New Partition
   Table</span>.
  </p><div class="sect3 " id="sec.expert_partitioner.tables.msdos"><div class="titlepage"><div><div><h4 class="title" id="sec.expert_partitioner.tables.msdos"><span class="number">5.1.1.1 </span><span class="name">Master Boot Record</span> <a title="Permalink" class="permalink" href="#sec.expert_partitioner.tables.msdos">#</a></h4></div></div></div><p>
    The <span class="emphasis"><em>master boot record (MBR)</em></span> is the legacy
    partition table used on IBM PCs. It is sometimes also called a
    <span class="emphasis"><em>MS-DOS</em></span> partition table. The MBR only supports
    4 primary partitions. If the disk already has an MBR, <span class="productname"><span class="phrase">openSUSE Leap</span></span>
    allows you to create additional partitions in it which can be used
    as the installation target.
   </p><p>
    The limit of 4 partitions can be overcome by creating an
    <span class="emphasis"><em>extended partition</em></span>. The extended partition
    itself is a primary partition and can contain more
    <span class="emphasis"><em>logical partitions</em></span>.
   </p><p>
    UEFI firmwares usually support booting from MBR in the legacy mode.
   </p></div><div class="sect3 " id="sec.expert_partitioner.tables.gpt"><div class="titlepage"><div><div><h4 class="title" id="sec.expert_partitioner.tables.gpt"><span class="number">5.1.1.2 </span><span class="name">GPT Partition Table</span> <a title="Permalink" class="permalink" href="#sec.expert_partitioner.tables.gpt">#</a></h4></div></div></div><p>
    UEFI computers use a <span class="emphasis"><em>GUID Partition Table</em></span> (GPT)
    by default. <span class="productname"><span class="phrase">openSUSE Leap</span></span> will create a GPT on a disk if no other
    partition table exists.
   </p><p>
    Old BIOS firmwares do not support booting from GPT partitions.
   </p><p>
    You need a GPT partition table to use one of the following features:
   </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>More than 4 primary partitions</p></li><li class="listitem "><p>
      UEFI Secure Boot
     </p></li><li class="listitem "><p>
      Use disks larger than 2 TB
     </p></li></ul></div><div id="idm140019141419424" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note: Partitions Created with Parted 3.1 or Earlier Mislabeled</h6><p>
     GPT partitions created with Parted 3.1 or earlier used the Microsoft
     Basic Data partition type instead the newer Linux-specific GPT GUID.
     Newer versions of Parted will set the misleading flag
     <code class="literal">msftdata</code> on such partitions. This will also lead to
     various disk tools labeling the partition as a <span class="emphasis"><em>Windows Data
     Partition</em></span> or similar.
    </p><p>
     To remove the flag, run:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>parted <em class="replaceable ">DEVICE</em> set <em class="replaceable ">PARTITION_NUMBER</em> msftdata off</pre></div></div></div><div class="sect3 " id="sec.expert_partitioner.tables.zsystems"><div class="titlepage"><div><div><h4 class="title" id="sec.expert_partitioner.tables.zsystems"><span class="number">5.1.1.3 </span><span class="name">Partition Tables on IBM Z</span> <a title="Permalink" class="permalink" href="#sec.expert_partitioner.tables.zsystems">#</a></h4></div></div></div><p>
    On IBM Z platforms, SUSE Linux Enterprise Server supports <span class="emphasis"><em>SCSI hard disks</em></span>
    and <span class="emphasis"><em>direct access storage devices</em></span> (DASD). While
    SCSI disks can be partitioned as described above, DASDs can have no
    more than three partition entries in their partition tables.
   </p></div></div><div class="sect2 " id="sec.expert_partitioner.partition"><div class="titlepage"><div><div><h3 class="title" id="sec.expert_partitioner.partition"><span class="number">5.1.2 </span><span class="name">Partitions</span> <a title="Permalink" class="permalink" href="#sec.expert_partitioner.partition">#</a></h3></div></div></div><p>
   The YaST Partitioner can create and format partitions with several
   file systems. The default file system used by <span class="productname"><span class="phrase">openSUSE Leap</span></span> is
   <code class="literal">Btrfs</code>. For details, see
   <a class="xref" href="#sec.yast.btrfs" title="5.1.2.2. Btrfs Partitioning">Section 5.1.2.2, “Btrfs Partitioning”</a>.
  </p><p>
   Other commonly used file systems are available:
   <code class="literal">Ext2</code>, <code class="literal">Ext3</code>,
   <code class="literal">Ext4</code>, <code class="literal">FAT</code>,
   <code class="literal">XFS</code> and <code class="literal">Swap</code>.
  </p><div class="sect3 " id="sec.expert_partitioner.partition.create"><div class="titlepage"><div><div><h4 class="title" id="sec.expert_partitioner.partition.create"><span class="number">5.1.2.1 </span><span class="name">Creating a Partition</span> <a title="Permalink" class="permalink" href="#sec.expert_partitioner.partition.create">#</a></h4></div></div></div><p>
    To create a partition select <span class="guimenu">Hard Disks</span> and
    then a hard disk with free space. The actual modification can be done in the
    <span class="guimenu">Partitions</span> tab:
   </p><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
      Click <span class="guimenu">Add</span> to create a new partition. When using
      <span class="emphasis"><em>MBR</em></span>, specify to create a primary
      or extended partition. Within the extended partition, you can
      create several logical partitions. For details, see
      <a class="xref" href="#sec.expert_partitioner.tables" title="5.1.1. Partition Tables">Section 5.1.1, “Partition Tables”</a>).
     </p></li><li class="step "><p>
      Specify the size of the new partition. You can either choose to occupy all
      the free unpartitioned space, or enter a custom size.
     </p></li><li class="step "><p>
      Select the file system to use and a mount point. YaST suggests a mount
      point for each partition created. To use a different mount method, like
      mount by label, select <span class="guimenu">Fstab Options</span>. For more
      information on supported file systems, see
      <code class="systemitem">root</code>.
     </p></li><li class="step "><p>
      Specify additional file system options if your setup requires them. This
      is necessary, for example, if you need persistent device names. For
      details on the available options, refer to
      <a class="xref" href="#sec.expert_partitioner.options" title="5.1.3. Editing a Partition">Section 5.1.3, “Editing a Partition”</a>.
     </p></li><li class="step "><p>
      Click <span class="guimenu">Finish</span> to apply your partitioning setup and leave
      the partitioning module.
     </p><p>
      If you created the partition during installation, you are returned to the
      installation overview screen.
     </p></li></ol></div></div></div><div class="sect3 " id="sec.yast.btrfs"><div class="titlepage"><div><div><h4 class="title" id="sec.yast.btrfs"><span class="number">5.1.2.2 </span><span class="name">Btrfs Partitioning</span> <a title="Permalink" class="permalink" href="#sec.yast.btrfs">#</a></h4></div></div></div><p>
    The default file system for the root partition is Btrfs. For details, see
    <a class="xref" href="#cha.snapper" title="Chapter 3. System Recovery and Snapshot Management with Snapper">Chapter 3, <em>System Recovery and Snapshot Management with Snapper</em></a>.
    The root file system is the default subvolume and it is not listed in the
    list of created subvolumes. As a default Btrfs subvolume, it can be mounted
    as a normal file system.
   </p><div id="idm140019141389024" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.png" /><h6>Important: Btrfs on an Encrypted Root Partition</h6><p>
     The default partitioning setup suggests the root partition as Btrfs with
     <code class="filename">/boot</code> being a directory. To encrypt the root
     partition encrypted, make sure to use the GPT partition
     table type instead of the default MSDOS type. Otherwise the GRUB2 boot
     loader may not have enough space for the second stage loader.
    </p></div><p>
    It is possible to create snapshots of Btrfs subvolumes—either
    manually, or automatically based on system events. For example when making
    changes to the file system, <code class="command">zypper</code> invokes the
    <code class="command">snapper</code> command to create snapshots before and after the
    change. This is useful if you are not satisfied with the change
    <code class="command">zypper</code> made and want to restore the previous state. As
    <code class="command">snapper</code> invoked by <code class="command">zypper</code> creates
    snapshots of
    the <span class="emphasis"><em>root</em></span> file system by default, it makes sense to
    exclude specific directories from being included into snapshots. This is the reason
    YaST suggests creating the following separate subvolumes.
   </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019141380144"><span class="term "><code class="filename">/boot/grub2/i386-pc</code>,
   <code class="filename">/boot/grub2/x86_64-efi</code>,
   <code class="filename">/boot/grub2/powerpc-ieee1275</code>,
   <code class="filename">/boot/grub2/s390x-emu</code>
  </span></dt><dd><p>
    A rollback of the boot loader configuration is not supported. The
    directories listed above are architecture-specific. The first two
    directories are present on AMD64/Intel 64 machines, the latter two on IBM
    POWER and on IBM Z, respectively.
   </p></dd><dt id="idm140019141376464"><span class="term "><code class="filename">/home</code>
  </span></dt><dd><p>
    If <code class="filename">/home</code> does not reside on a separate partition, it
    is excluded to avoid data loss on rollbacks.
   </p></dd><dt id="idm140019141373856"><span class="term "><code class="filename">/opt</code>, <code class="filename">/var/opt</code>
  </span></dt><dd><p>
    Third-party products usually get installed to <code class="filename">/opt</code>. It
    is excluded to avoid uninstalling these applications on rollbacks.
   </p></dd><dt id="idm140019141370784"><span class="term "><code class="filename">/srv</code>
  </span></dt><dd><p>
    Contains data for Web and FTP servers. It is excluded to avoid data loss on
    rollbacks.
   </p></dd><dt id="idm140019141368624"><span class="term "><code class="filename">/tmp</code>, <code class="filename">/var/tmp</code>,
   <code class="filename">/var/cache</code>, <code class="filename">/var/crash</code>
  </span></dt><dd><p>
    All directories containing temporary files and caches are excluded from
    snapshots.
   </p></dd><dt id="idm140019141365120"><span class="term "><code class="filename">/usr/local</code>
  </span></dt><dd><p>
    This directory is used when manually installing software. It is excluded to
    avoid uninstalling these installations on rollbacks.
   </p></dd><dt id="idm140019141362912"><span class="term "><code class="filename">/var/lib/libvirt/images</code>
  </span></dt><dd><p>
    The default location for virtual machine images managed with libvirt.
    Excluded to ensure virtual machine images are not replaced with older
    versions during a rollback. By default, this subvolume is created with the
    option <code class="literal">no copy on write</code>.
   </p></dd><dt id="idm140019141360160"><span class="term "><code class="filename">/var/lib/mailman</code>, <code class="filename">/var/spool</code>
  </span></dt><dd><p>
    Directories containing mails or mail queues are excluded to avoid a loss of
    mails after a rollback.
   </p></dd><dt id="idm140019141357536"><span class="term "><code class="filename">/var/lib/named</code>
  </span></dt><dd><p>
    Contains zone data for the DNS server. Excluded from snapshots to ensure a
    name server can operate after a rollback.
   </p></dd><dt id="idm140019141355344"><span class="term "><code class="filename">/var/lib/mariadb</code>,
   <code class="filename">/var/lib/mysql</code>, <code class="filename">/var/lib/pgqsl</code>
  </span></dt><dd><p>
    These directories contain database data. By default, these subvolumes are
    created with the option <code class="literal">no copy on write</code>.
   </p></dd><dt id="idm140019141351824"><span class="term "><code class="filename">/var/log</code>
  </span></dt><dd><p>
    Log file location. Excluded from snapshots to allow log file analysis after
    the rollback of a broken system.
   </p></dd></dl></div><div id="idm140019141349344" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.png" /><h6>Tip: Size of Btrfs Partition</h6><p>
     Since saved snapshots require more disk space, it is recommended to
     reserve enough space for Btrfs. Suggested size for a root Btrfs partition
     with default subvolumes is 20 GB.
    </p></div></div><div class="sect3 " id="sec.yast.btrfs_subvolumes"><div class="titlepage"><div><div><h4 class="title" id="sec.yast.btrfs_subvolumes"><span class="number">5.1.2.3 </span><span class="name">Managing Btrfs Subvolumes using YaST</span> <a title="Permalink" class="permalink" href="#sec.yast.btrfs_subvolumes">#</a></h4></div></div></div><p>
    Subvolumes of a Btrfs partition can be now managed with the YaST
    <span class="guimenu">Expert partitioner</span> module. You can add new or remove
    existing subvolumes.
   </p><div class="procedure " id="idm140019141345440"><div class="procedure-title-wrap"><h6 class="procedure-title"><span class="number">Procedure 5.1: </span><span class="name">Btrfs Subvolumes with YaST </span><a title="Permalink" class="permalink" href="#idm140019141345440">#</a></h6></div><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
      Start the YaST <span class="guimenu">Expert Partitioner</span> with
      <span class="guimenu">System</span> › <span class="guimenu">Partitioner</span>.
     </p></li><li class="step "><p>
      Choose <span class="guimenu">Btrfs</span> in the left <span class="guimenu">System
      View</span> pane.
     </p></li><li class="step "><p>
      Select the Btrfs partition whose subvolumes you need to manage and click
      <span class="guimenu">Edit</span>.
     </p></li><li class="step "><p>
      Click <span class="guimenu">Subvolume Handling</span>. You can see a list of all
      existing subvolumes of the selected Btrfs partition. There are
      several <code class="literal">@/.snapshots/xyz/snapshot</code> entries—each
      of these subvolumes belongs to one existing snapshot.
     </p></li><li class="step "><p>
      Depending on whether you want to add or remove subvolumes, do the
      following:
     </p><ol type="a" class="substeps "><li class="step "><p>
        To remove a subvolume, select it from the list of <span class="guimenu">Exisitng
        Subvolumes</span> and click <span class="guimenu">Remove</span>.
       </p></li><li class="step "><p>
        To add a new subvolume, enter its name to the <span class="guimenu">New
        Subvolume</span> text box and click <span class="guimenu">Add new</span>.
       </p><div class="figure" id="fig.yast2.btrfs.subvolumes"><div class="figure-contents"><div class="mediaobject"><a xmlns="" href="images/install_partitioner_btrfs_subvolumes.png"><img src="images/install_partitioner_btrfs_subvolumes.png" width="" alt="Btrfs Subvolumes in YaST Partitioner" /></a></div></div><div class="figure-title-wrap"><h6 class="figure-title"><span class="number">Figure 5.2: </span><span class="name">Btrfs Subvolumes in YaST Partitioner </span><a title="Permalink" class="permalink" href="#fig.yast2.btrfs.subvolumes">#</a></h6></div></div></li></ol></li><li class="step "><p>
      Confirm with <span class="guimenu">OK</span> and <span class="guimenu">Finish</span>.
     </p></li><li class="step "><p>
      Leave the partitioner with <span class="guimenu">Finish</span>.
     </p></li></ol></div></div></div></div><div class="sect2 " id="sec.expert_partitioner.options"><div class="titlepage"><div><div><h3 class="title" id="sec.expert_partitioner.options"><span class="number">5.1.3 </span><span class="name">Editing a Partition</span> <a title="Permalink" class="permalink" href="#sec.expert_partitioner.options">#</a></h3></div></div></div><p>
   When you create a new partition or modify an existing partition, you can set
   various parameters. For new partitions, the default parameters set by YaST
   are usually sufficient and do not require any modification. To edit your
   partition setup manually, proceed as follows:
  </p><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
     Select the partition.
    </p></li><li class="step "><p>
     Click <span class="guimenu">Edit</span> to edit the partition and set the
     parameters:
    </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019141318192"><span class="term ">File System ID</span></dt><dd><p>
        Even if you do not want to format the partition at this
        stage, assign it a file system ID to ensure that the partition is
        registered correctly. Typical values are <span class="guimenu">Linux</span>,
        <span class="guimenu">Linux swap</span>, <span class="guimenu">Linux LVM</span>, and
        <span class="guimenu">Linux RAID</span>.
       </p></dd><dt id="idm140019141314432"><span class="term ">
       File System
      </span></dt><dd><p>
        To change the partition file system, click <span class="guimenu">Format
        Partition</span> and select file system type in the <span class="guimenu">File
        System</span> list.
       </p><p>
        <span class="productname"><span class="phrase">openSUSE Leap</span></span> supports several types of file systems. Btrfs is the
        Linux file system of choice for the root partition because of its
        advanced features. It supports copy-on-write functionality, creating
        snapshots, multi-device spanning, subvolumes, and other useful
        techniques. XFS, Ext3 and JFS are journaling file systems. These file
        systems can restore the system very quickly after a system crash, using
        write processes logged during the operation. Ext2 is not a journaling
        file system, but it is adequate for smaller partitions because it does
        not require much disk space for management.
       </p><p>
        The default file system for the root partition is Btrfs. The default
        file system for additional partitions is XFS.
       </p><p>
        Swap is a special format that allows the partition to be used as a
        virtual memory. Create a swap partition of at least 256 MB.
        However, if you use up your swap space, consider adding more memory to
        your system instead of adding more swap space.
       </p><div id="idm140019141308480" class="admonition warning normal"><img class="symbol" alt="Warning" title="Warning" src="static/images/icon-warning.png" /><h6>Warning: Changing the File System</h6><p>
         Changing the file system and reformatting partitions irreversibly
         deletes all data from the partition.
        </p></div><p>
        For details on the various file systems, refer to <em class="citetitle ">Storage Administration Guide</em>.
       </p></dd><dt id="idm140019141305728"><span class="term ">
       Encrypt Device
      </span></dt><dd><p>
        If you activate the encryption, all data is written to the hard disk in
        encrypted form. This increases the security of sensitive data, but
        reduces the system speed, as the encryption takes some time to process.
        More information about the encryption of file systems is provided in
        <span class="intraxref">Book “<em class="citetitle ">Security Guide</em>”, Chapter 11 “Encrypting Partitions and Files”</span>.
       </p></dd><dt id="idm140019141303056"><span class="term ">
       Mount Point
      </span></dt><dd><p>
        Specify the directory where the partition should be mounted in the file
        system tree. Select from YaST suggestions or enter any other name.
       </p></dd><dt id="idm140019141301104"><span class="term ">
       Fstab Options
      </span></dt><dd><p>
        Specify various parameters contained in the global file system
        administration file (<code class="filename">/etc/fstab</code>). The default
        settings should suffice for most setups. You can, for example, change
        the file system identification from the device name to a volume label.
        In the volume label, use all characters except <code class="literal">/</code> and
        space.
       </p><p>
        To get persistent devices names, use the mount option <span class="guimenu">Device
        ID</span>, <span class="guimenu">UUID</span> or <span class="guimenu">LABEL</span>. In
        <span class="productname"><span class="phrase">openSUSE Leap</span></span>, persistent device names are enabled by default.
       </p><p>
        If you prefer to mount the partition by its label, you need to define
        one in the <span class="guimenu">Volume label</span> text entry. For example, you
        could use the partition label <code class="literal">HOME</code> for a partition
        intended to mount to <code class="filename">/home</code>.
       </p><p>
        If you intend to use quotas on the file system, use the mount option
        <span class="guimenu">Enable Quota Support</span>. This must be done before you
        can define quotas for users in the YaST <span class="guimenu">User
        Management</span> module. For further information on how to
        configure user quota, refer to
        <span class="intraxref">Book “<em class="citetitle ">Start-Up</em>”, Chapter 5 “Managing Users with YaST”, Section 5.3.3 “Managing Quotas”</span>.
       </p></dd></dl></div></li><li class="step "><p>
     Select <span class="guimenu">Finish</span> to save the changes.
    </p></li></ol></div></div><div id="idm140019141289168" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note: Resize File Systems</h6><p>
    To resize an existing file system, select the partition and use
    <span class="guimenu">Resize</span>. Note, that it is not possible to resize
    partitions while mounted. To resize partitions, unmount the relevant
    partition before running the partitioner.
   </p></div></div><div class="sect2 " id="sec.expert_partitioner.options2"><div class="titlepage"><div><div><h3 class="title" id="sec.expert_partitioner.options2"><span class="number">5.1.4 </span><span class="name">Expert Options</span> <a title="Permalink" class="permalink" href="#sec.expert_partitioner.options2">#</a></h3></div></div></div><p>
   After you select a hard disk device (like <span class="guimenu">sda</span>) in the
   <span class="guimenu">System View</span> pane, you can access the
   <span class="guimenu">Expert</span> menu in the lower right part of the
   <span class="guimenu">Expert Partitioner</span> window. The menu contains the
   following commands:
  </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019141283216"><span class="term ">Create New Partition Table</span></dt><dd><p>
      This option helps you create a new partition table on the selected
      device.
     </p><div id="idm140019141281648" class="admonition warning normal"><img class="symbol" alt="Warning" title="Warning" src="static/images/icon-warning.png" /><h6>Warning: Creating a New Partition Table</h6><p>
       Creating a new partition table on a device irreversibly removes all the
       partitions and their data from that device.
      </p></div></dd><dt id="idm140019141279840"><span class="term ">Clone This Disk</span></dt><dd><p>
      This option helps you clone the device partition layout (but not the
      data) to other available disk devices.
     </p></dd></dl></div></div><div class="sect2 " id="sec.expert_partitioner.configure_options"><div class="titlepage"><div><div><h3 class="title" id="sec.expert_partitioner.configure_options"><span class="number">5.1.5 </span><span class="name">Advanced Options</span> <a title="Permalink" class="permalink" href="#sec.expert_partitioner.configure_options">#</a></h3></div></div></div><p>
   After you select the host name of the computer (the top-level of the tree in
   the <span class="guimenu">System View</span> pane), you can access the
   <span class="guimenu">Configure</span> menu in the lower right part of the
   <span class="guimenu">Expert Partitioner</span> window. The menu contains the
   following commands:
  </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019141274128"><span class="term ">Configure iSCSI</span></dt><dd><p>
      To access SCSI over IP block devices, you first need to configure iSCSI.
      This results in additionally available devices in the main partition
      list.
     </p></dd><dt id="idm140019141272176"><span class="term ">Configure Multipath</span></dt><dd><p>
      Selecting this option helps you configure the multipath enhancement to
      the supported mass storage devices.
     </p></dd></dl></div></div><div class="sect2 " id="sec.expert_partitioner.info"><div class="titlepage"><div><div><h3 class="title" id="sec.expert_partitioner.info"><span class="number">5.1.6 </span><span class="name">More Partitioning Tips</span> <a title="Permalink" class="permalink" href="#sec.expert_partitioner.info">#</a></h3></div></div></div><p>
   The following section includes a few hints and tips on partitioning that
   should help you make the right decisions when setting up your system.
  </p><div class="sect3 " id="sec.expert_partitioner.info.cylinders"><div class="titlepage"><div><div><h4 class="title" id="sec.expert_partitioner.info.cylinders"><span class="number">5.1.6.1 </span><span class="name">Cylinder Numbers</span> <a title="Permalink" class="permalink" href="#sec.expert_partitioner.info.cylinders">#</a></h4></div></div></div><p>
    Note, that different partitioning tools may start counting the cylinders of
    a partition with <code class="literal">0</code> or with <code class="literal">1</code>. When
    calculating the number of cylinders, you should always use the difference
    between the last and the first cylinder number and add one.
   </p></div><div class="sect3 " id="sec.expert_partitioner.info.swap"><div class="titlepage"><div><div><h4 class="title" id="sec.expert_partitioner.info.swap"><span class="number">5.1.6.2 </span><span class="name">Using <code class="literal">swap</code></span> <a title="Permalink" class="permalink" href="#sec.expert_partitioner.info.swap">#</a></h4></div></div></div><p>
    Swap is used to extend the available physical memory. It is then possible
    to use more memory than physical RAM available. The memory management
    system of kernels before 2.4.10 needed swap as a safety measure. Then, if
    you did not have twice the size of your RAM in swap, the performance of the
    system suffered. These limitations no longer exist.
   </p><p>
    Linux uses a page called <span class="quote">“<span class="quote">Least Recently Used</span>”</span> (LRU) to select
    pages that might be moved from memory to disk. Therefore, running
    applications have more memory available and caching works more smoothly.
   </p><p>
    If an application tries to allocate the maximum allowed memory, problems
    with swap can arise. There are three major scenarios to look at:
   </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019141261024"><span class="term ">System with no swap</span></dt><dd><p>
       The application gets the maximum allowed memory. All caches are freed,
       and thus all other running applications are slowed. After a few minutes,
       the kernel's out-of-memory kill mechanism activates and kills the
       process.
      </p></dd><dt id="idm140019141258992"><span class="term ">System with medium sized swap (128 MB–512 MB)</span></dt><dd><p>
       At first, the system slows like a system without swap. After all
       physical RAM has been allocated, swap space is used as well. At this
       point, the system becomes very slow and it becomes impossible to run
       commands from remote. Depending on the speed of the hard disks that run
       the swap space, the system stays in this condition for about 10 to 15
       minutes until the out-of-memory kill mechanism resolves the issue. Note
       that you will need a certain amount of swap if the computer needs to
       perform a <span class="quote">“<span class="quote">suspend to disk</span>”</span>. In that case, the swap size
       should be large enough to contain the necessary data from memory (512
       MB–1GB).
      </p></dd><dt id="idm140019141256064"><span class="term ">System with lots of swap (several GB)</span></dt><dd><p>
       It is better to not have an application that is out of control and
       swapping excessively in this case. If you use such application, the
       system will need many hours to recover. In the process, it is likely
       that other processes get timeouts and faults, leaving the system in an
       undefined state, even after terminating the faulty process. In this
       case, do a hard machine reboot and try to get it running again. Lots of
       swap is only useful if you have an application that relies on this
       feature. Such applications (like databases or graphics manipulation
       programs) often have an option to directly use hard disk space for their
       needs. It is advisable to use this option instead of using lots of swap
       space.
      </p></dd></dl></div><p>
    If your system is not out of control, but needs more swap after some time,
    it is possible to extend the swap space online. If you prepared a partition
    for swap space, add this partition with YaST. If you do not have a
    partition available, you can also use a swap file to extend the swap. Swap
    files are generally slower than partitions, but compared to physical RAM,
    both are extremely slow so the actual difference is negligible.
   </p><div class="procedure " id="idm140019141252432"><div class="procedure-title-wrap"><h6 class="procedure-title"><span class="number">Procedure 5.2: </span><span class="name">Adding a Swap File Manually </span><a title="Permalink" class="permalink" href="#idm140019141252432">#</a></h6></div><div class="procedure-contents"><p>
     To add a swap file in the running system, proceed as follows:
    </p><ol class="procedure" type="1"><li class="step "><p>
      Create an empty file in your system. For example, to add a
      swap file with 128 MB swap at
      <code class="filename">/var/lib/swap/swapfile</code>, use the commands:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> mkdir -p /var/lib/swap
<code class="prompt user">tux &gt; </code><code class="command">sudo</code> dd if=/dev/zero of=/var/lib/swap/swapfile bs=1M count=128</pre></div></li><li class="step "><p>
      Initialize this swap file with the command
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> mkswap /var/lib/swap/swapfile</pre></div><div id="idm140019141246080" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note: Changed UUID for Swap Partitions when Formatting via <code class="command">mkswap</code></h6><p>Do not reformat existing swap partitions with <code class="command">mkswap</code>
     if possible. Reformatting with <code class="command">mkswap</code> will change
     the UUID value of the swap partition. Either reformat via YaST (will
     update <code class="filename">/etc/fstab</code>) or adjust
     <code class="filename">/etc/fstab</code> manually.
  </p></div></li><li class="step "><p>
      Activate the swap with the command
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> swapon /var/lib/swap/swapfile</pre></div><p>
      To disable this swap file, use the command
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> swapoff /var/lib/swap/swapfile</pre></div></li><li class="step "><p>
      Check the current available swap spaces with the command
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>cat /proc/swaps</pre></div><p>
      Note that at this point, it is only temporary swap space. After the next
      reboot, it is no longer used.
     </p></li><li class="step "><p>
      To enable this swap file permanently, add the following line to
      <code class="filename">/etc/fstab</code>:
     </p><div class="verbatim-wrap"><pre class="screen">/var/lib/swap/swapfile swap swap defaults 0 0</pre></div></li></ol></div></div></div></div><div class="sect2 " id="sec.expert_partitioner.lvm"><div class="titlepage"><div><div><h3 class="title" id="sec.expert_partitioner.lvm"><span class="number">5.1.7 </span><span class="name">Partitioning and LVM</span> <a title="Permalink" class="permalink" href="#sec.expert_partitioner.lvm">#</a></h3></div></div></div><p>
   From the <span class="guimenu">Expert partitioner</span>, access the LVM configuration
   by clicking the <span class="guimenu">Volume Management</span> item in the
   <span class="guimenu">System View</span> pane. However, if a working LVM configuration
   already exists on your system, it is automatically activated upon entering
   the initial LVM configuration of a session. In this case, all disks
   containing a partition (belonging to an activated volume group) cannot be
   repartitioned. The Linux kernel cannot reread the modified partition table
   of a hard disk when any partition on this disk is in use. If you already
   have a working LVM configuration on your system, physical repartitioning
   should not be necessary. Instead, change the configuration of the logical
   volumes.
  </p><p>
   At the beginning of the physical volumes (PVs), information about the volume
   is written to the partition. To reuse such a partition for other non-LVM
   purposes, it is advisable to delete the beginning of this volume. For
   example, in the VG <code class="literal">system</code> and PV
   <code class="filename">/dev/sda2</code>, do this with the command:
  </p><div class="verbatim-wrap"><pre class="screen"><code class="command">dd</code> <code class="option">if=/dev/zero of=/dev/sda2 bs=512 count=1</code></pre></div><div id="idm140019141227984" class="admonition warning normal"><img class="symbol" alt="Warning" title="Warning" src="static/images/icon-warning.png" /><h6>Warning: File System for Booting</h6><p>
    The file system used for booting (the root file system or
    <code class="filename">/boot</code>) must not be stored on an LVM logical volume.
    Instead, store it on a normal physical partition.
   </p></div><p>
   To change your <code class="filename">/usr</code> or
   <code class="systemitem">swap</code>, refer to
   <a class="xref" href="#pro.boot.linuxrc.lvm" title="Updating Init RAM Disk When Switching to Logical Volumes">Procedure 9.1, “Updating Init RAM Disk When Switching to Logical Volumes”</a>.
  </p></div></div><div class="sect1 " id="sec.yast.system.lvm"><div class="titlepage"><div><div><h2 class="title" id="sec.yast.system.lvm"><span class="number">5.2 </span><span class="name">LVM Configuration</span> <a title="Permalink" class="permalink" href="#sec.yast.system.lvm">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">Filename: </span>deployment_expert_partitioner_lvm.xml</li><li><span class="ds-label">ID: </span>sec.yast.system.lvm</li></ul></div></div></div></div><p>
  This section explains specific steps to take when configuring LVM.
  
 </p><div id="idm140019141219152" class="admonition warning normal"><img class="symbol" alt="Warning" title="Warning" src="static/images/icon-warning.png" /><h6>Warning: Back up Your Data</h6><p>
   Using LVM is sometimes associated with increased risk such as data loss.
   Risks also include application crashes, power failures, and faulty commands.
   Save your data before implementing LVM or reconfiguring volumes. Never work
   without a backup.
  </p></div><p>
  The YaST LVM configuration can be reached from the YaST Expert
  Partitioner (see <a class="xref" href="#sec.expert_partitioner" title="5.1. Using the Expert Partitioner">Section 5.1, “Using the Expert Partitioner”</a>) within the
  <span class="guimenu">Volume Management</span> item in the <span class="guimenu">System
  View</span> pane. The Expert Partitioner allows you to edit and delete
  existing partitions and create new ones that need to be used with LVM.
 </p><div class="sect2 " id="sec.yast.system.lvm.create_pv"><div class="titlepage"><div><div><h3 class="title" id="sec.yast.system.lvm.create_pv"><span class="number">5.2.1 </span><span class="name">Create Physical Volume</span> <a title="Permalink" class="permalink" href="#sec.yast.system.lvm.create_pv">#</a></h3></div></div></div><p>
   The first task is to create physical volumes that provide space to a volume group:
  </p><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
     Select a hard disk from <span class="guimenu">Hard Disks</span>.
    </p></li><li class="step "><p>
     Change to the <span class="guimenu">Partitions</span> tab.
    </p></li><li class="step "><p>
     Click <span class="guimenu">Add</span> and enter the desired size of the PV on this
     disk.
    </p></li><li class="step "><p>
     Use <span class="guimenu">Do not format partition</span> and change the
     <span class="guimenu">File System ID</span> to <span class="guimenu">0x8E Linux LVM</span>. Do
     not mount this partition.
    </p></li><li class="step "><p>
     Repeat this procedure until you have defined all the desired physical
     volumes on the available disks.
    </p></li></ol></div></div></div><div class="sect2 " id="sec.yast.system.lvm.volume_groups"><div class="titlepage"><div><div><h3 class="title" id="sec.yast.system.lvm.volume_groups"><span class="number">5.2.2 </span><span class="name">Creating Volume Groups</span> <a title="Permalink" class="permalink" href="#sec.yast.system.lvm.volume_groups">#</a></h3></div></div></div><p>
   If no volume group exists on your system, you must add one (see
   <a class="xref" href="#fig.lvm.yast.volgrp" title="Creating a Volume Group">Figure 5.3, “Creating a Volume Group”</a>). It is possible to create additional
   groups by clicking <span class="guimenu">Volume Management</span> in the
   <span class="guimenu">System View</span> pane, and then on <span class="guimenu">Add Volume
   Group</span>. One single volume group is usually sufficient.
  </p><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
     Enter a name for the VG, for example, <code class="literal">system</code>.
    </p></li><li class="step "><p>
     Select the desired <span class="guimenu">Physical Extend Size</span>. This value
     defines the size of a physical block in the volume group. All the disk
     space in a volume group is handled in blocks of this size.
    </p></li><li class="step "><p>
     Add the prepared PVs to the VG by selecting the device and clicking
     <span class="guimenu">Add</span>. Selecting several devices is possible by holding
     <span class="keycap">Ctrl</span> while selecting the devices.
    </p></li><li class="step "><p>
     Select <span class="guimenu">Finish</span> to make the VG available to further
     configuration steps.
    </p></li></ol></div></div><div class="figure" id="fig.lvm.yast.volgrp"><div class="figure-contents"><div class="mediaobject"><a xmlns="" href="images/install_partitioner_add_vg.png"><img src="images/install_partitioner_add_vg.png" width="" alt="Creating a Volume Group" /></a></div></div><div class="figure-title-wrap"><h6 class="figure-title"><span class="number">Figure 5.3: </span><span class="name">Creating a Volume Group </span><a title="Permalink" class="permalink" href="#fig.lvm.yast.volgrp">#</a></h6></div></div><p>
   If you have multiple volume groups defined and want to add or remove PVs,
   select the volume group in the <span class="guimenu">Volume Management</span> list
   and click <span class="guimenu">Resize</span>. In the following window, you can add
   or remove PVs to the selected volume group.
  </p></div><div class="sect2 " id="sec.yast.system.lvm.logical_vol"><div class="titlepage"><div><div><h3 class="title" id="sec.yast.system.lvm.logical_vol"><span class="number">5.2.3 </span><span class="name">Configuring Logical Volumes</span> <a title="Permalink" class="permalink" href="#sec.yast.system.lvm.logical_vol">#</a></h3></div></div></div><p>
   After the volume group has been filled with PVs, define the LVs which the
   operating system should use in the next dialog. Choose the current volume
   group and change to the <span class="guimenu">Logical Volumes</span> tab.
   <span class="guimenu">Add</span>, <span class="guimenu">Edit</span>, <span class="guimenu">Resize</span>,
   and <span class="guimenu">Delete</span> LVs as needed until all space in the volume
   group has been occupied. Assign at least one LV to each volume group.
  </p><div class="figure" id="fig.lvm.yast.mgmt"><div class="figure-contents"><div class="mediaobject"><a xmlns="" href="images/install_partitioner_volume_management.png"><img src="images/install_partitioner_volume_management.png" width="" alt="Logical Volume Management" /></a></div></div><div class="figure-title-wrap"><h6 class="figure-title"><span class="number">Figure 5.4: </span><span class="name">Logical Volume Management </span><a title="Permalink" class="permalink" href="#fig.lvm.yast.mgmt">#</a></h6></div></div><p>
   Click <span class="guimenu">Add</span> and go through the wizard-like pop-up that
   opens:
  </p><div class="orderedlist "><ol class="orderedlist" type="1"><li class="listitem "><p>
     Enter the name of the LV. For a partition that should be mounted to
     <code class="filename">/home</code>, a name like <code class="literal">HOME</code> could be
     used.
    </p></li><li class="listitem "><p>
     Select the type of the LV. It can be either <span class="guimenu">Normal
     Volume</span>, <span class="guimenu">Thin Pool</span>, or <span class="guimenu">Thin
     Volume</span>. Note that you need to create a thin pool first, which
     can store individual thin volumes. The big advantage of thin provisioning
     is that the total sum of all thin volumes stored in a thin pool can
     exceed the size of the pool itself.
    </p></li><li class="listitem "><p>
     Select the size and the number of stripes of the LV. If you have only one
     PV, selecting more than one stripe is not useful.
    </p></li><li class="listitem "><p>
     Choose the file system to use on the LV and the mount point.
    </p></li></ol></div><p>
   By using stripes it is possible to distribute the data stream in the LV
   among several PVs (striping). However, striping a volume can only be done
   over different PVs, each providing at least the amount of space of the
   volume. The maximum number of stripes equals to the number of PVs, where
   Stripe "1" means "no striping". Striping only makes sense with PVs on
   different hard disks, otherwise performance will decrease.
  </p><div id="idm140019141169776" class="admonition warning normal"><img class="symbol" alt="Warning" title="Warning" src="static/images/icon-warning.png" /><h6>Warning: Striping</h6><p>
    YaST cannot, at this point, verify the correctness of your entries
    concerning striping. Any mistake made here is apparent only later when the
    LVM is implemented on disk.
   </p></div><p>
   If you have already configured LVM on your system, the existing logical
   volumes can also be used. Before continuing, assign appropriate mount
   points to these LVs. With <span class="guimenu">Finish</span>, return to the YaST
   Expert Partitioner and finish your work there.
  </p></div></div><div class="sect1 " id="sec.yast.system.raid"><div class="titlepage"><div><div><h2 class="title" id="sec.yast.system.raid"><span class="number">5.3 </span><span class="name">Soft RAID</span> <a title="Permalink" class="permalink" href="#sec.yast.system.raid">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">Filename: </span>deployment_expert_partitioner_raid.xml</li><li><span class="ds-label">ID: </span>sec.yast.system.raid</li></ul></div></div></div></div><p>
  This section describes actions required to create and configure various types
  of RAID. .
 </p><div class="sect2 " id="sec.yast.system.raid.conf"><div class="titlepage"><div><div><h3 class="title" id="sec.yast.system.raid.conf"><span class="number">5.3.1 </span><span class="name">Soft RAID Configuration</span> <a title="Permalink" class="permalink" href="#sec.yast.system.raid.conf">#</a></h3></div></div></div><p>
   The YaST <span class="guimenu">RAID</span> configuration can be reached from the
   YaST Expert Partitioner, described in
   <a class="xref" href="#sec.expert_partitioner" title="5.1. Using the Expert Partitioner">Section 5.1, “Using the Expert Partitioner”</a>. This partitioning tool enables
   you to edit and delete existing partitions and create new ones to be used
   with soft RAID:
  </p><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
     Select a hard disk from <span class="guimenu">Hard Disks</span>.
    </p></li><li class="step "><p>
     Change to the <span class="guimenu">Partitions</span> tab.
    </p></li><li class="step "><p>
     Click <span class="guimenu">Add</span> and enter the desired size of the raid
     partition on this disk.
    </p></li><li class="step "><p>
     Use <span class="guimenu">Do not Format the Partition</span> and change the
     <span class="guimenu">File System ID</span> to <span class="guimenu">0xFD Linux RAID</span>.
     Do not mount this partition.
    </p></li><li class="step "><p>
     Repeat this procedure until you have defined all the desired physical
     volumes on the available disks.
    </p></li></ol></div></div><p>
   For RAID 0 and RAID 1, at least two partitions are
   needed—for RAID 1, usually exactly two and no more. If
   RAID 5 is used, at least three partitions are required, RAID 6 and RAID
   10 require at least four partitions. It is recommended to use partitions of
   the same size only. The RAID partitions should be located on different hard
   disks to decrease the risk of losing data if one is defective (RAID 1
   and 5) and to optimize the performance of RAID 0. After creating all
   the partitions to use with RAID, click
   <span class="guimenu">RAID</span> › <span class="guimenu">Add RAID</span>
   to start the RAID configuration.
  </p><p>
   In the next dialog, choose between RAID levels 0, 1, 5, 6 and 10. Then,
   select all partitions with either the <span class="quote">“<span class="quote">Linux RAID</span>”</span> or
   <span class="quote">“<span class="quote">Linux native</span>”</span> type that should be used by the RAID system. No
   swap or DOS partitions are shown.
  </p><div id="idm140019141148080" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.png" /><h6>Tip: Classify Disks</h6><p>
    For RAID types where the order of added disks matters, you can mark
    individual disks with one of the letters A to E. Click the
    <span class="guimenu">Classify</span> button, select the disk and click of the
    <span class="guimenu">Class X</span> buttons, where X is the letter you want to
    assign to the disk. Assign all available RAID disks this way, and confirm
    with <span class="guimenu">OK</span>. You can easily sort the classified disks with
    the <span class="guimenu">Sorted</span> or <span class="guimenu">Interleaved</span> buttons, or
    add a sort pattern from a text file with <span class="guimenu">Pattern File</span>.
   </p></div><div class="figure" id="fig.yast2.system.raid.conf"><div class="figure-contents"><div class="mediaobject"><a xmlns="" href="images/install_partitioner_raid.png"><img src="images/install_partitioner_raid.png" width="" alt="RAID Partitions" /></a></div></div><div class="figure-title-wrap"><h6 class="figure-title"><span class="number">Figure 5.5: </span><span class="name">RAID Partitions </span><a title="Permalink" class="permalink" href="#fig.yast2.system.raid.conf">#</a></h6></div></div><p>
   To add a previously unassigned partition to the selected RAID volume, first
   click the partition then <span class="guimenu">Add</span>. Assign all partitions
   reserved for RAID. Otherwise, the space on the partition remains unused.
   After assigning all partitions, click <span class="guimenu">Next</span> to select the
   available <span class="guimenu">RAID Options</span>.
  </p><p>
   In this last step, set the file system to use, encryption and the mount
   point for the RAID volume. After completing the configuration with
   <span class="guimenu">Finish</span>, see the <code class="filename">/dev/md0</code> device and
   others indicated with <span class="emphasis"><em>RAID</em></span> in the Expert Partitioner.
  </p></div><div class="sect2 " id="sec.yast.system.raid.trouble"><div class="titlepage"><div><div><h3 class="title" id="sec.yast.system.raid.trouble"><span class="number">5.3.2 </span><span class="name">Troubleshooting</span> <a title="Permalink" class="permalink" href="#sec.yast.system.raid.trouble">#</a></h3></div></div></div><p>
   Check the file <code class="filename">/proc/mdstat</code> to find out whether a RAID
   partition has been damaged. If Th system fails, shut down your Linux system
   and replace the defective hard disk with a new one partitioned the same way.
   Then restart your system and enter the command <code class="command">mdadm /dev/mdX --add
   /dev/sdX</code>. Replace 'X' with your particular device identifiers.
   This integrates the hard disk automatically into the RAID system and fully
   reconstructs it.
  </p><p>
   Note that although you can access all data during the rebuild, you may
   encounter some performance issues until the RAID has been fully rebuilt.
  </p></div><div class="sect2 " id="sec.yast.system.raid.information"><div class="titlepage"><div><div><h3 class="title" id="sec.yast.system.raid.information"><span class="number">5.3.3 </span><span class="name">For More Information</span> <a title="Permalink" class="permalink" href="#sec.yast.system.raid.information">#</a></h3></div></div></div><p>
   Configuration instructions and more details for soft RAID can be found in
   the HOWTOs at:
  </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
     <code class="filename">/usr/share/doc/packages/mdadm/Software-RAID.HOWTO.html</code>
    </p></li><li class="listitem "><p>
     <a class="link" href="http://raid.wiki.kernel.org" target="_blank">http://raid.wiki.kernel.org</a>
    </p></li></ul></div><p>
   Linux RAID mailing lists are available, such as
   <a class="link" href="http://marc.info/?l=linux-raid" target="_blank">http://marc.info/?l=linux-raid</a>.
  </p></div></div></div><div class="chapter " id="cha.tuning.multikernel"><div class="titlepage"><div><div><h2 class="title"><span class="number">6 </span><span class="name">Installing Multiple Kernel Versions</span> <a title="Permalink" class="permalink" href="#cha.tuning.multikernel">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">Filename: </span>tuning_multikernel.xml</li><li><span class="ds-label">ID: </span>cha.tuning.multikernel</li></ul></div></div><div><div class="abstract"><div class="abstract-title-wrap"><h6 class="abstract-title">Abstract<a title="Permalink" class="permalink" href="#idm140019141120464">#</a></h6></div><p>
    <span class="productname"><span class="phrase">openSUSE Leap</span></span> supports the parallel installation of multiple kernel
    versions. When installing a second kernel, a boot entry and an initrd are
    automatically created, so no further manual configuration is needed. When
    rebooting the machine, the newly added kernel is available as an additional
    boot parameter.
   </p><p>
    Using this functionality, you can safely test kernel updates while being
    able to always fall back to the proven former kernel. To do this, do not use
    the update tools (such as the YaST Online Update or the updater applet),
    but instead follow the process described in this chapter.
   </p></div></div></div></div><div class="line"><div class="toc"><dl><dt><span class="sect1"><a href="#sec.tuning.multikernel.enable"><span class="number">6.1 </span><span class="name">Enabling and Configuring Multiversion Support</span></a></span></dt><dt><span class="sect1"><a href="#sec.tuning.multikernel.yast"><span class="number">6.2 </span><span class="name">Installing/Removing Multiple Kernel Versions with YaST</span></a></span></dt><dt><span class="sect1"><a href="#sec.tuning.multikernel.zypper"><span class="number">6.3 </span><span class="name">Installing/Removing Multiple Kernel Versions with Zypper</span></a></span></dt><dt><span class="sect1"><a href="#sec.tuning.multikernel.latest"><span class="number">6.4 </span><span class="name">
   Installing the Latest Kernel Version from the Repository <code class="literal">Kernel:HEAD</code>
  </span></a></span></dt></dl></div></div><div id="idm140019141115920" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.png" /><h6>Tip: Check Your Boot Loader Configuration Kernel</h6><p>
   It is recommended to check your boot loader configuration after having
   installed another kernel to set the default boot entry of your choice. See
   <a class="xref" href="#sec.grub2.yast2.config" title="12.3. Configuring the Boot Loader with YaST">Section 12.3, “Configuring the Boot Loader with YaST”</a> for more information.
  </p></div><div class="sect1 " id="sec.tuning.multikernel.enable"><div class="titlepage"><div><div><h2 class="title" id="sec.tuning.multikernel.enable"><span class="number">6.1 </span><span class="name">Enabling and Configuring Multiversion Support</span> <a title="Permalink" class="permalink" href="#sec.tuning.multikernel.enable">#</a></h2></div></div></div><p>
   Installing multiple versions of a software package (multiversion support) is
   enabled by default since <span class="phrase">openSUSE Leap</span>. To verify this setting, proceed as
   follows:
  </p><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
     Open <code class="filename">/etc/zypp/zypp.conf</code> with the editor of your
     choice as <code class="systemitem">root</code>.
    </p></li><li class="step "><p>
     Search for the string <code class="literal">multiversion</code>. If multiversion is
     enabled for all kernel packages capable of this feature, the following
     line appears uncommented:
    </p><div class="verbatim-wrap"><pre class="screen">multiversion = provides:multiversion(kernel)</pre></div></li><li class="step "><p>
     To restrict multiversion support to certain kernel flavors, add the
     package names as a comma-separated list to the
     <code class="literal">multiversion</code> option in
     <code class="filename">/etc/zypp/zypp.conf</code>—for example
    </p><div class="verbatim-wrap"><pre class="screen">multiversion = kernel-default,kernel-default-base,kernel-source</pre></div></li><li class="step "><p>
     Save your changes.
    </p></li></ol></div></div><div id="idm140019141103472" class="admonition warning normal"><img class="symbol" alt="Warning" title="Warning" src="static/images/icon-warning.png" /><h6>Warning: Kernel Module Packages (KMP)</h6><p>
    Make sure that required vendor provided kernel modules (Kernel Module
    Packages) are also installed for the new updated kernel. The kernel update
    process will not warn about eventually missing kernel modules because
    package requirements are still fulfilled by the old kernel that is kept on
    the system.
   </p></div><div class="sect2 " id="sec.tuning.multikernel.enable.keep"><div class="titlepage"><div><div><h3 class="title" id="sec.tuning.multikernel.enable.keep"><span class="number">6.1.1 </span><span class="name">Automatically Deleting Unused Kernels</span> <a title="Permalink" class="permalink" href="#sec.tuning.multikernel.enable.keep">#</a></h3></div></div></div><p>
    When frequently testing new kernels with multiversion support enabled, the
    boot menu quickly becomes confusing. Since a <code class="filename">/boot</code>
    partition usually has limited space you also might run into trouble with
    <code class="filename">/boot</code> overflowing. While you can delete unused kernel
    versions manually with YaST or Zypper (as described below), you can also
    configure <code class="systemitem">libzypp</code> to automatically
    delete kernels no longer used. By default no kernels are deleted.
   </p><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
      Open <code class="filename">/etc/zypp/zypp.conf</code> with the editor of your
      choice as <code class="systemitem">root</code>.
     </p></li><li class="step "><p>
      Search for the string <code class="literal">multiversion.kernels</code> and
      activate this option by uncommenting the line. This option takes a
      comma-separated list of the following values:
     </p><p><span class="formalpara-title"><code class="literal"><em class="replaceable ">3.12.24-7.1</em></code>: </span>
       keep the kernel with the specified version number
      </p><p><span class="formalpara-title"><code class="literal">latest</code>: </span>
       keep the kernel with the highest version number
      </p><p><span class="formalpara-title"><code class="literal">latest-N</code>: </span>
       keep the kernel with the Nth highest version number
      </p><p><span class="formalpara-title"><code class="literal">running</code>: </span>
       keep the running kernel
      </p><p><span class="formalpara-title"><code class="literal">oldest</code>: </span>
       keep the kernel with the lowest version number (the one that was
       originally shipped with <span class="productname"><span class="phrase">openSUSE Leap</span></span>)
      </p><p><span class="formalpara-title"><code class="literal">oldest+N</code>. </span>
       keep the kernel with the Nth lowest version number
      </p><p>
      Here are some examples
     </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019141082512"><span class="term "><code class="literal">multiversion.kernels = latest,running</code>
       </span></dt><dd><p>
         Keep the latest kernel and the one currently running. This is similar
         to not enabling the multiversion feature, except that the old kernel
         is removed <span class="emphasis"><em>after the next reboot</em></span> and not
         immediately after the installation.
        </p></dd><dt id="idm140019141079760"><span class="term "><code class="literal">multiversion.kernels = latest,latest-1,running</code>
       </span></dt><dd><p>
         Keep the last two kernels and the one currently running.
        </p></dd><dt id="idm140019141077584"><span class="term "><code class="literal">
         multiversion.kernels = latest,running,<em class="replaceable ">3.12.25.rc7-test</em></code>
       </span></dt><dd><p>
         Keep the latest kernel, the one currently running, and
         <em class="replaceable ">3.12.25.rc7-test</em>.
        </p></dd></dl></div><div id="idm140019141074512" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.png" /><h6>Tip: Keep the Running Kernel</h6><p>
       Unless you are using a special setup, always keep the
       kernel marked <code class="literal">running</code>.
      </p><p>
       If you do not keep the running kernel, it will be deleted when
       updating the kernel. In turn, this means that all of the running
       kernel's modules are also deleted and cannot be loaded anymore.
      </p><p>
       If you decide not to keep the running kernel, always reboot
       immediately after a kernel upgrade to avoid issues with modules.
      </p></div></li></ol></div></div></div><div class="sect2 " id="sec.tuning.multikernel.deleteoldkernel"><div class="titlepage"><div><div><h3 class="title" id="sec.tuning.multikernel.deleteoldkernel"><span class="number">6.1.2 </span><span class="name">Use Case: Deleting an Old Kernel after Reboot Only</span> <a title="Permalink" class="permalink" href="#sec.tuning.multikernel.deleteoldkernel">#</a></h3></div></div></div><p>
    You want to make sure that an old kernel will only be deleted after the
    system has rebooted successfully with the new kernel.
   </p><p>
    Change the following line in <code class="filename">/etc/zypp/zypp.conf</code>:
   </p><div class="verbatim-wrap"><pre class="screen">multiversion.kernels = latest,running</pre></div><p>
    The previous parameters tell the system to keep the latest kernel and the
    running one only if they differ.
   </p></div><div class="sect2 " id="sec.tuning.multikernel.fallback"><div class="titlepage"><div><div><h3 class="title" id="sec.tuning.multikernel.fallback"><span class="number">6.1.3 </span><span class="name">Use Case: Keeping Older Kernels as Fallback</span> <a title="Permalink" class="permalink" href="#sec.tuning.multikernel.fallback">#</a></h3></div></div></div><p>
    You want to keep one or more kernel versions to have one or more
    <span class="quote">“<span class="quote">spare</span>”</span> kernels.
   </p><p>
    This can be useful if you need kernels for testing. If something goes wrong
    (for example, your machine does not boot), you
    still can use one or more kernel versions which are known to be good.
   </p><p>
    Change the following line in <code class="filename">/etc/zypp/zypp.conf</code>:
   </p><div class="verbatim-wrap"><pre class="screen">multiversion.kernels = latest,latest-1,latest-2,running</pre></div><p>
    When you reboot your system after the installation of a new kernel, the
    system will keep three kernels: the current kernel (configured as
    <code class="literal">latest,running</code>) and its two immediate predecessors
    (configured as <code class="literal">latest-1</code> and <code class="literal">latest-2</code>).
   </p></div><div class="sect2 " id="sec.tuning.multikernel.specificversion"><div class="titlepage"><div><div><h3 class="title" id="sec.tuning.multikernel.specificversion"><span class="number">6.1.4 </span><span class="name">Use Case: Keeping a Specific Kernel Version</span> <a title="Permalink" class="permalink" href="#sec.tuning.multikernel.specificversion">#</a></h3></div></div></div><p>
    You make regular system updates and install new kernel versions. However,
    you are also compiling your own kernel version and want
    to make sure that the system will keep them.
   </p><p>
    Change the following line in <code class="filename">/etc/zypp/zypp.conf</code>:
   </p><div class="verbatim-wrap"><pre class="screen">multiversion.kernels = latest,3.12.28-4.20,running</pre></div><p>
    When you reboot your system after the installation of a new kernel, the
    system will keep two kernels: the new and running kernel (configured as
    <code class="literal">latest,running</code>) and your self-compiled kernel
    (configured as <code class="literal">3.12.28-4.20</code>).
   </p></div></div><div class="sect1 " id="sec.tuning.multikernel.yast"><div class="titlepage"><div><div><h2 class="title" id="sec.tuning.multikernel.yast"><span class="number">6.2 </span><span class="name">Installing/Removing Multiple Kernel Versions with YaST</span> <a title="Permalink" class="permalink" href="#sec.tuning.multikernel.yast">#</a></h2></div></div></div><p>
   You can install or remove multiple kernels with YaST:
  </p><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
     Start YaST and open the software manager via <span class="guimenu">Software</span> › <span class="guimenu">Software Management</span>.
    </p></li><li class="step "><p>
     List all packages capable of providing multiple versions by choosing
     <span class="guimenu">View</span> › <span class="guimenu">Package Groups</span> › <span class="guimenu">Multiversion Packages</span>.
    </p><div class="figure" id="idm140019141048752"><div class="figure-contents"><div class="mediaobject"><a xmlns="" href="images/yast2_sw_multiversion.png"><img src="images/yast2_sw_multiversion.png" width="" alt="The YaST Software Manager: Multiversion View" /></a></div></div><div class="figure-title-wrap"><h6 class="figure-title"><span class="number">Figure 6.1: </span><span class="name">The YaST Software Manager: Multiversion View </span><a title="Permalink" class="permalink" href="#idm140019141048752">#</a></h6></div></div></li><li class="step "><p>
     Select a package and open its <span class="guimenu">Version</span> tab in the bottom
     pane on the left.
    </p></li><li class="step "><p>
     To install a package, click the check box next to it. A green check mark indicates it
     is selected for installation.
    </p><p>
     To remove an already installed package (marked with a white check mark),
     click the check box next to it until a red <code class="literal">X</code> indicates it is
     selected for removal.
    </p></li><li class="step "><p>
     Click <span class="guimenu">Accept</span> to start the installation.
    </p></li></ol></div></div></div><div class="sect1 " id="sec.tuning.multikernel.zypper"><div class="titlepage"><div><div><h2 class="title" id="sec.tuning.multikernel.zypper"><span class="number">6.3 </span><span class="name">Installing/Removing Multiple Kernel Versions with Zypper</span> <a title="Permalink" class="permalink" href="#sec.tuning.multikernel.zypper">#</a></h2></div></div></div><p>
   You can install or remove multiple kernels with <code class="command">zypper</code>:
  </p><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
     Use the command <code class="command">zypper se -s 'kernel*'</code> to display a
     list of all kernel packages available:
    </p><div class="verbatim-wrap"><pre class="screen">S | Name           | Type       | Version         | Arch   | Repository
--+----------------+------------+-----------------+--------+-------------------
v | kernel-default | package    | 2.6.32.10-0.4.1 | x86_64 | Alternative Kernel
i | kernel-default | package    | 2.6.32.9-0.5.1  | x86_64 | (System Packages)
  | kernel-default | srcpackage | 2.6.32.10-0.4.1 | noarch | Alternative Kernel
i | kernel-default | package    | 2.6.32.9-0.5.1  | x86_64 | (System Packages)
...</pre></div></li><li class="step "><p>
     Specify the exact version when installing:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> zypper in kernel-default-2.6.32.10-0.4.1</pre></div></li><li class="step "><p>
     When uninstalling a kernel, use the commands <code class="command">zypper se -si
     'kernel*'</code> to list all kernels installed and <code class="command">zypper
     rm</code> <em class="replaceable ">PACKAGENAME-VERSION</em> to remove the
     package.
    </p></li></ol></div></div></div><div class="sect1 " id="sec.tuning.multikernel.latest"><div class="titlepage"><div><div><h2 class="title" id="sec.tuning.multikernel.latest"><span class="number">6.4 </span><span class="name">
   Installing the Latest Kernel Version from the Repository <code class="literal">Kernel:HEAD</code>
  </span> <a title="Permalink" class="permalink" href="#sec.tuning.multikernel.latest">#</a></h2></div></div></div><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
     Add the <code class="literal">Kernel:HEAD</code> repository with (the repository
     is added using the alias <code class="literal">kernel-repo</code>):
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> zypper ar \
http://download.opensuse.org/repositories/Kernel:/HEAD/standard/ \
kernel-repo</pre></div></li><li class="step "><p>
     To refresh repositories, run:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> zypper ref</pre></div></li><li class="step "><p>
     To upgrade the kernel to the latest version in the
     <code class="literal">Kernel:HEAD</code> repository, run:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> zypper dist-upgrade --from kernel-repo</pre></div></li><li class="step "><p>
     Reboot the machine.
    </p></li></ol></div></div><div id="idm140019141018256" class="admonition warning normal"><img class="symbol" alt="Warning" title="Warning" src="static/images/icon-warning.png" /><h6>Warning: Installing from <code class="literal">Kernel:HEAD</code> May Break the System</h6><p>
    Installing a kernel from <code class="literal">Kernel:HEAD</code> should never be
    necessary, because important fixes are backported by SUSE and are made
    available as official updates. Installing the latest kernel only makes
    sense for kernel developers and kernel testers. If installing from
    <code class="literal">Kernel:HEAD</code>, be aware that it may break your system.
    Make sure to always have the original kernel available for booting as
    well.
   </p></div></div></div><div class="chapter " id="cha.gnome.gconf"><div class="titlepage"><div><div><h2 class="title"><span class="number">7 </span><span class="name">GNOME Configuration for Administrators</span> <a title="Permalink" class="permalink" href="#cha.gnome.gconf">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">Filename: </span>gnome_admin.xml</li><li><span class="ds-label">ID: </span>cha.gnome.gconf</li></ul></div></div></div></div><div class="line"><div class="toc"><dl><dt><span class="sect1"><a href="#sec.gnome.gconf.autostart"><span class="number">7.1 </span><span class="name">Starting Applications Automatically</span></a></span></dt><dt><span class="sect1"><a href="#sec.gnome.gconf.automount"><span class="number">7.2 </span><span class="name">Automounting and Managing Media Devices</span></a></span></dt><dt><span class="sect1"><a href="#sec.gnome.gconf.pref_app"><span class="number">7.3 </span><span class="name">Changing Preferred Applications</span></a></span></dt><dt><span class="sect1"><a href="#sec.gnome.gconf.templates"><span class="number">7.4 </span><span class="name">Adding Document Templates</span></a></span></dt><dt><span class="sect1"><a href="#sec.gnome.gconf.info"><span class="number">7.5 </span><span class="name">For More Information</span></a></span></dt></dl></div></div><p>
  This chapter introduces GNOME configuration options which administrators
  can use to adjust system-wide settings, such as customizing menus,
  installing themes, configuring fonts, changing preferred applications, and
  locking down capabilities.
 </p><p>
  These configuration options are stored in the GConf system. Access the
  GConf system with tools such as the <code class="command">gconftool-2</code> command
  line interface or the <code class="command">gconf-editor</code> GUI tool.
 </p><div class="sect1 " id="sec.gnome.gconf.autostart"><div class="titlepage"><div><div><h2 class="title" id="sec.gnome.gconf.autostart"><span class="number">7.1 </span><span class="name">Starting Applications Automatically</span> <a title="Permalink" class="permalink" href="#sec.gnome.gconf.autostart">#</a></h2></div></div></div><p>
   To automatically start applications in GNOME, use one of the following
   methods:
  </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p><span class="formalpara-title">To run applications for each user: </span>
      Put <code class="filename">.desktop</code> files in
      <code class="filename">/usr/share/gnome/autostart</code>.
     </p></li><li class="listitem "><p><span class="formalpara-title">To run applications for an individual user: </span>
      Put <code class="filename">.desktop</code> files in
      <code class="filename">~/.config/autostart</code>.
     </p></li></ul></div><p>
   To disable an application that starts automatically, add
   <code class="literal">X-Autostart-enabled=false</code> to the
   <code class="filename">.desktop</code> file.
  </p></div><div class="sect1 " id="sec.gnome.gconf.automount"><div class="titlepage"><div><div><h2 class="title" id="sec.gnome.gconf.automount"><span class="number">7.2 </span><span class="name">Automounting and Managing Media Devices</span> <a title="Permalink" class="permalink" href="#sec.gnome.gconf.automount">#</a></h2></div></div></div><p>
   GNOME Files (<code class="command">nautilus</code>) monitors volume-related events and
   responds with a user-specified policy. You can use GNOME Files to
   automatically mount hotplugged drives and inserted removable media,
   automatically run programs, and play audio CDs or video DVDs. GNOME Files
   can also automatically import photos from a digital camera.
  </p><p>
   System administrators can set system-wide defaults. For more information,
   see <a class="xref" href="#sec.gnome.gconf.pref_app" title="7.3. Changing Preferred Applications">Section 7.3, “Changing Preferred Applications”</a>.
  </p></div><div class="sect1 " id="sec.gnome.gconf.pref_app"><div class="titlepage"><div><div><h2 class="title" id="sec.gnome.gconf.pref_app"><span class="number">7.3 </span><span class="name">Changing Preferred Applications</span> <a title="Permalink" class="permalink" href="#sec.gnome.gconf.pref_app">#</a></h2></div></div></div><p>
   To change users' preferred applications, edit
   <code class="filename">/etc/gnome_defaults.conf</code>. Find further hints within
   this file.
  </p><p>
   For more information about MIME types, see
   <a class="link" href="http://www.freedesktop.org/Standards/shared-mime-info-spec" target="_blank">http://www.freedesktop.org/Standards/shared-mime-info-spec</a>.
  </p></div><div class="sect1 " id="sec.gnome.gconf.templates"><div class="titlepage"><div><div><h2 class="title" id="sec.gnome.gconf.templates"><span class="number">7.4 </span><span class="name">Adding Document Templates</span> <a title="Permalink" class="permalink" href="#sec.gnome.gconf.templates">#</a></h2></div></div></div><p>
   To add document templates for users, fill in the
   <code class="filename">Templates</code> directory in a user's home directory. You
   can do this manually for each user by copying the files into
   <code class="filename">~/Templates</code>, or system-wide by adding a
   <code class="filename">Templates</code> directory with documents to
   <code class="filename">/etc/skel</code> before the user is created.
  </p><p>
   A user creates a new document from a template by right-clicking the
   desktop and selecting <span class="guimenu">Create Document</span>.
  </p></div><div class="sect1 " id="sec.gnome.gconf.info"><div class="titlepage"><div><div><h2 class="title" id="sec.gnome.gconf.info"><span class="number">7.5 </span><span class="name">For More Information</span> <a title="Permalink" class="permalink" href="#sec.gnome.gconf.info">#</a></h2></div></div></div><p>
   For more information, see
   <a class="link" href="http://help.gnome.org/admin/" target="_blank">http://help.gnome.org/admin/</a>.
  </p></div></div></div><div class="part" id="part.reference.system"><div class="titlepage"><div><div><h1 class="title"><span class="number">Part II </span><span class="name">System </span><a title="Permalink" class="permalink" href="#part.reference.system">#</a></h1></div></div></div><div class="toc"><dl><dt><span class="chapter"><a href="#cha.64bit"><span class="number">8 </span><span class="name">32-Bit and 64-Bit Applications in a 64-Bit System Environment</span></a></span></dt><dd class="toc-abstract"><p>openSUSE® Leap is available for 64-bit platforms. This does not necessarily mean that all the applications included have already been ported to 64-bit platforms. openSUSE Leap supports the use of 32-bit applications in a 64-bit system environment. This chapter offers a brief overview of how this sup…</p></dd><dt><span class="chapter"><a href="#cha.boot"><span class="number">9 </span><span class="name">Introduction to the Booting Process</span></a></span></dt><dd class="toc-abstract"><p>
    Booting a Linux system involves different components and tasks. The
    hardware itself is initialized by the BIOS or the UEFI, which starts the
    kernel by means of a boot loader. After this point, the boot process is
    completely controlled by the operating system and handled by <code class="systemitem">systemd</code>.
    <code class="systemitem">systemd</code> provides a set of <span class="quote">“<span class="quote">targets</span>”</span> that boot setups for
    everyday usage, maintenance or emergencies.
   </p></dd><dt><span class="chapter"><a href="#cha.systemd"><span class="number">10 </span><span class="name">The <code class="systemitem">systemd</code> Daemon</span></a></span></dt><dd class="toc-abstract"><p>The program systemd is the process with process ID 1. It is responsible for initializing the system in the required way. systemd is started directly by the kernel and resists signal 9, which normally terminates processes. All other programs are either started directly by systemd or by one of its chi…</p></dd><dt><span class="chapter"><a href="#cha.journalctl"><span class="number">11 </span><span class="name"><code class="command">journalctl</code>: Query the <code class="systemitem">systemd</code> Journal</span></a></span></dt><dd class="toc-abstract"><p>
  When <code class="systemitem">systemd</code> replaced traditional init scripts in <span class="phrase">openSUSE Leap</span>
  (see <a class="xref" href="#cha.systemd" title="Chapter 10. The systemd Daemon">Chapter 10, <em>The <code class="systemitem">systemd</code> Daemon</em></a>), it introduced its own logging system
  called <span class="emphasis"><em>journal</em></span>. There is no need to run a
  <code class="systemitem">syslog</code> based service anymore, as all system events
  are written in the journal.
 </p></dd><dt><span class="chapter"><a href="#cha.grub2"><span class="number">12 </span><span class="name">The Boot Loader GRUB 2</span></a></span></dt><dd class="toc-abstract"><p>
    This chapter describes how to configure GRUB 2, the boot loader used in
    <span class="productname"><span class="phrase">openSUSE® Leap</span></span>. It is the successor to the traditional GRUB boot
    loader—now called <span class="quote">“<span class="quote">GRUB Legacy</span>”</span>.
     A YaST module is available
    for configuring the most important settings. The boot procedure as a whole
    is outlined in <a class="xref" href="#cha.boot" title="Chapter 9. Introduction to the Booting Process">Chapter 9, <em>Introduction to the Booting Process</em></a>. For details on Secure Boot
    support for UEFI machines, see <a class="xref" href="#cha.uefi" title="Chapter 14. UEFI (Unified Extensible Firmware Interface)">Chapter 14, <em>UEFI (Unified Extensible Firmware Interface)</em></a>.
   </p></dd><dt><span class="chapter"><a href="#cha.network"><span class="number">13 </span><span class="name">Basic Networking</span></a></span></dt><dd class="toc-abstract"><p>
    Linux offers the necessary networking tools and features for integration
    into all types of network structures. Network access using a network card
    can be configured with YaST. Manual configuration is also possible. In
    this chapter only the fundamental mechanisms and the relevant network
    configuration files are covered.
   </p></dd><dt><span class="chapter"><a href="#cha.uefi"><span class="number">14 </span><span class="name">UEFI (Unified Extensible Firmware Interface)</span></a></span></dt><dd class="toc-abstract"><p>
  UEFI (Unified Extensible Firmware Interface) is the interface between the
  firmware that comes with the system hardware, all the hardware components of
  the system, and the operating system.
 </p></dd><dt><span class="chapter"><a href="#cha.suse"><span class="number">15 </span><span class="name">Special System Features</span></a></span></dt><dd class="toc-abstract"><p>
    This chapter starts with information about various software packages, the
    virtual consoles and the keyboard layout. We talk about software components
    like <code class="systemitem">bash</code>,
    <code class="systemitem">cron</code> and
    <code class="systemitem">logrotate</code>, because they were
    changed or enhanced during the last release cycles. Even if they are small
    or considered of minor importance, users should change their default
    behavior, because these components are often closely coupled with the
    system. The chapter concludes with a section about language and
    country-specific settings (I18N and L10N).
   </p></dd><dt><span class="chapter"><a href="#cha.udev"><span class="number">16 </span><span class="name">Dynamic Kernel Device Management with <code class="systemitem">udev</code></span></a></span></dt><dd class="toc-abstract"><p>The kernel can add or remove almost any device in a running system. Changes in the device state (whether a device is plugged in or removed) need to be propagated to user space. Devices need to be configured when they are plugged in and recognized. Users of a certain device need to be informed about …</p></dd></dl></div><div class="chapter " id="cha.64bit"><div class="titlepage"><div><div><h2 class="title"><span class="number">8 </span><span class="name">32-Bit and 64-Bit Applications in a 64-Bit System Environment</span> <a title="Permalink" class="permalink" href="#cha.64bit">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">Filename: </span>64bit_issues.xml</li><li><span class="ds-label">ID: </span>cha.64bit</li></ul></div></div></div></div><div class="line"><div class="toc"><dl><dt><span class="sect1"><a href="#sec.64bit.runt"><span class="number">8.1 </span><span class="name">Runtime Support</span></a></span></dt><dt><span class="sect1"><a href="#sec.64bit.devel"><span class="number">8.2 </span><span class="name">Software Development</span></a></span></dt><dt><span class="sect1"><a href="#sec.64bit.biarch"><span class="number">8.3 </span><span class="name">Software Compilation on Biarch Platforms</span></a></span></dt><dt><span class="sect1"><a href="#sec.64bit.kernel"><span class="number">8.4 </span><span class="name">Kernel Specifications</span></a></span></dt></dl></div></div><p>
  <span class="productname"><span class="phrase">openSUSE® Leap</span></span> is available for  64-bit
  platforms. This does not necessarily mean that all the applications included
  have already been ported to 64-bit platforms. <span class="productname"><span class="phrase">openSUSE Leap</span></span> supports the use
  of 32-bit applications in a 64-bit system environment. This chapter offers a
  brief overview of how this support is implemented on 64-bit <span class="productname"><span class="phrase">openSUSE Leap</span></span>
  platforms. It explains how 32-bit applications are executed and how 32-bit applications should be compiled to enable them to run both in
  32-bit and 64-bit system environments. Additionally, find information about
  the kernel API and an explanation of how 32-bit applications can run under a
  64-bit kernel.
 </p><p>
  <span class="phrase"><span class="productname"><span class="phrase">openSUSE Leap</span></span> for the
  64-bit platforms amd64 and Intel 64</span> is designed so that existing
  32-bit applications run in the 64-bit environment
  <span class="quote">“<span class="quote">out-of-the-box.</span>”</span>  This
  support means that you can continue to use your preferred 32-bit applications
  without waiting for a corresponding 64-bit port to become
  available.
 </p><div class="sect1 " id="sec.64bit.runt"><div class="titlepage"><div><div><h2 class="title" id="sec.64bit.runt"><span class="number">8.1 </span><span class="name">Runtime Support</span> <a title="Permalink" class="permalink" href="#sec.64bit.runt">#</a></h2></div></div></div><div id="idm140019140970368" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.png" /><h6>Important: Conflicts Between Application Versions</h6><p>
    If an application is available both for 32-bit and 64-bit environments,
    parallel installation of both versions is bound to lead to problems. In
    such cases, decide on one of the two versions and install and use this.
   </p><p>
    An exception to this rule is PAM (pluggable authentication modules).
    <span class="productname"><span class="phrase">openSUSE Leap</span></span> uses PAM in the authentication process as a layer that
    mediates between user and application. On a 64-bit operating system that
    also runs 32-bit applications it is necessary to always install both
    versions of a PAM module.
   </p></div><p>
   To be executed correctly, every application requires a range of libraries.
   Unfortunately, the names for the 32-bit and 64-bit versions of these
   libraries are identical. They must be differentiated from each other in
   another way.
  </p><p>
   To retain compatibility with the 32-bit version, the libraries are stored at
   the same place in the system as in the 32-bit environment. The 32-bit
   version of <code class="filename">libc.so.6</code> is located under
   <code class="filename">/lib/libc.so.6</code> in both the 32-bit and 64-bit
   environments.
  </p><p>
   All 64-bit libraries and object files are located in directories called
   <code class="filename">lib64</code>. The 64-bit object files that you would normally
   expect to find under <code class="filename">/lib</code> and
   <code class="filename">/usr/lib</code> are now found under
   <code class="filename">/lib64</code> and <code class="filename">/usr/lib64</code>. This means
   that there is space for the 32-bit libraries under <code class="filename">/lib</code>
   and <code class="filename">/usr/lib</code>, so the file name for both versions can
   remain unchanged.
  </p><p>
   Subdirectories of 32-bit <code class="filename">/lib</code> directories which contain
   data content that does not depend on the word size are not moved. This
   scheme conforms to LSB (Linux Standards Base) and FHS (File System Hierarchy
   Standard).
  </p></div><div class="sect1 " id="sec.64bit.devel"><div class="titlepage"><div><div><h2 class="title" id="sec.64bit.devel"><span class="number">8.2 </span><span class="name">Software Development</span> <a title="Permalink" class="permalink" href="#sec.64bit.devel">#</a></h2></div></div></div><p>
   All 64-bit architectures support the development of 64-bit objects. The
   level of support for 32-bit compiling depends on the architecture. These are
   the various implementation options for the toolchain from GCC (GNU Compiler
   Collection) and binutils, which include the assembler <code class="command">as</code>
   and the linker <code class="command">ld</code>:
  </p><p>
   Both 32-bit and 64-bit objects can be generated with a biarch development
   toolchain. A biarch development toolchain allows generation of 32-bit and
   64-bit objects. The compilation of 64-bit objects is the default on almost
   all platforms. 32-bit objects can be generated if special flags are used.
   This special flag is <code class="option">-m32</code> for GCC. The flags for the
   binutils are architecture-dependent, but GCC transfers the correct flags to
   linkers and assemblers. A biarch development toolchain currently exists for
   amd64 (supports development for x86 and amd64 instructions), for IBM Z
   and for POWER. 32-bit objects are normally created on the POWER
   platform. The <code class="literal">-m64</code> flag must be used to generate 64-bit
   objects.
  </p><p>
   All header files must be written in an architecture-independent form. The
   installed 32-bit and 64-bit libraries must have an API (application
   programming interface) that matches the installed header files. The normal
   <span class="productname"><span class="phrase">openSUSE Leap</span></span> environment is designed according to this principle. In the
   case of manually updated libraries, resolve these issues yourself.
  </p></div><div class="sect1 " id="sec.64bit.biarch"><div class="titlepage"><div><div><h2 class="title" id="sec.64bit.biarch"><span class="number">8.3 </span><span class="name">Software Compilation on Biarch Platforms</span> <a title="Permalink" class="permalink" href="#sec.64bit.biarch">#</a></h2></div></div></div><p>
   To develop binaries for the other architecture on a biarch architecture, the
   respective libraries for the second architecture must additionally be
   installed. These packages are called
   <code class="systemitem">rpmname-32bit</code>. You also need the respective
   headers and libraries from the
   <code class="systemitem">rpmname-devel</code> packages and the
   development libraries for the second architecture from
   <code class="systemitem">rpmname-devel-32bit</code>.
  </p><p>
   For example, to compile a program that uses <code class="command">libaio</code> on a
   system with a 32-bit second architecture (x86_64), you need the following
   RPMs:
  </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019140946576"><span class="term ">libaio-32bit</span></dt><dd><p>
      32-bit runtime package
     </p></dd><dt id="idm140019140944768"><span class="term ">libaio-devel-32bit</span></dt><dd><p>
      Headers and libraries for 32-bit development
     </p></dd><dt id="idm140019140942928"><span class="term ">libaio</span></dt><dd><p>
      64-bit runtime package
     </p></dd><dt id="idm140019140941120"><span class="term ">libaio-devel</span></dt><dd><p>
      64-bit development headers and libraries
     </p></dd></dl></div><p>
   Most open source programs use an <code class="command">autoconf</code>-based program
   configuration. To use <code class="command">autoconf</code> for configuring a program
   for the second architecture, overwrite the normal compiler and linker
   settings of <code class="command">autoconf</code> by running the
   <code class="command">configure</code> script with additional environment variables.
  </p><p>
   The following example refers to an x86_64 system with x86 as the second
   architecture. 
  </p><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
     Use the 32-bit compiler:
    </p><div class="verbatim-wrap"><pre class="screen">CC="gcc -m32"</pre></div></li><li class="step "><p>
     Instruct the linker to process 32-bit objects (always use
     <code class="command">gcc</code> as the linker front-end):
    </p><div class="verbatim-wrap"><pre class="screen">LD="gcc -m32"</pre></div></li><li class="step "><p>
     Set the assembler to generate 32-bit objects:
    </p><div class="verbatim-wrap"><pre class="screen">AS="gcc -c -m32"</pre></div></li><li class="step "><p>
     Specify linker flags, such as the location of 32-bit libraries, for
     example:
    </p><div class="verbatim-wrap"><pre class="screen">LDFLAGS="-L/usr/lib"</pre></div></li><li class="step "><p>
     Specify the location for the 32-bit object code libraries:
    </p><div class="verbatim-wrap"><pre class="screen">--libdir=/usr/lib</pre></div></li><li class="step "><p>
     Specify the location for the 32-bit X libraries:
    </p><div class="verbatim-wrap"><pre class="screen">--x-libraries=/usr/lib</pre></div></li></ol></div></div><p>
   Not all of these variables are needed for every program. Adapt them to the
   respective program.
  </p><p>
   An example <code class="command">configure</code> call to compile a native 32-bit
   application on x86_64 could
   appear as follows:
  </p><div class="verbatim-wrap"><pre class="screen">CC="gcc -m32"
LDFLAGS="-L/usr/lib;"
./configure --prefix=/usr --libdir=/usr/lib --x-libraries=/usr/lib
make
make install</pre></div></div><div class="sect1 " id="sec.64bit.kernel"><div class="titlepage"><div><div><h2 class="title" id="sec.64bit.kernel"><span class="number">8.4 </span><span class="name">Kernel Specifications</span> <a title="Permalink" class="permalink" href="#sec.64bit.kernel">#</a></h2></div></div></div><p>
   The 64-bit kernels for AMD64/Intel 64 offer both a 64-bit and a 32-bit kernel ABI (application
   binary interface). The latter is identical with the ABI for the
   corresponding 32-bit kernel. This means that the 32-bit application can
   communicate with the 64-bit kernel in the same way as with the 32-bit
   kernel.
  </p><p>
   The 32-bit emulation of system calls for a 64-bit kernel does not support
   all the APIs used by system programs. This depends on the platform. For this
   reason, few applications, like <code class="command">lspci</code>, must be
   compiled.
  </p><p>
   A 64-bit kernel can only load 64-bit kernel modules that have been specially
   compiled for this kernel. It is not possible to use 32-bit kernel modules.
  </p><div id="idm140019140920560" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.png" /><h6>Tip: Kernel-loadable Modules</h6><p>
    Some applications require separate kernel-loadable modules. If you intend
    to use such a 32-bit application in a 64-bit system environment, contact
    the provider of this application and SUSE to make sure that the 64-bit
    version of the kernel-loadable module and the 32-bit compiled version of
    the kernel API are available for this module.
   </p></div></div></div><div class="chapter " id="cha.boot"><div class="titlepage"><div><div><h2 class="title"><span class="number">9 </span><span class="name">Introduction to the Booting Process</span> <a title="Permalink" class="permalink" href="#cha.boot">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">Filename: </span>bootconcept.xml</li><li><span class="ds-label">ID: </span>cha.boot</li></ul></div></div><div><div class="abstract"><div class="abstract-title-wrap"><h6 class="abstract-title">Abstract<a title="Permalink" class="permalink" href="#idm140019140915872">#</a></h6></div><p>
    Booting a Linux system involves different components and tasks. The
    hardware itself is initialized by the BIOS or the UEFI, which starts the
    kernel by means of a boot loader. After this point, the boot process is
    completely controlled by the operating system and handled by <code class="systemitem">systemd</code>.
    <code class="systemitem">systemd</code> provides a set of <span class="quote">“<span class="quote">targets</span>”</span> that boot setups for
    everyday usage, maintenance or emergencies.
   </p></div></div></div></div><div class="line"><div class="toc"><dl><dt><span class="sect1"><a href="#sec.boot.proc"><span class="number">9.1 </span><span class="name">The Linux Boot Process</span></a></span></dt><dt><span class="sect1"><a href="#sec.boot.initrd"><span class="number">9.2 </span><span class="name"><code class="systemitem">initramfs</code></span></a></span></dt><dt><span class="sect1"><a href="#sec.boot.linuxrc"><span class="number">9.3 </span><span class="name">Init on <code class="systemitem">initramfs</code></span></a></span></dt></dl></div></div><div class="sect1 " id="sec.boot.proc"><div class="titlepage"><div><div><h2 class="title" id="sec.boot.proc"><span class="number">9.1 </span><span class="name">The Linux Boot Process</span> <a title="Permalink" class="permalink" href="#sec.boot.proc">#</a></h2></div></div></div><p>
   The Linux boot process consists of several stages, each represented by a
   different component. The following list briefly summarizes the boot process
   and features all the major components involved:
  </p><div class="orderedlist "><ol class="orderedlist" type="1"><li class="listitem "><p><span class="formalpara-title">BIOS/UEFI. </span>
      After turning on the computer, the BIOS or the UEFI initializes the
      screen and keyboard, and tests the main memory. Up to this stage, the
      machine does not access any mass storage media. Subsequently, the
      information about the current date, time, and the most important
      peripherals are loaded from the CMOS values. When the first hard disk and
      its geometry are recognized, the system control passes from the BIOS to
      the boot loader. If the BIOS supports network booting, it is also
      possible to configure a boot server that provides the boot loader. On
      AMD64/Intel 64 systems, PXE boot is needed. Other architectures
      commonly use the BOOTP protocol to get the boot loader.
      For more information on UEFI, refer to <a class="xref" href="#cha.uefi" title="Chapter 14. UEFI (Unified Extensible Firmware Interface)">Chapter 14, <em>UEFI (Unified Extensible Firmware Interface)</em></a>.
     </p></li><li class="listitem "><p><span class="formalpara-title">Boot Loader. </span>
      The first physical 512-byte data sector of the first hard disk is loaded
      into the main memory and the <span class="emphasis"><em>boot loader</em></span> that
      resides at the beginning of this sector takes over. The commands executed
      by the boot loader determine the remaining part of the boot process.
      Therefore, the first 512 bytes on the first hard disk are called the
      <span class="emphasis"><em>Master Boot Record</em></span> (MBR). The boot loader then
      passes control to the actual operating system, in this case, the Linux
      kernel. More information about GRUB 2, the Linux boot loader, can be
      found in <a class="xref" href="#cha.grub2" title="Chapter 12. The Boot Loader GRUB 2">Chapter 12, <em>The Boot Loader GRUB 2</em></a>. For a network boot, the BIOS acts
      as the boot loader. It gets the boot image from the boot server and
      starts the system. This is completely independent of local hard disks.
     </p><p>
     If the root file system fails to mount from within the boot environment,
     it must be checked and repaired before the boot can continue. The file
     system checker will be automatically started for Ext3 and Ext4 file
     systems. The repair process is not automated for XFS and Btrfs file
     systems, and the user is be presented with information describing the
     options available to repair the file system. When the file system has been
     successfully repaired, exiting the boot environment will cause the system
     to retry mounting the root file system. If successful, the boot will
     continue normally.
    </p></li><li class="listitem "><p><span class="formalpara-title">Kernel and <code class="systemitem">initramfs</code>. </span>
      To pass system control, the boot loader loads both the kernel and an
      initial RAM-based file system (<code class="systemitem">initramfs</code>) into
      memory. The contents of the <code class="systemitem">initramfs</code> can be
      used by the kernel directly. <code class="systemitem">initramfs</code> contains
      a small executable called <code class="systemitem">init</code> that handles the
      mounting of the real root file system. If special hardware drivers are
      needed before the mass storage can be accessed, they must be in
      <code class="systemitem">initramfs</code>. For more information about
      <code class="systemitem">initramfs</code>, refer to
      <a class="xref" href="#sec.boot.initrd" title="9.2. initramfs">Section 9.2, “<code class="systemitem">initramfs</code>”</a>. If the system does not have a
      local hard disk, the <code class="systemitem">initramfs</code> must provide the
      root file system for the kernel. This can be done using a network block
      device like iSCSI or SAN, but it is also possible to use NFS as the root
      device.
     </p><div id="idm140019140894576" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note: The <code class="systemitem">init</code> Process Naming</h6><p>
      Two different programs are commonly named <span class="quote">“<span class="quote">init</span>”</span>:
     </p><div class="orderedlist "><ol class="orderedlist" type="a"><li class="listitem "><p>
        the <code class="systemitem">initramfs</code> process mounting the root file
        system
       </p></li><li class="listitem "><p>
        the operating system process setting up the system
       </p></li></ol></div><p>
      In this chapter we will therefore refer to them as
      <span class="quote">“<span class="quote"><code class="systemitem">init</code> on
      <code class="systemitem">initramfs</code></span>”</span> and <span class="quote">“<span class="quote"><code class="systemitem">systemd</code></span>”</span>,
      respectively.
     </p></div></li><li class="listitem "><p><span class="formalpara-title"><code class="systemitem">init</code> on <code class="systemitem">initramfs</code>. </span>
      This program performs all actions needed to mount the proper root file
      system. It provides kernel functionality for the needed file system and
      device drivers for mass storage controllers with
      <code class="systemitem">udev</code>. After the root file system
      has been found, it is checked for errors and mounted. If this is
      successful, the <code class="systemitem">initramfs</code> is cleaned and the
      <code class="systemitem">systemd</code> daemon on the root file system is executed. For more
      information about <code class="systemitem">init</code> on
      <code class="systemitem">initramfs</code>, refer to
      <a class="xref" href="#sec.boot.linuxrc" title="9.3. Init on initramfs">Section 9.3, “Init on <code class="systemitem">initramfs</code>”</a>. Find more information about
      <code class="systemitem">udev</code> in
      <a class="xref" href="#cha.udev" title="Chapter 16. Dynamic Kernel Device Management with udev">Chapter 16, <em>Dynamic Kernel Device Management with <code class="systemitem">udev</code></em></a>.
     </p></li><li class="listitem "><p><span class="formalpara-title"><code class="systemitem">systemd</code>. </span>
      By starting services and mounting file systems, <code class="systemitem">systemd</code> handles the
      actual booting of the system. <code class="systemitem">systemd</code> is described in
      <a class="xref" href="#cha.systemd" title="Chapter 10. The systemd Daemon">Chapter 10, <em>The <code class="systemitem">systemd</code> Daemon</em></a>.
     </p></li></ol></div></div><div class="sect1 " id="sec.boot.initrd"><div class="titlepage"><div><div><h2 class="title" id="sec.boot.initrd"><span class="number">9.2 </span><span class="name"><code class="systemitem">initramfs</code></span> <a title="Permalink" class="permalink" href="#sec.boot.initrd">#</a></h2></div></div></div><p>
   <code class="systemitem">initramfs</code> is a small cpio archive that the kernel
   can load into a RAM disk. It provides a minimal Linux environment that
   enables the execution of programs before the actual root file system is
   mounted. This minimal Linux environment is loaded into memory by BIOS or
   UEFI routines and does not have specific hardware requirements other than
   sufficient memory. The <code class="systemitem">initramfs</code> archive must
   always provide an executable named <code class="systemitem">init</code> that
   executes the <code class="systemitem">systemd</code> daemon on the root file system for the boot process
   to proceed.
  </p><p>
   Before the root file system can be mounted and the operating system can be
   started, the kernel needs the corresponding drivers to access the device on
   which the root file system is located. These drivers may include special
   drivers for certain kinds of hard disks or even network drivers to access a
   network file system. The needed modules for the root file system may be
   loaded by <code class="systemitem">init</code> on
   <code class="systemitem">initramfs</code>. After the modules are loaded,
   <code class="systemitem">udev</code> provides the
   <code class="systemitem">initramfs</code> with the needed devices. Later in the
   boot process, after changing the root file system, it is necessary to
   regenerate the devices. This is done by the <code class="systemitem">systemd</code> unit
   <code class="filename">udev.service</code> with the command
   <code class="command">udevtrigger</code>.
  </p><p>
   If you need to change hardware (for example, hard disks), and this hardware requires different drivers to be in the kernel at
   boot time, you must update the <code class="systemitem">initramfs</code> file. This
   is done by calling <code class="command">dracut</code> <code class="option">-f</code> (the option
   <code class="option">-f</code> overwrites the existing initramfs file). To add a driver
   for the new hardware, edit
   <code class="filename">/etc/dracut.conf.d/01-dist.conf</code> and add the following
   line. If the file does not exist, create it.
  </p><div class="verbatim-wrap"><pre class="screen">force_drivers+="<em class="replaceable ">DRIVER1</em>"</pre></div><p>
   Replace <em class="replaceable ">DRIVER1</em> with the module name of the
   driver. If you need to add more than one driver, list them space-separated
   (<code class="literal"><em class="replaceable ">DRIVER1</em>
   <em class="replaceable ">DRIVER2</em></code>).
  </p><div id="idm140019140859968" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.png" /><h6>Important: Updating <code class="systemitem">initramfs</code> or <code class="systemitem">init</code></h6><p>
    The boot loader loads <code class="systemitem">initramfs</code> or
    <code class="systemitem">init</code> in the same way as the kernel. It is not
    necessary to re-install GRUB 2 after updating
    <code class="systemitem">initramfs</code> or <code class="systemitem">init</code>,
    because GRUB 2 searches the directory for the right file when booting.
   </p></div><div id="idm140019140855936" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.png" /><h6>Tip: Changing Kernel Variables</h6><p>
    If you change the values of kernel variables via the
    <code class="command">sysctl</code> interface by editing related files
    (<code class="filename">/etc/sysctl.conf</code> or
    <code class="filename">/etc/sysctl.d/*.conf</code>), the change will be lost on the
    next system reboot. Even if you load the values with <code class="command">sysctl
    --system</code> at runtime, the changes are not saved into the initramfs
    file. You need to update it by calling <code class="command">dracut</code>
    <code class="option">-f</code> (the option <code class="option">-f</code> overwrites the existing
    initramfs file).
   </p></div></div><div class="sect1 " id="sec.boot.linuxrc"><div class="titlepage"><div><div><h2 class="title" id="sec.boot.linuxrc"><span class="number">9.3 </span><span class="name">Init on <code class="systemitem">initramfs</code></span> <a title="Permalink" class="permalink" href="#sec.boot.linuxrc">#</a></h2></div></div></div><p>
   The main purpose of <code class="systemitem">init</code> on
   <code class="systemitem">initramfs</code> is to prepare the mounting of and access
   to the real root file system. Depending on your system configuration,
   <code class="systemitem">init</code> on <code class="systemitem">initramfs</code> is
   responsible for the following tasks.
  </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019140846880"><span class="term ">Loading Kernel Modules</span></dt><dd><p>
      Depending on your hardware configuration, special drivers may be needed
      to access the hardware components of your computer (the most important
      component being your hard disk). To access the final root file system,
      the kernel needs to load the proper file system drivers.
     </p></dd><dt id="idm140019140844800"><span class="term ">Providing Block Special Files</span></dt><dd><p>
      For each loaded module, the kernel generates device events.
      <code class="systemitem">udev</code> handles these events and
      generates the required special block files on a RAM file system in
      <code class="filename">/dev</code>. Without those special files, the file system
      and other devices would not be accessible.
     </p></dd><dt id="idm140019140841584"><span class="term ">Managing RAID and LVM Setups</span></dt><dd><p>
      If you configured your system to hold the root file system under RAID or
      LVM, <code class="systemitem">init</code> on <code class="systemitem">initramfs</code>
      sets up LVM or RAID to enable access to the root file system later.
     </p><p>
      To change your <code class="filename">/usr</code> or
      <code class="systemitem">swap</code> partitions directly without the help of
      YaST, further actions are needed. If you forget these steps, your
      system will start in emergency mode. To avoid starting in emergency mode,
      perform the following steps:
     </p><div class="procedure " id="pro.boot.linuxrc.lvm"><div class="procedure-title-wrap"><h6 class="procedure-title"><span class="number">Procedure 9.1: </span><span class="name">Updating Init RAM Disk When Switching to Logical Volumes </span><a title="Permalink" class="permalink" href="#pro.boot.linuxrc.lvm">#</a></h6></div><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
        Edit the corresponding entry in <code class="filename">/etc/fstab</code> and
        replace your previous partitions with the logical volume.
       </p></li><li class="step "><p>
        Execute the following commands:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code><code class="command">mount</code> -a
<code class="prompt root">root # </code><code class="command">swapon</code> -a</pre></div></li><li class="step "><p>
        Regenerate your initial RAM disk (initramfs) with
        <code class="command">mkinitrd</code> or <code class="command">dracut</code>.
       </p></li><li class="step "><p>
        For IBM Z, additionally run <code class="command">grub2-install</code>.
       </p></li></ol></div></div><p>
      Find more information about RAID and LVM in
      <a class="xref" href="#cha.expert_partitioner" title="Chapter 5. Expert Partitioner">Chapter 5, <em>Expert Partitioner</em></a>.
     </p></dd><dt id="ve.net"><span class="term ">Managing Network Configuration</span></dt><dd><p>
      If you configured your system to use a network-mounted root file system
      (mounted via NFS), <code class="systemitem">init</code> on
      <code class="systemitem">initramfs</code> must make sure that the proper network
      drivers are loaded and that they are set up to allow access to the root
      file system.
     </p><p>
      If the file system resides on a network block device like iSCSI or SAN,
      the connection to the storage server is also set up by
      <code class="systemitem">init</code> on <code class="systemitem">initramfs</code>.
      <span class="productname"><span class="phrase">openSUSE Leap</span></span> supports booting from a secondary iSCSI target if the
      primary target is not available. .
     </p></dd></dl></div><p>
   When <code class="systemitem">init</code> on <code class="systemitem">initramfs</code> is
   called during the initial boot as part of the installation process, its
   tasks differ from those mentioned above:
  </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019140818928"><span class="term ">Finding the Installation Medium</span></dt><dd><p>
      When starting the installation process, your machine loads an
      installation kernel and a special <code class="systemitem">init</code>
      containing the YaST installer. The YaST installer is running in a RAM
      file system and needs to have information about the location of the
      installation medium to access it for installing the operating system.
     </p></dd><dt id="idm140019140816352"><span class="term ">
      Initiating Hardware Recognition and Loading Appropriate Kernel Modules
     </span></dt><dd><p>
      As mentioned in <a class="xref" href="#sec.boot.initrd" title="9.2. initramfs">Section 9.2, “<code class="systemitem">initramfs</code>”</a>, the boot process
      starts with a minimum set of drivers that can be used with most hardware
      configurations. <code class="systemitem">init</code> starts an initial hardware
      scanning process that determines the set of drivers suitable for your
      hardware configuration. These drivers are used to generate a custom
      <code class="systemitem">initramfs</code> that is needed to boot the system. If
      the modules are not needed for boot but for coldplug, the modules can be
      loaded with <code class="systemitem">systemd</code>; for more information, see
      <a class="xref" href="#sec.boot.systemd.advanced.kernel_modules" title="10.6.4. Loading Kernel Modules">Section 10.6.4, “Loading Kernel Modules”</a>.

     </p></dd><dt id="idm140019140811296"><span class="term ">Loading the Installation System</span></dt><dd><p>
      When the hardware is properly recognized, the appropriate drivers are
      loaded. The <code class="systemitem">udev</code> program creates
      the special device files and <code class="systemitem">init</code> starts the
      installation system with the YaST installer.
     </p></dd><dt id="idm140019140808160"><span class="term ">Starting YaST</span></dt><dd><p>
      Finally, <code class="systemitem">init</code> starts YaST, which starts
      package installation and system configuration.
     </p></dd></dl></div></div></div><div class="chapter " id="cha.systemd"><div class="titlepage"><div><div><h2 class="title"><span class="number">10 </span><span class="name">The <code class="systemitem">systemd</code> Daemon</span> <a title="Permalink" class="permalink" href="#cha.systemd">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">Filename: </span>systemd.xml</li><li><span class="ds-label">ID: </span>cha.systemd</li></ul></div></div></div></div><div class="line"><div class="toc"><dl><dt><span class="sect1"><a href="#sec.boot.systemd.concept"><span class="number">10.1 </span><span class="name">The systemd Concept</span></a></span></dt><dt><span class="sect1"><a href="#sec.boot.systemd.basics"><span class="number">10.2 </span><span class="name">Basic Usage</span></a></span></dt><dt><span class="sect1"><a href="#sec.boot.systemd.boot"><span class="number">10.3 </span><span class="name">System Start and Target Management</span></a></span></dt><dt><span class="sect1"><a href="#sec.boot.runlevel.edit"><span class="number">10.4 </span><span class="name">Managing Services with YaST</span></a></span></dt><dt><span class="sect1"><a href="#sec.boot.systemd.custom"><span class="number">10.5 </span><span class="name">Customization of <code class="systemitem">systemd</code></span></a></span></dt><dt><span class="sect1"><a href="#sec.boot.systemd.advanced"><span class="number">10.6 </span><span class="name">Advanced Usage</span></a></span></dt><dt><span class="sect1"><a href="#sec.boot.systemd.info"><span class="number">10.7 </span><span class="name">More Information</span></a></span></dt></dl></div></div><p>
  The program <code class="systemitem">systemd</code> is the process with process ID 1. It is responsible for
  initializing the system in the required way. <code class="systemitem">systemd</code> is started directly by
  the kernel and resists signal 9, which normally terminates processes.
  All other programs are either started directly by systemd or by one of its
  child processes.
 </p><p>
  Starting with <span class="productname"><span class="phrase">openSUSE Leap</span></span> 12 systemd is a replacement for the popular
  System V init daemon. <code class="systemitem">systemd</code> is fully compatible with System V init (by
  supporting init scripts). One of the main advantages of systemd is that it
  considerably speeds up boot time by aggressively paralleling service starts.
  Furthermore, systemd only starts a service when it is really needed. Daemons
  are not started unconditionally at boot time, but rather when being required
  for the first time. systemd also supports Kernel Control Groups (cgroups),
  snapshotting and restoring the system state and more. See
  <a class="link" href="http://www.freedesktop.org/wiki/Software/systemd/" target="_blank">http://www.freedesktop.org/wiki/Software/systemd/</a> for
  details.
 </p><div class="sect1 " id="sec.boot.systemd.concept"><div class="titlepage"><div><div><h2 class="title" id="sec.boot.systemd.concept"><span class="number">10.1 </span><span class="name">The systemd Concept</span> <a title="Permalink" class="permalink" href="#sec.boot.systemd.concept">#</a></h2></div></div></div><p>
   This section will go into detail about the concept behind systemd.
  </p><div class="sect2 " id="sec.boot.systemd.whatissystemd"><div class="titlepage"><div><div><h3 class="title" id="sec.boot.systemd.whatissystemd"><span class="number">10.1.1 </span><span class="name">What Is systemd</span> <a title="Permalink" class="permalink" href="#sec.boot.systemd.whatissystemd">#</a></h3></div></div></div><p>
    systemd is a system and session manager for Linux, compatible with System V
    and LSB init scripts. The main features are:
   </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
      provides aggressive parallelization capabilities
     </p></li><li class="listitem "><p>
      uses socket and D-Bus activation for starting services
     </p></li><li class="listitem "><p>
      offers on-demand starting of daemons
     </p></li><li class="listitem "><p>
      keeps track of processes using Linux cgroups
     </p></li><li class="listitem "><p>
      supports snapshotting and restoring of the system state
     </p></li><li class="listitem "><p>
      maintains mount and automount points
     </p></li><li class="listitem "><p>
      implements an elaborate transactional dependency-based service control
      logic
     </p></li></ul></div></div><div class="sect2 " id="sec.boot.systemd.unitfile"><div class="titlepage"><div><div><h3 class="title" id="sec.boot.systemd.unitfile"><span class="number">10.1.2 </span><span class="name">Unit File</span> <a title="Permalink" class="permalink" href="#sec.boot.systemd.unitfile">#</a></h3></div></div></div><p>
    A unit configuration file contains information about a service, a socket, a
    device, a mount point, an automount point, a swap file or partition, a
    start-up target, a watched file system path, a timer controlled and
    supervised by systemd, a temporary system state snapshot, a resource
    management slice or a group of externally created processes. <span class="quote">“<span class="quote">Unit
    file</span>”</span> is a generic term used by systemd for the following:
   </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p><span class="formalpara-title">Service. </span>
       Information about a process (for example running a daemon); file ends
       with .service
      </p></li><li class="listitem "><p><span class="formalpara-title">Targets. </span>
       Used for grouping units and as synchronization points during start-up;
       file ends with .target
      </p></li><li class="listitem "><p><span class="formalpara-title">Sockets. </span>
       Information about an IPC or network socket or a file system FIFO, for
       socket-based activation (like
       <code class="systemitem">inetd</code>); file ends with .socket
      </p></li><li class="listitem "><p><span class="formalpara-title">Path. </span>
       Used to trigger other units (for example running a service when files
       change); file ends with .path
      </p></li><li class="listitem "><p><span class="formalpara-title">Timer. </span>
       Information about a timer controlled, for timer-based activation; file
       ends with .timer
      </p></li><li class="listitem "><p><span class="formalpara-title">Mount point. </span>
       Usually auto-generated by the fstab generator; file ends with .mount
      </p></li><li class="listitem "><p><span class="formalpara-title">Automount point. </span>
       Information about a file system automount point; file ends with
       .automount
      </p></li><li class="listitem "><p><span class="formalpara-title">Swap. </span>
       Information about a swap device or file for memory paging; file ends
       with .swap
      </p></li><li class="listitem "><p><span class="formalpara-title">Device. </span>
       Information about a device unit as exposed in the sysfs/udev(7) device
       tree; file ends with .device
      </p></li><li class="listitem "><p><span class="formalpara-title">Scope / Slice. </span>
       A concept for hierarchically managing resources of a group of processes;
       file ends with .scope/.slice
      </p></li></ul></div><p>
    For more information about systemd.unit see
    <a class="link" href="http://www.freedesktop.org/software/systemd/man/systemd.unit.html" target="_blank">http://www.freedesktop.org/software/systemd/man/systemd.unit.html</a>
   </p></div></div><div class="sect1 " id="sec.boot.systemd.basics"><div class="titlepage"><div><div><h2 class="title" id="sec.boot.systemd.basics"><span class="number">10.2 </span><span class="name">Basic Usage</span> <a title="Permalink" class="permalink" href="#sec.boot.systemd.basics">#</a></h2></div></div></div><p>
   The System V init system uses several commands to handle services—the
   init scripts, <code class="command">insserv</code>, <code class="command">telinit</code> and
   others. systemd makes it easier to manage services, since there is only one
   command to memorize for the majority of service-handling tasks:
   <code class="command">systemctl</code>. It uses the <span class="quote">“<span class="quote">command plus
   subcommand</span>”</span> notation like <code class="command">git</code> or
   <code class="command">zypper</code>:
  </p><div class="verbatim-wrap"><pre class="screen">systemctl <em class="replaceable ">GENERAL OPTIONS</em> <em class="replaceable ">SUBCOMMAND</em> <em class="replaceable ">SUBCOMMAND OPTIONS</em></pre></div><p>
   See <code class="command">man 1 systemctl</code> for a complete manual.
  </p><div id="idm140019140752176" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.png" /><h6>Tip: Terminal Output and Bash Completion</h6><p>
    If the output goes to a terminal (and not to a pipe or a file, for example)
    systemd commands send long output to a pager by default. Use the
    <code class="option">--no-pager</code> option to turn off paging mode.
   </p><p>
    systemd also supports bash-completion, allowing you to enter the first
    letters of a subcommand and then press <span class="keycap">→|</span> to
    automatically complete it. This feature is only available in the
    <code class="systemitem">bash</code> shell and requires the installation of the
    package <code class="systemitem">bash-completion</code>.
   </p></div><div class="sect2 " id="sec.boot.systemd.basics.services"><div class="titlepage"><div><div><h3 class="title" id="sec.boot.systemd.basics.services"><span class="number">10.2.1 </span><span class="name">Managing Services in a Running System</span> <a title="Permalink" class="permalink" href="#sec.boot.systemd.basics.services">#</a></h3></div></div></div><p>
    Subcommands for managing services are the same as for managing a service
    with System V init (<code class="command">start</code>, <code class="command">stop</code>,
    ...). The general syntax for service management commands is as follows:
   </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019140744832"><span class="term ">systemd</span></dt><dd><div class="verbatim-wrap"><pre class="screen">systemctl reload|restart|start|status|stop|<em class="replaceable ">...</em> <em class="replaceable ">MY_SERVICE(S)</em></pre></div></dd><dt id="idm140019140742272"><span class="term ">System V init</span></dt><dd><div class="verbatim-wrap"><pre class="screen">rc<em class="replaceable ">MY_SERVICE(S)</em> reload|restart|start|status|stop|<em class="replaceable ">...</em></pre></div></dd></dl></div><p>
    systemd allows you to manage several services in one go. Instead of
    executing init scripts one after the other as with System V init, execute a
    command like the following:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> systemctl start <em class="replaceable ">MY_1ST_SERVICE</em> <em class="replaceable ">MY_2ND_SERVICE</em></pre></div><p>
    To list all services available on the system:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> systemctl list-unit-files --type=service</pre></div><p>
    The following table lists the most important service management commands
    for systemd and System V init:
   </p><div class="table" id="idm140019140735104"><div class="table-title-wrap"><h6 class="table-title"><span class="number">Table 10.1: </span><span class="name">Service Management Commands </span><a title="Permalink" class="permalink" href="#idm140019140735104">#</a></h6></div><div class="table-contents"><table summary="Service Management Commands" border="1"><colgroup><col class="1" /><col class="2" /><col class="3" /></colgroup><thead><tr><th>
        <p>
         Task
        </p>
       </th><th>
        <p>
         systemd Command
        </p>
       </th><th>
        <p>
         System V init Command
        </p>
       </th></tr></thead><tbody><tr><td>
        <p><span class="formalpara-title">Starting. </span></p>
       </td><td>
<div class="verbatim-wrap"><pre class="screen">start</pre></div>
       </td><td>
<div class="verbatim-wrap"><pre class="screen">start</pre></div>
       </td></tr><tr><td>
        <p><span class="formalpara-title">Stopping. </span></p>
       </td><td>
<div class="verbatim-wrap"><pre class="screen">stop</pre></div>
       </td><td>
<div class="verbatim-wrap"><pre class="screen">stop</pre></div>
       </td></tr><tr><td>
        <p><span class="formalpara-title">Restarting. </span>
          Shuts down services and starts them afterward. If a service is not
          yet running it will be started.
         </p>
       </td><td>
<div class="verbatim-wrap"><pre class="screen">restart</pre></div>
       </td><td>
<div class="verbatim-wrap"><pre class="screen">restart</pre></div>
       </td></tr><tr><td>
        <p><span class="formalpara-title">Restarting conditionally. </span>
          Restarts services if they are currently running. Does nothing for
          services that are not running.
         </p>
       </td><td>
<div class="verbatim-wrap"><pre class="screen">try-restart</pre></div>
       </td><td>
<div class="verbatim-wrap"><pre class="screen">try-restart</pre></div>
       </td></tr><tr><td>
        <p><span class="formalpara-title">Reloading. </span>
          Tells services to reload their configuration files without
          interrupting operation. Use case: Tell Apache to reload a modified
          <code class="filename">httpd.conf</code> configuration file. Note that not all
          services support reloading.
         </p>
       </td><td>
<div class="verbatim-wrap"><pre class="screen">reload</pre></div>
       </td><td>
<div class="verbatim-wrap"><pre class="screen">reload</pre></div>
       </td></tr><tr><td>
        <p><span class="formalpara-title">Reloading or restarting. </span>
          Reloads services if reloading is supported, otherwise restarts them.
          If a service is not yet running it will be started.
         </p>
       </td><td>
<div class="verbatim-wrap"><pre class="screen">reload-or-restart</pre></div>
       </td><td>
<div class="verbatim-wrap"><pre class="screen">n/a</pre></div>
       </td></tr><tr><td>
        <p><span class="formalpara-title">Reloading or restarting conditionally. </span>
          Reloads services if reloading is supported, otherwise restarts them
          if currently running. Does nothing for services that are not running.
         </p>
       </td><td>
<div class="verbatim-wrap"><pre class="screen">reload-or-try-restart</pre></div>
       </td><td>
<div class="verbatim-wrap"><pre class="screen">n/a</pre></div>
       </td></tr><tr><td>
        <p><span class="formalpara-title">Getting detailed status information. </span>
          Lists information about the status of services. The <code class="systemitem">systemd</code> command
          shows details such as description, executable, status, cgroup, and
          messages last issued by a service (see
          <a class="xref" href="#sec.boot.systemd.basics.services_debugging" title="10.6.8. Debugging Services">Section 10.6.8, “Debugging Services”</a>). The
          level of details displayed with the System V init differs from
          service to service.
         </p>
       </td><td>
<div class="verbatim-wrap"><pre class="screen">status</pre></div>
       </td><td>
<div class="verbatim-wrap"><pre class="screen">status</pre></div>
       </td></tr><tr><td>
        <p><span class="formalpara-title">Getting short status information. </span>
          Shows whether services are active or not.
         </p>
       </td><td>
<div class="verbatim-wrap"><pre class="screen">is-active</pre></div>
       </td><td>
<div class="verbatim-wrap"><pre class="screen">status</pre></div>
       </td></tr></tbody></table></div></div></div><div class="sect2 " id="sec.boot.systemd.basics.services_enabling"><div class="titlepage"><div><div><h3 class="title" id="sec.boot.systemd.basics.services_enabling"><span class="number">10.2.2 </span><span class="name">Permanently Enabling/Disabling Services</span> <a title="Permalink" class="permalink" href="#sec.boot.systemd.basics.services_enabling">#</a></h3></div></div></div><p>
    The service management commands mentioned in the previous section let you
    manipulate services for the current session. systemd also lets you
    permanently enable or disable services, so they are automatically started
    when requested or are always unavailable. You can either do this by using
    YaST, or on the command line.
   </p><div class="sect3 " id="sec.boot.systemd.basics.services_enabling.cmd"><div class="titlepage"><div><div><h4 class="title" id="sec.boot.systemd.basics.services_enabling.cmd"><span class="number">10.2.2.1 </span><span class="name">Enabling/Disabling Services on the Command Line</span> <a title="Permalink" class="permalink" href="#sec.boot.systemd.basics.services_enabling.cmd">#</a></h4></div></div></div><p>
     The following table lists enabling and disabling commands for systemd and
     System V init:
    </p><div id="idm140019140674832" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.png" /><h6>Important: Service Start</h6><p>
      When enabling a service on the command line, it is not started
      automatically. It is scheduled to be started with the next system
      start-up or runlevel/target change. To immediately start a service after
      having enabled it, explicitly run <code class="command">systemctl start
      <em class="replaceable ">MY_SERVICE</em></code> or <code class="command">rc
      <em class="replaceable ">MY_SERVICE</em> start</code>.
     </p></div><div class="table" id="idm140019140671616"><div class="table-title-wrap"><h6 class="table-title"><span class="number">Table 10.2: </span><span class="name">Commands for Enabling and Disabling Services </span><a title="Permalink" class="permalink" href="#idm140019140671616">#</a></h6></div><div class="table-contents"><table summary="Commands for Enabling and Disabling Services" border="1"><colgroup><col class="1" /><col class="2" /><col class="3" /></colgroup><thead><tr><th>
         <p>
          Task
         </p>
        </th><th>
         <p>
          <code class="systemitem">systemd</code> Command
         </p>
        </th><th>
         <p>
          System V init Command
         </p>
        </th></tr></thead><tbody><tr><td>
         <p><span class="formalpara-title">Enabling. </span></p>
        </td><td>
         <p>
          <code class="command">systemctl enable
          <em class="replaceable ">MY_SERVICE(S)</em></code>
         </p>
        </td><td>
         <p>
          <code class="command">insserv <em class="replaceable ">MY_SERVICE(S)</em></code>,
          <code class="command">chkconfig -a
          <em class="replaceable ">MY_SERVICE(S)</em></code>
         </p>
        </td></tr><tr><td>
         <p><span class="formalpara-title">Disabling. </span></p>
        </td><td>
         <p>
          <code class="command">systemctl disable
          <em class="replaceable ">MY_SERVICE(S)</em>.service</code>
         </p>
        </td><td>
         <p>
          <code class="command">insserv -r
          <em class="replaceable ">MY_SERVICE(S)</em></code>,
          <code class="command">chkconfig -d
          <em class="replaceable ">MY_SERVICE(S)</em></code>
         </p>
        </td></tr><tr><td>
         <p><span class="formalpara-title">Checking. </span>
           Shows whether a service is enabled or not.
          </p>
        </td><td>
         <p>
          <code class="command">systemctl is-enabled
          <em class="replaceable ">MY_SERVICE</em></code>
         </p>
        </td><td>
         <p>
          <code class="command">chkconfig <em class="replaceable ">MY_SERVICE</em></code>
         </p>
        </td></tr><tr><td>
         <p><span class="formalpara-title">Re-enabling. </span>
           Similar to restarting a service, this command first disables and
           then enables a service. Useful to re-enable a service with its
           defaults.
          </p>
        </td><td>
         <p>
          <code class="command">systemctl reenable
          <em class="replaceable ">MY_SERVICE</em></code>
         </p>
        </td><td>
         <p>
          n/a
         </p>
        </td></tr><tr><td>
         <p><span class="formalpara-title">Masking. </span>
           After <span class="quote">“<span class="quote">disabling</span>”</span> a service, it can still be started
           manually. To completely disable a service, you need to mask it. Use
           with care.
          </p>
        </td><td>
         <p>
          <code class="command">systemctl mask
          <em class="replaceable ">MY_SERVICE</em></code>
         </p>
        </td><td>
         <p>
          n/a
         </p>
        </td></tr><tr><td>
         <p><span class="formalpara-title">Unmasking. </span>
           A service that has been masked can only be used again after it has
           been unmasked.
          </p>
        </td><td>
         <p>
          <code class="command">systemctl unmask
          <em class="replaceable ">MY_SERVICE</em></code>
         </p>
        </td><td>
         <p>
          n/a
         </p>
        </td></tr></tbody></table></div></div></div></div></div><div class="sect1 " id="sec.boot.systemd.boot"><div class="titlepage"><div><div><h2 class="title" id="sec.boot.systemd.boot"><span class="number">10.3 </span><span class="name">System Start and Target Management</span> <a title="Permalink" class="permalink" href="#sec.boot.systemd.boot">#</a></h2></div></div></div><p>
   The entire process of starting the system and shutting it down is maintained
   by systemd. From this point of view, the kernel can be considered a
   background process to maintain all other processes and adjust CPU time and
   hardware access according to requests from other programs.
  </p><div class="sect2 " id="sec.boot.systemd.targets"><div class="titlepage"><div><div><h3 class="title" id="sec.boot.systemd.targets"><span class="number">10.3.1 </span><span class="name">Targets Compared to Runlevels</span> <a title="Permalink" class="permalink" href="#sec.boot.systemd.targets">#</a></h3></div></div></div><p>
    With System V init the system was booted into a so-called
    <span class="quote">“<span class="quote">Runlevel</span>”</span>. A runlevel defines how the system is started and
    what services are available in the running system. Runlevels are numbered;
    the most commonly known ones are <code class="literal">0</code> (shutting down the
    system), <code class="literal">3</code> (multiuser with network) and
    <code class="literal">5</code> (multiuser with network and display manager).
   </p><p>
    systemd introduces a new concept by using so-called <span class="quote">“<span class="quote">target
    units</span>”</span>. However, it remains fully compatible with the runlevel
    concept. Target units are named rather than numbered and serve specific
    purposes. For example, the targets <code class="systemitem">local-fs.target</code>
    and <code class="systemitem">swap.target</code> mount local file systems and swap
    spaces.
   </p><p>
    The target <code class="systemitem">graphical.target</code> provides a multiuser
    system with network and display manager capabilities and is equivalent to
    runlevel 5. Complex targets, such as
    <code class="systemitem">graphical.target</code> act as <span class="quote">“<span class="quote">meta</span>”</span>
    targets by combining a subset of other targets. Since systemd makes it easy
    to create custom targets by combining existing targets, it offers great
    flexibility.
   </p><p>
    The following list shows the most important systemd target units. For a
    full list refer to <code class="command">man 7 systemd.special</code>.
   </p><div class="variablelist "><div class="variablelist-title-wrap"><h6 class="variablelist-title"><span class="name">Selected systemd Target Units </span><a title="Permalink" class="permalink" href="#idm140019140611536">#</a></h6></div><dl class="variablelist"><dt id="idm140019140610784"><span class="term "><code class="systemitem">default.target</code>
     </span></dt><dd><p>
       The target that is booted by default. Not a <span class="quote">“<span class="quote">real</span>”</span> target,
       but rather a symbolic link to another target like
       <code class="systemitem">graphic.target</code>. Can be permanently changed via
       YaST (see <a class="xref" href="#sec.boot.runlevel.edit" title="10.4. Managing Services with YaST">Section 10.4, “Managing Services with YaST”</a>). To change it for
       a session, use the kernel parameter
       <code class="literal">systemd.unit=<em class="replaceable ">MY_TARGET.target</em></code>
       at the boot prompt.
      </p></dd><dt id="idm140019140606320"><span class="term "><code class="systemitem">emergency.target</code>
     </span></dt><dd><p>
       Starts an emergency shell on the console. Only use it at the boot prompt
       as <code class="literal">systemd.unit=emergency.target</code>.
      </p></dd><dt id="idm140019140603696"><span class="term "><code class="systemitem">graphical.target</code>
     </span></dt><dd><p>
       Starts a system with network, multiuser support and a display manager.
      </p></dd><dt id="idm140019140601552"><span class="term "><code class="systemitem">halt.target</code>
     </span></dt><dd><p>
       Shuts down the system.
      </p></dd><dt id="idm140019140599456"><span class="term "><code class="systemitem">mail-transfer-agent.target</code>
     </span></dt><dd><p>
       Starts all services necessary for sending and receiving mails.
      </p></dd><dt id="idm140019140597296"><span class="term "><code class="systemitem">multi-user.target</code>
     </span></dt><dd><p>
       Starts a multiuser system with network.
      </p></dd><dt id="idm140019140595184"><span class="term "><code class="systemitem">reboot.target</code>
     </span></dt><dd><p>
       Reboots the system.
      </p></dd><dt id="idm140019140593088"><span class="term "><code class="systemitem">rescue.target</code>
     </span></dt><dd><p>
       Starts a single-user system without network.
      </p></dd></dl></div><p>
    To remain compatible with the System V init runlevel system, systemd
    provides special targets named
    <code class="literal">runlevel<em class="replaceable ">X</em>.target</code> mapping the
    corresponding runlevels numbered <em class="replaceable ">X</em>.
   </p><p>
    If you want to know the current target, use the command: <code class="command">systemctl
    get-default</code>
   </p><div class="table" id="idm140019140587920"><div class="table-title-wrap"><h6 class="table-title"><span class="number">Table 10.3: </span><span class="name">System V Runlevels and <code class="systemitem">systemd</code> Target Units </span><a title="Permalink" class="permalink" href="#idm140019140587920">#</a></h6></div><div class="table-contents"><table summary="System V Runlevels and systemd Target Units" border="1"><colgroup><col class="1" /><col class="2" /><col class="3" /></colgroup><thead><tr><th>
        <p>
         System V runlevel
        </p>
       </th><th>
        <p>
         <code class="systemitem">systemd</code> target
        </p>
       </th><th>
        <p>
         Purpose
        </p>
       </th></tr></thead><tbody><tr><td>
        <p>
         0
        </p>
       </td><td>
        <p>
         <code class="systemitem">runlevel0.target</code>,
         <code class="systemitem">halt.target</code>,
         <code class="systemitem">poweroff.target</code>
        </p>
       </td><td>
        <p>
         System shutdown
        </p>
       </td></tr><tr><td>
        <p>
         1, S
        </p>
       </td><td>
        <p>
         <code class="systemitem">runlevel1.target</code>,
         <code class="systemitem">rescue.target</code>,
        </p>
       </td><td>
        <p>
         Single-user mode
        </p>
       </td></tr><tr><td>
        <p>
         2
        </p>
       </td><td>
        <p>
         <code class="systemitem">runlevel2.target</code>,
         <code class="systemitem">multi-user.target</code>,
        </p>
       </td><td>
        <p>
         Local multiuser without remote network
        </p>
       </td></tr><tr><td>
        <p>
         3
        </p>
       </td><td>
        <p>
         <code class="systemitem">runlevel3.target</code>,
         <code class="systemitem">multi-user.target</code>,
        </p>
       </td><td>
        <p>
         Full multiuser with network
        </p>
       </td></tr><tr><td>
        <p>
         4
        </p>
       </td><td>
        <p>
         <code class="systemitem">runlevel4.target</code>
        </p>
       </td><td>
        <p>
         Unused/User-defined
        </p>
       </td></tr><tr><td>
        <p>
         5
        </p>
       </td><td>
        <p>
         <code class="systemitem">runlevel5.target</code>,
         <code class="systemitem">graphical.target</code>,
        </p>
       </td><td>
        <p>
         Full multiuser with network and display manager
        </p>
       </td></tr><tr><td>
        <p>
         6
        </p>
       </td><td>
        <p>
         <code class="systemitem">runlevel6.target</code>,
         <code class="systemitem">reboot.target</code>,
        </p>
       </td><td>
        <p>
         System reboot
        </p>
       </td></tr></tbody></table></div></div><div id="idm140019140548800" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.png" /><h6>Important: systemd Ignores <code class="filename">/etc/inittab</code></h6><p>
     The runlevels in a System V init system are configured in
     <code class="filename">/etc/inittab</code>. systemd does <span class="emphasis"><em>not</em></span>
     use this configuration. Refer to
     <a class="xref" href="#sec.boot.systemd.custom.targets" title="10.5.3. Creating Custom Targets">Section 10.5.3, “Creating Custom Targets”</a> for instructions on how
     to create your own bootable target.
    </p></div><div class="sect3 " id="sec.boot.systemd.targets.commands"><div class="titlepage"><div><div><h4 class="title" id="sec.boot.systemd.targets.commands"><span class="number">10.3.1.1 </span><span class="name">Commands to Change Targets</span> <a title="Permalink" class="permalink" href="#sec.boot.systemd.targets.commands">#</a></h4></div></div></div><p>
     Use the following commands to operate with target units:
    </p><div class="informaltable"><table border="1"><colgroup><col class="1" /><col class="2" /><col class="3" /></colgroup><thead><tr><th>
         <p>
          Task
         </p>
        </th><th>
         <p>
          systemd Command
         </p>
        </th><th>
         <p>
          System V init Command
         </p>
        </th></tr></thead><tbody><tr><td>
         <p>
          Change the current target/runlevel
         </p>
        </td><td>
         <p>
          <code class="command">systemctl isolate</code>
          <em class="replaceable ">MY_TARGET</em>.target
         </p>
        </td><td>
         <p>
          <code class="command">telinit</code> <em class="replaceable ">X</em>
         </p>
        </td></tr><tr><td>
         <p>
          Change to the default target/runlevel
         </p>
        </td><td>
         <p>
          <code class="command">systemctl default</code>
         </p>
        </td><td>
         <p>
          n/a
         </p>
        </td></tr><tr><td>
         <p>
          Get the current target/runlevel
         </p>
        </td><td>
         <p>
          <code class="command">systemctl list-units --type=target</code>
         </p>
         <p>
          With systemd there is usually more than one active target. The
          command lists all currently active targets.
         </p>
        </td><td>
         <p>
          <code class="command">who -r</code>
         </p>
         <p>
          or
         </p>
         <p>
          <code class="command">runlevel</code>
         </p>
        </td></tr><tr><td>
         <p>
          persistently change the default runlevel
         </p>
        </td><td>
         <p>
          Use the Services Manager or run the following command:
         </p>
         <p>
          <code class="command">ln -sf /usr/lib/systemd/system/</code>
          <em class="replaceable ">MY_TARGET</em>.target
          /etc/systemd/system/default.target
         </p>
        </td><td>
         <p>
          Use the Services Manager or change the line
         </p>
         <p>
          <code class="command">id:</code> <em class="replaceable ">X</em>:initdefault:
         </p>
         <p>
          in <code class="filename">/etc/inittab</code>
         </p>
        </td></tr><tr><td>
         <p>
          Change the default runlevel for the current boot process
         </p>
        </td><td>
         <p>
          Enter the following option at the boot prompt
         </p>
         <p>
          <code class="command">systemd.unit=</code>
          <em class="replaceable ">MY_TARGET</em>.target
         </p>
        </td><td>
         <p>
          Enter the desired runlevel number at the boot prompt.
         </p>
        </td></tr><tr><td>
         <p>
          Show a target's/runlevel's dependencies
         </p>
        </td><td>
         <p>
          <code class="command">systemctl show -p "Requires"</code>
          <em class="replaceable ">MY_TARGET</em>.target
         </p>
         <p>
          <code class="command">systemctl show -p "Wants"</code>
          <em class="replaceable ">MY_TARGET</em>.target
         </p>
         <p>
          <span class="quote">“<span class="quote">Requires</span>”</span> lists the hard dependencies (the ones that
          must be resolved), whereas <span class="quote">“<span class="quote">Wants</span>”</span> lists the soft
          dependencies (the ones that get resolved if possible).
         </p>
        </td><td>
         <p>
          n/a
         </p>
        </td></tr></tbody></table></div></div></div><div class="sect2 " id="sec.boot.systemd.debug"><div class="titlepage"><div><div><h3 class="title" id="sec.boot.systemd.debug"><span class="number">10.3.2 </span><span class="name">Debugging System Start-Up</span> <a title="Permalink" class="permalink" href="#sec.boot.systemd.debug">#</a></h3></div></div></div><p>
    systemd offers the means to analyze the system start-up process. You can
    review the list of all services and their status (rather than having to
    parse <code class="filename">/varlog/</code>). systemd also allows you to scan the
    start-up procedure to find out how much time each service start-up
    consumes.
   </p><div class="sect3 " id="sec.boot.systemd.debug.review"><div class="titlepage"><div><div><h4 class="title" id="sec.boot.systemd.debug.review"><span class="number">10.3.2.1 </span><span class="name">Review Start-Up of Services</span> <a title="Permalink" class="permalink" href="#sec.boot.systemd.debug.review">#</a></h4></div></div></div><p>
     To review the complete list of services that have been started since
     booting the system, enter the command <code class="command">systemctl</code>. It
     lists all active services like shown below (shortened). To get more
     information on a specific service, use <code class="command">systemctl status
     <em class="replaceable ">MY_SERVICE</em></code>.
    </p><div class="example" id="idm140019140490480"><div class="example-title-wrap"><h6 class="example-title"><span class="number">Example 10.1: </span><span class="name">List Active Services </span><a title="Permalink" class="permalink" href="#idm140019140490480">#</a></h6></div><div class="example-contents"><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>systemctl
UNIT                        LOAD   ACTIVE SUB       JOB DESCRIPTION
[...]
iscsi.service               loaded active exited    Login and scanning of iSC+
kmod-static-nodes.service   loaded active exited    Create list of required s+
libvirtd.service            loaded active running   Virtualization daemon
nscd.service                loaded active running   Name Service Cache Daemon
chronyd.service             loaded active running   NTP Server Daemon
polkit.service              loaded active running   Authorization Manager
postfix.service             loaded active running   Postfix Mail Transport Ag+
rc-local.service            loaded active exited    /etc/init.d/boot.local Co+
rsyslog.service             loaded active running   System Logging Service
[...]
LOAD   = Reflects whether the unit definition was properly loaded.
ACTIVE = The high-level unit activation state, i.e. generalization of SUB.
SUB    = The low-level unit activation state, values depend on unit type.

161 loaded units listed. Pass --all to see loaded but inactive units, too.
To show all installed unit files use 'systemctl list-unit-files'.</pre></div></div></div><p>
     To restrict the output to services that failed to start, use the
     <code class="option">--failed</code> option:
    </p><div class="example" id="idm140019140486496"><div class="example-title-wrap"><h6 class="example-title"><span class="number">Example 10.2: </span><span class="name">List Failed Services </span><a title="Permalink" class="permalink" href="#idm140019140486496">#</a></h6></div><div class="example-contents"><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>systemctl --failed
UNIT                   LOAD   ACTIVE SUB    JOB DESCRIPTION
apache2.service        loaded failed failed     apache
NetworkManager.service loaded failed failed     Network Manager
plymouth-start.service loaded failed failed     Show Plymouth Boot Screen

[...]</pre></div></div></div></div><div class="sect3 " id="sec.boot.systemd.debug.time"><div class="titlepage"><div><div><h4 class="title" id="sec.boot.systemd.debug.time"><span class="number">10.3.2.2 </span><span class="name">Debug Start-Up Time</span> <a title="Permalink" class="permalink" href="#sec.boot.systemd.debug.time">#</a></h4></div></div></div><p>
     To debug system start-up time, systemd offers the
     <code class="command">systemd-analyze</code> command. It shows the total start-up
     time, a list of services ordered by start-up time and can also generate an
     SVG graphic showing the time services took to start in relation to the
     other services.
    </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019140481488"><span class="term ">Listing the System Start-Up Time</span></dt><dd><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>systemd-analyze
Startup finished in 2666ms (kernel) + 21961ms (userspace) = 24628ms</pre></div></dd><dt id="idm140019140479104"><span class="term ">Listing the Services Start-Up Time</span></dt><dd><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>systemd-analyze blame
  6472ms systemd-modules-load.service
  5833ms remount-rootfs.service
  4597ms network.service
  4254ms systemd-vconsole-setup.service
  4096ms postfix.service
  2998ms xdm.service
  2483ms localnet.service
  2470ms SuSEfirewall2_init.service
  2189ms avahi-daemon.service
  2120ms systemd-logind.service
  1080ms chronyd.service
[...]
    75ms fbset.service
    72ms purge-kernels.service
    47ms dev-vda1.swap
    38ms bluez-coldplug.service
    35ms splash_early.service</pre></div></dd><dt id="idm140019140476256"><span class="term ">Services Start-Up Time Graphics</span></dt><dd><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>systemd-analyze plot &gt; jupiter.example.com-startup.svg</pre></div><div class="informalfigure"><div class="mediaobject"><a xmlns="" href="images/systemd_startup.png"><img src="images/systemd_startup.png" width="" /></a></div></div></dd></dl></div></div><div class="sect3 " id="sec.boot.systemd.debug.complete"><div class="titlepage"><div><div><h4 class="title" id="sec.boot.systemd.debug.complete"><span class="number">10.3.2.3 </span><span class="name">Review the Complete Start-Up Process</span> <a title="Permalink" class="permalink" href="#sec.boot.systemd.debug.complete">#</a></h4></div></div></div><p>
     The above-mentioned commands let you review the services that started and
     the time it took to start them. If you need to know more details, you can
     tell <code class="systemitem">systemd</code> to verbosely log the complete start-up procedure by
     entering the following parameters at the boot prompt:
    </p><div class="verbatim-wrap"><pre class="screen">systemd.log_level=debug systemd.log_target=kmsg</pre></div><p>
     Now <code class="systemitem">systemd</code> writes its log messages into the kernel ring buffer. View
     that buffer with <code class="command">dmesg</code>:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>dmesg -T | less</pre></div></div></div><div class="sect2 " id="sec.boot.systemd.sysv_compatibility"><div class="titlepage"><div><div><h3 class="title" id="sec.boot.systemd.sysv_compatibility"><span class="number">10.3.3 </span><span class="name">System V Compatibility</span> <a title="Permalink" class="permalink" href="#sec.boot.systemd.sysv_compatibility">#</a></h3></div></div></div><p>
    systemd is compatible with System V, allowing you to still use existing
    System V init scripts. However, there is at least one known issue where a
    System V init script does not work with systemd out of the box: starting a
    service as a different user via <code class="command">su</code> or
    <code class="command">sudo</code> in init scripts will result in a failure of the
    script, producing an <span class="quote">“<span class="quote">Access denied</span>”</span> error.
   </p><p>
    When changing the user with <code class="command">su</code> or
    <code class="command">sudo</code>, a PAM session is started. This session will be
    terminated after the init script is finished. As a consequence, the service
    that has been started by the init script will also be terminated. To work
    around this error, proceed as follows:
   </p><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
      Create a service file wrapper with the same name as the init script plus
      the file name extension <code class="filename">.service</code>:
     </p><div class="verbatim-wrap"><pre class="screen">[Unit]
Description=<em class="replaceable ">DESCRIPTION</em>
After=network.target

[Service]
User=<em class="replaceable ">USER</em>
Type=forking<span id="co.service_wrapper.type"></span><span class="callout">1</span>
PIDFile=<em class="replaceable ">PATH TO PID FILE</em><a class="xref" href="#co.service_wrapper.type"><span class="callout">1</span></a>
ExecStart=<em class="replaceable ">PATH TO INIT SCRIPT</em> start
ExecStop=<em class="replaceable ">PATH TO INIT SCRIPT</em> stop
ExecStopPost=/usr/bin/rm -f <em class="replaceable ">PATH TO PID FILE</em><a class="xref" href="#co.service_wrapper.type"><span class="callout">1</span></a>

[Install]
WantedBy=multi-user.target<span id="co.service_wrapper.target"></span><span class="callout">2</span></pre></div><p>
      Replace all values written in <em class="replaceable ">UPPERCASE
      LETTERS</em> with appropriate values.
     </p><div class="calloutlist "><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#co.service_wrapper.type"><span class="callout">1</span></a> </p></td><td valign="top" align="left"><p>
        Optional—only use if the init script starts a daemon.
       </p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#co.service_wrapper.target"><span class="callout">2</span></a> </p></td><td valign="top" align="left"><p>
        <code class="literal">multi-user.target</code> also starts the init script when
        booting into <code class="literal">graphical.target</code>. If it should only be
        started when booting into the display manager, user
        <code class="literal">graphical.target</code> here.
       </p></td></tr></table></div></li><li class="step "><p>
      Start the daemon with <code class="command">systemctl start
      <em class="replaceable ">APPLICATION</em></code>.
     </p></li></ol></div></div></div></div><div class="sect1 " id="sec.boot.runlevel.edit"><div class="titlepage"><div><div><h2 class="title" id="sec.boot.runlevel.edit"><span class="number">10.4 </span><span class="name">Managing Services with YaST</span> <a title="Permalink" class="permalink" href="#sec.boot.runlevel.edit">#</a></h2></div></div></div><p>
   Basic service management can also be done with the YaST Services Manager
   module. It supports starting, stopping, enabling and disabling services. It
   also lets you show a service's status and change the default target. Start
   the YaST module with <span class="guimenu">YaST</span> › <span class="guimenu">System</span> › <span class="guimenu">Services Manager</span>.
  </p><div class="figure" id="fig.yast2.runlevel"><div class="figure-contents"><div class="mediaobject"><a xmlns="" href="images/yast2_runlevel.png"><img src="images/yast2_runlevel.png" width="" alt="Services Manager" /></a></div></div><div class="figure-title-wrap"><h6 class="figure-title"><span class="number">Figure 10.1: </span><span class="name">Services Manager </span><a title="Permalink" class="permalink" href="#fig.yast2.runlevel">#</a></h6></div></div><div class="variablelist "><dl class="variablelist"><dt id="idm140019140433968"><span class="term ">Changing the <span class="guimenu">Default System Target</span>
    </span></dt><dd><p>
      To change the target the system boots into, choose a target from the
      <span class="guimenu">Default System Target</span> drop-down box. The most often
      used targets are <span class="guimenu">Graphical Interface</span> (starting a
      graphical login screen) and <span class="guimenu">Multi-User</span> (starting the
      system in command line mode).
     </p></dd><dt id="idm140019140430208"><span class="term ">Starting or Stopping a Service</span></dt><dd><p>
      Select a service from the table. The <span class="guimenu">Active</span> column
      shows whether it is currently running (<span class="guimenu">Active</span>) or not
      (<span class="guimenu">Inactive</span>). Toggle its status by choosing
      <span class="guimenu">Start/Stop</span>.
     </p><p>
      Starting or stopping a service changes its status for the currently
      running session. To change its status throughout a reboot, you need to
      enable or disable it.
     </p></dd><dt id="idm140019140425904"><span class="term ">Enabling or Disabling a Service</span></dt><dd><p>
      Select a service from the table. The <span class="guimenu">Enabled</span> column
      shows whether it is currently <span class="guimenu">Enabled</span> or
      <span class="guimenu">Disabled</span>. Toggle its status by choosing
      <span class="guimenu">Enable/Disable</span>.
     </p><p>
      By enabling or disabling a service you configure whether it is started
      during booting (<span class="guimenu">Enabled</span>) or not
      (<span class="guimenu">Disabled</span>). This setting will not affect the current
      session. To change its status in the current session, you need to start
      or stop it.
     </p></dd><dt id="idm140019140420672"><span class="term ">View a Status Messages</span></dt><dd><p>
      To view the status message of a service, select it from the list and
      choose <span class="guimenu">Show Details</span>. The output you will see is
      identical to the one generated by the command
      <code class="command">systemctl</code> <code class="option">-l</code> status
      <em class="replaceable ">MY_SERVICE</em>.
     </p></dd></dl></div><div id="idm140019140416784" class="admonition warning normal"><img class="symbol" alt="Warning" title="Warning" src="static/images/icon-warning.png" /><h6>Warning: Faulty Runlevel Settings May Damage Your System</h6><p>
    Faulty runlevel settings may make your system unusable. Before applying
    your changes, make absolutely sure that you know their consequences.
   </p></div></div><div class="sect1 " id="sec.boot.systemd.custom"><div class="titlepage"><div><div><h2 class="title" id="sec.boot.systemd.custom"><span class="number">10.5 </span><span class="name">Customization of <code class="systemitem">systemd</code></span> <a title="Permalink" class="permalink" href="#sec.boot.systemd.custom">#</a></h2></div></div></div><p>
   The following sections contain some examples for
   <code class="systemitem">systemd</code> customization.
  </p><div id="idm140019140412704" class="admonition warning normal"><img class="symbol" alt="Warning" title="Warning" src="static/images/icon-warning.png" /><h6>Warning: Avoiding Overwritten Customization</h6><p>
    Always do systemd customization in <code class="filename">/etc/systemd/</code>,
    <span class="emphasis"><em>never</em></span> in <code class="filename">/usr/lib/systemd/</code>.
    Otherwise your changes will be overwritten by the next update of systemd.
   </p></div><div class="sect2 " id="sec.boot.systemd.custom.service"><div class="titlepage"><div><div><h3 class="title" id="sec.boot.systemd.custom.service"><span class="number">10.5.1 </span><span class="name">Customizing Unit Files</span> <a title="Permalink" class="permalink" href="#sec.boot.systemd.custom.service">#</a></h3></div></div></div><p>
    The systemd unit files are located in
    <code class="filename">/usr/lib/systemd/system</code>. If you want to customize
    them, proceed as follows:
   </p><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
      Copy the files you want to modify from
      <code class="filename">/usr/lib/systemd/system</code> to
      <code class="filename">/etc/systemd/system</code>. Keep the file names identical
      to the original ones.
     </p></li><li class="step "><p>
      Modify the copies in <code class="filename">/etc/systemd/system</code> according
      to your needs.
     </p></li><li class="step "><p>
      For an overview of your configuration changes, use the
      <code class="command">systemd-delta</code> command. It can compare and identify
      configuration files that override other configuration files. For details,
      refer to the <code class="command">systemd-delta</code> man page.
     </p></li></ol></div></div><p>
    The modified files in <code class="filename">/etc/systemd</code> will take
    precedence over the original files in
    <code class="filename">/usr/lib/systemd/system</code>, provided that their file name
    is the same.
   </p><div class="sect3 " id="systemd.xinetd_conversion"><div class="titlepage"><div><div><h4 class="title" id="systemd.xinetd_conversion"><span class="number">10.5.1.1 </span><span class="name">Converting <code class="systemitem">xinetd</code> Services to <code class="systemitem">systemd</code></span> <a title="Permalink" class="permalink" href="#systemd.xinetd_conversion">#</a></h4></div></div></div><p>
     Since the release of <span class="productname"><span class="phrase">openSUSE Leap</span></span> 15, the <code class="systemitem">xinetd</code>
     infrastructure has been removed. This section outlines how to convert
     existing custom <code class="systemitem">xinetd</code> service files to <code class="systemitem">systemd</code>
     sockets.
    </p><p>
     For each <code class="systemitem">xinetd</code> service file, you need at least
     two <code class="systemitem">systemd</code> unit files: the socket file (<code class="filename">*.socket</code>)
     and an associated service file (<code class="filename">*.service</code>). The
     socket file tells <code class="systemitem">systemd</code> which socket to create, and the service file
     tells what executable to start.
    </p><p>
     Consider the following example <code class="systemitem">xinetd</code> service
     file:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>cat /etc/xinetd.d/example
service example
{
  socket_type = stream
  protocol = tcp
  port = 10085
  wait = no
  user = user
  group = users
  groups = yes
  server = /usr/libexec/example/exampled
  server_args = -auth=bsdtcp exampledump
  disable = no
}</pre></div><p>
     To convert it to <code class="systemitem">systemd</code>, you need the following two matching files:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>cat /usr/lib/systemd/system/example.socket
[Socket]
ListenStream=0.0.0.0:10085
Accept=false

[Install]
WantedBy=sockets.target</pre></div><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>cat /usr/lib/systemd/system/example.service
[Unit]
Description=example

[Service]
ExecStart=/usr/libexec/example/exampled -auth=bsdtcp exampledump
User=user
Group=users
StandardInput=socket</pre></div><p>
     For a complete list of the <code class="systemitem">systemd</code> 'socket' and 'service' file options,
     refer to systemd.socket and systemd.service manual pages (<code class="command">man 5
     systemd.socket</code>, <code class="command">man 5 systemd.service</code>).
    </p></div></div><div class="sect2 " id="sec.boot.systemd.custom.drop-in"><div class="titlepage"><div><div><h3 class="title" id="sec.boot.systemd.custom.drop-in"><span class="number">10.5.2 </span><span class="name">Creating <span class="quote">“<span class="quote">Drop-in</span>”</span> Files</span> <a title="Permalink" class="permalink" href="#sec.boot.systemd.custom.drop-in">#</a></h3></div></div></div><p>
    If you only want to add a few lines to a configuration file or modify a
    small part of it, you can use so-called <span class="quote">“<span class="quote">drop-in</span>”</span> files.
    Drop-in files let you extend the configuration of unit files without having
    to edit or override the unit files themselves.
   </p><p>
    For example, to change one value for the <em class="replaceable ">FOOBAR</em>
    service located in
    <code class="filename">/usr/lib/systemd/system/<em class="replaceable ">FOOBAR.SERVICE</em></code>,
    proceed as follows:
   </p><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
      Create a directory called
      <code class="filename">/etc/systemd/system/<em class="replaceable ">MY_SERVICE</em>.service.d/</code>.
     </p><p>
      Note the <code class="literal">.d</code> suffix. The directory must otherwise be
      named like the service that you want to patch with the drop-in file.
     </p></li><li class="step "><p>
      In that directory, create a file
      <code class="filename"><em class="replaceable ">WHATEVERMODIFICATION</em>.conf</code>.
     </p><p>
      Make sure it only contains the line with the value that you want to
      modify.
     </p></li><li class="step "><p>
      Save your changes to the file. It will be used as an extension of the
      original file.
     </p></li></ol></div></div></div><div class="sect2 " id="sec.boot.systemd.custom.targets"><div class="titlepage"><div><div><h3 class="title" id="sec.boot.systemd.custom.targets"><span class="number">10.5.3 </span><span class="name">Creating Custom Targets</span> <a title="Permalink" class="permalink" href="#sec.boot.systemd.custom.targets">#</a></h3></div></div></div><p>
    On System V init SUSE systems, runlevel 4 is unused to allow
    administrators to create their own runlevel configuration. systemd allows
    you to create any number of custom targets. It is suggested to start by
    adapting an existing target such as
    <code class="systemitem">graphical.target</code>.
   </p><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
      Copy the configuration file
      <code class="filename">/usr/lib/systemd/system/graphical.target</code> to
      <code class="filename">/etc/systemd/system/<em class="replaceable ">MY_TARGET</em>.target</code>
      and adjust it according to your needs.
     </p></li><li class="step "><p>
      The configuration file copied in the previous step already covers the
      required (<span class="quote">“<span class="quote">hard</span>”</span>) dependencies for the target. To also cover
      the wanted (<span class="quote">“<span class="quote">soft</span>”</span>) dependencies, create a directory
      <code class="filename">/etc/systemd/system/<em class="replaceable ">MY_TARGET</em>.target.wants</code>.
     </p></li><li class="step "><p>
      For each wanted service, create a symbolic link from
      <code class="filename">/usr/lib/systemd/system</code> into
      <code class="filename">/etc/systemd/system/<em class="replaceable ">MY_TARGET</em>.target.wants</code>.
     </p></li><li class="step "><p>
      Once you have finished setting up the target, reload the systemd
      configuration to make the new target available:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> systemctl daemon-reload</pre></div></li></ol></div></div></div></div><div class="sect1 " id="sec.boot.systemd.advanced"><div class="titlepage"><div><div><h2 class="title" id="sec.boot.systemd.advanced"><span class="number">10.6 </span><span class="name">Advanced Usage</span> <a title="Permalink" class="permalink" href="#sec.boot.systemd.advanced">#</a></h2></div></div></div><p>
   The following sections cover advanced topics for system administrators. For
   even more advanced systemd documentation, refer to Lennart Pöttering's
   series about systemd for administrators at
   <a class="link" href="http://0pointer.de/blog/projects" target="_blank">http://0pointer.de/blog/projects</a>.
  </p><div class="sect2 " id="sec.boot.systemd.advanced.tmp"><div class="titlepage"><div><div><h3 class="title" id="sec.boot.systemd.advanced.tmp"><span class="number">10.6.1 </span><span class="name">Cleaning Temporary Directories</span> <a title="Permalink" class="permalink" href="#sec.boot.systemd.advanced.tmp">#</a></h3></div></div></div><p>
    <code class="systemitem">systemd</code> supports cleaning temporary directories regularly. The
    configuration from the previous system version is automatically migrated
    and active. <code class="literal">tmpfiles.d</code>—which is responsible for
    managing temporary files—reads its configuration from
    <code class="filename">/etc/tmpfiles.d/*.conf</code> ,
    <code class="filename">/run/tmpfiles.d/*.conf</code>, and
    <code class="filename">/usr/lib/tmpfiles.d/*.conf</code> files. Configuration placed
    in <code class="filename">/etc/tmpfiles.d/*.conf</code> overrides related
    configurations from the other two directories
    (<code class="filename">/usr/lib/tmpfiles.d/*.conf</code> is where packages store
    their configuration files).
   </p><p>
    The configuration format is one line per path containing action and path,
    and optionally mode, ownership, age and argument fields, depending on the
    action. The following example unlinks the X11 lock files:
   </p><div class="verbatim-wrap"><pre class="screen">Type Path               Mode UID  GID  Age Argument
r    /tmp/.X[0-9]*-lock</pre></div><p>
    To get the status the tmpfile timer:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> systemctl status systemd-tmpfiles-clean.timer
systemd-tmpfiles-clean.timer - Daily Cleanup of Temporary Directories
 Loaded: loaded (/usr/lib/systemd/system/systemd-tmpfiles-clean.timer; static)
 Active: active (waiting) since Tue 2014-09-09 15:30:36 CEST; 1 weeks 6 days ago
   Docs: man:tmpfiles.d(5)
         man:systemd-tmpfiles(8)

Sep 09 15:30:36 jupiter systemd[1]: Starting Daily Cleanup of Temporary Directories.
Sep 09 15:30:36 jupiter systemd[1]: Started Daily Cleanup of Temporary Directories.</pre></div><p>
    For more information on temporary files handling, see <code class="command">man 5
    tmpfiles.d</code>.
   </p></div><div class="sect2 " id="sec.boot.systemd.advanced.logging"><div class="titlepage"><div><div><h3 class="title" id="sec.boot.systemd.advanced.logging"><span class="number">10.6.2 </span><span class="name">System Log</span> <a title="Permalink" class="permalink" href="#sec.boot.systemd.advanced.logging">#</a></h3></div></div></div><p>
    <a class="xref" href="#sec.boot.systemd.basics.services_debugging" title="10.6.8. Debugging Services">Section 10.6.8, “Debugging Services”</a> explains how
    to view log messages for a given service. However, displaying log messages
    is not restricted to service logs. You can also access and query the
    complete log messages written by <code class="systemitem">systemd</code>—the so-called
    <span class="quote">“<span class="quote">Journal</span>”</span>. Use the command
    <code class="command">systemd-journalctl</code> to display the complete log messages
    starting with the oldest entries. Refer to <code class="command">man 1
    systemd-journalctl</code> for options such as applying filters or
    changing the output format.
   </p></div><div class="sect2 " id="sec.boot.systemd.advanced.snapshots"><div class="titlepage"><div><div><h3 class="title" id="sec.boot.systemd.advanced.snapshots"><span class="number">10.6.3 </span><span class="name">Snapshots</span> <a title="Permalink" class="permalink" href="#sec.boot.systemd.advanced.snapshots">#</a></h3></div></div></div><p>
    You can save the current state of <code class="systemitem">systemd</code> to a named snapshot and later
    revert to it with the <code class="command">isolate</code> subcommand. This is useful
    when testing services or custom targets, because it allows you to return to
    a defined state at any time. A snapshot is only available in the current
    session and will automatically be deleted on reboot. A snapshot name must
    end in <code class="filename">.snapshot</code>.
   </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019140339056"><span class="term ">Create a Snapshot</span></dt><dd><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> systemctl snapshot <em class="replaceable ">MY_SNAPSHOT</em>.snapshot</pre></div></dd><dt id="idm140019140336240"><span class="term ">Delete a Snapshot</span></dt><dd><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> systemctl delete <em class="replaceable ">MY_SNAPSHOT</em>.snapshot</pre></div></dd><dt id="idm140019140333424"><span class="term ">View a Snapshot</span></dt><dd><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> systemctl show <em class="replaceable ">MY_SNAPSHOT</em>.snapshot</pre></div></dd><dt id="idm140019140330608"><span class="term ">Activate a Snapshot</span></dt><dd><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> systemctl isolate <em class="replaceable ">MY_SNAPSHOT</em>.snapshot</pre></div></dd></dl></div></div><div class="sect2 " id="sec.boot.systemd.advanced.kernel_modules"><div class="titlepage"><div><div><h3 class="title" id="sec.boot.systemd.advanced.kernel_modules"><span class="number">10.6.4 </span><span class="name">Loading Kernel Modules</span> <a title="Permalink" class="permalink" href="#sec.boot.systemd.advanced.kernel_modules">#</a></h3></div></div></div><p>
    With <code class="systemitem">systemd</code>, kernel modules can automatically be loaded at boot time via
    a configuration file in <code class="filename">/etc/modules-load.d</code>. The file
    should be named <em class="replaceable ">MODULE</em>.conf and have the
    following content:
   </p><div class="verbatim-wrap"><pre class="screen"># load module <em class="replaceable ">MODULE</em> at boot time
<em class="replaceable ">MODULE</em></pre></div><p>
    In case a package installs a configuration file for loading a kernel
    module, the file gets installed to
    <code class="filename">/usr/lib/modules-load.d</code>. If two configuration files
    with the same name exist, the one in
    <code class="filename">/etc/modules-load.d</code> tales precedence.
   </p><p>
    For more information, see the <code class="systemitem">modules-load.d(5)</code>
    man page.
   </p></div><div class="sect2 " id="sec.boot.systemd.advanced.before.local"><div class="titlepage"><div><div><h3 class="title" id="sec.boot.systemd.advanced.before.local"><span class="number">10.6.5 </span><span class="name">Performing Actions before Loading a Service</span> <a title="Permalink" class="permalink" href="#sec.boot.systemd.advanced.before.local">#</a></h3></div></div></div><p>
    With System V init actions that need to be performed before loading a
    service, needed to be specified in <code class="filename">/etc/init.d/before.local
    </code>. This procedure is no longer supported with systemd. If you
    need to do actions before starting services, do the following:
   </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019140317648"><span class="term ">Loading Kernel Modules</span></dt><dd><p>
       Create a drop-in file in <code class="filename">/etc/modules-load.d</code>
       directory (see <code class="command">man modules-load.d</code> for the syntax)
      </p></dd><dt id="idm140019140314944"><span class="term ">
     Creating Files or Directories, Cleaning-up Directories, Changing
     Ownership
     </span></dt><dd><p>
       Create a drop-in file in <code class="filename">/etc/tmpfiles.d</code> (see
       <code class="command">man tmpfiles.d</code> for the syntax)
      </p></dd><dt id="idm140019140312160"><span class="term ">Other Tasks</span></dt><dd><p>
       Create a system service file, for example
       <code class="filename">/etc/systemd/system/before.service</code>, from the
       following template:
      </p><div class="verbatim-wrap"><pre class="screen">[Unit]
Before=<em class="replaceable ">NAME OF THE SERVICE YOU WANT THIS SERVICE TO BE STARTED BEFORE</em>
[Service]
Type=oneshot
RemainAfterExit=true
ExecStart=<em class="replaceable ">YOUR_COMMAND</em>
# beware, executable is run directly, not through a shell, check the man pages
# systemd.service and systemd.unit for full syntax
[Install]
# target in which to start the service
WantedBy=multi-user.target
#WantedBy=graphical.target</pre></div><p>
       When the service file is created, you should run the following commands
       (as <code class="systemitem">root</code>):
      </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> systemctl daemon-reload
<code class="prompt user">tux &gt; </code><code class="command">sudo</code> systemctl enable before</pre></div><p>
       Every time you modify the service file, you need to run:
      </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> systemctl daemon-reload</pre></div></dd></dl></div></div><div class="sect2 " id="sec.boot.systemd.advanced.cgroups"><div class="titlepage"><div><div><h3 class="title" id="sec.boot.systemd.advanced.cgroups"><span class="number">10.6.6 </span><span class="name">Kernel Control Groups (cgroups)</span> <a title="Permalink" class="permalink" href="#sec.boot.systemd.advanced.cgroups">#</a></h3></div></div></div><p>
    On a traditional System V init system it is not always possible to clearly
    assign a process to the service that spawned it. Some services, such as
    Apache, spawn a lot of third-party processes (for example CGI or Java
    processes), which themselves spawn more processes. This makes a clear
    assignment difficult or even impossible. Additionally, a service may not
    terminate correctly, leaving some children alive.
   </p><p>
    systemd solves this problem by placing each service into its own cgroup.
    cgroups are a kernel feature that allows aggregating processes and all
    their children into hierarchical organized groups. systemd names each
    cgroup after its service. Since a non-privileged process is not allowed to
    <span class="quote">“<span class="quote">leave</span>”</span> its cgroup, this provides an effective way to label
    all processes spawned by a service with the name of the service.
   </p><p>
    To list all processes belonging to a service, use the command
    <code class="command">systemd-cgls</code>. The result will look like the following
    (shortened) example:
   </p><div class="example" id="idm140019140298912"><div class="example-title-wrap"><h6 class="example-title"><span class="number">Example 10.3: </span><span class="name">List all Processes Belonging to a Service </span><a title="Permalink" class="permalink" href="#idm140019140298912">#</a></h6></div><div class="example-contents"><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>systemd-cgls --no-pager
├─1 /usr/lib/systemd/systemd --switched-root --system --deserialize 20
├─user.slice
│ └─user-1000.slice
│   ├─session-102.scope
│   │ ├─12426 gdm-session-worker [pam/gdm-password]
│   │ ├─15831 gdm-session-worker [pam/gdm-password]
│   │ ├─15839 gdm-session-worker [pam/gdm-password]
│   │ ├─15858 /usr/lib/gnome-terminal-server

[...]

└─system.slice
  ├─systemd-hostnamed.service
  │ └─17616 /usr/lib/systemd/systemd-hostnamed
  ├─cron.service
  │ └─1689 /usr/sbin/cron -n
  ├─postfix.service
  │ ├─ 1676 /usr/lib/postfix/master -w
  │ ├─ 1679 qmgr -l -t fifo -u
  │ └─15590 pickup -l -t fifo -u
  ├─sshd.service
  │ └─1436 /usr/sbin/sshd -D

[...]</pre></div></div></div><p>
    See <span class="intraxref">Book “<em class="citetitle ">System Analysis and Tuning Guide</em>”, Chapter 9 “Kernel Control Groups”</span> for more information about
    cgroups.
   </p></div><div class="sect2 " id="sec.boot.systemd.advanced.kill"><div class="titlepage"><div><div><h3 class="title" id="sec.boot.systemd.advanced.kill"><span class="number">10.6.7 </span><span class="name">Terminating Services (Sending Signals)</span> <a title="Permalink" class="permalink" href="#sec.boot.systemd.advanced.kill">#</a></h3></div></div></div><p>
    As explained in <a class="xref" href="#sec.boot.systemd.advanced.cgroups" title="10.6.6. Kernel Control Groups (cgroups)">Section 10.6.6, “Kernel Control Groups (cgroups)”</a>, it is
    not always possible to assign a process to its parent service process in a
    System V init system. This makes it difficult to terminate a service and
    all of its children. Child processes that have not been terminated will
    remain as zombie processes.
   </p><p>
    systemd's concept of confining each service into a cgroup makes it possible
    to clearly identify all child processes of a service and therefore allows
    you to send a signal to each of these processes. Use <code class="command">systemctl
    kill</code> to send signals to services. For a list of available signals
    refer to <code class="command">man 7 signals</code>.
   </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019140290608"><span class="term ">Sending <code class="systemitem">SIGTERM</code> to a Service</span></dt><dd><p>
       <code class="systemitem">SIGTERM</code> is the default signal that is sent.
      </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> systemctl kill <em class="replaceable ">MY_SERVICE</em></pre></div></dd><dt id="idm140019140286576"><span class="term ">Sending <em class="replaceable ">SIGNAL</em> to a Service</span></dt><dd><p>
       Use the <code class="option">-s</code> option to specify the signal that should be
       sent.
      </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> systemctl kill -s <em class="replaceable ">SIGNAL</em> <em class="replaceable ">MY_SERVICE</em></pre></div></dd><dt id="idm140019140282080"><span class="term ">Selecting Processes</span></dt><dd><p>
       By default the <code class="command">kill</code> command sends the signal to
       <code class="option">all</code> processes of the specified cgroup. You can restrict
       it to the <code class="option">control</code> or the <code class="option">main</code> process.
       The latter is for example useful to force a service to reload its
       configuration by sending <code class="systemitem">SIGHUP</code>:
      </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> systemctl kill -s SIGHUP --kill-who=main <em class="replaceable ">MY_SERVICE</em></pre></div></dd></dl></div><div id="idm140019140276384" class="admonition warning normal"><img class="symbol" alt="Warning" title="Warning" src="static/images/icon-warning.png" /><h6>Warning: Terminating or Restarting the D-Bus Service is Not Supported</h6><p>
     The D-Bus service is the message bus for communication between systemd
     clients and the systemd manager that is running as pid 1. Even though
     <code class="systemitem">dbus</code> is a stand-alone daemon, it
     is an integral part of the init infrastructure.
    </p><p>
     Terminating <code class="systemitem">dbus</code> or
     restarting it in the running system is similar to an attempt to terminate
     or restart pid 1. It will break systemd client/server communication and
     make most systemd functions unusable.
    </p><p>
     Therefore, terminating or restarting
     <code class="systemitem">dbus</code> is neither recommended
     nor supported.
    </p></div></div><div class="sect2 " id="sec.boot.systemd.basics.services_debugging"><div class="titlepage"><div><div><h3 class="title" id="sec.boot.systemd.basics.services_debugging"><span class="number">10.6.8 </span><span class="name">Debugging Services</span> <a title="Permalink" class="permalink" href="#sec.boot.systemd.basics.services_debugging">#</a></h3></div></div></div><p>
    By default, systemd is not overly verbose. If a service was started
    successfully, no output will be produced. In case of a failure, a short
    error message will be displayed. However, <code class="command">systemctl
    status</code> provides means to debug start-up and operation of a
    service.
   </p><p>
    systemd comes with its own logging mechanism (<span class="quote">“<span class="quote">The Journal</span>”</span>)
    that logs system messages. This allows you to display the service messages
    together with status messages. The <code class="command">status</code> command works
    similar to <code class="command">tail</code> and can also display the log messages in
    different formats, making it a powerful debugging tool.
   </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019140266624"><span class="term ">Show Service Start-Up Failure</span></dt><dd><p>
       Whenever a service fails to start, use <code class="command">systemctl status
       <em class="replaceable ">MY_SERVICE</em></code> to get a detailed error
       message:
      </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>systemctl start apache2
Job failed. See system journal and 'systemctl status' for details.
<code class="prompt root">root # </code>systemctl status apache2
   Loaded: loaded (/usr/lib/systemd/system/apache2.service; disabled)
   Active: failed (Result: exit-code) since Mon, 04 Jun 2012 16:52:26 +0200; 29s ago
   Process: 3088 ExecStart=/usr/sbin/start_apache2 -D SYSTEMD -k start (code=exited, status=1/FAILURE)
   CGroup: name=systemd:/system/apache2.service

Jun 04 16:52:26 g144 start_apache2[3088]: httpd2-prefork: Syntax error on line
205 of /etc/apache2/httpd.conf: Syntax error on li...alHost&gt;</pre></div></dd><dt id="idm140019140261744"><span class="term ">Show Last <em class="replaceable ">N</em> Service Messages</span></dt><dd><p>
       The default behavior of the <code class="command">status</code> subcommand is to
       display the last ten messages a service issued. To change the number of
       messages to show, use the
       <code class="option">--lines=<em class="replaceable ">N</em></code> parameter:
      </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> systemctl status chronyd
<code class="prompt user">tux &gt; </code><code class="command">sudo</code> systemctl --lines=20 status chronyd</pre></div></dd><dt id="idm140019140256384"><span class="term ">Show Service Messages in Append Mode</span></dt><dd><p>
       To display a <span class="quote">“<span class="quote">live stream</span>”</span> of service messages, use the
       <code class="option">--follow</code> option, which works like
       <code class="command">tail</code> <code class="option">-f</code>:
      </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> systemctl --follow status chronyd</pre></div></dd><dt id="idm140019140251712"><span class="term ">Messages Output Format</span></dt><dd><p>
       The <code class="option">--output=<em class="replaceable ">MODE</em></code> parameter
       allows you to change the output format of service messages. The most
       important modes available are:
      </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019140249104"><span class="term "><code class="option">short</code>
        </span></dt><dd><p>
          The default format. Shows the log messages with a human readable time
          stamp.
         </p></dd><dt id="idm140019140246928"><span class="term "><code class="option">verbose</code>
        </span></dt><dd><p>
          Full output with all fields.
         </p></dd><dt id="idm140019140244816"><span class="term "><code class="option">cat</code>
        </span></dt><dd><p>
          Terse output without time stamps.
         </p></dd></dl></div></dd></dl></div></div></div><div class="sect1 " id="sec.boot.systemd.info"><div class="titlepage"><div><div><h2 class="title" id="sec.boot.systemd.info"><span class="number">10.7 </span><span class="name">More Information</span> <a title="Permalink" class="permalink" href="#sec.boot.systemd.info">#</a></h2></div></div></div><p>
   For more information on systemd refer to the following online resources:
  </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019140239840"><span class="term ">Homepage</span></dt><dd><p>
      <a class="link" href="http://www.freedesktop.org/wiki/Software/systemd" target="_blank">http://www.freedesktop.org/wiki/Software/systemd</a>
     </p></dd><dt id="idm140019140237456"><span class="term ">systemd for Administrators</span></dt><dd><p>
      Lennart Pöttering, one of the systemd authors, has written a series of
      blog entries (13 at the time of writing this chapter). Find them at
      <a class="link" href="http://0pointer.de/blog/projects" target="_blank">http://0pointer.de/blog/projects</a>.
     </p></dd></dl></div></div></div><div class="chapter " id="cha.journalctl"><div class="titlepage"><div><div><h2 class="title"><span class="number">11 </span><span class="name"><code class="command">journalctl</code>: Query the <code class="systemitem">systemd</code> Journal</span> <a title="Permalink" class="permalink" href="#cha.journalctl">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">Filename: </span>journalctl.xml</li><li><span class="ds-label">ID: </span>cha.journalctl</li></ul></div></div></div></div><div class="line"><div class="toc"><dl><dt><span class="sect1"><a href="#sec.journalctl.persistent"><span class="number">11.1 </span><span class="name">Making the Journal Persistent</span></a></span></dt><dt><span class="sect1"><a href="#sec.journalctl.switches"><span class="number">11.2 </span><span class="name"><code class="command">journalctl</code> Useful Switches</span></a></span></dt><dt><span class="sect1"><a href="#sec.journalctl.filter"><span class="number">11.3 </span><span class="name">Filtering the Journal Output</span></a></span></dt><dt><span class="sect1"><a href="#sec.journalctl.investigate"><span class="number">11.4 </span><span class="name">Investigating <code class="systemitem">systemd</code> Errors</span></a></span></dt><dt><span class="sect1"><a href="#sec.journalctl.config"><span class="number">11.5 </span><span class="name">Journald Configuration</span></a></span></dt><dt><span class="sect1"><a href="#sec.journalctl.yast"><span class="number">11.6 </span><span class="name">Using YaST to Filter the <code class="systemitem">systemd</code> Journal</span></a></span></dt></dl></div></div><p>
  When <code class="systemitem">systemd</code> replaced traditional init scripts in <span class="phrase">openSUSE Leap</span>
  (see <a class="xref" href="#cha.systemd" title="Chapter 10. The systemd Daemon">Chapter 10, <em>The <code class="systemitem">systemd</code> Daemon</em></a>), it introduced its own logging system
  called <span class="emphasis"><em>journal</em></span>. There is no need to run a
  <code class="systemitem">syslog</code> based service anymore, as all system events
  are written in the journal.
 </p><p>
  The journal itself is a system service managed by <code class="systemitem">systemd</code>. Its full name is
  <code class="literal">systemd-journald.service</code>. It collects and stores logging
  data by maintaining structured indexed journals based on logging information
  received from the kernel, user processes, standard input, and system service errors. The <code class="literal">systemd-journald</code> service is on
  by default:
 </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> systemctl status systemd-journald
systemd-journald.service - Journal Service
   Loaded: loaded (/usr/lib/systemd/system/systemd-journald.service; static)
   Active: active (running) since Mon 2014-05-26 08:36:59 EDT; 3 days ago
     Docs: man:systemd-journald.service(8)
           man:journald.conf(5)
 Main PID: 413 (systemd-journal)
   Status: "Processing requests..."
   CGroup: /system.slice/systemd-journald.service
           └─413 /usr/lib/systemd/systemd-journald
[...]</pre></div><div class="sect1 " id="sec.journalctl.persistent"><div class="titlepage"><div><div><h2 class="title" id="sec.journalctl.persistent"><span class="number">11.1 </span><span class="name">Making the Journal Persistent</span> <a title="Permalink" class="permalink" href="#sec.journalctl.persistent">#</a></h2></div></div></div><p>
   The journal stores log data in <code class="filename">/run/log/journal/</code> by
   default. Because the <code class="filename">/run/</code> directory is volatile by
   nature, log data is lost at reboot. To make the log data persistent, the
   directory <code class="filename">/var/log/journal/</code> with correct ownership and
   permissions must exist, where the systemd-journald service can store its
   data. <code class="systemitem">systemd</code> will create the directory for you—and switch to
   persistent logging—if you do the following:
  </p><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
     As <code class="systemitem">root</code>, open <code class="filename">/etc/systemd/journald.conf</code> for
     editing.
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>vi /etc/systemd/journald.conf</pre></div></li><li class="step "><p>
     Uncomment the line containing <code class="literal">Storage=</code> and change it to
    </p><div class="verbatim-wrap"><pre class="screen">[...]
[Journal]
Storage=persistent
#Compress=yes
[...]</pre></div></li><li class="step "><p>
     Save the file and restart systemd-journald:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>systemctl restart systemd-journald</pre></div></li></ol></div></div></div><div class="sect1 " id="sec.journalctl.switches"><div class="titlepage"><div><div><h2 class="title" id="sec.journalctl.switches"><span class="number">11.2 </span><span class="name"><code class="command">journalctl</code> Useful Switches</span> <a title="Permalink" class="permalink" href="#sec.journalctl.switches">#</a></h2></div></div></div><p>
   This section introduces several common useful options to enhance the default
   <code class="command">journalctl</code> behavior. All switches are described in the
   <code class="command">journalctl</code> manual page, <code class="command">man 1
   journalctl</code>.
  </p><div id="idm140019140207136" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.png" /><h6>Tip: Messages Related to a Specific Executable</h6><p>
    To show all journal messages related to a specific executable, specify the
    full path to the executable:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> journalctl /usr/lib/systemd/systemd</pre></div></div><div class="variablelist "><dl class="variablelist"><dt id="idm140019140204336"><span class="term ">-f</span></dt><dd><p>
      Shows only the most recent journal messages, and prints new log entries
      as they are added to the journal.
     </p></dd><dt id="idm140019140202432"><span class="term ">-e</span></dt><dd><p>
      Prints the messages and jumps to the end of the journal, so that the
      latest entries are visible within the pager.
     </p></dd><dt id="idm140019140200528"><span class="term ">-r</span></dt><dd><p>
      Prints the messages of the journal in reverse order, so that the latest
      entries are listed first.
     </p></dd><dt id="idm140019140198640"><span class="term ">-k</span></dt><dd><p>
      Shows only kernel messages. This is equivalent to the field match
      <code class="literal">_TRANSPORT=kernel</code> (see
      <a class="xref" href="#sec.journalctl.filter.fields" title="11.3.3. Filtering Based on Fields">Section 11.3.3, “Filtering Based on Fields”</a>).
     </p></dd><dt id="idm140019140195760"><span class="term ">-u</span></dt><dd><p>
      Shows only messages for the specified <code class="systemitem">systemd</code> unit. This is equivalent
      to the field match
      <code class="literal">_SYSTEMD_UNIT=<em class="replaceable ">UNIT</em></code> (see
      <a class="xref" href="#sec.journalctl.filter.fields" title="11.3.3. Filtering Based on Fields">Section 11.3.3, “Filtering Based on Fields”</a>).
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> journalctl -u apache2
[...]
Jun 03 10:07:11 pinkiepie systemd[1]: Starting The Apache Webserver...
Jun 03 10:07:12 pinkiepie systemd[1]: Started The Apache Webserver.</pre></div></dd></dl></div></div><div class="sect1 " id="sec.journalctl.filter"><div class="titlepage"><div><div><h2 class="title" id="sec.journalctl.filter"><span class="number">11.3 </span><span class="name">Filtering the Journal Output</span> <a title="Permalink" class="permalink" href="#sec.journalctl.filter">#</a></h2></div></div></div><p>
   When called without switches, <code class="command">journalctl</code> shows the full
   content of the journal, the oldest entries listed first. The output can be
   filtered by specific switches and fields.
  </p><div class="sect2 " id="sec.journalctl.filter.boot"><div class="titlepage"><div><div><h3 class="title" id="sec.journalctl.filter.boot"><span class="number">11.3.1 </span><span class="name">Filtering Based on a Boot Number</span> <a title="Permalink" class="permalink" href="#sec.journalctl.filter.boot">#</a></h3></div></div></div><p>
    <code class="command">journalctl</code> can filter messages based on a specific
    system boot. To list all available boots, run
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> journalctl --list-boots
-1 097ed2cd99124a2391d2cffab1b566f0 Mon 2014-05-26 08:36:56 EDT—Fri 2014-05-30 05:33:44 EDT
 0 156019a44a774a0bb0148a92df4af81b Fri 2014-05-30 05:34:09 EDT—Fri 2014-05-30 06:15:01 EDT</pre></div><p>
    The first column lists the boot offset: <code class="literal">0</code> for the
    current boot, <code class="literal">-1</code> for the previous one,
    <code class="literal">-2</code> for the one prior to that, etc. The second column
    contains the boot ID followed by the limiting time stamps of the specific
    boot.
   </p><p>
    Show all messages from the current boot:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> journalctl -b</pre></div><p>
    If you need to see journal messages from the previous boot, add an offset
    parameter. The following example outputs the previous boot messages:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> journalctl -b -1</pre></div><p>
    Another way is to list boot messages based on the boot ID. For this
    purpose, use the _BOOT_ID field:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> journalctl _BOOT_ID=156019a44a774a0bb0148a92df4af81b</pre></div></div><div class="sect2 " id="sec.journalctl.filter.time"><div class="titlepage"><div><div><h3 class="title" id="sec.journalctl.filter.time"><span class="number">11.3.2 </span><span class="name">Filtering Based on Time Interval</span> <a title="Permalink" class="permalink" href="#sec.journalctl.filter.time">#</a></h3></div></div></div><p>
    You can filter the output of <code class="command">journalctl</code> by specifying
    the starting and/or ending date. The date specification should be of the
    format "2014-06-30 9:17:16". If the time part is omitted, midnight is
    assumed. If seconds are omitted, ":00" is assumed. If the date part is
    omitted, the current day is assumed. Instead of numeric expression, you can
    specify the keywords "yesterday", "today", or "tomorrow". They refer to
    midnight of the day before the current day, of the current day, or of the
    day after the current day. If you specify "now", it refers to the current
    time. You can also specify relative times prefixed with
    <code class="literal">-</code> or <code class="literal">+</code>, referring to times before or
    after the current time.
   </p><p>
    Show only new messages since now, and update the output continuously:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> journalctl --since "now" -f</pre></div><p>
    Show all messages since last midnight till 3:20am:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> journalctl --since "today" --until "3:20"</pre></div></div><div class="sect2 " id="sec.journalctl.filter.fields"><div class="titlepage"><div><div><h3 class="title" id="sec.journalctl.filter.fields"><span class="number">11.3.3 </span><span class="name">Filtering Based on Fields</span> <a title="Permalink" class="permalink" href="#sec.journalctl.filter.fields">#</a></h3></div></div></div><p>
    You can filter the output of the journal by specific fields. The syntax of
    a field to be matched is <code class="literal">FIELD_NAME=MATCHED_VALUE</code>, such
    as <code class="literal">_SYSTEMD_UNIT=httpd.service</code>. You can specify multiple
    matches in a single query to filter the output messages even more. See
    <code class="command">man 7 systemd.journal-fields</code> for a list of default
    fields.
   </p><p>
    Show messages produced by a specific process ID:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> journalctl _PID=1039</pre></div><p>
    Show messages belonging to a specific user ID:
   </p><div class="verbatim-wrap"><pre class="screen"># journalctl _UID=1000</pre></div><p>
    Show messages from the kernel ring buffer (the same as
    <code class="command">dmesg</code> produces):
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> journalctl _TRANSPORT=kernel</pre></div><p>
    Show messages from the service's standard or error output:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> journalctl _TRANSPORT=stdout</pre></div><p>
    Show messages produced by a specified service only:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> journalctl _SYSTEMD_UNIT=avahi-daemon.service</pre></div><p>
    If two different fields are specified, only entries that match both
    expressions at the same time are shown:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> journalctl _SYSTEMD_UNIT=avahi-daemon.service _PID=1488</pre></div><p>
    If two matches refer to the same field, all entries matching either
    expression are shown:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> journalctl _SYSTEMD_UNIT=avahi-daemon.service _SYSTEMD_UNIT=dbus.service</pre></div><p>
    You can use the '+' separator to combine two expressions in a logical 'OR'.
    The following example shows all messages from the Avahi service process
    with the process ID 1480 together with all messages from the D-Bus service:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> journalctl _SYSTEMD_UNIT=avahi-daemon.service _PID=1480 + _SYSTEMD_UNIT=dbus.service</pre></div></div></div><div class="sect1 " id="sec.journalctl.investigate"><div class="titlepage"><div><div><h2 class="title" id="sec.journalctl.investigate"><span class="number">11.4 </span><span class="name">Investigating <code class="systemitem">systemd</code> Errors</span> <a title="Permalink" class="permalink" href="#sec.journalctl.investigate">#</a></h2></div></div></div><p>
   This section introduces a simple example to illustrate how to find and fix
   the error reported by <code class="systemitem">systemd</code> during <code class="command">apache2</code> start-up.
  </p><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
     Try to start the apache2 service:
    </p><div class="verbatim-wrap"><pre class="screen"># systemctl start apache2
Job for apache2.service failed. See 'systemctl status apache2' and 'journalctl -xn' for details.</pre></div></li><li class="step "><p>
     Let us see what the service's status says:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> systemctl status apache2
apache2.service - The Apache Webserver
   Loaded: loaded (/usr/lib/systemd/system/apache2.service; disabled)
   Active: failed (Result: exit-code) since Tue 2014-06-03 11:08:13 CEST; 7min ago
  Process: 11026 ExecStop=/usr/sbin/start_apache2 -D SYSTEMD -DFOREGROUND \
           -k graceful-stop (code=exited, status=1/FAILURE)</pre></div><p>
     The ID of the process causing the failure is 11026.
    </p></li><li class="step "><p>
     Show the verbose version of messages related to process ID 11026:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> journalctl -o verbose _PID=11026
[...]
MESSAGE=AH00526: Syntax error on line 6 of /etc/apache2/default-server.conf:
[...]
MESSAGE=Invalid command 'DocumenttRoot', perhaps misspelled or defined by a module
[...]</pre></div></li><li class="step "><p>
     Fix the typo inside <code class="filename">/etc/apache2/default-server.conf</code>,
     start the apache2 service, and print its status:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> systemctl start apache2 &amp;&amp; systemctl status apache2
apache2.service - The Apache Webserver
   Loaded: loaded (/usr/lib/systemd/system/apache2.service; disabled)
   Active: active (running) since Tue 2014-06-03 11:26:24 CEST; 4ms ago
  Process: 11026 ExecStop=/usr/sbin/start_apache2 -D SYSTEMD -DFOREGROUND
           -k graceful-stop (code=exited, status=1/FAILURE)
 Main PID: 11263 (httpd2-prefork)
   Status: "Processing requests..."
   CGroup: /system.slice/apache2.service
           ├─11263 /usr/sbin/httpd2-prefork -f /etc/apache2/httpd.conf -D [...]
           ├─11280 /usr/sbin/httpd2-prefork -f /etc/apache2/httpd.conf -D [...]
           ├─11281 /usr/sbin/httpd2-prefork -f /etc/apache2/httpd.conf -D [...]
           ├─11282 /usr/sbin/httpd2-prefork -f /etc/apache2/httpd.conf -D [...]
           ├─11283 /usr/sbin/httpd2-prefork -f /etc/apache2/httpd.conf -D [...]
           └─11285 /usr/sbin/httpd2-prefork -f /etc/apache2/httpd.conf -D [...]</pre></div></li></ol></div></div></div><div class="sect1 " id="sec.journalctl.config"><div class="titlepage"><div><div><h2 class="title" id="sec.journalctl.config"><span class="number">11.5 </span><span class="name">Journald Configuration</span> <a title="Permalink" class="permalink" href="#sec.journalctl.config">#</a></h2></div></div></div><p>
   The behavior of the systemd-journald service can be adjusted by modifying
   <code class="filename">/etc/systemd/journald.conf</code>. This section introduces
   only basic option settings. For a complete file description, see
   <code class="command">man 5 journald.conf</code>. Note that you need to restart the
   journal for the changes to take effect with
  </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> systemctl restart systemd-journald</pre></div><div class="sect2 " id="sec.journalctl.config.systemmaxuse"><div class="titlepage"><div><div><h3 class="title" id="sec.journalctl.config.systemmaxuse"><span class="number">11.5.1 </span><span class="name">Changing the Journal Size Limit</span> <a title="Permalink" class="permalink" href="#sec.journalctl.config.systemmaxuse">#</a></h3></div></div></div><p>
    If the journal log data is saved to a persistent location (see
    <a class="xref" href="#sec.journalctl.persistent" title="11.1. Making the Journal Persistent">Section 11.1, “Making the Journal Persistent”</a>), it uses up to 10% of the file
    system the <code class="filename">/var/log/journal</code> resides on. For example,
    if <code class="filename">/var/log/journal</code> is located on a 30 GB
    <code class="filename">/var</code> partition, the journal may use up to 3 GB of the
    disk space. To change this limit, change (and uncomment) the
    <code class="option">SystemMaxUse</code> option:
   </p><div class="verbatim-wrap"><pre class="screen">SystemMaxUse=50M</pre></div></div><div class="sect2 " id="sec.journalctl.config.ttypath"><div class="titlepage"><div><div><h3 class="title" id="sec.journalctl.config.ttypath"><span class="number">11.5.2 </span><span class="name">Forwarding the Journal to <code class="filename">/dev/ttyX</code></span> <a title="Permalink" class="permalink" href="#sec.journalctl.config.ttypath">#</a></h3></div></div></div><p>
    You can forward the journal to a terminal device to inform you about system
    messages on a preferred terminal screen, for example
    <code class="literal">/dev/tty12</code>. Change the following journald options to
   </p><div class="verbatim-wrap"><pre class="screen">ForwardToConsole=yes
TTYPath=/dev/tty12</pre></div></div><div class="sect2 " id="sec.journalctl.config.forwardtosyslog"><div class="titlepage"><div><div><h3 class="title" id="sec.journalctl.config.forwardtosyslog"><span class="number">11.5.3 </span><span class="name">Forwarding the Journal to Syslog Facility</span> <a title="Permalink" class="permalink" href="#sec.journalctl.config.forwardtosyslog">#</a></h3></div></div></div><p>
    Journald is backward compatible with traditional syslog implementations
    such as <code class="systemitem">rsyslog</code>. Make sure the following is valid:
   </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
      rsyslog is installed.
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> rpm -q rsyslog
rsyslog-7.4.8-2.16.x86_64</pre></div></li><li class="listitem "><p>
      rsyslog service is enabled.
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> systemctl is-enabled rsyslog
enabled</pre></div></li><li class="listitem "><p>
      Forwarding to syslog is enabled in
      <code class="filename">/etc/systemd/journald.conf</code>.
     </p><div class="verbatim-wrap"><pre class="screen">ForwardToSyslog=yes</pre></div></li></ul></div></div></div><div class="sect1 " id="sec.journalctl.yast"><div class="titlepage"><div><div><h2 class="title" id="sec.journalctl.yast"><span class="number">11.6 </span><span class="name">Using YaST to Filter the <code class="systemitem">systemd</code> Journal</span> <a title="Permalink" class="permalink" href="#sec.journalctl.yast">#</a></h2></div></div></div><p>
   For an easy way of filtering the systemd journal (without having to deal
   with the journalctl syntax), you can use the YaST journal module. After
   installing it with <code class="command">sudo zypper in yast2-journal</code>, start it
   from YaST by selecting <span class="guimenu">System</span> › <span class="guimenu">Systemd Journal</span>. Alternatively, start it
   from command line by entering <code class="command">sudo yast2 journal</code>.
  </p><div class="figure" id="fig.journalctl.yast"><div class="figure-contents"><div class="mediaobject"><a xmlns="" href="images/yast2_journal.png"><img src="images/yast2_journal.png" width="" alt="YaST systemd Journal" /></a></div></div><div class="figure-title-wrap"><h6 class="figure-title"><span class="number">Figure 11.1: </span><span class="name">YaST systemd Journal </span><a title="Permalink" class="permalink" href="#fig.journalctl.yast">#</a></h6></div></div><p>
   The module displays the log entries in a table. The search box on top allows
   you to search for entries that contain certain characters, similar to using
   <code class="command">grep</code>. To filter the entries by date and time, unit, file,
   or priority, click <span class="guimenu">Change filters</span> and set the respective
   options.
  </p></div></div><div class="chapter " id="cha.grub2"><div class="titlepage"><div><div><h2 class="title"><span class="number">12 </span><span class="name">The Boot Loader GRUB 2</span> <a title="Permalink" class="permalink" href="#cha.grub2">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">Filename: </span>grub2.xml</li><li><span class="ds-label">ID: </span>cha.grub2</li></ul></div></div><div><div class="abstract"><div class="abstract-title-wrap"><h6 class="abstract-title">Abstract<a title="Permalink" class="permalink" href="#idm140019140104496">#</a></h6></div><p>
    This chapter describes how to configure GRUB 2, the boot loader used in
    <span class="productname"><span class="phrase">openSUSE® Leap</span></span>. It is the successor to the traditional GRUB boot
    loader—now called <span class="quote">“<span class="quote">GRUB Legacy</span>”</span>.
     A YaST module is available
    for configuring the most important settings. The boot procedure as a whole
    is outlined in <a class="xref" href="#cha.boot" title="Chapter 9. Introduction to the Booting Process">Chapter 9, <em>Introduction to the Booting Process</em></a>. For details on Secure Boot
    support for UEFI machines, see <a class="xref" href="#cha.uefi" title="Chapter 14. UEFI (Unified Extensible Firmware Interface)">Chapter 14, <em>UEFI (Unified Extensible Firmware Interface)</em></a>.
   </p></div></div></div></div><div class="line"><div class="toc"><dl><dt><span class="sect1"><a href="#sec.grub2.new.features"><span class="number">12.1 </span><span class="name">Main Differences between GRUB Legacy and GRUB 2</span></a></span></dt><dt><span class="sect1"><a href="#sec.grub2.file_structure"><span class="number">12.2 </span><span class="name">Configuration File Structure</span></a></span></dt><dt><span class="sect1"><a href="#sec.grub2.yast2.config"><span class="number">12.3 </span><span class="name">Configuring the Boot Loader with YaST</span></a></span></dt><dt><span class="sect1"><a href="#sec.grub2.zseries"><span class="number">12.4 </span><span class="name">Differences in Terminal Usage on IBM Z</span></a></span></dt><dt><span class="sect1"><a href="#sec.grub2.commands"><span class="number">12.5 </span><span class="name">Helpful GRUB 2 Commands</span></a></span></dt><dt><span class="sect1"><a href="#sec.grub2.info"><span class="number">12.6 </span><span class="name">More Information</span></a></span></dt></dl></div></div><div class="sect1 " id="sec.grub2.new.features"><div class="titlepage"><div><div><h2 class="title" id="sec.grub2.new.features"><span class="number">12.1 </span><span class="name">Main Differences between GRUB Legacy and GRUB 2</span> <a title="Permalink" class="permalink" href="#sec.grub2.new.features">#</a></h2></div></div></div><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
     The configuration is stored in different files.
    </p></li><li class="listitem "><p>
     More file systems are supported (for example, Btrfs).
    </p></li><li class="listitem "><p>
     Can directly read files stored on LVM or RAID devices.
    </p></li><li class="listitem "><p>
     The user interface can be translated and altered with themes.
    </p></li><li class="listitem "><p>
     Includes a mechanism for loading modules to support additional features,
     such as file systems, etc.
    </p></li><li class="listitem "><p>
     Automatically searches for and generates boot entries for other kernels
     and operating systems, such as Windows.
    </p></li><li class="listitem "><p>
     Includes a minimal Bash-like console.
    </p></li></ul></div></div><div class="sect1 " id="sec.grub2.file_structure"><div class="titlepage"><div><div><h2 class="title" id="sec.grub2.file_structure"><span class="number">12.2 </span><span class="name">Configuration File Structure</span> <a title="Permalink" class="permalink" href="#sec.grub2.file_structure">#</a></h2></div></div></div><p>
   The configuration of GRUB 2 is based on the following files:
  </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019140088064"><span class="term "><code class="filename">/boot/grub2/grub.cfg</code>
    </span></dt><dd><p>
      This file contains the configuration of the GRUB 2 menu items. It
      replaces <code class="filename">menu.lst</code> used in GRUB Legacy.
      <code class="filename">grub.cfg</code> is automatically generated by the
      <a class="xref" href="#vle.grub2.mkconfig"><code class="command">grub2-mkconfig</code>
    </a> command, and should not be edited.
     </p></dd><dt id="idm140019140084368"><span class="term "><code class="filename">/boot/grub2/custom.cfg</code>
    </span></dt><dd><p>
      This optional file is directly sourced by <code class="filename">grub.cfg</code>
      at boot time and can be used to add custom items to the boot menu.
      Starting with <span class="productname"><span class="phrase">openSUSE Leap</span></span> <span class="phrase">Leap 42.2</span> these entries will also
      be parsed when using <code class="command">grub-once</code>.
     </p></dd><dt id="idm140019140079408"><span class="term "><code class="filename">/etc/default/grub</code>
    </span></dt><dd><p>
      This file controls the user settings of GRUB 2 and usually includes
      additional environmental settings such as backgrounds and themes.
     </p></dd><dt id="idm140019140077184"><span class="term ">Scripts under <code class="filename">/etc/grub.d/</code>
    </span></dt><dd><p>
      The scripts in this directory are read during execution of the
      <a class="xref" href="#vle.grub2.mkconfig"><code class="command">grub2-mkconfig</code>
    </a> command. Their instructions are
      integrated into the main configuration file
      <code class="filename">/boot/grub/grub.cfg</code>.
     </p></dd><dt id="vle.grub2.sysconfig"><span class="term "><code class="filename">/etc/sysconfig/bootloader</code>
    </span></dt><dd><p>
      This configuration file is used when configuring the boot loader with
      YaST and every time a new kernel is installed. It is evaluated by the
      perl-bootloader which modifies the boot loader configuration file (for
      example <code class="filename">/boot/grub2/grub.cfg</code> for GRUB 2)
      accordingly. <code class="filename">/etc/sysconfig/bootloader</code> is not a
      GRUB 2-specific configuration file—the values are applied to any
      boot loader installed on <span class="productname"><span class="phrase">openSUSE Leap</span></span>.
     </p></dd><dt id="idm140019140068896"><span class="term "><code class="filename">/boot/grub2/x86_64-efi</code>,
     ,
     
    </span></dt><dd><p>
      These configuration files contain architecture-specific options.
     </p></dd></dl></div><p>
   GRUB 2 can be controlled in various ways. Boot entries from an existing
   configuration can be selected from the graphical menu (splash screen). The
   configuration is loaded from the file
   <code class="filename">/boot/grub2/grub.cfg</code> which is compiled from other
   configuration files (see below). All GRUB 2 configuration files are
   considered system files, and you need <code class="systemitem">root</code> privileges to edit them.
  </p><div id="idm140019140064384" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note: Activating Configuration Changes</h6><p>
    After having manually edited GRUB 2 configuration files, you need to run
    <a class="xref" href="#vle.grub2.mkconfig"><code class="command">grub2-mkconfig</code>
    </a> to activate the changes. However, this
    is not necessary when changing the configuration with YaST, since it will
    automatically run <a class="xref" href="#vle.grub2.mkconfig"><code class="command">grub2-mkconfig</code>
    </a>.
   </p></div><div class="sect2 " id="sec.grub2.cfg"><div class="titlepage"><div><div><h3 class="title" id="sec.grub2.cfg"><span class="number">12.2.1 </span><span class="name">The File <code class="filename">/boot/grub2/grub.cfg</code></span> <a title="Permalink" class="permalink" href="#sec.grub2.cfg">#</a></h3></div></div></div><p>
    The graphical splash screen with the boot menu is based on the GRUB 2
    configuration file <code class="filename">/boot/grub2/grub.cfg</code>, which
    contains information about all partitions or operating systems that can be
    booted by the menu.
   </p><p>
    Every time the system is booted, GRUB 2 loads the menu file directly from
    the file system. For this reason, GRUB 2 does not need to be re-installed
    after changes to the configuration file. <code class="filename">grub.cfg</code> is
    automatically rebuilt with kernel installations or removals.
   </p><p>
    <code class="filename">grub.cfg</code> is compiled by the
    <a class="xref" href="#vle.grub2.mkconfig"><code class="command">grub2-mkconfig</code>
    </a> from the file
    <code class="filename">/etc/default/grub</code> and scripts found in the
    <code class="filename">/etc/grub.d/</code> directory. Therefore you should never
    edit the file manually. Instead, edit the related source files or use the
    YaST <span class="guimenu">Boot Loader</span> module to modify the configuration as
    described in <a class="xref" href="#sec.grub2.yast2.config" title="12.3. Configuring the Boot Loader with YaST">Section 12.3, “Configuring the Boot Loader with YaST”</a>.
   </p></div><div class="sect2 " id="sec.grub2.etc_default_grub"><div class="titlepage"><div><div><h3 class="title" id="sec.grub2.etc_default_grub"><span class="number">12.2.2 </span><span class="name">The File <code class="filename">/etc/default/grub</code></span> <a title="Permalink" class="permalink" href="#sec.grub2.etc_default_grub">#</a></h3></div></div></div><p>
    More general options of GRUB 2 belong here, such as the time the menu is
    displayed, or the default OS to boot. To list all available options, see
    the output of the following command:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>grep "export GRUB_DEFAULT" -A50 /usr/sbin/grub2-mkconfig | grep GRUB_</pre></div><p>
    In addition to already defined variables, the user may introduce their own
    variables, and use them later in the scripts found in the
    <code class="filename">/etc/grub.d</code> directory.
   </p><p>
    After having edited <code class="filename">/etc/default/grub</code>, run
    <a class="xref" href="#vle.grub2.mkconfig"><code class="command">grub2-mkconfig</code>
    </a> to update the main configuration file.
   </p><div id="idm140019140048880" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note: Scope</h6><p>
     All options set in this file are general options that affect all boot
     entries. Specific options for Xen kernels or the Xen hypervisor can be
     set via the GRUB_*_XEN_* configuration options. See below for details.
    </p></div><div class="variablelist "><dl class="variablelist"><dt id="idm140019140046512"><span class="term "><code class="literal">GRUB_DEFAULT</code>
     </span></dt><dd><p>
       Sets the boot menu entry that is booted by default. Its value can be a
       numeric value, the complete name of a menu entry, or
       <span class="quote">“<span class="quote">saved</span>”</span>.
      </p><p>
       <code class="literal">GRUB_DEFAULT=2</code> boots the third (counted from zero)
       boot menu entry.
      </p><p>
       <code class="literal">GRUB_DEFAULT="2&gt;0"</code> boots the first submenu entry
       of the third top-level menu entry.
      </p><p>
       <code class="literal">GRUB_DEFAULT="Example boot menu entry"</code> boots the menu
       entry with the title <span class="quote">“<span class="quote">Example boot menu entry</span>”</span>.
      </p><p>
       <code class="literal">GRUB_DEFAULT=saved</code> boots the entry specified by the
       <code class="command">grub2-once</code> or <code class="command">grub2-set-default</code>
       commands. While <code class="command">grub2-reboot</code> sets the
       default boot entry for the next reboot only,
       <code class="command">grub2-set-default</code> sets the default boot entry until
       changed. <code class="command">grub2-editenv list</code> lists next boot entry.
      </p></dd><dt id="idm140019140037280"><span class="term "><code class="literal">GRUB_HIDDEN_TIMEOUT</code>
     </span></dt><dd><p>
       Waits the specified number of seconds for the user to press a key.
       During the period no menu is shown unless the user presses a key. If no
       key is pressed during the time specified, the control is passed to
       <code class="literal">GRUB_TIMEOUT</code>.
       <code class="literal">GRUB_HIDDEN_TIMEOUT=0</code> first checks whether
       <span class="keycap">Shift</span> is pressed and shows the boot menu if yes,
       otherwise immediately boots the default menu entry. This is the default
       when only one bootable OS is identified by GRUB 2.
      </p></dd><dt id="idm140019140033328"><span class="term "><code class="literal">GRUB_HIDDEN_TIMEOUT_QUIET</code>
     </span></dt><dd><p>
       If <code class="literal">false</code> is specified, a countdown timer is displayed
       on a blank screen when the <code class="literal">GRUB_HIDDEN_TIMEOUT</code>
       feature is active.
      </p></dd><dt id="idm140019140030256"><span class="term "><code class="literal">GRUB_TIMEOUT</code>
     </span></dt><dd><p>
       Time period in seconds the boot menu is displayed before automatically
       booting the default boot entry. If you press a key, the timeout is
       cancelled and GRUB 2 waits for you to make the selection manually.
       <code class="literal">GRUB_TIMEOUT=-1</code> will cause the menu to be displayed
       until you select the boot entry manually.
      </p></dd><dt id="idm140019140027424"><span class="term "><code class="literal">GRUB_CMDLINE_LINUX</code>
     </span></dt><dd><p>
       Entries on this line are added at the end of the boot entries for normal
       and recovery mode. Use it to add kernel parameters to the boot entry.
      </p></dd><dt id="idm140019140025200"><span class="term "><code class="literal">GRUB_CMDLINE_LINUX_DEFAULT</code>
     </span></dt><dd><p>
       Same as <code class="literal">GRUB_CMDLINE_LINUX</code> but the entries are
       appended in the normal mode only.
      </p></dd><dt id="idm140019140022608"><span class="term "><code class="literal">GRUB_CMDLINE_LINUX_RECOVERY</code>
     </span></dt><dd><p>
       Same as <code class="literal">GRUB_CMDLINE_LINUX</code> but the entries are
       appended in the recovery mode only.
      </p></dd><dt id="idm140019140020016"><span class="term "><code class="literal">GRUB_CMDLINE_LINUX_XEN_REPLACE</code>
     </span></dt><dd><p>
       This entry will completely replace the
       <code class="literal">GRUB_CMDLINE_LINUX</code> parameters for all Xen boot
       entries.
      </p></dd><dt id="idm140019140017408"><span class="term "><code class="literal">GRUB_CMDLINE_LINUX_XEN_REPLACE_DEFAULT</code>
     </span></dt><dd><p>
       Same as <code class="literal">GRUB_CMDLINE_LINUX_XEN_REPLACE</code> but it will
       only replace parameters of<code class="literal">GRUB_CMDLINE_LINUX_DEFAULT</code>.
      </p></dd><dt id="idm140019140014352"><span class="term "><code class="literal">GRUB_CMDLINE_XEN</code>
     </span></dt><dd><p>
       This entry specifies the kernel parameters for the Xen guest kernel
       only—the operation principle is the same as for
       <code class="literal">GRUB_CMDLINE_LINUX</code>.
      </p></dd><dt id="idm140019140011696"><span class="term "><code class="literal">GRUB_CMDLINE_XEN_DEFAULT</code>
     </span></dt><dd><p>
       Same as <code class="literal">GRUB_CMDLINE_XEN</code>—the operation
       principle is the same as for
       <code class="literal">GRUB_CMDLINE_LINUX_DEFAULT</code>.
      </p></dd><dt id="idm140019140008640"><span class="term "><code class="literal">GRUB_TERMINAL</code>
     </span></dt><dd><p>
       Enables and specifies an input/output terminal device. Can be
       <code class="literal">console</code> (PC BIOS and EFI consoles),
       <code class="literal">serial</code> (serial terminal),
       <code class="literal">ofconsole</code> (Open Firmware console), or the default
       <code class="literal">gfxterm</code> (graphics-mode output). It is also possible
       to enable more than one device by quoting the required options, for
       example <code class="literal">GRUB_TERMINAL="console serial"</code>.
      </p></dd><dt id="idm140019140004064"><span class="term "><code class="literal">GRUB_GFXMODE</code>
     </span></dt><dd><p>
       The resolution used for the <code class="literal">gfxterm</code> graphical
       terminal. Note that you can only use modes supported by your graphics
       card (VBE). The default is ‘auto’, which tries to select a preferred
       resolution. You can display the screen resolutions available to GRUB 2
       by typing <code class="command">videoinfo</code> in the GRUB 2 command line. The
       command line is accessed by typing <span class="keycap">C</span> when the GRUB 2
       boot menu screen is displayed.
      </p><p>
       You can also specify a color depth by appending it to the resolution
       setting, for example <code class="literal">GRUB_GFXMODE=1280x1024x24</code>.
      </p></dd><dt id="idm140019139999248"><span class="term "><code class="literal">GRUB_BACKGROUND</code>
     </span></dt><dd><p>
       Set a background image for the <code class="literal">gfxterm</code> graphical
       terminal. The image must be a file readable by GRUB 2 at boot time, and
       it must end with the <code class="literal">.png</code>, <code class="literal">.tga</code>,
       <code class="literal">.jpg</code>, or <code class="literal">.jpeg</code> suffix. If
       necessary, the image will be scaled to fit the screen.
      </p></dd><dt id="idm140019139994752"><span class="term "><code class="literal">GRUB_DISABLE_OS_PROBER</code>
     </span></dt><dd><p>
       If this option is set to <code class="literal">true</code>, automatic searching
       for other operating systems is disabled. Only the kernel images in
       <code class="filename">/boot/</code> and the options from your own scripts in
       <code class="filename">/etc/grub.d/</code> are detected.
      </p></dd><dt id="idm140019139991200"><span class="term "><code class="literal">SUSE_BTRFS_SNAPSHOT_BOOTING</code>
     </span></dt><dd><p>
       If this option is set to <code class="literal">true</code>, GRUB 2 can boot
       directly into Snapper snapshots. For more information, see
       <a class="xref" href="#sec.snapper.snapshot-boot" title="3.3. System Rollback by Booting from Snapshots">Section 3.3, “System Rollback by Booting from Snapshots”</a>.
      </p></dd></dl></div><p>
    For a complete list of options, see the
    <a class="link" href="http://www.gnu.org/software/grub/manual/grub.html#Simple-configuration" target="_blank">
    GNU GRUB manual</a>. For a complete list of possible parameters, see
    <a class="link" href="http://en.opensuse.org/Linuxrc" target="_blank">http://en.opensuse.org/Linuxrc</a>.
   </p></div><div class="sect2 " id="sec.grub2.etc_grub_d"><div class="titlepage"><div><div><h3 class="title" id="sec.grub2.etc_grub_d"><span class="number">12.2.3 </span><span class="name">Scripts in <code class="filename">/etc/grub.d</code></span> <a title="Permalink" class="permalink" href="#sec.grub2.etc_grub_d">#</a></h3></div></div></div><p>
    The scripts in this directory are read during execution of the
    <a class="xref" href="#vle.grub2.mkconfig"><code class="command">grub2-mkconfig</code>
    </a> command, and their instructions are
    incorporated into <code class="filename">/boot/grub2/grub.cfg</code>. The order of
    menu items in <code class="filename">grub.cfg</code> is determined by the order in
    which the files in this directory are run. Files with a leading numeral are
    executed first, beginning with the lowest number.
    <code class="filename">00_header</code> is run before <code class="filename">10_linux</code>,
    which would run before <code class="filename">40_custom</code>. If files with
    alphabetic names are present, they are executed after the numerically-named
    files. Only executable files generate output to
    <code class="filename">grub.cfg</code> during execution of
    <code class="command">grub2-mkconfig</code>. By default all files in the
    <code class="filename">/etc/grub.d</code> directory are executable.
   </p><div id="idm140019139979264" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.png" /><h6>Tip: Persistent Custom Content in <code class="filename">grub.cfg</code></h6><p>
     Because <code class="filename">/boot/grub2/grub.cfg</code> is recompiled each time
     <code class="command">grub2-mkconfig</code> is run, any custom content is lost.
     If you want to insert your lines directly into
     <code class="filename">/boot/grub2/grub.cfg</code> without losing them after
     <code class="command">grub2-mkconfig</code> is run, insert it between
    </p><div class="verbatim-wrap"><pre class="screen">### BEGIN /etc/grub.d/90_persistent ###</pre></div><p>
     and
    </p><div class="verbatim-wrap"><pre class="screen">### END /etc/grub.d/90_persistent ###</pre></div><p>
     lines. The <code class="filename">90_persistent</code> script ensures that such
     content will be preserved.
    </p><p>
     A list of the most important scripts follows:
    </p></div><div class="variablelist "><dl class="variablelist"><dt id="idm140019139972592"><span class="term "><code class="filename">00_header</code>
     </span></dt><dd><p>
       Sets environmental variables such as system file locations, display
       settings, themes, and previously saved entries. It also imports
       preferences stored in the <code class="filename">/etc/default/grub</code>.
       Normally you do not need to make changes to this file.
      </p></dd><dt id="idm140019139969856"><span class="term "><code class="filename">10_linux</code>
     </span></dt><dd><p>
       Identifies Linux kernels on the root device and creates relevant menu
       entries. This includes the associated recovery mode option if enabled.
       Only the latest kernel is displayed on the main menu page, with
       additional kernels included in a submenu.
      </p></dd><dt id="idm140019139967504"><span class="term "><code class="filename">30_os-prober</code>
     </span></dt><dd><p>
       This script uses <code class="command">os-prober</code> to search for Linux and
       other operating systems and places the results in the GRUB 2 menu. There
       are sections to identify specific other operating systems, such as
       Windows or macOS.
      </p></dd><dt id="idm140019139964768"><span class="term "><code class="filename">40_custom</code>
     </span></dt><dd><p>
       This file provides a simple way to include custom boot entries into
       <code class="filename">grub.cfg</code>. Make sure that you do not change the
       <code class="literal">exec tail -n +3 $0</code> part at the beginning.
      </p></dd></dl></div><p>
    The processing sequence is set by the preceding numbers with the lowest
    number being executed first. If scripts are preceded by the same number the
    alphabetical order of the complete name decides the order.
   </p><div id="idm140019139960864" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.png" /><h6>Tip: <code class="filename">/boot/grub2/custom.cfg</code></h6><p>
     If you create <code class="filename">/boot/grub2/custom.cfg</code> and fill it with
     a custom content, it will be automatically included into
     <code class="filename">/boot/grub2/grub.cfg</code> at boot time.
    </p></div></div><div class="sect2 " id="sec.grub2.map"><div class="titlepage"><div><div><h3 class="title" id="sec.grub2.map"><span class="number">12.2.4 </span><span class="name">Mapping between BIOS Drives and Linux Devices</span> <a title="Permalink" class="permalink" href="#sec.grub2.map">#</a></h3></div></div></div><p>
    In GRUB Legacy, the <code class="filename">device.map</code> configuration file was
    used to derive Linux device names from BIOS drive numbers. The mapping
    between BIOS drives and Linux devices cannot always be guessed correctly.
    For example, GRUB Legacy would get a wrong order if the boot sequence of
    IDE and SCSI drives is exchanged in the BIOS configuration.
   </p><p>
    GRUB 2 avoids this problem by using device ID strings (UUIDs) or file
    system labels when generating <code class="filename">grub.cfg</code>. GRUB 2
    utilities create a temporary device map on the fly, which is usually
    sufficient, particularly in the case of single-disk systems.
   </p><p>
    However, if you need to override the GRUB 2's automatic device mapping
    mechanism, create your custom mapping file
    <code class="filename">/boot/grub2/device.map</code>. The following example changes
    the mapping to make <code class="literal">DISK 3</code> the boot disk. Note that
    GRUB 2 partition numbers start with <code class="literal">1</code> and not with
    <code class="literal">0</code> as in GRUB Legacy.
   </p><div class="verbatim-wrap"><pre class="screen">(hd1)  /dev/disk-by-id/<em class="replaceable ">DISK3 ID</em>
(hd2)  /dev/disk-by-id/<em class="replaceable ">DISK1 ID</em>
(hd3)  /dev/disk-by-id/<em class="replaceable ">DISK2 ID</em></pre></div></div><div class="sect2 " id="sec.grub2.menu_change"><div class="titlepage"><div><div><h3 class="title" id="sec.grub2.menu_change"><span class="number">12.2.5 </span><span class="name">Editing Menu Entries during the Boot Procedure</span> <a title="Permalink" class="permalink" href="#sec.grub2.menu_change">#</a></h3></div></div></div><p>
    Being able to directly edit menu entries is useful when the system does not
    boot anymore because of a faulty configuration. It can also be used to test
    new settings without altering the system configuration.
   </p><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
      In the graphical boot menu, select the entry you want to edit with the
      arrow keys.
     </p></li><li class="step "><p>
      Press <span class="keycap">E</span> to open the text-based editor.
     </p></li><li class="step "><p>
      Use the arrow keys to move to the line you want to edit.
     </p><div class="figure" id="fig.grub2.boot.editor"><div class="figure-contents"><div class="mediaobject"><a xmlns="" href="images/grub2_edit_config.png"><img src="images/grub2_edit_config.png" width="" alt="GRUB 2 Boot Editor" /></a></div></div><div class="figure-title-wrap"><h6 class="figure-title"><span class="number">Figure 12.1: </span><span class="name">GRUB 2 Boot Editor </span><a title="Permalink" class="permalink" href="#fig.grub2.boot.editor">#</a></h6></div></div><p>
      Now you have two options:
     </p><ol type="a" class="substeps "><li class="step "><p>
        Add space-separated parameters to the end of the line starting with
        <code class="literal">linux</code> or <code class="literal">linuxefi</code> to edit the
        kernel parameters. A complete list of parameters is available at
        <a class="link" href="http://en.opensuse.org/Linuxrc" target="_blank">http://en.opensuse.org/Linuxrc</a>.
       </p></li><li class="step "><p>
        Or edit the general options to change for example the kernel version.
        The <span class="keycap">→|</span> key suggests all possible completions.
       </p></li></ol></li><li class="step "><p>
      Press <span class="keycap">F10</span> to boot the system with the changes you made
      or press <span class="keycap">Esc</span> to discard your edits and return to
      the GRUB 2 menu.
     </p></li></ol></div></div><p>
    Changes made this way only apply to the current boot process and are not
    saved permanently.
   </p><div id="idm140019139931648" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.png" /><h6>Important: Keyboard Layout During the Boot Procedure</h6><p>
     The US keyboard layout is the only one available when booting. See
     <span class="intraxref">Book “<em class="citetitle ">Start-Up</em>”, Chapter 4 “Troubleshooting”, Section 4.3 “Booting from Installation Media Fails”, US Keyboard Layout</span>.
    </p></div><div id="idm140019139929632" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note: Boot Loader on the Installation Media</h6><p>
     The Boot Loader of the installation media on systems with a traditional
     BIOS is still GRUB Legacy. To add boot parameters, select an entry and start
     typing. Additions you make to the installation boot entry will be
     permanently saved in the installed system.
    </p></div></div><div class="sect2 " id="sec.grub2.password"><div class="titlepage"><div><div><h3 class="title" id="sec.grub2.password"><span class="number">12.2.6 </span><span class="name">Setting a Boot Password</span> <a title="Permalink" class="permalink" href="#sec.grub2.password">#</a></h3></div></div></div><p>
    Even before the operating system is booted, GRUB 2 enables access to file
    systems. Users without root permissions can access files in your Linux
    system to which they have no access after the system is booted. To block
    this kind of access or to prevent users from booting certain menu entries,
    set a boot password.
   </p><div id="idm140019139925632" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.png" /><h6>Important: Booting Requires Password</h6><p>
     If set, the boot password is required on every boot, which means the
     system does not boot automatically.
    </p></div><p>
    Proceed as follows to set a boot password. Alternatively use YaST
    (<a class="xref" href="#vle.grub2.yast2.boot.password"><span class="guimenu">Protect Boot Loader with Password</span>
     </a>).
   </p><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
      Encrypt the password using <code class="command">grub2-mkpasswd-pbkdf2:</code>
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> grub2-mkpasswd-pbkdf2
Password: ****
Reenter password: ****
PBKDF2 hash of your password is grub.pbkdf2.sha512.10000.9CA4611006FE96BC77A...</pre></div></li><li class="step "><p>
      Paste the resulting string into the file
      <code class="filename">/etc/grub.d/40_custom</code> together with the <code class="command">set
      superusers</code> command.
     </p><div class="verbatim-wrap"><pre class="screen">set superusers="root"
password_pbkdf2 root grub.pbkdf2.sha512.10000.9CA4611006FE96BC77A...</pre></div></li><li class="step "><p>
      Run <a class="xref" href="#vle.grub2.mkconfig"><code class="command">grub2-mkconfig</code>
    </a> to import the changes into the
      main configuration file.
     </p></li></ol></div></div><p>
    After you reboot, you will be prompted for a user name and a password when
    trying to boot a menu entry. Enter <code class="literal">root</code> and the password
    you typed during the <code class="command">grub2-mkpasswd-pbkdf2</code> command. If
    the credentials are correct, the system will boot the selected boot entry.
   </p><p>
    For more information, see
    <a class="link" href="https://www.gnu.org/software/grub/manual/grub.html#Security" target="_blank">https://www.gnu.org/software/grub/manual/grub.html#Security</a>.
   </p></div></div><div class="sect1 " id="sec.grub2.yast2.config"><div class="titlepage"><div><div><h2 class="title" id="sec.grub2.yast2.config"><span class="number">12.3 </span><span class="name">Configuring the Boot Loader with YaST</span> <a title="Permalink" class="permalink" href="#sec.grub2.yast2.config">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">Filename: </span>grub2_yast_i.xml</li><li><span class="ds-label">ID: </span>sec.grub2.yast2.config</li></ul></div></div></div></div><p>
  The easiest way to configure general options of the boot loader in your
  <span class="productname"><span class="phrase">openSUSE Leap</span></span> system is to use the YaST module. In the <span class="guimenu">YaST Control Center</span>, select
  <span class="guimenu">System</span> › <span class="guimenu">Boot
  Loader</span>. The module shows the current boot loader
  configuration of your system and allows you to make changes.
 </p><p>
  Use the <span class="guimenu">Boot Code Options</span> tab to view and change settings
  related to type, location and advanced loader settings. You can choose
  whether to use GRUB 2 in standard or EFI mode.
 </p><div class="figure" id="fig.grub2.yast.boot.code.options0"><div class="figure-contents"><div class="mediaobject"><a xmlns="" href="images/yast2_bootloader_boot_code.png"><img src="images/yast2_bootloader_boot_code.png" width="" alt="Boot Code Options" /></a></div></div><div class="figure-title-wrap"><h6 class="figure-title"><span class="number">Figure 12.2: </span><span class="name">Boot Code Options </span><a title="Permalink" class="permalink" href="#fig.grub2.yast.boot.code.options0">#</a></h6></div></div><div id="idm140019139899360" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.png" /><h6>Important: EFI Systems require GRUB2-EFI</h6><p>
   If you have an EFI system you can only install GRUB2-EFI, otherwise your
   system is no longer bootable.
  </p></div><div id="idm140019139897904" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.png" /><h6>Important: Reinstalling the Boot Loader</h6><p>
   To reinstall the boot loader, make sure to change a setting in YaST and
   then change it back. For example, to reinstall GRUB2-EFI, select
   <span class="guimenu">GRUB2</span> first and then immediately switch back to
   <span class="guimenu">GRUB2-EFI</span>.
  </p><p>
   Otherwise, the boot loader may only be partially reinstalled.
  </p></div><div id="idm140019139894992" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note: Custom Boot Loader</h6><p>
   To use a boot loader other than the ones listed, select <span class="guimenu">Do Not
   Install Any Boot Loader</span>. Read the documentation of your boot
   loader carefully before choosing this option.
  </p></div><div class="sect2 " id="sec.grub2.yast2.location"><div class="titlepage"><div><div><h3 class="title" id="sec.grub2.yast2.location"><span class="number">12.3.1 </span><span class="name">Boot Loader Location and Boot Code Options</span> <a title="Permalink" class="permalink" href="#sec.grub2.yast2.location">#</a></h3></div></div></div><p>
   The default location of the boot loader depends on the partition setup and
   is either the Master Boot Record (MBR) or the boot sector of the
   <code class="filename">/</code> partition. To modify the location of the boot loader,
   follow these steps:
  </p><div class="procedure " id="pro.sec.grub2.yast2.location"><div class="procedure-title-wrap"><h6 class="procedure-title"><span class="number">Procedure 12.1: </span><span class="name">Changing the Boot Loader Location </span><a title="Permalink" class="permalink" href="#pro.sec.grub2.yast2.location">#</a></h6></div><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
     Select the <span class="guimenu">Boot Code Options</span> tab and then choose one of
     the following options for <span class="guimenu">Boot Loader Location</span>:
    </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019139887552"><span class="term "><span class="guimenu">Boot from Master Boot Record</span>
      </span></dt><dd><p>
        This installs the boot loader in the MBR of the disk containing the
        directory <code class="filename">/boot</code>. Usually this will be the disk
        mounted to <code class="filename">/</code>, but if <code class="filename">/boot</code> is
        mounted to a separate partition on a different disk, the MBR of that
        disk will be used.
       </p></dd><dt id="idm140019139883904"><span class="term "><span class="guimenu">Boot from Root Partition</span>
      </span></dt><dd><p>
        This installs the boot loader in the boot sector of the
        <code class="filename">/</code> partition.
       </p></dd><dt id="idm140019139881296"><span class="term "><span class="guimenu">Custom Boot Partition</span>
      </span></dt><dd><p>
        Use this option to specify the location of the boot loader manually.
       </p></dd></dl></div></li><li class="step "><p>
     Click <span class="guimenu">OK</span> to apply your changes.
    </p></li></ol></div></div><div class="figure" id="fig.grub2.yast.boot.code.options"><div class="figure-contents"><div class="mediaobject"><a xmlns="" href="images/yast2_bootloader_boot_code.png"><img src="images/yast2_bootloader_boot_code.png" width="" alt="Code Options" /></a></div></div><div class="figure-title-wrap"><h6 class="figure-title"><span class="number">Figure 12.3: </span><span class="name">Code Options </span><a title="Permalink" class="permalink" href="#fig.grub2.yast.boot.code.options">#</a></h6></div></div><p>
   The <span class="guimenu">Boot Code Options</span> tab includes the following
   additional options:
  </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019139870608"><span class="term "><span class="guimenu">Set Active Flag in Partition Table for Boot
      Partition</span>
     </span></dt><dd><p>
       Activates <span class="phrase">the partition that contains the
        <code class="filename">/boot</code> directory</span>. Use this option on systems with old BIOS and/or
       legacy operating systems because they may fail to boot from a non-active
       partition. It is safe to leave this option active.
      </p></dd><dt id="idm140019139867104"><span class="term "><span class="guimenu">Write Generic Boot Code to MBR</span>
     </span></dt><dd><p>
       If MBR contains a custom 'non-GRUB' code, this option replaces it with a
       generic, operating system independent code. If you deactivate this
       option, the system may become unbootable.
      </p></dd><dt id="idm140019139864816"><span class="term "><span class="guimenu">Enable Trusted Boot Support</span>
     </span></dt><dd><p>
       Starts TrustedGRUB2 which supports trusted computing functionality
       (Trusted Platform Module (TPM)). For more information refer to
       <a class="link" href="https://github.com/Sirrix-AG/TrustedGRUB2" target="_blank">https://github.com/Sirrix-AG/TrustedGRUB2</a>.
      </p></dd></dl></div></div><div class="sect2 " id="sec.grub2.yast2.config.order"><div class="titlepage"><div><div><h3 class="title" id="sec.grub2.yast2.config.order"><span class="number">12.3.2 </span><span class="name">Adjusting the Disk Order</span> <a title="Permalink" class="permalink" href="#sec.grub2.yast2.config.order">#</a></h3></div></div></div><p>
   If your computer has more than one hard disk, you can specify the boot
   sequence of the disks. The first disk in the list is where GRUB 2 will be
   installed in the case of booting from MBR. It is the disk where <span class="productname"><span class="phrase">openSUSE Leap</span></span>
   is installed by default. The rest of the list is a hint for
   GRUB 2's device mapper (see <a class="xref" href="#sec.grub2.map" title="12.2.4. Mapping between BIOS Drives and Linux Devices">Section 12.2.4, “Mapping between BIOS Drives and Linux Devices”</a>).
  </p><div id="idm140019139858032" class="admonition warning normal"><img class="symbol" alt="Warning" title="Warning" src="static/images/icon-warning.png" /><h6>Warning: Unbootable System</h6><p>
    The default value is usually valid for almost all deployments. If you change
    the boot order of disks wrongly, the system may become unbootable on the
    next reboot. For example, if the first disk in the list is not part of BIOS
    boot order, and the other disk in the list have empty MBRs.
   </p></div><div class="procedure " id="pro.sec.grub2.yast2.config.order"><div class="procedure-title-wrap"><h6 class="procedure-title"><span class="number">Procedure 12.2: </span><span class="name">Setting the Disk Order </span><a title="Permalink" class="permalink" href="#pro.sec.grub2.yast2.config.order">#</a></h6></div><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
     Open the <span class="guimenu">Boot Code Options</span> tab.
    </p></li><li class="step "><p>
     Click <span class="guimenu">Edit Disk Boot Order</span>.
    </p></li><li class="step "><p>
     If more than one disk is listed, select a disk and click
     <span class="guimenu">Up</span> or <span class="guimenu">Down</span> to reorder the displayed
     disks.
    </p></li><li class="step "><p>
     Click <span class="guimenu">OK</span> two times to save the changes.
    </p></li></ol></div></div></div><div class="sect2 " id="sec.grub2.yast2.config.advanced"><div class="titlepage"><div><div><h3 class="title" id="sec.grub2.yast2.config.advanced"><span class="number">12.3.3 </span><span class="name">Configuring Advanced Options</span> <a title="Permalink" class="permalink" href="#sec.grub2.yast2.config.advanced">#</a></h3></div></div></div><p>
   Advanced boot parameters can be configured via the <span class="guimenu">Boot Loader
   Options</span> tab.
  </p><div class="sect3 " id="sec.grub2.yast2.config.advanced.boot-loader"><div class="titlepage"><div><div><h4 class="title" id="sec.grub2.yast2.config.advanced.boot-loader"><span class="number">12.3.3.1 </span><span class="name"><span class="guimenu">Boot Loader Options</span> Tab</span> <a title="Permalink" class="permalink" href="#sec.grub2.yast2.config.advanced.boot-loader">#</a></h4></div></div></div><div class="figure" id="fig.grub2.yast.bootloader.options"><div class="figure-contents"><div class="mediaobject"><a xmlns="" href="images/yast2_bootloader_options.png"><img src="images/yast2_bootloader_options.png" width="" alt="Boot loader Options" /></a></div></div><div class="figure-title-wrap"><h6 class="figure-title"><span class="number">Figure 12.4: </span><span class="name">Boot loader Options </span><a title="Permalink" class="permalink" href="#fig.grub2.yast.bootloader.options">#</a></h6></div></div><div class="variablelist "><dl class="variablelist"><dt id="idm140019139839584"><span class="term "><span class="guimenu">Boot Loader Time-Out</span>
     </span></dt><dd><p>
       Change the value of <span class="guimenu">Time-Out in Seconds</span> by typing in
       a new value and clicking the appropriate arrow key with your mouse.
      </p></dd><dt id="idm140019139836960"><span class="term "><span class="guimenu">Probe Foreign OS</span>
     </span></dt><dd><p>
       When selected, the boot loader searches for other systems like Windows
       or other Linux installations.
      </p></dd><dt id="idm140019139834768"><span class="term "><span class="guimenu">Hide Menu on Boot</span>
     </span></dt><dd><p>
       Hides the boot menu and boots the default entry.
      </p></dd><dt id="idm140019139832640"><span class="term "><span class="guimenu">Adjusting the Default Boot Entry</span>
     </span></dt><dd><p>
       Select the desired entry from the <span class="quote">“<span class="quote">Default Boot Section</span>”</span>
       list. Note that the <span class="quote">“<span class="quote">&gt;</span>”</span> sign in the boot entry name
       delimits the boot section and its subsection.
      </p></dd><dt id="vle.grub2.yast2.boot.password"><span class="term "><span class="guimenu">Protect Boot Loader with Password</span>
     </span></dt><dd><p>
       Protects the boot loader and the system with an additional password. For
       more information, see <a class="xref" href="#sec.grub2.password" title="12.2.6. Setting a Boot Password">Section 12.2.6, “Setting a Boot Password”</a>.
      </p></dd></dl></div></div><div class="sect3 " id="sec.grub2.yast2.config.advanced.kernel_parameters"><div class="titlepage"><div><div><h4 class="title" id="sec.grub2.yast2.config.advanced.kernel_parameters"><span class="number">12.3.3.2 </span><span class="name"><span class="guimenu">Kernel Parameters</span> Tab</span> <a title="Permalink" class="permalink" href="#sec.grub2.yast2.config.advanced.kernel_parameters">#</a></h4></div></div></div><div class="figure" id="fig.grub2.yast.kernel.parameters"><div class="figure-contents"><div class="mediaobject"><a xmlns="" href="images/yast2_bootloader_kernel_parameters.png"><img src="images/yast2_bootloader_kernel_parameters.png" width="" alt="Kernel Parameters" /></a></div></div><div class="figure-title-wrap"><h6 class="figure-title"><span class="number">Figure 12.5: </span><span class="name">Kernel Parameters </span><a title="Permalink" class="permalink" href="#fig.grub2.yast.kernel.parameters">#</a></h6></div></div><div class="variablelist "><dl class="variablelist"><dt id="idm140019139818688"><span class="term "><span class="guimenu">Console resolution</span>
     </span></dt><dd><p>
       The <span class="guimenu">Console resolution</span> option specifies the default
       screen resolution during the boot process.
      </p></dd><dt id="idm140019139816096"><span class="term "><span class="guimenu">Kernel Command Line Parameter</span>
     </span></dt><dd><p>
       The optional kernel parameters are added at the end of the default
       parameters. For a list of all possible parameters, see
       <a class="link" href="http://en.opensuse.org/Linuxrc" target="_blank">http://en.opensuse.org/Linuxrc</a>.
      </p></dd><dt id="idm140019139813296"><span class="term "><span class="guimenu">Use graphical console</span>
     </span></dt><dd><p>
       When checked, the boot menu appears on a graphical splash screen rather
       than in a text mode. The resolution of the boot screen can be then set
       from the <span class="guimenu">Console resolution</span> list, and graphical theme
       definition file can be specified with the <span class="guimenu">Console
       theme</span> file-chooser.
      </p></dd><dt id="idm140019139810096"><span class="term "><span class="guimenu">Use Serial Console</span>
     </span></dt><dd><p>
       If your machine is controlled via a serial console, activate this option
       and specify which COM port to use at which speed. See <code class="command">info
       grub</code> or
       <a class="link" href="http://www.gnu.org/software/grub/manual/grub.html#Serial-terminal" target="_blank">http://www.gnu.org/software/grub/manual/grub.html#Serial-terminal</a>
      </p></dd></dl></div></div></div></div><div class="sect1 " id="sec.grub2.zseries"><div class="titlepage"><div><div><h2 class="title" id="sec.grub2.zseries"><span class="number">12.4 </span><span class="name">Differences in Terminal Usage on IBM Z</span> <a title="Permalink" class="permalink" href="#sec.grub2.zseries">#</a></h2></div></div></div><p>
   On 3215 and 3270 terminals there are some differences and limitations on how
   to move the cursor and how to issue editing commands within GRUB 2.
  </p><div class="sect2 " id="sec.grub2.zseries.limitations"><div class="titlepage"><div><div><h3 class="title" id="sec.grub2.zseries.limitations"><span class="number">12.4.1 </span><span class="name">Limitations</span> <a title="Permalink" class="permalink" href="#sec.grub2.zseries.limitations">#</a></h3></div></div></div><div class="variablelist "><dl class="variablelist"><dt id="idm140019139802752"><span class="term ">Interactivity</span></dt><dd><p>
       Interactivity is strongly limited. Typing often does not result in
       visual feedback. To see where the cursor is, type an underscore
       (<span class="keycap">_</span>).
      </p><div id="idm140019139800688" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note: 3270 Compared to 3215</h6><p>
        The 3270 terminal is much better at displaying and refreshing screens
        than the 3215 terminal.
       </p></div></dd><dt id="idm140019139798928"><span class="term ">Cursor Movement</span></dt><dd><p>
       <span class="quote">“<span class="quote">Traditional</span>”</span> cursor movement is not possible.
       <span class="keycap">Alt</span>, <span class="keycap">Meta</span>,
       <span class="keycap">Ctrl</span> and the cursor keys do not work. To move
       the cursor, use the key combinations listed in
       <a class="xref" href="#sec.grub2.zseries.keys" title="12.4.2. Key Combinations">Section 12.4.2, “Key Combinations”</a>.
      </p></dd><dt id="idm140019139794336"><span class="term ">Caret</span></dt><dd><p>
       The caret (<span class="keycap">^</span>) is used as a control character. To type a
       literal <span class="keycap">^</span> followed by a letter, type
       <span class="keycap">^</span>, <span class="keycap">^</span>,
       <em class="replaceable ">LETTER</em>.
      </p></dd><dt id="idm140019139790288"><span class="term ">Enter</span></dt><dd><p>
       The <span class="keycap">Enter</span> key does not work, use
       <span class="keycap">^</span><span class="key-connector">–</span><span class="keycap">J</span> instead.
      </p></dd></dl></div></div><div class="sect2 " id="sec.grub2.zseries.keys"><div class="titlepage"><div><div><h3 class="title" id="sec.grub2.zseries.keys"><span class="number">12.4.2 </span><span class="name">Key Combinations</span> <a title="Permalink" class="permalink" href="#sec.grub2.zseries.keys">#</a></h3></div></div></div><div class="informaltable"><table border="1"><colgroup><col /><col /><col /></colgroup><tbody><tr><td rowspan="3" valign="top">
        <p>
         Common Substitutes:
        </p>
       </td><td>
        <p>
         <span class="keycap">^</span><span class="key-connector">–</span><span class="keycap">J</span>
        </p>
       </td><td>
        <p>
         engage (<span class="quote">“<span class="quote">Enter</span>”</span>)
        </p>
       </td></tr><tr><td>
        <p>
         <span class="keycap">^</span><span class="key-connector">–</span><span class="keycap">L</span>
        </p>
       </td><td>
        <p>
         abort, return to previous <span class="quote">“<span class="quote">state</span>”</span>
        </p>
       </td></tr><tr><td>
        <p>
         <span class="keycap">^</span><span class="key-connector">–</span><span class="keycap">I</span>
        </p>
       </td><td>
        <p>
         tab completion (in edit and shell mode)
        </p>
       </td></tr><tr><td rowspan="9" valign="top">
        <p>
         Keys Available in Menu Mode:
        </p>
       </td><td>
        <p>
         <span class="keycap">^</span><span class="key-connector">–</span><span class="keycap">A</span>
        </p>
       </td><td>
        <p>
         first entry
        </p>
       </td></tr><tr><td>
        <p>
         <span class="keycap">^</span><span class="key-connector">–</span><span class="keycap">E</span>
        </p>
       </td><td>
        <p>
         last entry
        </p>
       </td></tr><tr><td>
        <p>
         <span class="keycap">^</span><span class="key-connector">–</span><span class="keycap">P</span>
        </p>
       </td><td>
        <p>
         previous entry
        </p>
       </td></tr><tr><td>
        <p>
         <span class="keycap">^</span><span class="key-connector">–</span><span class="keycap">N</span>
        </p>
       </td><td>
        <p>
         next entry
        </p>
       </td></tr><tr><td>
        <p>
         <span class="keycap">^</span><span class="key-connector">–</span><span class="keycap">G</span>
        </p>
       </td><td>
        <p>
         previous page
        </p>
       </td></tr><tr><td>
        <p>
         <span class="keycap">^</span><span class="key-connector">–</span><span class="keycap">C</span>
        </p>
       </td><td>
        <p>
         next page
        </p>
       </td></tr><tr><td>
        <p>
         <span class="keycap">^</span><span class="key-connector">–</span><span class="keycap">F</span>
        </p>
       </td><td>
        <p>
         boot selected entry or enter submenu (same as
         <span class="keycap">^</span><span class="key-connector">–</span><span class="keycap">J</span>)
        </p>
       </td></tr><tr><td>
        <p>
         <span class="keycap">E</span>
        </p>
       </td><td>
        <p>
         edit selected entry
        </p>
       </td></tr><tr><td>
        <p>
         <span class="keycap">C</span>
        </p>
       </td><td>
        <p>
         enter GRUB-Shell
        </p>
       </td></tr><tr><td rowspan="14" valign="top">
        <p>
         Keys Available in Edit Mode:
        </p>
       </td><td>
        <p>
         <span class="keycap">^</span><span class="key-connector">–</span><span class="keycap">P</span>
        </p>
       </td><td>
        <p>
         previous line
        </p>
       </td></tr><tr><td>
        <p>
         <span class="keycap">^</span><span class="key-connector">–</span><span class="keycap">N</span>
        </p>
       </td><td>
        <p>
         next line
        </p>
       </td></tr><tr><td>
        <p>
         <span class="keycap">^</span><span class="key-connector">–</span><span class="keycap">B</span>
        </p>
       </td><td>
        <p>
         backward char
        </p>
       </td></tr><tr><td>
        <p>
         <span class="keycap">^</span><span class="key-connector">–</span><span class="keycap">F</span>
        </p>
       </td><td>
        <p>
         forward char
        </p>
       </td></tr><tr><td>
        <p>
         <span class="keycap">^</span><span class="key-connector">–</span><span class="keycap">A</span>
        </p>
       </td><td>
        <p>
         beginning of line
        </p>
       </td></tr><tr><td>
        <p>
         <span class="keycap">^</span><span class="key-connector">–</span><span class="keycap">E</span>
        </p>
       </td><td>
        <p>
         end of line
        </p>
       </td></tr><tr><td>
        <p>
         <span class="keycap">^</span><span class="key-connector">–</span><span class="keycap">H</span>
        </p>
       </td><td>
        <p>
         backspace
        </p>
       </td></tr><tr><td>
        <p>
         <span class="keycap">^</span><span class="key-connector">–</span><span class="keycap">D</span>
        </p>
       </td><td>
        <p>
         delete
        </p>
       </td></tr><tr><td>
        <p>
         <span class="keycap">^</span><span class="key-connector">–</span><span class="keycap">K</span>
        </p>
       </td><td>
        <p>
         kill line
        </p>
       </td></tr><tr><td>
        <p>
         <span class="keycap">^</span><span class="key-connector">–</span><span class="keycap">Y</span>
        </p>
       </td><td>
        <p>
         yank
        </p>
       </td></tr><tr><td>
        <p>
         <span class="keycap">^</span><span class="key-connector">–</span><span class="keycap">O</span>
        </p>
       </td><td>
        <p>
         open line
        </p>
       </td></tr><tr><td>
        <p>
         <span class="keycap">^</span><span class="key-connector">–</span><span class="keycap">L</span>
        </p>
       </td><td>
        <p>
         refresh screen
        </p>
       </td></tr><tr><td>
        <p>
         <span class="keycap">^</span><span class="key-connector">–</span><span class="keycap">X</span>
        </p>
       </td><td>
        <p>
         boot entry
        </p>
       </td></tr><tr><td>
        <p>
         <span class="keycap">^</span><span class="key-connector">–</span><span class="keycap">C</span>
        </p>
       </td><td>
        <p>
         enter GRUB-Shell
        </p>
       </td></tr><tr><td rowspan="11" valign="top">
        <p>
         Keys Available in Command Line Mode:
        </p>
       </td><td>
        <p>
         <span class="keycap">^</span><span class="key-connector">–</span><span class="keycap">P</span>
        </p>
       </td><td>
        <p>
         previous command
        </p>
       </td></tr><tr><td>
        <p>
         <span class="keycap">^</span><span class="key-connector">–</span><span class="keycap">N</span>
        </p>
       </td><td>
        <p>
         next command from history
        </p>
       </td></tr><tr><td>
        <p>
         <span class="keycap">^</span><span class="key-connector">–</span><span class="keycap">A</span>
        </p>
       </td><td>
        <p>
         beginning of line
        </p>
       </td></tr><tr><td>
        <p>
         <span class="keycap">^</span><span class="key-connector">–</span><span class="keycap">E</span>
        </p>
       </td><td>
        <p>
         end of line
        </p>
       </td></tr><tr><td>
        <p>
         <span class="keycap">^</span><span class="key-connector">–</span><span class="keycap">B</span>
        </p>
       </td><td>
        <p>
         backward char
        </p>
       </td></tr><tr><td>
        <p>
         <span class="keycap">^</span><span class="key-connector">–</span><span class="keycap">F</span>
        </p>
       </td><td>
        <p>
         forward char
        </p>
       </td></tr><tr><td>
        <p>
         <span class="keycap">^</span><span class="key-connector">–</span><span class="keycap">H</span>
        </p>
       </td><td>
        <p>
         backspace
        </p>
       </td></tr><tr><td>
        <p>
         <span class="keycap">^</span><span class="key-connector">–</span><span class="keycap">D</span>
        </p>
       </td><td>
        <p>
         delete
        </p>
       </td></tr><tr><td>
        <p>
         <span class="keycap">^</span><span class="key-connector">–</span><span class="keycap">K</span>
        </p>
       </td><td>
        <p>
         kill line
        </p>
       </td></tr><tr><td>
        <p>
         <span class="keycap">^</span><span class="key-connector">–</span><span class="keycap">U</span>
        </p>
       </td><td>
        <p>
         discard line
        </p>
       </td></tr><tr><td>
        <p>
         <span class="keycap">^</span><span class="key-connector">–</span><span class="keycap">Y</span>
        </p>
       </td><td>
        <p>
         yank
        </p>
       </td></tr></tbody></table></div></div></div><div class="sect1 " id="sec.grub2.commands"><div class="titlepage"><div><div><h2 class="title" id="sec.grub2.commands"><span class="number">12.5 </span><span class="name">Helpful GRUB 2 Commands</span> <a title="Permalink" class="permalink" href="#sec.grub2.commands">#</a></h2></div></div></div><div class="variablelist "><dl class="variablelist"><dt id="vle.grub2.mkconfig"><span class="term "><code class="command">grub2-mkconfig</code>
    </span></dt><dd><p>
      Generates a new <code class="filename">/boot/grub2/grub.cfg</code> based on
      <code class="filename">/etc/default/grub</code> and the scripts from
      <code class="filename">/etc/grub.d/</code>.
     </p><div class="example" id="idm140019139655760"><div class="example-title-wrap"><h6 class="example-title"><span class="number">Example 12.1: </span><span class="name">Usage of grub2-mkconfig </span><a title="Permalink" class="permalink" href="#idm140019139655760">#</a></h6></div><div class="example-contents"><div class="verbatim-wrap"><pre class="screen">grub2-mkconfig -o /boot/grub2/grub.cfg</pre></div></div></div><div id="idm140019139654400" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.png" /><h6>Tip: Syntax Check</h6><p>
       Running <code class="command">grub2-mkconfig</code> without any parameters prints
       the configuration to STDOUT where it can be reviewed. Use
       <a class="xref" href="#vle.grub2.script_check"><code class="command">grub2-script-check</code>
    </a> after
       <code class="filename">/boot/grub2/grub.cfg</code> has been written to check its
       syntax.
      </p></div><div id="idm140019139651488" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.png" /><h6>Important: <code class="command">grub2-mkconfig</code> Cannot Repair UEFI Secure Boot Tables</h6><p>
       If you are using UEFI Secure Boot and your system is not reaching GRUB 2
       correctly anymore, you may need to additionally reinstall Shim and
       regenerate the UEFI boot table. To do so, use:
      </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>shim-install --config-file=/boot/grub2/grub.cfg</pre></div></div></dd><dt id="vle.grub2.mkrescue"><span class="term "><code class="command">grub2-mkrescue</code></span></dt><dd><p>
      Creates a bootable rescue image of your installed GRUB 2 configuration.
     </p><div class="example" id="idm140019139646176"><div class="example-title-wrap"><h6 class="example-title"><span class="number">Example 12.2: </span><span class="name">Usage of grub2-mkrescue </span><a title="Permalink" class="permalink" href="#idm140019139646176">#</a></h6></div><div class="example-contents"><div class="verbatim-wrap"><pre class="screen">grub2-mkrescue -o save_path/name.iso iso</pre></div></div></div></dd><dt id="vle.grub2.script_check"><span class="term "><code class="command">grub2-script-check</code>
    </span></dt><dd><p>
      Checks the given file for syntax errors.
     </p><div class="example" id="idm140019139642256"><div class="example-title-wrap"><h6 class="example-title"><span class="number">Example 12.3: </span><span class="name">Usage of grub2-script-check </span><a title="Permalink" class="permalink" href="#idm140019139642256">#</a></h6></div><div class="example-contents"><div class="verbatim-wrap"><pre class="screen">grub2-script-check /boot/grub2/grub.cfg</pre></div></div></div></dd><dt id="idm140019139640560"><span class="term "><code class="command">grub2-once</code>
    </span></dt><dd><p>
      Set the default boot entry for the next boot only. To get the list of
      available boot entries use the <code class="option">--list</code> option.
     </p><div class="example" id="idm140019139638256"><div class="example-title-wrap"><h6 class="example-title"><span class="number">Example 12.4: </span><span class="name">Usage of grub2-once </span><a title="Permalink" class="permalink" href="#idm140019139638256">#</a></h6></div><div class="example-contents"><div class="verbatim-wrap"><pre class="screen">grub2-once number_of_the_boot_entry</pre></div></div></div><div id="idm140019139636896" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.png" /><h6>Tip: <code class="command">grub2-once</code> Help</h6><p>
       Call the program without any option to get a full list of all possible
       options.
      </p></div></dd></dl></div></div><div class="sect1 " id="sec.grub2.info"><div class="titlepage"><div><div><h2 class="title" id="sec.grub2.info"><span class="number">12.6 </span><span class="name">More Information</span> <a title="Permalink" class="permalink" href="#sec.grub2.info">#</a></h2></div></div></div><p>
   Extensive information about GRUB 2 is available at <a class="link" href="http://www.gnu.org/software/grub/" target="_blank">http://www.gnu.org/software/grub/</a>. Also refer to the
   <code class="command">grub</code> info page. 
  </p></div></div><div class="chapter " id="cha.network"><div class="titlepage"><div><div><h2 class="title"><span class="number">13 </span><span class="name">Basic Networking</span> <a title="Permalink" class="permalink" href="#cha.network">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">Filename: </span>net_basic.xml</li><li><span class="ds-label">ID: </span>cha.network</li></ul></div></div><div><div class="abstract"><div class="abstract-title-wrap"><h6 class="abstract-title">Abstract<a title="Permalink" class="permalink" href="#idm140019139628880">#</a></h6></div><p>
    Linux offers the necessary networking tools and features for integration
    into all types of network structures. Network access using a network card
    can be configured with YaST. Manual configuration is also possible. In
    this chapter only the fundamental mechanisms and the relevant network
    configuration files are covered.
   </p></div></div></div></div><div class="line"><div class="toc"><dl><dt><span class="sect1"><a href="#sec.network.addresses"><span class="number">13.1 </span><span class="name">IP Addresses and Routing</span></a></span></dt><dt><span class="sect1"><a href="#sec.network.ipv6"><span class="number">13.2 </span><span class="name">IPv6—The Next Generation Internet</span></a></span></dt><dt><span class="sect1"><a href="#sec.network.nameres"><span class="number">13.3 </span><span class="name">Name Resolution</span></a></span></dt><dt><span class="sect1"><a href="#sec.network.yast"><span class="number">13.4 </span><span class="name">Configuring a Network Connection with YaST</span></a></span></dt><dt><span class="sect1"><a href="#sec.network.nm"><span class="number">13.5 </span><span class="name">NetworkManager</span></a></span></dt><dt><span class="sect1"><a href="#sec.network.manconf"><span class="number">13.6 </span><span class="name">Configuring a Network Connection Manually</span></a></span></dt><dt><span class="sect1"><a href="#sec.network.router"><span class="number">13.7 </span><span class="name">Basic Router Setup</span></a></span></dt><dt><span class="sect1"><a href="#sec.network.iface-bonding"><span class="number">13.8 </span><span class="name">Setting Up Bonding Devices</span></a></span></dt><dt><span class="sect1"><a href="#sec.network.iface-teaming"><span class="number">13.9 </span><span class="name">Setting Up Team Devices for Network Teaming</span></a></span></dt><dt><span class="sect1"><a href="#sec.network.openvswitch"><span class="number">13.10 </span><span class="name">Software-Defined Networking with <span class="productname">Open vSwitch</span></span></a></span></dt></dl></div></div><p>
  Linux and other Unix operating systems use the TCP/IP protocol. It is not a
  single network protocol, but a family of network protocols that offer various
  services. The protocols listed in <a class="xref" href="#tab.net.basic.tcpproto" title="Several Protocols in the TCP/IP Protocol Family">Several Protocols in the TCP/IP Protocol Family</a>,
  are provided for exchanging data between two machines via TCP/IP. Networks
  combined by TCP/IP, comprising a worldwide network, are also called
  <span class="quote">“<span class="quote">the Internet.</span>”</span>
 </p><p>
  RFC stands for <span class="emphasis"><em>Request for Comments</em></span>. RFCs are documents
  that describe various Internet protocols and implementation procedures for
  the operating system and its applications. The RFC documents describe the
  setup of Internet protocols. For more information about RFCs, see
  <a class="link" href="http://www.ietf.org/rfc.html" target="_blank">http://www.ietf.org/rfc.html</a>.
 </p><div class="variablelist " id="tab.net.basic.tcpproto"><div class="variablelist-title-wrap"><h6 class="variablelist-title"><span class="name">Several Protocols in the TCP/IP Protocol Family </span><a title="Permalink" class="permalink" href="#tab.net.basic.tcpproto">#</a></h6></div><dl class="variablelist"><dt id="idm140019139621504"><span class="term ">TCP</span></dt><dd><p>
     Transmission Control Protocol: a connection-oriented secure protocol. The
     data to transmit is first sent by the application as a stream of data and
     converted into the appropriate format by the operating system. The data
     arrives at the respective application on the destination host in the
     original data stream format it was initially sent. TCP determines whether
     any data has been lost or jumbled during the transmission. TCP is
     implemented wherever the data sequence matters.
    </p></dd><dt id="idm140019139619216"><span class="term ">UDP</span></dt><dd><p>
     User Datagram Protocol: a connectionless, insecure protocol. The data to
     transmit is sent in the form of packets generated by the application. The
     order in which the data arrives at the recipient is not guaranteed and
     data loss is possible. UDP is suitable for record-oriented applications.
     It features a smaller latency period than TCP.
    </p></dd><dt id="idm140019139617072"><span class="term ">ICMP</span></dt><dd><p>
     Internet Control Message Protocol: This is not a protocol for
     the end user, but a special control protocol that issues error reports and
     can control the behavior of machines participating in TCP/IP data
     transfer. In addition, it provides a special echo mode that can be viewed
     using the program ping.
    </p></dd><dt id="idm140019139614960"><span class="term ">IGMP</span></dt><dd><p>
     Internet Group Management Protocol: This protocol controls machine
     behavior when implementing IP multicast.
    </p></dd></dl></div><p>
  As shown in <a class="xref" href="#fig.net.basic.OSI" title="Simplified Layer Model for TCP/IP">Figure 13.1, “Simplified Layer Model for TCP/IP”</a>, data exchange takes place in
  different layers. The actual network layer is the insecure data transfer via
  IP (Internet protocol). On top of IP, TCP (transmission control protocol)
  guarantees, to a certain extent, security of the data transfer. The IP layer
  is supported by the underlying hardware-dependent protocol, such as Ethernet.
 </p><div class="figure" id="fig.net.basic.OSI"><div class="figure-contents"><div class="mediaobject"><a xmlns="" href="images/net_basic_osi.png"><img src="images/net_basic_osi.png" width="" alt="Simplified Layer Model for TCP/IP" /></a></div></div><div class="figure-title-wrap"><h6 class="figure-title"><span class="number">Figure 13.1: </span><span class="name">Simplified Layer Model for TCP/IP </span><a title="Permalink" class="permalink" href="#fig.net.basic.OSI">#</a></h6></div></div><p>
  The diagram provides one or two examples for each layer. The layers are
  ordered according to <span class="emphasis"><em>abstraction levels</em></span>. The lowest
  layer is very close to the hardware. The uppermost layer, however, is almost
  a complete abstraction from the hardware. Every layer has its own special
  function. The special functions of each layer are mostly implicit in their
  description. The data link and physical layers represent the physical network
  used, such as Ethernet.
 </p><p>
  Almost all hardware protocols work on a packet-oriented basis. The data to
  transmit is collected into <span class="emphasis"><em>packets</em></span> (it cannot be sent
  all at once). The maximum size of a TCP/IP packet is approximately 64 KB.
  Packets are normally quite smaller, as the network hardware can be a limiting
  factor. The maximum size of a data packet on an Ethernet is about fifteen
  hundred bytes. The size of a TCP/IP packet is limited to this amount when the
  data is sent over an Ethernet. If more data is transferred, more data packets
  need to be sent by the operating system.
 </p><p>
  For the layers to serve their designated functions, additional information
  regarding each layer must be saved in the data packet. This takes place in
  the <span class="emphasis"><em>header</em></span> of the packet. Every layer attaches a small
  block of data, called the protocol header, to the front of each emerging
  packet. A sample TCP/IP data packet traveling over an Ethernet cable is
  illustrated in <a class="xref" href="#fig.net.basic.TCPPaket" title="TCP/IP Ethernet Packet">Figure 13.2, “TCP/IP Ethernet Packet”</a>. The proof sum is
  located at the end of the packet, not at the beginning. This simplifies
  things for the network hardware.
 </p><div class="figure" id="fig.net.basic.TCPPaket"><div class="figure-contents"><div class="mediaobject"><a xmlns="" href="images/net_basic_tcppacket.png"><img src="images/net_basic_tcppacket.png" width="" alt="TCP/IP Ethernet Packet" /></a></div></div><div class="figure-title-wrap"><h6 class="figure-title"><span class="number">Figure 13.2: </span><span class="name">TCP/IP Ethernet Packet </span><a title="Permalink" class="permalink" href="#fig.net.basic.TCPPaket">#</a></h6></div></div><p>
  When an application sends data over the network, the data passes through each
  layer, all implemented in the Linux kernel except the physical layer. Each
  layer is responsible for preparing the data so it can be passed to the next
  layer. The lowest layer is ultimately responsible for sending the data. The
  entire procedure is reversed when data is received. Like the layers of an
  onion, in each layer the protocol headers are removed from the transported
  data. Finally, the transport layer is responsible for making the data
  available for use by the applications at the destination. In this manner, one
  layer only communicates with the layer directly above or below it. For
  applications, it is irrelevant whether data is transmitted via a 100 Mbit/s
  FDDI network or via a 56-Kbit/s modem line. Likewise, it is irrelevant for
  the data line which kind of data is transmitted, as long as packets are in
  the correct format.
 </p><div class="sect1 " id="sec.network.addresses"><div class="titlepage"><div><div><h2 class="title" id="sec.network.addresses"><span class="number">13.1 </span><span class="name">IP Addresses and Routing</span> <a title="Permalink" class="permalink" href="#sec.network.addresses">#</a></h2></div></div></div><p>
   The discussion in this section is limited to IPv4 networks. For information
   about IPv6 protocol, the successor to IPv4, refer to
   <a class="xref" href="#sec.network.ipv6" title="13.2. IPv6—The Next Generation Internet">Section 13.2, “IPv6—The Next Generation Internet”</a>.
  </p><div class="sect2 " id="sec.network.addresses.ip"><div class="titlepage"><div><div><h3 class="title" id="sec.network.addresses.ip"><span class="number">13.1.1 </span><span class="name">IP Addresses</span> <a title="Permalink" class="permalink" href="#sec.network.addresses.ip">#</a></h3></div></div></div><p>
    Every computer on the Internet has a unique 32-bit address. These 32 bits
    (or 4 bytes) are normally written as illustrated in the second row in
    <a class="xref" href="#aus.net.basic.ipaddress" title="Writing IP Addresses">Example 13.1, “Writing IP Addresses”</a>.
   </p><div class="example" id="aus.net.basic.ipaddress"><div class="example-title-wrap"><h6 class="example-title"><span class="number">Example 13.1: </span><span class="name">Writing IP Addresses </span><a title="Permalink" class="permalink" href="#aus.net.basic.ipaddress">#</a></h6></div><div class="example-contents"><div class="verbatim-wrap"><pre class="screen">IP Address (binary):  11000000 10101000 00000000 00010100
IP Address (decimal):      192.     168.       0.      20</pre></div></div></div><p>
    In decimal form, the four bytes are written in the decimal number system,
    separated by periods. The IP address is assigned to a host or a network
    interface. It can be used only once throughout the world. There are
    exceptions to this rule, but these are not relevant to the following
    passages.
   </p><p>
    The points in IP addresses indicate the hierarchical system. Until the
    1990s, IP addresses were strictly categorized in classes. However, this
    system proved too inflexible and was discontinued. Now, <span class="emphasis"><em>classless
    routing</em></span> (CIDR, classless interdomain routing) is used.
   </p></div><div class="sect2 " id="sec.network.addresses.route"><div class="titlepage"><div><div><h3 class="title" id="sec.network.addresses.route"><span class="number">13.1.2 </span><span class="name">Netmasks and Routing</span> <a title="Permalink" class="permalink" href="#sec.network.addresses.route">#</a></h3></div></div></div><p>
    Netmasks are used to define the address range of a subnet. If two hosts are
    in the same subnet, they can reach each other directly. If they are not in
    the same subnet, they need the address of a gateway that handles all the
    traffic for the subnet. To check if two IP addresses are in the same
    subnet, simply <span class="quote">“<span class="quote">AND</span>”</span> both addresses with the netmask. If the
    result is identical, both IP addresses are in the same local network. If
    there are differences, the remote IP address, and thus the remote
    interface, can only be reached over a gateway.
   </p><p>
    To understand how the netmask works, look at
    <a class="xref" href="#tab.net.basic.netmask" title="Linking IP Addresses to the Netmask">Example 13.2, “Linking IP Addresses to the Netmask”</a>. The netmask consists of 32 bits
    that identify how much of an IP address belongs to the network. All those
    bits that are <code class="literal">1</code> mark the corresponding bit in the IP
    address as belonging to the network. All bits that are <code class="literal">0</code>
    mark bits inside the subnet. This means that the more bits are
    <code class="literal">1</code>, the smaller the subnet is. Because the netmask always
    consists of several successive <code class="literal">1</code> bits, it is also
    possible to count the number of bits in the netmask. In
    <a class="xref" href="#tab.net.basic.netmask" title="Linking IP Addresses to the Netmask">Example 13.2, “Linking IP Addresses to the Netmask”</a> the first net with 24 bits could
    also be written as <code class="literal">192.168.0.0/24</code>.
   </p><div class="example" id="tab.net.basic.netmask"><div class="example-title-wrap"><h6 class="example-title"><span class="number">Example 13.2: </span><span class="name">Linking IP Addresses to the Netmask </span><a title="Permalink" class="permalink" href="#tab.net.basic.netmask">#</a></h6></div><div class="example-contents"><div class="verbatim-wrap"><pre class="screen">IP address (192.168.0.20):  11000000 10101000 00000000 00010100
Netmask   (255.255.255.0):  11111111 11111111 11111111 00000000
---------------------------------------------------------------
Result of the link:         11000000 10101000 00000000 00000000
In the decimal system:           192.     168.       0.       0

IP address (213.95.15.200): 11010101 10111111 00001111 11001000
Netmask    (255.255.255.0): 11111111 11111111 11111111 00000000
---------------------------------------------------------------
Result of the link:         11010101 10111111 00001111 00000000
In the decimal system:           213.      95.      15.       0</pre></div></div></div><p>
    To give another example: all machines connected with the same Ethernet
    cable are usually located in the same subnet and are directly accessible.
    Even when the subnet is physically divided by switches or bridges, these
    hosts can still be reached directly.
   </p><p>
    IP addresses outside the local subnet can only be reached if a gateway is
    configured for the target network. In the most common case, there is only
    one gateway that handles all traffic that is external. However, it is also
    possible to configure several gateways for different subnets.
   </p><p>
    If a gateway has been configured, all external IP packets are sent to the
    appropriate gateway. This gateway then attempts to forward the packets in
    the same manner—from host to host—until it reaches the
    destination host or the packet's TTL (time to live) expires.
   </p><div class="variablelist " id="net.basic.spezial.net"><div class="variablelist-title-wrap"><h6 class="variablelist-title"><span class="name">Specific Addresses </span><a title="Permalink" class="permalink" href="#net.basic.spezial.net">#</a></h6></div><dl class="variablelist"><dt id="idm140019139573408"><span class="term ">
      Base Network Address
     </span></dt><dd><p>
       This is the netmask AND any address in the network, as shown in
       <a class="xref" href="#tab.net.basic.netmask" title="Linking IP Addresses to the Netmask">Example 13.2, “Linking IP Addresses to the Netmask”</a> under <code class="literal">Result</code>.
       This address cannot be assigned to any hosts.
      </p></dd><dt id="idm140019139570480"><span class="term ">
      Broadcast Address
     </span></dt><dd><p>
       This could be paraphrased as: <span class="quote">“<span class="quote">Access all hosts in this
       subnet.</span>”</span> To generate this, the netmask is inverted in binary form
       and linked to the base network address with a logical OR. The above
       example therefore results in 192.168.0.255. This address cannot be
       assigned to any hosts.
      </p></dd><dt id="idm140019139567968"><span class="term ">
      Local Host
     </span></dt><dd><p>
       The address <code class="systemitem">127.0.0.1</code> is
       assigned to the <span class="quote">“<span class="quote">loopback device</span>”</span> on each host. A
       connection can be set up to your own machine with this address and with
       all addresses from the complete
       <code class="systemitem">127.0.0.0/8</code> loopback network
       as defined with IPv4. With IPv6 there is only one loopback address
       (<code class="systemitem">::1</code>).
      </p></dd></dl></div><p>
    Because IP addresses must be unique all over the world, you cannot select
    random addresses. There are three address domains to use if you want to set
    up a private IP-based network. These cannot get any connection from the
    rest of the Internet, because they cannot be transmitted over the Internet.
    These address domains are specified in RFC 1597 and listed in
    <a class="xref" href="#tab.net.basic.privat.net" title="Private IP Address Domains">Table 13.1, “Private IP Address Domains”</a>.
   </p><div class="table" id="tab.net.basic.privat.net"><div class="table-title-wrap"><h6 class="table-title"><span class="number">Table 13.1: </span><span class="name">Private IP Address Domains </span><a title="Permalink" class="permalink" href="#tab.net.basic.privat.net">#</a></h6></div><div class="table-contents"><table summary="Private IP Address Domains" border="1"><colgroup><col /><col /></colgroup><thead><tr><th>
        <p>
         Network/Netmask
        </p>
       </th><th>
        <p>
         Domain
        </p>
       </th></tr></thead><tbody><tr><td>
        <p>
         <code class="systemitem">10.0.0.0</code>/<code class="systemitem">255.0.0.0</code>
        </p>
       </td><td>
        <p>
         <code class="systemitem">10.x.x.x</code>
        </p>
       </td></tr><tr><td>
        <p>
         <code class="systemitem">172.16.0.0</code>/<code class="systemitem">255.240.0.0</code>
        </p>
       </td><td>
        <p>
         <code class="systemitem">172.16.x.x</code> –
         <code class="systemitem">172.31.x.x</code>
        </p>
       </td></tr><tr><td>
        <p>
         <code class="systemitem">192.168.0.0</code>/<code class="systemitem">255.255.0.0</code>
        </p>
       </td><td>
        <p>
         <code class="systemitem">192.168.x.x</code>
        </p>
       </td></tr></tbody></table></div></div></div></div><div class="sect1 " id="sec.network.ipv6"><div class="titlepage"><div><div><h2 class="title" id="sec.network.ipv6"><span class="number">13.2 </span><span class="name">IPv6—The Next Generation Internet</span> <a title="Permalink" class="permalink" href="#sec.network.ipv6">#</a></h2></div></div></div><p>
   Due to the emergence of the World Wide Web (WWW), the Internet has
   experienced explosive growth, with an increasing number of computers
   communicating via TCP/IP in the past fifteen years. Since Tim Berners-Lee at
   CERN (<a class="link" href="http://public.web.cern.ch" target="_blank">http://public.web.cern.ch</a>) invented the WWW in
   1990, the number of Internet hosts has grown from a few thousand to about a
   hundred million.
  </p><p>
   As mentioned, an IPv4 address consists of only 32 bits. Also, quite a few
   IP addresses are lost—they cannot be used because of the way in which
   networks are organized. The number of addresses available in your subnet is
   two to the power of the number of bits, minus two. A subnet has, for
   example, 2, 6, or 14 addresses available. To connect 128 hosts to the
   Internet, for example, you need a subnet with 256 IP addresses, from which
   only 254 are usable, because two IP addresses are needed for the structure
   of the subnet itself: the broadcast and the base network address.
  </p><p>
   Under the current IPv4 protocol, DHCP or NAT (network address translation)
   are the typical mechanisms used to circumvent the potential address
   shortage. Combined with the convention to keep private and public address
   spaces separate, these methods can certainly mitigate the shortage. The
   problem with them lies in their configuration, which is a chore to set up
   and a burden to maintain. To set up a host in an IPv4 network, you need
   several address items, such as the host's own IP address, the subnetmask,
   the gateway address and maybe a name server address. All these items need to
   be known and cannot be derived from somewhere else.
  </p><p>
   With IPv6, both the address shortage and the complicated configuration
   should be a thing of the past. The following sections tell more about the
   improvements and benefits brought by IPv6 and about the transition from the
   old protocol to the new one.
  </p><div class="sect2 " id="sec.network.ipv6.adv"><div class="titlepage"><div><div><h3 class="title" id="sec.network.ipv6.adv"><span class="number">13.2.1 </span><span class="name">Advantages</span> <a title="Permalink" class="permalink" href="#sec.network.ipv6.adv">#</a></h3></div></div></div><p>
    The most important and most visible improvement brought by the new protocol
    is the enormous expansion of the available address space. An IPv6 address
    is made up of 128 bit values instead of the traditional 32 bits. This
    provides for as many as several quadrillion IP addresses.
   </p><p>
    However, IPv6 addresses are not only different from their predecessors with
    regard to their length. They also have a different internal structure that
    may contain more specific information about the systems and the networks to
    which they belong. More details about this are found in
    <a class="xref" href="#sec.network.ipv6.address" title="13.2.2. Address Types and Structure">Section 13.2.2, “Address Types and Structure”</a>.
   </p><p>
    The following is a list of other advantages of the new protocol:
   </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019139532880"><span class="term ">Autoconfiguration</span></dt><dd><p>
       IPv6 makes the network <span class="quote">“<span class="quote">plug and play</span>”</span> capable, which means
       that a newly set up system integrates into the (local) network without
       any manual configuration. The new host uses its automatic configuration
       mechanism to derive its own address from the information made available
       by the neighboring routers, relying on a protocol called the
       <span class="emphasis"><em>neighbor discovery</em></span> (ND) protocol. This method does
       not require any intervention on the administrator's part and there is no
       need to maintain a central server for address allocation—an
       additional advantage over IPv4, where automatic address allocation
       requires a DHCP server.
      </p><p>
       Nevertheless if a router is connected to a switch, the router should
       send periodic advertisements with flags telling the hosts of a network
       how they should interact with each other. For more information, see
       RFC 2462 and the <code class="systemitem">radvd.conf(5)</code> man page, and
       RFC 3315.
      </p></dd><dt id="idm140019139528432"><span class="term ">Mobility</span></dt><dd><p>
       IPv6 makes it possible to assign several addresses to one network
       interface at the same time. This allows users to access several networks
       easily, something that could be compared with the international roaming
       services offered by mobile phone companies. When you take your mobile
       phone abroad, the phone automatically logs in to a foreign service when
       it enters the corresponding area, so you can be reached under the same
       number everywhere and can place an outgoing call, as you would in your
       home area.
      </p></dd><dt id="idm140019139526080"><span class="term ">Secure Communication</span></dt><dd><p>
       With IPv4, network security is an add-on function. IPv6 includes IPsec
       as one of its core features, allowing systems to communicate over a
       secure tunnel to avoid eavesdropping by outsiders on the Internet.
      </p></dd><dt id="idm140019139524064"><span class="term ">Backward Compatibility</span></dt><dd><p>
       Realistically, it would be impossible to switch the entire Internet from
       IPv4 to IPv6 at one time. Therefore, it is crucial that both protocols
       can coexist not only on the Internet, but also on one system. This is
       ensured by compatible addresses (IPv4 addresses can easily be translated
       into IPv6 addresses) and by using several tunnels. See
       <a class="xref" href="#sec.network.ipv6.coexist" title="13.2.3. Coexistence of IPv4 and IPv6">Section 13.2.3, “Coexistence of IPv4 and IPv6”</a>. Also, systems can rely on a
       <span class="emphasis"><em>dual stack IP</em></span> technique to support both protocols
       at the same time, meaning that they have two network stacks that are
       completely separate, such that there is no interference between the two
       protocol versions.
      </p></dd><dt id="idm140019139520656"><span class="term ">Custom Tailored Services through Multicasting</span></dt><dd><p>
       With IPv4, some services, such as SMB, need to broadcast their packets
       to all hosts in the local network. IPv6 allows a much more fine-grained
       approach by enabling servers to address hosts through
       <span class="emphasis"><em>multicasting</em></span>, that is by addressing several hosts as
       parts of a group. This is different from addressing all hosts through
       <span class="emphasis"><em>broadcasting</em></span> or each host individually through
       <span class="emphasis"><em>unicasting</em></span>). Which hosts are addressed as a group
       may depend on the concrete application. There are some predefined groups
       to address all name servers (the <span class="emphasis"><em>all name servers multicast
       group</em></span>), for example, or all routers (the <span class="emphasis"><em>all
       routers multicast group</em></span>).
      </p></dd></dl></div></div><div class="sect2 " id="sec.network.ipv6.address"><div class="titlepage"><div><div><h3 class="title" id="sec.network.ipv6.address"><span class="number">13.2.2 </span><span class="name">Address Types and Structure</span> <a title="Permalink" class="permalink" href="#sec.network.ipv6.address">#</a></h3></div></div></div><p>
    As mentioned, the current IP protocol has two major limitations:
    there is an increasing shortage of IP addresses, and configuring the network
    and maintaining the routing tables is becoming a more complex and
    burdensome task. IPv6 solves the first problem by expanding the address
    space to 128 bits. The second one is mitigated by introducing a
    hierarchical address structure combined with sophisticated techniques to
    allocate network addresses, and <span class="emphasis"><em>multihoming</em></span> (the
    ability to assign several addresses to one device, giving access to several
    networks).
   </p><p>
    When dealing with IPv6, it is useful to know about three different types of
    addresses:
   </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019139512240"><span class="term ">Unicast</span></dt><dd><p>
       Addresses of this type are associated with exactly one network
       interface. Packets with such an address are delivered to only one
       destination. Accordingly, unicast addresses are used to transfer packets
       to individual hosts on the local network or the Internet.
      </p></dd><dt id="idm140019139510176"><span class="term ">Multicast</span></dt><dd><p>
       Addresses of this type relate to a group of network interfaces. Packets
       with such an address are delivered to all destinations that belong to
       the group. Multicast addresses are mainly used by certain network
       services to communicate with certain groups of hosts in a well-directed
       manner.
      </p></dd><dt id="idm140019139508064"><span class="term ">Anycast</span></dt><dd><p>
       Addresses of this type are related to a group of interfaces. Packets
       with such an address are delivered to the member of the group that is
       closest to the sender, according to the principles of the underlying
       routing protocol. Anycast addresses are used to make it easier for hosts
       to find out about servers offering certain services in the given network
       area. All servers of the same type have the same anycast address.
       Whenever a host requests a service, it receives a reply from the server
       with the closest location, as determined by the routing protocol. If
       this server should fail for some reason, the protocol automatically
       selects the second closest server, then the third one, and so forth.
      </p></dd></dl></div><p>
    An IPv6 address is made up of eight four-digit fields, each representing 16
    bits, written in hexadecimal notation. They are separated by colons
    (<code class="literal">:</code>). Any leading zero bytes within a given field may be
    dropped, but zeros within the field or at its end may not. Another
    convention is that more than four consecutive zero bytes may be collapsed
    into a double colon. However, only one such <code class="literal">::</code> is
    allowed per address. This kind of shorthand notation is shown in
    <a class="xref" href="#aus.netz.ipv6.add" title="Sample IPv6 Address">Example 13.3, “Sample IPv6 Address”</a>, where all three lines represent the
    same address.
   </p><div class="example" id="aus.netz.ipv6.add"><div class="example-title-wrap"><h6 class="example-title"><span class="number">Example 13.3: </span><span class="name">Sample IPv6 Address </span><a title="Permalink" class="permalink" href="#aus.netz.ipv6.add">#</a></h6></div><div class="example-contents"><div class="verbatim-wrap"><pre class="screen">fe80 : 0000 : 0000 : 0000 : 0000 : 10 : 1000 : 1a4
fe80 :    0 :    0 :    0 :    0 : 10 : 1000 : 1a4
fe80 :                           : 10 : 1000 : 1a4</pre></div></div></div><p>
    Each part of an IPv6 address has a defined function. The first bytes form
    the prefix and specify the type of address. The center part is the network
    portion of the address, but it may be unused. The end of the address forms
    the host part. With IPv6, the netmask is defined by indicating the length
    of the prefix after a slash at the end of the address. An address, as shown
    in <a class="xref" href="#aus.netz.ipv6.addpre" title="IPv6 Address Specifying the Prefix Length">Example 13.4, “IPv6 Address Specifying the Prefix Length”</a>, contains the information that
    the first 64 bits form the network part of the address and the last 64 form
    its host part. In other words, the <code class="literal">64</code> means that the
    netmask is filled with 64 1-bit values from the left. As with IPv4, the IP
    address is combined with AND with the values from the netmask to determine
    whether the host is located in the same subnet or in another one.
   </p><div class="example" id="aus.netz.ipv6.addpre"><div class="example-title-wrap"><h6 class="example-title"><span class="number">Example 13.4: </span><span class="name">IPv6 Address Specifying the Prefix Length </span><a title="Permalink" class="permalink" href="#aus.netz.ipv6.addpre">#</a></h6></div><div class="example-contents"><div class="verbatim-wrap"><pre class="screen">fe80::10:1000:1a4/64</pre></div></div></div><p>
    IPv6 knows about several predefined types of prefixes. Some are shown in
    <a class="xref" href="#list.net.basic.ipv6.prefix" title="Various IPv6 Prefixes">Various IPv6 Prefixes</a>.
   </p><div class="variablelist " id="list.net.basic.ipv6.prefix"><div class="variablelist-title-wrap"><h6 class="variablelist-title"><span class="name">Various IPv6 Prefixes </span><a title="Permalink" class="permalink" href="#list.net.basic.ipv6.prefix">#</a></h6></div><dl class="variablelist"><dt id="idm140019139494704"><span class="term "><code class="systemitem">00</code>
     </span></dt><dd><p>
       IPv4 addresses and IPv4 over IPv6 compatibility addresses. These are
       used to maintain compatibility with IPv4. Their use still requires a
       router able to translate IPv6 packets into IPv4 packets. Several special
       addresses, such as the one for the loopback device, have this prefix as
       well.
      </p></dd><dt id="idm140019139492032"><span class="term "><code class="systemitem">2</code> or
      <code class="systemitem">3</code> as the
      first digit
     </span></dt><dd><p>
       Aggregatable global unicast addresses. As is the case with IPv4, an
       interface can be assigned to form part of a certain subnet. Currently,
       there are the following address spaces:
       <code class="systemitem">2001::/16</code> (production quality
       address space) and <code class="systemitem">2002::/16</code>
       (6to4 address space).
      </p></dd><dt id="idm140019139487312"><span class="term "><code class="systemitem">fe80::/10</code>
     </span></dt><dd><p>
       Link-local addresses. Addresses with this prefix should not be routed
       and should therefore only be reachable from within the same subnet.
      </p></dd><dt id="idm140019139484816"><span class="term "><code class="systemitem">fec0::/10</code>
     </span></dt><dd><p>
       Site-local addresses. These may be routed, but only within the network
       of the organization to which they belong. In effect, they are the IPv6
       equivalent of the current private network address space, such as
       <code class="systemitem">10.x.x.x</code>.
      </p></dd><dt id="idm140019139481520"><span class="term "><code class="systemitem">ff</code>
     </span></dt><dd><p>
       These are multicast addresses.
      </p></dd></dl></div><p>
    A unicast address consists of three basic components:
   </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019139478192"><span class="term ">Public Topology</span></dt><dd><p>
       The first part (which also contains one of the prefixes mentioned above)
       is used to route packets through the public Internet. It includes
       information about the company or institution that provides the Internet
       access.
      </p></dd><dt id="idm140019139476160"><span class="term ">Site Topology</span></dt><dd><p>
       The second part contains routing information about the subnet to which
       to deliver the packet.
      </p></dd><dt id="idm140019139474272"><span class="term ">Interface ID</span></dt><dd><p>
       The third part identifies the interface to which to deliver the packet.
       This also allows for the MAC to form part of the address. Given that the
       MAC is a globally unique, fixed identifier coded into the device by the
       hardware maker, the configuration procedure is substantially simplified.
       In fact, the first 64 address bits are consolidated to form the
       <code class="literal">EUI-64</code> token, with the last 48 bits taken from the
       MAC, and the remaining 24 bits containing special information about the
       token type. This also makes it possible to assign an
       <code class="literal">EUI-64</code> token to interfaces that do not have a MAC,
       such as those based on PPP.
      </p></dd></dl></div><p>
    On top of this basic structure, IPv6 distinguishes between five different
    types of unicast addresses:
   </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019139469968"><span class="term "><code class="systemitem">::</code> (unspecified) </span></dt><dd><p>
       This address is used by the host as its source address when the
       interface is initialized for the first time (at which point, the address
       cannot yet be determined by other means).
      </p></dd><dt id="idm140019139467424"><span class="term "><code class="systemitem">::1</code> (loopback) </span></dt><dd><p>
       The address of the loopback device.
      </p></dd><dt id="idm140019139465040"><span class="term ">IPv4 Compatible Addresses</span></dt><dd><p>
       The IPv6 address is formed by the IPv4 address and a prefix consisting
       of 96 zero bits. This type of compatibility address is used for
       tunneling (see <a class="xref" href="#sec.network.ipv6.coexist" title="13.2.3. Coexistence of IPv4 and IPv6">Section 13.2.3, “Coexistence of IPv4 and IPv6”</a>) to allow
       IPv4 and IPv6 hosts to communicate with others operating in a pure IPv4
       environment.
      </p></dd><dt id="idm140019139462400"><span class="term ">IPv4 Addresses Mapped to IPv6</span></dt><dd><p>
       This type of address specifies a pure IPv4 address in IPv6 notation.
      </p></dd><dt id="idm140019139460528"><span class="term ">Local Addresses</span></dt><dd><p>
       There are two address types for local use:
      </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019139458720"><span class="term ">link-local</span></dt><dd><p>
          This type of address can only be used in the local subnet. Packets
          with a source or target address of this type should not be routed to
          the Internet or other subnets. These addresses contain a special
          prefix (<code class="systemitem">fe80::/10</code>) and the
          interface ID of the network card, with the middle part consisting of
          zero bytes. Addresses of this type are used during automatic
          configuration to communicate with other hosts belonging to the same
          subnet.
         </p></dd><dt id="idm140019139455712"><span class="term ">site-local</span></dt><dd><p>
          Packets with this type of address may be routed to other subnets, but
          not to the wider Internet—they must remain inside the
          organization's own network. Such addresses are used for intranets and
          are an equivalent of the private address space defined by IPv4. They
          contain a special prefix
          (<code class="systemitem">fec0::/10</code>), the interface
          ID, and a 16 bit field specifying the subnet ID. Again, the rest is
          filled with zero bytes.
         </p></dd></dl></div></dd></dl></div><p>
    As a completely new feature introduced with IPv6, each network interface
    normally gets several IP addresses, with the advantage that several
    networks can be accessed through the same interface. One of these networks
    can be configured completely automatically using the MAC and a known prefix
    with the result that all hosts on the local network can be reached when
    IPv6 is enabled (using the link-local address). With the MAC forming part
    of it, any IP address used in the world is unique. The only variable parts
    of the address are those specifying the <span class="emphasis"><em>site topology</em></span>
    and the <span class="emphasis"><em>public topology</em></span>, depending on the actual
    network in which the host is currently operating.
   </p><p>
    For a host to go back and forth between different networks, it needs at
    least two addresses. One of them, the <span class="emphasis"><em>home address</em></span>,
    not only contains the interface ID but also an identifier of the home
    network to which it normally belongs (and the corresponding prefix). The
    home address is a static address and, as such, it does not normally change.
    Still, all packets destined to the mobile host can be delivered to it,
    regardless of whether it operates in the home network or somewhere outside.
    This is made possible by the completely new features introduced with IPv6,
    such as <span class="emphasis"><em>stateless autoconfiguration</em></span> and
    <span class="emphasis"><em>neighbor discovery</em></span>. In addition to its home address, a
    mobile host gets one or more additional addresses that belong to the
    foreign networks where it is roaming. These are called
    <span class="emphasis"><em>care-of</em></span> addresses. The home network has a facility
    that forwards any packets destined to the host when it is roaming outside.
    In an IPv6 environment, this task is performed by the <span class="emphasis"><em>home
    agent</em></span>, which takes all packets destined to the home address and
    relays them through a tunnel. On the other hand, those packets destined to
    the care-of address are directly transferred to the mobile host without any
    special detours.
   </p></div><div class="sect2 " id="sec.network.ipv6.coexist"><div class="titlepage"><div><div><h3 class="title" id="sec.network.ipv6.coexist"><span class="number">13.2.3 </span><span class="name">Coexistence of IPv4 and IPv6</span> <a title="Permalink" class="permalink" href="#sec.network.ipv6.coexist">#</a></h3></div></div></div><p>
    The migration of all hosts connected to the Internet from IPv4 to IPv6 is a
    gradual process. Both protocols will coexist for some time to come. The
    coexistence on one system is guaranteed where there is a <span class="emphasis"><em>dual
    stack</em></span> implementation of both protocols. That still leaves the
    question of how an IPv6 enabled host should communicate with an IPv4 host
    and how IPv6 packets should be transported by the current networks, which
    are predominantly IPv4-based. The best solutions offer tunneling and
    compatibility addresses (see <a class="xref" href="#sec.network.ipv6.address" title="13.2.2. Address Types and Structure">Section 13.2.2, “Address Types and Structure”</a>).
   </p><p>
    IPv6 hosts that are more or less isolated in the (worldwide) IPv4 network
    can communicate through tunnels: IPv6 packets are encapsulated as IPv4
    packets to move them across an IPv4 network. Such a connection between two
    IPv4 hosts is called a <span class="emphasis"><em>tunnel</em></span>. To achieve this,
    packets must include the IPv6 destination address (or the corresponding
    prefix) and the IPv4 address of the remote host at the receiving end of the
    tunnel. A basic tunnel can be configured manually according to an agreement
    between the hosts' administrators. This is also called <span class="emphasis"><em>static
    tunneling</em></span>.
   </p><p>
    However, the configuration and maintenance of static tunnels is often too
    labor-intensive to use them for daily communication needs. Therefore, IPv6
    provides for three different methods of <span class="emphasis"><em>dynamic
    tunneling</em></span>:
   </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019139439680"><span class="term ">6over4</span></dt><dd><p>
       IPv6 packets are automatically encapsulated as IPv4 packets and sent
       over an IPv4 network capable of multicasting. IPv6 is tricked into
       seeing the whole network (Internet) as a huge local area network (LAN).
       This makes it possible to determine the receiving end of the IPv4 tunnel
       automatically. However, this method does not scale very well and is also
       hampered because IP multicasting is far from widespread on the Internet.
       Therefore, it only provides a solution for smaller corporate or
       institutional networks where multicasting can be enabled. The
       specifications for this method are laid down in RFC 2529.
      </p></dd><dt id="idm140019139437216"><span class="term ">6to4</span></dt><dd><p>
       With this method, IPv4 addresses are automatically generated from IPv6
       addresses, enabling isolated IPv6 hosts to communicate over an IPv4
       network. However, several problems have been reported regarding the
       communication between those isolated IPv6 hosts and the Internet. The
       method is described in RFC 3056.
      </p></dd><dt id="idm140019139435088"><span class="term ">IPv6 Tunnel Broker</span></dt><dd><p>
       This method relies on special servers that provide dedicated tunnels for
       IPv6 hosts. It is described in RFC 3053.
      </p></dd></dl></div></div><div class="sect2 " id="sec.network.ipv6.config"><div class="titlepage"><div><div><h3 class="title" id="sec.network.ipv6.config"><span class="number">13.2.4 </span><span class="name">Configuring IPv6</span> <a title="Permalink" class="permalink" href="#sec.network.ipv6.config">#</a></h3></div></div></div><p>
    To configure IPv6, you normally do not need to make any changes on the
    individual workstations. IPv6 is enabled by default. To disable or enable
    IPv6 on an installed system, use the YaST <span class="guimenu">Network
    Settings</span> module. On the <span class="guimenu">Global Options</span> tab,
    check or uncheck the <span class="guimenu">Enable IPv6</span> option as necessary.

    To enable it temporarily until the next reboot, enter
    <code class="command">modprobe</code> <code class="option">-i ipv6</code> as
    <code class="systemitem">root</code>. It is impossible to unload
    the IPv6 module after it has been loaded.
   </p><p>
    Because of the autoconfiguration concept of IPv6, the network card is
    assigned an address in the <span class="emphasis"><em>link-local</em></span> network.
    Normally, no routing table management takes place on a workstation. The
    network routers can be queried by the workstation, using the
    <span class="emphasis"><em>router advertisement protocol</em></span>, for what prefix and
    gateways should be implemented. The radvd program can be used to set up an
    IPv6 router. This program informs the workstations which prefix to use for
    the IPv6 addresses and which routers. Alternatively, use zebra/quagga for
    automatic configuration of both addresses and routing.
   </p><p>
    For information about how to set up various types of tunnels using the
    <code class="filename">/etc/sysconfig/network</code> files, see the man page of
    <code class="literal">ifcfg-tunnel</code> (<code class="command">man ifcfg-tunnel</code>).
   </p></div><div class="sect2 " id="sec.network.ipv6.moreinfo"><div class="titlepage"><div><div><h3 class="title" id="sec.network.ipv6.moreinfo"><span class="number">13.2.5 </span><span class="name">For More Information</span> <a title="Permalink" class="permalink" href="#sec.network.ipv6.moreinfo">#</a></h3></div></div></div><p>
    The above overview does not cover the topic of IPv6 comprehensively. For a
    more in-depth look at the new protocol, refer to the following online
    documentation and books:
   </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019139421856"><span class="term "><a class="link" href="http://www.ipv6.org/" target="_blank">http://www.ipv6.org/</a>
     </span></dt><dd><p>
       The starting point for everything about IPv6.
      </p></dd><dt id="idm140019139419616"><span class="term "><a class="link" href="http://www.ipv6day.org" target="_blank">http://www.ipv6day.org</a>
     </span></dt><dd><p>
       All information needed to start your own IPv6 network.
      </p></dd><dt id="idm140019139417376"><span class="term "><a class="link" href="http://www.ipv6-to-standard.org/" target="_blank">http://www.ipv6-to-standard.org/</a>
     </span></dt><dd><p>
       The list of IPv6-enabled products.
      </p></dd><dt id="idm140019139415184"><span class="term "><a class="link" href="http://www.bieringer.de/linux/IPv6/" target="_blank">http://www.bieringer.de/linux/IPv6/</a>
     </span></dt><dd><p>
       Here, find the Linux IPv6-HOWTO and many links related to the topic.
      </p></dd><dt id="idm140019139412912"><span class="term ">RFC 2460</span></dt><dd><p>
       The fundamental RFC about IPv6.
      </p></dd><dt id="idm140019139411088"><span class="term ">IPv6 Essentials</span></dt><dd><p>
       A book describing all the important aspects of the topic is
       <span class="emphasis"><em>IPv6 Essentials</em></span> by Silvia Hagen (ISBN
       0-596-00125-8).
      </p></dd></dl></div></div></div><div class="sect1 " id="sec.network.nameres"><div class="titlepage"><div><div><h2 class="title" id="sec.network.nameres"><span class="number">13.3 </span><span class="name">Name Resolution</span> <a title="Permalink" class="permalink" href="#sec.network.nameres">#</a></h2></div></div></div><p>
   DNS assists in assigning an IP address to one or more names and assigning a
   name to an IP address. In Linux, this conversion is usually carried out by a
   special type of software known as bind. The machine that takes care of this
   conversion is called a <span class="emphasis"><em>name server</em></span>. The names make up a
   hierarchical system in which each name component is separated by a period.
   The name hierarchy is, however, independent of the IP address hierarchy
   described above.
  </p><p>
   Consider a complete name, such as
   <code class="systemitem">jupiter.example.com</code>, written in the
   format <code class="systemitem">hostname.domain</code>. A full
   name, called a <span class="emphasis"><em>fully qualified domain name</em></span> (FQDN),
   consists of a host name and a domain name
   (<code class="systemitem">example.com</code>). The latter
   also includes the <span class="emphasis"><em>top level domain</em></span> or TLD
   (<code class="systemitem">com</code>).
  </p><p>
   TLD assignment has become quite confusing for historical reasons.
   Traditionally, three-letter domain names are used in the USA. In the rest of
   the world, the two-letter ISO national codes are the standard. In addition
   to that, longer TLDs were introduced in 2000 that represent certain spheres
   of activity (for example, <code class="systemitem">.info</code>,
   <code class="systemitem">.name</code>,
   <code class="systemitem">.museum</code>).
  </p><p>
   In the early days of the Internet (before 1990), the file
   <code class="filename">/etc/hosts</code> was used to store the names of all the
   machines represented over the Internet. This quickly proved to be
   impractical in the face of the rapidly growing number of computers connected
   to the Internet. For this reason, a decentralized database was developed to
   store the host names in a widely distributed manner. This database, similar
   to the name server, does not have the data pertaining to all hosts in the
   Internet readily available, but can dispatch requests to other name servers.
  </p><p>
   The top of the hierarchy is occupied by <span class="emphasis"><em>root name
   servers</em></span>. These root name servers manage the top level domains and
   are run by the Network Information Center (NIC). Each root name server knows
   about the name servers responsible for a given top level domain. Information
   about top level domain NICs is available at
   <a class="link" href="http://www.internic.net" target="_blank">http://www.internic.net</a>.
  </p><p>
   DNS can do more than resolve host names. The name server also knows which
   host is receiving e-mails for an entire domain—the <span class="emphasis"><em>mail
   exchanger (MX)</em></span>.
  </p><p>
   For your machine to resolve an IP address, it must know about at least one
   name server and its IP address. Easily specify such a name server using
   YaST. <span class="phrase">The configuration of name server access with
   <span class="productname"><span class="phrase">openSUSE® Leap</span></span> is described in
   <a class="xref" href="#sec.network.yast.change.host" title="13.4.1.4. Configuring Host Name and DNS">Section 13.4.1.4, “Configuring Host Name and DNS”</a>. Setting up your own name
   server is described in <a class="xref" href="#cha.dns" title="Chapter 19. The Domain Name System">Chapter 19, <em>The Domain Name System</em></a>.</span>
  </p><p>
   The protocol <code class="literal">whois</code> is closely related to DNS. With this
   program, quickly find out who is responsible for a given domain.
  </p><div id="idm140019139389664" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note: MDNS and .local Domain Names</h6><p>
    The <code class="literal">.local</code> top level domain is treated as link-local
    domain by the resolver. DNS requests are send as multicast DNS requests
    instead of normal DNS requests. If you already use the
    <code class="literal">.local</code> domain in your name server configuration, you
    must switch this option off in <code class="filename">/etc/host.conf</code>. For
    more information, see the <code class="filename">host.conf</code> manual page.
   </p><p>
    If you want to switch off MDNS during installation, use
    <code class="literal">nomdns=1</code> as a boot parameter.
   </p><p>
    For more information on multicast DNS, see
    <a class="link" href="http://www.multicastdns.org" target="_blank">http://www.multicastdns.org</a>.
   </p></div></div><div class="sect1 " id="sec.network.yast"><div class="titlepage"><div><div><h2 class="title" id="sec.network.yast"><span class="number">13.4 </span><span class="name">Configuring a Network Connection with YaST</span> <a title="Permalink" class="permalink" href="#sec.network.yast">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">Filename: </span>net_yast.xml</li><li><span class="ds-label">ID: </span>sec.network.yast</li></ul></div></div></div></div><p>
  There are many supported networking types on Linux. Most of them use
  different device names and the configuration files are spread over several
  locations in the file system. For a detailed overview of the aspects of
  manual network configuration, see <a class="xref" href="#sec.network.manconf" title="13.6. Configuring a Network Connection Manually">Section 13.6, “Configuring a Network Connection Manually”</a>.
 </p><p>
  <span class="phrase">All network interfaces with link
  up (with a network cable connected) are automatically configured.</span>
  Additional hardware can be configured any time on the installed system. The
  following sections describe the network configuration for all types of
  network connections supported by <span class="productname"><span class="phrase">openSUSE Leap</span></span>.
 </p><div class="sect2 " id="sec.network.yast.netcard"><div class="titlepage"><div><div><h3 class="title" id="sec.network.yast.netcard"><span class="number">13.4.1 </span><span class="name">Configuring the Network Card with YaST</span> <a title="Permalink" class="permalink" href="#sec.network.yast.netcard">#</a></h3></div></div></div><p>
   To configure your Ethernet or Wi-Fi/Bluetooth card in YaST, select
   <span class="guimenu">System</span> › <span class="guimenu">Network Settings</span>. After starting the module, YaST displays the
   <span class="guimenu">Network Settings</span> dialog with four tabs: <span class="guimenu">Global
   Options</span>, <span class="guimenu">Overview</span>,
   <span class="guimenu">Hostname/DNS</span> and <span class="guimenu">Routing</span>.
  </p><p>
   The <span class="guimenu">Global Options</span> tab allows you to set general
   networking options such as the network setup method, IPv6, and general DHCP
   options. For more information, see
   <a class="xref" href="#sec.network.yast.netcard.global" title="13.4.1.1. Configuring Global Networking Options">Section 13.4.1.1, “Configuring Global Networking Options”</a>.
  </p><p>
   The <span class="guimenu">Overview</span> tab contains information about installed
   network interfaces and configurations. Any properly detected network card is
   listed with its name. You can manually configure new cards, remove or change
   their configuration in this dialog. To manually configure a card
   that was not automatically detected, see
   <a class="xref" href="#sec.network.yast.netcard.man" title="13.4.1.3. Configuring an Undetected Network Card">Section 13.4.1.3, “Configuring an Undetected Network Card”</a>. If you want to change the
   configuration of an already configured card, see
   <a class="xref" href="#sec.network.yast.netcard.change" title="13.4.1.2. Changing the Configuration of a Network Card">Section 13.4.1.2, “Changing the Configuration of a Network Card”</a>.
  </p><p>
   The <span class="guimenu">Hostname/DNS</span> tab allows to set the host name of the
   machine and name the servers to be used. For more information, see
   <a class="xref" href="#sec.network.yast.change.host" title="13.4.1.4. Configuring Host Name and DNS">Section 13.4.1.4, “Configuring Host Name and DNS”</a>.
  </p><p>
   The <span class="guimenu">Routing</span> tab is used for the configuration of routing.
   See <a class="xref" href="#sec.network.yast.change.route" title="13.4.1.5. Configuring Routing">Section 13.4.1.5, “Configuring Routing”</a> for more information.
  </p><div class="figure" id="fig.yast2.neticard"><div class="figure-contents"><div class="mediaobject"><a xmlns="" href="images/yast2_net_icard.png"><img src="images/yast2_net_icard.png" width="" alt="Configuring Network Settings" /></a></div></div><div class="figure-title-wrap"><h6 class="figure-title"><span class="number">Figure 13.3: </span><span class="name">Configuring Network Settings </span><a title="Permalink" class="permalink" href="#fig.yast2.neticard">#</a></h6></div></div><div class="sect3 " id="sec.network.yast.netcard.global"><div class="titlepage"><div><div><h4 class="title" id="sec.network.yast.netcard.global"><span class="number">13.4.1.1 </span><span class="name">Configuring Global Networking Options</span> <a title="Permalink" class="permalink" href="#sec.network.yast.netcard.global">#</a></h4></div></div></div><p>
    The <span class="guimenu">Global Options</span> tab of the YaST <span class="guimenu">Network
    Settings</span> module allows you to set important global networking
    options, such as the use of NetworkManager, IPv6 and DHCP client options. These
    settings are applicable for all network interfaces.
   </p><p>
    In the <span class="guimenu">Network Setup Method</span> choose the way network
    connections are managed. If you want a NetworkManager desktop applet to manage
    connections for all interfaces, choose <span class="guimenu">NetworkManager Service</span>.
    NetworkManager is well suited for switching between multiple wired and wireless
    networks. If you do not run a desktop environment, or if your computer is a
    Xen server, virtual system, or provides network services such as DHCP or
    DNS in your network, use the <span class="guimenu">Wicked Service</span> method. If
    NetworkManager is used, <code class="command">nm-applet</code> should be used to configure
    network options and the <span class="guimenu">Overview</span>,
    <span class="guimenu">Hostname/DNS</span> and <span class="guimenu">Routing</span> tabs of the
    <span class="guimenu">Network Settings</span> module are disabled.
    <span class="phrase">For more information on NetworkManager, see
    <a class="xref" href="#cha.nm" title="Chapter 28. Using NetworkManager">Chapter 28, <em>Using NetworkManager</em></a>.</span> 
   </p><p>
    In the <span class="guimenu">IPv6 Protocol Settings</span> choose whether to use the
    IPv6 protocol. It is possible to use IPv6 together with IPv4. By default,
    IPv6 is enabled. However, in networks not using IPv6 protocol, response
    times can be faster with IPv6 protocol disabled. To disable IPv6,
    deactivate <span class="guimenu">Enable IPv6</span>. If IPv6 is disabled, the kernel
    no longer loads the IPv6 module automatically. This setting will be applied
    after reboot.
   </p><p>
    In the <span class="guimenu">DHCP Client Options</span> configure options for the
    DHCP client.


    The <span class="guimenu">DHCP Client Identifier</span> must be different for each
    DHCP client on a single network. If left empty, it defaults to the hardware
    address of the network interface. However, if you are running several
    virtual machines using the same network interface and, therefore, the same
    hardware address, specify a unique free-form identifier here.
   </p><p>
    The <span class="guimenu">Hostname to Send</span> specifies a string used for the
    host name option field when the DHCP client sends messages to DHCP server.
    Some DHCP servers update name server zones (forward and reverse records)
    according to this host name (Dynamic DNS). Also, some DHCP servers require
    the <span class="guimenu">Hostname to Send</span> option field to contain a specific
    string in the DHCP messages from clients. Leave <code class="literal">AUTO</code> to
    send the current host name (that is the one defined in
    <code class="filename">/etc/HOSTNAME</code>). Make the option field empty for not
    sending any host name.
   </p><p>
    If you do not want to change the default route according to the information
    from DHCP, deactivate <span class="guimenu">Change Default Route via DHCP</span>.
   </p></div><div class="sect3 " id="sec.network.yast.netcard.change"><div class="titlepage"><div><div><h4 class="title" id="sec.network.yast.netcard.change"><span class="number">13.4.1.2 </span><span class="name">Changing the Configuration of a Network Card</span> <a title="Permalink" class="permalink" href="#sec.network.yast.netcard.change">#</a></h4></div></div></div><p>
    To change the configuration of a network card, select a card from the list
    of the detected cards in <span class="guimenu">Network Settings</span> › <span class="guimenu">Overview</span> in YaST and click
    <span class="guimenu">Edit</span>. The <span class="guimenu">Network Card Setup</span> dialog
    appears in which to adjust the card configuration using the
    <span class="guimenu">General</span>, <span class="guimenu">Address</span> and
    <span class="guimenu">Hardware</span> tabs.
   </p><div class="sect4 " id="sec.network.yast.change.address"><div class="titlepage"><div><div><h5 class="title" id="sec.network.yast.change.address"><span class="number">13.4.1.2.1 </span><span class="name">Configuring IP Addresses</span> <a title="Permalink" class="permalink" href="#sec.network.yast.change.address">#</a></h5></div></div></div><p>
     You can set the IP address of the network card or the way its IP address
     is determined in the <span class="guimenu">Address</span> tab of the
     <span class="guimenu">Network Card Setup</span> dialog. Both IPv4 and IPv6 addresses
     are supported. The network card can have <span class="guimenu">No IP Address</span>
     (which is useful for bonding devices), a <span class="guimenu">Statically Assigned IP
     Address</span> (IPv4 or IPv6) or a <span class="guimenu">Dynamic Address</span>
     assigned via <span class="guimenu">DHCP</span> or <span class="guimenu">Zeroconf</span> or
     both.
    </p><p>
     If using <span class="guimenu">Dynamic Address</span>, select whether to use
     <span class="guimenu">DHCP Version 4 Only</span> (for IPv4), <span class="guimenu">DHCP Version 6
     Only</span> (for IPv6) or <span class="guimenu">DHCP Both Version 4 and 6</span>.
    </p><p>
     If possible, the first network card with link that is available during the
     installation is automatically configured to use automatic address setup
     via DHCP. 
    </p><p>
     DHCP should also be used if you are using a DSL line but with no static IP
     assigned by the ISP (Internet Service Provider). If you decide to use
     DHCP, configure the details in <span class="guimenu">DHCP Client Options</span> in
     the <span class="guimenu">Global Options</span> tab of the <span class="guimenu">Network
     Settings</span> dialog of the YaST network card configuration module.
     If you have a virtual host setup where different hosts communicate through
     the same interface, an <span class="guimenu">DHCP Client Identifier</span> is
     necessary to distinguish them.
    </p><p>
     DHCP is a good choice for client configuration but it is not ideal for
     server configuration. To set a static IP address, proceed as follows:
    </p><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
       Select a card from the list of detected cards in the
       <span class="guimenu">Overview</span> tab of the YaST network card configuration
       module and click <span class="guimenu">Edit</span>.
      </p></li><li class="step "><p>
       In the <span class="guimenu">Address</span> tab, choose <span class="guimenu">Statically
       Assigned IP Address</span>.
      </p></li><li class="step "><p>
       Enter the <span class="guimenu">IP Address</span>. Both IPv4 and IPv6 addresses
       can be used. Enter the network mask in <span class="guimenu">Subnet Mask</span>.
       If the IPv6 address is used, use <span class="guimenu">Subnet Mask</span> for
       prefix length in format <code class="literal">/64</code>.
      </p><p>
       Optionally, you can enter a fully qualified <span class="guimenu">Hostname</span>
       for this address, which will be written to the
       <code class="filename">/etc/hosts</code> configuration file.
      </p></li><li class="step "><p>
       Click <span class="guimenu">Next</span>.
      </p></li><li class="step "><p>
       To activate the configuration, click <span class="guimenu">OK</span>.
      </p></li></ol></div></div><div id="idm140019139315056" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note: Interface Activation and Link Detection</h6><p>
      During activation of a network interface, <code class="command">wicked</code>
      checks for a carrier and only applies the IP configuration when a link
      has been detected. If you need to apply the configuration regardless of
      the link status (for example, when you want to test a service listening to a
      certain address), you can skip link detection by adding the variable
      <code class="literal">LINK_REQUIRED=no</code> to the configuration file of the
      interface in <code class="filename">/etc/sysconfig/network/ifcfg</code>.
     </p><p>
      Additionally, you can use the variable
      <code class="literal">LINK_READY_WAIT=<em class="replaceable ">5</em></code> to
      specify the timeout for waiting for a link in seconds.
     </p><p>
      For more information about the <code class="filename">ifcfg-*</code> configuration
      files, refer to <a class="xref" href="#sec.network.manconf.files.ifcfg" title="13.6.2.5. /etc/sysconfig/network/ifcfg-*">Section 13.6.2.5, “<code class="filename">/etc/sysconfig/network/ifcfg-*</code>”</a> and
      <code class="command">man 5 ifcfg</code>.
     </p></div><p>
     If you use the static address, the name servers and default gateway are
     not configured automatically. To configure name servers, proceed as
     described in <a class="xref" href="#sec.network.yast.change.host" title="13.4.1.4. Configuring Host Name and DNS">Section 13.4.1.4, “Configuring Host Name and DNS”</a>. To configure
     a gateway, proceed as described in
     <a class="xref" href="#sec.network.yast.change.route" title="13.4.1.5. Configuring Routing">Section 13.4.1.5, “Configuring Routing”</a>.
    </p></div><div class="sect4 " id="sec.network.yast.configure.addresses"><div class="titlepage"><div><div><h5 class="title" id="sec.network.yast.configure.addresses"><span class="number">13.4.1.2.2 </span><span class="name">Configuring Multiple Addresses</span> <a title="Permalink" class="permalink" href="#sec.network.yast.configure.addresses">#</a></h5></div></div></div><p>
     One network device can have multiple IP addresses.
    </p><div id="idm140019139305072" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note: Aliases Are a Compatibility Feature</h6><p>
      These so-called aliases or labels, respectively, work with IPv4 only.
      With IPv6 they will be ignored. Using <code class="command">iproute2</code> network
      interfaces can have one or more addresses.
     </p></div><p>
     Using YaST to set additional addresses for your network card, proceed as
     follows:
    </p><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
       Select a card from the list of detected cards in the
       <span class="guimenu">Overview</span> tab of the YaST <span class="guimenu">Network
       Settings</span> dialog and click <span class="guimenu">Edit</span>.
      </p></li><li class="step "><p>
       In the <span class="guimenu">Address</span> › <span class="guimenu">Additional
       Addresses</span> tab, click <span class="guimenu">Add</span>.
      </p></li><li class="step "><p>
       Enter <span class="guimenu">IPv4 Address Label</span>, <span class="guimenu">IP
       Address</span>, and <span class="guimenu">Netmask</span>. Do not include the
       interface name in the alias name.
      </p></li><li class="step "><p>
       To activate the configuration, confirm the settings.
      </p></li></ol></div></div></div><div class="sect4 " id="sec.network.yast.change.udev"><div class="titlepage"><div><div><h5 class="title" id="sec.network.yast.change.udev"><span class="number">13.4.1.2.3 </span><span class="name">Changing the Device Name and Udev Rules</span> <a title="Permalink" class="permalink" href="#sec.network.yast.change.udev">#</a></h5></div></div></div><p>
     It is possible to change the device name of the network card when it is
     used. It is also possible to determine whether the network card should be
     identified by udev via its hardware (MAC) address or via the bus ID. The
     later option is preferable in large servers to simplify hotplugging of
     cards. To set these options with YaST, proceed as follows:
    </p><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
       Select a card from the list of detected cards in the
       <span class="guimenu">Overview</span> tab of the YaST <span class="guimenu">Network
       Settings</span> dialog and click <span class="guimenu">Edit</span>.
      </p></li><li class="step "><p>
       Go to the <span class="guimenu">Hardware</span> tab. The current device name is
       shown in <span class="guimenu">Udev Rules</span>. Click <span class="guimenu">Change</span>.
      </p></li><li class="step "><p>
       Select whether udev should identify the card by its <span class="guimenu">MAC
       Address</span> or <span class="guimenu">Bus ID</span>. The current MAC address
       and bus ID of the card are shown in the dialog.
      </p></li><li class="step "><p>
       To change the device name, check the <span class="guimenu">Change Device
       Name</span> option and edit the name.
      </p></li><li class="step "><p>
       To activate the configuration, confirm the settings.
      </p></li></ol></div></div></div><div class="sect4 " id="sec.network.yast.change.driver"><div class="titlepage"><div><div><h5 class="title" id="sec.network.yast.change.driver"><span class="number">13.4.1.2.4 </span><span class="name">Changing Network Card Kernel Driver</span> <a title="Permalink" class="permalink" href="#sec.network.yast.change.driver">#</a></h5></div></div></div><p>
     For some network cards, several kernel drivers may be available. If the
     card is already configured, YaST allows you to select a kernel driver to
     be used from a list of available suitable drivers. It is also possible to
     specify options for the kernel driver. To set these options with YaST,
     proceed as follows:
    </p><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
       Select a card from the list of detected cards in the
       <span class="guimenu">Overview</span> tab of the YaST Network Settings module
       and click <span class="guimenu">Edit</span>.
      </p></li><li class="step "><p>
       Go to the <span class="guimenu">Hardware</span> tab.
      </p></li><li class="step "><p>
       Select the kernel driver to be used in <span class="guimenu">Module Name</span>.
       Enter any options for the selected driver in <span class="guimenu">Options</span>
       in the form

       <code class="command">=</code> =<em class="replaceable ">VALUE</em>. If more options
       are used, they should be space-separated.
      </p></li><li class="step "><p>
       To activate the configuration, confirm the settings.
      </p></li></ol></div></div></div><div class="sect4 " id="sec.network.yast.change.start"><div class="titlepage"><div><div><h5 class="title" id="sec.network.yast.change.start"><span class="number">13.4.1.2.5 </span><span class="name">Activating the Network Device</span> <a title="Permalink" class="permalink" href="#sec.network.yast.change.start">#</a></h5></div></div></div><p>
     If you use the method with <code class="command">wicked</code>, you can configure
     your device to either start during boot, on cable connection, on card
     detection, manually, or never. To change device start-up, proceed as
     follows:
    </p><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
       In YaST select a card from the list of detected cards in <span class="guimenu">System</span> › <span class="guimenu">Network Settings</span> and click <span class="guimenu">Edit</span>.
      </p></li><li class="step "><p>
       In the <span class="guimenu">General</span> tab, select the desired entry from
       <span class="guimenu">Device Activation</span>.
      </p><p>
       Choose <span class="guimenu">At Boot Time</span> to start the device during the
       system boot. With <span class="guimenu">On Cable Connection</span>, the interface
       is watched for any existing physical connection. With <span class="guimenu">On
       Hotplug</span>, the interface is set when available. It is similar to
       the <span class="guimenu">At Boot Time</span> option, and only differs in that no
       error occurs if the interface is not present at boot time. Choose
       <span class="guimenu">Manually</span> to control the interface manually with
       <code class="command">ifup</code>. Choose <span class="guimenu">Never</span> to not start
       the device. The <span class="guimenu">On NFSroot</span> is similar to <span class="guimenu">At
       Boot Time</span>, but the interface does not shut down with the
       <code class="command">systemctl stop network</code> command; the
       <code class="option">network</code> service also cares about the
       <code class="option">wicked</code> service if <code class="command">wicked</code> is active.
       Use this if you use an NFS or iSCSI root file system.
      </p></li><li class="step "><p>
       To activate the configuration, confirm the settings.
      </p></li></ol></div></div><div id="idm140019139257744" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.png" /><h6>Tip: NFS as a Root File System</h6><p>
      On (diskless) systems where the root partition is mounted via network as
      an NFS share, you need to be careful when configuring the network device
      with which the NFS share is accessible.
     </p><p>
      When shutting down or rebooting the system, the default processing order
      is to turn off network connections, then unmount the root partition. With
      NFS root, this order causes problems as the root partition cannot be
      cleanly unmounted as the network connection to the NFS share is already
      not activated. To prevent the system from deactivating the relevant
      network device, open the network device configuration tab as described in
      <a class="xref" href="#sec.network.yast.change.start" title="13.4.1.2.5. Activating the Network Device">Section 13.4.1.2.5, “Activating the Network Device”</a> and choose <span class="guimenu">On
      NFSroot</span> in the <span class="guimenu">Device Activation</span> pane.
     </p></div></div><div class="sect4 " id="sec.network.yast.change.mtu"><div class="titlepage"><div><div><h5 class="title" id="sec.network.yast.change.mtu"><span class="number">13.4.1.2.6 </span><span class="name">Setting Up Maximum Transfer Unit Size</span> <a title="Permalink" class="permalink" href="#sec.network.yast.change.mtu">#</a></h5></div></div></div><p>
     You can set a maximum transmission unit (MTU) for the interface. MTU
     refers to the largest allowed packet size in bytes. A higher MTU brings
     higher bandwidth efficiency. However, large packets can block up a slow
     interface for some time, increasing the lag for further packets.
    </p><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
       In YaST select a card from the list of detected cards in <span class="guimenu">System</span> › <span class="guimenu">Network Settings</span> and click <span class="guimenu">Edit</span>.
      </p></li><li class="step "><p>
       In the <span class="guimenu">General</span> tab, select the desired entry from the
       <span class="guimenu">Set MTU</span> list.
      </p></li><li class="step "><p>
       To activate the configuration, confirm the settings.
      </p></li></ol></div></div></div><div class="sect4 " id="sec.network.yast.change.pciemulti"><div class="titlepage"><div><div><h5 class="title" id="sec.network.yast.change.pciemulti"><span class="number">13.4.1.2.7 </span><span class="name">PCIe Multifunction Devices</span> <a title="Permalink" class="permalink" href="#sec.network.yast.change.pciemulti">#</a></h5></div></div></div><p>
     Multifunction devices that support LAN, iSCSI, and FCoE are supported.
     YaST FCoE client (<code class="command">yast2 fcoe-client</code>) shows the private
     flags in additional columns to allow the user to select the device meant
     for FCoE. YaST network module (<code class="command">yast2 lan</code>) excludes
     <span class="quote">“<span class="quote">storage only devices</span>”</span> for network configuration.
    </p></div><div class="sect4 " id="sec.network.yast.change.infiniband"><div class="titlepage"><div><div><h5 class="title" id="sec.network.yast.change.infiniband"><span class="number">13.4.1.2.8 </span><span class="name">Infiniband Configuration for IP-over-InfiniBand (IPoIB)</span> <a title="Permalink" class="permalink" href="#sec.network.yast.change.infiniband">#</a></h5></div></div></div><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
       In YaST select the InfiniBand device in <span class="guimenu">System</span> › <span class="guimenu">Network Settings</span> and click <span class="guimenu">Edit</span>.
      </p></li><li class="step "><p>
       In the <span class="guimenu">General</span> tab, select one of the
       <span class="guimenu">IP-over-InfiniBand</span> (IPoIB) modes:
       <span class="guimenu">connected</span> (default) or <span class="guimenu">datagram</span>.
      </p></li><li class="step "><p>
       To activate the configuration, confirm the settings.
      </p></li></ol></div></div><p>
     For more information about InfiniBand, see
     <code class="filename">/usr/src/linux/Documentation/infiniband/ipoib.txt</code>.
    </p></div><div class="sect4 " id="sec.network.yast.change.fire"><div class="titlepage"><div><div><h5 class="title" id="sec.network.yast.change.fire"><span class="number">13.4.1.2.9 </span><span class="name">Configuring the Firewall</span> <a title="Permalink" class="permalink" href="#sec.network.yast.change.fire">#</a></h5></div></div></div><p>
     Without having to perform the detailed firewall setup as described in
     <span class="intraxref">Book “<em class="citetitle ">Security Guide</em>”, Chapter 15 “Masquerading and Firewalls”, Section 15.4 “<code class="systemitem">firewalld</code>”</span>, you can determine the
     basic firewall configuration for your device as part of the device setup.
     Proceed as follows:
    </p><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
       Open the YaST <span class="guimenu">System</span> › <span class="guimenu">Network
       Settings</span> module. In the
       <span class="guimenu">Overview</span> tab, select a card from the list of detected
       cards and click <span class="guimenu">Edit</span>.
      </p></li><li class="step "><p>
       Enter the <span class="guimenu">General</span> tab of the <span class="guimenu">Network
       Settings</span> dialog.
      </p></li><li class="step "><p>
       Determine the <span class="guimenu">Firewall Zone</span> to which your interface
       should be assigned. The following options are available:
      </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019139223808"><span class="term ">Firewall Disabled</span></dt><dd><p>
          This option is available only if the firewall is disabled and the
          firewall does not run. Only use this option if your machine is part
          of a greater network that is protected by an outer firewall.
         </p></dd><dt id="idm140019139221792"><span class="term ">Automatically Assign Zone</span></dt><dd><p>
          This option is available only if the firewall is enabled. The
          firewall is running and the interface is automatically assigned to a
          firewall zone. The zone which contains the keyword
          <code class="literal">any</code> or the external zone will be used for such an
          interface.
         </p></dd><dt id="idm140019139219264"><span class="term ">Internal Zone (Unprotected)</span></dt><dd><p>
          The firewall is running, but does not enforce any rules to protect
          this interface. Use this option if your machine is part of a greater
          network that is protected by an outer firewall. It is also useful for
          the interfaces connected to the internal network, when the machine
          has more network interfaces.
         </p></dd><dt id="idm140019139217104"><span class="term ">Demilitarized Zone</span></dt><dd><p>
          A demilitarized zone is an additional line of defense in front of an
          internal network and the (hostile) Internet. Hosts assigned to this
          zone can be reached from the internal network and from the Internet,
          but cannot access the internal network.
         </p></dd><dt id="idm140019139215024"><span class="term ">External Zone</span></dt><dd><p>
          The firewall is running on this interface and fully protects it
          against other—presumably hostile—network traffic. This is
          the default option.
         </p></dd></dl></div></li><li class="step "><p>
       To activate the configuration, confirm the settings.
      </p></li></ol></div></div></div></div><div class="sect3 " id="sec.network.yast.netcard.man"><div class="titlepage"><div><div><h4 class="title" id="sec.network.yast.netcard.man"><span class="number">13.4.1.3 </span><span class="name">Configuring an Undetected Network Card</span> <a title="Permalink" class="permalink" href="#sec.network.yast.netcard.man">#</a></h4></div></div></div><p>
    If a network card is not detected correctly, the card is not included in
    the list of detected cards. If you are sure that your system includes a
    driver for your card, you can configure it manually. You can also configure
    special network device types, such as bridge, bond, TUN or TAP. To
    configure an undetected network card (or a special device) proceed as
    follows:
   </p><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
      In the <span class="guimenu">System</span> › <span class="guimenu">Network
      Settings</span> › <span class="guimenu">Overview</span> dialog in
      YaST click <span class="guimenu">Add</span>.
     </p></li><li class="step "><p>
      In the <span class="guimenu">Hardware</span> dialog, set the <span class="guimenu">Device
      Type</span> of the interface from the available options and
      <span class="guimenu">Configuration Name</span>. If the network card is an
      USB device, activate the respective check box and exit this dialog with
      <span class="guimenu">Next</span>. Otherwise, you can define the kernel
      <span class="guimenu">Module Name</span> to be used for the card and its
      <span class="guimenu">Options</span>, if necessary.
     </p><p>
      In <span class="guimenu">Ethtool Options</span>, you can set
      <code class="command">ethtool</code> options used by <code class="command">ifup</code> for
      the interface. For information about available options, see the
      <code class="command">ethtool</code> manual page.
     </p><p>
      If the option string starts with a
      <code class="literal">-</code> (for example, <code class="literal">-K
      <em class="replaceable ">INTERFACE_NAME</em> rx on</code>), the second
      word in the string is replaced with the current interface name. Otherwise
      (for example, <code class="literal">autoneg off speed 10</code>)
      <code class="command">ifup</code> adds <code class="literal">-s
      <em class="replaceable ">INTERFACE_NAME</em></code> to the beginning.
     </p></li><li class="step "><p>
      Click <span class="guimenu">Next</span>.
     </p></li><li class="step "><p>
      Configure any needed options, such as the IP address, device activation
      or firewall zone for the interface in the <span class="guimenu">General</span>,
      <span class="guimenu">Address</span>, and <span class="guimenu">Hardware</span> tabs. For
      more information about the configuration options, see
      <a class="xref" href="#sec.network.yast.netcard.change" title="13.4.1.2. Changing the Configuration of a Network Card">Section 13.4.1.2, “Changing the Configuration of a Network Card”</a>.
     </p></li><li class="step "><p>
      If you selected <span class="guimenu">Wireless</span> as the device type of the
      interface, configure the wireless connection in the next dialog.
     </p></li><li class="step "><p>
      To activate the new network configuration, confirm the settings.
     </p></li></ol></div></div></div><div class="sect3 " id="sec.network.yast.change.host"><div class="titlepage"><div><div><h4 class="title" id="sec.network.yast.change.host"><span class="number">13.4.1.4 </span><span class="name">Configuring Host Name and DNS</span> <a title="Permalink" class="permalink" href="#sec.network.yast.change.host">#</a></h4></div></div></div><p>
    If you did not change the network configuration during installation and the
    Ethernet card was already available, a host name was automatically
    generated for your computer and DHCP was activated. The same applies to the
    name service information your host needs to integrate into a network
    environment. If DHCP is used for network address setup, the list of domain
    name servers is automatically filled with the appropriate data. If a static
    setup is preferred, set these values manually.
   </p><p>
    To change the name of your computer and adjust the name server search list,
    proceed as follows:
   </p><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
      Go to the <span class="guimenu">Network Settings</span> › <span class="guimenu">Hostname/DNS</span> tab in the
      <span class="guimenu">System</span> module in YaST.
     </p></li><li class="step "><p>
      Enter the <span class="guimenu">Hostname</span> and, if needed, the <span class="guimenu">Domain
      Name</span>. The domain is especially important if the machine is a
      mail server. Note that the host name is global and applies to all set
      network interfaces.
     </p><p>
      If you are using DHCP to get an IP address, the host name of your
      computer will be automatically set by the DHCP. You should disable this
      behavior if you connect to different networks, because they may assign
      different host names and changing the host name at runtime may confuse
      the graphical desktop. To disable using DHCP to get an IP address
      deactivate <span class="guimenu">Change Hostname via DHCP</span>.
     </p><p>
      <span class="guimenu">Assign Hostname to Loopback IP</span> associates your host
      name with <code class="literal">127.0.0.2</code> (loopback) IP address in
      <code class="filename">/etc/hosts</code>. This is a useful option if you want to
      have the host name resolvable at all times, even without active network.
     </p></li><li class="step "><p>
      In <span class="guimenu">Modify DNS Configuration</span>, select the way the DNS
      configuration (name servers, search list, the content of the
      <code class="filename">/etc/resolv.conf</code> file) is modified.
     </p><p>
      If the <span class="guimenu">Use Default Policy</span> option is selected, the
      configuration is handled by the <code class="command">netconfig</code> script which
      merges the data defined statically (with YaST or in the configuration
      files) with data obtained dynamically (from the DHCP client or
      NetworkManager). This default policy is usually sufficient.
     </p><p>
      If the <span class="guimenu">Only Manually</span> option is selected,
      <code class="command">netconfig</code> is not allowed to modify the
      <code class="filename">/etc/resolv.conf</code> file. However, this file can be
      edited manually.
     </p><p>
      If the <span class="guimenu">Custom Policy</span> option is selected, a
      <span class="guimenu">Custom Policy Rule</span> string defining the merge policy
      should be specified. The string consists of a comma-separated list of
      interface names to be considered a valid source of settings. Except for
      complete interface names, basic wild cards to match multiple interfaces
      are allowed, as well. For example, <code class="literal">eth* ppp?</code> will
      first target all eth and then all ppp0-ppp9 interfaces. There are two
      special policy values that indicate how to apply the static settings
      defined in the <code class="filename">/etc/sysconfig/network/config</code> file:
     </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019139170128"><span class="term "><code class="literal">STATIC</code>
       </span></dt><dd><p>
         The static settings need to be merged together with the dynamic
         settings.
        </p></dd><dt id="idm140019139167968"><span class="term "><code class="literal">STATIC_FALLBACK</code>
       </span></dt><dd><p>
         The static settings are used only when no dynamic configuration is
         available.
        </p></dd></dl></div><p>
      For more information, see the man page of <code class="command">netconfig</code>(8)
      (<code class="command">man 8 netconfig</code>).
     </p></li><li class="step "><p>
      Enter the <span class="guimenu">Name Servers</span> and fill in the <span class="guimenu">Domain
      Search</span> list. Name servers must be specified by IP addresses,
      such as 192.168.1.116, not by host names. Names specified in the
      <span class="guimenu">Domain Search</span> tab are domain names used for resolving
      host names without a specified domain. If more than one <span class="guimenu">Domain
      Search</span> is used, separate domains with commas or white space.
     </p></li><li class="step "><p>
      To activate the configuration, confirm the settings.
     </p></li></ol></div></div><p>
    It is also possible to edit the host name using YaST from the command
    line. The changes made by YaST take effect immediately (which is not the
    case when editing the <code class="filename">/etc/HOSTNAME</code> file manually). To
    change the host name, use the following command:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>yast dns edit hostname=<em class="replaceable ">HOSTNAME</em></pre></div><p>
    To change the name servers, use the following commands:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>yast dns edit nameserver1=192.168.1.116
<code class="prompt root">root # </code>yast dns edit nameserver2=192.168.1.117
<code class="prompt root">root # </code>yast dns edit nameserver3=192.168.1.118</pre></div></div><div class="sect3 " id="sec.network.yast.change.route"><div class="titlepage"><div><div><h4 class="title" id="sec.network.yast.change.route"><span class="number">13.4.1.5 </span><span class="name">Configuring Routing</span> <a title="Permalink" class="permalink" href="#sec.network.yast.change.route">#</a></h4></div></div></div><p>
    To make your machine communicate with other machines and other networks,
    routing information must be given to make network traffic take the correct
    path. If DHCP is used, this information is automatically provided. If a
    static setup is used, this data must be added manually.
   </p><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
      In YaST go to <span class="guimenu">Network Settings</span> › <span class="guimenu">Routing</span>.
     </p></li><li class="step "><p>
      Enter the IP address of the <span class="guimenu">Default Gateway</span> (IPv4 and
      IPv6 if necessary). The default gateway matches every possible
      destination, but if a routing table entry exists that matches the
      required address, this will be used instead of the default route via the
      Default Gateway.
     </p></li><li class="step "><p>
      More entries can be entered in the <span class="guimenu">Routing Table</span>.
      Enter the <span class="guimenu">Destination</span> network IP address,
      <span class="guimenu">Gateway</span> IP address and the <span class="guimenu">Netmask</span>.
      Select the <span class="guimenu">Device</span> through which the traffic to the
      defined network will be routed (the minus sign stands for any device).
      
      To omit any of these values, use the minus sign <code class="literal">-</code>. To
      enter a default gateway into the table, use <code class="literal">default</code> in
      the <span class="guimenu">Destination</span> field.
     </p><div id="idm140019139143344" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note: Route Prioritization</h6><p>
       If more default routes are used, it is possible to specify the metric
       option to determine which route has a higher priority. To specify the
       metric option, enter <code class="option">- metric
       <em class="replaceable ">NUMBER</em></code> in
       <span class="guimenu">Options</span>. The route with the highest metric is used as
       default. If the network device is disconnected, its route will be
       removed and the next one will be used. However, the current kernel does
       not use metric in static routing, only routing daemons like
       <code class="systemitem">multipathd</code> do.
      </p></div></li><li class="step "><p>
      If the system is a router, enable <span class="guimenu">IPv4 Forwarding</span> and
      <span class="guimenu">IPv6 Forwarding</span> in the <span class="guimenu">Network
      Settings</span> as needed.
     </p></li><li class="step "><p>
      To activate the configuration, confirm the settings.
     </p></li></ol></div></div></div></div></div><div class="sect1 " id="sec.network.nm"><div class="titlepage"><div><div><h2 class="title" id="sec.network.nm"><span class="number">13.5 </span><span class="name">NetworkManager</span> <a title="Permalink" class="permalink" href="#sec.network.nm">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">Filename: </span>networkmanager.xml</li><li><span class="ds-label">ID: </span>sec.network.nm</li></ul></div></div></div></div><p>
  NetworkManager is the ideal solution for laptops and other portable computers.
  With NetworkManager, you do not need to worry about configuring network
  interfaces and switching between networks when you are moving.
 </p><div class="sect2 " id="sec.network.nm.comparison"><div class="titlepage"><div><div><h3 class="title" id="sec.network.nm.comparison"><span class="number">13.5.1 </span><span class="name">NetworkManager and <code class="command">wicked</code></span> <a title="Permalink" class="permalink" href="#sec.network.nm.comparison">#</a></h3></div></div></div><p>
   However, NetworkManager is not a suitable solution for all cases, so you can
   still choose between the <code class="command">wicked</code> controlled method for
   managing network connections and NetworkManager. If you want to manage your
   network connection with NetworkManager, enable NetworkManager in the YaST Network
   Settings module as described in <a class="xref" href="#sec.nm.activate" title="28.2. Enabling or Disabling NetworkManager">Section 28.2, “Enabling or Disabling NetworkManager”</a> and
   configure your network connections with NetworkManager. For a list of use cases
   and a detailed description of how to configure and use NetworkManager, refer to
   <a class="xref" href="#cha.nm" title="Chapter 28. Using NetworkManager">Chapter 28, <em>Using NetworkManager</em></a>.
  </p><p>
   Some differences between wicked and NetworkManager:
  </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019139126336"><span class="term "><code class="systemitem">root</code> Privileges</span></dt><dd><p>
      If you use NetworkManager for network setup, you can easily switch, stop or
      start your network connection at any time from within your desktop
      environment using an applet. NetworkManager also makes it possible to change
      and configure wireless card connections without requiring
      <code class="systemitem">root</code> privileges. For this reason, NetworkManager is the ideal
      solution for a mobile workstation.
     </p><p>
      <code class="command">wicked</code> also provides some ways to switch, stop or
      start the connection with or without user intervention, like
      user-managed devices. However, this always requires <code class="systemitem">root</code>
      privileges to change or configure a network device. This is often a
      problem for mobile computing, where it is not possible to preconfigure
      all the connection possibilities.
     </p></dd><dt id="idm140019139120928"><span class="term ">Types of Network Connections</span></dt><dd><p>
      Both <code class="command">wicked</code> and NetworkManager can handle network
      connections with a wireless network (with WEP, WPA-PSK, and
      WPA-Enterprise access) and wired networks using DHCP and static
      configuration. They also support connection through dial-up and VPN.
      With NetworkManager you can also connect a mobile broadband (3G) modem
      or set up a DSL connection, which is not possible with the traditional
      configuration.
     </p><p>
      NetworkManager tries to keep your computer connected at all times using the
      best connection available. If the network cable is accidentally
      disconnected, it tries to reconnect. It can find the network with the
      best signal strength from the list of your wireless connections and
      automatically use it to connect. To get the same functionality with
      <code class="command">wicked</code>, more configuration effort is required.
     </p></dd></dl></div></div><div class="sect2 " id="sec.network.nm.functionality"><div class="titlepage"><div><div><h3 class="title" id="sec.network.nm.functionality"><span class="number">13.5.2 </span><span class="name">NetworkManager Functionality and Configuration Files</span> <a title="Permalink" class="permalink" href="#sec.network.nm.functionality">#</a></h3></div></div></div><p>
   The individual network connection settings created with NetworkManager are
   stored in configuration profiles. The <span class="emphasis"><em>system</em></span>
   connections configured with either NetworkManager or YaST are saved in
   <code class="filename">/etc/NetworkManager/system-connections/*</code> or in
   <code class="filename">/etc/sysconfig/network/ifcfg-*</code>. For GNOME, all
   user-defined connections are stored in GConf.
  </p><p>
   In case no profile is configured, NetworkManager automatically creates one and
   names it <code class="literal">Auto $INTERFACE-NAME</code>. That is made in an
   attempt to work without any configuration for as many cases as (securely)
   possible. If the automatically created profiles do not suit your needs,
   use the network connection configuration dialogs provided by GNOME to
   modify them as desired. For more information, see
   <a class="xref" href="#sec.nm.configure" title="28.3. Configuring Network Connections">Section 28.3, “Configuring Network Connections”</a>.
  </p></div><div class="sect2 " id="sec.network.nm.policykit"><div class="titlepage"><div><div><h3 class="title" id="sec.network.nm.policykit"><span class="number">13.5.3 </span><span class="name">Controlling and Locking Down NetworkManager Features</span> <a title="Permalink" class="permalink" href="#sec.network.nm.policykit">#</a></h3></div></div></div><p>
   On centrally administered machines, certain NetworkManager features can be
   controlled or disabled with PolKit, for example if a user is allowed to
   modify administrator defined connections or if a user is allowed to
   define his own network configurations. To view or change the respective
   NetworkManager policies, start the graphical <span class="guimenu">Authorizations</span>
   tool for PolKit. In the tree on the left side, find them below the
   <span class="guimenu">network-manager-settings</span> entry. For an introduction to
   PolKit and details on how to use it, refer to
   <span class="intraxref">Book “<em class="citetitle ">Security Guide</em>”, Chapter 9 “Authorization with PolKit”</span>.
  </p></div></div><div class="sect1 " id="sec.network.manconf"><div class="titlepage"><div><div><h2 class="title" id="sec.network.manconf"><span class="number">13.6 </span><span class="name">Configuring a Network Connection Manually</span> <a title="Permalink" class="permalink" href="#sec.network.manconf">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">Filename: </span>net_wicked.xml</li><li><span class="ds-label">ID: </span>sec.network.manconf</li></ul></div></div></div></div><p>
  Manual configuration of the network software should be the last alternative.
  Using YaST is recommended. However, this background information about the
  network configuration can also assist your work with YaST.
 </p><div class="sect2 " id="sec.network.manconf.wicked"><div class="titlepage"><div><div><h3 class="title" id="sec.network.manconf.wicked"><span class="number">13.6.1 </span><span class="name">The <code class="command">wicked</code> Network Configuration</span> <a title="Permalink" class="permalink" href="#sec.network.manconf.wicked">#</a></h3></div></div></div><p>
   The tool and library called <code class="command">wicked</code> provides a new
   framework for network configuration.
  </p><p>
   One of the challenges with traditional network interface management is that
   different layers of network management get jumbled together into one single
   script, or at most two different scripts. These scripts interact with each other in a
   way that is not well-defined. This leads to unpredictable issues, obscure
   constraints and conventions, etc. Several layers of special hacks for a variety of different scenarios increase the maintenance
   burden. Address configuration protocols are being used that are implemented
   via daemons like dhcpcd, which interact rather poorly with the rest of the
   infrastructure. Funky interface naming schemes that require heavy udev
   support are introduced to achieve persistent identification of interfaces.
  </p><p>
   The idea of wicked is to decompose the problem in several ways. None of them
   is entirely novel, but trying to put ideas from different projects together
   is hopefully going to create a better solution overall.
  </p><p>
   One approach is to use a client/server model. This allows wicked to define
   standardized facilities for things like address configuration that are well
   integrated with the overall framework. For example, using a specific address
   configuration, the administrator may request that an interface should be
   configured via DHCP or IPv4 zeroconf. In this case, the address configuration
   service simply obtains the lease from its server and passes it on to the
   wicked server process that installs the requested addresses and routes.
  </p><p>
   The other approach to decomposing the problem is to enforce the layering
   aspect. For any type of network interface, it is possible to define a dbus
   service that configures the network interface's device layer—a VLAN, a
   bridge, a bonding, or a paravirtualized device. Common functionality, such
   as address configuration, is implemented by joint services that are layered
   on top of these device specific services without having to implement them
   specifically.
  </p><p>
   The wicked framework implements these two aspects by using a variety of dbus
   services, which get attached to a network interface depending on its type.
   Here is a rough overview of the current object hierarchy in wicked.
  </p><p>
   Each network interface is represented via a child object of
   <code class="systemitem">/org/opensuse/Network/Interfaces</code>. The name of the
   child object is given by its ifindex. For example, the loopback interface,
   which usually gets ifindex 1, is
   <code class="systemitem">/org/opensuse/Network/Interfaces/1</code>, the first
   Ethernet interface registered is
   <code class="systemitem">/org/opensuse/Network/Interfaces/2</code>.
  </p><p>
   Each network interface has a <span class="quote">“<span class="quote">class</span>”</span> associated with it, which
   is used to select the dbus interfaces it supports. By default, each network
   interface is of class <code class="literal">netif</code>, and
   <code class="systemitem">wickedd</code> will automatically
   attach all interfaces compatible with this class. In the current
   implementation, this includes the following interfaces:
  </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019139091040"><span class="term ">org.opensuse.Network.Interface</span></dt><dd><p>
      Generic network interface functions, such as taking the link up or down,
      assigning an MTU, etc.
     </p></dd><dt id="idm140019139089136"><span class="term ">org.opensuse.Network.Addrconf.ipv4.dhcp, </span><span class="term ">org.opensuse.Network.Addrconf.ipv6.dhcp, </span><span class="term ">org.opensuse.Network.Addrconf.ipv4.auto</span></dt><dd><p>
      Address configuration services for DHCP,

      IPv4 zeroconf, etc.
     </p></dd></dl></div><p>
   Beyond this, network interfaces may require or offer special configuration
   mechanisms. For an Ethernet device, for example, you should be able to
   control the link speed, offloading of checksumming, etc. To achieve this,
   Ethernet devices have a class of their own, called
   <code class="literal">netif-ethernet</code>, which is a subclass of
   <code class="literal">netif</code>. As a consequence, the dbus interfaces assigned to
   an Ethernet interface include all the services listed above, plus the
   <code class="systemitem">org.opensuse.Network.Ethernet</code> service available only to objects belonging to the <code class="literal">netif-ethernet</code>
   class.
  </p><p>
   Similarly, there exist classes for interface types like bridges, VLANs,
   bonds, or infinibands.
  </p><p>
   How do you interact with an interface like VLAN (which is really a virtual network interface that
   sits on top of an Ethernet device) that needs to be created
   first? For this, wicked defines factory
   interfaces, such as
   <code class="systemitem">org.opensuse.Network.VLAN.Factory</code>. Such a factory
   interface offers a single function that lets you create an interface of the
   requested type. These factory interfaces are attached to the
   <code class="systemitem">/org/opensuse/Network/Interfaces</code> list node.
  </p><div class="sect3 " id="sec.network.manconf.supported"><div class="titlepage"><div><div><h4 class="title" id="sec.network.manconf.supported"><span class="number">13.6.1.1 </span><span class="name"><code class="literal">wicked</code> Architecture and Features</span> <a title="Permalink" class="permalink" href="#sec.network.manconf.supported">#</a></h4></div></div></div><p>
    The <code class="literal">wicked</code> service comprises several parts as depicted
    in <a class="xref" href="#wicked.architecture" title="wicked architecture">Figure 13.4, “<code class="literal">wicked</code> architecture”</a>.
   </p><div class="figure" id="wicked.architecture"><div class="figure-contents"><div class="mediaobject"><a xmlns="" href="images/wicked_scheme.png"><img src="images/wicked_scheme.png" width="" alt="wicked architecture" /></a></div></div><div class="figure-title-wrap"><h6 class="figure-title"><span class="number">Figure 13.4: </span><span class="name"><code class="literal">wicked</code> architecture </span><a title="Permalink" class="permalink" href="#wicked.architecture">#</a></h6></div></div><p>
    <code class="literal">wicked</code> currently supports the following:
   </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
      Configuration file back-ends to parse SUSE style
      <code class="filename">/etc/sysconfig/network</code> files.
     </p></li><li class="listitem "><p>
      An internal configuration back-end to represent network interface
      configuration in XML.


     </p></li><li class="listitem "><p>
      Bring up and shutdown of <span class="quote">“<span class="quote">normal</span>”</span> network interfaces such as
      Ethernet or InfiniBand, VLAN, bridge, bonds, tun, tap, dummy, macvlan,
      macvtap, hsi, qeth, iucv, and wireless (currently limited to one
      wpa-psk/eap network) devices.
     </p></li><li class="listitem "><p>
      A built-in DHCPv4 client and a built-in DHCPv6 client.
     </p></li><li class="listitem "><p>
      The nanny daemon (enabled by default) helps to automatically bring up
      configured interfaces when the device is available (interface
      hotplugging) and set up the IP configuration when a link (carrier) is
      detected. See <a class="xref" href="#sec.network.manconf.using_nanny" title="13.6.1.3. Nanny">Section 13.6.1.3, “Nanny”</a> for more
      information.
     </p></li><li class="listitem "><p>
      <code class="literal">wicked</code> was implemented as a group of DBus services
      that are integrated with systemd. So the usual
      <code class="command">systemctl</code> commands will apply to
      <code class="literal">wicked</code>.
     </p></li></ul></div></div><div class="sect3 " id="sec.network.manconf.using_wicked"><div class="titlepage"><div><div><h4 class="title" id="sec.network.manconf.using_wicked"><span class="number">13.6.1.2 </span><span class="name">Using <code class="literal">wicked</code></span> <a title="Permalink" class="permalink" href="#sec.network.manconf.using_wicked">#</a></h4></div></div></div><p>
    On openSUSE Leap <code class="literal">wicked</code> is running by default on
    desktop or server hardware. On mobile hardware NetworkManager is running by
    default. If you want to check what is currently enabled and whether it is
    running, call:
   </p><div class="verbatim-wrap"><pre class="screen">systemctl status network</pre></div><p>
    If <code class="literal">wicked</code> is enabled, you will see something along these
    lines:
   </p><div class="verbatim-wrap"><pre class="screen">wicked.service - wicked managed network interfaces
    Loaded: loaded (/usr/lib/systemd/system/wicked.service; enabled)
    ...</pre></div><p>
    In case something different is running (for example, NetworkManager) and you want to
    switch to <code class="literal">wicked</code>, first stop what is running and then
    enable <code class="literal">wicked</code>:
   </p><div class="verbatim-wrap"><pre class="screen">systemctl is-active network &amp;&amp; \
systemctl stop      network
systemctl enable --force wicked</pre></div><p>
    This enables the wicked services, creates the
    <code class="filename">network.service</code> to <code class="filename">wicked.service</code>
    alias link, and starts the network at the next boot.
   </p><p>
    Starting the server process:
   </p><div class="verbatim-wrap"><pre class="screen">systemctl start wickedd</pre></div><p>
    This starts <code class="command">wickedd</code> (the main server) and associated
    supplicants:
   </p><div class="verbatim-wrap"><pre class="screen">/usr/lib/wicked/bin/wickedd-auto4 --systemd --foreground
/usr/lib/wicked/bin/wickedd-dhcp4 --systemd --foreground
/usr/lib/wicked/bin/wickedd-dhcp6 --systemd --foreground
/usr/sbin/wickedd --systemd --foreground
/usr/sbin/wickedd-nanny --systemd --foreground</pre></div><p>
    Then bringing up the network:
   </p><div class="verbatim-wrap"><pre class="screen">systemctl start wicked</pre></div><p>
    Alternatively use the <code class="filename">network.service</code> alias:
   </p><div class="verbatim-wrap"><pre class="screen">systemctl start network</pre></div><p>
    These commands are using the default or system configuration sources as
    defined in <code class="filename">/etc/wicked/client.xml</code>.
   </p><p>
    To enable debugging, set <code class="literal">WICKED_DEBUG</code> in
    <code class="filename">/etc/sysconfig/network/config</code>, for example:
   </p><div class="verbatim-wrap"><pre class="screen">WICKED_DEBUG="all"</pre></div><p>
    Or, to omit some:
   </p><div class="verbatim-wrap"><pre class="screen">WICKED_DEBUG="all,-dbus,-objectmodel,-xpath,-xml"</pre></div><p>
    Use the client utility to display interface information for all interfaces
    or the interface specified with <em class="replaceable ">IFNAME</em>:
   </p><div class="verbatim-wrap"><pre class="screen">wicked show all
wicked show <em class="replaceable ">IFNAME</em></pre></div><p>
    In XML output:
   </p><div class="verbatim-wrap"><pre class="screen">wicked show-xml all
wicked show-xml <em class="replaceable ">IFNAME</em></pre></div><p>
    Bringing up one interface:
   </p><div class="verbatim-wrap"><pre class="screen">wicked ifup eth0
wicked ifup wlan0
...</pre></div><p>
    Because there is no configuration source specified, the wicked client
    checks its default sources of configuration defined in
    <code class="filename">/etc/wicked/client.xml</code>:
   </p><div class="orderedlist "><ol class="orderedlist" type="1"><li class="listitem "><p>
      <code class="literal">firmware:</code> iSCSI Boot Firmware Table (iBFT)
     </p></li><li class="listitem "><p>
      <code class="literal">compat:</code> <code class="literal">ifcfg</code>
      files—implemented for compatibility
     </p></li></ol></div><p>
    Whatever <code class="literal">wicked</code> gets from those sources for a given
    interface is applied. The intended order of importance is
    <code class="literal">firmware</code>, then <code class="literal">compat</code>—this may
    be changed in the future.
   </p><p>
    For more information, see the <code class="command">wicked</code> man page.
   </p></div><div class="sect3 " id="sec.network.manconf.using_nanny"><div class="titlepage"><div><div><h4 class="title" id="sec.network.manconf.using_nanny"><span class="number">13.6.1.3 </span><span class="name">Nanny</span> <a title="Permalink" class="permalink" href="#sec.network.manconf.using_nanny">#</a></h4></div></div></div><p>
    Nanny is an event and policy driven daemon that is responsible for
    asynchronous or unsolicited scenarios such as hotplugging devices. Thus the
    nanny daemon helps with starting or restarting delayed or temporarily gone
    devices. Nanny monitors device and link changes, and integrates new devices
    defined by the current policy set. Nanny continues to set up even if
    <code class="command">ifup</code> already exited because of specified timeout
    constraints.
   </p><p>
    By default, the nanny daemon is active on the system. It is enabled in the
    <code class="filename">/etc/wicked/common.xml</code> configuration file:
   </p><div class="verbatim-wrap"><pre class="screen">&lt;config&gt;
  ...
  &lt;use-nanny&gt;true&lt;/use-nanny&gt;
&lt;/config&gt;</pre></div><p>
    This setting causes ifup and ifreload to apply a policy with the effective
    configuration to the nanny daemon; then, nanny configures
    <code class="systemitem">wickedd</code> and thus ensures
    hotplug support. It waits in the background for events or changes (such as
    new devices or carrier on).
   </p></div><div class="sect3 " id="sec.network.manconf.multiple"><div class="titlepage"><div><div><h4 class="title" id="sec.network.manconf.multiple"><span class="number">13.6.1.4 </span><span class="name">Bringing Up Multiple Interfaces</span> <a title="Permalink" class="permalink" href="#sec.network.manconf.multiple">#</a></h4></div></div></div><p>
    For bonds and bridges, it may make sense to define the entire device
    topology in one file (ifcfg-bondX), and bring it up in one go. wicked then
    can bring up the whole configuration if you specify the top level interface
    names (of the bridge or bond):
   </p><div class="verbatim-wrap"><pre class="screen">wicked ifup br0</pre></div><p>
    This command automatically sets up the bridge and its dependencies in the
    appropriate order without the need to list the dependencies (ports, etc.)
    separately.
   </p><p>
    To bring up multiple interfaces in one command:
   </p><div class="verbatim-wrap"><pre class="screen">wicked ifup bond0 br0 br1 br2</pre></div><p>
    Or also all interfaces:
   </p><div class="verbatim-wrap"><pre class="screen">wicked ifup all</pre></div></div><div class="sect3 " id="sec.network.manconf.tunnel"><div class="titlepage"><div><div><h4 class="title" id="sec.network.manconf.tunnel"><span class="number">13.6.1.5 </span><span class="name">Using Tunnels with Wicked</span> <a title="Permalink" class="permalink" href="#sec.network.manconf.tunnel">#</a></h4></div></div></div><p>
    When you need to use tunnels with Wicked, the <code class="envar">TUNNEL_DEVICE</code>
    is used for this. It permits to specify an optional device name to bind
    the tunnel to the device. The tunneled packets will only be routed via this
    device.
   </p><p>
    For more information, refer to <code class="command">man 5 ifcfg-tunnel</code>.
   </p></div><div class="sect3 " id="sec.network.manconf.incremental"><div class="titlepage"><div><div><h4 class="title" id="sec.network.manconf.incremental"><span class="number">13.6.1.6 </span><span class="name">Handling Incremental Changes</span> <a title="Permalink" class="permalink" href="#sec.network.manconf.incremental">#</a></h4></div></div></div><p>
    With <code class="command">wicked</code>, there is no need to actually take down an
    interface to reconfigure it (unless it is required by the kernel). For
    example, to add another IP address or route to a statically configured
    network interface, add the IP address to the interface definition, and do
    another <span class="quote">“<span class="quote">ifup</span>”</span> operation. The server will try hard to update
    only those settings that have changed. This applies to link-level options
    such as the device MTU or the MAC address, and network-level settings, such
    as addresses, routes, or even the address configuration mode (for example,
    when moving from a static configuration to DHCP).
   </p><p>
    Things get tricky of course with virtual interfaces combining several real
    devices such as bridges or bonds. For bonded devices, it is not possible to
    change certain parameters while the device is up. Doing that will result in
    an error.
   </p><p>
    However, what should still work, is the act of adding or removing the child
    devices of a bond or bridge, or choosing a bond's primary interface.
   </p></div><div class="sect3 " id="sec.network.manconf.address_config"><div class="titlepage"><div><div><h4 class="title" id="sec.network.manconf.address_config"><span class="number">13.6.1.7 </span><span class="name">Wicked Extensions: Address Configuration</span> <a title="Permalink" class="permalink" href="#sec.network.manconf.address_config">#</a></h4></div></div></div><p>
    <code class="command">wicked</code> is designed to be extensible with shell scripts.
    These extensions can be defined in the <code class="filename">config.xml</code>
    file.
   </p><p>
    Currently, several classes of extensions are supported:
   </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
      link configuration: these are scripts responsible for setting up a
      device's link layer according to the configuration provided by the
      client, and for tearing it down again.
     </p></li><li class="listitem "><p>
      address configuration: these are scripts responsible for managing a
      device's address configuration. Usually address configuration and DHCP
      are managed by <code class="command">wicked</code> itself, but can be implemented
      by means of extensions.
     </p></li><li class="listitem "><p>
      firewall extension: these scripts can apply firewall rules.
     </p></li></ul></div><p>
    Typically, extensions have a start and a stop command, an optional
    <span class="quote">“<span class="quote">pid file</span>”</span>, and a set of environment variables that get passed
    to the script.
   </p><p>
    To illustrate how this is supposed to work, look at a firewall extension
    defined in <code class="filename">etc/server.xml</code>:
   </p><div class="verbatim-wrap"><pre class="screen">&lt;dbus-service interface="org.opensuse.Network.Firewall"&gt;
 &lt;action name="firewallUp"   command="/etc/wicked/extensions/firewall up"/&gt;
 &lt;action name="firewallDown" command="/etc/wicked/extensions/firewall down"/&gt;

 &lt;!-- default environment for all calls to this extension script --&gt;
 &lt;putenv name="WICKED_OBJECT_PATH" value="$object-path"/&gt;
 &lt;putenv name="WICKED_INTERFACE_NAME" value="$property:name"/&gt;
 &lt;putenv name="WICKED_INTERFACE_INDEX" value="$property:index"/&gt;
&lt;/dbus-service&gt;</pre></div><p>
    The extension is attached to the
    <code class="sgmltag-starttag">&lt;dbus-service&gt;</code>
    tag and defines commands to execute for the actions of this interface.
    Further, the declaration can define and initialize environment variables
    passed to the actions.
   </p></div><div class="sect3 " id="sec.network.manconf.configuration_files"><div class="titlepage"><div><div><h4 class="title" id="sec.network.manconf.configuration_files"><span class="number">13.6.1.8 </span><span class="name">Wicked Extensions: Configuration Files</span> <a title="Permalink" class="permalink" href="#sec.network.manconf.configuration_files">#</a></h4></div></div></div><p>
    You can extend the handling of configuration files with scripts as well.
    For example, DNS updates from leases are ultimately handled by the
    <code class="filename">extensions/resolver</code> script, with behavior configured
    in <code class="filename">server.xml</code>:
   </p><div class="verbatim-wrap"><pre class="screen">&lt;system-updater name="resolver"&gt;
 &lt;action name="backup" command="/etc/wicked/extensions/resolver backup"/&gt;
 &lt;action name="restore" command="/etc/wicked/extensions/resolver restore"/&gt;
 &lt;action name="install" command="/etc/wicked/extensions/resolver install"/&gt;
 &lt;action name="remove" command="/etc/wicked/extensions/resolver remove"/&gt;
&lt;/system-updater&gt;</pre></div><p>
    When an update arrives in <code class="systemitem">wickedd</code>, the system
    updater routines parse the lease and call the appropriate commands
    (<code class="literal">backup</code>, <code class="literal">install</code>, etc.) in the
    resolver script. This in turn configures the DNS settings using
    <code class="command">/sbin/netconfig</code>, or by manually writing
    <code class="filename">/etc/resolv.conf</code> as a fallback.
   </p></div></div><div class="sect2 " id="sec.network.manconf.files"><div class="titlepage"><div><div><h3 class="title" id="sec.network.manconf.files"><span class="number">13.6.2 </span><span class="name">Configuration Files</span> <a title="Permalink" class="permalink" href="#sec.network.manconf.files">#</a></h3><div class="doc-status"><ul><li><span class="ds-label">Filename: </span>net_config_files.xml</li><li><span class="ds-label">ID: </span>sec.network.manconf.files</li></ul></div></div></div></div><p>
  This section provides an overview of the network configuration files and
  explains their purpose and the format used.
 </p><div class="sect3 " id="wicked.configuration.common.xml"><div class="titlepage"><div><div><h4 class="title" id="wicked.configuration.common.xml"><span class="number">13.6.2.1 </span><span class="name"><code class="filename">/etc/wicked/common.xml</code></span> <a title="Permalink" class="permalink" href="#wicked.configuration.common.xml">#</a></h4></div></div></div><p>
   The <code class="filename">/etc/wicked/common.xml</code> file contains common
   definitions that should be used by all applications. It is sourced/included
   by the other configuration files in this directory. Although you can use
   this file to enable debugging across all
   <code class="literal">wicked</code> components, we recommend to use the file
   <code class="filename">/etc/wicked/local.xml</code> for this purpose. After applying
   maintenance updates you might lose your changes as the
   <code class="filename">/etc/wicked/common.xml</code> might be overwritten. The
   <code class="filename">/etc/wicked/common.xml</code> file includes the
   <code class="filename">/etc/wicked/local.xml</code> in the default installation, thus
   you typically do not need to modify the
   <code class="filename">/etc/wicked/common.xml</code>.
  </p><p>
   In case you want to disable <code class="literal">nanny</code> by setting the
   <code class="literal">&lt;use-nanny&gt;</code> to <code class="literal">false</code>, restart
   the <code class="literal">wickedd.service</code> and then run the following command to
   apply all configurations and policies:
  </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> wicked ifup all</pre></div><div id="idm140019138984368" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note: Configuration Files</h6><p>
    The <code class="literal">wickedd</code>, <code class="literal">wicked</code>, or
    <code class="literal">nanny</code> programs try to read
    <code class="filename">/etc/wicked/common.xml</code> if their own configuration
    files do not exist.
   </p></div></div><div class="sect3 " id="wicked.configuration.server.xml"><div class="titlepage"><div><div><h4 class="title" id="wicked.configuration.server.xml"><span class="number">13.6.2.2 </span><span class="name"><code class="filename">/etc/wicked/server.xml</code></span> <a title="Permalink" class="permalink" href="#wicked.configuration.server.xml">#</a></h4></div></div></div><p>
   The file <code class="filename">/etc/wicked/server.xml</code> is read by the
   <code class="literal">wickedd</code> server process at start-up. The file stores
   extensions to the <code class="filename">/etc/wicked/common.xml</code>. On top of
   that this file configures handling of a resolver and receiving information
   from <code class="literal">addrconf</code> supplicants, for example DHCP.
  </p><p>
   We recommend to add changes required to this file into a separate file
   <code class="filename">/etc/wicked/server-local.xml</code>, that gets included by
   <code class="filename">/etc/wicked/server.xml</code>. By using a separate file
   you avoid overwriting of your changes during maintenance updates.
  </p></div><div class="sect3 " id="wicked.configuration.client.xml"><div class="titlepage"><div><div><h4 class="title" id="wicked.configuration.client.xml"><span class="number">13.6.2.3 </span><span class="name"><code class="filename">/etc/wicked/client.xml</code></span> <a title="Permalink" class="permalink" href="#wicked.configuration.client.xml">#</a></h4></div></div></div><p>
   The <code class="filename">/etc/wicked/client.xml</code> is used by the
   <code class="command">wicked</code> command. The file specifies the location of a
   script used when discovering devices managed by ibft and configures
   locations of network interface configurations.
  </p><p>
   We recommend to add changes required to this file into a separate file
   <code class="filename">/etc/wicked/client-local.xml</code>, that gets included by
   <code class="filename">/etc/wicked/server.xml</code>. By using a separate file
   you avoid overwriting of your changes during maintenance updates.
  </p></div><div class="sect3 " id="wicked.configuration.nanny.xml"><div class="titlepage"><div><div><h4 class="title" id="wicked.configuration.nanny.xml"><span class="number">13.6.2.4 </span><span class="name"><code class="filename">/etc/wicked/nanny.xml</code></span> <a title="Permalink" class="permalink" href="#wicked.configuration.nanny.xml">#</a></h4></div></div></div><p>
   The <code class="filename">/etc/wicked/nanny.xml</code> configures types of link
   layers. We recommend to add specific configuration into a separate file:
   <code class="filename">/etc/wicked/nanny-local.xml</code> to avoid losing the changes
   during maintenance updates.
  </p></div><div class="sect3 " id="sec.network.manconf.files.ifcfg"><div class="titlepage"><div><div><h4 class="title" id="sec.network.manconf.files.ifcfg"><span class="number">13.6.2.5 </span><span class="name"><code class="filename">/etc/sysconfig/network/ifcfg-*</code></span> <a title="Permalink" class="permalink" href="#sec.network.manconf.files.ifcfg">#</a></h4></div></div></div><p>
   These files contain the traditional configurations for network interfaces.
   In <span class="phrase">openSUSE
   prior to Leap</span>, this was the only supported format besides iBFT firmware.
  </p><div id="idm140019138965488" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note: <code class="command">wicked</code> and the <code class="filename">ifcfg-*</code> Files</h6><p>
    <code class="command">wicked</code> reads these files if you specify the
    <code class="literal">compat:</code> prefix. According to the <span class="productname"><span class="phrase">openSUSE Leap</span></span> default
    configuration in <code class="filename">/etc/wicked/client.xml</code>,
    <code class="command">wicked</code> tries these files before the XML configuration
    files in <code class="filename">/etc/wicked/ifconfig</code>.
   </p><p>
    The <code class="option">--ifconfig</code> switch is provided mostly for testing only.
    If specified, default configuration sources defined in
    <code class="filename">/etc/wicked/ifconfig</code> are not applied.
   </p></div><p>
   The <code class="filename">ifcfg-*</code> files include information such as the start
   mode and the IP address. Possible parameters are described in the manual
   page of <code class="systemitem">ifup</code>. Additionally, most variables from the
   <code class="filename">dhcp</code> and <code class="filename">wireless</code> files can be
   used in the <code class="filename">ifcfg-*</code> files if a general setting should
   be used for only one interface. However, most of the
   <code class="filename">/etc/sysconfig/network/config</code> variables are global and
   cannot be overridden in ifcfg-files. For example,
   <code class="systemitem">NETCONFIG_*</code> variables are global.
  </p><p>

   For configuring <code class="systemitem">macvlan</code> and
   <code class="systemitem">macvtab</code> interfaces, see the
   <code class="systemitem">ifcfg-macvlan</code> and
   <code class="systemitem">ifcfg-macvtap</code> man pages. For example, for a macvlan
   interface provide a <code class="filename">ifcfg-macvlan0</code> with settings as
   follows:
  </p><div class="verbatim-wrap"><pre class="screen">STARTMODE='auto'
MACVLAN_DEVICE='eth0'
#MACVLAN_MODE='vepa'
#LLADDR=02:03:04:05:06:aa</pre></div><p>
   For <code class="filename">ifcfg.template</code>, see
   <a class="xref" href="#sec.network.manconf.files.config-etc" title="13.6.2.6. /etc/sysconfig/network/config, /etc/sysconfig/network/dhcp, and /etc/sysconfig/network/wireless">Section 13.6.2.6, “<code class="filename">/etc/sysconfig/network/config</code>, <code class="filename">/etc/sysconfig/network/dhcp</code>, and <code class="filename">/etc/sysconfig/network/wireless</code>”</a>.
  </p></div><div class="sect3 " id="sec.network.manconf.files.config-etc"><div class="titlepage"><div><div><h4 class="title" id="sec.network.manconf.files.config-etc"><span class="number">13.6.2.6 </span><span class="name"><code class="filename">/etc/sysconfig/network/config</code>, <code class="filename">/etc/sysconfig/network/dhcp</code>, and <code class="filename">/etc/sysconfig/network/wireless</code></span> <a title="Permalink" class="permalink" href="#sec.network.manconf.files.config-etc">#</a></h4></div></div></div><p>
   The file <code class="filename">config</code> contains general settings for the
   behavior of <code class="command">ifup</code>, <code class="command">ifdown</code> and
   <code class="command">ifstatus</code>. <code class="filename">dhcp</code> contains settings for
   DHCP and <code class="filename">wireless</code> for wireless LAN cards. The variables
   in all three configuration files are commented. Some variables from
   <code class="filename">/etc/sysconfig/network/config</code> can also be used in
   <code class="filename">ifcfg-*</code> files, where they are given a higher priority.
   The <code class="filename">/etc/sysconfig/network/ifcfg.template</code> file lists
   variables that can be specified in a per interface scope. However, most of
   the <code class="filename">/etc/sysconfig/network/config</code> variables are global
   and cannot be overridden in ifcfg-files. For example,
   <code class="systemitem">NETWORKMANAGER</code> or
   <code class="systemitem">NETCONFIG_*</code> variables are global.
  </p><div id="idm140019138941168" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note: Using DHCPv6</h6><p>
    In <span class="phrase">openSUSE
    prior to Leap</span>, DHCPv6 used to work even on networks where IPv6 Router
    Advertisements (RAs) were not configured properly. Starting with <span class="phrase">openSUSE Leap</span>,
    DHCPv6 will correctly require that at least one of the routers on the
    network sends out RAs that indicate that this network is managed by DHCPv6.
   </p><p>
    For networks where the router cannot be configured correctly, the <code class="literal">ifcfg</code> option allows the user to override this
    behavior by specifying <code class="literal">DHCLIENT6_MODE='managed'</code> in the
    <code class="literal">ifcfg</code> file.

    You can also activate this workaround with a boot parameter in the
    installation system:
   </p><div class="verbatim-wrap"><pre class="screen">ifcfg=eth0=dhcp6,DHCLIENT6_MODE=managed</pre></div></div></div><div class="sect3 " id="sec.network.manconf.files.routes"><div class="titlepage"><div><div><h4 class="title" id="sec.network.manconf.files.routes"><span class="number">13.6.2.7 </span><span class="name"><code class="filename">/etc/sysconfig/network/routes</code> and <code class="filename">/etc/sysconfig/network/ifroute-*</code></span> <a title="Permalink" class="permalink" href="#sec.network.manconf.files.routes">#</a></h4></div></div></div><p>
   The static routing of TCP/IP packets is determined by the
   <code class="filename">/etc/sysconfig/network/routes</code> and
   <code class="filename">/etc/sysconfig/network/ifroute-*</code> files. All the static
   routes required by the various system tasks can be specified in
   <code class="filename">/etc/sysconfig/network/routes</code>: routes to a host, routes
   to a host via a gateway and routes to a network. For each interface that
   needs individual routing, define an additional configuration file:
   <code class="filename">/etc/sysconfig/network/ifroute-*</code>. Replace the wild card
   (<code class="literal">*</code>) with the name of the interface. The entries in the
   routing configuration files look like this:
  </p><div class="verbatim-wrap"><pre class="screen"># Destination     Gateway           Netmask            Interface  Options</pre></div><p>
   The route's destination is in the first column. This column may contain the
   IP address of a network or host or, in the case of
   <span class="emphasis"><em>reachable</em></span> name servers, the fully qualified network or
   host name. The network should be written in CIDR notation (address with the
   associated routing prefix-length) such as 10.10.0.0/16 for IPv4 or fc00::/7
   for IPv6 routes. The keyword <code class="literal">default</code> indicates that the
   route is the default gateway in the same address family as the gateway. For
   devices without a gateway use explicit 0.0.0.0/0 or ::/0 destinations.
  </p><p>
   The second column contains the default gateway or a gateway through which a
   host or network can be accessed.
  </p><p>
   The third column is deprecated; it used to contain the IPv4 netmask of the
   destination. For IPv6 routes, the default route, or when using a
   prefix-length (CIDR notation) in the first column, enter a dash
   (<code class="literal">-</code>) here.
  </p><p>
   The fourth column contains the name of the interface. If you leave it empty
   using a dash (<code class="literal">-</code>), it can cause unintended behavior in
   <code class="filename">/etc/sysconfig/network/routes</code>. For more information,
   see the <code class="systemitem">routes</code> man page.
  </p><p>
   An (optional) fifth column can be used to specify special options. For
   details, see the <code class="systemitem">routes</code> man page.
  </p><div class="example" id="idm140019138923616"><div class="example-title-wrap"><h6 class="example-title"><span class="number">Example 13.5: </span><span class="name">Common Network Interfaces and Some Static Routes </span><a title="Permalink" class="permalink" href="#idm140019138923616">#</a></h6></div><div class="example-contents"><div class="verbatim-wrap"><pre class="screen"># --- IPv4 routes in CIDR prefix notation:
# Destination     [Gateway]         -                  Interface
127.0.0.0/8       -                 -                  lo
204.127.235.0/24  -                 -                  eth0
default           204.127.235.41    -                  eth0
207.68.156.51/32  207.68.145.45     -                  eth1
192.168.0.0/16    207.68.156.51     -                  eth1

# --- IPv4 routes in deprecated netmask notation"
# Destination     [Dummy/Gateway]   Netmask            Interface
#
127.0.0.0         0.0.0.0           255.255.255.0      lo
204.127.235.0     0.0.0.0           255.255.255.0      eth0
default           204.127.235.41    0.0.0.0            eth0
207.68.156.51     207.68.145.45     255.255.255.255    eth1
192.168.0.0       207.68.156.51     255.255.0.0        eth1

# --- IPv6 routes are always using CIDR notation:
# Destination     [Gateway]                -           Interface
2001:DB8:100::/64 -                        -           eth0
2001:DB8:100::/32 fe80::216:3eff:fe6d:c042 -           eth0</pre></div></div></div></div><div class="sect3 " id="sec.network.manconf.files.resolv"><div class="titlepage"><div><div><h4 class="title" id="sec.network.manconf.files.resolv"><span class="number">13.6.2.8 </span><span class="name"><code class="filename">/etc/resolv.conf</code></span> <a title="Permalink" class="permalink" href="#sec.network.manconf.files.resolv">#</a></h4></div></div></div><p>
   The domain to which the host belongs is specified in
   <code class="filename">/etc/resolv.conf</code> (keyword
   <code class="systemitem">search</code>). Up to six domains with a total of 256
   characters can be specified with the <code class="systemitem">search</code> option.
   When resolving a name that is not fully qualified, an attempt is made to
   generate one by attaching the individual <code class="systemitem">search</code>
   entries. Up to 3 name servers can be specified with the
   <code class="systemitem">nameserver</code> option, each on a line of its own.
   Comments are preceded by hash mark or semicolon signs (<code class="literal">#</code>
   or <code class="literal">;</code>). As an example, see
   <a class="xref" href="#dat.netz.etc.resolv.conf" title="/etc/resolv.conf">Example 13.6, “<code class="filename">/etc/resolv.conf</code>”</a>.
  </p><p>
   However, the <code class="filename">/etc/resolv.conf</code> should not be edited by
   hand. Instead, it is generated by the <code class="command">netconfig</code> script.
   To define static DNS configuration without using YaST, edit the
   appropriate variables manually in the
   <code class="filename">/etc/sysconfig/network/config</code> file:
  </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019138912928"><span class="term "><code class="systemitem">NETCONFIG_DNS_STATIC_SEARCHLIST</code>
    </span></dt><dd><p>
      list of DNS domain names used for host name lookup
     </p></dd><dt id="idm140019138910784"><span class="term "><code class="systemitem">NETCONFIG_DNS_STATIC_SERVERS</code>
    </span></dt><dd><p>
      list of name server IP addresses to use for host name lookup
     </p></dd><dt id="idm140019138908624"><span class="term "><code class="systemitem">NETCONFIG_DNS_FORWARDER</code>
    </span></dt><dd><p>
      the name of the DNS forwarder that needs to be configured, for example
      <code class="literal">bind</code> or <code class="literal">resolver</code>
     </p></dd><dt id="idm140019138905584"><span class="term "><code class="systemitem">NETCONFIG_DNS_RESOLVER_OPTIONS</code>
    </span></dt><dd><p>
      arbitrary options that will be written to
      <code class="filename">/etc/resolv.conf</code>, for example:
     </p><div class="verbatim-wrap"><pre class="screen">debug attempts:1 timeout:10</pre></div><p>
      For more information, see the <code class="literal">resolv.conf</code> man page.
     </p></dd><dt id="idm140019138901632"><span class="term "><code class="systemitem">NETCONFIG_DNS_RESOLVER_SORTLIST</code>
    </span></dt><dd><p>
      list of up to 10 items, for example:
     </p><div class="verbatim-wrap"><pre class="screen">130.155.160.0/255.255.240.0 130.155.0.0</pre></div><p>
      For more information, see the <code class="systemitem">resolv.conf</code> man
      page.
     </p></dd></dl></div><p>
   To disable DNS configuration using netconfig, set
   <code class="literal">NETCONFIG_DNS_POLICY=''</code>. For more information about
   <code class="command">netconfig</code>, see the <code class="systemitem">netconfig(8)</code>
   man page (<code class="command">man 8 netconfig</code>).
  </p><div class="example" id="dat.netz.etc.resolv.conf"><div class="example-title-wrap"><h6 class="example-title"><span class="number">Example 13.6: </span><span class="name"><code class="filename">/etc/resolv.conf</code> </span><a title="Permalink" class="permalink" href="#dat.netz.etc.resolv.conf">#</a></h6></div><div class="example-contents"><div class="verbatim-wrap"><pre class="screen"># Our domain
search example.com
#
# We use dns.example.com (192.168.1.116) as nameserver
nameserver 192.168.1.116</pre></div></div></div></div><div class="sect3 " id="sec.network.manconf.netconfig"><div class="titlepage"><div><div><h4 class="title" id="sec.network.manconf.netconfig"><span class="number">13.6.2.9 </span><span class="name"><code class="filename">/sbin/netconfig</code></span> <a title="Permalink" class="permalink" href="#sec.network.manconf.netconfig">#</a></h4></div></div></div><p>
   <code class="command">netconfig</code> is a modular tool to manage additional network
   configuration settings. It merges statically defined settings with settings
   provided by autoconfiguration mechanisms as DHCP or PPP according to a
   predefined policy. The required changes are applied to the system by calling
   the netconfig modules that are responsible for modifying a configuration
   file and restarting a service or a similar action.
  </p><p>
   <code class="command">netconfig</code> recognizes three main actions. The
   <code class="command">netconfig modify</code> and <code class="command">netconfig remove</code>
   commands are used by daemons such as DHCP or PPP to provide or remove
   settings to netconfig. Only the <code class="command">netconfig update</code> command
   is available for the user:
  </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019138888176"><span class="term "><code class="command">modify</code>
    </span></dt><dd><p>
      The <code class="command">netconfig modify</code> command modifies the current
      interface and service specific dynamic settings and updates the network
      configuration. Netconfig reads settings from standard input or from a
      file specified with the <code class="option">--lease-file
      <em class="replaceable ">FILENAME</em></code> option and internally stores
      them until a system reboot (or the next modify or remove action). Already
      existing settings for the same interface and service combination are
      overwritten. The interface is specified by the <code class="option">-i
      <em class="replaceable ">INTERFACE_NAME</em></code> parameter. The service
      is specified by the <code class="option">-s
      <em class="replaceable ">SERVICE_NAME</em></code> parameter.
     </p></dd><dt id="idm140019138882992"><span class="term "><code class="command">remove</code>
    </span></dt><dd><p>
      The <code class="command">netconfig remove</code> command removes the dynamic
      settings provided by a modificatory action for the specified interface
      and service combination and updates the network configuration. The
      interface is specified by the <code class="option">-i
      <em class="replaceable ">INTERFACE_NAME</em></code> parameter. The service
      is specified by the <code class="option">-s
      <em class="replaceable ">SERVICE_NAME</em></code> parameter.
     </p></dd><dt id="idm140019138878768"><span class="term "><code class="command">update</code>
    </span></dt><dd><p>

      The <code class="command">netconfig update</code> command updates the network
      configuration using current settings. This is useful when the policy or
      the static configuration has changed. Use the <code class="option">-m
      <em class="replaceable ">MODULE_TYPE</em></code> parameter, if you want to
      update a specified service only (<code class="systemitem">dns</code>,
      <code class="systemitem">nis</code>, or <code class="systemitem">ntp</code>).
     </p></dd></dl></div><p>
   The netconfig policy and the static configuration settings are defined
   either manually or using YaST in the
   <code class="filename">/etc/sysconfig/network/config</code> file. The dynamic
   configuration settings provided by autoconfiguration tools such as DHCP or
   PPP are delivered directly by these tools with the <code class="command">netconfig
   modify</code> and <code class="command">netconfig remove</code> actions.

   When NetworkManager is enabled, netconfig (in policy mode <code class="literal">auto</code>)
   uses only NetworkManager settings, ignoring settings from any other interfaces
   configured using the traditional ifup method. If NetworkManager does not provide any
   setting, static settings are used as a fallback. A mixed usage of NetworkManager and
   the <code class="command">wicked</code> method is not supported.
  </p><p>
   For more information about <code class="command">netconfig</code>, see <code class="command">man 8
   netconfig</code>.
  </p></div><div class="sect3 " id="sec.network.manconf.hosts"><div class="titlepage"><div><div><h4 class="title" id="sec.network.manconf.hosts"><span class="number">13.6.2.10 </span><span class="name"><code class="filename">/etc/hosts</code></span> <a title="Permalink" class="permalink" href="#sec.network.manconf.hosts">#</a></h4></div></div></div><p>
   In this file, shown in <a class="xref" href="#dat.netz.etc.hosts" title="/etc/hosts">Example 13.7, “<code class="filename">/etc/hosts</code>”</a>, IP addresses
   are assigned to host names. If no name server is implemented, all hosts to
   which an IP connection will be set up must be listed here. For each host,
   enter a line consisting of the IP address, the fully qualified host name,
   and the host name into the file. The IP address must be at the beginning of
   the line and the entries separated by blanks and tabs. Comments are always
   preceded by the <code class="literal">#</code> sign.
  </p><div class="example" id="dat.netz.etc.hosts"><div class="example-title-wrap"><h6 class="example-title"><span class="number">Example 13.7: </span><span class="name"><code class="filename">/etc/hosts</code> </span><a title="Permalink" class="permalink" href="#dat.netz.etc.hosts">#</a></h6></div><div class="example-contents"><div class="verbatim-wrap"><pre class="screen">127.0.0.1 localhost
192.168.2.100 jupiter.example.com jupiter
192.168.2.101 venus.example.com venus</pre></div></div></div></div><div class="sect3 " id="sec.network.manconf.files.networks"><div class="titlepage"><div><div><h4 class="title" id="sec.network.manconf.files.networks"><span class="number">13.6.2.11 </span><span class="name"><code class="filename">/etc/networks</code></span> <a title="Permalink" class="permalink" href="#sec.network.manconf.files.networks">#</a></h4></div></div></div><p>
   Here, network names are converted to network addresses. The format is
   similar to that of the <code class="filename">hosts</code> file, except the network
   names precede the addresses. See <a class="xref" href="#dat.netz.networks" title="/etc/networks">Example 13.8, “<code class="filename">/etc/networks</code>”</a>.
  </p><div class="example" id="dat.netz.networks"><div class="example-title-wrap"><h6 class="example-title"><span class="number">Example 13.8: </span><span class="name"><code class="filename">/etc/networks</code> </span><a title="Permalink" class="permalink" href="#dat.netz.networks">#</a></h6></div><div class="example-contents"><div class="verbatim-wrap"><pre class="screen">loopback     127.0.0.0
localnet     192.168.0.0</pre></div></div></div></div><div class="sect3 " id="sec.network.manconf.files.host"><div class="titlepage"><div><div><h4 class="title" id="sec.network.manconf.files.host"><span class="number">13.6.2.12 </span><span class="name"><code class="filename">/etc/host.conf</code></span> <a title="Permalink" class="permalink" href="#sec.network.manconf.files.host">#</a></h4></div></div></div><p>
   Name resolution—the translation of host and network names via the
   <span class="emphasis"><em>resolver</em></span> library—is controlled by this file. This
   file is only used for programs linked to libc4 or libc5. For current glibc
   programs, refer to the settings in <code class="filename">/etc/nsswitch.conf</code>.
   Each parameter must always be entered on a separate line. Comments are
   preceded by a <code class="literal">#</code> sign.
   <a class="xref" href="#tab.netz.param.hostconf" title="Parameters for /etc/host.conf">Table 13.2, “Parameters for /etc/host.conf”</a> shows the parameters available. A
   sample <code class="filename">/etc/host.conf</code> is shown in
   <a class="xref" href="#dat.netz.etc.hostconf" title="/etc/host.conf">Example 13.9, “<code class="filename">/etc/host.conf</code>”</a>.
  </p><div class="table" id="tab.netz.param.hostconf"><div class="table-title-wrap"><h6 class="table-title"><span class="number">Table 13.2: </span><span class="name">Parameters for /etc/host.conf </span><a title="Permalink" class="permalink" href="#tab.netz.param.hostconf">#</a></h6></div><div class="table-contents"><table summary="Parameters for /etc/host.conf" border="1"><colgroup><col /><col /></colgroup><tbody><tr><td align="left">
       <p>
        order <span class="emphasis"><em>hosts</em></span>, <span class="emphasis"><em>bind</em></span>
       </p>
      </td><td align="left">
       <p>
        Specifies in which order the services are accessed for the name
        resolution. Available arguments are (separated by blank spaces or
        commas):
       </p>
      </td></tr><tr><td align="left">
       
      </td><td align="left">
       <p>
        <span class="emphasis"><em>hosts</em></span>: searches the
        <code class="filename">/etc/hosts</code> file
       </p>
      </td></tr><tr><td align="left">
       
      </td><td align="left">
       <p>
        <span class="emphasis"><em>bind</em></span>: accesses a name server
       </p>
      </td></tr><tr><td align="left">
       
      </td><td align="left">
       <p>
        <span class="emphasis"><em>nis</em></span>: uses NIS
       </p>
      </td></tr><tr><td align="left">
       <p>
        multi <span class="emphasis"><em>on</em></span>/<span class="emphasis"><em>off</em></span>
       </p>
      </td><td align="left">
       <p>
        Defines if a host entered in <code class="filename">/etc/hosts</code> can have
        multiple IP addresses.
       </p>
      </td></tr><tr><td align="left">
       <p>
        nospoof <span class="emphasis"><em>on</em></span> spoofalert
        <span class="emphasis"><em>on</em></span>/<span class="emphasis"><em>off</em></span>
       </p>
      </td><td align="left">
       <p>
        These parameters influence the name server
        <span class="emphasis"><em>spoofing</em></span> but do not exert any influence on the
        network configuration.
       </p>
      </td></tr><tr><td align="left">
       <p>
        trim <span class="emphasis"><em>domainname</em></span>
       </p>
      </td><td align="left">
       <p>
        The specified domain name is separated from the host name after host
        name resolution (as long as the host name includes the domain name).
        This option is useful only if names from the local domain are in the
        <code class="filename">/etc/hosts</code> file, but should still be recognized
        with the attached domain names.
       </p>
      </td></tr></tbody></table></div></div><div class="example" id="dat.netz.etc.hostconf"><div class="example-title-wrap"><h6 class="example-title"><span class="number">Example 13.9: </span><span class="name"><code class="filename">/etc/host.conf</code> </span><a title="Permalink" class="permalink" href="#dat.netz.etc.hostconf">#</a></h6></div><div class="example-contents"><div class="verbatim-wrap"><pre class="screen"># We have named running
order hosts bind
# Allow multiple address
multi on</pre></div></div></div></div><div class="sect3 " id="sec.network.manconf.files.nsswitch"><div class="titlepage"><div><div><h4 class="title" id="sec.network.manconf.files.nsswitch"><span class="number">13.6.2.13 </span><span class="name"><code class="filename">/etc/nsswitch.conf</code></span> <a title="Permalink" class="permalink" href="#sec.network.manconf.files.nsswitch">#</a></h4></div></div></div><p>
   The introduction of the GNU C Library 2.0 was accompanied by the
   introduction of the <span class="emphasis"><em>Name Service Switch</em></span> (NSS). Refer to
   the <code class="systemitem">nsswitch.conf(5)</code> man page and <span class="emphasis"><em>The GNU
   C Library Reference Manual</em></span> for details.
  </p><p>
   The order for queries is defined in the file
   <code class="filename">/etc/nsswitch.conf</code>. A sample
   <code class="filename">nsswitch.conf</code> is shown in
   <a class="xref" href="#dat.netz.nsswitchconf" title="/etc/nsswitch.conf">Example 13.10, “<code class="filename">/etc/nsswitch.conf</code>”</a>. Comments are preceded by
   <code class="literal">#</code> signs. In this example, the entry under the
   <code class="filename">hosts</code> database means that a request is sent to
   <code class="filename">/etc/hosts</code> (<code class="option">files</code>) via
   DNS<span class="phrase"> (see <a class="xref" href="#cha.dns" title="Chapter 19. The Domain Name System">Chapter 19, <em>The Domain Name System</em></a>)</span>.
  </p><div class="example" id="dat.netz.nsswitchconf"><div class="example-title-wrap"><h6 class="example-title"><span class="number">Example 13.10: </span><span class="name"><code class="filename">/etc/nsswitch.conf</code> </span><a title="Permalink" class="permalink" href="#dat.netz.nsswitchconf">#</a></h6></div><div class="example-contents"><div class="verbatim-wrap"><pre class="screen">passwd:     compat
group:      compat

hosts:      files dns
networks:   files dns

services:   db files
protocols:  db files
rpc:        files
ethers:     files
netmasks:   files
netgroup:   files nis
publickey:  files

bootparams: files
automount:  files nis
aliases:    files nis
shadow:     compat</pre></div></div></div><p>
   The <span class="quote">“<span class="quote">databases</span>”</span> available over NSS are listed in
   <a class="xref" href="#tab.netz.nnswitch.db" title="Databases Available via /etc/nsswitch.conf">Table 13.3, “Databases Available via /etc/nsswitch.conf”</a>. The configuration options for NSS databases are listed in
   <a class="xref" href="#tab.netz.nnswitch.conf" title="Configuration Options for NSS “Databases”">Table 13.4, “Configuration Options for NSS <span class="quote">“<span class="quote">Databases</span>”</span>”</a>.
  </p><div class="table" id="tab.netz.nnswitch.db"><div class="table-title-wrap"><h6 class="table-title"><span class="number">Table 13.3: </span><span class="name">Databases Available via /etc/nsswitch.conf </span><a title="Permalink" class="permalink" href="#tab.netz.nnswitch.db">#</a></h6></div><div class="table-contents"><table summary="Databases Available via /etc/nsswitch.conf" border="1"><colgroup><col /><col /></colgroup><tbody><tr><td align="left">
       <p>
        <code class="option">aliases</code>
       </p>
      </td><td align="left">
       <p>
        Mail aliases implemented by <code class="filename">sendmail</code>; see
        <code class="command">man</code> <code class="option">5 aliases</code>.
       </p>
      </td></tr><tr><td align="left">
       <p>
        <code class="option">ethers</code>
       </p>
      </td><td align="left">
       <p>
        Ethernet addresses.
       </p>
      </td></tr><tr><td align="left">
       <p>
        <code class="option">netmasks</code>
       </p>
      </td><td align="left">
       <p>
        List of networks and their subnet masks. Only needed, if you use
        subnetting.
       </p>
      </td></tr><tr><td align="left">
       <p>
        <code class="option">group</code>
       </p>
      </td><td align="left">
       <p>
        User groups used by <code class="filename">getgrent</code>. See also the man
        page for <code class="command">group</code>.
       </p>
      </td></tr><tr><td align="left">
       <p>
        <code class="option">hosts</code>
       </p>
      </td><td align="left">
       <p>
        Host names and IP addresses, used by <code class="filename">gethostbyname</code>
        and similar functions.
       </p>
      </td></tr><tr><td align="left">
       <p>
        <code class="option">netgroup</code>
       </p>
      </td><td align="left">
       <p>
        Valid host and user lists in the network for controlling access
        permissions; see the <code class="systemitem">netgroup(5)</code> man page.
       </p>
      </td></tr><tr><td align="left">
       <p>
        <code class="option">networks</code>
       </p>
      </td><td align="left">
       <p>
        Network names and addresses, used by <code class="filename">getnetent</code>.
       </p>
      </td></tr><tr><td align="left">
       <p>
        <code class="option">publickey</code>
       </p>
      </td><td align="left">
       <p>
        Public and secret keys for Secure_RPC used by NFS and NIS+.
       </p>
      </td></tr><tr><td align="left">
       <p>
        <code class="option">passwd</code>
       </p>
      </td><td align="left">
       <p>
        User passwords, used by <code class="filename">getpwent</code>; see the
        <code class="systemitem">passwd(5)</code> man page.
       </p>
      </td></tr><tr><td align="left">
       <p>
        <code class="option">protocols</code>
       </p>
      </td><td align="left">
       <p>
        Network protocols, used by <code class="filename">getprotoent</code>; see the
        <code class="systemitem">protocols(5)</code> man page.
       </p>
      </td></tr><tr><td align="left">
       <p>
        <code class="option">rpc</code>
       </p>
      </td><td align="left">
       <p>
        Remote procedure call names and addresses, used by
        <code class="filename">getrpcbyname</code> and similar functions.
       </p>
      </td></tr><tr><td align="left">
       <p>
        <code class="option">services</code>
       </p>
      </td><td align="left">
       <p>
        Network services, used by <code class="filename">getservent</code>.
       </p>
      </td></tr><tr><td align="left">
       <p>
        <code class="option">shadow</code>
       </p>
      </td><td align="left">
       <p>
        Shadow passwords of users, used by <code class="filename">getspnam</code>; see
        the <code class="option">shadow(5)</code> man page.
       </p>
      </td></tr></tbody></table></div></div><div class="table" id="tab.netz.nnswitch.conf"><div class="table-title-wrap"><h6 class="table-title"><span class="number">Table 13.4: </span><span class="name">Configuration Options for NSS <span class="quote">“<span class="quote">Databases</span>”</span> </span><a title="Permalink" class="permalink" href="#tab.netz.nnswitch.conf">#</a></h6></div><div class="table-contents"><table summary="Configuration Options for NSS Databases" border="1"><colgroup><col /><col /></colgroup><tbody><tr><td align="left">
       <p>
        <code class="option">files</code>
       </p>
      </td><td align="left">
       <p>
        directly access files, for example, <code class="filename">/etc/aliases</code>
       </p>
      </td></tr><tr><td align="left">
       <p>
        <code class="option">db</code>
       </p>
      </td><td align="left">
       <p>
        access via a database
       </p>
      </td></tr><tr><td align="left">
       <p>
        <code class="option">nis</code>, <code class="option">nisplus</code>
       </p>
      </td><td align="left">
       <p>
        NIS, see also <span class="intraxref">Book “<em class="citetitle ">Security Guide</em>”, Chapter 3 “Using NIS”</span>
       </p>
      </td></tr><tr><td align="left">
       <p>
        <code class="option">dns</code>
       </p>
      </td><td align="left">
       <p>
        can only be used as an extension for <code class="option">hosts</code> and
        <code class="option">networks</code>
       </p>
      </td></tr><tr><td align="left">
       <p>
        <code class="option">compat</code>
       </p>
      </td><td align="left">
       <p>
        can only be used as an extension for <code class="option">passwd</code>,
        <code class="option">shadow</code> and <code class="option">group</code>
       </p>
      </td></tr></tbody></table></div></div></div><div class="sect3 " id="sec.network.manconf.files.nscd"><div class="titlepage"><div><div><h4 class="title" id="sec.network.manconf.files.nscd"><span class="number">13.6.2.14 </span><span class="name"><code class="filename">/etc/nscd.conf</code></span> <a title="Permalink" class="permalink" href="#sec.network.manconf.files.nscd">#</a></h4></div></div></div><p>
   This file is used to configure nscd (name service cache daemon). See the
   <code class="systemitem">nscd(8)</code> and <code class="systemitem">nscd.conf(5)</code>
   man pages. By default, the system entries of <code class="option">passwd</code>,
   <code class="option">groups</code> and <code class="option">hosts</code>are cached by nscd. This is important for the
   performance of directory services, like NIS and LDAP, because otherwise the
   network connection needs to be used for every access to names, groups or
   hosts.
   
  </p><p>
   If the caching for <code class="option">passwd</code> is activated, it usually takes
   about fifteen seconds until a newly added local user is recognized. Reduce
   this waiting time by restarting nscd with:
  </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> systemctl restart nscd</pre></div></div><div class="sect3 " id="sec.network.manconf.files.hostname"><div class="titlepage"><div><div><h4 class="title" id="sec.network.manconf.files.hostname"><span class="number">13.6.2.15 </span><span class="name"><code class="filename">/etc/HOSTNAME</code></span> <a title="Permalink" class="permalink" href="#sec.network.manconf.files.hostname">#</a></h4></div></div></div><p>
   <code class="filename">/etc/HOSTNAME</code> contains the fully qualified host name
   (FQHN). The fully qualified host name is the host name with the domain name
   attached. This file must contain only one line (in which the host name is
   set). It is read while the machine is booting.
  </p></div></div><div class="sect2 " id="sec.network.manconf.testing"><div class="titlepage"><div><div><h3 class="title" id="sec.network.manconf.testing"><span class="number">13.6.3 </span><span class="name">Testing the Configuration</span> <a title="Permalink" class="permalink" href="#sec.network.manconf.testing">#</a></h3></div></div></div><p>
   Before you write your configuration to the configuration files, you can test
   it. To set up a test configuration, use the <code class="command">ip</code> command.
   To test the connection, use the <code class="command">ping</code> command.
  </p><p>
   The command <code class="command">ip</code> changes the network configuration directly
   without saving it in the configuration file. Unless you enter your
   configuration in the correct configuration files, the changed network
   configuration is lost on reboot.
  </p><div id="idm140019138734576" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note: <code class="command">ifconfig</code> and <code class="command">route</code> Are Obsolete</h6><p>
    The <code class="command">ifconfig</code> and <code class="command">route</code> tools are
    obsolete. Use <code class="command">ip</code> instead. <code class="command">ifconfig</code>,
    for example, limits interface names to 9 characters.
   </p></div><div class="sect3 " id="sec.network.manconf.ip"><div class="titlepage"><div><div><h4 class="title" id="sec.network.manconf.ip"><span class="number">13.6.3.1 </span><span class="name">Configuring a Network Interface with <code class="command">ip</code></span> <a title="Permalink" class="permalink" href="#sec.network.manconf.ip">#</a></h4></div></div></div><p>
    <code class="command">ip</code> is a tool to show and configure network devices,
    routing, policy routing, and tunnels.
   </p><p>
    <code class="command">ip</code> is a very complex tool. Its common syntax is
    <code class="command">ip</code> <code class="option"><em class="replaceable ">OPTIONS</em>
    <em class="replaceable ">OBJECT</em>
    <em class="replaceable ">COMMAND</em></code>. You can work with the
    following objects:
   </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019138722352"><span class="term ">link</span></dt><dd><p>
       This object represents a network device.
      </p></dd><dt id="idm140019138720528"><span class="term ">address</span></dt><dd><p>
       This object represents the IP address of device.
      </p></dd><dt id="idm140019138718688"><span class="term ">neighbor</span></dt><dd><p>
       This object represents an ARP or NDISC cache entry.
      </p></dd><dt id="idm140019138716848"><span class="term ">route</span></dt><dd><p>
       This object represents the routing table entry.
      </p></dd><dt id="idm140019138715008"><span class="term ">rule</span></dt><dd><p>
       This object represents a rule in the routing policy database.
      </p></dd><dt id="idm140019138713152"><span class="term ">maddress</span></dt><dd><p>
       This object represents a multicast address.
      </p></dd><dt id="idm140019138711312"><span class="term ">mroute</span></dt><dd><p>
       This object represents a multicast routing cache entry.
      </p></dd><dt id="idm140019138709472"><span class="term ">tunnel</span></dt><dd><p>
       This object represents a tunnel over IP.
      </p></dd></dl></div><p>
    If no command is given, the default command is used (usually
    <code class="command">list</code>).
   </p><p>
    Change the state of a device with the command <code class="command">ip link
    set</code> <code class="option"><em class="replaceable ">DEVICE_NAME</em></code> <code class="command"></code>
    . For example, to deactivate device eth0, enter <code class="command">ip link
    set</code> <code class="option">eth0 down</code>. To activate it again, use
    <code class="command">ip link set</code> <code class="option">eth0 up</code>.
   </p><p>
    After activating a device, you can configure it. To set the IP address, use
    <code class="command">ip addr
    add</code> <code class="option"><em class="replaceable ">IP_ADDRESS</em> + dev
    <em class="replaceable ">DEVICE_NAME</em></code>. For example, to set the
    address of the interface eth0 to 192.168.12.154/30 with standard broadcast
    (option <code class="option">brd</code>), enter <code class="command">ip
    addr</code> <code class="option">add 192.168.12.154/30 brd + dev eth0</code>.
   </p><p>
    To have a working connection, you must also configure the default gateway.
    To set a gateway for your system, enter <code class="command">ip route
    add</code> <code class="option">gateway_ip_address</code>. To translate one IP
    address to another, use <code class="command">nat</code>: <code class="command">ip route add
    nat</code> <code class="option">ip_address</code> <code class="command">via</code> <code class="option">other_ip_address</code>.
   </p><p>
    To display all devices, use <code class="command">ip link ls</code>. To display the
    running interfaces only, use <code class="command">ip link ls up</code>. To print
    interface statistics for a device, enter <code class="command">ip -s link
    ls</code> <code class="option">device_name</code>. To view addresses of your
    devices, enter <code class="command">ip addr</code>. In the output of the <code class="command">ip
    addr</code>, also find information about MAC addresses of your devices.
    To show all routes, use <code class="command">ip route show</code>.
   </p><p>
    For more information about using <code class="command">ip</code>, enter
    <code class="command">ip</code> <code class="option">help</code> or see the
    <code class="systemitem">ip(8)</code> man page. The <code class="option">help</code> option
    is also available for all <code class="command">ip</code> subcommands. If, for
    example, you need help for
    <code class="command">ip</code> <code class="option">addr</code>, enter
    <code class="command">ip</code> <code class="option">addr help</code>. Find the
    <code class="command">ip</code> manual in
    <code class="filename">/usr/share/doc/packages/iproute2/ip-cref.pdf</code>.
   </p></div><div class="sect3 " id="sec.network.manconf.testingping"><div class="titlepage"><div><div><h4 class="title" id="sec.network.manconf.testingping"><span class="number">13.6.3.2 </span><span class="name">Testing a Connection with ping</span> <a title="Permalink" class="permalink" href="#sec.network.manconf.testingping">#</a></h4></div></div></div><p>
    The <code class="command">ping</code> command is the standard tool for testing
    whether a TCP/IP connection works. It uses the ICMP protocol to send a
    small data packet, ECHO_REQUEST datagram, to the destination host,
    requesting an immediate reply. If this works, <code class="command">ping</code>
    displays a message to that effect. This indicates that the network link is
    functioning.
   </p><p>
    <code class="command">ping</code> does more than only test the function of the
    connection between two computers: it also provides some basic information
    about the quality of the connection. In
    <a class="xref" href="#ex.basicnet.manconf.ping" title="Output of the Command ping">Example 13.11, “Output of the Command ping”</a>, you can see an example of the
    <code class="command">ping</code> output. The second-to-last line contains
    information about the number of transmitted packets, packet loss, and total
    time of <code class="command">ping</code> running.
   </p><p>
    As the destination, you can use a host name or IP address, for example,
    <code class="command">ping</code> <code class="option">example.com</code> or
    <code class="command">ping</code> <code class="option">192.168.3.100</code>. The program sends
    packets until you press
    <span class="keycap">Ctrl</span><span class="key-connector">–</span><span class="keycap">C</span>.
   </p><p>
    If you only need to check the functionality of the connection, you can
    limit the number of the packets with the <code class="option">-c</code> option. For
    example to limit ping to three packets, enter
    <code class="command">ping</code> <code class="option">-c 3 example.com</code>.
   </p><div class="example" id="ex.basicnet.manconf.ping"><div class="example-title-wrap"><h6 class="example-title"><span class="number">Example 13.11: </span><span class="name">Output of the Command ping </span><a title="Permalink" class="permalink" href="#ex.basicnet.manconf.ping">#</a></h6></div><div class="example-contents"><div class="verbatim-wrap"><pre class="screen">ping -c 3 example.com
PING example.com (192.168.3.100) 56(84) bytes of data.
64 bytes from example.com (192.168.3.100): icmp_seq=1 ttl=49 time=188 ms
64 bytes from example.com (192.168.3.100): icmp_seq=2 ttl=49 time=184 ms
64 bytes from example.com (192.168.3.100): icmp_seq=3 ttl=49 time=183 ms
--- example.com ping statistics ---
3 packets transmitted, 3 received, 0% packet loss, time 2007ms
rtt min/avg/max/mdev = 183.417/185.447/188.259/2.052 ms</pre></div></div></div><p>
    The default interval between two packets is one second. To change the
    interval, ping provides the option <code class="option">-i</code>. For example, to
    increase the ping interval to ten seconds, enter
    <code class="command">ping</code> <code class="option">-i 10 example.com</code>.
   </p><p>
    In a system with multiple network devices, it is sometimes useful to send
    the ping through a specific interface address. To do so, use the
    <code class="option">-I</code> option with the name of the selected device, for
    example, <code class="command">ping</code> <code class="option">-I wlan1
    example.com</code>.
   </p><p>
    For more options and information about using ping, enter
    <code class="command">ping</code> <code class="option">-h</code> or see the
    <code class="systemitem">ping (8)</code> man page.
   </p><div id="idm140019138667024" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.png" /><h6>Tip: Pinging IPv6 Addresses</h6><p>
     For IPv6 addresses use the <code class="command">ping6</code> command. Note, to ping
     link-local addresses, you must specify the interface with
     <code class="option">-I</code>. The following command works, if the address is
     reachable via <code class="literal">eth1</code>:
    </p><div class="verbatim-wrap"><pre class="screen">ping6 -I eth1 fe80::117:21ff:feda:a425</pre></div></div></div></div><div class="sect2 " id="sec.network.manconf.scripts"><div class="titlepage"><div><div><h3 class="title" id="sec.network.manconf.scripts"><span class="number">13.6.4 </span><span class="name">Unit Files and Start-Up Scripts</span> <a title="Permalink" class="permalink" href="#sec.network.manconf.scripts">#</a></h3></div></div></div><p>
   Apart from the configuration files described above, there are also systemd
   unit files and various scripts that load the network services while the
   machine is booting. These are started when the system is switched to the
   <code class="systemitem">multi-user.target</code> target. Some of these unit files
   and scripts are described in <a class="xref" href="#var.net.start.scripts" title="Some Unit Files and Start-Up Scripts for Network Programs">Some Unit Files and Start-Up Scripts for Network Programs</a>. For
   more information about <code class="systemitem">systemd</code>, see
   <a class="xref" href="#cha.systemd" title="Chapter 10. The systemd Daemon">Chapter 10, <em>The <code class="systemitem">systemd</code> Daemon</em></a> and for more information about the
   <code class="systemitem">systemd</code> targets, see the man page of
   <code class="systemitem">systemd.special</code> (<code class="command">man
   systemd.special</code>).
  </p><div class="variablelist " id="var.net.start.scripts"><div class="variablelist-title-wrap"><h6 class="variablelist-title"><span class="name">Some Unit Files and Start-Up Scripts for Network Programs </span><a title="Permalink" class="permalink" href="#var.net.start.scripts">#</a></h6></div><dl class="variablelist"><dt id="idm140019138656848"><span class="term "><code class="systemitem">network.target</code>


    </span></dt><dd><p>
      <code class="systemitem">network.target</code> is the systemd target for
      networking, but its mean depends on the settings provided by the system
      administrator.
     </p><p>
      For more information, see
      <a class="link" href="http://www.freedesktop.org/wiki/Software/systemd/NetworkTarget/" target="_blank">http://www.freedesktop.org/wiki/Software/systemd/NetworkTarget/</a>.
     </p></dd><dt id="idm140019138653136"><span class="term "><code class="systemitem">multi-user.target</code>
    </span></dt><dd><p>
      <code class="systemitem">multi-user.target</code> is the systemd target for a
      multiuser system with all required network services.
     </p></dd><dt id="idm140019138650528"><span class="term "><code class="systemitem">rpcbind</code>
    </span></dt><dd><p>
      Starts the rpcbind utility that converts RPC program numbers to universal
      addresses. It is needed for RPC services, such as an NFS server.
     </p></dd><dt id="idm140019138648304"><span class="term "><code class="systemitem">ypserv</code>
    </span></dt><dd><p>
      Starts the NIS server.
     </p></dd><dt id="idm140019138646208"><span class="term "><code class="systemitem">ypbind</code>
    </span></dt><dd><p>
      Starts the NIS client.
     </p></dd><dt id="idm140019138644112"><span class="term "><code class="filename">/etc/init.d/nfsserver</code>
    </span></dt><dd><p>
      Starts the NFS server.
     </p></dd><dt id="idm140019138642016"><span class="term "><code class="filename">/etc/init.d/postfix</code>
    </span></dt><dd><p>
      Controls the postfix process.
     </p></dd></dl></div></div></div><div class="sect1 " id="sec.network.router"><div class="titlepage"><div><div><h2 class="title" id="sec.network.router"><span class="number">13.7 </span><span class="name">Basic Router Setup</span> <a title="Permalink" class="permalink" href="#sec.network.router">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">Filename: </span>net_router.xml</li><li><span class="ds-label">ID: </span>sec.network.router</li></ul></div></div></div></div><p>
  A router is a networking device that delivers and receives data (network
  packets) to or from more than one network back and forth. You often use a
  router to connect your local network to the remote network (Internet) or to
  connect local network segments. With <span class="productname"><span class="phrase">openSUSE Leap</span></span> you can build a router with
  features such as NAT (Network Address Translation) or advanced firewalling.
 </p><p>
  The following are basic steps to turn <span class="productname"><span class="phrase">openSUSE Leap</span></span> into a router.
 </p><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
    Enable forwarding, for example in
    <code class="filename">/etc/sysctl.d/50-router.conf</code>
   </p><div class="verbatim-wrap"><pre class="screen">net.ipv4.conf.all.forwarding = 1
net.ipv6.conf.all.forwarding = 1</pre></div><p>
    Then provide a static IPv4 and IPv6 IP setup for the interfaces. Enabling
    forwarding disables several mechanisms, for example IPv6 does not accept an
    IPv6 RA (router advertisement) anymore, which also prevents the creation of
    a default route.
   </p></li><li class="step "><p>
    In many situations (for example, when you can reach the same network
    via more than one interface, or when VPN usually is used and already
    on <span class="quote">“<span class="quote">normal multi-home hosts</span>”</span>), you must disable the IPv4
    reverse path filter (this feature does not currently exist for IPv6):
   </p><div class="verbatim-wrap"><pre class="screen">net.ipv4.conf.all.rp_filter = 0</pre></div><p>
    You can also filter with firewall settings instead.
   </p></li><li class="step "><p>
    To accept an IPv6 RA (from the router on an external, uplink, or ISP
    interface) and create a default (or also a more specific) IPv6 route again,
    set:
   </p><div class="verbatim-wrap"><pre class="screen">net.ipv6.conf.${ifname}.accept_ra = 2
net.ipv6.conf.${ifname}.autoconf = 0</pre></div><p>
    (Note: <span class="quote">“<span class="quote"><code class="literal">eth0.42</code></span>”</span> needs to be written as
    <code class="literal">eth0/42</code> in a dot-separated sysfs path.)
   </p></li></ol></div></div><p>
  More router behavior and forwarding dependencies are described in
  <a class="link" href="https://www.kernel.org/doc/Documentation/networking/ip-sysctl.txt" target="_blank">https://www.kernel.org/doc/Documentation/networking/ip-sysctl.txt</a>.
 </p><p>
  To provide IPv6 on your internal (DMZ) interfaces, and announce yourself as
  an IPv6 router and <span class="quote">“<span class="quote">autoconf networks</span>”</span> to the clients, install
  and configure <code class="systemitem">radvd</code> in
  <code class="filename">/etc/radvd.conf</code>, for example:
 </p><div class="verbatim-wrap"><pre class="screen">interface eth0
{
    IgnoreIfMissing on;         # do not fail if interface missed

    AdvSendAdvert on;           # enable sending RAs
    AdvManagedFlag on;          # IPv6 addresses managed via DHCPv6
    AdvOtherConfigFlag on;      # DNS, NTP... only via DHCPv6

    AdvDefaultLifetime 3600;    # client default route lifetime of 1 hour

    prefix 2001:db8:0:1::/64    # (/64 is default and required for autoconf)
    {
        AdvAutonomous off;         # Disable address autoconf (DHCPv6 only)

        AdvValidLifetime 3600;     # prefix (autoconf addr) is valid 1 h
        AdvPreferredLifetime 1800; # prefix (autoconf addr) is prefered 1/2 h
    }
}</pre></div><p>
  Lastly configure the firewall. In SuSEfirewall2, you need to set
  <code class="literal">FW_ROUTE="yes"</code> (otherwise it will also reset forwarding
  sysctl again) and define the interfaces in the <code class="literal">FW_DEV_INT</code>,
  <code class="literal">FW_DEV_EXT</code> (and <code class="literal">FW_DEV_DMZ</code>) zone
  variables as needed, perhaps also <code class="literal">FW_MASQUERADE="yes"</code> and
  <code class="literal">FW_MASQ_DEV</code>.
 </p></div><div class="sect1 " id="sec.network.iface-bonding"><div class="titlepage"><div><div><h2 class="title" id="sec.network.iface-bonding"><span class="number">13.8 </span><span class="name">Setting Up Bonding Devices</span> <a title="Permalink" class="permalink" href="#sec.network.iface-bonding">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">Filename: </span>net_bonding.xml</li><li><span class="ds-label">ID: </span>sec.network.iface-bonding</li></ul></div></div></div></div><p>
  For some systems, there is a desire to implement network connections that
  comply to more than the standard data security or availability requirements
  of a typical Ethernet device. In these cases, several Ethernet devices can be
  aggregated to a single bonding device.
 </p><p>
  The configuration of the bonding device is done by means of bonding module
  options. The behavior is mainly affected by the mode of the bonding device.
  By default, this is <code class="systemitem">mode=active-backup</code> which means
  that a different slave device will become active if the active slave fails.
 </p><div id="idm140019138609072" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.png" /><h6>Tip: Bonding and Xen</h6><p>
   Using bonding devices is only of interest for machines where you have
   multiple real network cards available. In most configurations, this means
   that you should use the bonding configuration only in Dom0. Only if you
   have multiple network cards assigned to a VM Guest system it may also be
   useful to set up the bond in a VM Guest.
  </p></div><p>
  To configure a bonding device, use the following procedure:
 </p><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
    Run <span class="guimenu">YaST</span> › <span class="guimenu">System</span> › <span class="guimenu">Network Settings</span>.
   </p></li><li class="step "><p>
    Use <span class="guimenu">Add</span> and change the <span class="guimenu">Device Type</span> to
    <span class="guimenu">Bond</span>. Proceed with <span class="guimenu">Next</span>.
   </p><div class="informalfigure"><div class="mediaobject"><a xmlns="" href="images/bond_configuration.png"><img src="images/bond_configuration.png" width="" /></a></div></div></li><li class="step "><p>
    Select how to assign the IP address to the bonding device. Three methods
    are at your disposal:
   </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
      No IP Address
     </p></li><li class="listitem "><p>
      Dynamic Address (with DHCP or Zeroconf)
     </p></li><li class="listitem "><p>
      Statically assigned IP Address
     </p></li></ul></div><p>
    Use the method that is appropriate for your environment.
   </p></li><li class="step "><p>
    In the <span class="guimenu">Bond Slaves</span> tab, select the Ethernet devices that
    should be included into the bond by activating the related check box.
   </p></li><li class="step "><p>
    Edit the <span class="guimenu">Bond Driver Options</span>. The modes that are
    available for configuration are the following:
   </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
      balance-rr
     </p></li><li class="listitem "><p>
      active-backup
     </p></li><li class="listitem "><p>
      balance-xor
     </p></li><li class="listitem "><p>
      broadcast
     </p></li><li class="listitem "><p>
      802.3ad
     </p><p>
      <code class="literal">802.3ad</code> is the standardized LACP <span class="quote">“<span class="quote">IEEE 802.3ad
      Dynamic link aggregation</span>”</span> mode.
     </p></li><li class="listitem "><p>
      balance-tlb
     </p></li><li class="listitem "><p>
      balance-alb
     </p></li></ul></div></li><li class="step "><p>
    Make sure that the parameter <code class="literal">miimon=100</code> is added to the
    <span class="guimenu">Bond Driver Options</span>. Without this parameter, the data
    integrity is not checked regularly.
   </p></li><li class="step "><p>
    Click <span class="guimenu">Next</span> and leave YaST with <span class="guimenu">OK</span>
    to create the device.
   </p></li></ol></div></div><p>
  All modes, and many more options are explained in detail in the
  <span class="guimenu">Linux Ethernet Bonding Driver HOWTO</span> found at
  <code class="filename">/usr/src/linux/Documentation/networking/bonding.txt</code>
  after installing the package <code class="systemitem">kernel-source</code>.
 </p><div class="sect2 " id="sec.network.iface-bonding.hotplug"><div class="titlepage"><div><div><h3 class="title" id="sec.network.iface-bonding.hotplug"><span class="number">13.8.1 </span><span class="name">Hotplugging of Bonding Slaves</span> <a title="Permalink" class="permalink" href="#sec.network.iface-bonding.hotplug">#</a></h3></div></div></div><p>
   In specific network environments (such as High Availability), there are
   cases when you need to replace a bonding slave interface with another one.
   The reason may be a constantly failing network device. The solution is to
   set up hotplugging of bonding slaves.
  </p><p>
   The bond is configured as usual (according to <code class="command">man 5
   ifcfg-bonding</code>), for example:
  </p><div class="verbatim-wrap"><pre class="screen">ifcfg-bond0
          STARTMODE='auto' # or 'onboot'
          BOOTPROTO='static'
          IPADDR='192.168.0.1/24'
          BONDING_MASTER='yes'
          BONDING_SLAVE_0='eth0'
          BONDING_SLAVE_1='eth1'
          BONDING_MODULE_OPTS='mode=active-backup miimon=100'</pre></div><p>
   The slaves are specified with <code class="literal">STARTMODE=hotplug</code> and
   <code class="literal">BOOTPROTO=none</code>:
  </p><div class="verbatim-wrap"><pre class="screen">ifcfg-eth0
          STARTMODE='hotplug'
          BOOTPROTO='none'

ifcfg-eth1
          STARTMODE='hotplug'
          BOOTPROTO='none'</pre></div><p>
   <code class="literal">BOOTPROTO=none</code> uses the <code class="command">ethtool</code>
   options (when provided), but does not set the link up on <code class="command">ifup
   eth0</code>. The reason is that the slave interface is controlled by the
   bond master.
  </p><p>
   <code class="literal">STARTMODE=hotplug</code> causes the slave interface to join the
   bond automatically when it is available.
  </p><p>
   The <code class="systemitem">udev</code> rules in
   <code class="filename">/etc/udev/rules.d/70-persistent-net.rules</code> need to be
   changed to match the device by bus ID (udev <code class="systemitem">KERNELS</code>
   keyword equal to "SysFS BusID" as visible in <code class="command">hwinfo
   --netcard</code>) instead of by MAC address. This allows replacement of
   defective hardware (a network card in the same slot but with a different
   MAC) and prevents confusion when the bond changes the MAC address of all its
   slaves.
  </p><p>
   For example:
  </p><div class="verbatim-wrap"><pre class="screen">SUBSYSTEM=="net", ACTION=="add", DRIVERS=="?*",
KERNELS=="0000:00:19.0", ATTR{dev_id}=="0x0", ATTR{type}=="1",
KERNEL=="eth*", NAME="eth0"</pre></div><p>
   At boot time, the systemd <code class="systemitem">network.service</code> does not
   wait for the hotplug slaves, but for the bond to become ready, which
   requires at least one available slave. When one of the slave interfaces gets
   removed (unbind from NIC driver, <code class="command">rmmod</code> of the NIC driver
   or true PCI hotplug remove) from the system, the kernel removes it from the
   bond automatically. When a new card is added to the system (replacement of
   the hardware in the slot), <code class="systemitem">udev</code> renames it using
   the bus-based persistent name rule to the name of the slave, and calls
   <code class="command">ifup</code> for it. The <code class="command">ifup</code> call
   automatically joins it into the bond.
   
  </p></div></div><div class="sect1 " id="sec.network.iface-teaming"><div class="titlepage"><div><div><h2 class="title" id="sec.network.iface-teaming"><span class="number">13.9 </span><span class="name">Setting Up Team Devices for Network Teaming</span> <a title="Permalink" class="permalink" href="#sec.network.iface-teaming">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">Filename: </span>net_teaming.xml</li><li><span class="ds-label">ID: </span>sec.network.iface-teaming</li></ul></div></div></div></div><p>
  The term <span class="quote">“<span class="quote">link aggregation</span>”</span> is the general term which describes
  combining (or aggregating) a network connection to provide a logical layer.
  Sometimes you find the terms <span class="quote">“<span class="quote">channel teaming</span>”</span>, <span class="quote">“<span class="quote">Ethernet
  bonding</span>”</span>, <span class="quote">“<span class="quote">port truncating</span>”</span>, etc. which are synonyms and
  refer to the same concept.
 </p><p>
  This concept is widely known as <span class="quote">“<span class="quote">bonding</span>”</span> and was originally
  integrated into the Linux kernel (see <a class="xref" href="#sec.network.iface-bonding" title="13.8. Setting Up Bonding Devices">Section 13.8, “Setting Up Bonding Devices”</a> for the
  original implementation). The term <span class="emphasis"><em>Network Teaming</em></span> is used to
  refer to the new implementation of this concept.
 </p><p>
  The main difference between bonding and Network Teaming is that teaming supplies a
  set of small kernel modules responsible for providing an interface
  for teamd instances. Everything else is handled in user space. This is
  different from the original bonding implementation which contains all of its
  functionality exclusively in the kernel. For a comparison refer to <a class="xref" href="#tab.team.comparison" title="Feature Comparison between Bonding and Team">Table 13.5, “Feature Comparison between Bonding and Team”</a>.
 </p><div class="table" id="tab.team.comparison"><div class="table-title-wrap"><h6 class="table-title"><span class="number">Table 13.5: </span><span class="name">Feature Comparison between Bonding and Team </span><a title="Permalink" class="permalink" href="#tab.team.comparison">#</a></h6></div><div class="table-contents"><table summary="Feature Comparison between Bonding and Team" border="1"><colgroup><col class="c1" /><col class="c2" /><col class="c3" /></colgroup><thead><tr><th>Feature</th><th>Bonding</th><th>Team</th></tr></thead><tfoot><tr><th colspan="3">Source: <a class="link" href="http://libteam.org/files/teamdev.pp.pdf" target="_blank">http://libteam.org/files/teamdev.pp.pdf</a></th></tr></tfoot><tbody><tr><td>broadcast, round-robin TX policy</td><td>yes</td><td>yes</td></tr><tr><td>active-backup TX policy</td><td>yes</td><td>yes</td></tr><tr><td>LACP (802.3ad) support</td><td>yes</td><td>yes</td></tr><tr><td>hash-based TX policy</td><td>yes</td><td>yes</td></tr><tr><td>user can set hash function</td><td>no</td><td>yes</td></tr><tr><td>TX load-balancing support (TLB)</td><td>yes</td><td>yes</td></tr><tr><td>TX load-balancing support for LACP</td><td>no</td><td>yes</td></tr><tr><td>Ethtool link monitoring</td><td>yes</td><td>yes</td></tr><tr><td>ARP link monitoring</td><td>yes</td><td>yes</td></tr><tr><td>NS/NA (IPV6) link monitoring</td><td>no</td><td>yes</td></tr><tr><td>RCU locking on TX/RX paths</td><td>no</td><td>yes</td></tr><tr><td>port prio and stickiness</td><td>no</td><td>yes</td></tr><tr><td>separate per-port link monitoring setup</td><td>no</td><td>yes</td></tr><tr><td>multiple link monitoring setup</td><td>limited</td><td>yes</td></tr><tr><td>VLAN support</td><td>yes</td><td>yes</td></tr><tr><td>multiple device stacking</td><td>yes</td><td>yes</td></tr></tbody></table></div></div><p>
  Both implementations, bonding and Network Teaming, can be used in
  parallel. Network Teaming is an alternative to the existing bonding
  implementation. It does not replace bonding.
 </p><p>
  Network Teaming can be used for different use cases. The two most important use
  cases are explained later and involve:
 </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
    Load balancing between different network devices.
   </p></li><li class="listitem "><p>
    Failover from one network device to another in case one of the devices
    should fail.
   </p></li></ul></div><p>
  
  Currently, there is no YaST module to support creating a teaming device.
  You need to configure Network Teaming manually. The general procedure is shown
  below which can be applied for all your Network Teaming configurations:
 </p><div class="procedure " id="pro.team.general"><div class="procedure-title-wrap"><h6 class="procedure-title"><span class="number">Procedure 13.1: </span><span class="name">General Procedure </span><a title="Permalink" class="permalink" href="#pro.team.general">#</a></h6></div><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
    Make sure you have all the necessary packages installed. Install the
    packages
    <span class="package">libteam-tools</span>,
    <span class="package">libteamdctl0</span>, and
    <span class="package">python-libteam</span>.
   </p></li><li class="step "><p>
    Create a configuration file under
    <code class="filename">/etc/sysconfig/network/</code>. Usually it will be
    <code class="filename">ifcfg-team0</code>. If you need more than one Network Teaming
    device, give them ascending numbers.
   </p><p>
    This configuration file contains several variables which are explained in
    the man pages (see <code class="command">man ifcfg</code> and <code class="command">man
    ifcfg-team</code>). An example configuration can be found in your
    system in the file <code class="filename">/etc/sysconfig/network/ifcfg.template</code>.
   </p></li><li class="step "><p>
    Remove the configuration files of the interfaces which will be used for the
    teaming device (usually <code class="filename">ifcfg-eth0</code> and
    <code class="filename">ifcfg-eth1</code>).
   </p><p>
    It is recommended to make a backup and remove both files. Wicked will
    re-create the configuration files with the necessary parameters for
    teaming.
   </p></li><li class="step "><p>
    Optionally, check if everything is included in Wicked's configuration file:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> <code class="command">wicked show-config</code></pre></div></li><li class="step "><p>
    Start the Network Teaming device <code class="systemitem">team0</code>:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> <code class="command">wicked ifup all team0</code></pre></div><p>
    In case you need additional debug information, use the option
    <code class="option">--debug all</code> after the <code class="command">all</code> subcommand.
   </p></li><li class="step "><p>
    Check the status of the Network Teaming device. This can be done by the following
    commands:
   </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
      Get the state of the teamd instance from Wicked:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> <code class="command">wicked ifstatus --verbose team0</code></pre></div></li><li class="listitem "><p>
      Get the state of the entire instance:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> <code class="command">teamdctl team0 state</code></pre></div></li><li class="listitem "><p>
      Get the systemd state of the teamd instance:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> <code class="command">systemctl status teamd@team0</code></pre></div></li></ul></div><p>
    Each of them shows a slightly different view depending on your needs.
   </p></li><li class="step "><p>
    In case you need to change something in the
    <code class="filename">ifcfg-team0</code> file afterward, reload its configuration
    with:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> <code class="command">wicked ifreload team0</code></pre></div></li></ol></div></div><p>
  Do <span class="emphasis"><em>not</em></span> use <code class="command">systemctl</code> for starting or
  stopping the teaming device! Instead, use the <code class="command">wicked</code>
  command as shown above.
 </p><p>
  To completely remove the team device, use this procedure:
 </p><div class="procedure " id="idm140019138475648"><div class="procedure-title-wrap"><h6 class="procedure-title"><span class="number">Procedure 13.2: </span><span class="name">Removing a Team Device </span><a title="Permalink" class="permalink" href="#idm140019138475648">#</a></h6></div><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
    Stop the Network Teaming device <code class="systemitem">team0</code>:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> <code class="command">wicked ifdown team0</code></pre></div></li><li class="step "><p>
    Rename the file <code class="filename">/etc/sysconfig/network/ifcfg-team0</code> to <code class="filename">/etc/sysconfig/network/.ifcfg-team0</code>.
    Inserting a dot in front of the file name makes it
    <span class="quote">“<span class="quote">invisible</span>”</span> for wicked. If you really do not need the
    configuration anymore, you can also remove the file.
   </p></li><li class="step "><p>Reload the configuration:</p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> <code class="command">wicked ifreload all</code></pre></div></li></ol></div></div><div class="sect2 " id="sec.network.iface-teaming.lb"><div class="titlepage"><div><div><h3 class="title" id="sec.network.iface-teaming.lb"><span class="number">13.9.1 </span><span class="name">Use Case: Loadbalancing with Network Teaming</span> <a title="Permalink" class="permalink" href="#sec.network.iface-teaming.lb">#</a></h3></div></div></div><p>
   Loadbalancing is used to improve bandwidth. Use the following configuration
   file to create a Network Teaming device with loadbalancing capabilities. Proceed
   with <a class="xref" href="#pro.team.general" title="General Procedure">Procedure 13.1, “General Procedure”</a> to set up the device. Check the
   output with <code class="command">teamdctl</code>.
  </p><div class="example" id="ex.team.lb"><div class="example-title-wrap"><h6 class="example-title"><span class="number">Example 13.12: </span><span class="name">Configuration for Loadbalancing with Network Teaming </span><a title="Permalink" class="permalink" href="#ex.team.lb">#</a></h6></div><div class="example-contents"><div class="verbatim-wrap"><pre class="screen">STARTMODE=auto <span id="co.team.lb.startmode"></span><span class="callout">1</span>
BOOTPROTO=static <span id="co.team.lb.boot-and-ip"></span><span class="callout">2</span>
IPADDRESS="192.168.1.1/24" <a class="xref" href="#co.team.lb.boot-and-ip"><span class="callout">2</span></a>
IPADDR6="fd00:deca:fbad:50::1/64" <a class="xref" href="#co.team.lb.boot-and-ip"><span class="callout">2</span></a>

TEAM_RUNNER="loadbalance" <span id="co.team.lb.loadbalance"></span><span class="callout">3</span>
TEAM_LB_TX_HASH="ipv4,ipv6,eth,vlan"
TEAM_LB_TX_BALANCER_NAME="basic"
TEAM_LB_TX_BALANCER_INTERVAL="100"

TEAM_PORT_DEVICE_0="eth0" <span id="co.team.lb.dev"></span><span class="callout">4</span>
TEAM_PORT_DEVICE_1="eth1" <a class="xref" href="#co.team.lb.dev"><span class="callout">4</span></a>

TEAM_LW_NAME="ethtool" <span id="co.team.lb.name"></span><span class="callout">5</span>
TEAM_LW_ETHTOOL_DELAY_UP="10" <span id="co.team.lb.ethtool.delay"></span><span class="callout">6</span>
TEAM_LW_ETHTOOL_DELAY_DOWN="10" <a class="xref" href="#co.team.lb.ethtool.delay"><span class="callout">6</span></a></pre></div><div class="calloutlist "><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#co.team.lb.startmode"><span class="callout">1</span></a> </p></td><td valign="top" align="left"><p>
      Controls the start of the teaming device. The value of
      <code class="literal">auto</code> means, the interface will be set up when the
      network service is available and will be started automatically on every
      reboot.
     </p><p>
      In case you need to control the device yourself (and prevent it from
      starting automatically), set <code class="varname">STARTMODE</code> to
      <code class="literal">manual</code>.
     </p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#co.team.lb.boot-and-ip"><span class="callout">2</span></a> </p></td><td valign="top" align="left"><p>
      Sets a static IP address (here
      <code class="systemitem">192.168.1.1</code>
      for IPv4 and
      <code class="systemitem">fd00:deca:fbad:50::1</code> for
      IPv6).
     </p><p>
      If the Network Teaming device should use a dynamic IP address, set
      <code class="literal">BOOTPROTO="dhcp"</code> and remove (or comment) the line with
      <code class="varname">IPADDRESS</code> and <code class="varname">IPADDR6</code>.
     </p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#co.team.lb.loadbalance"><span class="callout">3</span></a> </p></td><td valign="top" align="left"><p>
      Sets <code class="varname">TEAM_RUNNER</code> to <code class="literal">loadbalance</code> to
      activate the loadbalancing mode.
     </p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#co.team.lb.dev"><span class="callout">4</span></a> </p></td><td valign="top" align="left"><p>
      Specifies one or more devices which should be aggregated to create the
      Network Teaming device.
     </p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#co.team.lb.name"><span class="callout">5</span></a> </p></td><td valign="top" align="left"><p>
      Defines a link watcher to monitor the state of subordinate devices. The
      default value <code class="literal">ethtool</code> checks only if the device is up
      and accessible. This makes this check fast enough. However, it does not
      check if the device can really send or receive packets.
     </p><p>
      If you need a higher confidence in the connection, use the
      <code class="literal">arp_ping</code> option. This sends pings to an arbitrary host
      (configured in the <code class="varname">TEAM_LW_ARP_PING_TARGET_HOST</code>
      variable). Only if the replies are received, the Network Teaming device is
      considered to be up.
     </p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#co.team.lb.ethtool.delay"><span class="callout">6</span></a> </p></td><td valign="top" align="left"><p>
      Defines the delay in milliseconds between the link coming up (or down)
      and the runner being notified.
     </p></td></tr></table></div></div></div></div><div class="sect2 " id="sec.network.iface-teaming.failover"><div class="titlepage"><div><div><h3 class="title" id="sec.network.iface-teaming.failover"><span class="number">13.9.2 </span><span class="name">Use Case: Failover with Network Teaming</span> <a title="Permalink" class="permalink" href="#sec.network.iface-teaming.failover">#</a></h3></div></div></div><p>
   Failover is used to ensure high availability of a critical Network Teaming device
   by involving a parallel backup network device. The backup network device is
   running all the time and takes over if and when the main device fails.
  </p><p>
   Use the following configuration file to create a Network Teaming device with
   failover capabilities. Proceed with <a class="xref" href="#pro.team.general" title="General Procedure">Procedure 13.1, “General Procedure”</a> to
   set up the device. Check the output with <code class="command">teamdctl</code>.
  </p><div class="example" id="ex.team.failover"><div class="example-title-wrap"><h6 class="example-title"><span class="number">Example 13.13: </span><span class="name">Configuration for DHCP Network Teaming Device </span><a title="Permalink" class="permalink" href="#ex.team.failover">#</a></h6></div><div class="example-contents"><div class="verbatim-wrap"><pre class="screen">STARTMODE=auto <span id="co.team.failover.startmode"></span><span class="callout">1</span>
BOOTPROTO=static <span id="co.team.failover.boot-and-ip"></span><span class="callout">2</span>
IPADDR="192.168.1.2/24" <a class="xref" href="#co.team.failover.boot-and-ip"><span class="callout">2</span></a>
IPADDR6="fd00:deca:fbad:50::2/64" <a class="xref" href="#co.team.failover.boot-and-ip"><span class="callout">2</span></a>

TEAM_RUNNER=activebackup <span id="co.team.failover.activebackup"></span><span class="callout">3</span>
TEAM_PORT_DEVICE_0="eth0" <span id="co.team.failover.dev"></span><span class="callout">4</span>
TEAM_PORT_DEVICE_1="eth1" <a class="xref" href="#co.team.failover.dev"><span class="callout">4</span></a>

TEAM_LW_NAME=ethtool <span id="co.team.failover.name"></span><span class="callout">5</span>
TEAM_LW_ETHTOOL_DELAY_UP="10" <span id="co.team.failover.ethtool.delay"></span><span class="callout">6</span>
TEAM_LW_ETHTOOL_DELAY_DOWN="10" <a class="xref" href="#co.team.failover.ethtool.delay"><span class="callout">6</span></a></pre></div><div class="calloutlist "><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#co.team.failover.startmode"><span class="callout">1</span></a> </p></td><td valign="top" align="left"><p>
      Controls the start of the teaming device. The value of
      <code class="literal">auto</code> means, the interface will be set up when the
      network service is available and will be started automatically on every
      reboot.
     </p><p>
      In case you need to control the device yourself (and prevent it from
      starting automatically), set <code class="varname">STARTMODE</code> to
      <code class="literal">manual</code>.
     </p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#co.team.failover.boot-and-ip"><span class="callout">2</span></a> </p></td><td valign="top" align="left"><p>
      Sets a static IP address (here
      <code class="systemitem">192.168.1.2</code>
      for IPv4 and
      <code class="systemitem">fd00:deca:fbad:50::2</code> for
      IPv6).
     </p><p>
      If the Network Teaming device should use a dynamic IP address, set
      <code class="literal">BOOTPROTO="dhcp"</code> and remove (or comment) the line with
      <code class="varname">IPADDRESS</code> and <code class="varname">IPADDR6</code>.
     </p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#co.team.failover.activebackup"><span class="callout">3</span></a> </p></td><td valign="top" align="left"><p>
      Sets <code class="varname">TEAM_RUNNER</code> to <code class="literal">activebackup</code> to
      activate the failover mode.
     </p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#co.team.failover.dev"><span class="callout">4</span></a> </p></td><td valign="top" align="left"><p>
      Specifies one or more devices which should be aggregated to create the
      Network Teaming device.
     </p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#co.team.failover.name"><span class="callout">5</span></a> </p></td><td valign="top" align="left"><p>
      Defines a link watcher to monitor the state of subordinate devices. The
      default value <code class="literal">ethtool</code> checks only if the device is up
      and accessible. This makes this check fast enough. However, it does not
      check if the device can really send or receive packets.
     </p><p>
      If you need a higher confidence in the connection, use the
      <code class="literal">arp_ping</code> option. This sends pings to an arbitrary host
      (configured in the <code class="varname">TEAM_LW_ARP_PING_TARGET_HOST</code>
      variable). Only if the replies are received, the Network Teaming device is
      considered to be up.
     </p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#co.team.failover.ethtool.delay"><span class="callout">6</span></a> </p></td><td valign="top" align="left"><p>
      Defines the delay in milliseconds between the link coming up (or down)
      and the runner being notified.
     </p></td></tr></table></div></div></div></div><div class="sect2 " id="sec.network.iface-teaming.vlan"><div class="titlepage"><div><div><h3 class="title" id="sec.network.iface-teaming.vlan"><span class="number">13.9.3 </span><span class="name">Use Case: VLAN over Team Device</span> <a title="Permalink" class="permalink" href="#sec.network.iface-teaming.vlan">#</a></h3></div></div></div><p>
   VLAN is an abbreviation of <span class="emphasis"><em>Virtual Local Area Network</em></span>.
   It allows the running of multiple <span class="emphasis"><em>logical</em></span> (virtual)
   ethernets over one single physical ethernet. It logically splits the
   network into different broadcast domains so that packets are only switched
   between ports that are designated for the same VLAN.
  </p><p>
   The following use case creates two static VLANs on top of a team device:
  </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p><code class="systemitem">vlan0</code>,
      bound to the IP address <code class="systemitem">192.168.10.1</code></p></li><li class="listitem "><p><code class="systemitem">vlan1</code>,
      bound to the IP address <code class="systemitem">192.168.20.1</code></p></li></ul></div><p>Proceed as follows:</p><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
     Enable the VLAN tags on your switch. If you want to use loadbalancing
     for your team device, your switch needs to be capable of
     <span class="emphasis"><em>Link Aggregation Control Protocol</em></span> (LACP) (802.3ad).
     Consult your hardware manual about the details.
    </p></li><li class="step "><p>
     Decide if you want to use loadbalancing or failover for your team device.
     Set up your team device as described in <a class="xref" href="#sec.network.iface-teaming.lb" title="13.9.1. Use Case: Loadbalancing with Network Teaming">Section 13.9.1, “Use Case: Loadbalancing with Network Teaming”</a>
     or <a class="xref" href="#sec.network.iface-teaming.failover" title="13.9.2. Use Case: Failover with Network Teaming">Section 13.9.2, “Use Case: Failover with Network Teaming”</a>.
    </p></li><li class="step "><p>
     In <code class="filename">/etc/sysconfig/network</code> create a file
     <code class="filename">ifcfg-vlan0</code> with the following content:
    </p><div class="verbatim-wrap"><pre class="screen">STARTMODE="auto"
BOOTPROTO="static" <span id="co.team.vlan.bootproto"></span><span class="callout">1</span>
IPADDR='192.168.10.1/24' <span id="co.team.vlan.ipaddr"></span><span class="callout">2</span>
ETHERDEVICE="team0" <span id="co.team.vlan.etherdevice"></span><span class="callout">3</span>
VLAN_ID="0" <span id="co.team.vlan.vlan_id"></span><span class="callout">4</span>
VLAN='yes'</pre></div><div class="calloutlist "><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#co.team.vlan.bootproto"><span class="callout">1</span></a> </p></td><td valign="top" align="left"><p>
       Defines a fixed IP address, specified in <code class="varname">IPADDR</code>.
      </p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#co.team.vlan.ipaddr"><span class="callout">2</span></a> </p></td><td valign="top" align="left"><p>
       Defines the IP address, here with its netmask.
      </p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#co.team.vlan.etherdevice"><span class="callout">3</span></a> </p></td><td valign="top" align="left"><p>
       Contains the real interface to use for the VLAN interface, here our
       team device (<code class="systemitem">team0</code>).
      </p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#co.team.vlan.vlan_id"><span class="callout">4</span></a> </p></td><td valign="top" align="left"><p>
       Specifies a unique ID for the VLAN. Preferably, the file name and the
       <code class="varname">VLAN_ID</code> corresponds to the name
       <code class="filename">ifcfg-vlan<em class="replaceable ">VLAN_ID</em></code>.
       In our case <code class="varname">VLAN_ID</code> is <code class="literal">0</code> which
       leads to the filename <code class="filename">ifcfg-vlan0</code>.
      </p></td></tr></table></div></li><li class="step "><p>
     Copy the file <code class="filename">/etc/sysconfig/network/ifcfg-vlan0</code> to
     <code class="filename">/etc/sysconfig/network/ifcfg-vlan1</code> and change the
     following values:
    </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
       <code class="varname">IPADDR</code> from <code class="systemitem">192.168.10.1/24</code> to <code class="systemitem">192.168.20.1/24</code>.</p></li><li class="listitem "><p>
       <code class="varname">VLAN_ID</code> from <code class="literal">0</code> to
      <code class="literal">1</code>.
      </p></li></ul></div></li><li class="step "><p>
     Start the two VLANs:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code><code class="command">wicked</code> ifup vlan0 vlan1</pre></div></li><li class="step "><p>
     Check the output of <code class="command">ifconfig</code>:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code><code class="command">ifconfig</code> -a
[...]
vlan0     Link encap:Ethernet  HWaddr 08:00:27:DC:43:98
          inet addr:192.168.10.1 Bcast:192.168.10.255 Mask:255.255.255.0
          inet6 addr: fe80::a00:27ff:fedc:4398/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:12 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          RX bytes:0 (0.0 b)  TX bytes:816 (816.0 b)

vlan1     Link encap:Ethernet  HWaddr 08:00:27:DC:43:98
          inet addr:192.168.20.1 Bcast:192.168.20.255 Mask:255.255.255.0
          inet6 addr: fe80::a00:27ff:fedc:4398/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:12 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          RX bytes:0 (0.0 b)  TX bytes:816 (816.0 b)</pre></div></li></ol></div></div></div></div><div class="sect1 " id="sec.network.openvswitch"><div class="titlepage"><div><div><h2 class="title" id="sec.network.openvswitch"><span class="number">13.10 </span><span class="name">Software-Defined Networking with <span class="productname">Open vSwitch</span></span> <a title="Permalink" class="permalink" href="#sec.network.openvswitch">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">Filename: </span>net_sdn.xml</li><li><span class="ds-label">ID: </span>sec.network.openvswitch</li></ul></div></div></div></div><p>
  Software-defined networking (SDN) means separating the system that controls
  where traffic is sent (the <span class="emphasis"><em>control plane</em></span>) from the
  underlying system that forwards traffic to the selected destination (the
  <span class="emphasis"><em>data plane</em></span>, also called the <span class="emphasis"><em>forwarding
  plane</em></span>). This means that the functions previously fulfilled by a
  single, usually inflexible switch, can now be separated between a switch (data
  plane) and its controller (control plane). In this model, the controller is
  programmable and can be very flexible and adapt quickly to changing network
  conditions.
 </p><p>
  <span class="productname">Open vSwitch</span> is software that implements a distributed virtual multilayer switch
  that is compatible with the

  <span class="productname">OpenFlow</span> protocol.
  <span class="productname">OpenFlow</span> allows a controller application
  to modify the configuration of a switch.
  <span class="productname">OpenFlow</span> is layered onto the TCP protocol
  and is implemented in a range of hardware and software. A single controller
  can thus drive multiple, very different switches.
 </p><div class="sect2 " id="sec.network.openvswitch.advantage"><div class="titlepage"><div><div><h3 class="title" id="sec.network.openvswitch.advantage"><span class="number">13.10.1 </span><span class="name">Advantages of <span class="productname">Open vSwitch</span></span> <a title="Permalink" class="permalink" href="#sec.network.openvswitch.advantage">#</a></h3></div></div></div><p>
   Software-defined networking with <span class="productname">Open vSwitch</span> brings several advantages with it,
   especially when you used together with virtual machines:
  </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
     Networking states can be identified easily.
    </p></li><li class="listitem "><p>
     Networks and their live state can be moved from one host to another.
    </p></li><li class="listitem "><p>
     Network dynamics are traceable and external software can be enabled to
     respond to them.
    </p></li><li class="listitem "><p>
     You can apply and manipulate tags in network packets to identify which
     machine they are coming from or going to and maintain other networking
     context.  Tagging rules can be configured and migrated.
    </p></li><li class="listitem "><p>
     <span class="productname">Open vSwitch</span> implements the GRE protocol (<span class="emphasis"><em>Generic Routing
     Encapsulation</em></span>). This allows you, for example, to connect
     private VM networks to each other.
    </p></li><li class="listitem "><p>
     <span class="productname">Open vSwitch</span> can be used on its own, but is designed to integrate with networking
     hardware and can control hardware switches.
    </p></li></ul></div></div><div class="sect2 " id="sec.network.openvswitch.install"><div class="titlepage"><div><div><h3 class="title" id="sec.network.openvswitch.install"><span class="number">13.10.2 </span><span class="name">Installing <span class="productname">Open vSwitch</span></span> <a title="Permalink" class="permalink" href="#sec.network.openvswitch.install">#</a></h3></div></div></div><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
     Install <span class="productname">Open vSwitch</span> and supplementary packages:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code><code class="command">zypper</code> install openvswitch openvswitch-switch</pre></div><p>
     If you plan to use <span class="productname">Open vSwitch</span> together with the KVM hypervisor, additionally
     install
     <span class="package">tunctl</span>
     . If you plan to use <span class="productname">Open vSwitch</span> together with the Xen hypervisor,
     additionally install
     <span class="package">openvswitch-kmp-xen</span>
     .
    </p></li><li class="step "><p>
     Enable the <span class="productname">Open vSwitch</span> service:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code><code class="command">systemctl</code> enable openvswitch</pre></div></li><li class="step "><p>
     Either restart the computer or use <code class="command">systemctl</code> to start
     the <span class="productname">Open vSwitch</span> service immediately:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code><code class="command">systemctl</code> start openvswitch</pre></div></li><li class="step "><p>
     To check whether <span class="productname">Open vSwitch</span> was activated correctly, use:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code><code class="command">systemctl</code> status openvswitch</pre></div></li></ol></div></div></div><div class="sect2 " id="sec.network.openvswitch.userspace"><div class="titlepage"><div><div><h3 class="title" id="sec.network.openvswitch.userspace"><span class="number">13.10.3 </span><span class="name">Overview of <span class="productname">Open vSwitch</span> Daemons and Utilities</span> <a title="Permalink" class="permalink" href="#sec.network.openvswitch.userspace">#</a></h3></div></div></div><p>
   <span class="productname">Open vSwitch</span> consists of several components. Among them are a kernel module and
   various user space components. The kernel module is used for accelerating
   the data path, but is not necessary for a minimal <span class="productname">Open vSwitch</span> installation.
  </p><div class="sect3 " id="sec.network.openvswitch.daemon"><div class="titlepage"><div><div><h4 class="title" id="sec.network.openvswitch.daemon"><span class="number">13.10.3.1 </span><span class="name">Daemons</span> <a title="Permalink" class="permalink" href="#sec.network.openvswitch.daemon">#</a></h4></div></div></div><p>
    The central executables of <span class="productname">Open vSwitch</span> are its two daemons. When you start the
    <code class="systemitem">openvswitch</code> service, you are indirectly starting
    them.
   </p><p>
    The main <span class="productname">Open vSwitch</span> daemon (<code class="command">ovs-vswitchd</code>) provides the
    implementation of a switch. The <span class="productname">Open vSwitch</span> database daemon
    (<code class="command">ovsdb-server</code>) serves the database that stores the
    configuration and state of <span class="productname">Open vSwitch</span>.
   </p></div><div class="sect3 " id="sec.network.openvswitch.utility"><div class="titlepage"><div><div><h4 class="title" id="sec.network.openvswitch.utility"><span class="number">13.10.3.2 </span><span class="name">Utilities</span> <a title="Permalink" class="permalink" href="#sec.network.openvswitch.utility">#</a></h4></div></div></div><p>
    <span class="productname">Open vSwitch</span> also comes with several utilities that help you work with it. The
    following list is not exhaustive, but instead describes important commands
    only.
   </p><div class="variablelist " id="vl.ovs.utility"><dl class="variablelist"><dt id="idm140019138315792"><span class="term "><code class="command">ovsdb-tool</code>
     </span></dt><dd><p>
       Create, upgrade, compact, and query <span class="productname">Open vSwitch</span> databases. Do transactions on
       <span class="productname">Open vSwitch</span> databases.
      </p></dd><dt id="idm140019138312272"><span class="term "><code class="command">ovs-appctl</code>
     </span></dt><dd><p>
       Configure a running <code class="command">ovs-vswitchd</code> or
       <code class="command">ovsdb-server</code> daemon.
      </p></dd><dt id="idm140019138309280"><span class="term "><code class="command">ovs-dpctl</code>, <code class="command">ovs-dpctl-top</code>
     </span></dt><dd><p>
       Create, modify, visualize, and delete data paths. Using this tool can
       interfere with <code class="command">ovs-vswitchd</code> also performing data path
       management. Therefore, it is often used for diagnostics only.
      </p><p>
       <code class="command">ovs-dpctl-top</code> creates a <code class="command">top</code>-like
       visualization for data paths.
       
      </p></dd><dt id="idm140019138304288"><span class="term "><code class="command">ovs-ofctl</code>
     </span></dt><dd><p>
       Manage any switches adhering to the
       <span class="productname">OpenFlow</span> protocol.
       <code class="command">ovs-ofctl</code> is not limited to interacting with <span class="productname">Open vSwitch</span>.
      </p></dd><dt id="idm140019138300272"><span class="term "><code class="command">ovs-vsctl</code>
     </span></dt><dd><p>
       Provides a high-level interface to the configuration database. It can be
       used to query and modify the database. In effect, it shows the status of
       <code class="command">ovs-vswitchd</code> and can be used to configure it.
      </p></dd></dl></div></div></div><div class="sect2 " id="sec.network.openvswitch.bridge"><div class="titlepage"><div><div><h3 class="title" id="sec.network.openvswitch.bridge"><span class="number">13.10.4 </span><span class="name">Creating a Bridge with <span class="productname">Open vSwitch</span></span> <a title="Permalink" class="permalink" href="#sec.network.openvswitch.bridge">#</a></h3></div></div></div><p>
   The following example configuration uses the Wicked network service that is
   used by default on <span class="productname"><span class="phrase">openSUSE Leap</span></span>. To learn more about Wicked, see
   <a class="xref" href="#sec.network.manconf" title="13.6. Configuring a Network Connection Manually">Section 13.6, “Configuring a Network Connection Manually”</a>.
  </p><p>
   When you have installed and started <span class="productname">Open vSwitch</span>, proceed as follows:
  </p><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
     To configure a bridge for use by your virtual machine, create a file with
     content like this:
    </p><div class="verbatim-wrap"><pre class="screen">STARTMODE='auto'<span id="ovs.ifcfg.mode"></span><span class="callout">1</span>
BOOTPROTO='dhcp'<span id="ovs.ifcfg.protocol"></span><span class="callout">2</span>
OVS_BRIDGE='yes'<span id="ovs.ifcfg.bridge"></span><span class="callout">3</span>
OVS_BRIDGE_PORT_DEVICE_1='<em class="replaceable ">eth0</em>'<span id="ovs.ifcfg.port"></span><span class="callout">4</span></pre></div><div class="calloutlist "><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#ovs.ifcfg.mode"><span class="callout">1</span></a> </p></td><td valign="top" align="left"><p>
       Set up the bridge automatically when the network service is started.
      </p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#ovs.ifcfg.protocol"><span class="callout">2</span></a> </p></td><td valign="top" align="left"><p>
       The protocol to use for configuring the IP address.
      </p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#ovs.ifcfg.bridge"><span class="callout">3</span></a> </p></td><td valign="top" align="left"><p>
       Mark the configuration as an <span class="productname">Open vSwitch</span> bridge.
      </p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#ovs.ifcfg.port"><span class="callout">4</span></a> </p></td><td valign="top" align="left"><p>
       Choose which device/devices should be added to the bridge. To add more
       devices, append additional lines for each of them to the file:
      </p><div class="verbatim-wrap"><pre class="screen">OVS_BRIDGE_PORT_DEVICE_<em class="replaceable ">SUFFIX</em>='<em class="replaceable ">DEVICE</em>'</pre></div><p>
       The <em class="replaceable ">SUFFIX</em> can be any alphanumeric string.
       However, to avoid overwriting a previous definition, make sure the
       <em class="replaceable ">SUFFIX</em> of each device is unique.
      </p></td></tr></table></div><p>
     Save the file in the directory <code class="filename">/etc/sysconfig/network</code>
     under the name <code class="filename">ifcfg-br0</code>. Instead of
     <em class="replaceable ">br0</em>, you can use any name you want. However,
     the file name needs to begin with <code class="literal">ifcfg-</code>.
    </p><p>
     To learn about further options, refer to the man pages of
     <code class="literal">ifcfg</code> (<code class="command">man 5 ifcfg</code>) and
     <code class="literal">ifcfg-ovs-bridge</code> (<code class="command">man 5
     ifcfg-ovs-bridge</code>).
    </p></li><li class="step "><p>
     Now start the bridge:
     
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code><code class="command">wicked</code> ifup <em class="replaceable ">br0</em></pre></div><p>
     When Wicked is done, it should output the name of the bridge and next to
     it the state <code class="literal">up</code>.
    </p></li></ol></div></div></div><div class="sect2 " id="sec.network.openvswitch.kvm"><div class="titlepage"><div><div><h3 class="title" id="sec.network.openvswitch.kvm"><span class="number">13.10.5 </span><span class="name">Using <span class="productname">Open vSwitch</span> Directly with KVM</span> <a title="Permalink" class="permalink" href="#sec.network.openvswitch.kvm">#</a></h3></div></div></div><p>
   After having created the bridge as described in
   <a class="xref" href="#sec.network.openvswitch.bridge" title="13.10.4. Creating a Bridge with Open vSwitch">Section 13.10.4, “Creating a Bridge with <span class="productname">Open vSwitch</span>”</a>, you can use <span class="productname">Open vSwitch</span> to manage the network
   access of virtual machines created with KVM/QEMU.
  </p><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
     To be able to best use the capabilities of Wicked, make some further
     changes to the bridge configured before. Open the previously created
     <code class="filename">/etc/sysconfig/network/ifcfg-br0</code> and append a line
     for another port device:
    </p><div class="verbatim-wrap"><pre class="screen">OVS_BRIDGE_PORT_DEVICE_2='<em class="replaceable ">tap0</em>'</pre></div><p>
     Additionally, set <code class="literal">BOOTPROTO</code> to <code class="literal">none</code>.
     The file should now look like this:
    </p><div class="verbatim-wrap"><pre class="screen">STARTMODE='auto'
BOOTPROTO='none'
OVS_BRIDGE='yes'
OVS_BRIDGE_PORT_DEVICE_1='<em class="replaceable ">eth0</em>'
OVS_BRIDGE_PORT_DEVICE_2='<em class="replaceable ">tap0</em>'</pre></div><p>
     The new port device <em class="replaceable ">tap0</em> will be configured in
     the next step.
    </p></li><li class="step "><p>
     Now add a configuration file for the <em class="replaceable ">tap0</em>
     device:
    </p><div class="verbatim-wrap"><pre class="screen">STARTMODE='auto'
BOOTPROTO='none'
TUNNEL='tap'</pre></div><p>
     Save the file in the directory <code class="filename">/etc/sysconfig/network</code>
     under the name <code class="filename">ifcfg-tap0</code>.
    </p><div id="idm140019138255856" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.png" /><h6>Tip: Allowing Other Users to Access the Tap Device</h6><p>
      To be able to use this tap device from a virtual machine started as a
      user who is not <code class="systemitem">root</code>, append:
     </p><div class="verbatim-wrap"><pre class="screen">TUNNEL_SET_OWNER=<em class="replaceable ">USER_NAME</em></pre></div><p>
      To allow access for an entire group, append:
     </p><div class="verbatim-wrap"><pre class="screen">TUNNEL_SET_GROUP=<em class="replaceable ">GROUP_NAME</em></pre></div></div></li><li class="step "><p>
     Finally, open the configuration for the device defined as the first
     <code class="literal">OVS_BRIDGE_PORT_DEVICE</code>. If you did not change the name,
     that should be <code class="literal">eth0</code>. Therefore, open
     <code class="filename">/etc/sysconfig/network/ifcfg-eth0</code> and make sure that
     the following options are set:
    </p><div class="verbatim-wrap"><pre class="screen">STARTMODE='auto'
BOOTPROTO='none'</pre></div><p>
     If the file does not exist yet, create it.
    </p></li><li class="step "><p>
     Restart the bridge interface using Wicked:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code><code class="command">wicked</code> ifreload <em class="replaceable ">br0</em></pre></div><p>
     This will also trigger a reload of the newly defined bridge port devices.
    </p></li><li class="step "><p>
     To start a virtual machine, use, for example:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code><code class="command">qemu-kvm</code> \
-drive file=<em class="replaceable ">/PATH/TO/DISK-IMAGE</em><span id="co.ovs.pathimage"></span><span class="callout">1</span> \
-m 512 -net nic,vlan=0,macaddr=00:11:22:EE:EE:EE \
-net tap,ifname=<em class="replaceable ">tap0</em>,script=no,downscript=no<span id="co.ovs.tapdevice"></span><span class="callout">2</span></pre></div><div class="calloutlist "><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#co.ovs.pathimage"><span class="callout">1</span></a> </p></td><td valign="top" align="left"><p>
       The path to the QEMU disk image you want to start.
      </p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#co.ovs.tapdevice"><span class="callout">2</span></a> </p></td><td valign="top" align="left"><p>
       Use the tap device (<code class="literal">tap0</code>) created before.
      </p></td></tr></table></div><p>
     For further information on the usage of KVM/QEMU, see
     <span class="intraxref">Book “<em class="citetitle ">Virtualization Guide</em>”</span>.
    </p></li></ol></div></div></div><div class="sect2 " id="sec.network.openvswitch.libvirt"><div class="titlepage"><div><div><h3 class="title" id="sec.network.openvswitch.libvirt"><span class="number">13.10.6 </span><span class="name">Using <span class="productname">Open vSwitch</span> with <code class="systemitem">libvirt</code></span> <a title="Permalink" class="permalink" href="#sec.network.openvswitch.libvirt">#</a></h3></div></div></div><p>
   After having created the bridge as described before in
   <a class="xref" href="#sec.network.openvswitch.bridge" title="13.10.4. Creating a Bridge with Open vSwitch">Section 13.10.4, “Creating a Bridge with <span class="productname">Open vSwitch</span>”</a>, you can add the bridge to an existing
   virtual machine managed with <code class="systemitem">libvirt</code>. Since <code class="systemitem">libvirt</code> has some support for
   <span class="productname">Open vSwitch</span> bridges already, you can use the bridge created in
   <a class="xref" href="#sec.network.openvswitch.bridge" title="13.10.4. Creating a Bridge with Open vSwitch">Section 13.10.4, “Creating a Bridge with <span class="productname">Open vSwitch</span>”</a> without further changes to the networking
   configuration.
  </p><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
     Open the domain XML file for the intended virtual machine:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code><code class="command">virsh</code> edit <em class="replaceable ">VM_NAME</em></pre></div><p>
     Replace <em class="replaceable ">VM_NAME</em> with the name of the desired
     virtual machine. This will open your default text editor.
    </p></li><li class="step "><p>
     Find the networking section of the document by looking for a section
     starting with <code class="literal">&lt;interface type="..."&gt;</code> and ending
     in <code class="literal">&lt;/interface&gt;</code>.
    </p><p>
     Replace the existing section with a networking section that looks somewhat
     like this:
    </p><div class="verbatim-wrap"><pre class="screen">&lt;interface type='bridge'&gt;
  &lt;source bridge='br0'/&gt;
  &lt;virtualport type='openvswitch'/&gt;
&lt;/interface&gt;</pre></div><div id="idm140019138223168" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.png" /><h6>Important: Compatibility of <code class="command">virsh iface-*</code> and Virtual Machine Manager with <span class="productname">Open vSwitch</span></h6><p>
      At the moment, the <span class="productname">Open vSwitch</span> compatibility of <code class="systemitem">libvirt</code> is not exposed
      through the <code class="command">virsh iface-*</code> tools and Virtual Machine Manager. If you use
      any of these tools, your configuration can break.
     </p></div></li><li class="step "><p>
     You can now start or restart the virtual machine as usual.
    </p></li></ol></div></div><p>
   For further information on the usage of <code class="systemitem">libvirt</code>, see
   <span class="intraxref">Book “<em class="citetitle ">Virtualization Guide</em>”</span>.
  </p></div><div class="sect2 " id="sec.network.openvswitch.more"><div class="titlepage"><div><div><h3 class="title" id="sec.network.openvswitch.more"><span class="number">13.10.7 </span><span class="name">For More Information</span> <a title="Permalink" class="permalink" href="#sec.network.openvswitch.more">#</a></h3></div></div></div><div class="variablelist "><dl class="variablelist"><dt id="idm140019138214064"><span class="term "><a class="link" href="http://openvswitch.org/support/" target="_blank">http://openvswitch.org/support/</a>
    </span></dt><dd><p>
      The documentation section of the <span class="productname">Open vSwitch</span> project Web site
     </p></dd><dt id="idm140019138211152"><span class="term "><a class="link" href="https://www.opennetworking.org/images/stories/downloads/sdn-resources/white-papers/wp-sdn-newnorm.pdf" target="_blank">https://www.opennetworking.org/images/stories/downloads/sdn-resources/white-papers/wp-sdn-newnorm.pdf</a>
    </span></dt><dd><p>
      Whitepaper by the Open Networking Foundation about software-defined
      networking and the <span class="productname">OpenFlow</span> protocol
     </p></dd></dl></div></div></div></div><div class="chapter " id="cha.uefi"><div class="titlepage"><div><div><h2 class="title"><span class="number">14 </span><span class="name">UEFI (Unified Extensible Firmware Interface)</span> <a title="Permalink" class="permalink" href="#cha.uefi">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">Filename: </span>uefi.xml</li><li><span class="ds-label">ID: </span>cha.uefi</li></ul></div></div></div></div><div class="line"><div class="toc"><dl><dt><span class="sect1"><a href="#sec.uefi.secboot"><span class="number">14.1 </span><span class="name">Secure Boot</span></a></span></dt><dt><span class="sect1"><a href="#sec.uefi.moreinfo"><span class="number">14.2 </span><span class="name">For More Information</span></a></span></dt></dl></div></div><p>
  UEFI (Unified Extensible Firmware Interface) is the interface between the
  firmware that comes with the system hardware, all the hardware components of
  the system, and the operating system.
 </p><p>
  UEFI is becoming more and more available on PC systems and thus is replacing
  the traditional PC-BIOS. UEFI, for example, properly supports 64-bit systems
  and offers secure booting (<span class="quote">“<span class="quote">Secure Boot</span>”</span>, firmware version
  2.3.1c or better required), which is one of its most important features.
  Lastly, with UEFI a standard firmware will become available on all x86
  platforms.
 </p><p>
  UEFI additionally offers the following advantages:
 </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
    Booting from large disks (over 2 TiB) with a GUID Partition Table (GPT).
   </p></li><li class="listitem "><p>
    CPU-independent architecture and drivers.
   </p></li><li class="listitem "><p>
    Flexible pre-OS environment with network capabilities.
   </p></li><li class="listitem "><p>
    CSM (Compatibility Support Module) to support booting legacy operating
    systems via a PC-BIOS-like emulation.
   </p></li></ul></div><p>
  For more information, see
  <a class="link" href="http://en.wikipedia.org/wiki/Unified_Extensible_Firmware_Interface" target="_blank">http://en.wikipedia.org/wiki/Unified_Extensible_Firmware_Interface</a>.
  The following sections are not meant as a general UEFI overview; these are
  only hints about how some features are implemented in <span class="productname"><span class="phrase">openSUSE Leap</span></span>.
 </p><div class="sect1 " id="sec.uefi.secboot"><div class="titlepage"><div><div><h2 class="title" id="sec.uefi.secboot"><span class="number">14.1 </span><span class="name">Secure Boot</span> <a title="Permalink" class="permalink" href="#sec.uefi.secboot">#</a></h2></div></div></div><p>
   In the world of UEFI, securing the bootstrapping process means establishing
   a chain of trust. The <span class="quote">“<span class="quote">platform</span>”</span> is the root of this chain of
   trust; in the context of <span class="productname"><span class="phrase">openSUSE Leap</span></span>, the mainboard and the on-board firmware
   could be considered the <span class="quote">“<span class="quote">platform</span>”</span>. In other words, it is the hardware vendor, and the chain of trust flows from
   that hardware vendor to the component manufacturers, the OS vendors, etc.
  </p><p>
   The trust is expressed via public key cryptography. The hardware vendor puts
   a so-called Platform Key (PK) into the firmware, representing the root of
   trust. The trust relationship with operating system vendors and others is
   documented by signing their keys with the Platform Key.
  </p><p>
   Finally, security is established by requiring that no code will be executed
   by the firmware unless it has been signed by one of these
   <span class="quote">“<span class="quote">trusted</span>”</span> keys—be it an OS boot loader, some driver
   located in the flash memory of some PCI Express card or on disk, or be it an
   update of the firmware itself.
  </p><p>
   To use Secure Boot, you need to have your OS loader signed with
   a key trusted by the firmware, and you need the OS loader to verify that the
   kernel it loads can be trusted.
  </p><p>

   Key Exchange Keys (KEK) can be added to the UEFI key database. This way, you
   can use other certificates, as long as they are signed with the private part
   of the PK.

  </p><div class="sect2 " id="sec.uefi.secboot.sle"><div class="titlepage"><div><div><h3 class="title" id="sec.uefi.secboot.sle"><span class="number">14.1.1 </span><span class="name">Implementation on <span class="productname"><span class="phrase">openSUSE Leap</span></span></span> <a title="Permalink" class="permalink" href="#sec.uefi.secboot.sle">#</a></h3></div></div></div><p>
    Microsoft’s Key Exchange Key (KEK) is installed by default.
   </p><div id="idm140019138183936" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note: GUID Partitioning Table (GPT) Required</h6><p>
     The Secure Boot feature is enabled by default on UEFI/x86_64
     installations. You can find the <span class="guimenu">Enable Secure Boot
     Support</span> option in the <span class="guimenu">Boot Code Options</span> tab
     of the <span class="guimenu">Boot Loader Settings</span> dialog. It supports booting
     when the secure boot is activated in the firmware, while making it
     possible to boot when it is deactivated.
    </p><div class="figure" id="idm140019138181152"><div class="figure-contents"><div class="mediaobject"><a xmlns="" href="images/yast2_bootloader_boot_code_efi.png"><img src="images/yast2_bootloader_boot_code_efi.png" width="" alt="Secure Boot Support" /></a></div></div><div class="figure-title-wrap"><h6 class="figure-title"><span class="number">Figure 14.1: </span><span class="name">Secure Boot Support </span><a title="Permalink" class="permalink" href="#idm140019138181152">#</a></h6></div></div><p>
     The Secure Boot feature requires that a GUID Partitioning Table (GPT)
     replaces the old partitioning with a Master Boot Record (MBR). If YaST
     detects EFI mode during the installation, it will try to create a GPT
     partition. UEFI expects to find the EFI programs on a FAT-formatted EFI
     System Partition (ESP).
    </p></div><p>
    Supporting UEFI Secure Boot essentially requires having a boot loader with
    a digital signature that the firmware recognizes as a trusted key. That key
    is trusted by the firmware a priori, without requiring any manual
    intervention.
   </p><p>
    There are two ways of getting there. One is to work with hardware vendors
    to have them endorse a SUSE key, which SUSE then signs the boot loader
    with. The other way is to go through Microsoft’s Windows Logo
    Certification program to have the boot loader certified and have Microsoft
    recognize the SUSE signing key (that is, have it signed with their KEK). By
    now, SUSE got the loader signed by UEFI Signing Service (that is Microsoft
    in this case).
   </p><div class="figure" id="fig.uefi.secure.boot.mok2"><div class="figure-contents"><div class="mediaobject"><a xmlns="" href="images/uefi-secure-boot-mok2.png"><img src="images/uefi-secure-boot-mok2.png" width="" alt="UEFI: Secure Boot Process" /></a></div></div><div class="figure-title-wrap"><h6 class="figure-title"><span class="number">Figure 14.2: </span><span class="name">UEFI: Secure Boot Process </span><a title="Permalink" class="permalink" href="#fig.uefi.secure.boot.mok2">#</a></h6></div></div><p>
    At the implementation layer, SUSE uses the <code class="systemitem">shim</code>
    loader which is installed by default. It is a smart solution that avoids
    legal issues, and simplifies the certification and signing step
    considerably. The <code class="systemitem">shim</code> loader’s job is to load a
    boot loader such as GRUB 2 and verify it; this boot loader in
    turn will load kernels signed by a SUSE key only. 
   </p><p>
    There are two types of trusted users:
   </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
      First, those who hold the keys. The Platform Key (PK) allows almost
      everything. The Key Exchange Key (KEK) allows all a PK can except
      changing the PK.
     </p></li><li class="listitem "><p>
      Second, anyone with physical access to the machine. A user with physical
      access can reboot the machine, and configure UEFI.
     </p></li></ul></div><p>
    UEFI offers two types of variables to fulfill the needs of those users:
   </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
      The first is the so-called <span class="quote">“<span class="quote">Authenticated Variables</span>”</span>, which
      can be updated from both within the boot process (the so-called Boot
      Services Environment) and the running OS. This can be done only when the new value of
      the variable is signed with the same key that the old value of the
      variable was signed with. And they can only be appended to or changed to
      a value with a higher serial number.
     </p></li><li class="listitem "><p>
      The second is the so-called <span class="quote">“<span class="quote">Boot Services Only Variables</span>”</span>.
      These variables are accessible to any code that runs during the boot
      process. After the boot process ends and before the OS starts, the boot
      loader must call the <code class="literal">ExitBootServices</code> call. After
      that, these variables are no longer accessible, and the OS cannot touch
      them.
     </p></li></ul></div><p>
    The various UEFI key lists are of the first type, as this allows online
    updating, adding, and blacklisting of keys, drivers, and firmware
    fingerprints. It is the second type of variable, the <span class="quote">“<span class="quote">Boot Services
    Only Variable</span>”</span>, that helps to implement Secure Boot in a secure and
    open source-friendly manner, and thus compatible with
    GPLv3.
   </p><p>
    SUSE starts with <code class="systemitem">shim</code>—a small and simple EFI
    boot loader signed by SUSE and Microsoft.
   </p><p>
    This allows <code class="systemitem">shim</code> to load and execute.
   </p><p>
    <code class="systemitem">shim</code> then goes on to verify that the boot loader
    it wants to load is trusted.

    In a default situation <code class="systemitem">shim</code> will use an
    independent SUSE certificate embedded in its body. In addition,
    <code class="systemitem">shim</code> will allow to <span class="quote">“<span class="quote">enroll</span>”</span>
    additional keys, overriding the default SUSE key. In the following, we call
    them <span class="quote">“<span class="quote">Machine Owner Keys</span>”</span> or MOKs for short.
   </p><p>
    Next the boot loader will verify and then boot the kernel, and the kernel
    will do the same on the modules.
   </p></div><div class="sect2 " id="sec.uefi.secboot.mok"><div class="titlepage"><div><div><h3 class="title" id="sec.uefi.secboot.mok"><span class="number">14.1.2 </span><span class="name">MOK (Machine Owner Key)</span> <a title="Permalink" class="permalink" href="#sec.uefi.secboot.mok">#</a></h3></div></div></div><p>
    If the user (<span class="quote">“<span class="quote">machine owner</span>”</span>) wants to replace any components
    of the boot process, Machine Owner Keys (MOKs) are to be used. The
    <code class="systemitem">mokutils</code> tool will help with signing components
    and managing MOKs.
   </p><p>
    The enrollment process begins with rebooting the machine and interrupting
    the boot process (for example, pressing a key) when
    <code class="systemitem">shim</code> loads. <code class="systemitem">shim</code> will
    then go into enrollment mode, allowing the user to replace the default SUSE
    key with keys from a file on the boot partition. If the user chooses to do
    so, <code class="systemitem">shim</code> will then calculate a hash of that file
    and put the result in a <span class="quote">“<span class="quote">Boot Services Only</span>”</span> variable. This
    allows <code class="systemitem">shim</code> to detect any change of the file made
    outside of Boot Services and thus avoid tampering with the list of
    user-approved MOKs.
   </p><p>
    All of this happens during boot time—only verified code is executing
    now. Therefore, only a user present at the console can use the machine
    owner's set of keys. It cannot be malware or a hacker with remote access to
    the OS because hackers or malware can only change the file, but not the
    hash stored in the <span class="quote">“<span class="quote">Boot Services Only</span>”</span> variable.
   </p><p>
    The boot loader, after having been loaded and verified by
    <code class="systemitem">shim</code>, will call back to
    <code class="systemitem">shim</code> when it wants to verify the kernel—to
    avoid duplication of the verification code. <code class="systemitem">Shim</code>
    will use the same list of MOKs for this and tell the boot loader whether it
    can load the kernel.
   </p><p>
    This way, you can install your own kernel or boot loader. It is only
    necessary to install a new set of keys and authorize them by being
    physically present during the first reboot. Because MOKs are a list and not
    not a single MOK, you can make <code class="systemitem">shim</code> trust keys
    from several vendors, allowing dual- and multi-boot from the boot loader.
   </p></div><div class="sect2 " id="sec.uefi.secboot.custom"><div class="titlepage"><div><div><h3 class="title" id="sec.uefi.secboot.custom"><span class="number">14.1.3 </span><span class="name">Booting a Custom Kernel</span> <a title="Permalink" class="permalink" href="#sec.uefi.secboot.custom">#</a></h3></div></div></div><p>
    The following is based on
    <a class="link" href="http://en.opensuse.org/openSUSE:UEFI#Booting_a_custom_kernel" target="_blank">http://en.opensuse.org/openSUSE:UEFI#Booting_a_custom_kernel</a>.
   </p><p>
    Secure Boot does not prevent you from using a self-compiled kernel. You
    must sign it with your own certificate and make that certificate known to
    the firmware or MOK.
   </p><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
      Create a custom X.509 key and certificate used for signing:
     </p><div class="verbatim-wrap"><pre class="screen">openssl req -new -x509 -newkey rsa:2048 -keyout key.asc \
  -out cert.pem -nodes -days 666 -subj "/CN=$USER/"</pre></div><p>

      For more information about creating certificates, see
      <a class="link" href="http://en.opensuse.org/openSUSE:UEFI_Image_File_Sign_Tools#Create_Your_Own_Certificate" target="_blank">http://en.opensuse.org/openSUSE:UEFI_Image_File_Sign_Tools#Create_Your_Own_Certificate</a>.
     </p></li><li class="step "><p>
      Package the key and the certificate as a PKCS#12 structure:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>openssl pkcs12 -export -inkey key.asc -in cert.pem \
  -name kernel_cert -out cert.p12</pre></div></li><li class="step "><p>
      Generate an NSS database for use with <code class="command">pesign</code>:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>certutil -d . -N</pre></div></li><li class="step "><p>
      Import the key and the certificate contained in PKCS#12 into the NSS
      database:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>pk12util -d . -i cert.p12</pre></div></li><li class="step "><p>
      <span class="quote">“<span class="quote">Bless</span>”</span> the kernel with the new signature using
      <code class="command">pesign</code>:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>pesign -n . -c kernel_cert -i arch/x86/boot/bzImage \
  -o vmlinuz.signed -s</pre></div></li><li class="step "><p>
      List the signatures on the kernel image:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>pesign -n . -S -i vmlinuz.signed</pre></div><p>
      At that point, you can install the kernel in <code class="filename">/boot</code>
      as usual. Because the kernel now has a custom signature the certificate
      used for signing needs to be imported into the UEFI firmware or MOK.
     </p></li><li class="step "><p>
      Convert the certificate to the DER format for import into the firmware or
      MOK:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>openssl x509 -in cert.pem -outform der -out cert.der</pre></div></li><li class="step "><p>
      Copy the certificate to the ESP for easier access:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> cp cert.der /boot/efi/</pre></div></li><li class="step "><p>
      Use <code class="command">mokutil</code> to launch the MOK list automatically.
     </p><ul class="stepalternatives ">
      <li class="step "><ol type="a" class="substeps "><li class="step "><p>
          Import the certificate to MOK:
         </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>mokutil --root-pw --import cert.der</pre></div><p>
          The <code class="option">--root-pw</code> option enables usage of the <code class="systemitem">root</code>
          user directly.
         </p></li><li class="step "><p>
          Check the list of certificates that are prepared to be enrolled:
         </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>mokutil --list-new</pre></div></li><li class="step "><p>
          Reboot the system; <code class="systemitem">shim</code> should launch
          MokManager. You need to enter the <code class="systemitem">root</code> password to confirm the
          import of the certificate to the MOK list.
         </p></li><li class="step "><p>
          Check if the newly imported key was enrolled:
         </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>mokutil --list-enrolled</pre></div></li></ol></li>
      <li class="step "><ol type="a" class="substeps "><li class="step "><p>
          Alternatively, this is the procedure if you want to launch MOK
          manually:
         </p><p>
          Reboot
         </p></li><li class="step "><p>
          In the GRUB 2 menu press the '<code class="literal">c</code>' key.
         </p></li><li class="step "><p>
          Type:
         </p><div class="verbatim-wrap"><pre class="screen">chainloader $efibootdir/MokManager.efi
boot</pre></div></li><li class="step "><p>
          Select <span class="guimenu">Enroll key from disk</span>.
         </p></li><li class="step "><p>
          Navigate to the <code class="filename">cert.der</code> file and press
          <span class="keycap">Enter</span>.
         </p></li><li class="step "><p>
          Follow the instructions to enroll the key. Normally this should be
          pressing '<code class="literal">0</code>' and then '<code class="literal">y</code>' to
          confirm.
         </p><p>
          Alternatively, the firmware menu may provide ways to add a new key to
          the Signature Database.
         </p></li></ol></li>
     </ul></li></ol></div></div></div><div class="sect2 " id="sec.uefi.secboot.non-inbox"><div class="titlepage"><div><div><h3 class="title" id="sec.uefi.secboot.non-inbox"><span class="number">14.1.4 </span><span class="name">Using Non-Inbox Drivers</span> <a title="Permalink" class="permalink" href="#sec.uefi.secboot.non-inbox">#</a></h3></div></div></div><p>
    There is no support for adding non-inbox drivers (that is, drivers that do
    not come with <span class="productname"><span class="phrase">openSUSE Leap</span></span>) during installation with Secure Boot enabled. The
    signing key used for SolidDriver/PLDP is not trusted by default.
   </p><p>
    It is possible to install third party drivers during installation with
    Secure Boot enabled in two different ways. In both cases:
   </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
      Add the needed keys to the firmware database via firmware/system
      management tools before the installation. This option depends on the
      specific hardware you are using. Consult your hardware vendor for more
      information.
     </p></li><li class="listitem "><p>
      Use a bootable driver ISO from
      <a class="link" href="https://drivers.suse.com/" target="_blank">https://drivers.suse.com/</a> or your hardware vendor to
      enroll the needed keys in the MOK list at first boot.
     </p></li></ul></div><p>
    To use the bootable driver ISO to enroll the driver keys to the MOK list,
    follow these steps:
   </p><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
      Burn the ISO image above to an empty CD/DVD medium.
     </p></li><li class="step "><p>
      Start the installation using the new CD/DVD medium, having the standard
      installation media at hand or a URL to a network installation
      server.
     </p><p>
      If doing a network installation, enter the URL of the network
      installation source on the boot command line using the
      <code class="option">install=</code> option.
     </p><p>
      If doing installation from optical media, the installer will first boot
      from the driver kit and then ask to insert the first installation disk of
      the product.
     </p></li><li class="step "><p>
      An initrd containing updated drivers will be used for installation.
     </p></li></ol></div></div><p>
    For more information, see
    <a class="link" href="https://drivers.suse.com/doc/Usage/Secure_Boot_Certificate.html" target="_blank">https://drivers.suse.com/doc/Usage/Secure_Boot_Certificate.html</a>.
   </p></div><div class="sect2 " id="sec.uefi.secboot.feats"><div class="titlepage"><div><div><h3 class="title" id="sec.uefi.secboot.feats"><span class="number">14.1.5 </span><span class="name">Features and Limitations</span> <a title="Permalink" class="permalink" href="#sec.uefi.secboot.feats">#</a></h3></div></div></div><p>
    When booting in Secure Boot mode, the following features apply:
   </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
      Installation to UEFI default boot loader location, a mechanism to keep or
      restore the EFI boot entry.
     </p></li><li class="listitem "><p>
      Reboot via UEFI.
     </p></li><li class="listitem "><p>
      Xen hypervisor will boot with UEFI when there is no legacy BIOS to fall
      back to.
     </p></li><li class="listitem "><p>
      UEFI IPv6 PXE boot support.
     </p></li><li class="listitem "><p>
      UEFI videomode support, the kernel can retrieve video mode from UEFI
      to configure KMS mode with the same parameters.
     </p></li><li class="listitem "><p>
      UEFI booting from USB devices is supported.
     </p></li></ul></div><p>
    When booting in Secure Boot mode, the following limitations apply:
   </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
      To ensure that Secure Boot cannot be easily circumvented, some kernel
      features are disabled when running under Secure Boot.
     </p></li><li class="listitem "><p>
      Boot loader, kernel, and kernel modules must be signed.
     </p></li><li class="listitem "><p>
      Kexec and Kdump are disabled.
     </p></li><li class="listitem "><p>
      Hibernation (suspend on disk) is disabled.
     </p></li><li class="listitem "><p>
      Access to <code class="filename">/dev/kmem</code> and
      <code class="filename">/dev/mem</code> is not possible, not even as root user.
     </p></li><li class="listitem "><p>
      Access to the I/O port is not possible, not even as root user. All X11
      graphical drivers must use a kernel driver.
     </p></li><li class="listitem "><p>
      PCI BAR access through sysfs is not possible.
     </p></li><li class="listitem "><p>
      <code class="literal">custom_method</code> in ACPI is not available.
     </p></li><li class="listitem "><p>
      debugfs for asus-wmi module is not available.
     </p></li><li class="listitem "><p>
      the <code class="literal">acpi_rsdp</code> parameter does not have any effect on
      the kernel.
     </p></li></ul></div></div></div><div class="sect1 " id="sec.uefi.moreinfo"><div class="titlepage"><div><div><h2 class="title" id="sec.uefi.moreinfo"><span class="number">14.2 </span><span class="name">For More Information</span> <a title="Permalink" class="permalink" href="#sec.uefi.moreinfo">#</a></h2></div></div></div><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
     <a class="link" href="http://www.uefi.org" target="_blank">http://www.uefi.org</a> —UEFI home page where you
     can find the current UEFI specifications.
    </p></li><li class="listitem "><p>
     Blog posts by Olaf Kirch and Vojtěch Pavlík (the chapter above is
     heavily based on these posts):
    </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
       <a class="link" href="http://www.suse.com/blogs/uefi-secure-boot-plan/" target="_blank">http://www.suse.com/blogs/uefi-secure-boot-plan/</a>
      </p></li><li class="listitem "><p>
       <a class="link" href="http://www.suse.com/blogs/uefi-secure-boot-overview/" target="_blank">http://www.suse.com/blogs/uefi-secure-boot-overview/</a>
      </p></li><li class="listitem "><p>
       <a class="link" href="http://www.suse.com/blogs/uefi-secure-boot-details/" target="_blank">http://www.suse.com/blogs/uefi-secure-boot-details/</a>
      </p></li></ul></div></li><li class="listitem "><p>
     <a class="link" href="http://en.opensuse.org/openSUSE:UEFI" target="_blank">http://en.opensuse.org/openSUSE:UEFI</a> —UEFI with
     openSUSE.
    </p></li></ul></div></div></div><div class="chapter " id="cha.suse"><div class="titlepage"><div><div><h2 class="title"><span class="number">15 </span><span class="name">Special System Features</span> <a title="Permalink" class="permalink" href="#cha.suse">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">Filename: </span>suse_linux.xml</li><li><span class="ds-label">ID: </span>cha.suse</li></ul></div></div><div><div class="abstract"><div class="abstract-title-wrap"><h6 class="abstract-title">Abstract<a title="Permalink" class="permalink" href="#idm140019138047568">#</a></h6></div><p>
    This chapter starts with information about various software packages, the
    virtual consoles and the keyboard layout. We talk about software components
    like <code class="systemitem">bash</code>,
    <code class="systemitem">cron</code> and
    <code class="systemitem">logrotate</code>, because they were
    changed or enhanced during the last release cycles. Even if they are small
    or considered of minor importance, users should change their default
    behavior, because these components are often closely coupled with the
    system. The chapter concludes with a section about language and
    country-specific settings (I18N and L10N).
   </p></div></div></div></div><div class="line"><div class="toc"><dl><dt><span class="sect1"><a href="#sec.suse.packages"><span class="number">15.1 </span><span class="name">Information about Special Software Packages</span></a></span></dt><dt><span class="sect1"><a href="#sec.suse.virt.konsolen"><span class="number">15.2 </span><span class="name">Virtual Consoles</span></a></span></dt><dt><span class="sect1"><a href="#sec.suse.kb"><span class="number">15.3 </span><span class="name">Keyboard Mapping</span></a></span></dt><dt><span class="sect1"><a href="#sec.suse.l10n"><span class="number">15.4 </span><span class="name">Language and Country-Specific Settings</span></a></span></dt></dl></div></div><div class="sect1 " id="sec.suse.packages"><div class="titlepage"><div><div><h2 class="title" id="sec.suse.packages"><span class="number">15.1 </span><span class="name">Information about Special Software Packages</span> <a title="Permalink" class="permalink" href="#sec.suse.packages">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">Filename: </span>suse_sw_packages.xml</li><li><span class="ds-label">ID: </span>sec.suse.packages</li></ul></div></div></div></div><p>
  The programs <code class="systemitem">bash</code>,
  <code class="systemitem">cron</code>,
  <code class="systemitem">logrotate</code>,
  <code class="systemitem">locate</code>,
  <code class="systemitem">ulimit</code> and
  <code class="systemitem">free</code> are very important for system
  administrators and many users. Man pages and info pages are two useful
  sources of information about commands, but both are not always available. GNU
  Emacs is a popular and very configurable text editor.
 </p><div class="sect2 " id="sec.suse.packages.bash"><div class="titlepage"><div><div><h3 class="title" id="sec.suse.packages.bash"><span class="number">15.1.1 </span><span class="name">The <code class="systemitem">bash</code> Package and <code class="filename">/etc/profile</code></span> <a title="Permalink" class="permalink" href="#sec.suse.packages.bash">#</a></h3></div></div></div><p>
   Bash is the default system shell. When used as a login shell, it reads
   several initialization files. Bash processes them in the order they appear
   in this list:
  </p><div class="orderedlist "><ol class="orderedlist" type="1"><li class="listitem "><p>
     <code class="filename">/etc/profile</code>
    </p></li><li class="listitem "><p>
     <code class="filename">~/.profile</code>
    </p></li><li class="listitem "><p>
     <code class="filename">/etc/bash.bashrc</code>
    </p></li><li class="listitem "><p>
     <code class="filename">~/.bashrc</code>
    </p></li></ol></div><p>
   Make custom settings in <code class="filename">~/.profile</code> or
   <code class="filename">~/.bashrc</code>. To ensure the correct processing of these
   files, it is necessary to copy the basic settings from
   <code class="filename">/etc/skel/.profile</code> or
   <code class="filename">/etc/skel/.bashrc</code> into the home directory of the user.
   It is recommended to copy the settings from <code class="filename">/etc/skel</code>
   after an update. Execute the following shell commands to prevent the loss of
   personal adjustments:
  </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>mv ~/.bashrc ~/.bashrc.old
<code class="prompt user">tux &gt; </code>cp /etc/skel/.bashrc ~/.bashrc
<code class="prompt user">tux &gt; </code>mv ~/.profile ~/.profile.old
<code class="prompt user">tux &gt; </code>cp /etc/skel/.profile ~/.profile</pre></div><p>
   Then copy personal adjustments back from the <code class="literal">*.old</code> files.
  </p></div><div class="sect2 " id="sec.suse.packages.cron"><div class="titlepage"><div><div><h3 class="title" id="sec.suse.packages.cron"><span class="number">15.1.2 </span><span class="name">The <span class="phrase">cron</span> Package</span> <a title="Permalink" class="permalink" href="#sec.suse.packages.cron">#</a></h3></div></div></div><p>
   Use <code class="systemitem">cron</code> to automatically run
   commands in the background at
   predefined times. <code class="systemitem">cron</code> uses specially
   formatted time tables, and the tool comes with several default ones. Users
   can also specify custom tables, if needed.
  </p><p>
   The cron tables are located in <code class="filename">/var/spool/cron/tabs</code>.
   <code class="filename">/etc/crontab</code> serves as a systemwide cron table. Enter
   the user name to run the command directly after the time table and before
   the command. In <a class="xref" href="#ex.suse.packages.cron" title="Entry in /etc/crontab">Example 15.1, “Entry in /etc/crontab”</a>,
   <code class="systemitem">root</code> is entered. Package-specific
   tables, located in <code class="filename">/etc/cron.d</code>, have the same format.
   See the <code class="command">cron</code> man page (<code class="command">man cron</code>).
  </p><div class="example" id="ex.suse.packages.cron"><div class="example-title-wrap"><h6 class="example-title"><span class="number">Example 15.1: </span><span class="name">Entry in /etc/crontab </span><a title="Permalink" class="permalink" href="#ex.suse.packages.cron">#</a></h6></div><div class="example-contents"><div class="verbatim-wrap"><pre class="screen">1-59/5 * * * *   root   test -x /usr/sbin/atrun &amp;&amp; /usr/sbin/atrun</pre></div></div></div><p>
   You cannot edit <code class="filename">/etc/crontab</code> by calling the command
   <code class="command">crontab -e</code>. This file must be loaded directly into an
   editor, then modified and saved.
  </p><p>
   A number of packages install shell scripts to the directories
   <code class="filename">/etc/cron.hourly</code>, <code class="filename">/etc/cron.daily</code>,
   <code class="filename">/etc/cron.weekly</code> and
   <code class="filename">/etc/cron.monthly</code>, whose execution is controlled by
   <code class="filename">/usr/lib/cron/run-crons</code>.
   <code class="filename">/usr/lib/cron/run-crons</code> is run every 15 minutes from
   the main table (<code class="filename">/etc/crontab</code>). This guarantees that
   processes that may have been neglected can be run at the proper time.
  </p><p>
   To run the <code class="filename">hourly</code>, <code class="filename">daily</code> or other
   periodic maintenance scripts at custom times, remove the time stamp files
   regularly using <code class="filename">/etc/crontab</code> entries (see
   <a class="xref" href="#ex.suse.packages.cron.time" title="/etc/crontab: Remove Time Stamp Files">Example 15.2, “/etc/crontab: Remove Time Stamp Files”</a>, which removes the
   <code class="filename">hourly</code> one before every full hour, the
   <code class="filename">daily</code> one once a day at 2:14 a.m., etc.).
  </p><div class="example" id="ex.suse.packages.cron.time"><div class="example-title-wrap"><h6 class="example-title"><span class="number">Example 15.2: </span><span class="name">/etc/crontab: Remove Time Stamp Files </span><a title="Permalink" class="permalink" href="#ex.suse.packages.cron.time">#</a></h6></div><div class="example-contents"><div class="verbatim-wrap"><pre class="screen">59 *  * * *     root  rm -f /var/spool/cron/lastrun/cron.hourly
14 2  * * *     root  rm -f /var/spool/cron/lastrun/cron.daily
29 2  * * 6     root  rm -f /var/spool/cron/lastrun/cron.weekly
44 2  1 * *     root  rm -f /var/spool/cron/lastrun/cron.monthly</pre></div></div></div><p>
   Or you can set <code class="literal">DAILY_TIME</code> in
   <code class="filename">/etc/sysconfig/cron</code> to the time at which
   <code class="filename">cron.daily</code> should start. The setting of
   <code class="literal">MAX_NOT_RUN</code> ensures that the daily tasks get triggered to
   run, even if the user did not turn on the computer at the specified
   <code class="literal">DAILY_TIME</code> for a longer time. The maximum value of
   <code class="literal">MAX_NOT_RUN</code> is 14 days.
  </p><p>
   The daily system maintenance jobs are distributed to various scripts for
   reasons of clarity. They are contained in the package
   <code class="systemitem">aaa_base</code>.
   <code class="filename">/etc/cron.daily</code> contains, for example, the components
   <code class="filename">suse.de-backup-rpmdb</code>,
   <code class="filename">suse.de-clean-tmp</code> or
   <code class="filename">suse.de-cron-local</code>.
   
  </p></div><div class="sect2 " id="sec.suse.packages.cronstatus"><div class="titlepage"><div><div><h3 class="title" id="sec.suse.packages.cronstatus"><span class="number">15.1.3 </span><span class="name">Stopping Cron Status Messages</span> <a title="Permalink" class="permalink" href="#sec.suse.packages.cronstatus">#</a></h3></div></div></div><p>
   To avoid the mail-flood caused by cron status messages, the default value of
   <code class="literal">SEND_MAIL_ON_NO_ERROR</code> in
   <code class="filename">/etc/sysconfig/cron</code> is set to "<code class="literal">no</code>"
   for new installations. Even with this setting to "<code class="literal">no</code>",
   cron data output will still be sent to the <code class="literal">MAILTO</code>
   address, as documented in the cron man page.
  </p><p>
   In the update case it is recommended to set these values according to your
   needs.
  </p></div><div class="sect2 " id="sec.suse.log"><div class="titlepage"><div><div><h3 class="title" id="sec.suse.log"><span class="number">15.1.4 </span><span class="name">Log Files: Package logrotate</span> <a title="Permalink" class="permalink" href="#sec.suse.log">#</a></h3><div class="doc-status"><ul><li><span class="ds-label">Filename: </span>suse_logfiles.xml</li><li><span class="ds-label">ID: </span>sec.suse.log</li></ul></div></div></div></div><p>
  There are several system services (<span class="emphasis"><em>daemons</em></span>) that, along
  with the kernel itself, regularly record the system status and specific
  events onto log files. This way, the administrator can regularly check the
  status of the system at a certain point in time, recognize errors or faulty
  functions and troubleshoot them with pinpoint precision. These log files are
  normally stored in <code class="filename">/var/log</code> as specified by FHS and grow
  on a daily basis. The <code class="systemitem">logrotate</code> package helps
  control the growth of these files. For more details refer to <span class="intraxref">Book “<em class="citetitle ">System Analysis and Tuning Guide</em>”, Chapter 3 “Analyzing and Managing System Log Files”, Section 3.3 “Managing Log Files with <code class="command">logrotate</code>”</span>.
 </p></div><div class="sect2 " id="sec.suse.locate"><div class="titlepage"><div><div><h3 class="title" id="sec.suse.locate"><span class="number">15.1.5 </span><span class="name">The <code class="command">locate</code> Command</span> <a title="Permalink" class="permalink" href="#sec.suse.locate">#</a></h3></div></div></div><p>
   <code class="command">locate</code>, a command for quickly finding files, is not
   included in the standard scope of installed software. If desired, install
   the package <code class="systemitem">mlocate</code>, the successor of the package
   <code class="systemitem">findutils-locate</code>. The
   <code class="systemitem">updatedb</code> process is started
   automatically every night or about 15 minutes after booting the system.
  </p></div><div class="sect2 " id="sec.suse.ulimit"><div class="titlepage"><div><div><h3 class="title" id="sec.suse.ulimit"><span class="number">15.1.6 </span><span class="name">The <code class="command">ulimit</code> Command</span> <a title="Permalink" class="permalink" href="#sec.suse.ulimit">#</a></h3></div></div></div><p>
   With the <code class="command">ulimit</code> (<span class="emphasis"><em>user limits</em></span>)
   command, it is possible to set limits for the use of system resources and to
   have these displayed. <code class="command">ulimit</code> is especially useful for
   limiting available memory for applications. With this, an application can be
   prevented from co-opting too much of the system resources and slowing or
   even hanging up the operating system.
  </p><p>
   <code class="command">ulimit</code> can be used with various options. To limit memory
   usage, use the options listed in <a class="xref" href="#tab.suse.packages.ulimit" title="ulimit: Setting Resources for the User">Table 15.1, “<code class="command">ulimit</code>: Setting Resources for the User”</a>.
  </p><div class="table" id="tab.suse.packages.ulimit"><div class="table-title-wrap"><h6 class="table-title"><span class="number">Table 15.1: </span><span class="name"><code class="command">ulimit</code>: Setting Resources for the User </span><a title="Permalink" class="permalink" href="#tab.suse.packages.ulimit">#</a></h6></div><div class="table-contents"><table summary="ulimit: Setting Resources for the User" border="1"><colgroup><col /><col /></colgroup><tbody><tr><td>
       <p>
        <code class="option">-m</code>
       </p>
      </td><td>
       <p>
        The maximum resident set size
       </p>
      </td></tr><tr><td>
       <p>
        <code class="option">-v</code>
       </p>
      </td><td>
       <p>
        The maximum amount of virtual memory available to the shell
       </p>
      </td></tr><tr><td>
       <p>
        <code class="option">-s</code>
       </p>
      </td><td>
       <p>
        The maximum size of the stack
       </p>
      </td></tr><tr><td>
       <p>
        <code class="option">-c</code>
       </p>
      </td><td>
       <p>
        The maximum size of core files created
       </p>
      </td></tr><tr><td>
       <p>
        <code class="option">-a</code>
       </p>
      </td><td>
       <p>
        All current limits are reported
       </p>
      </td></tr></tbody></table></div></div><p>
   Systemwide default entries are set in <code class="filename">/etc/profile</code>.
   Editing this file directly is not recommended, because changes will be
   overwritten during system upgrades. To customize systemwide profile
   settings, use <code class="filename">/etc/profile.local</code>. Per-user settings
   should be made in
   <code class="filename">~<em class="replaceable ">USER</em>/.bashrc</code>.
  </p><div class="example" id="ex.u.ulimit.bashrc"><div class="example-title-wrap"><h6 class="example-title"><span class="number">Example 15.3: </span><span class="name"><code class="command">ulimit</code>: Settings in <code class="filename">~/.bashrc</code> </span><a title="Permalink" class="permalink" href="#ex.u.ulimit.bashrc">#</a></h6></div><div class="example-contents"><div class="verbatim-wrap"><pre class="screen"># Limits maximum resident set size (physical memory):
ulimit -m 98304

# Limits of virtual memory:
ulimit -v 98304</pre></div></div></div><p>
   Memory allocations must be specified in KB. For more detailed information,
   see <code class="command">man bash</code>.
  </p><div id="idm140019137946608" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.png" /><h6>Important: <code class="command">ulimit</code> Support</h6><p>
    Not all shells support <code class="command">ulimit</code> directives. PAM (for
    example, <code class="literal">pam_limits</code>) offers comprehensive adjustment
    possibilities as an alternative to <code class="command">ulimit</code>.
   </p></div></div><div class="sect2 " id="sec.suse.free"><div class="titlepage"><div><div><h3 class="title" id="sec.suse.free"><span class="number">15.1.7 </span><span class="name">The <code class="command">free</code> Command</span> <a title="Permalink" class="permalink" href="#sec.suse.free">#</a></h3></div></div></div><p>
   The <code class="command">free</code> command displays the total amount of free and
   used physical memory as well as swap space in the system and the buffers and
   cache consumed by the kernel. The concept of <span class="emphasis"><em>available
   RAM</em></span> dates back to before the days of unified memory management.
   The slogan <span class="emphasis"><em>free memory is bad memory</em></span> applies well to
   Linux. As a result, Linux has always made the effort to balance out caches
   without actually allowing free or unused memory.
  </p><p>
   The kernel does not have direct knowledge of any applications or user data.
   Instead, it manages applications and user data in a <span class="emphasis"><em>page
   cache</em></span>. If memory runs short, parts of it are written to the swap
   partition or to files, from which they can initially be read using the
   <code class="command">mmap</code> command (see <code class="command">man mmap</code>).
  </p><p>
   The kernel also contains other caches, such as the <span class="emphasis"><em>slab
   cache</em></span>, where the caches used for network access are stored. This
   may explain the differences between the counters in
   <code class="filename">/proc/meminfo</code>. Most, but not all, of them can be
   accessed via <code class="filename">/proc/slabinfo</code>.
  </p><p>
   However, if your goal is to find out how much RAM is currently being used,
   find this information in <code class="filename">/proc/meminfo</code>.
  </p></div><div class="sect2 " id="sec.suse.manpages"><div class="titlepage"><div><div><h3 class="title" id="sec.suse.manpages"><span class="number">15.1.8 </span><span class="name">Man Pages and Info Pages</span> <a title="Permalink" class="permalink" href="#sec.suse.manpages">#</a></h3></div></div></div><p>
   For some GNU applications (such as tar), the man pages are no longer
   maintained. For these commands, use the <code class="option">--help</code> option to
   get a quick overview of the info pages, which provide more in-depth
   instructions. Info

   is GNU's hypertext system. Read an introduction to this system by entering
   <code class="command">info</code> <code class="option">info</code>. Info pages can be viewed with
   Emacs by entering <code class="command">emacs</code> <code class="option">-f info</code> or
   directly in a console with <code class="command">info</code>. You can also use tkinfo,
   xinfo or the help system to view info pages.
  </p></div><div class="sect2 " id="sec.suse.packages.man"><div class="titlepage"><div><div><h3 class="title" id="sec.suse.packages.man"><span class="number">15.1.9 </span><span class="name">Selecting Man Pages Using the <code class="command">man</code> Command</span> <a title="Permalink" class="permalink" href="#sec.suse.packages.man">#</a></h3></div></div></div><p>
   To read a man page enter <code class="command">man</code>
   <em class="replaceable ">MAN_PAGE</em>. If a man page with the same name exists
   in different sections, they will all be listed with the corresponding
   section numbers. Select the one to display. If you do not enter a section
   number within a few seconds, the first man page will be displayed.
  </p><p>
   To change this to the default system behavior, set
   <code class="literal">MAN_POSIXLY_CORRECT=1</code> in a shell initialization file such
   as <code class="filename">~/.bashrc</code>.
  </p></div><div class="sect2 " id="sec.suse.emacs"><div class="titlepage"><div><div><h3 class="title" id="sec.suse.emacs"><span class="number">15.1.10 </span><span class="name">Settings for GNU Emacs</span> <a title="Permalink" class="permalink" href="#sec.suse.emacs">#</a></h3><div class="doc-status"><ul><li><span class="ds-label">Filename: </span>suse_emacs.xml</li><li><span class="ds-label">ID: </span>sec.suse.emacs</li></ul></div></div></div></div><p>
  GNU Emacs is a complex work environment. The following sections cover the
  configuration files processed when GNU Emacs is started. More information is
  available at <a class="link" href="http://www.gnu.org/software/emacs/" target="_blank">http://www.gnu.org/software/emacs/</a>.
 </p><p>
  On start-up, Emacs reads several files containing the settings of the user,
  system administrator and distributor for customization or preconfiguration.
  The initialization file <code class="filename">~/.emacs</code> is installed to the
  home directories of the individual users from <code class="filename">/etc/skel</code>.
  <code class="filename">.emacs</code>, in turn, reads the file
  <code class="filename">/etc/skel/.gnu-emacs</code>. To customize the program, copy
  <code class="filename">.gnu-emacs</code> to the home directory (with <code class="command">cp
  /etc/skel/.gnu-emacs ~/.gnu-emacs</code>) and make the desired settings
  there.
 </p><p>
  <code class="filename">.gnu-emacs</code> defines the file
  <code class="filename">~/.gnu-emacs-custom</code> as <code class="literal">custom-file</code>.
  If users make settings with the <code class="literal">customize</code> options in
  Emacs, the settings are saved to <code class="filename">~/.gnu-emacs-custom</code>.
 </p><p>
  With <span class="productname"><span class="phrase">openSUSE Leap</span></span>, the <code class="systemitem">emacs</code>
  package installs the file <code class="filename">site-start.el</code> in the directory
  <code class="filename">/usr/share/emacs/site-lisp</code>. The file
  <code class="filename">site-start.el</code> is loaded before the initialization file
  <code class="filename">~/.emacs</code>. Among other things,
  <code class="filename">site-start.el</code> ensures that special configuration files
  distributed with Emacs add-on packages, such as
  <code class="systemitem">psgml</code>, are loaded automatically.
  Configuration files of this type are located in
  <code class="filename">/usr/share/emacs/site-lisp</code>, too, and always begin with
  <code class="filename">suse-start-</code>. The local system administrator can specify
  systemwide settings in <code class="filename">default.el</code>.
 </p><p>
  More information about these files is available in the Emacs info file under
  <span class="emphasis"><em>Init File</em></span>: <code class="literal">info:/emacs/InitFile</code>.
  Information about how to disable the loading of these files (if necessary) is
  also provided at this location.
 </p><p>
  The components of Emacs are divided into several packages:
 </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
    The base package <code class="systemitem">emacs</code>.
   </p></li><li class="listitem "><p>
    <code class="systemitem">emacs-x11</code> (usually installed):
    the program <span class="emphasis"><em>with</em></span> X11 support.
   </p></li><li class="listitem "><p>
    <code class="systemitem">emacs-nox</code>: the program
    <span class="emphasis"><em>without</em></span> X11 support.
   </p></li><li class="listitem "><p>
    <code class="systemitem">emacs-info</code>: online documentation
    in info format.
   </p></li><li class="listitem "><p>
    <code class="systemitem">emacs-el</code>: the uncompiled library
    files in Emacs Lisp. These are not required at runtime.
   </p></li><li class="listitem "><p>
    Numerous add-on packages can be installed if needed:
    <code class="systemitem">emacs-auctex</code> (LaTeX),
    <code class="systemitem">psgml</code> (SGML and XML),
    <code class="systemitem">gnuserv</code> (client and server
    operation) and others.
   </p></li></ul></div></div></div><div class="sect1 " id="sec.suse.virt.konsolen"><div class="titlepage"><div><div><h2 class="title" id="sec.suse.virt.konsolen"><span class="number">15.2 </span><span class="name">Virtual Consoles</span> <a title="Permalink" class="permalink" href="#sec.suse.virt.konsolen">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">Filename: </span>suse_vc.xml</li><li><span class="ds-label">ID: </span>sec.suse.virt.konsolen</li></ul></div></div></div></div><p>
  Linux is a multiuser and multitasking system. The advantages of these
  features can be appreciated even on a stand-alone PC system. In text mode,
  there are six virtual consoles available. Switch between them using
  <span class="keycap">Alt</span><span class="key-connector">–</span><span class="keycap">F1</span> through
  <span class="keycap">Alt</span><span class="key-connector">–</span><span class="keycap">F6</span>. The
  seventh console is reserved for X and the tenth console shows kernel
  messages.

 </p><p>
  To switch to a console from X without shutting it down, use <span class="keycap">Ctrl</span><span class="key-connector">–</span><span class="keycap">Alt</span><span class="key-connector">–</span><span class="keycap">F1</span> to <span class="keycap">Ctrl</span><span class="key-connector">–</span><span class="keycap">Alt</span><span class="key-connector">–</span><span class="keycap">F6</span>. To return to X,
  press <span class="keycap">Alt</span><span class="key-connector">–</span><span class="keycap">F7</span>.
 </p></div><div class="sect1 " id="sec.suse.kb"><div class="titlepage"><div><div><h2 class="title" id="sec.suse.kb"><span class="number">15.3 </span><span class="name">Keyboard Mapping</span> <a title="Permalink" class="permalink" href="#sec.suse.kb">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">Filename: </span>suse_kb.xml</li><li><span class="ds-label">ID: </span>sec.suse.kb</li></ul></div></div></div></div><p>
  To standardize the keyboard mapping of programs, changes were made to the
  following files:
 </p><div class="verbatim-wrap"><pre class="screen">/etc/inputrc
/etc/X11/Xmodmap
/etc/skel/.emacs
/etc/skel/.gnu-emacs
/etc/skel/.vimrc
/etc/csh.cshrc
/etc/termcap
/usr/share/terminfo/x/xterm
/usr/share/X11/app-defaults/XTerm
/usr/share/emacs/<em class="replaceable ">VERSION</em>/site-lisp/term/*.el</pre></div><p>
  These changes only affect applications that use <code class="command">terminfo</code>
  entries or whose configuration files are changed directly
  (<code class="command">vi</code>, <code class="command">emacs</code>, etc.). Applications not
  shipped with the system should be adapted to these defaults.
 </p><p>
  Under X, the compose key (multikey) can be enabled as explained in
  <code class="filename">/etc/X11/Xmodmap</code>.
 </p><p>
  Further settings are possible using the X Keyboard Extension (XKB). This
  extension is also used by the desktop environment GNOME (gswitchit).
 </p><div id="idm140019137867632" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.png" /><h6>Tip: For More Information</h6><p>
   Information about XKB is available in the documents listed in
   <code class="filename">/usr/share/doc/packages/xkeyboard-config</code> (part of the
   <code class="systemitem">xkeyboard-config</code> package).
  </p></div></div><div class="sect1 " id="sec.suse.l10n"><div class="titlepage"><div><div><h2 class="title" id="sec.suse.l10n"><span class="number">15.4 </span><span class="name">Language and Country-Specific Settings</span> <a title="Permalink" class="permalink" href="#sec.suse.l10n">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">Filename: </span>suse_l10n.xml</li><li><span class="ds-label">ID: </span>sec.suse.l10n</li></ul></div></div></div></div><p>
  The system is, to a very large extent, internationalized and can be modified
  for local needs. Internationalization (<span class="emphasis"><em>I18N</em></span>) allows
  specific localization (<span class="emphasis"><em>L10N</em></span>). The abbreviations I18N and
  L10N are derived from the first and last letters of the words and, in
  between, the number of letters omitted.
 </p><p>
  Settings are made with <code class="systemitem">LC_</code> variables defined in the
  file <code class="filename">/etc/sysconfig/language</code>. This refers not only to
  <span class="emphasis"><em>native language support</em></span>, but also to the categories
  <span class="emphasis"><em>Messages</em></span> (Language), <span class="emphasis"><em>Character Set</em></span>,
  <span class="emphasis"><em>Sort Order</em></span>, <span class="emphasis"><em>Time and Date</em></span>,
  <span class="emphasis"><em>Numbers</em></span> and <span class="emphasis"><em>Money</em></span>. Each of these
  categories can be defined directly with its own variable or indirectly with a
  master variable in the file <code class="filename">language</code> (see the
  <code class="command">locale</code> man page).
 </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019137853552"><span class="term "><code class="systemitem">RC_LC_MESSAGES</code>,
    <code class="systemitem">RC_LC_CTYPE</code>,
    <code class="systemitem">RC_LC_COLLATE</code>,
    <code class="systemitem">RC_LC_TIME</code>,
    <code class="systemitem">RC_LC_NUMERIC</code>,
    <code class="systemitem">RC_LC_MONETARY</code>
   </span></dt><dd><p>
     These variables are passed to the shell without the
     <code class="systemitem">RC_</code> prefix and represent the listed categories.
     The shell profiles concerned are listed below. The current setting can be
     shown with the command <code class="command">locale</code>.
    </p></dd><dt id="idm140019137848144"><span class="term "><code class="systemitem">RC_LC_ALL</code>
   </span></dt><dd><p>
     This variable, if set, overwrites the values of the variables already
     mentioned.
    </p></dd><dt id="idm140019137845984"><span class="term "><code class="systemitem">RC_LANG</code>
   </span></dt><dd><p>
     If none of the previous variables are set, this is the fallback. By
     default, only <code class="systemitem">RC_LANG</code> is set. This makes it
     easier for users to enter their own values.
    </p></dd><dt id="idm140019137843312"><span class="term "><code class="systemitem">ROOT_USES_LANG</code>
   </span></dt><dd><p>
     A <code class="literal">yes</code> or <code class="literal">no</code> variable. If set to
     <code class="literal">no</code>, <code class="systemitem">root</code>
     always works in the POSIX environment.
    </p></dd></dl></div><p>
  The variables can be set with the YaST sysconfig editor. The value of such
  a variable contains the language code, country code, encoding and modifier.
  The individual components are connected by special characters:
 </p><div class="verbatim-wrap"><pre class="screen">  LANG=&lt;language&gt;[[_&lt;COUNTRY&gt;].&lt;Encoding&gt;[@&lt;Modifier&gt;]]</pre></div><div class="sect2 " id="sec.suse.l10n.examples"><div class="titlepage"><div><div><h3 class="title" id="sec.suse.l10n.examples"><span class="number">15.4.1 </span><span class="name">Some Examples</span> <a title="Permalink" class="permalink" href="#sec.suse.l10n.examples">#</a></h3></div></div></div><p>
   You should always set the language and country codes together. Language
   settings follow the standard ISO 639 available at
   <a class="link" href="http://www.evertype.com/standards/iso639/iso639-en.html" target="_blank">http://www.evertype.com/standards/iso639/iso639-en.html</a>
   and <a class="link" href="http://www.loc.gov/standards/iso639-2/" target="_blank">http://www.loc.gov/standards/iso639-2/</a>. Country
   codes are listed in ISO 3166, see
   <a class="link" href="http://en.wikipedia.org/wiki/ISO_3166" target="_blank">http://en.wikipedia.org/wiki/ISO_3166</a>.


  </p><p>
   It only makes sense to set values for which usable description files can be
   found in <code class="filename">/usr/lib/locale</code>. Additional description files
   can be created from the files in <code class="filename">/usr/share/i18n</code> using
   the command <code class="command">localedef</code>. The description files are part of
   the <code class="systemitem">glibc-i18ndata</code> package. A description file for
   <code class="literal">en_US.UTF-8</code> (for English and United States) can be
   created with:
  </p><div class="verbatim-wrap"><pre class="screen">localedef -i en_US -f UTF-8 en_US.UTF-8</pre></div><div class="variablelist "><dl class="variablelist"><dt id="idm140019137829792"><span class="term ">
<code class="systemitem">LANG=en_US.UTF-8</code>
    </span></dt><dd><p>
      This is the default setting if American English is selected during
      installation. If you selected another language, that language is enabled
      but still with UTF-8 as the character encoding.
     </p></dd><dt id="idm140019137827360"><span class="term ">
<code class="systemitem">LANG=en_US.ISO-8859-1</code>
    </span></dt><dd><p>
      This sets the language to English, country to United States and the
      character set to <code class="literal">ISO-8859-1</code>. This character set does
      not support the Euro sign, but it can be useful sometimes for programs
      that have not been updated to support <code class="literal">UTF-8</code>. The
      string defining the charset (<code class="literal">ISO-8859-1</code> in this case)
      is then evaluated by programs like Emacs.
     </p></dd><dt id="idm140019137823488"><span class="term "><code class="systemitem">LANG=en_IE@euro</code>
    </span></dt><dd><p>
      The above example explicitly includes the Euro sign in a language
      setting. This setting is obsolete now, as UTF-8 also covers the Euro
      symbol. It is only useful if an application supports ISO-8859-15 and not
      UTF-8.
     </p></dd></dl></div><p>
   Changes to <code class="filename">/etc/sysconfig/language</code> are activated by the
   following process chain:
  </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
     For the Bash: <code class="filename">/etc/profile</code> reads
     <code class="filename">/etc/profile.d/lang.sh</code> which, in turn, analyzes
     <code class="filename">/etc/sysconfig/language</code>.
    </p></li><li class="listitem "><p>
     For tcsh: At login, <code class="filename">/etc/csh.login</code> reads
     <code class="filename">/etc/profile.d/lang.csh</code> which, in turn, analyzes
     <code class="filename">/etc/sysconfig/language</code>.
    </p></li></ul></div><p>
   This ensures that any changes to
   <code class="filename">/etc/sysconfig/language</code> are available at the next login
   to the respective shell, without having to manually activate
   them.
  </p><p>
   Users can override the system defaults by editing their
   <code class="filename">~/.bashrc</code> accordingly. For example, if you do not want
   to use the system-wide <code class="literal">en_US</code> for program messages,
   include <code class="systemitem">LC_MESSAGES=es_ES</code> so that messages are
   displayed in Spanish instead.
  </p></div><div class="sect2 " id="sec.suse.l10n.dot.i18n"><div class="titlepage"><div><div><h3 class="title" id="sec.suse.l10n.dot.i18n"><span class="number">15.4.2 </span><span class="name">Locale Settings in <code class="filename">~/.i18n</code></span> <a title="Permalink" class="permalink" href="#sec.suse.l10n.dot.i18n">#</a></h3></div></div></div><p>
   If you are not satisfied with locale system defaults, change the settings in
   <code class="filename">~/.i18n</code> according to the Bash scripting syntax. Entries
   in <code class="filename">~/.i18n</code> override system defaults from
   <code class="filename">/etc/sysconfig/language</code>. Use the same variable names
   but without the <code class="literal">RC_</code> name space prefixes. For example, use
   <code class="literal">LANG</code> instead of <code class="literal">RC_LANG</code>:
  </p><div class="verbatim-wrap"><pre class="screen">LANG=cs_CZ.UTF-8
LC_COLLATE=C</pre></div></div><div class="sect2 " id="sec.suse.l10n.fallback"><div class="titlepage"><div><div><h3 class="title" id="sec.suse.l10n.fallback"><span class="number">15.4.3 </span><span class="name">Settings for Language Support</span> <a title="Permalink" class="permalink" href="#sec.suse.l10n.fallback">#</a></h3></div></div></div><p>
   Files in the category <span class="emphasis"><em>Messages</em></span> are, as a rule, only
   stored in the corresponding language directory (like
   <code class="filename">en</code>) to have a fallback. If you set
   <code class="systemitem">LANG</code> to <code class="literal">en_US</code> and the message
   file in <code class="filename">/usr/share/locale/en_US/LC_MESSAGES</code> does not
   exist, it falls back to
   <code class="filename">/usr/share/locale/en/LC_MESSAGES</code>.
  </p><p>
   A fallback chain can also be defined, for example, for Breton to French or
   for Galician to Spanish to Portuguese:
  </p><p>
   <code class="systemitem">LANGUAGE="br_FR:fr_FR"</code>
  </p><p>
   <code class="systemitem">LANGUAGE="gl_ES:es_ES:pt_PT"</code>
  </p><p>
   If desired, use the Norwegian variants Nynorsk and Bokmål instead (with
   additional fallback to <code class="literal">no</code>):
  </p><p>
   <code class="systemitem">LANG="nn_NO"</code>
  </p><p>
   <code class="systemitem">LANGUAGE="nn_NO:nb_NO:no"</code>
  </p><p>
   or
  </p><p>
   <code class="systemitem">LANG="nb_NO"</code>
  </p><p>
   <code class="systemitem">LANGUAGE="nb_NO:nn_NO:no"</code>
  </p><p>
   Note that in Norwegian, <code class="systemitem">LC_TIME</code> is also treated
   differently.
  </p><p>
   One problem that can arise is a separator used to delimit groups of digits
   not being recognized properly. This occurs if <code class="systemitem">LANG</code>
   is set to only a two-letter language code like <code class="literal">de</code>, but
   the definition file glibc uses is located in
   <code class="filename">/usr/share/lib/de_DE/LC_NUMERIC</code>. Thus
   <code class="systemitem">LC_NUMERIC</code> must be set to <code class="literal">de_DE</code>
   to make the separator definition visible to the system.
  </p></div><div class="sect2 " id="sec.suse.l10n.info"><div class="titlepage"><div><div><h3 class="title" id="sec.suse.l10n.info"><span class="number">15.4.4 </span><span class="name">For More Information</span> <a title="Permalink" class="permalink" href="#sec.suse.l10n.info">#</a></h3></div></div></div><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
     <span class="emphasis"><em>The GNU C Library Reference Manual</em></span>, Chapter
     <span class="quote">“<span class="quote">Locales and Internationalization</span>”</span>. It is included in
     <code class="systemitem">glibc-info</code>.
    </p></li><li class="listitem "><p>
     Markus Kuhn, <span class="emphasis"><em>UTF-8 and Unicode FAQ for Unix/Linux</em></span>,
     currently at
     <a class="link" href="http://www.cl.cam.ac.uk/~mgk25/unicode.html" target="_blank">http://www.cl.cam.ac.uk/~mgk25/unicode.html</a>.
    </p></li><li class="listitem "><p>
     <span class="emphasis"><em>Unicode-HOWTO</em></span> by Bruno Haible, available at

     <a class="link" href="http://tldp.org/HOWTO/Unicode-HOWTO-1.html" target="_blank">http://tldp.org/HOWTO/Unicode-HOWTO-1.html</a>.
    </p></li></ul></div></div></div></div><div class="chapter " id="cha.udev"><div class="titlepage"><div><div><h2 class="title"><span class="number">16 </span><span class="name">Dynamic Kernel Device Management with <code class="systemitem">udev</code></span> <a title="Permalink" class="permalink" href="#cha.udev">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">Filename: </span>udev.xml</li><li><span class="ds-label">ID: </span>cha.udev</li></ul></div></div></div></div><div class="line"><div class="toc"><dl><dt><span class="sect1"><a href="#sec.udev.devdir"><span class="number">16.1 </span><span class="name">The <code class="filename">/dev</code> Directory</span></a></span></dt><dt><span class="sect1"><a href="#sec.udev.kernel"><span class="number">16.2 </span><span class="name">Kernel <code class="systemitem">uevents</code> and <code class="systemitem">udev</code></span></a></span></dt><dt><span class="sect1"><a href="#sec.udev.drivers"><span class="number">16.3 </span><span class="name">Drivers, Kernel Modules and Devices</span></a></span></dt><dt><span class="sect1"><a href="#sec.udev.boot"><span class="number">16.4 </span><span class="name">Booting and Initial Device Setup</span></a></span></dt><dt><span class="sect1"><a href="#sec.udev.debug"><span class="number">16.5 </span><span class="name">Monitoring the Running <code class="systemitem">udev</code> Daemon</span></a></span></dt><dt><span class="sect1"><a href="#sec.udev.rules"><span class="number">16.6 </span><span class="name">Influencing Kernel Device Event Handling with <code class="systemitem">udev</code> Rules</span></a></span></dt><dt><span class="sect1"><a href="#sec.udev.persdev"><span class="number">16.7 </span><span class="name">Persistent Device Naming</span></a></span></dt><dt><span class="sect1"><a href="#sec.udev.files"><span class="number">16.8 </span><span class="name">Files used by <code class="systemitem">udev</code></span></a></span></dt><dt><span class="sect1"><a href="#sec.udev.moreinfo"><span class="number">16.9 </span><span class="name">For More Information</span></a></span></dt></dl></div></div><p>
  The kernel can add or remove almost any device in a running system. Changes
  in the device state (whether a device is plugged in or removed) need to be
  propagated to user space. Devices need to be configured when they are
  plugged in and recognized. Users of a certain device need to be informed
  about any changes in this device's recognized state.
  <code class="systemitem">udev</code> provides the needed
  infrastructure to dynamically maintain the device node files and symbolic
  links in the <code class="filename">/dev</code> directory.
  <code class="systemitem">udev</code> rules provide a way to plug
  external tools into the kernel device event processing. This allows you to
  customize <code class="systemitem">udev</code> device handling by adding certain scripts to execute as part of kernel device
  handling, or request and import additional data to evaluate during device
  handling.
 </p><div class="sect1 " id="sec.udev.devdir"><div class="titlepage"><div><div><h2 class="title" id="sec.udev.devdir"><span class="number">16.1 </span><span class="name">The <code class="filename">/dev</code> Directory</span> <a title="Permalink" class="permalink" href="#sec.udev.devdir">#</a></h2></div></div></div><p>
   The device nodes in the <code class="filename">/dev</code> directory provide access
   to the corresponding kernel devices. With
   <code class="systemitem">udev</code>, the <code class="filename">/dev</code>
   directory reflects the current state of the kernel. Every kernel device has
   one corresponding device file. If a device is disconnected from the system,
   the device node is removed.
  </p><p>
   The content of the <code class="filename">/dev</code> directory is kept on a
   temporary file system and all files are rendered at every system start-up.
   Manually created or modified files do not, by design, survive a reboot.
   Static files and directories that should always be in the
   <code class="filename">/dev</code> directory regardless of the state of the
   corresponding kernel device can be created with systemd-tmpfiles. The
   configuration files are found in <code class="filename">/usr/lib/tmpfiles.d/</code>
   and <code class="filename">/etc/tmpfiles.d/</code>; for more information, see the
   <code class="systemitem">systemd-tmpfiles(8)</code> man page.
  </p></div><div class="sect1 " id="sec.udev.kernel"><div class="titlepage"><div><div><h2 class="title" id="sec.udev.kernel"><span class="number">16.2 </span><span class="name">Kernel <code class="systemitem">uevents</code> and <code class="systemitem">udev</code></span> <a title="Permalink" class="permalink" href="#sec.udev.kernel">#</a></h2></div></div></div><p>
   The required device information is exported by the
   <code class="systemitem">sysfs</code> file system. For every
   device the kernel has detected and initialized, a directory with the device
   name is created. It contains attribute files with device-specific
   properties.
  </p><p>
   Every time a device is added or removed, the kernel sends a uevent to notify
   <code class="systemitem">udev</code> of the change. The
   <code class="systemitem">udev</code> daemon reads and parses all
   provided rules from the <code class="filename">/etc/udev/rules.d/*.rules</code> files
   once at start-up and keeps them in memory. If rules files are changed, added
   or removed, the daemon can reload the in-memory representation of all rules
   with the command <code class="command">udevadm control --reload</code>. For more
   details on <code class="systemitem">udev</code> rules and their
   syntax, refer to <a class="xref" href="#sec.udev.rules" title="16.6. Influencing Kernel Device Event Handling with udev Rules">Section 16.6, “Influencing Kernel Device Event Handling with <code class="systemitem">udev</code> Rules”</a>.
  </p><p>
   Every received event is matched against the set of provides rules. The rules
   can add or change event environment keys, request a specific name for the
   device node to create, add symbolic links pointing to the node or add
   programs to run after the device node is created. The driver core
   <code class="systemitem">uevents</code> are received from a kernel
   netlink socket.
  </p></div><div class="sect1 " id="sec.udev.drivers"><div class="titlepage"><div><div><h2 class="title" id="sec.udev.drivers"><span class="number">16.3 </span><span class="name">Drivers, Kernel Modules and Devices</span> <a title="Permalink" class="permalink" href="#sec.udev.drivers">#</a></h2></div></div></div><p>
   The kernel bus drivers probe for devices. For every detected device, the
   kernel creates an internal device structure while the driver core sends a
   uevent to the <code class="systemitem">udev</code> daemon. Bus
   devices identify themselves by a specially-formatted ID, which tells what
   kind of device it is. Usually these IDs consist of vendor and product ID and
   other subsystem-specific values. Every bus has its own scheme for these IDs,
   called <code class="envar">MODALIAS</code>. The kernel takes the device information,
   composes a <code class="envar">MODALIAS</code> ID string from it and sends that string
   along with the event. For a USB mouse, it looks like this:
  </p><div class="verbatim-wrap"><pre class="screen">MODALIAS=usb:v046DpC03Ed2000dc00dsc00dp00ic03isc01ip02</pre></div><p>
   Every device driver carries a list of known aliases for devices it can
   handle. The list is contained in the kernel module file itself. The program
   depmod reads the ID lists and creates the file
   <code class="filename">modules.alias</code> in the kernel's
   <code class="filename">/lib/modules</code> directory for all currently available
   modules. With this infrastructure, module loading is as easy as calling
   <code class="command">modprobe</code> for every event that carries a
   <code class="literal">MODALIAS</code> key. If <code class="command">modprobe $MODALIAS</code> is
   called, it matches the device alias composed for the device with the aliases
   provided by the modules. If a matching entry is found, that module is
   loaded. All this is automatically triggered by
   <code class="systemitem">udev</code>.
  </p></div><div class="sect1 " id="sec.udev.boot"><div class="titlepage"><div><div><h2 class="title" id="sec.udev.boot"><span class="number">16.4 </span><span class="name">Booting and Initial Device Setup</span> <a title="Permalink" class="permalink" href="#sec.udev.boot">#</a></h2></div></div></div><p>
   All device events happening during the boot process before the
   <code class="systemitem">udev</code> daemon is running are lost,
   because the infrastructure to handle these events resides on the root file
   system and is not available at that time. To cover that loss, the kernel
   provides a <code class="filename">uevent</code> file located in the device directory
   of every device in the <code class="systemitem">sysfs</code>
   file system. By writing <code class="literal">add</code> to that file, the kernel
   resends the same event as the one lost during boot. A simple loop over all
   <code class="filename">uevent</code> files in <code class="filename">/sys</code> triggers all
   events again to create the device nodes and perform device setup.
  </p><p>
   As an example, a USB mouse present during boot may not be initialized by the
   early boot logic, because the driver is not available at that time. The
   event for the device discovery was lost and failed to find a kernel module
   for the device. Instead of manually searching for connected
   devices, <code class="systemitem">udev</code> requests all device
   events from the kernel after the root file system is available, so the event
   for the USB mouse device runs again. Now it finds the kernel module on the
   mounted root file system and the USB mouse can be initialized.
  </p><p>
   From user space, there is no visible difference between a device coldplug
   sequence and a device discovery during runtime. In both cases, the same
   rules are used to match and the same configured programs are run.
  </p></div><div class="sect1 " id="sec.udev.debug"><div class="titlepage"><div><div><h2 class="title" id="sec.udev.debug"><span class="number">16.5 </span><span class="name">Monitoring the Running <code class="systemitem">udev</code> Daemon</span> <a title="Permalink" class="permalink" href="#sec.udev.debug">#</a></h2></div></div></div><p>
   The program <code class="command">udevadm monitor</code> can be used to visualize the
   driver core events and the timing of the
   <code class="systemitem">udev</code> event processes.
  </p><div class="verbatim-wrap"><pre class="screen">UEVENT[1185238505.276660] add   /devices/pci0000:00/0000:00:1d.2/usb3/3-1 (usb)
UDEV  [1185238505.279198] add   /devices/pci0000:00/0000:00:1d.2/usb3/3-1 (usb)
UEVENT[1185238505.279527] add   /devices/pci0000:00/0000:00:1d.2/usb3/3-1/3-1:1.0 (usb)
UDEV  [1185238505.285573] add   /devices/pci0000:00/0000:00:1d.2/usb3/3-1/3-1:1.0 (usb)
UEVENT[1185238505.298878] add   /devices/pci0000:00/0000:00:1d.2/usb3/3-1/3-1:1.0/input/input10 (input)
UDEV  [1185238505.305026] add   /devices/pci0000:00/0000:00:1d.2/usb3/3-1/3-1:1.0/input/input10 (input)
UEVENT[1185238505.305442] add   /devices/pci0000:00/0000:00:1d.2/usb3/3-1/3-1:1.0/input/input10/mouse2 (input)
UEVENT[1185238505.306440] add   /devices/pci0000:00/0000:00:1d.2/usb3/3-1/3-1:1.0/input/input10/event4 (input)
UDEV  [1185238505.325384] add   /devices/pci0000:00/0000:00:1d.2/usb3/3-1/3-1:1.0/input/input10/event4 (input)
UDEV  [1185238505.342257] add   /devices/pci0000:00/0000:00:1d.2/usb3/3-1/3-1:1.0/input/input10/mouse2 (input)</pre></div><p>
   The <code class="literal">UEVENT</code> lines show the events the kernel has sent over
   netlink. The <code class="literal">UDEV</code> lines show the finished
   <code class="systemitem">udev</code> event handlers. The timing is
   printed in microseconds. The time between <code class="literal">UEVENT</code> and
   <code class="literal">UDEV</code> is the time
   <code class="systemitem">udev</code> took to process this event or
   the <code class="systemitem">udev</code> daemon has delayed its
   execution to synchronize this event with related and already running events.
   For example, events for hard disk partitions always wait for the main disk
   device event to finish, because the partition events may rely on the data
   that the main disk event has queried from the hardware.
  </p><p>
   <code class="command">udevadm monitor --env</code> shows the complete event
   environment:
  </p><div class="verbatim-wrap"><pre class="screen">ACTION=add
DEVPATH=/devices/pci0000:00/0000:00:1d.2/usb3/3-1/3-1:1.0/input/input10
SUBSYSTEM=input
SEQNUM=1181
NAME="Logitech USB-PS/2 Optical Mouse"
PHYS="usb-0000:00:1d.2-1/input0"
UNIQ=""
EV=7
KEY=70000 0 0 0 0
REL=103
MODALIAS=input:b0003v046DpC03Ee0110-e0,1,2,k110,111,112,r0,1,8,amlsfw</pre></div><p>
   <code class="systemitem">udev</code> also sends messages to syslog.
   The default syslog priority that controls which messages are sent to syslog
   is specified in the <code class="systemitem">udev</code>
   configuration file <code class="filename">/etc/udev/udev.conf</code>. The log
   priority of the running daemon can be changed with <code class="command">udevadm control
   --log_priority=</code><em class="replaceable ">LEVEL/NUMBER</em>.
  </p></div><div class="sect1 " id="sec.udev.rules"><div class="titlepage"><div><div><h2 class="title" id="sec.udev.rules"><span class="number">16.6 </span><span class="name">Influencing Kernel Device Event Handling with <code class="systemitem">udev</code> Rules</span> <a title="Permalink" class="permalink" href="#sec.udev.rules">#</a></h2></div></div></div><p>
   A <code class="systemitem">udev</code> rule can match any property
   the kernel adds to the event itself or any information that the kernel
   exports to <code class="filename">sysfs</code>. The rule can also request additional
   information from external programs. Every event is matched against all
   provided rules. All rules are located in the
   <code class="filename">/etc/udev/rules.d</code> directory.
  </p><p>
   Every line in the rules file contains at least one key value pair. There are
   two kinds of keys, match and assignment keys. If all match keys match their
   values, the rule is applied and the assignment keys are assigned the
   specified value. A matching rule may specify the name of the device node,
   add symbolic links pointing to the node or run a specified program as part
   of the event handling. If no matching rule is found, the default device node
   name is used to create the device node. Detailed information about the rule
   syntax and the provided keys to match or import data are described in the
   <code class="systemitem">udev</code> man page. The following
   example rules provide a basic introduction to
   <code class="systemitem">udev</code> rule syntax. The example rules
   are all taken from the <code class="systemitem">udev</code> default
   rule set that is located under
   <code class="filename">/etc/udev/rules.d/50-udev-default.rules</code>.
  </p><div class="example" id="ex.rules"><div class="example-title-wrap"><h6 class="example-title"><span class="number">Example 16.1: </span><span class="name">Example <code class="systemitem">udev</code> Rules </span><a title="Permalink" class="permalink" href="#ex.rules">#</a></h6></div><div class="example-contents"><div class="verbatim-wrap"><pre class="screen"># console
KERNEL=="console", MODE="0600", OPTIONS="last_rule"

# serial devices
KERNEL=="ttyUSB*", ATTRS{product}=="[Pp]alm*Handheld*", SYMLINK+="pilot"

# printer
SUBSYSTEM=="usb", KERNEL=="lp*", NAME="usb/%k", SYMLINK+="usb%k", GROUP="lp"

# kernel firmware loader
SUBSYSTEM=="firmware", ACTION=="add", RUN+="firmware.sh"</pre></div></div></div><p>
   The <code class="systemitem">console</code> rule consists of three keys: one match
   key (<code class="literal">KERNEL</code>) and two assign keys
   (<code class="literal">MODE</code>, <code class="literal">OPTIONS</code>). The
   <code class="literal">KERNEL</code> match rule searches the device list for any items
   of the type <code class="literal">console</code>. Only exact matches are valid and
   trigger this rule to be executed. The <code class="literal">MODE</code> key assigns
   special permissions to the device node, in this case, read and write
   permissions to the owner of this device only. The <code class="literal">OPTIONS</code>
   key makes this rule the last rule to be applied to any device of this type.
   Any later rule matching this particular device type does not have any
   effect.
  </p><p>
   The <code class="systemitem">serial devices</code> rule is not available in
   <code class="filename">50-udev-default.rules</code> anymore, but it is still worth
   considering. It consists of two match keys (<code class="literal">KERNEL</code> and
   <code class="literal">ATTRS</code>) and one assign key (<code class="literal">SYMLINK</code>).
   The <code class="literal">KERNEL</code> key searches for all devices of the
   <code class="literal">ttyUSB</code> type. Using the <code class="literal">*</code> wild card,
   this key matches several of these devices. The second match key,
   <code class="literal">ATTRS</code>, checks whether the <code class="filename">product</code>
   attribute file in <code class="literal">sysfs</code> for any <code class="literal">ttyUSB</code>
   device contains a certain string. The assign key
   (<code class="literal">SYMLINK</code>) triggers the addition of a symbolic link to
   this device under <code class="filename">/dev/pilot</code>. The operator used in this
   key (<code class="literal">+=</code>) tells
   <code class="systemitem">udev</code> to additionally perform this
   action, even if previous or later rules add other symbolic links. As this
   rule contains two match keys, it is only applied if both conditions are met.
  </p><p>
   The <code class="systemitem">printer</code> rule deals with USB printers and
   contains two match keys which must both apply to get the entire rule applied
   (<code class="literal">SUBSYSTEM</code> and <code class="literal">KERNEL</code>). Three assign
   keys deal with the naming for this device type (<code class="literal">NAME</code>),
   the creation of symbolic device links (<code class="literal">SYMLINK</code>) and the
   group membership for this device type (<code class="literal">GROUP</code>). Using the
   <code class="literal">*</code> wild card in the <code class="literal">KERNEL</code> key makes it
   match several <code class="literal">lp</code> printer devices. Substitutions are used
   in both, the <code class="literal">NAME</code> and the <code class="literal">SYMLINK</code> keys
   to extend these strings by the internal device name. For example, the
   symbolic link to the first <code class="literal">lp</code> USB printer would read
   <code class="filename">/dev/usblp0</code>.
  </p><p>
   The <code class="systemitem">kernel firmware loader</code> rule makes
   <code class="systemitem">udev</code> load additional firmware by an
   external helper script during runtime. The <code class="literal">SUBSYSTEM</code>
   match key searches for the <code class="literal">firmware</code> subsystem. The
   <code class="literal">ACTION</code> key checks whether any device belonging to the
   <code class="literal">firmware</code> subsystem has been added. The
   <code class="literal">RUN+=</code> key triggers the execution of the
   <code class="literal">firmware.sh</code> script to locate the firmware that is to be
   loaded.
  </p><p>
   Some general characteristics are common to all rules:
  </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
     Each rule consists of one or more key value pairs separated by a comma.
    </p></li><li class="listitem "><p>
     A key's operation is determined by the operator.
     <code class="systemitem">udev</code> rules support several
     operators.
    </p></li><li class="listitem "><p>
     Each given value must be enclosed by quotation marks.
    </p></li><li class="listitem "><p>
     Each line of the rules file represents one rule. If a rule is longer than
     one line, use <code class="literal">\</code> to join the different lines as you
     would do in shell syntax.
    </p></li><li class="listitem "><p>
     <code class="systemitem">udev</code> rules support a shell-style
     pattern that matches the <code class="literal">*</code>, <code class="literal">?</code>, and
     <code class="literal">[]</code> patterns.
    </p></li><li class="listitem "><p>
     <code class="systemitem">udev</code> rules support substitutions.
    </p></li></ul></div><div class="sect2 " id="sec.udev.rules.ops"><div class="titlepage"><div><div><h3 class="title" id="sec.udev.rules.ops"><span class="number">16.6.1 </span><span class="name">Using Operators in <code class="systemitem">udev</code> Rules</span> <a title="Permalink" class="permalink" href="#sec.udev.rules.ops">#</a></h3></div></div></div><p>
    Creating keys you can choose from several operators, depending on the type
    of key you want to create. Match keys will normally be used to find a value
    that either matches or explicitly mismatches the search value. Match keys
    contain either of the following operators:
   </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019137675104"><span class="term "><code class="literal">==</code>
     </span></dt><dd><p>
       Compare for equality. If the key contains a search pattern, all results
       matching this pattern are valid.
      </p></dd><dt id="idm140019137672912"><span class="term "><code class="literal">!=</code>
     </span></dt><dd><p>
       Compare for non-equality. If the key contains a search pattern, all
       results matching this pattern are valid.
      </p></dd></dl></div><p>
    Any of the following operators can be used with assign keys:
   </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019137669776"><span class="term "><code class="literal">=</code>
     </span></dt><dd><p>
       Assign a value to a key. If the key previously consisted of a list of
       values, the key resets and only the single value is assigned.
      </p></dd><dt id="idm140019137667552"><span class="term "><code class="literal">+=</code>
     </span></dt><dd><p>
       Add a value to a key that contains a list of entries.
      </p></dd><dt id="idm140019137665424"><span class="term "><code class="literal">:=</code>
     </span></dt><dd><p>
       Assign a final value. Disallow any later change by later rules.
      </p></dd></dl></div></div><div class="sect2 " id="sec.udev.rules.subst"><div class="titlepage"><div><div><h3 class="title" id="sec.udev.rules.subst"><span class="number">16.6.2 </span><span class="name">Using Substitutions in <code class="systemitem">udev</code> Rules</span> <a title="Permalink" class="permalink" href="#sec.udev.rules.subst">#</a></h3></div></div></div><p>
    <code class="systemitem">udev</code> rules support the use of
    placeholders and substitutions. Use them in a similar fashion as you would
    do in any other scripts. The following substitutions can be used with
    <code class="systemitem">udev</code> rules:
   </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019137658736"><span class="term "><code class="literal">%r</code>, <code class="literal">$root</code>
     </span></dt><dd><p>
       The device directory, <code class="filename">/dev</code> by default.
      </p></dd><dt id="idm140019137655744"><span class="term "><code class="literal">%p</code>, <code class="literal">$devpath</code>
     </span></dt><dd><p>
       The value of <code class="envar">DEVPATH</code>.
      </p></dd><dt id="idm140019137652768"><span class="term "><code class="literal">%k</code>, <code class="literal">$kernel</code>
     </span></dt><dd><p>
       The value of <code class="envar">KERNEL</code> or the internal device name.
      </p></dd><dt id="idm140019137649776"><span class="term "><code class="literal">%n</code>, <code class="literal">$number</code>
     </span></dt><dd><p>
       The device number.
      </p></dd><dt id="idm140019137647232"><span class="term "><code class="literal">%N</code>, <code class="literal">$tempnode</code>
     </span></dt><dd><p>
       The temporary name of the device file.
      </p></dd><dt id="idm140019137644672"><span class="term "><code class="literal">%M</code>, <code class="literal">$major</code>
     </span></dt><dd><p>
       The major number of the device.
      </p></dd><dt id="idm140019137642112"><span class="term "><code class="literal">%m</code>, <code class="literal">$minor</code>
     </span></dt><dd><p>
       The minor number of the device.
      </p></dd><dt id="idm140019137639552"><span class="term "><code class="literal">%s{<em class="replaceable ">ATTRIBUTE</em>}</code>,
     <code class="literal">$attr{<em class="replaceable ">ATTRIBUTE</em>}</code>
     </span></dt><dd><p>
       The value of a <code class="filename">sysfs</code> attribute (specified by
       <em class="replaceable ">ATTRIBUTE</em>).
      </p></dd><dt id="idm140019137635216"><span class="term "><code class="literal">%E{<em class="replaceable ">VARIABLE</em>}</code>,
     <code class="literal">$env{<em class="replaceable ">VARIABLE</em>}</code>
     </span></dt><dd><p>
       The value of an environment variable (specified by
       <em class="replaceable ">VARIABLE</em>).
      </p></dd><dt id="idm140019137631296"><span class="term "><code class="literal">%c</code>, <code class="literal">$result</code>
     </span></dt><dd><p>
       The output of <code class="envar">PROGRAM</code>.
      </p></dd><dt id="idm140019137628320"><span class="term "><code class="literal">%%</code>
     </span></dt><dd><p>
       The <code class="literal">%</code> character.
      </p></dd><dt id="idm140019137625792"><span class="term "><code class="literal">$$</code>
     </span></dt><dd><p>
       The <code class="literal">$</code> character.
      </p></dd></dl></div></div><div class="sect2 " id="sec.udev.rules.match"><div class="titlepage"><div><div><h3 class="title" id="sec.udev.rules.match"><span class="number">16.6.3 </span><span class="name">Using <code class="systemitem">udev</code> Match Keys</span> <a title="Permalink" class="permalink" href="#sec.udev.rules.match">#</a></h3></div></div></div><p>
    Match keys describe conditions that must be met before a
    <code class="systemitem">udev</code> rule can be applied. The
    following match keys are available:
   </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019137619504"><span class="term "><code class="literal">ACTION</code>
     </span></dt><dd><p>
       The name of the event action, for example, <code class="literal">add</code> or
       <code class="literal">remove</code> when adding or removing a device.
      </p></dd><dt id="idm140019137616464"><span class="term "><code class="literal">DEVPATH</code>
     </span></dt><dd><p>
       The device path of the event device, for example,
       <code class="literal">DEVPATH=/bus/pci/drivers/ipw3945</code> to search for all
       events related to the ipw3945 driver.
      </p></dd><dt id="idm140019137613824"><span class="term "><code class="literal">KERNEL</code>
     </span></dt><dd><p>
       The internal (kernel) name of the event device.
      </p></dd><dt id="idm140019137611696"><span class="term "><code class="literal">SUBSYSTEM</code>
     </span></dt><dd><p>
       The subsystem of the event device, for example,
       <code class="literal">SUBSYSTEM=usb</code> for all events related to USB devices.
      </p></dd><dt id="idm140019137609088"><span class="term "><code class="literal">ATTR{<em class="replaceable ">FILENAME</em>}</code>
     </span></dt><dd><p>
       <code class="systemitem">sysfs</code> attributes of the
       event device. To match a string contained in the
       <code class="filename">vendor</code> attribute file name, you could use
       <code class="literal">ATTR{vendor}=="On[sS]tream"</code>, for example.
      </p></dd><dt id="idm140019137604832"><span class="term "><code class="literal">KERNELS</code>
     </span></dt><dd><p>
       Let <code class="systemitem">udev</code> search the device path
       upwards for a matching device name.
      </p></dd><dt id="idm140019137601968"><span class="term "><code class="literal">SUBSYSTEMS</code>
     </span></dt><dd><p>
       Let <code class="systemitem">udev</code> search the device path
       upwards for a matching device subsystem name.
      </p></dd><dt id="idm140019137599104"><span class="term "><code class="literal">DRIVERS</code>
     </span></dt><dd><p>
       Let <code class="systemitem">udev</code> search the device path
       upwards for a matching device driver name.
      </p></dd><dt id="idm140019137596240"><span class="term "><code class="literal">ATTRS{<em class="replaceable ">FILENAME</em>}</code>
     </span></dt><dd><p>
       Let <code class="systemitem">udev</code> search the device path
       upwards for a device with matching
       <code class="systemitem">sysfs</code> attribute values.
      </p></dd><dt id="idm140019137592192"><span class="term "><code class="literal">ENV{<em class="replaceable ">KEY</em>}</code>
     </span></dt><dd><p>
       The value of an environment variable, for example,
       <code class="literal">ENV{ID_BUS}="ieee1394</code> to search for all events
       related to the FireWire bus ID.
      </p></dd><dt id="idm140019137589120"><span class="term "><code class="literal">PROGRAM</code>
     </span></dt><dd><p>
       Let <code class="systemitem">udev</code> execute an external
       program. To be successful, the program must return with exit code zero.
       The program's output, printed to STDOUT, is available to the
       <code class="literal">RESULT</code> key.
      </p></dd><dt id="idm140019137585712"><span class="term "><code class="literal">RESULT</code>
     </span></dt><dd><p>
       Match the output string of the last <code class="literal">PROGRAM</code> call.
       Either include this key in the same rule as the
       <code class="literal">PROGRAM</code> key or in a later one.
      </p></dd></dl></div></div><div class="sect2 " id="sec.udev.rules.assign"><div class="titlepage"><div><div><h3 class="title" id="sec.udev.rules.assign"><span class="number">16.6.4 </span><span class="name">Using <code class="systemitem">udev</code> Assign Keys</span> <a title="Permalink" class="permalink" href="#sec.udev.rules.assign">#</a></h3></div></div></div><p>
    In contrast to the match keys described above, assign keys do not describe
    conditions that must be met. They assign values, names and actions to the
    device nodes maintained by <code class="systemitem">udev</code>.
   </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019137578800"><span class="term "><code class="literal">NAME</code>
     </span></dt><dd><p>
       The name of the device node to be created. After a rule has set a node
       name, all other rules with a <code class="literal">NAME</code> key for this node
       are ignored.
      </p></dd><dt id="idm140019137576144"><span class="term "><code class="literal">SYMLINK</code>
     </span></dt><dd><p>
       The name of a symbolic link related to the node to be created. Multiple
       matching rules can add symbolic links to be created with the device
       node. You can also specify multiple symbolic links for one node in one
       rule using the space character to separate the symbolic link names.
      </p></dd><dt id="idm140019137573760"><span class="term "><code class="literal">OWNER, GROUP, MODE</code>
     </span></dt><dd><p>
       The permissions for the new device node. Values specified here overwrite
       anything that has been compiled in.
      </p></dd><dt id="idm140019137571568"><span class="term "><code class="literal">ATTR{<em class="replaceable ">KEY</em>}</code>
     </span></dt><dd><p>
       Specify a value to be written to a
       <code class="systemitem">sysfs</code> attribute of the event
       device. If the <code class="literal">==</code> operator is used, this key is also
       used to match against the value of a
       <code class="systemitem">sysfs</code> attribute.
      </p></dd><dt id="idm140019137567024"><span class="term "><code class="literal">ENV{<em class="replaceable ">KEY</em>}</code>
     </span></dt><dd><p>
       Tell <code class="systemitem">udev</code> to export a variable
       to the environment. If the <code class="literal">==</code> operator is used, this
       key is also used to match against an environment variable.
      </p></dd><dt id="idm140019137563200"><span class="term "><code class="literal">RUN</code>
     </span></dt><dd><p>
       Tell <code class="systemitem">udev</code> to add a program to
       the list of programs to be executed for this device. Keep in mind to
       restrict this to very short tasks to avoid blocking further events for
       this device.
      </p></dd><dt id="idm140019137560208"><span class="term "><code class="literal">LABEL</code>
     </span></dt><dd><p>
       Add a label where a <code class="literal">GOTO</code> can jump to.
      </p></dd><dt id="idm140019137557664"><span class="term "><code class="literal">GOTO</code>
     </span></dt><dd><p>
       Tell <code class="systemitem">udev</code> to skip several
       rules and continue with the one that carries the label referenced by the
       <code class="literal">GOTO</code> key.
      </p></dd><dt id="idm140019137554320"><span class="term "><code class="literal">IMPORT{<em class="replaceable ">TYPE</em>}</code>
     </span></dt><dd><p>
       Load variables into the event environment such as the output of an
       external program. <code class="systemitem">udev</code> imports
       variables of several types. If no type is specified,
       <code class="systemitem">udev</code> tries to determine the
       type itself based on the executable bit of the file permissions.
      </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
         <code class="literal">program</code> tells
         <code class="systemitem">udev</code> to execute an external
         program and import its output.
        </p></li><li class="listitem "><p>
         <code class="literal">file</code> tells
         <code class="systemitem">udev</code> to import a text file.
        </p></li><li class="listitem "><p>
         <code class="literal">parent</code> tells
         <code class="systemitem">udev</code> to import the stored
         keys from the parent device.
        </p></li></ul></div></dd><dt id="idm140019137542816"><span class="term "><code class="literal">WAIT_FOR_SYSFS</code>
     </span></dt><dd><p>
       Tells <code class="systemitem">udev</code> to wait for the
       specified <code class="systemitem">sysfs</code> file to be
       created for a certain device. For example,
       <code class="literal">WAIT_FOR_SYSFS="ioerr_cnt"</code> informs
       <code class="systemitem">udev</code> to wait until the
       <code class="filename">ioerr_cnt</code> file has been created.
      </p></dd><dt id="idm140019137537568"><span class="term "><code class="literal">OPTIONS</code>
     </span></dt><dd><p>
       The <code class="literal">OPTION</code> key may have several values:
      </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
         <code class="literal">last_rule</code> tells
         <code class="systemitem">udev</code> to ignore all later
         rules.
        </p></li><li class="listitem "><p>
         <code class="literal">ignore_device</code> tells
         <code class="systemitem">udev</code> to ignore this event
         completely.
        </p></li><li class="listitem "><p>
         <code class="literal">ignore_remove</code> tells
         <code class="systemitem">udev</code> to ignore all later
         remove events for the device.
        </p></li><li class="listitem "><p>
         <code class="literal">all_partitions</code> tells
         <code class="systemitem">udev</code> to create device nodes
         for all available partitions on a block device.
        </p></li></ul></div></dd></dl></div></div></div><div class="sect1 " id="sec.udev.persdev"><div class="titlepage"><div><div><h2 class="title" id="sec.udev.persdev"><span class="number">16.7 </span><span class="name">Persistent Device Naming</span> <a title="Permalink" class="permalink" href="#sec.udev.persdev">#</a></h2></div></div></div><p>
   The dynamic device directory and the
   <code class="systemitem">udev</code> rules infrastructure make it
   possible to provide stable names for all disk devices—regardless of
   their order of recognition or the connection used for the device. Every
   appropriate block device the kernel creates is examined by tools with
   special knowledge about certain buses, drive types or file systems. Along
   with the dynamic kernel-provided device node name,
   <code class="systemitem">udev</code> maintains classes of
   persistent symbolic links pointing to the device:
  </p><div class="verbatim-wrap"><pre class="screen">/dev/disk
|-- by-id
|   |-- scsi-SATA_HTS726060M9AT00_MRH453M4HWHG7B -&gt; ../../sda
|   |-- scsi-SATA_HTS726060M9AT00_MRH453M4HWHG7B-part1 -&gt; ../../sda1
|   |-- scsi-SATA_HTS726060M9AT00_MRH453M4HWHG7B-part6 -&gt; ../../sda6
|   |-- scsi-SATA_HTS726060M9AT00_MRH453M4HWHG7B-part7 -&gt; ../../sda7
|   |-- usb-Generic_STORAGE_DEVICE_02773 -&gt; ../../sdd
|   `-- usb-Generic_STORAGE_DEVICE_02773-part1 -&gt; ../../sdd1
|-- by-label
|   |-- Photos -&gt; ../../sdd1
|   |-- SUSE10 -&gt; ../../sda7
|   `-- devel -&gt; ../../sda6
|-- by-path
|   |-- pci-0000:00:1f.2-scsi-0:0:0:0 -&gt; ../../sda
|   |-- pci-0000:00:1f.2-scsi-0:0:0:0-part1 -&gt; ../../sda1
|   |-- pci-0000:00:1f.2-scsi-0:0:0:0-part6 -&gt; ../../sda6
|   |-- pci-0000:00:1f.2-scsi-0:0:0:0-part7 -&gt; ../../sda7
|   |-- pci-0000:00:1f.2-scsi-1:0:0:0 -&gt; ../../sr0
|   |-- usb-02773:0:0:2 -&gt; ../../sdd
|   |-- usb-02773:0:0:2-part1 -&gt; ../../sdd1
`-- by-uuid
    |-- 159a47a4-e6e6-40be-a757-a629991479ae -&gt; ../../sda7
    |-- 3e999973-00c9-4917-9442-b7633bd95b9e -&gt; ../../sda6
    `-- 4210-8F8C -&gt; ../../sdd1</pre></div></div><div class="sect1 " id="sec.udev.files"><div class="titlepage"><div><div><h2 class="title" id="sec.udev.files"><span class="number">16.8 </span><span class="name">Files used by <code class="systemitem">udev</code></span> <a title="Permalink" class="permalink" href="#sec.udev.files">#</a></h2></div></div></div><div class="variablelist "><dl class="variablelist"><dt id="idm140019137517920"><span class="term "><code class="filename">/sys/*</code>
    </span></dt><dd><p>
      Virtual file system provided by the Linux kernel, exporting all currently
      known devices. This information is used by
      <code class="systemitem">udev</code> to create device nodes in
      <code class="filename">/dev</code>
     </p></dd><dt id="idm140019137514528"><span class="term "><code class="filename">/dev/*</code>
    </span></dt><dd><p>
      Dynamically created device nodes and static content created with
      systemd-tmpfiles; for more information, see the
      <code class="systemitem">systemd-tmpfiles(8)</code> man page.
     </p></dd></dl></div><p>
   The following files and directories contain the crucial elements of the
   <code class="systemitem">udev</code> infrastructure:
  </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019137510208"><span class="term "><code class="filename">/etc/udev/udev.conf</code>
    </span></dt><dd><p>
      Main <code class="systemitem">udev</code> configuration file.
     </p></dd><dt id="idm140019137507392"><span class="term "><code class="filename">/etc/udev/rules.d/*</code>
    </span></dt><dd><p>
      <code class="systemitem">udev</code> event matching rules.
     </p></dd><dt id="idm140019137504576"><span class="term "><code class="filename">/usr/lib/tmpfiles.d/</code> and
    <code class="filename">/etc/tmpfiles.d/</code>
    </span></dt><dd><p>
      Responsible for static <code class="filename">/dev</code> content.
     </p></dd><dt id="idm140019137501584"><span class="term "><code class="filename">/usr/lib/udev/*</code>
    </span></dt><dd><p>
      Helper programs called from <code class="systemitem">udev</code>
      rules.
     </p></dd></dl></div></div><div class="sect1 " id="sec.udev.moreinfo"><div class="titlepage"><div><div><h2 class="title" id="sec.udev.moreinfo"><span class="number">16.9 </span><span class="name">For More Information</span> <a title="Permalink" class="permalink" href="#sec.udev.moreinfo">#</a></h2></div></div></div><p>
   For more information about the <code class="systemitem">udev</code>
   infrastructure, refer to the following man pages:
  </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019137495760"><span class="term "><code class="systemitem">udev</code>
    </span></dt><dd><p>
      General information about <code class="systemitem">udev</code>,
      keys, rules and other important configuration issues.
     </p></dd><dt id="idm140019137492624"><span class="term "><code class="command">udevadm</code>
    </span></dt><dd><p>
      <code class="command">udevadm</code> can be used to control the runtime behavior of
      <code class="systemitem">udev</code>, request kernel events,
      manage the event queue and provide simple debugging mechanisms.
     </p></dd><dt id="idm140019137489264"><span class="term "><code class="systemitem">udevd</code>
    </span></dt><dd><p>
      Information about the <code class="systemitem">udev</code> event
      managing daemon.
     </p></dd></dl></div></div></div></div><div class="part" id="part.reference.services"><div class="titlepage"><div><div><h1 class="title"><span class="number">Part III </span><span class="name">Services </span><a title="Permalink" class="permalink" href="#part.reference.services">#</a></h1></div></div></div><div class="toc"><dl><dt><span class="chapter"><a href="#cha.slp"><span class="number">17 </span><span class="name">SLP</span></a></span></dt><dd class="toc-abstract"><p>
    Configuring a network client requires detailed knowledge about services
    provided over the network (such as printing or LDAP, for example). To make
    it easier to configure such services on a network client, the
    <span class="quote">“<span class="quote">service location protocol</span>”</span> (SLP) was developed. SLP makes the
    availability and configuration data of selected services known to all
    clients in the local network. Applications that support SLP can use this
    information to be configured automatically.
   </p></dd><dt><span class="chapter"><a href="#cha.ntp"><span class="number">18 </span><span class="name">Time Synchronization with NTP</span></a></span></dt><dd class="toc-abstract"><p>
    The NTP (network time protocol) mechanism is a protocol for synchronizing
    the system time over the network. First, a machine can obtain the time from
    a server that is a reliable time source. Second, a machine can itself act
    as a time source for other computers in the network. The goal is
    twofold—maintaining the absolute time and synchronizing the system
    time of all machines within a network.
   </p></dd><dt><span class="chapter"><a href="#cha.dns"><span class="number">19 </span><span class="name">The Domain Name System</span></a></span></dt><dd class="toc-abstract"><p>
    DNS (domain name system) is needed to resolve the domain names and host
    names into IP addresses. In this way, the IP address 192.168.2.100 is assigned to
    the host name <code class="literal">jupiter</code>, for example. Before setting up your
    own name server, read the general information about DNS in
    <a class="xref" href="#sec.network.nameres" title="13.3. Name Resolution">Section 13.3, “Name Resolution”</a>. The following configuration
    examples refer to BIND, the default DNS server.
   </p></dd><dt><span class="chapter"><a href="#cha.dhcp"><span class="number">20 </span><span class="name">DHCP</span></a></span></dt><dd class="toc-abstract"><p>
    The purpose of the <span class="emphasis"><em>Dynamic Host Configuration Protocol</em></span>
    (DHCP) is to assign network settings centrally (from a server) rather than
    configuring them locally on every workstation. A host configured to use
    DHCP does not have control over its own static address. It is enabled to
    configure itself completely and automatically according to directions from
    the server. If you use the NetworkManager on the client side, you do not need to
    configure the client. This is useful if you have changing environments and
    only one interface active at a time. Never use NetworkManager on a machine that runs
    a DHCP server.
   </p></dd><dt><span class="chapter"><a href="#cha.samba"><span class="number">21 </span><span class="name">Samba</span></a></span></dt><dd class="toc-abstract"><p>
    Using Samba, a Unix machine can be configured as a file and print server
    for macOS, Windows, and OS/2 machines. Samba has developed into a
    fully-fledged and rather complex product. Configure Samba with YaST, or
    by editing the configuration file manually.
   </p></dd><dt><span class="chapter"><a href="#cha.nfs"><span class="number">22 </span><span class="name">Sharing File Systems with NFS</span></a></span></dt><dd class="toc-abstract"><p>
    The <span class="emphasis"><em>Network File System</em></span> (<span class="emphasis"><em>NFS</em></span>)
    is a protocol that allows access to files on a server very similar to
    accessing local files.
   </p></dd><dt><span class="chapter"><a href="#cha.autofs"><span class="number">23 </span><span class="name">On-Demand Mounting with Autofs</span></a></span></dt><dd class="toc-abstract"><p>
    <code class="systemitem">autofs</code> is a program that automatically mounts
    specified directories on an on-demand basis. It is based on a kernel module
    for high efficiency, and can manage both local directories and network
    shares. These automatic mount points are mounted only when they are
    accessed, and unmounted after a certain period of inactivity. This
    on-demand behavior saves bandwidth and results in better performance than
    static mounts managed by <code class="filename">/etc/fstab</code>. While
    <code class="systemitem">autofs</code> is a control script,
    <code class="command">automount</code> is the command (daemon) that does the actual
    auto-mounting.
   </p></dd><dt><span class="chapter"><a href="#cha.apache2"><span class="number">24 </span><span class="name">The Apache HTTP Server</span></a></span></dt><dd class="toc-abstract"><p>
    According to the survey from <a class="link" href="http://www.netcraft.com/" target="_blank">http://www.netcraft.com/</a>,
    the Apache HTTP Server (Apache) is the world's most widely-used Web server.
    Developed by the Apache Software Foundation
    (<a class="link" href="http://www.apache.org/" target="_blank">http://www.apache.org/</a>), it is available for most
    operating systems. <span class="productname"><span class="phrase">openSUSE® Leap</span></span> includes Apache version 2.4. In this
    chapter, learn how to install, configure and set up a Web server; how to
    use SSL, CGI, and additional modules; and how to troubleshoot Apache.
   </p></dd><dt><span class="chapter"><a href="#cha.ftp"><span class="number">25 </span><span class="name">Setting Up an FTP Server with YaST</span></a></span></dt><dd class="toc-abstract"><p>
    Using the YaST <span class="guimenu">FTP Server</span> module, you can configure
    your machine to function as an FTP (File Transfer Protocol) server.
    Anonymous and/or authenticated users can connect to your machine and
    download files using the FTP protocol. Depending on the configuration, they
    can also upload files to the FTP server. YaST uses vsftpd (Very Secure
    FTP Daemon).
   </p></dd><dt><span class="chapter"><a href="#cha.squid"><span class="number">26 </span><span class="name">The Proxy Server Squid</span></a></span></dt><dd class="toc-abstract"><p>
    Squid is a widely-used proxy cache for Linux and Unix platforms. This means
    that it stores requested Internet objects, such as data on a Web or FTP
    server, on a machine that is closer to the requesting workstation than the
    server. It can be set up in multiple hierarchies to assure optimal response
    times and low bandwidth usage, even in modes that are transparent to end
    users.
   </p></dd></dl></div><div class="chapter " id="cha.slp"><div class="titlepage"><div><div><h2 class="title"><span class="number">17 </span><span class="name">SLP</span> <a title="Permalink" class="permalink" href="#cha.slp">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">Filename: </span>net_slp.xml</li><li><span class="ds-label">ID: </span>cha.slp</li></ul></div></div><div><div class="abstract"><div class="abstract-title-wrap"><h6 class="abstract-title">Abstract<a title="Permalink" class="permalink" href="#idm140019137481696">#</a></h6></div><p>
    Configuring a network client requires detailed knowledge about services
    provided over the network (such as printing or LDAP, for example). To make
    it easier to configure such services on a network client, the
    <span class="quote">“<span class="quote">service location protocol</span>”</span> (SLP) was developed. SLP makes the
    availability and configuration data of selected services known to all
    clients in the local network. Applications that support SLP can use this
    information to be configured automatically.
   </p></div></div></div></div><div class="line"><div class="toc"><dl><dt><span class="sect1"><a href="#sec.slp.sl.fend"><span class="number">17.1 </span><span class="name">The SLP Front-End <code class="command">slptool</code></span></a></span></dt><dt><span class="sect1"><a href="#sec.slp.sl.reg"><span class="number">17.2 </span><span class="name">Providing Services via SLP</span></a></span></dt><dt><span class="sect1"><a href="#sec.slp.info"><span class="number">17.3 </span><span class="name">For More Information</span></a></span></dt></dl></div></div><p>
  <span class="productname"><span class="phrase">openSUSE® Leap</span></span> supports installation using installation sources provided
  with SLP and contains many system services with integrated support for SLP.
  You can use SLP to provide networked clients with central functions, such as
  an installation server, file server, or print server on your system. Services
  that offer SLP support include cupsd, login, ntp, openldap2, postfix,
  rpasswd, rsyncd, saned, sshd (via fish), vnc, and ypserv.
 </p><p>
  All packages necessary to use SLP services on a network client are installed
  by default. However, if you want to <span class="emphasis"><em>provide</em></span> services via
  SLP, check that the <code class="systemitem">openslp-server</code> package is
  installed.
 </p><div class="sect1 " id="sec.slp.sl.fend"><div class="titlepage"><div><div><h2 class="title" id="sec.slp.sl.fend"><span class="number">17.1 </span><span class="name">The SLP Front-End <code class="command">slptool</code></span> <a title="Permalink" class="permalink" href="#sec.slp.sl.fend">#</a></h2></div></div></div><p>
   <code class="command">slptool</code> is a command line tool to query and register SLP
   services. The query functions are useful for diagnostic purposes. The most
   important <code class="command">slptool</code> subcommands are listed below.
   <code class="command">slptool</code> <code class="option">--help</code> lists all available
   options and functions.
  </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019137470800"><span class="term ">findsrvtypes</span></dt><dd><p>
      List all service types available on the network.
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>slptool findsrvtypes
service:install.suse:nfs
service:install.suse:ftp
service:install.suse:http
service:install.suse:smb
service:ssh
service:fish
service:YaST.installation.suse:vnc
service:smtp
service:domain
service:management-software.IBM:hardware-management-console
service:rsync
service:ntp
service:ypserv</pre></div></dd><dt id="idm140019137467936"><span class="term ">findsrvs <em class="replaceable ">SERVICE_TYPE</em>
    </span></dt><dd><p>
      List all servers providing <em class="replaceable ">SERVICE_TYPE</em>
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>slptool findsrvs service:ntp
service:ntp://ntp.example.com:123,57810
service:ntp://ntp2.example.com:123,57810</pre></div></dd><dt id="idm140019137464400"><span class="term ">
     findattrs <em class="replaceable ">SERVICE_TYPE</em>//<em class="replaceable ">HOST</em>
    </span></dt><dd><p>
      List attributes for <em class="replaceable ">SERVICE_TYPE</em> on
      <em class="replaceable ">HOST</em>
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>slptool findattrs service:ntp://ntp.example.com
(owner=tux),(email=tux@example.com)</pre></div></dd><dt id="idm140019137460000"><span class="term ">
     register <em class="replaceable ">SERVICE
     type</em>//<em class="replaceable ">HOST</em>:<em class="replaceable ">PORT</em>
     "(<em class="replaceable ">ATTRIBUTE=VALUE</em>),(<em class="replaceable ">ATTRIBUTE=VALUE</em>)"
    </span></dt><dd><p>
      Registers <em class="replaceable ">SERVICE_TYPE</em> on
      <em class="replaceable ">HOST</em> with an optional list of attributes
     </p><div class="verbatim-wrap"><pre class="screen">slptool register service:ntp://ntp.example.com:57810 \
"(owner=tux),(email=tux@example.com)"</pre></div></dd><dt id="idm140019137454512"><span class="term ">
     deregister <em class="replaceable ">SERVICE_TYPE</em>//<em class="replaceable ">host</em>
    </span></dt><dd><p>
      De-registers <em class="replaceable ">SERVICE_TYPE</em> on
      <em class="replaceable ">HOST</em>
     </p><div class="verbatim-wrap"><pre class="screen">slptool deregister service:ntp://ntp.example.com</pre></div></dd></dl></div><p>
   For more information run <code class="command">slptool --help</code>.
  </p></div><div class="sect1 " id="sec.slp.sl.reg"><div class="titlepage"><div><div><h2 class="title" id="sec.slp.sl.reg"><span class="number">17.2 </span><span class="name">Providing Services via SLP</span> <a title="Permalink" class="permalink" href="#sec.slp.sl.reg">#</a></h2></div></div></div><p>
   To provide SLP services, the SLP daemon
   (<code class="systemitem">slpd</code>) must be running. Like most
   system services in <span class="productname"><span class="phrase">openSUSE Leap</span></span>,
   <code class="systemitem">slpd</code> is controlled by means of a
   separate start script. After the installation, the daemon is inactive by
   default. To activate it for the current session, run <code class="command">sudo systemctl
   start slpd</code>. If <code class="systemitem">slpd</code> should
   be activated on system start-up, run <code class="command">sudo systemctl enable
   slpd</code>.
  </p><p>
   Many applications in <span class="productname"><span class="phrase">openSUSE Leap</span></span> have integrated SLP support via the
   <code class="literal">libslp</code> library. If a service has not been compiled with
   SLP support, use one of the following methods to make it available via SLP:
  </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019137440672"><span class="term ">Static Registration with <code class="filename">/etc/slp.reg.d</code>
    </span></dt><dd><p>
      Create a separate registration file for each new service. The following
      example registers a scanner service:
     </p><div class="verbatim-wrap"><pre class="screen">## Register a saned service on this system
## en means english language
## 65535 disables the timeout, so the service registration does
## not need refreshes
service:scanner.sane://$HOSTNAME:6566,en,65535
watch-port-tcp=6566
description=SANE scanner daemon</pre></div><p>
      The most important line in this file is the <span class="emphasis"><em>service
      URL</em></span>, which begins with <code class="literal">service:</code>. This
      contains the service type (<code class="literal">scanner.sane</code>) and the
      address under which the service is available on the server.
      <em class="replaceable ">$HOSTNAME</em> is automatically replaced with the
      full host name. The name of the TCP port on which the relevant service
      can be found follows, separated by a colon. Then enter the language in
      which the service should appear and the duration of registration in
      seconds. These should be separated from the service URL by commas. Set
      the value for the duration of registration between <code class="literal">0</code>
      and <code class="literal">65535</code>. <code class="literal">0</code> prevents registration.
      <code class="literal">65535</code> removes all restrictions.
     </p><p>
      The registration file also contains the two variables
      <code class="systemitem">watch-port-tcp</code> and
      <code class="systemitem">description</code>.
      <code class="systemitem">watch-port-tcp</code> links the SLP service
      announcement to whether the relevant service is active by having
      <code class="systemitem">slpd</code> check the status of the
      service. The second variable contains a more precise description of the
      service that is displayed in suitable browsers.
     </p><div id="idm140019137430576" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.png" /><h6>Tip: YaST and SLP</h6><p>
       Some services brokered by YaST, such as an installation server or YOU
       server, perform this registration automatically when you activate SLP in
       the module dialogs. YaST then creates registration files for these
       services.
      </p></div></dd><dt id="idm140019137428672"><span class="term ">Static Registration with <code class="filename">/etc/slp.reg</code>
    </span></dt><dd><p>
      The only difference between this method and the procedure with
      <code class="filename">/etc/slp.reg.d</code> is that all services are grouped
      within a central file.
     </p></dd><dt id="idm140019137425856"><span class="term ">Dynamic Registration with <code class="command">slptool</code>
    </span></dt><dd><p>
      If a service needs to be registered dynamically without the need of
      configuration files, use the slptool command line utility. The same
      utility can also be used to de-register an existing service offering
      without restarting <code class="systemitem">slpd</code>. See
      <a class="xref" href="#sec.slp.sl.fend" title="17.1. The SLP Front-End slptool">Section 17.1, “The SLP Front-End <code class="command">slptool</code>”</a> for details.
     </p></dd></dl></div><div class="sect2 " id="sec.slp.sl.reg.install"><div class="titlepage"><div><div><h3 class="title" id="sec.slp.sl.reg.install"><span class="number">17.2.1 </span><span class="name">Setting up an SLP Installation Server</span> <a title="Permalink" class="permalink" href="#sec.slp.sl.reg.install">#</a></h3></div></div></div><p>
    Announcing the installation data via SLP within your network makes the
    network installation much easier, since the installation data such as IP
    address of the server or the path to the installation media are
    automatically required via SLP query. 
   </p></div></div><div class="sect1 " id="sec.slp.info"><div class="titlepage"><div><div><h2 class="title" id="sec.slp.info"><span class="number">17.3 </span><span class="name">For More Information</span> <a title="Permalink" class="permalink" href="#sec.slp.info">#</a></h2></div></div></div><div class="variablelist "><dl class="variablelist"><dt id="idm140019137418256"><span class="term ">RFC 2608, 2609, 2610</span></dt><dd><p>
      RFC 2608 generally deals with the definition of SLP. RFC 2609 deals with
      the syntax of the service URLs used in greater detail and RFC 2610 deals
      with DHCP via SLP.
     </p></dd><dt id="idm140019137416288"><span class="term "><a class="link" href="http://www.openslp.org" target="_blank">http://www.openslp.org</a>
    </span></dt><dd><p>
      The home page of the OpenSLP project.
     </p></dd><dt id="idm140019137414064"><span class="term "><code class="filename">/usr/share/doc/packages/openslp</code>
    </span></dt><dd><p>
      This directory contains the documentation for SLP coming with the
      <code class="systemitem">openslp-server</code> package, including a
      <code class="filename">README.SUSE</code> containing the <span class="productname"><span class="phrase">openSUSE Leap</span></span> details,
      the RFCs, and two introductory HTML documents. Programmers who want to
      use the SLP functions will find more information in the
      <span class="emphasis"><em>Programmers Guide</em></span> that is included in the
      <code class="systemitem">openslp-devel</code> package.
     </p></dd></dl></div></div></div><div class="chapter " id="cha.ntp"><div class="titlepage"><div><div><h2 class="title"><span class="number">18 </span><span class="name">Time Synchronization with NTP</span> <a title="Permalink" class="permalink" href="#cha.ntp">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">Filename: </span>chrony.xml</li><li><span class="ds-label">ID: </span>cha.ntp</li></ul></div></div><div><div class="abstract"><div class="abstract-title-wrap"><h6 class="abstract-title">Abstract<a title="Permalink" class="permalink" href="#idm140019137405392">#</a></h6></div><p>
    The NTP (network time protocol) mechanism is a protocol for synchronizing
    the system time over the network. First, a machine can obtain the time from
    a server that is a reliable time source. Second, a machine can itself act
    as a time source for other computers in the network. The goal is
    twofold—maintaining the absolute time and synchronizing the system
    time of all machines within a network.
   </p></div></div></div></div><div class="line"><div class="toc"><dl><dt><span class="sect1"><a href="#sec.ntp.yast"><span class="number">18.1 </span><span class="name">Configuring an NTP Client with YaST</span></a></span></dt><dt><span class="sect1"><a href="#sec.netz.xntp.netconf"><span class="number">18.2 </span><span class="name">Manually Configuring NTP in the Network</span></a></span></dt><dt><span class="sect1"><a href="#ntp.chronyc"><span class="number">18.3 </span><span class="name">Configure <code class="systemitem">chronyd</code> at Runtime using <code class="command">chronyc</code></span></a></span></dt><dt><span class="sect1"><a href="#sec.netz.xntp.dynamic"><span class="number">18.4 </span><span class="name">Dynamic Time Synchronization at Runtime</span></a></span></dt><dt><span class="sect1"><a href="#sec.netz.xntp.normal"><span class="number">18.5 </span><span class="name">Setting Up a Local Reference Clock</span></a></span></dt></dl></div></div><p>
  Maintaining an exact system time is important in many situations. The
  built-in hardware clock does often not meet the requirements of applications
  such as databases or clusters. Manual correction of the system time would
  lead to severe problems because, for example, a backward leap can cause
  malfunction of critical applications. Within a network, it is usually
  necessary to synchronize the system time of all machines, but manual time
  adjustment is a bad approach. NTP provides a mechanism to solve these
  problems. The NTP service continuously adjusts the system time with reliable
  time servers in the network. It further enables the management of local
  reference clocks, such as radio-controlled clocks.
 </p><p>
  Since <span class="productname"><span class="phrase">openSUSE Leap</span></span> 15, <code class="systemitem">chrony</code> is the default implementation of NTP.
  <code class="systemitem">chrony</code> includes two parts; <code class="systemitem">chronyd</code> is a daemon that can be started at
  boot time and <code class="command">chronyc</code> is a command line interface program to monitor the
  performance of <code class="systemitem">chronyd</code>, and to change various operating parameters at
  runtime.
 </p><div id="idm140019137396368" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note</h6><p>
   To enable time synchronization by means of active directory, follow the
   instructions found at <span class="intraxref">Book “<em class="citetitle ">Security Guide</em>”, Chapter 7 “Active Directory Support”, Section 7.3.3 “
    Joining Active Directory Using
    <span class="guimenu">Windows Domain Membership</span>
   ”, 
    Joining an Active Directory Domain Using <span class="guimenu">Windows Domain Membership</span>
   </span>.
  </p></div><div class="sect1 " id="sec.ntp.yast"><div class="titlepage"><div><div><h2 class="title" id="sec.ntp.yast"><span class="number">18.1 </span><span class="name">Configuring an NTP Client with YaST</span> <a title="Permalink" class="permalink" href="#sec.ntp.yast">#</a></h2></div></div></div><p>
   The NTP daemon (<code class="systemitem">chronyd</code>) coming with the <code class="systemitem">chrony</code>
   package is preset to use the local computer hardware clock as a time
   reference.  The precision of a hardware clock heavily depends on its time
   source. For example, an atomic clock or GPS receiver is a very precise time
   source, while a common RTC chip is not a reliable time source.  YaST
   simplifies the configuration of an NTP client.
  </p><p>
   In the YaST NTP client configuration (<span class="guimenu">Network
   Services</span> › <span class="guimenu">NTP Configuration</span>)
   window, you can specify when to start NTP daemon, the type of the
   configuration source, and add custom time servers.
  </p><div class="figure" id="idm140019137389808"><div class="figure-contents"><div class="mediaobject"><a xmlns="" href="images/ntp_client.png"><img src="images/ntp_client.png" width="" alt="NTP Configuration Window" /></a></div></div><div class="figure-title-wrap"><h6 class="figure-title"><span class="number">Figure 18.1: </span><span class="name">NTP Configuration Window </span><a title="Permalink" class="permalink" href="#idm140019137389808">#</a></h6></div></div><div class="sect2 " id="idm140019137384800"><div class="titlepage"><div><div><h3 class="title" id="idm140019137384800"><span class="number">18.1.1 </span><span class="name">NTP Daemon Start</span> <a title="Permalink" class="permalink" href="#idm140019137384800">#</a></h3></div></div></div><p>
    You can choose from three options when to start the NTP daemon:
   </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019137383264"><span class="term "><span class="guimenu">Only Manually</span>
     </span></dt><dd><p>
       Select <span class="guimenu">Only Manually</span>, if you want to manually start
       the <code class="systemitem">chrony</code> daemon.
      </p></dd><dt id="idm140019137379984"><span class="term "><span class="guimenu">Synchronize without Daemon</span>
     </span></dt><dd><p>
       Select <span class="guimenu">Synchronize without Daemon</span> to set the system
       time periodically without a permanently running <code class="systemitem">chrony</code>. You can set
       the <span class="guimenu">Interval of the Synchronization in Minutes</span>.
      </p></dd><dt id="idm140019137376144"><span class="term "><span class="guimenu">Now and On Boot</span>
     </span></dt><dd><p>
       Select <span class="guimenu">Now and On Boot</span> to start <code class="systemitem">chronyd</code>
       automatically when the system is booted. This setting is recommended.
      </p></dd></dl></div></div><div class="sect2 " id="idm140019137372512"><div class="titlepage"><div><div><h3 class="title" id="idm140019137372512"><span class="number">18.1.2 </span><span class="name">Type of the Configuration Source</span> <a title="Permalink" class="permalink" href="#idm140019137372512">#</a></h3></div></div></div><p>
    In the <span class="guimenu">Configuration Source</span> drop-down list, select
    either <span class="guimenu">Dynamic</span> or <span class="guimenu">Static</span>. Set
    <span class="guimenu">Static</span> if your server uses only a fixed set of (public)
    NTP servers, while <span class="guimenu">Dynamic</span> is better if your internal
    network offers NTP servers via DHCP.
   </p></div><div class="sect2 " id="sec.net.ntp.yast.new_sync"><div class="titlepage"><div><div><h3 class="title" id="sec.net.ntp.yast.new_sync"><span class="number">18.1.3 </span><span class="name">Configure Time Servers</span> <a title="Permalink" class="permalink" href="#sec.net.ntp.yast.new_sync">#</a></h3></div></div></div><p>
    Time servers for the client to query are listed in the lower part of the
    <span class="guimenu">NTP Configuration</span> window. Modify this list as needed
    with <span class="guimenu">Add</span>, <span class="guimenu">Edit</span>, and
    <span class="guimenu">Delete</span>.
   </p><p>
    Click <span class="guimenu">Add</span> to add a new time server:
   </p><div class="figure" id="idm140019137364320"><div class="figure-contents"><div class="mediaobject"><a xmlns="" href="images/ntp_client_serveradd.png"><img src="images/ntp_client_serveradd.png" width="" alt="Adding a Time Server" /></a></div></div><div class="figure-title-wrap"><h6 class="figure-title"><span class="number">Figure 18.2: </span><span class="name">Adding a Time Server </span><a title="Permalink" class="permalink" href="#idm140019137364320">#</a></h6></div></div><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
      In the <span class="guimenu">Address</span> field, type the URL of the time server
      or pool of time servers with which you want to synchronize the machine
      time. After the URL is complete, click <span class="guimenu">Test</span> to verify
      that it points to a valid time source.
     </p></li><li class="step "><p>
      Activate <span class="guimenu">Quick Initial Sync</span> to speed up the time
      synchronization by sending more requests at the <code class="systemitem">chronyd</code> daemon start.
     </p></li><li class="step "><p>
      Activate <span class="guimenu">Start Offline</span> to speed up the boot time on
      systems that start the <code class="systemitem">chronyd</code> daemon automatically and may not have an
      internet connection at boot time. This option is useful for example for
      laptops whose network connection is managed by NetworkManager.
     </p></li><li class="step "><p>
      Confirm with <span class="guimenu">OK</span>
     </p></li></ol></div></div></div></div><div class="sect1 " id="sec.netz.xntp.netconf"><div class="titlepage"><div><div><h2 class="title" id="sec.netz.xntp.netconf"><span class="number">18.2 </span><span class="name">Manually Configuring NTP in the Network</span> <a title="Permalink" class="permalink" href="#sec.netz.xntp.netconf">#</a></h2></div></div></div><p>
   <code class="systemitem">chrony</code> reads its configuration from the
   <code class="filename">/etc/chrony.conf</code> file. To keep the computer clock
   synchronized, you need to tell <code class="systemitem">chrony</code> what time servers to use. You can
   use specific server names or IP addresses, for example:
  </p><div class="verbatim-wrap"><pre class="screen">server 0.europe.pool.ntp.org
server 1.europe.pool.ntp.org
server 2.europe.pool.ntp.org</pre></div><p>
   You can also specify a <span class="emphasis"><em>pool</em></span> name. Pool name resolves to
   several IP addresses:
  </p><div class="verbatim-wrap"><pre class="screen">pool pool.ntp.org</pre></div><div id="idm140019137345200" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.png" /><h6>Tip: Computers on the Same Network</h6><p>
    To synchronize time on multiple computers on the same network, we do not
    recommend to synchronize all of them with an external server. A good
    practice is to make one computer the time server which is synchronized with
    an external time server, and the other computers act as its clients. Add a
    <code class="literal">local</code> directive to the server's
    <code class="filename">/etc/chrony.conf</code> to distinguish it from an
    authoritative time server:
   </p><div class="verbatim-wrap"><pre class="screen">local stratum 10</pre></div></div><p>
   To start <code class="systemitem">chrony</code>, run:
  </p><div class="verbatim-wrap"><pre class="screen">systemctl start chronyd.service</pre></div><p>
   After initializing <code class="systemitem">chronyd</code>, it takes some time before the time is
   stabilized and the drift file for correcting the local computer clock is
   created. With the drift file, the systematic error of the hardware clock can
   be computed when the computer is powered on. The correction is used
   immediately, resulting in a higher stability of the system time.
  </p><p>
   To enable the service so that <code class="systemitem">chrony</code> starts automatically at boot time,
   run:
  </p><div class="verbatim-wrap"><pre class="screen">systemctl enable chronyd.service</pre></div></div><div class="sect1 " id="ntp.chronyc"><div class="titlepage"><div><div><h2 class="title" id="ntp.chronyc"><span class="number">18.3 </span><span class="name">Configure <code class="systemitem">chronyd</code> at Runtime using <code class="command">chronyc</code></span> <a title="Permalink" class="permalink" href="#ntp.chronyc">#</a></h2></div></div></div><p>
   You can use <code class="command">chronyc</code> to change the behavior of <code class="systemitem">chronyd</code> at runtime. It
   also generates status reports about the operation of <code class="systemitem">chronyd</code>.
  </p><p>
   You can run <code class="command">chronyc</code> either in interactive a or non-interactive mode. To
   run <code class="command">chronyc</code> interactively, enter <code class="command">chronyc</code> on the command line. It
   displays a prompt and waits for your command input. For example, to check
   how many NTP sources are online or offline, run:
  </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code><code class="command">chronyc</code>
chronyc&gt; activity
200 OK
4 sources online
2 sources offline
1 sources doing burst (return to online)
1 sources doing burst (return to offline)
0 sources with unknown address</pre></div><p>
   To exit <code class="command">chronyc</code>'s prompt, enter <code class="command">quit</code> or
   <code class="command">exit</code>.
  </p><p>
   If you do not need to use the interactive prompt, enter the command
   directly:
  </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code><code class="command">chronyc</code> activity</pre></div><div id="idm140019137325536" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note: Temporary Changes</h6><p>
    Changes made using <code class="command">chronyc</code> are not permanent. They will be lost after the
    next <code class="systemitem">chronyd</code> restart. For permanent changes, modify
    <code class="filename">/etc/chrony.conf</code>.
   </p></div><p>
   For a complete list of <code class="command">chronyc</code> commands, see its manual page (<code class="command">man
   1 chronyc</code>).
  </p></div><div class="sect1 " id="sec.netz.xntp.dynamic"><div class="titlepage"><div><div><h2 class="title" id="sec.netz.xntp.dynamic"><span class="number">18.4 </span><span class="name">Dynamic Time Synchronization at Runtime</span> <a title="Permalink" class="permalink" href="#sec.netz.xntp.dynamic">#</a></h2></div></div></div><p>
   If the system boots without network connection, <code class="systemitem">chronyd</code> starts up, but it
   cannot resolve DNS names of the time servers set in the configuration file.
   This can happen if you use NetworkManager with an encrypted Wi-Fi.
  </p><p>
   <code class="systemitem">chronyd</code> keeps trying to resolve the time server names specified by the
   <code class="option">server</code>, <code class="option">pool</code>, and <code class="option">peer</code>
   directives in an increasing time interval until it succeeds.
  </p><p>
   If the time server will not be reachable when <code class="systemitem">chronyd</code> is started, you can
   specify the <code class="option">offline</code> option:
  </p><div class="verbatim-wrap"><pre class="screen">server <em class="replaceable ">server_address</em> offline</pre></div><p>
   <code class="systemitem">chronyd</code> will then not try to poll the server until it is enabled using the
   following command:
  </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>chronyc online <em class="replaceable ">server_address</em></pre></div><p>
   When the <code class="option">auto_offline</code> option is set, <code class="systemitem">chronyd</code> assumes that
   the time server has gone offline when 2 requests have been sent to it
   without receiving a response. This option avoids the need to run the
   'offline' command from <code class="command">chronyc</code> when disconnecting the network link.
  </p></div><div class="sect1 " id="sec.netz.xntp.normal"><div class="titlepage"><div><div><h2 class="title" id="sec.netz.xntp.normal"><span class="number">18.5 </span><span class="name">Setting Up a Local Reference Clock</span> <a title="Permalink" class="permalink" href="#sec.netz.xntp.normal">#</a></h2></div></div></div><p>
   The software package <code class="systemitem">chrony</code> relies on other programs (such as
   <code class="systemitem">gpsd</code>) to access the timing data via the SHM or SOCK
   driver. Use the <code class="option">refclock</code> directive in
   <code class="filename">/etc/chrony.conf</code> to specify a hardware reference clock
   to be used as a time source. It has two mandatory parameters; a driver name
   and a driver-specific parameter. The two parameters are followed by zero or
   more <code class="option">refclock</code> options. <code class="systemitem">chronyd</code> includes the following
   drivers:
  </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
     PPS - driver for the kernel 'pulse per second' API. For example:
    </p><div class="verbatim-wrap"><pre class="screen">refclock PPS /dev/pps0 lock NMEA refid GPS</pre></div></li><li class="listitem "><p>
     SHM - NTP shared memory driver. For example:
    </p><div class="verbatim-wrap"><pre class="screen">refclock SHM 0 poll 3 refid GPS1
refclock SHM 1:perm=0644 refid GPS2</pre></div></li><li class="listitem "><p>
     SOCK - Unix domain socket driver. For example:
    </p><div class="verbatim-wrap"><pre class="screen">refclock SOCK /var/run/chrony.ttyS0.sock</pre></div></li><li class="listitem "><p>
     PHC - PTP hardware clock driver. For example:
    </p><div class="verbatim-wrap"><pre class="screen">refclock PHC /dev/ptp0 poll 0 dpoll -2 offset -37
refclock PHC /dev/ptp1:nocrossts poll 3 pps</pre></div></li></ul></div><p>
   For more information on individual drivers' options, see <code class="command">man 8
   chrony.conf</code>.
  </p></div></div><div class="chapter " id="cha.dns"><div class="titlepage"><div><div><h2 class="title"><span class="number">19 </span><span class="name">The Domain Name System</span> <a title="Permalink" class="permalink" href="#cha.dns">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">Filename: </span>net_dns.xml</li><li><span class="ds-label">ID: </span>cha.dns</li></ul></div></div><div><div class="abstract"><div class="abstract-title-wrap"><h6 class="abstract-title">Abstract<a title="Permalink" class="permalink" href="#idm140019137292976">#</a></h6></div><p>
    DNS (domain name system) is needed to resolve the domain names and host
    names into IP addresses. In this way, the IP address 192.168.2.100 is assigned to
    the host name <code class="literal">jupiter</code>, for example. Before setting up your
    own name server, read the general information about DNS in
    <a class="xref" href="#sec.network.nameres" title="13.3. Name Resolution">Section 13.3, “Name Resolution”</a>. The following configuration
    examples refer to BIND, the default DNS server.
   </p></div></div></div></div><div class="line"><div class="toc"><dl><dt><span class="sect1"><a href="#sec.dns.basic"><span class="number">19.1 </span><span class="name">DNS Terminology</span></a></span></dt><dt><span class="sect1"><a href="#sec.dns.install"><span class="number">19.2 </span><span class="name">Installation</span></a></span></dt><dt><span class="sect1"><a href="#sec.dns.yast"><span class="number">19.3 </span><span class="name">Configuration with YaST</span></a></span></dt><dt><span class="sect1"><a href="#sec.dns.bind"><span class="number">19.4 </span><span class="name">Starting the BIND Name Server</span></a></span></dt><dt><span class="sect1"><a href="#sec.dns.named"><span class="number">19.5 </span><span class="name">The /etc/named.conf Configuration File</span></a></span></dt><dt><span class="sect1"><a href="#sec.dns.zonefile"><span class="number">19.6 </span><span class="name">Zone Files</span></a></span></dt><dt><span class="sect1"><a href="#sec.dns.dynupdate"><span class="number">19.7 </span><span class="name">Dynamic Update of Zone Data</span></a></span></dt><dt><span class="sect1"><a href="#sec.dns.tsig"><span class="number">19.8 </span><span class="name">Secure Transactions</span></a></span></dt><dt><span class="sect1"><a href="#sec.dns.dnssec"><span class="number">19.9 </span><span class="name">DNS Security</span></a></span></dt><dt><span class="sect1"><a href="#sec.dns.info"><span class="number">19.10 </span><span class="name">For More Information</span></a></span></dt></dl></div></div><div class="sect1 " id="sec.dns.basic"><div class="titlepage"><div><div><h2 class="title" id="sec.dns.basic"><span class="number">19.1 </span><span class="name">DNS Terminology</span> <a title="Permalink" class="permalink" href="#sec.dns.basic">#</a></h2></div></div></div><div class="variablelist "><dl class="variablelist"><dt id="idm140019137287808"><span class="term ">Zone</span></dt><dd><p>
      The domain name space is divided into regions called zones. For example,
      if you have <code class="literal">example.com</code>, you have the
      <code class="literal">example</code> section (or zone) of the
      <code class="literal">com</code> domain.
     </p></dd><dt id="idm140019137284576"><span class="term ">DNS server</span></dt><dd><p>
      The DNS server is a server that maintains the name and IP information for
      a domain. You can have a primary DNS server for master zone, a secondary
      server for slave zone, or a slave server without any zones for caching.
     </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019137282592"><span class="term ">Master zone DNS server</span></dt><dd><p>
         The master zone includes all hosts from your network and a DNS server
         master zone stores up-to-date records for all the hosts in your
         domain.
        </p></dd><dt id="idm140019137280640"><span class="term ">Slave zone DNS server</span></dt><dd><p>
         A slave zone is a copy of the master zone. The slave zone DNS server
         obtains its zone data with zone transfer operations from its master
         server. The slave zone DNS server responds authoritatively for the
         zone as long as it has valid (not expired) zone data. If the slave
         cannot obtain a new copy of the zone data, it stops responding for the
         zone.
        </p></dd></dl></div></dd><dt id="idm140019137277968"><span class="term ">Forwarder</span></dt><dd><p>
      Forwarders are DNS servers to which your DNS server should send queries
      it cannot answer. To enable different configuration sources in one
      configuration, <code class="literal">netconfig</code> is used (see also
      <code class="command">man 8 netconfig</code>).
     </p></dd><dt id="idm140019137275104"><span class="term ">Record</span></dt><dd><p>
      The record is information about name and IP address. Supported records
      and their syntax are described in BIND documentation. Some special
      records are:
     </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019137273184"><span class="term ">NS record</span></dt><dd><p>
         An NS record tells name servers which machines are in charge of a
         given domain zone.
        </p></dd><dt id="idm140019137271296"><span class="term ">MX record</span></dt><dd><p>
         The MX (mail exchange) records describe the machines to contact for
         directing mail across the Internet.
        </p></dd><dt id="idm140019137269392"><span class="term ">SOA record</span></dt><dd><p>
         SOA (Start of Authority) record is the first record in a zone file.
         The SOA record is used when using DNS to synchronize data between
         multiple computers.
        </p></dd></dl></div></dd></dl></div></div><div class="sect1 " id="sec.dns.install"><div class="titlepage"><div><div><h2 class="title" id="sec.dns.install"><span class="number">19.2 </span><span class="name">Installation</span> <a title="Permalink" class="permalink" href="#sec.dns.install">#</a></h2></div></div></div><p>
   To install a DNS server, start YaST and select
   <span class="guimenu">Software</span> › <span class="guimenu">Software
   Management</span>. Choose
   <span class="guimenu">View</span> › <span class="guimenu">Patterns</span>
   and select <span class="guimenu">DHCP and DNS Server</span>. Confirm the installation
   of the dependent packages to finish the installation process.
  </p><p>
   Alternatively use the following command on the command line:
  </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> zypper in -t pattern dhcp_dns_server</pre></div></div><div class="sect1 " id="sec.dns.yast"><div class="titlepage"><div><div><h2 class="title" id="sec.dns.yast"><span class="number">19.3 </span><span class="name">Configuration with YaST</span> <a title="Permalink" class="permalink" href="#sec.dns.yast">#</a></h2></div></div></div><p>
   Use the YaST DNS module to configure a DNS server for the local network.
   When starting the module for the first time, a wizard starts, prompting you
   to make a few decisions concerning administration of the server. Completing
   this initial setup produces a basic server configuration. Use the expert
   mode to deal with more advanced configuration tasks, such as setting up
   ACLs, logging, TSIG keys, and other options.
  </p><div class="sect2 " id="sec.dns.yast.wizard"><div class="titlepage"><div><div><h3 class="title" id="sec.dns.yast.wizard"><span class="number">19.3.1 </span><span class="name">Wizard Configuration</span> <a title="Permalink" class="permalink" href="#sec.dns.yast.wizard">#</a></h3></div></div></div><p>
    The wizard consists of three steps or dialogs. At the appropriate places in
    the dialogs, you can enter the expert configuration mode.
   </p><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>



      When starting the module for the first time, the <span class="guimenu">Forwarder
      Settings</span> dialog, shown in
      <a class="xref" href="#fig.yast2.dnsinst.forwarders" title="DNS Server Installation: Forwarder Settings">Figure 19.1, “DNS Server Installation: Forwarder Settings”</a>, opens. The <span class="guimenu">Local
      DNS Resolution Policy</span> allows to set the following options:
     </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
        <span class="guimenu">Merging forwarders is disabled</span>

       </p></li><li class="listitem "><p>
        <span class="guimenu">Automatic merging</span>

       </p></li><li class="listitem "><p>
        <span class="guimenu">Merging forwarders is enabled</span>

       </p></li><li class="listitem "><p>

        <span class="guimenu">Custom configuration</span>—If <span class="guimenu">Custom
        configuration</span> is selected, <span class="guimenu">Custom policy</span>
        can be specified; by default (with <span class="guimenu">Automatic merging</span>
        selected), <span class="guimenu">Custom policy</span> is set to
        <code class="literal">auto</code>, but here you can either set interface names or
        select from the two special policy names <code class="literal">STATIC</code> and
        <code class="literal">STATIC_FALLBACK</code>.
       </p></li></ul></div><p>
      In <span class="guimenu">Local DNS Resolution Forwarder</span>, specify which
      service to use: <span class="guimenu">Using system name servers</span>,
      <span class="guimenu">This name server (bind)</span>, or <span class="guimenu">Local dnsmasq
      server</span>.
     </p><p>
      For more information about all these settings, see <code class="command">man 8
      netconfig</code>.
     </p><div class="figure" id="fig.yast2.dnsinst.forwarders"><div class="figure-contents"><div class="mediaobject"><a xmlns="" href="images/yast2_dns_wiz_forw.png"><img src="images/yast2_dns_wiz_forw.png" width="" alt="DNS Server Installation: Forwarder Settings" /></a></div></div><div class="figure-title-wrap"><h6 class="figure-title"><span class="number">Figure 19.1: </span><span class="name">DNS Server Installation: Forwarder Settings </span><a title="Permalink" class="permalink" href="#fig.yast2.dnsinst.forwarders">#</a></h6></div></div><p>
      Forwarders are DNS servers to which your DNS server sends queries it
      cannot answer itself. Enter their IP address and click
      <span class="guimenu">Add</span>.
     </p></li><li class="step "><p>
      The <span class="guimenu">DNS Zones</span> dialog consists of several parts and is
      responsible for the management of zone files, described in
      <a class="xref" href="#sec.dns.zonefile" title="19.6. Zone Files">Section 19.6, “Zone Files”</a>. For a new zone, provide a name for it
      in <span class="guimenu">Name</span>. To add a reverse zone, the name must end in
      <code class="literal">.in-addr.arpa</code>. Finally, select the
      <span class="guimenu">Type</span> (master, slave, or forward). See
      <a class="xref" href="#fig.yast2.dnsinst.zones" title="DNS Server Installation: DNS Zones">Figure 19.2, “DNS Server Installation: DNS Zones”</a>. Click <span class="guimenu">Edit </span>
      to configure other settings of an existing zone. To remove a zone, click
      <span class="guimenu">Delete</span>.
     </p><div class="figure" id="fig.yast2.dnsinst.zones"><div class="figure-contents"><div class="mediaobject"><a xmlns="" href="images/yast2_dns_wiz_zone.png"><img src="images/yast2_dns_wiz_zone.png" width="" alt="DNS Server Installation: DNS Zones" /></a></div></div><div class="figure-title-wrap"><h6 class="figure-title"><span class="number">Figure 19.2: </span><span class="name">DNS Server Installation: DNS Zones </span><a title="Permalink" class="permalink" href="#fig.yast2.dnsinst.zones">#</a></h6></div></div></li><li class="step "><p>
      In the final dialog, you can open the DNS port in the firewall by
      clicking <span class="guimenu">Open Port in Firewall</span>. Then decide whether to
      start the DNS server when booting (<span class="guimenu">On</span> or
      <span class="guimenu">Off</span>). You can also activate LDAP support. See
      <a class="xref" href="#fig.yast2.dnsinst.finish" title="DNS Server Installation: Finish Wizard">Figure 19.3, “DNS Server Installation: Finish Wizard”</a>.
     </p><div class="figure" id="fig.yast2.dnsinst.finish"><div class="figure-contents"><div class="mediaobject"><a xmlns="" href="images/yast2_dns_wiz_finish.png"><img src="images/yast2_dns_wiz_finish.png" width="" alt="DNS Server Installation: Finish Wizard" /></a></div></div><div class="figure-title-wrap"><h6 class="figure-title"><span class="number">Figure 19.3: </span><span class="name">DNS Server Installation: Finish Wizard </span><a title="Permalink" class="permalink" href="#fig.yast2.dnsinst.finish">#</a></h6></div></div></li></ol></div></div></div><div class="sect2 " id="sec.dns.yast.expert"><div class="titlepage"><div><div><h3 class="title" id="sec.dns.yast.expert"><span class="number">19.3.2 </span><span class="name">Expert Configuration</span> <a title="Permalink" class="permalink" href="#sec.dns.yast.expert">#</a></h3></div></div></div><p>
    After starting the module, YaST opens a window displaying several
    configuration options. Completing it results in a DNS server configuration
    with the basic functions in place:
   </p><div class="sect3 " id="sec.dns.yast.expert.startup"><div class="titlepage"><div><div><h4 class="title" id="sec.dns.yast.expert.startup"><span class="number">19.3.2.1 </span><span class="name">Start-Up</span> <a title="Permalink" class="permalink" href="#sec.dns.yast.expert.startup">#</a></h4></div></div></div><p>
     Under <span class="guimenu">Start-Up</span>, define whether the DNS server should be
     started when the booting the system or manually. To start the DNS server
     immediately, click <span class="guimenu">Start DNS Server Now</span>. To stop the
     DNS server, click <span class="guimenu">Stop DNS Server Now</span>. To save the
     current settings, select <span class="guimenu">Save Settings and Reload DNS Server
     Now</span>.

     You can open the DNS port in the firewall with <span class="guimenu">Open Port in
     Firewall</span> and modify the firewall settings with <span class="guimenu">Firewall
     Details</span>.
    </p><p>
     By selecting <span class="guimenu">LDAP Support Active</span>, the zone files are
     managed by an LDAP database. Any changes to zone data written to the LDAP
     database are picked up by the DNS server when it is restarted or prompted
     to reload its configuration.
    </p></div><div class="sect3 " id="sec.dns.yast.expert.forwarders"><div class="titlepage"><div><div><h4 class="title" id="sec.dns.yast.expert.forwarders"><span class="number">19.3.2.2 </span><span class="name">Forwarders</span> <a title="Permalink" class="permalink" href="#sec.dns.yast.expert.forwarders">#</a></h4></div></div></div><p>
     If your local DNS server cannot answer a request, it tries to forward the
     request to a <span class="guimenu">Forwarder</span>, if configured so. This
     forwarder may be added manually to the <span class="guimenu">Forwarder List</span>.
     If the forwarder is not static like in dial-up connections,
     <span class="guimenu">netconfig</span> handles the configuration. For more
     information about netconfig, see <code class="command">man 8 netconfig</code>.
    </p></div><div class="sect3 " id="sec.dns.yast.expert.basics"><div class="titlepage"><div><div><h4 class="title" id="sec.dns.yast.expert.basics"><span class="number">19.3.2.3 </span><span class="name">Basic Options</span> <a title="Permalink" class="permalink" href="#sec.dns.yast.expert.basics">#</a></h4></div></div></div><p>
     In this section, set basic server options. From the
     <span class="guimenu">Option</span> menu, select the desired item then specify the
     value in the corresponding text box. Include the new entry by selecting
     <span class="guimenu">Add</span>.
    </p></div><div class="sect3 " id="sec.dns.yast.expert.logging"><div class="titlepage"><div><div><h4 class="title" id="sec.dns.yast.expert.logging"><span class="number">19.3.2.4 </span><span class="name">Logging</span> <a title="Permalink" class="permalink" href="#sec.dns.yast.expert.logging">#</a></h4></div></div></div><p>
     To set what the DNS server should log and how, select
     <span class="guimenu">Logging</span>. Under <span class="guimenu">Log Type</span>, specify
     where the DNS server should write the log data. Use the system-wide log by
     selecting <span class="guimenu">System Log</span> or specify a different file by
     selecting <span class="guimenu">File</span>. In the latter case, additionally
     specify a name, the maximum file size in megabytes and the number of log
     file versions to store.
    </p><p>
     Further options are available under <span class="guimenu">Additional Logging</span>.
     Enabling <span class="guimenu">Log All DNS Queries</span> causes
     <span class="emphasis"><em>every</em></span> query to be logged, in which case the log file
     could grow extremely large. For this reason, it is not a good idea to
     enable this option for other than debugging purposes. To log the data
     traffic during zone updates between DHCP and DNS server, enable
     <span class="guimenu">Log Zone Updates</span>. To log the data traffic during a zone
     transfer from master to slave, enable <span class="guimenu">Log Zone
     Transfer</span>. See <a class="xref" href="#fig.yast2.dns.logging" title="DNS Server: Logging">Figure 19.4, “DNS Server: Logging”</a>.
    </p><div class="figure" id="fig.yast2.dns.logging"><div class="figure-contents"><div class="mediaobject"><a xmlns="" href="images/yast2_dns_def_logging.png"><img src="images/yast2_dns_def_logging.png" width="" alt="DNS Server: Logging" /></a></div></div><div class="figure-title-wrap"><h6 class="figure-title"><span class="number">Figure 19.4: </span><span class="name">DNS Server: Logging </span><a title="Permalink" class="permalink" href="#fig.yast2.dns.logging">#</a></h6></div></div></div><div class="sect3 " id="sec.dns.yast.expert.acls"><div class="titlepage"><div><div><h4 class="title" id="sec.dns.yast.expert.acls"><span class="number">19.3.2.5 </span><span class="name">ACLs</span> <a title="Permalink" class="permalink" href="#sec.dns.yast.expert.acls">#</a></h4></div></div></div><p>
     Use this dialog to define ACLs (access control lists) to enforce access
     restrictions. After providing a distinct name under
     <span class="guimenu">Name</span>, specify an IP address (with or without netmask)
     under <span class="guimenu">Value</span> in the following fashion:
    </p><div class="verbatim-wrap"><pre class="screen">{ 192.168.1/24; }</pre></div><p>
     The syntax of the configuration file requires that the address ends with a
     semicolon and is put into curly braces.
    </p></div><div class="sect3 " id="sec.dns.yast.expert.tsig"><div class="titlepage"><div><div><h4 class="title" id="sec.dns.yast.expert.tsig"><span class="number">19.3.2.6 </span><span class="name">TSIG Keys</span> <a title="Permalink" class="permalink" href="#sec.dns.yast.expert.tsig">#</a></h4></div></div></div><p>
     The main purpose of TSIGs (transaction signatures) is to secure
     communications between DHCP and DNS servers. They are described in
     <a class="xref" href="#sec.dns.tsig" title="19.8. Secure Transactions">Section 19.8, “Secure Transactions”</a>.
    </p><p>
     To generate a TSIG key, enter a distinctive name in the field labeled
     <span class="guimenu">Key ID</span> and specify the file where the key should be
     stored (<span class="guimenu">Filename</span>). Confirm your choices with
     <span class="guimenu">Generate</span>.
    </p><p>
     To use a previously created key, leave the <span class="guimenu">Key ID</span> field
     blank and select the file where it is stored under
     <span class="guimenu">Filename</span>. After that, confirm with
     <span class="guimenu">Add</span>.
    </p></div><div class="sect3 " id="sec.dns.yast.expert.add_slave"><div class="titlepage"><div><div><h4 class="title" id="sec.dns.yast.expert.add_slave"><span class="number">19.3.2.7 </span><span class="name">DNS Zones (Adding a Slave Zone)</span> <a title="Permalink" class="permalink" href="#sec.dns.yast.expert.add_slave">#</a></h4></div></div></div><p>
     To add a slave zone, select <span class="guimenu">DNS Zones</span>, choose the zone
     type <span class="guimenu">Slave</span>, write the name of the new zone, and click
     <span class="guimenu">Add</span>.
    </p><p>
     In the <span class="guimenu">Zone Editor</span> sub-dialog under <span class="guimenu">Master DNS
     Server IP</span>, specify the master from which the slave should pull
     its data. To limit access to the server, select one of the ACLs from the
     list.

    </p></div><div class="sect3 " id="sec.dns.yast.expert.add_master"><div class="titlepage"><div><div><h4 class="title" id="sec.dns.yast.expert.add_master"><span class="number">19.3.2.8 </span><span class="name">DNS Zones (Adding a Master Zone)</span> <a title="Permalink" class="permalink" href="#sec.dns.yast.expert.add_master">#</a></h4></div></div></div><p>
     To add a master zone, select <span class="guimenu">DNS Zones</span>, choose the zone
     type <span class="guimenu">Master</span>, write the name of the new zone, and click
     <span class="guimenu">Add</span>. When adding a master zone, a reverse zone is also
     needed. For example, when adding the zone
     <code class="systemitem">example.com</code> that points to hosts in a subnet
     <code class="literal">192.168.1.0/24</code>, you should also add a reverse zone for
     the IP-address range covered. By definition, this should be named
     <code class="literal">1.168.192.in-addr.arpa</code>.
    </p></div><div class="sect3 " id="sec.dns.yast.expert.edit_master"><div class="titlepage"><div><div><h4 class="title" id="sec.dns.yast.expert.edit_master"><span class="number">19.3.2.9 </span><span class="name">DNS Zones (Editing a Master Zone)</span> <a title="Permalink" class="permalink" href="#sec.dns.yast.expert.edit_master">#</a></h4></div></div></div><p>
     To edit a master zone, select <span class="guimenu">DNS Zones</span>, select the
     master zone from the table, and click <span class="guimenu">Edit</span>. The dialog
     consists of several pages: <span class="guimenu">Basics</span> (the one opened
     first), <span class="guimenu">NS Records</span>, <span class="guimenu">MX Records</span>,
     <span class="guimenu">SOA</span>, and <span class="guimenu">Records</span>.
    </p><p>
     The basic dialog, shown in <a class="xref" href="#fig.yast2.dns.ddns" title="DNS Server: Zone Editor (Basics)">Figure 19.5, “DNS Server: Zone Editor (Basics)”</a>, lets you
     define settings for dynamic DNS and access options for zone transfers to
     clients and slave name servers. To permit the dynamic updating of zones,
     select <span class="guimenu">Allow Dynamic Updates</span> as well as the
     corresponding TSIG key. The key must have been defined before the update
     action starts. To enable zone transfers, select the corresponding ACLs.
     ACLs must have been defined already.
    </p><p>
     In the <span class="guimenu">Basics</span> dialog, select whether to enable zone
     transfers. Use the listed ACLs to define who can download zones.
    </p><div class="figure" id="fig.yast2.dns.ddns"><div class="figure-contents"><div class="mediaobject"><a xmlns="" href="images/yast2_dns_def_ddns.png"><img src="images/yast2_dns_def_ddns.png" width="" alt="DNS Server: Zone Editor (Basics)" /></a></div></div><div class="figure-title-wrap"><h6 class="figure-title"><span class="number">Figure 19.5: </span><span class="name">DNS Server: Zone Editor (Basics) </span><a title="Permalink" class="permalink" href="#fig.yast2.dns.ddns">#</a></h6></div></div><div class="variablelist "><dl class="variablelist"><dt id="idm140019137154480"><span class="term ">Zone Editor (NS Records)</span></dt><dd><p>
        The <span class="guimenu">NS Records</span> dialog allows you to define
        alternative name servers for the zones specified. Make sure that your
        own name server is included in the list. To add a record, enter its
        name under <span class="guimenu">Name Server to Add</span> then confirm with
        <span class="guimenu">Add</span>. See <a class="xref" href="#fig.yast2.dns.nsrec" title="DNS Server: Zone Editor (NS Records)">Figure 19.6, “DNS Server: Zone Editor (NS Records)”</a>.
       </p><div class="figure" id="fig.yast2.dns.nsrec"><div class="figure-contents"><div class="mediaobject"><a xmlns="" href="images/yast2_dns_def_nsrec.png"><img src="images/yast2_dns_def_nsrec.png" width="" alt="DNS Server: Zone Editor (NS Records)" /></a></div></div><div class="figure-title-wrap"><h6 class="figure-title"><span class="number">Figure 19.6: </span><span class="name">DNS Server: Zone Editor (NS Records) </span><a title="Permalink" class="permalink" href="#fig.yast2.dns.nsrec">#</a></h6></div></div></dd><dt id="idm140019137145120"><span class="term ">Zone Editor (MX Records)</span></dt><dd><p>
        To add a mail server for the current zone to the existing list, enter
        the corresponding address and priority value. After doing so, confirm
        by selecting <span class="guimenu">Add</span>. See
        <a class="xref" href="#fig.yast2.dns.mxrec" title="DNS Server: Zone Editor (MX Records)">Figure 19.7, “DNS Server: Zone Editor (MX Records)”</a>.
       </p><div class="figure" id="fig.yast2.dns.mxrec"><div class="figure-contents"><div class="mediaobject"><a xmlns="" href="images/yast2_dns_def_mxrec.png"><img src="images/yast2_dns_def_mxrec.png" width="" alt="DNS Server: Zone Editor (MX Records)" /></a></div></div><div class="figure-title-wrap"><h6 class="figure-title"><span class="number">Figure 19.7: </span><span class="name">DNS Server: Zone Editor (MX Records) </span><a title="Permalink" class="permalink" href="#fig.yast2.dns.mxrec">#</a></h6></div></div></dd><dt id="idm140019137136704"><span class="term ">Zone Editor (SOA)</span></dt><dd><p>
        This page allows you to create SOA (start of authority) records. For an
        explanation of the individual options, refer to
        <a class="xref" href="#ex.welt.zone" title="The /var/lib/named/example.com.zone File">Example 19.6, “The /var/lib/named/example.com.zone File”</a>. <span class="phrase">Changing SOA
        records is not supported for dynamic zones managed via LDAP.</span>
       </p><div class="figure" id="fig.yast2.dns.soa"><div class="figure-contents"><div class="mediaobject"><a xmlns="" href="images/yast2_dns_def_soa.png"><img src="images/yast2_dns_def_soa.png" width="" alt="DNS Server: Zone Editor (SOA)" /></a></div></div><div class="figure-title-wrap"><h6 class="figure-title"><span class="number">Figure 19.8: </span><span class="name">DNS Server: Zone Editor (SOA) </span><a title="Permalink" class="permalink" href="#fig.yast2.dns.soa">#</a></h6></div></div></dd><dt id="idm140019137128000"><span class="term ">Zone Editor (Records)</span></dt><dd><p>
        This dialog manages name resolution. In <span class="guimenu">Record Key</span>,
        enter the host name then select its type. The <span class="guimenu">A</span> type
        represents the main entry. The value for this should be an IP address
        (IPv4). Use <span class="guimenu">AAAA</span> for IPv6 addresses.
        <span class="guimenu">CNAME</span> is an alias. Use the types
        <span class="guimenu">NS</span> and <span class="guimenu">MX</span> for detailed or partial
        records that expand on the information provided in the <span class="guimenu">NS
        Records</span> and <span class="guimenu">MX Records</span> tabs. These three
        types resolve to an existing <code class="literal">A</code> record.
        <span class="guimenu">PTR</span> is for reverse zones. It is the opposite of an
        <code class="literal">A</code> record, for example:
       </p><div class="verbatim-wrap"><pre class="screen">hostname.example.com. IN A 192.168.0.1
1.0.168.192.in-addr.arpa IN PTR hostname.example.com.</pre></div></dd></dl></div><div class="sect4 " id="sec.dns.yast.expert.edit_master.rev"><div class="titlepage"><div><div><h5 class="title" id="sec.dns.yast.expert.edit_master.rev"><span class="number">19.3.2.9.1 </span><span class="name">Adding Reverse Zones</span> <a title="Permalink" class="permalink" href="#sec.dns.yast.expert.edit_master.rev">#</a></h5></div></div></div><p>
      To add a reverse zone, follow this procedure:
     </p><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
        Start <span class="guimenu">YaST</span> › <span class="guimenu">DNS
        Server</span> › <span class="guimenu">DNS Zones</span>.
       </p></li><li class="step "><p>
        If you have not added a master forward zone, add it and
        <span class="guimenu">Edit</span> it.
       </p></li><li class="step "><p>
        In the <span class="guimenu">Records</span> tab, fill the corresponding
        <span class="guimenu">Record Key</span> and <span class="guimenu">Value</span>, then add
        the record with <span class="guimenu">Add</span> and confirm with
        <span class="guimenu">OK</span>. If YaST complains about a non-existing record
        for a name server, add it in the <span class="guimenu">NS Records</span> tab.
       </p><div class="figure" id="idm140019137111200"><div class="figure-contents"><div class="mediaobject"><a xmlns="" href="images/yast2_dns_revzone1.png"><img src="images/yast2_dns_revzone1.png" width="" alt="Adding a Record for a Master Zone" /></a></div></div><div class="figure-title-wrap"><h6 class="figure-title"><span class="number">Figure 19.9: </span><span class="name">Adding a Record for a Master Zone </span><a title="Permalink" class="permalink" href="#idm140019137111200">#</a></h6></div></div></li><li class="step "><p>
        Back in the <span class="guimenu">DNS Zones</span> window, add a reverse master
        zone.
       </p><div class="figure" id="idm140019137104816"><div class="figure-contents"><div class="mediaobject"><a xmlns="" href="images/yast2_dns_revzone2.png"><img src="images/yast2_dns_revzone2.png" width="" alt="Adding a Reverse Zone" /></a></div></div><div class="figure-title-wrap"><h6 class="figure-title"><span class="number">Figure 19.10: </span><span class="name">Adding a Reverse Zone </span><a title="Permalink" class="permalink" href="#idm140019137104816">#</a></h6></div></div></li><li class="step "><p>
        <span class="guimenu">Edit</span> the reverse zone, and in the
        <span class="guimenu">Records</span> tab, you can see the <span class="guimenu">PTR: Reverse
        translation</span> record type. Add the corresponding
        <span class="guimenu">Record Key</span> and <span class="guimenu">Value</span>, then click
        <span class="guimenu">Add</span> and confirm with <span class="guimenu">OK</span>.
       </p><div class="figure" id="idm140019137095728"><div class="figure-contents"><div class="mediaobject"><a xmlns="" href="images/yast2_dns_revzone3.png"><img src="images/yast2_dns_revzone3.png" width="" alt="Adding a Reverse Record" /></a></div></div><div class="figure-title-wrap"><h6 class="figure-title"><span class="number">Figure 19.11: </span><span class="name">Adding a Reverse Record </span><a title="Permalink" class="permalink" href="#idm140019137095728">#</a></h6></div></div><p>
        Add a name server record if needed.
       </p></li></ol></div></div><div id="idm140019137089936" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.png" /><h6>Tip: Editing the Reverse Zone</h6><p>
       After adding a forward zone, go back to the main menu and select the
       reverse zone for editing. There in the tab <span class="guimenu">Basics</span>
       activate the check box <span class="guimenu">Automatically Generate Records
       From</span> and select your forward zone. That way, all changes to
       the forward zone are automatically updated in the reverse zone.
      </p></div></div></div></div></div><div class="sect1 " id="sec.dns.bind"><div class="titlepage"><div><div><h2 class="title" id="sec.dns.bind"><span class="number">19.4 </span><span class="name">Starting the BIND Name Server</span> <a title="Permalink" class="permalink" href="#sec.dns.bind">#</a></h2></div></div></div><p>
   On a <span class="productname"><span class="phrase">openSUSE® Leap</span></span> system, the name server BIND (<span class="emphasis"><em>Berkeley
   Internet Name Domain</em></span>) comes preconfigured, so it can be started
   right after installation without any problems. Normally, if you already have an Internet connection and entered
   <code class="systemitem">127.0.0.1</code> as the name server
   address for <code class="systemitem">localhost</code> in
   <code class="filename">/etc/resolv.conf</code>, you already have a working
   name resolution without needing to know the DNS of the provider. BIND
   carries out name resolution via the root name server, a notably slower
   process. Normally, the DNS of the provider should be entered with its IP
   address in the configuration file <code class="filename">/etc/named.conf</code> under
   <code class="systemitem">forwarders</code> to ensure effective and secure name
   resolution. If this works so far, the name server runs as a pure
   <span class="emphasis"><em>caching-only</em></span> name server. Only when you configure its
   own zones it becomes a proper DNS. Find a simple example documented in
   <code class="filename">/usr/share/doc/packages/bind/config</code>.
  </p><div id="idm140019137079216" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.png" /><h6>Tip: Automatic Adaptation of the Name Server Information</h6><p>
    Depending on the type of Internet connection or the network connection, the
    name server information can automatically be adapted to the current
    conditions. To do this, set the
    <code class="systemitem">NETCONFIG_DNS_POLICY</code> variable in the
    <code class="filename">/etc/sysconfig/network/config</code> file to
    <code class="literal">auto</code>.
   </p></div><p>
   However, do not set up an official domain until one is assigned to you by
   the responsible institution. Even if you have your own domain and it is
   managed by the provider, you are better off not using it, because BIND would
   otherwise not forward requests for this domain. The Web server at the
   provider, for example, would not be accessible for this domain.
  </p><p>
   To start the name server, enter the command <code class="command">systemctl start
   named</code> as <code class="systemitem">root</code>. Check
   with <code class="command">systemctl status named</code> whether named (as the name
   server process is called) has been started successfully. Test the name
   server immediately on the local system with the <code class="command">host</code> or
   <code class="command">dig</code> programs, which should return
   <code class="systemitem">localhost</code> as the default server
   with the address <code class="systemitem">127.0.0.1</code>. If
   this is not the case, <code class="filename">/etc/resolv.conf</code> probably
   contains an incorrect name server entry or the file does not exist. For the
   first test, enter <code class="command">host</code> <code class="option">127.0.0.1</code>,
   which should always work. If you get an error message, use
   <code class="command">systemctl status named</code> to see whether the server is
   actually running. If the name server does not start or behaves unexpectedly,
   check the output of <code class="command">journalctl -e</code>.
  </p><p>
   To use the name server of the provider (or one already running on your
   network) as the forwarder, enter the corresponding IP address or addresses
   in the <code class="systemitem">options</code> section under
   <code class="systemitem">forwarders</code>. The addresses included in
   <a class="xref" href="#ex.forward" title="Forwarding Options in named.conf">Example 19.1, “Forwarding Options in named.conf”</a> are examples only. Adjust these entries to your
   own setup.
  </p><div class="example" id="ex.forward"><div class="example-title-wrap"><h6 class="example-title"><span class="number">Example 19.1: </span><span class="name">Forwarding Options in named.conf </span><a title="Permalink" class="permalink" href="#ex.forward">#</a></h6></div><div class="example-contents"><div class="verbatim-wrap"><pre class="screen">options {
        directory "/var/lib/named";
        forwarders { 10.11.12.13; 10.11.12.14; };
        listen-on { 127.0.0.1; 192.168.1.116; };
        allow-query { 127/8; 192.168/16 };
        notify no;
};</pre></div></div></div><p>
   The <code class="systemitem">options</code> entry is followed by entries for the
   zone, <code class="systemitem">localhost</code>, and
   <code class="systemitem">0.0.127.in-addr.arpa</code>. The <code class="literal">type
   hint</code> entry under <span class="quote">“<span class="quote">.</span>”</span> should always be present. The
   corresponding files do not need to be modified and should work as they are.
   Also make sure that each entry is closed with a <span class="quote">“<span class="quote">;</span>”</span> and that
   the curly braces are in the correct places. After changing the configuration
   file <code class="filename">/etc/named.conf</code> or the zone files, tell BIND to
   reread them with <code class="command">systemctl reload named</code>. Achieve the same
   by stopping and restarting the name server with <code class="command">systemctl restart
   named</code>. Stop the server at any time by entering <code class="command">systemctl
   stop named</code>.
  </p></div><div class="sect1 " id="sec.dns.named"><div class="titlepage"><div><div><h2 class="title" id="sec.dns.named"><span class="number">19.5 </span><span class="name">The /etc/named.conf Configuration File</span> <a title="Permalink" class="permalink" href="#sec.dns.named">#</a></h2></div></div></div><p>
   All the settings for the BIND name server itself are stored in the
   <code class="filename">/etc/named.conf</code> file. However, the zone data for the
   domains to handle (consisting of the host names, IP addresses, and so on)
   are stored in separate files in the <code class="filename">/var/lib/named</code>
   directory. The details of this are described later.
  </p><p>
   <code class="filename">/etc/named.conf</code> is roughly divided into two areas. One
   is the <code class="systemitem">options</code> section for general settings and the
   other consists of <code class="systemitem">zone</code> entries for the individual
   domains. A <code class="systemitem">logging</code> section and
   <code class="systemitem">acl</code> (access control list) entries are optional.
   Comment lines begin with a <code class="literal">#</code> sign or
   <code class="literal">//</code>. A minimal <code class="filename">/etc/named.conf</code> is
   shown in <a class="xref" href="#ex.named.mini" title="A Basic /etc/named.conf">Example 19.2, “A Basic /etc/named.conf”</a>.
  </p><div class="example" id="ex.named.mini"><div class="example-title-wrap"><h6 class="example-title"><span class="number">Example 19.2: </span><span class="name">A Basic /etc/named.conf </span><a title="Permalink" class="permalink" href="#ex.named.mini">#</a></h6></div><div class="example-contents"><div class="verbatim-wrap"><pre class="screen">options {
        directory "/var/lib/named";
        forwarders { 10.0.0.1; };
        notify no;
};

zone "localhost" in {
       type master;
       file "localhost.zone";
};

zone "0.0.127.in-addr.arpa" in {
        type master;
        file "127.0.0.zone";
};

zone "." in {
        type hint;
        file "root.hint";
};</pre></div></div></div><div class="sect2 " id="sec.dns.named.options"><div class="titlepage"><div><div><h3 class="title" id="sec.dns.named.options"><span class="number">19.5.1 </span><span class="name">Important Configuration Options</span> <a title="Permalink" class="permalink" href="#sec.dns.named.options">#</a></h3></div></div></div><div class="variablelist "><dl class="variablelist"><dt id="idm140019137047408"><span class="term ">directory "<em class="replaceable ">FILENAME</em>";</span></dt><dd><p>
       Specifies the directory in which BIND can find the files containing the
       zone data. Usually, this is <code class="filename">/var/lib/named</code>.
      </p></dd><dt id="idm140019137044624"><span class="term ">forwarders { <em class="replaceable ">IP-ADDRESS</em>; };</span></dt><dd><p>
       Specifies the name servers (mostly of the provider) to which DNS
       requests should be forwarded if they cannot be resolved directly.
       Replace <em class="replaceable ">IP-ADDRESS</em> with an IP address like
       <code class="literal">192.168.1.116</code>.
      </p></dd><dt id="idm140019137041328"><span class="term ">forward first;</span></dt><dd><p>
       Causes DNS requests to be forwarded before an attempt is made to resolve
       them via the root name servers. Instead of <code class="systemitem">forward
       first</code>, <code class="systemitem">forward only</code> can be written
       to have all requests forwarded and none sent to the root name servers.
       This makes sense for firewall configurations.
      </p></dd><dt id="idm140019137038384"><span class="term ">listen-on port 53 { 127.0.0.1; <em class="replaceable ">IP-ADDRESS</em>; };</span></dt><dd><p>
       Tells BIND on which network interfaces and port to accept client
       queries. <code class="literal">port 53</code> does not need to be specified
       explicitly, because <code class="literal">53</code> is the default port. Enter
       <code class="literal">127.0.0.1</code> to permit requests from the local host. If
       you omit this entry entirely, all interfaces are used by default.
      </p></dd><dt id="idm140019137034528"><span class="term ">listen-on-v6 port 53 {any; };</span></dt><dd><p>
       Tells BIND on which port it should listen for IPv6 client requests. The
       only alternative to <code class="literal">any</code> is <code class="literal">none</code>.
       As far as IPv6 is concerned, the server only accepts wild card
       addresses.
      </p></dd><dt id="idm140019137031648"><span class="term ">query-source address * port 53;</span></dt><dd><p>
       This entry is necessary if a firewall is blocking outgoing DNS requests.
       This tells BIND to post requests externally from port 53 and not from
       any of the high ports above 1024.
      </p></dd><dt id="idm140019137029648"><span class="term ">query-source-v6 address * port 53;</span></dt><dd><p>
       Tells BIND which port to use for IPv6 queries.
      </p></dd><dt id="idm140019137027792"><span class="term ">allow-query { 127.0.0.1; <em class="replaceable ">NET</em>; };</span></dt><dd><p>
       Defines the networks from which clients can post DNS requests. Replace
       <em class="replaceable ">NET</em> with address information like
       <code class="literal">192.168.2.0/24</code>. The <code class="systemitem">/24</code> at
       the end is an abbreviated expression for the netmask (in this case
       <code class="systemitem">255.255.255.0</code>).
      </p></dd><dt id="idm140019137023328"><span class="term ">allow-transfer  ! *;;</span></dt><dd><p>
       Controls which hosts can request zone transfers. In the example, such
       requests are completely denied with <code class="systemitem">! *</code>.
       Without this entry, zone transfers can be requested from anywhere
       without restrictions.
      </p></dd><dt id="idm140019137020880"><span class="term ">statistics-interval 0;</span></dt><dd><p>
       In the absence of this entry, BIND generates several lines of
       statistical information per hour in the system's journal. Set it to 0 to
       suppress these statistics completely or set an interval in minutes.
      </p></dd><dt id="idm140019137018880"><span class="term ">cleaning-interval 720;</span></dt><dd><p>
       This option defines at which time intervals BIND clears its cache. This
       triggers an entry in the system's journal each time it occurs. The time
       specification is in minutes. The default is 60 minutes.
      </p></dd><dt id="idm140019137016880"><span class="term ">interface-interval 0;</span></dt><dd><p>
       BIND regularly searches the network interfaces for new or nonexistent
       interfaces. If this value is set to <code class="systemitem">0</code>, this is
       not done and BIND only listens at the interfaces detected at start-up.
       Otherwise, the interval can be defined in minutes. The default is sixty
       minutes.
      </p></dd><dt id="idm140019137014352"><span class="term ">notify no;</span></dt><dd><p>
       <code class="option">no</code> prevents other name servers from being informed when
       changes are made to the zone data or when the name server is restarted.
      </p></dd></dl></div><p>
    For a list of available options, read the manual page <code class="command">man 5
    named.conf</code>.
   </p></div><div class="sect2 " id="sec.dns.named.log"><div class="titlepage"><div><div><h3 class="title" id="sec.dns.named.log"><span class="number">19.5.2 </span><span class="name">Logging</span> <a title="Permalink" class="permalink" href="#sec.dns.named.log">#</a></h3></div></div></div><p>
    What, how, and where logging takes place can be extensively configured in
    BIND. Normally, the default settings should be sufficient.
    <a class="xref" href="#ex.no.log" title="Entry to Disable Logging">Example 19.3, “Entry to Disable Logging”</a>, shows the simplest form of such an entry and
    completely suppresses any logging.
   </p><div class="example" id="ex.no.log"><div class="example-title-wrap"><h6 class="example-title"><span class="number">Example 19.3: </span><span class="name">Entry to Disable Logging </span><a title="Permalink" class="permalink" href="#ex.no.log">#</a></h6></div><div class="example-contents"><div class="verbatim-wrap"><pre class="screen">logging {
        category default { null; };
};</pre></div></div></div></div><div class="sect2 " id="sec.dns.named.zones"><div class="titlepage"><div><div><h3 class="title" id="sec.dns.named.zones"><span class="number">19.5.3 </span><span class="name">Zone Entries</span> <a title="Permalink" class="permalink" href="#sec.dns.named.zones">#</a></h3></div></div></div><div class="example" id="ex.meine.domain"><div class="example-title-wrap"><h6 class="example-title"><span class="number">Example 19.4: </span><span class="name">Zone Entry for example.com </span><a title="Permalink" class="permalink" href="#ex.meine.domain">#</a></h6></div><div class="example-contents"><div class="verbatim-wrap"><pre class="screen">zone "example.com" in {
      type master;
      file "example.com.zone";
      notify no;
};</pre></div></div></div><p>
    After <code class="systemitem">zone</code>, specify the name of the domain to
    administer (<code class="systemitem">example.com</code>)
    followed by <code class="systemitem">in</code> and a block of relevant options
    enclosed in curly braces, as shown in <a class="xref" href="#ex.meine.domain" title="Zone Entry for example.com">Example 19.4, “Zone Entry for example.com”</a>. To
    define a <span class="emphasis"><em>slave zone</em></span>, switch the
    <code class="systemitem">type</code> to <code class="literal">slave</code> and specify a
    name server that administers this zone as <code class="literal">master</code> (which,
    in turn, may be a slave of another master), as shown in
    <a class="xref" href="#ex.andere.domain" title="Zone Entry for example.net">Example 19.5, “Zone Entry for example.net”</a>.
   </p><div class="example" id="ex.andere.domain"><div class="example-title-wrap"><h6 class="example-title"><span class="number">Example 19.5: </span><span class="name">Zone Entry for example.net </span><a title="Permalink" class="permalink" href="#ex.andere.domain">#</a></h6></div><div class="example-contents"><div class="verbatim-wrap"><pre class="screen">zone "example.net" in {
      type slave;
      file "slave/example.net.zone";
      masters { 10.0.0.1; }; 
};</pre></div></div></div><p>
    The zone options:
   </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019136995552"><span class="term ">type master;</span></dt><dd><p>
       By specifying <code class="literal">master</code>, tell BIND that the zone is
       handled by the local name server. This assumes that a zone file has been
       created in the correct format.
      </p></dd><dt id="idm140019136993168"><span class="term ">type slave;</span></dt><dd><p>
       This zone is transferred from another name server. It must be used
       together with <code class="systemitem">masters</code>.
      </p></dd><dt id="idm140019136990848"><span class="term ">type hint;</span></dt><dd><p>
       The zone <code class="literal">.</code> of the <code class="literal">hint</code> type is
       used to set the root name servers. This zone definition can be left as
       is.
      </p></dd><dt id="idm140019136988064"><span class="term ">file <code class="filename">example.com.zone</code> or file
      <span class="quote">“<span class="quote">slave/example.net.zone</span>”</span>;</span></dt><dd><p>
       This entry specifies the file where zone data for the domain is located.
       This file is not required for a slave, because this data is pulled from
       another name server. To differentiate master and slave files, use the
       directory <code class="filename">slave</code> for the slave files.
      </p></dd><dt id="idm140019136984672"><span class="term ">masters { <em class="replaceable ">SERVER_IP_ADDRESS</em>; };</span></dt><dd><p>
       This entry is only needed for slave zones. It specifies from which name
       server the zone file should be transferred.
      </p></dd><dt id="idm140019136982304"><span class="term ">allow-update {! *; };</span></dt><dd><p>
       This option controls external write access, which would allow clients to
       make a DNS entry—something not normally desirable for security
       reasons. Without this entry, zone updates are not allowed. The above
       entry achieves the same because <code class="literal">! *</code> effectively bans
       any such activity.
      </p></dd></dl></div></div></div><div class="sect1 " id="sec.dns.zonefile"><div class="titlepage"><div><div><h2 class="title" id="sec.dns.zonefile"><span class="number">19.6 </span><span class="name">Zone Files</span> <a title="Permalink" class="permalink" href="#sec.dns.zonefile">#</a></h2></div></div></div><p>
   Two types of zone files are needed. One assigns IP addresses to host names
   and the other does the reverse: it supplies a host name for an IP address.
  </p><div id="idm140019136977536" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.png" /><h6>Tip: Using the Dot (Period, Fullstop) in Zone Files</h6><p>
    The <code class="literal">"."</code> has an important meaning in the zone files. If
    host names are given without a final dot (<code class="literal">.</code>), the zone
    is appended. Complete host names specified with a full domain name must end
    with a dot (<code class="literal">.</code>) to avoid having the domain added to it
    again. A missing or wrongly placed "." is probably the most frequent cause
    of name server configuration errors.
   </p></div><p>
   The first case to consider is the zone file
   <code class="filename">example.com.zone</code>, responsible for the domain
   <code class="filename">example.com</code>, shown in
   <a class="xref" href="#ex.welt.zone" title="The /var/lib/named/example.com.zone File">Example 19.6, “The /var/lib/named/example.com.zone File”</a>.
  </p><div class="example" id="ex.welt.zone"><div class="example-title-wrap"><h6 class="example-title"><span class="number">Example 19.6: </span><span class="name">The /var/lib/named/example.com.zone File </span><a title="Permalink" class="permalink" href="#ex.welt.zone">#</a></h6></div><div class="example-contents"><div class="verbatim-wrap"><pre class="screen">1.  $TTL 2D
2.  example.com. IN SOA      dns  root.example.com. ( 
3.               2003072441  ; serial
4.               1D          ; refresh
5.               2H          ; retry
6.               1W          ; expiry
7.               2D )        ; minimum
8.
9.               IN NS       dns 
10.              IN MX       10 mail
11.
12. gate         IN A        192.168.5.1 
13.              IN A        10.0.0.1 
14. dns          IN A        192.168.1.116 
15. mail         IN A        192.168.3.108 
16. jupiter      IN A        192.168.2.100
17. venus        IN A        192.168.2.101
18. saturn       IN A        192.168.2.102
19. mercury      IN A        192.168.2.103
20. ntp          IN CNAME    dns 
21. dns6         IN A6  0    2002:c0a8:174::</pre></div></div></div><div class="variablelist "><dl class="variablelist"><dt id="idm140019136969440"><span class="term ">Line 1:</span></dt><dd><p>
      <code class="systemitem">$TTL</code> defines the default time to live that
      should apply to all the entries in this file. In this example, entries
      are valid for a period of two days (<code class="literal">2 D</code>).
     </p></dd><dt id="idm140019136966608"><span class="term ">Line 2:</span></dt><dd><p>
      This is where the SOA (start of authority) control record begins:
     </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
        The name of the domain to administer is
        <code class="literal">example.com</code> in the first position. This ends
        with <code class="literal">"."</code>, because otherwise the zone would be
        appended a second time. Alternatively, <code class="literal">@</code> can be
        entered here, in which case the zone would be extracted from the
        corresponding entry in <code class="filename">/etc/named.conf</code>.
       </p></li><li class="listitem "><p>
        After <code class="systemitem">IN SOA</code> is the name of the name server in
        charge as master for this zone. The name is expanded from
        <code class="literal">dns</code> to <code class="literal">dns.example.com</code>, because it does
        not end with a <code class="literal">"."</code>.
       </p></li><li class="listitem "><p>
        An e-mail address of the person in charge of this name server follows.
        Because the <code class="literal">@</code> sign already has a special meaning,
        <code class="literal">"."</code> is entered here instead. For
        <code class="systemitem">root@example.com</code> the entry must read
        <code class="systemitem">root.example.com.</code>. The
        <code class="literal">"."</code> must be included at the end to prevent the zone
        from being added.
       </p></li><li class="listitem "><p>
        The <code class="literal">(</code> includes all lines up to <code class="literal">)</code>
        into the SOA record.
       </p></li></ul></div></dd><dt id="idm140019136952848"><span class="term ">Line 3:</span></dt><dd><p>
      The <code class="systemitem">serial number</code> is an arbitrary number that is
      increased each time this file is changed. It is needed to inform the
      secondary name servers (slave servers) of changes. For this, a 10 digit
      number of the date and run number, written as YYYYMMDDNN, has become the
      customary format.
     </p></dd><dt id="idm140019136950336"><span class="term ">Line 4:</span></dt><dd><p>
      The <code class="systemitem">refresh rate</code> specifies the time interval at
      which the secondary name servers verify the zone <code class="systemitem">serial
      number</code>. In this case, one day.
     </p></dd><dt id="idm140019136947568"><span class="term ">Line 5:</span></dt><dd><p>
      The <code class="systemitem">retry rate</code> specifies the time interval at
      which a secondary name server, in case of error, attempts to contact the
      primary server again. Here, two hours.
     </p></dd><dt id="idm140019136945184"><span class="term ">Line 6:</span></dt><dd><p>
      The <code class="systemitem">expiration time</code> specifies the time frame
      after which a secondary name server discards the cached data if it has
      not regained contact to the primary server. Here, a week.
     </p></dd><dt id="idm140019136942784"><span class="term ">Line 7:</span></dt><dd><p>
      The last entry in the SOA record specifies the <code class="systemitem">negative
      caching TTL</code>—the time for which results of unresolved
      DNS queries from other servers may be cached.
     </p></dd><dt id="idm140019136940416"><span class="term ">Line 9:</span></dt><dd><p>
      The <code class="systemitem">IN NS</code> specifies the name server responsible
      for this domain. <code class="systemitem">dns</code> is extended to
      <code class="systemitem">dns.example.com</code> because it does not end with a
      <code class="literal">"."</code>. There can be several lines like this—one
      for the primary and one for each secondary name server. If
      <code class="systemitem">notify</code> is not set to <code class="option">no</code> in
      <code class="filename">/etc/named.conf</code>, all the name servers listed here
      are informed of the changes made to the zone data.
     </p></dd><dt id="idm140019136935248"><span class="term ">Line 10:</span></dt><dd><p>
      The MX record specifies the mail server that accepts, processes, and
      forwards e-mails for the domain
      <code class="systemitem">example.com</code>. In this
      example, this is the host
      <code class="systemitem">mail.example.com</code>. The number in
      front of the host name is the preference value. If there are multiple MX
      entries, the mail server with the smallest value is taken first. If
      mail delivery to this server fails, the next entry with
      higher value is used.
     </p></dd><dt id="idm140019136931616"><span class="term ">Lines 12–19:</span></dt><dd><p>
      These are the actual address records where one or more IP addresses are
      assigned to host names. The names are listed here without a
      <code class="literal">"."</code> because they do not include their domain, so
      <code class="systemitem">example.com</code> is added to
      all of them. Two IP addresses are assigned to the host
      <code class="systemitem">gate</code>, as it has two network cards.


      Wherever the host address is a traditional one (IPv4), the record is
      marked with <code class="literal">A</code>. If the address is an IPv6 address, the
      entry is marked with <code class="literal">AAAA</code>.

     </p><div id="idm140019136927248" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note: IPv6 Syntax</h6><p>
       The IPv6 record has a slightly different syntax than IPv4. Because of
       the fragmentation possibility, it is necessary to provide information
       about missed bits before the address. To fill up the IPv6 address with
       the needed number of <span class="quote">“<span class="quote">0</span>”</span>, add two colons at the correct
       place in the address.

      </p><div class="verbatim-wrap"><pre class="screen">pluto     AAAA 2345:00C1:CA11::1234:5678:9ABC:DEF0
pluto     AAAA 2345:00D2:DA11::1234:5678:9ABC:DEF0</pre></div></div></dd><dt id="idm140019136924320"><span class="term ">Line 20:</span></dt><dd><p>
      The alias <code class="literal">ntp</code> can be used to address

      <code class="literal">dns</code> (<code class="systemitem">CNAME</code> means

      <span class="emphasis"><em>canonical name</em></span>).
     </p></dd></dl></div><p>
   The pseudo domain <code class="literal">in-addr.arpa</code> is used for the reverse
   lookup of IP addresses into host names. It is appended to the network part
   of the address in reverse notation. So
   <code class="systemitem">192.168</code> is resolved into
   <code class="systemitem">168.192.in-addr.arpa</code>. See
   <a class="xref" href="#dat.arpa" title="Reverse Lookup">Example 19.7, “Reverse Lookup”</a>.
  </p><div class="example" id="dat.arpa"><div class="example-title-wrap"><h6 class="example-title"><span class="number">Example 19.7: </span><span class="name">Reverse Lookup </span><a title="Permalink" class="permalink" href="#dat.arpa">#</a></h6></div><div class="example-contents"><div class="verbatim-wrap"><pre class="screen">1.  $TTL 2D
2.  168.192.in-addr.arpa.   IN SOA dns.example.com. root.example.com. (
3.                          2003072441      ; serial
4.                          1D              ; refresh
5.                          2H              ; retry
6.                          1W              ; expiry
7.                          2D )            ; minimum
8.
9.                          IN NS           dns.example.com.
10.
11. 1.5                     IN PTR          gate.example.com. 
12. 100.3                   IN PTR          www.example.com. 
13. 253.2                   IN PTR          cups.example.com.</pre></div></div></div><div class="variablelist "><dl class="variablelist"><dt id="idm140019136914880"><span class="term ">Line 1:</span></dt><dd><p>
      $TTL defines the standard TTL that applies to all entries here.
     </p></dd><dt id="idm140019136913024"><span class="term ">Line 2:</span></dt><dd><p>

      The configuration file should activate reverse lookup for the network
      <code class="systemitem">192.168</code>. Given

      that the zone is called <code class="systemitem">168.192.in-addr.arpa</code>, it
      should not be added to the host names. Therefore, all host names are
      entered in their complete form—with their domain and with a
      <code class="literal">"."</code> at the end. The remaining entries correspond to
      those described for the previous <code class="systemitem">example.com</code>
      example.
     </p></dd><dt id="idm140019136908864"><span class="term ">Lines 3–7:</span></dt><dd><p>
      See the previous example for <code class="systemitem">example.com</code>.
     </p></dd><dt id="idm140019136906608"><span class="term ">Line 9:</span></dt><dd><p>
      Again this line specifies the name server responsible for this zone. This
      time, however, the name is entered in its complete form with the domain
      and a <code class="literal">"."</code> at the end.
     </p></dd><dt id="idm140019136904208"><span class="term ">Lines 11–13:</span></dt><dd><p>
      These are the pointer records hinting at the IP addresses on the
      respective hosts. Only the last part of the IP address is entered at the
      beginning of the line, without the <code class="literal">"."</code> at the end.
      Appending the zone to this (without the
      <code class="systemitem">.in-addr.arpa</code>) results in the complete IP
      address in reverse order.
     </p></dd></dl></div><p>
   Normally, zone transfers between different versions of BIND should be
   possible without any problems.
  </p></div><div class="sect1 " id="sec.dns.dynupdate"><div class="titlepage"><div><div><h2 class="title" id="sec.dns.dynupdate"><span class="number">19.7 </span><span class="name">Dynamic Update of Zone Data</span> <a title="Permalink" class="permalink" href="#sec.dns.dynupdate">#</a></h2></div></div></div><p>
   The term <span class="emphasis"><em>dynamic update</em></span> refers to operations by which
   entries in the zone files of a master server are added, changed, or deleted.
   This mechanism is described in RFC 2136. Dynamic update is configured
   individually for each zone entry by adding an optional
   <code class="systemitem">allow-update</code> or
   <code class="systemitem">update-policy</code> rule. Zones to update dynamically
   should not be edited by hand.
  </p><p>
   Transmit the entries to update to the server with the command
   <code class="command">nsupdate</code>. For the exact syntax of this command, check the
   manual page for nsupdate (<code class="command">man</code> <code class="option">8
   nsupdate</code>). For security reasons, any such update should be
   performed using TSIG keys as described in <a class="xref" href="#sec.dns.tsig" title="19.8. Secure Transactions">Section 19.8, “Secure Transactions”</a>.
  </p></div><div class="sect1 " id="sec.dns.tsig"><div class="titlepage"><div><div><h2 class="title" id="sec.dns.tsig"><span class="number">19.8 </span><span class="name">Secure Transactions</span> <a title="Permalink" class="permalink" href="#sec.dns.tsig">#</a></h2></div></div></div><p>
   Secure transactions can be made with transaction signatures (TSIGs) based on
   shared secret keys (also called TSIG keys). This section describes how to
   generate and use such keys.
  </p><p>
   Secure transactions are needed for communication between different servers
   and for the dynamic update of zone data. Making the access control dependent
   on keys is much more secure than merely relying on IP addresses.
  </p><p>
   Generate a TSIG key with the following command (for details, see
   <code class="command">man</code> <code class="option">dnssec-keygen</code>):
  </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> dnssec-keygen -a hmac-md5 -b 128 -n HOST host1-host2</pre></div><p>
   This creates two files with names similar to these:
  </p><div class="verbatim-wrap"><pre class="screen">Khost1-host2.+157+34265.private Khost1-host2.+157+34265.key</pre></div><p>
   The key itself (a string like <code class="literal">ejIkuCyyGJwwuN3xAteKgg==</code>)
   is found in both files. To use it for transactions, the second file
   (<code class="filename">Khost1-host2.+157+34265.key</code>) must be transferred to
   the remote host, preferably in a secure way (using scp, for example). On the
   remote server, the key must be included in the
   <code class="filename">/etc/named.conf</code> file to enable a secure communication
   between <code class="literal">host1</code> and <code class="literal">host2</code>:
  </p><div class="verbatim-wrap"><pre class="screen">key host1-host2 {
 algorithm hmac-md5;
 secret "ejIkuCyyGJwwuN3xAteKgg==";
};</pre></div><div id="idm140019136885040" class="admonition warning normal"><img class="symbol" alt="Warning" title="Warning" src="static/images/icon-warning.png" /><h6>Warning: File Permissions of <code class="filename">/etc/named.conf</code></h6><p>
    Make sure that the permissions of <code class="filename">/etc/named.conf</code> are
    properly restricted. The default for this file is <code class="literal">0640</code>,
    with the owner being <code class="systemitem">root</code> and the
    group <code class="systemitem">named</code>. As an alternative,
    move the keys to an extra file with specially limited permissions, which is
    then included from <code class="filename">/etc/named.conf</code>. To include an
    external file, use:
   </p><div class="verbatim-wrap"><pre class="screen">include  "filename"</pre></div><p>
    Replace <code class="option">filename</code> with an absolute path to your file with
    keys.
   </p></div><p>





   To enable the server <code class="literal">host1</code> to use the key for
   <code class="literal">host2</code> (which has the address <code class="literal">10.1.2.3</code>
   in this example), the server's <code class="filename">/etc/named.conf</code> must
   include the following rule:
  </p><div class="verbatim-wrap"><pre class="screen">server 10.1.2.3 {
  keys { host1-host2. ;};
};</pre></div><p>
   Analogous entries must be included in the configuration files of
   <code class="literal">host2</code>.
  </p><p>
   Add TSIG keys for any ACLs (access control lists, not to be confused with
   file system ACLs) that are defined for IP addresses and address ranges to
   enable transaction security. The corresponding entry could look like this:
  </p><div class="verbatim-wrap"><pre class="screen">allow-update { key host1-host2. ;};</pre></div><p>
   This topic is discussed in more detail in the <span class="emphasis"><em>BIND Administrator
   Reference Manual</em></span> under <code class="literal">update-policy</code>.
  </p></div><div class="sect1 " id="sec.dns.dnssec"><div class="titlepage"><div><div><h2 class="title" id="sec.dns.dnssec"><span class="number">19.9 </span><span class="name">DNS Security</span> <a title="Permalink" class="permalink" href="#sec.dns.dnssec">#</a></h2></div></div></div><p>
   DNSSEC, or DNS security, is described in RFC 2535. The tools available
   for DNSSEC are discussed in the BIND Manual.
  </p><p>
   A zone considered secure must have one or several zone keys associated with
   it. These are generated with <code class="command">dnssec-keygen</code>, as are the
   host keys. The DSA encryption algorithm is currently used to generate these
   keys. The public keys generated should be included in the corresponding zone
   file with an <code class="systemitem">$INCLUDE</code> rule.
  </p><p>
   With the command <code class="command">dnssec-signzone</code>, you can create sets of
   generated keys (<code class="literal">keyset-</code> files), transfer them to the
   parent zone in a secure manner, and sign them. This generates the files to
   include for each zone in <code class="filename">/etc/named.conf</code>.
  </p></div><div class="sect1 " id="sec.dns.info"><div class="titlepage"><div><div><h2 class="title" id="sec.dns.info"><span class="number">19.10 </span><span class="name">For More Information</span> <a title="Permalink" class="permalink" href="#sec.dns.info">#</a></h2></div></div></div><p>
   For more information, see the <span class="emphasis"><em>BIND Administrator Reference
   Manual</em></span> from the
   <code class="systemitem">bind-doc</code> package, which is
   installed under <code class="filename">/usr/share/doc/packages/bind/arm</code>.
   Consider additionally consulting the RFCs referenced by the manual and the
   manual pages included with BIND.
   <code class="filename">/usr/share/doc/packages/bind/README.SUSE</code> contains
   up-to-date information about BIND in <span class="productname"><span class="phrase">openSUSE Leap</span></span>.
  </p></div></div><div class="chapter " id="cha.dhcp"><div class="titlepage"><div><div><h2 class="title"><span class="number">20 </span><span class="name">DHCP</span> <a title="Permalink" class="permalink" href="#cha.dhcp">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">Filename: </span>net_dhcp.xml</li><li><span class="ds-label">ID: </span>cha.dhcp</li></ul></div></div><div><div class="abstract"><div class="abstract-title-wrap"><h6 class="abstract-title">Abstract<a title="Permalink" class="permalink" href="#idm140019136859136">#</a></h6></div><p>
    The purpose of the <span class="emphasis"><em>Dynamic Host Configuration Protocol</em></span>
    (DHCP) is to assign network settings centrally (from a server) rather than
    configuring them locally on every workstation. A host configured to use
    DHCP does not have control over its own static address. It is enabled to
    configure itself completely and automatically according to directions from
    the server. If you use the NetworkManager on the client side, you do not need to
    configure the client. This is useful if you have changing environments and
    only one interface active at a time. Never use NetworkManager on a machine that runs
    a DHCP server.
   </p></div></div></div></div><div class="line"><div class="toc"><dl><dt><span class="sect1"><a href="#sec.dhcp.yast"><span class="number">20.1 </span><span class="name">Configuring a DHCP Server with YaST</span></a></span></dt><dt><span class="sect1"><a href="#sec.dhcp.soft"><span class="number">20.2 </span><span class="name">DHCP Software Packages</span></a></span></dt><dt><span class="sect1"><a href="#sec.dhcp.server"><span class="number">20.3 </span><span class="name">The DHCP Server dhcpd</span></a></span></dt><dt><span class="sect1"><a href="#sec.dhcp.addinfo"><span class="number">20.4 </span><span class="name">For More Information</span></a></span></dt></dl></div></div><p>
  One way to configure a DHCP server is to identify each client using the
  hardware address of its network card (which should be fixed in most cases),
  then supply that client with identical settings each time it connects to the
  server. DHCP can also be configured to assign addresses to each relevant
  client dynamically from an address pool set up for this purpose. In the
  latter case, the DHCP server tries to assign the same address to the client
  each time it receives a request, even over extended periods. This works only
  if the network does not have more clients than addresses.
 </p><p>
  DHCP makes life easier for system administrators. Any changes, even bigger
  ones, related to addresses and the network configuration in general can be
  implemented centrally by editing the server's configuration file. This is
  much more convenient than reconfiguring numerous workstations. It is also
  much easier to integrate machines, particularly new machines, into the
  network, because they can be given an IP address from the pool. Retrieving
  the appropriate network settings from a DHCP server is especially useful in
  case of laptops regularly used in different networks.
 </p><p>
  In this chapter, the DHCP server will run in the same subnet as the
  workstations, <code class="systemitem">192.168.2.0/24</code> with
  <code class="systemitem">192.168.2.1</code> as gateway. It has
  the fixed IP address <code class="systemitem">192.168.2.254</code> and
  serves two address ranges,
  <code class="systemitem">192.168.2.10</code> to
  <code class="systemitem">192.168.2.20</code> and
  <code class="systemitem">192.168.2.100</code> to
  <code class="systemitem">192.168.2.200</code>.
 </p><p>
  A DHCP server supplies not only the IP address and the netmask, but also the
  host name, domain name, gateway, and name server addresses for the client to
  use. In addition to that, DHCP allows several other parameters to be
  configured in a centralized way, for example, a time server from which
  clients may poll the current time or even a print server.
 </p><div class="sect1 " id="sec.dhcp.yast"><div class="titlepage"><div><div><h2 class="title" id="sec.dhcp.yast"><span class="number">20.1 </span><span class="name">Configuring a DHCP Server with YaST</span> <a title="Permalink" class="permalink" href="#sec.dhcp.yast">#</a></h2></div></div></div><p>
   To install a DHCP server, start YaST and select
   <span class="guimenu">Software</span> › <span class="guimenu">Software
   Management</span>. Choose
   <span class="guimenu">Filter</span> › <span class="guimenu">Patterns</span> and select <span class="guimenu">DHCP and DNS
   Server</span>. Confirm the installation of the dependent packages to
   finish the installation process.
  </p><div id="idm140019136843008" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.png" /><h6>Important: LDAP Support</h6><p>
    The YaST DHCP module can be set up to store the server configuration
    locally (on the host that runs the DHCP server) or to have its
    configuration data managed by an LDAP server. To use LDAP, set
    up your LDAP environment before configuring the DHCP server.
   </p><p>
    For more information about LDAP, see <span class="intraxref">Book “<em class="citetitle ">Security Guide</em>”, Chapter 5 “LDAP—A Directory Service”</span>.
   </p></div><p>
   The YaST DHCP module (<code class="systemitem">yast2-dhcp-server</code>) allows
   you to set up your own DHCP server for the local network. The module can run
   in wizard mode or expert configuration mode.
  </p><div class="sect2 " id="sec.dhcp.yast.init"><div class="titlepage"><div><div><h3 class="title" id="sec.dhcp.yast.init"><span class="number">20.1.1 </span><span class="name">Initial Configuration (Wizard)</span> <a title="Permalink" class="permalink" href="#sec.dhcp.yast.init">#</a></h3></div></div></div><p>
    When the module is started for the first time, a wizard starts, prompting
    you to make a few basic decisions concerning server administration.
    Completing this initial setup produces a very basic server configuration
    that should function in its essential aspects. The expert mode can be used
    to deal with more advanced configuration tasks. Proceed as follows:
   </p><div class="procedure " id="pro.dhcp.yast.init"><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
      Select the interface from the list to which the DHCP server should listen
      and click <span class="guimenu">Select</span>. After this, select <span class="guimenu">Open
      Firewall for Selected Interfaces</span> to open the firewall for this
      interface, and click <span class="guimenu">Next</span>. See
      <a class="xref" href="#fig.yast2.dhcp.wiz1" title="DHCP Server: Card Selection">Figure 20.1, “DHCP Server: Card Selection”</a>.
     </p><div class="figure" id="fig.yast2.dhcp.wiz1"><div class="figure-contents"><div class="mediaobject"><a xmlns="" href="images/yast2_dhcp_wiz1.png"><img src="images/yast2_dhcp_wiz1.png" width="" alt="DHCP Server: Card Selection" /></a></div></div><div class="figure-title-wrap"><h6 class="figure-title"><span class="number">Figure 20.1: </span><span class="name">DHCP Server: Card Selection </span><a title="Permalink" class="permalink" href="#fig.yast2.dhcp.wiz1">#</a></h6></div></div></li><li class="step "><p>
      Use the check box to determine whether your DHCP settings should be
      automatically stored by an LDAP server. In the text boxes, provide the
      network specifics for all clients the DHCP server should manage. These
      specifics are the domain name, address of a time server, addresses of the
      primary and secondary name server, addresses of a print and a WINS server
      (for a mixed network with both Windows and Linux clients), gateway
      address, and lease time. See <a class="xref" href="#fig.yast2.dhcp.wiz2" title="DHCP Server: Global Settings">Figure 20.2, “DHCP Server: Global Settings”</a>.
     </p><div class="figure" id="fig.yast2.dhcp.wiz2"><div class="figure-contents"><div class="mediaobject"><a xmlns="" href="images/yast2_dhcp_wiz2.png"><img src="images/yast2_dhcp_wiz2.png" width="" alt="DHCP Server: Global Settings" /></a></div></div><div class="figure-title-wrap"><h6 class="figure-title"><span class="number">Figure 20.2: </span><span class="name">DHCP Server: Global Settings </span><a title="Permalink" class="permalink" href="#fig.yast2.dhcp.wiz2">#</a></h6></div></div></li><li class="step "><p>
      Configure how dynamic IP addresses should be assigned to clients. To do
      so, specify an IP range from which the server can assign addresses to
      DHCP clients. All these addresses must be covered by the same netmask.
      Also specify the lease time during which a client may keep its IP address
      without needing to request an extension of the lease. Optionally, specify
      the maximum lease time—the period during which the server reserves
      an IP address for a particular client. See
      <a class="xref" href="#fig.yast2.dhcp.wiz3" title="DHCP Server: Dynamic DHCP">Figure 20.3, “DHCP Server: Dynamic DHCP”</a>.
     </p><div class="figure" id="fig.yast2.dhcp.wiz3"><div class="figure-contents"><div class="mediaobject"><a xmlns="" href="images/yast2_dhcp_wiz3.png"><img src="images/yast2_dhcp_wiz3.png" width="" alt="DHCP Server: Dynamic DHCP" /></a></div></div><div class="figure-title-wrap"><h6 class="figure-title"><span class="number">Figure 20.3: </span><span class="name">DHCP Server: Dynamic DHCP </span><a title="Permalink" class="permalink" href="#fig.yast2.dhcp.wiz3">#</a></h6></div></div></li><li class="step "><p>
      Define how the DHCP server should be started. Specify whether to start
      the DHCP server automatically when the system is booted or manually when
      needed (for example, for testing purposes). Click
      <span class="guimenu">Finish</span> to complete the configuration of the server.
      See <a class="xref" href="#fig.yast2.dhcp.start" title="DHCP Server: Start-Up">Figure 20.4, “DHCP Server: Start-Up”</a>.

     </p><div class="figure" id="fig.yast2.dhcp.start"><div class="figure-contents"><div class="mediaobject"><a xmlns="" href="images/yast2_dhcp_start.png"><img src="images/yast2_dhcp_start.png" width="" alt="DHCP Server: Start-Up" /></a></div></div><div class="figure-title-wrap"><h6 class="figure-title"><span class="number">Figure 20.4: </span><span class="name">DHCP Server: Start-Up </span><a title="Permalink" class="permalink" href="#fig.yast2.dhcp.start">#</a></h6></div></div></li><li class="step "><p>
      Instead of using dynamic DHCP in the way described in the preceding
      steps, you can also configure the server to assign addresses in
      quasi-static fashion. Use the text boxes provided in the lower part to
      specify a list of the clients to manage in this way. Specifically,
      provide the <span class="guimenu">Name</span> and the <span class="guimenu">IP Address</span>
      to give to such a client, the <span class="guimenu">Hardware Address</span>, and
      the <span class="guimenu">Network Type</span> (token ring or Ethernet). Modify the
      list of clients, which is shown in the upper part with
      <span class="guimenu">Add</span>, <span class="guimenu">Edit</span>, and <span class="guimenu">Delete from
      List</span>. See <a class="xref" href="#fig.yast2.dhcp.statdhcp" title="DHCP Server: Host Management">Figure 20.5, “DHCP Server: Host Management”</a>.
     </p><div class="figure" id="fig.yast2.dhcp.statdhcp"><div class="figure-contents"><div class="mediaobject"><a xmlns="" href="images/yast2_dhcp_statdhcp.png"><img src="images/yast2_dhcp_statdhcp.png" width="" alt="DHCP Server: Host Management" /></a></div></div><div class="figure-title-wrap"><h6 class="figure-title"><span class="number">Figure 20.5: </span><span class="name">DHCP Server: Host Management </span><a title="Permalink" class="permalink" href="#fig.yast2.dhcp.statdhcp">#</a></h6></div></div></li></ol></div></div></div><div class="sect2 " id="sec.dhcp.yast.expert"><div class="titlepage"><div><div><h3 class="title" id="sec.dhcp.yast.expert"><span class="number">20.1.2 </span><span class="name">DHCP Server Configuration (Expert)</span> <a title="Permalink" class="permalink" href="#sec.dhcp.yast.expert">#</a></h3></div></div></div><p>
    In addition to the configuration method discussed earlier, there is also an
    expert configuration mode that allows you to change the DHCP server setup
    in every detail. Start the expert configuration by clicking <span class="guimenu">DHCP
    Server Expert Configuration</span> in the <span class="guimenu">Start-Up</span>
    dialog (see <a class="xref" href="#fig.yast2.dhcp.start" title="DHCP Server: Start-Up">Figure 20.4, “DHCP Server: Start-Up”</a>).
   </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019136790352"><span class="term ">Chroot Environment and Declarations</span></dt><dd><p>
       In this first dialog, make the existing configuration editable by
       selecting <span class="guimenu">Start DHCP Server</span>. An important feature of
       the behavior of the DHCP server is its ability to run in a chroot
       environment, or chroot jail, to secure the server host. If the DHCP
       server should ever be compromised by an outside attack, the attacker
       will still be in the chroot jail, which prevents him from
       accessing the rest of the system. The lower part of the dialog displays a
       tree view with the declarations that have already been defined. Modify
       these with <span class="guimenu">Add</span>, <span class="guimenu">Delete</span>, and
       <span class="guimenu">Edit</span>. Selecting <span class="guimenu">Advanced</span> takes you
       to additional expert dialogs. See
       <a class="xref" href="#fig.yast2.dhcp.chroot" title="DHCP Server: Chroot Jail and Declarations">Figure 20.6, “DHCP Server: Chroot Jail and Declarations”</a>. After selecting
       <span class="guimenu">Add</span>, define the type of declaration to add. With
       <span class="guimenu">Advanced</span>, view the log file of the server, configure
       TSIG key management, and adjust the configuration of the firewall
       according to the setup of the DHCP server.
      </p><div class="figure" id="fig.yast2.dhcp.chroot"><div class="figure-contents"><div class="mediaobject"><a xmlns="" href="images/yast2_dhcp_chroot.png"><img src="images/yast2_dhcp_chroot.png" width="" alt="DHCP Server: Chroot Jail and Declarations" /></a></div></div><div class="figure-title-wrap"><h6 class="figure-title"><span class="number">Figure 20.6: </span><span class="name">DHCP Server: Chroot Jail and Declarations </span><a title="Permalink" class="permalink" href="#fig.yast2.dhcp.chroot">#</a></h6></div></div></dd><dt id="idm140019136778576"><span class="term ">Selecting the Declaration Type</span></dt><dd><p>
       The <span class="guimenu">Global Options</span> of the DHCP server are made up of
       several declarations. This dialog lets you set the declaration types
       <span class="guimenu">Subnet</span>, <span class="guimenu">Host</span>, <span class="guimenu">Shared
       Network</span>, <span class="guimenu">Group</span>, <span class="guimenu">Pool of
       Addresses</span>, and <span class="guimenu">Class</span>. This example shows
       the selection of a new subnet (see
       <a class="xref" href="#fig.yast2.dhcp.newdec" title="DHCP Server: Selecting a Declaration Type">Figure 20.7, “DHCP Server: Selecting a Declaration Type”</a>).
      </p><div class="figure" id="fig.yast2.dhcp.newdec"><div class="figure-contents"><div class="mediaobject"><a xmlns="" href="images/yast2_dhcp_newdec.png"><img src="images/yast2_dhcp_newdec.png" width="" alt="DHCP Server: Selecting a Declaration Type" /></a></div></div><div class="figure-title-wrap"><h6 class="figure-title"><span class="number">Figure 20.7: </span><span class="name">DHCP Server: Selecting a Declaration Type </span><a title="Permalink" class="permalink" href="#fig.yast2.dhcp.newdec">#</a></h6></div></div></dd><dt id="idm140019136767520"><span class="term ">Subnet Configuration</span></dt><dd><p>
       This dialog allows you specify a new subnet with its IP address and
       netmask. In the middle part of the dialog, modify the DHCP server start
       options for the selected subnet using <span class="guimenu">Add</span>,
       <span class="guimenu">Edit</span>, and <span class="guimenu">Delete</span>. To set up
       dynamic DNS for the subnet, select <span class="guimenu">Dynamic DNS</span>.
      </p><div class="figure" id="fig.yast2.dhcp.sub"><div class="figure-contents"><div class="mediaobject"><a xmlns="" href="images/yast2_dhcp_sub.png"><img src="images/yast2_dhcp_sub.png" width="" alt="DHCP Server: Configuring Subnets" /></a></div></div><div class="figure-title-wrap"><h6 class="figure-title"><span class="number">Figure 20.8: </span><span class="name">DHCP Server: Configuring Subnets </span><a title="Permalink" class="permalink" href="#fig.yast2.dhcp.sub">#</a></h6></div></div></dd><dt id="idm140019136758272"><span class="term ">TSIG Key Management</span></dt><dd><p>
       If you chose to configure dynamic DNS in the previous dialog, you can
       now configure the key management for a secure zone transfer. Selecting
       <span class="guimenu">OK</span> takes you to another dialog in which to configure
       the interface for dynamic DNS (see
       <a class="xref" href="#fig.yast2.dhcp.dyndns" title="DHCP Server: Interface Configuration for Dynamic DNS">Figure 20.10, “DHCP Server: Interface Configuration for Dynamic DNS”</a>).
      </p><div class="figure" id="fig.yast2.dhcp.tsig"><div class="figure-contents"><div class="mediaobject"><a xmlns="" href="images/yast2_dhcp_tsig.png"><img src="images/yast2_dhcp_tsig.png" width="" alt="DHCP Server: TSIG Configuration" /></a></div></div><div class="figure-title-wrap"><h6 class="figure-title"><span class="number">Figure 20.9: </span><span class="name">DHCP Server: TSIG Configuration </span><a title="Permalink" class="permalink" href="#fig.yast2.dhcp.tsig">#</a></h6></div></div></dd><dt id="idm140019136749808"><span class="term ">Dynamic DNS: Interface Configuration</span></dt><dd><p>
       You can now activate dynamic DNS for the subnet by selecting
       <span class="guimenu">Enable Dynamic DNS for This Subnet</span>. After doing so,
       use the drop-down box to activate the TSIG keys for forward and reverse
       zones, making sure that the keys are the same for the DNS and the DHCP
       server. With <span class="guimenu">Update Global Dynamic DNS Settings</span>,
       enable the automatic update and adjustment of the global DHCP server
       settings according to the dynamic DNS environment. Finally, define which
       forward and reverse zones should be updated per dynamic DNS, specifying
       the name of the primary name server for each of the two zones. Selecting
       <span class="guimenu">OK</span> returns to the subnet configuration dialog (see
       <a class="xref" href="#fig.yast2.dhcp.sub" title="DHCP Server: Configuring Subnets">Figure 20.8, “DHCP Server: Configuring Subnets”</a>). Selecting <span class="guimenu">OK</span>
       again returns to the original expert configuration dialog.
      </p><div class="figure" id="fig.yast2.dhcp.dyndns"><div class="figure-contents"><div class="mediaobject"><a xmlns="" href="images/yast2_dhcp_dyndns.png"><img src="images/yast2_dhcp_dyndns.png" width="" alt="DHCP Server: Interface Configuration for Dynamic DNS" /></a></div></div><div class="figure-title-wrap"><h6 class="figure-title"><span class="number">Figure 20.10: </span><span class="name">DHCP Server: Interface Configuration for Dynamic DNS </span><a title="Permalink" class="permalink" href="#fig.yast2.dhcp.dyndns">#</a></h6></div></div></dd><dt id="idm140019136739504"><span class="term ">Network Interface Configuration</span></dt><dd><p>
       To define the interfaces the DHCP server should listen to and to adjust
       the firewall configuration, select <span class="guimenu">Advanced</span> › <span class="guimenu">Interface Configuration</span> from the expert configuration dialog. From the list of
       interfaces displayed, select one or more that should be attended by the
       DHCP server. If clients in all subnets need to be able to communicate
       with the server and the server host also runs a firewall, adjust the
       firewall accordingly. To do so, select <span class="guimenu">Adapt Firewall
       Settings</span>. YaST then adjusts the rules of SuSEfirewall2 to
       the new conditions (see <a class="xref" href="#fig.yast2.dhcp.fire" title="DHCP Server: Network Interface and Firewall">Figure 20.11, “DHCP Server: Network Interface and Firewall”</a>), after
       which you can return to the original dialog by selecting
       <span class="guimenu">OK</span>.
      </p><div class="figure" id="fig.yast2.dhcp.fire"><div class="figure-contents"><div class="mediaobject"><a xmlns="" href="images/yast2_dhcp_fire.png"><img src="images/yast2_dhcp_fire.png" width="" alt="DHCP Server: Network Interface and Firewall" /></a></div></div><div class="figure-title-wrap"><h6 class="figure-title"><span class="number">Figure 20.11: </span><span class="name">DHCP Server: Network Interface and Firewall </span><a title="Permalink" class="permalink" href="#fig.yast2.dhcp.fire">#</a></h6></div></div></dd></dl></div><p>
    After completing all configuration steps, close the dialog with
    <span class="guimenu">OK</span>. The server is now started with its new
    configuration.
   </p></div></div><div class="sect1 " id="sec.dhcp.soft"><div class="titlepage"><div><div><h2 class="title" id="sec.dhcp.soft"><span class="number">20.2 </span><span class="name">DHCP Software Packages</span> <a title="Permalink" class="permalink" href="#sec.dhcp.soft">#</a></h2></div></div></div><p>
   Both the DHCP server and the DHCP clients are available for
   <span class="productname"><span class="phrase">openSUSE Leap</span></span>. The DHCP server available is <code class="systemitem">dhcpd</code> (published by the Internet Systems
   Consortium).

   On the client side, there is <code class="systemitem">dhcp-client</code> (also from
   ISC) and tools coming with the <code class="systemitem">wicked</code> package.
  </p><p>
   By default, the <code class="systemitem">wicked</code> tools are installed with the
   services <code class="systemitem">wickedd-dhcp4</code> and
   <code class="systemitem">wickedd-dhcp6</code>. Both are launched automatically on
   each system boot to watch for a DHCP server. They do not need a
   configuration file to do their job and work out of the box in most standard
   setups. For more complex situations, use the ISC
   <code class="systemitem">dhcp-client</code>, which is controlled by means of the
   configuration files <code class="filename">/etc/dhclient.conf</code> and
   <code class="filename">/etc/dhclient6.conf</code>.
  </p></div><div class="sect1 " id="sec.dhcp.server"><div class="titlepage"><div><div><h2 class="title" id="sec.dhcp.server"><span class="number">20.3 </span><span class="name">The DHCP Server dhcpd</span> <a title="Permalink" class="permalink" href="#sec.dhcp.server">#</a></h2></div></div></div><p>
   The core of any DHCP system is the dynamic host configuration protocol
   daemon. This server <span class="emphasis"><em>leases</em></span> addresses and watches how
   they are used, according to the settings defined in the configuration file
   <code class="filename">/etc/dhcpd.conf</code>. By changing the parameters and values
   in this file, a system administrator can influence the program's behavior in
   numerous ways. Look at the basic sample <code class="filename">/etc/dhcpd.conf</code>
   file in <a class="xref" href="#dat.dhcp.conf" title="The Configuration File /etc/dhcpd.conf">Example 20.1, “The Configuration File /etc/dhcpd.conf”</a>.
  </p><div class="example" id="dat.dhcp.conf"><div class="example-title-wrap"><h6 class="example-title"><span class="number">Example 20.1: </span><span class="name">The Configuration File /etc/dhcpd.conf </span><a title="Permalink" class="permalink" href="#dat.dhcp.conf">#</a></h6></div><div class="example-contents"><div class="verbatim-wrap"><pre class="screen">default-lease-time 600;         # 10 minutes
max-lease-time 7200;            # 2  hours

option domain-name "example.com";
option domain-name-servers 192.168.1.116;
option broadcast-address 192.168.2.255;
option routers 192.168.2.1;
option subnet-mask 255.255.255.0;

subnet 192.168.2.0 netmask 255.255.255.0
 {
  range 192.168.2.10 192.168.2.20;
  range 192.168.2.100 192.168.2.200;
 }</pre></div></div></div><p>
   This simple configuration file should be sufficient to get the DHCP server
   to assign IP addresses in the network. Make sure that a semicolon is
   inserted at the end of each line, because otherwise dhcpd is not started.
  </p><p>
   The sample file can be divided into three sections. The first one defines
   how many seconds an IP address is leased to a requesting client by default
   (<code class="literal">default-lease-time</code>) before it should apply for renewal.
   This section also includes a statement of the maximum period for which a
   machine may keep an IP address assigned by the DHCP server without applying
   for renewal (<code class="literal">max-lease-time</code>).
  </p><p>
   In the second part, some basic network parameters are defined on a global
   level:
  </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
     The line <code class="literal">option domain-name</code> defines the default domain
     of your network.
    </p></li><li class="listitem "><p>
     With the entry <code class="literal">option domain-name-servers</code>, specify up
     to three values for the DNS servers used to resolve IP addresses into host
     names and vice versa. Ideally, configure a name server on your machine or
     somewhere else in your network before setting up DHCP. That name server
     should also define a host name for each dynamic address and vice versa. To
     learn how to configure your own name server, read
     <a class="xref" href="#cha.dns" title="Chapter 19. The Domain Name System">Chapter 19, <em>The Domain Name System</em></a>.
    </p></li><li class="listitem "><p>
     The line <code class="literal">option broadcast-address</code> defines the broadcast
     address the requesting client should use.
    </p></li><li class="listitem "><p>
     With <code class="literal">option routers</code>, set where the server should send
     data packets that cannot be delivered to a host on the local network
     (according to the source and target host address and the subnet mask
     provided). Usually, especially in smaller networks, this router is
     identical to the Internet gateway.
    </p></li><li class="listitem "><p>
     With <code class="literal">option subnet-mask</code>, specify the netmask assigned
     to clients.
    </p></li></ul></div><p>
   The last section of the file defines a network, including a subnet mask. To
   finish, specify the address range that the DHCP daemon should use to assign
   IP addresses to interested clients. In <a class="xref" href="#dat.dhcp.conf" title="The Configuration File /etc/dhcpd.conf">Example 20.1, “The Configuration File /etc/dhcpd.conf”</a>,
   clients may be given any address between <code class="literal">192.168.2.10</code>
   and <code class="literal">192.168.2.20</code> or <code class="literal">192.168.2.100</code>
   and <code class="literal">192.168.2.200</code>.
  </p><p>
   After editing these few lines, you should be able to activate the DHCP
   daemon with the command <code class="command">systemctl start dhcpd</code>. It will be
   ready for use immediately. Use the command
   <code class="command">rcdhcpd</code> <code class="option">check-syntax</code>


   to perform a brief syntax check. If you encounter any unexpected problems
   with your configuration (the server aborts with an error or does not return
   <code class="literal">done</code> on start), you should be able to find out what has
   gone wrong by looking for information either in the main system log that can
   be queried with the command <code class="command">journalctl</code> (see
   <a class="xref" href="#cha.journalctl" title="Chapter 11. journalctl: Query the systemd Journal">Chapter 11, <em><code class="command">journalctl</code>: Query the <code class="systemitem">systemd</code> Journal</em></a> for more information).
  </p><p>
   On a default <span class="productname"><span class="phrase">openSUSE Leap</span></span> system, the DHCP daemon is started in a chroot
   environment for security reasons. The configuration files must be copied to
   the chroot environment so the daemon can find them. Normally, there is no
   need to worry about this because the command <code class="command">systemctl start dhcpd
   </code> automatically copies the files.
  </p><div class="sect2 " id="sec.dhcp.statip"><div class="titlepage"><div><div><h3 class="title" id="sec.dhcp.statip"><span class="number">20.3.1 </span><span class="name">Clients with Fixed IP Addresses</span> <a title="Permalink" class="permalink" href="#sec.dhcp.statip">#</a></h3></div></div></div><p>
    DHCP can also be used to assign a predefined, static address to a specific
    client. Addresses assigned explicitly always take priority over dynamic
    addresses from the pool. A static address never expires in the way a
    dynamic address would, for example, if there were not enough addresses
    available and the server needed to redistribute them among clients.
   </p><p>
    To identify a client configured with a static address, dhcpd uses the
    hardware address (which is a globally unique, fixed numerical code
    consisting of six octet pairs) for the identification of all network
    devices (for example, <code class="literal">00:30:6E:08:EC:80</code>). If the respective
    lines, like the ones in <a class="xref" href="#dat.dhcp.conf.add" title="Additions to the Configuration File">Example 20.2, “Additions to the Configuration File”</a>, are added to
    the configuration file of <a class="xref" href="#dat.dhcp.conf" title="The Configuration File /etc/dhcpd.conf">Example 20.1, “The Configuration File /etc/dhcpd.conf”</a>, the DHCP daemon
    always assigns the same set of data to the corresponding client.
   </p><div class="example" id="dat.dhcp.conf.add"><div class="example-title-wrap"><h6 class="example-title"><span class="number">Example 20.2: </span><span class="name">Additions to the Configuration File </span><a title="Permalink" class="permalink" href="#dat.dhcp.conf.add">#</a></h6></div><div class="example-contents"><div class="verbatim-wrap"><pre class="screen">host jupiter {
hardware ethernet 00:30:6E:08:EC:80;
fixed-address 192.168.2.100;
}</pre></div></div></div><p>
    The name of the respective client (<code class="literal">host</code>
    <em class="replaceable ">HOSTNAME</em>, here <code class="systemitem">jupiter</code>)
    is entered in the first line and the MAC address in the second line. On
    Linux hosts, find the MAC address with the command <code class="command">ip</code>
    <code class="option">link show</code> followed by the network device (for example,
    <code class="literal">eth0</code>). The output should contain something like
   </p><div class="verbatim-wrap"><pre class="screen">link/ether 00:30:6E:08:EC:80</pre></div><p>
    In the preceding example, a client with a network card having the MAC
    address <code class="literal">00:30:6E:08:EC:80</code> is assigned the IP address
    <code class="systemitem">192.168.2.100</code> and the host name
    <code class="literal">jupiter</code> automatically. The type of hardware to enter is
    <code class="literal">ethernet</code> in nearly all cases, although
    <code class="literal">token-ring</code>, which is often found on IBM systems, is also
    supported.
   </p></div><div class="sect2 " id="sec.dhcp.sle"><div class="titlepage"><div><div><h3 class="title" id="sec.dhcp.sle"><span class="number">20.3.2 </span><span class="name">The <span class="productname"><span class="phrase">openSUSE Leap</span></span> Version</span> <a title="Permalink" class="permalink" href="#sec.dhcp.sle">#</a></h3></div></div></div><p>
    To improve security, the <span class="productname"><span class="phrase">openSUSE Leap</span></span> version of the ISC's DHCP server
    comes with the non-root/chroot patch by Ari Edelkind applied. This enables
    dhcpd to run with the user ID
    <code class="systemitem">nobody</code> and run in a chroot
    environment (<code class="filename">/var/lib/dhcp</code>). To make this possible,
    the configuration file <code class="filename">dhcpd.conf</code> must be located in
    <code class="filename">/var/lib/dhcp/etc</code>. The init script automatically
    copies the file to this directory when starting.
   </p><p>
    Control the server's behavior regarding this feature by means of entries in
    the file <code class="filename">/etc/sysconfig/dhcpd</code>. To run dhcpd without
    the chroot environment, set the variable
    <code class="systemitem">DHCPD_RUN_CHROOTED</code> in
    <code class="filename">/etc/sysconfig/dhcpd</code> to <span class="quote">“<span class="quote">no</span>”</span>.
   </p><p>
    To enable dhcpd to resolve host names even from within the chroot
    environment, some other configuration files must be copied as well:
   </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
      <code class="filename">/etc/localtime</code>
     </p></li><li class="listitem "><p>
      <code class="filename">/etc/host.conf</code>
     </p></li><li class="listitem "><p>
      <code class="filename">/etc/hosts</code>
     </p></li><li class="listitem "><p>
      <code class="filename">/etc/resolv.conf</code>
     </p></li></ul></div><p>
    These files are copied to <code class="filename">/var/lib/dhcp/etc/</code> when
    starting the init script. Take these copies into account for any changes
    that they require if they are dynamically modified by scripts like
    <code class="filename">/etc/ppp/ip-up</code>. However, there should be no need to
    worry about this if the configuration file only specifies IP addresses
    (instead of host names).
   </p><p>
    If your configuration includes additional files that should be copied into
    the chroot environment, set these under the variable
    <code class="systemitem">DHCPD_CONF_INCLUDE_FILES</code> in the file
    <code class="filename">/etc/sysconfig/dhcpd</code>. To ensure that the DHCP logging
    facility keeps working even after a restart of the syslog daemon, there is
    an additional entry <code class="systemitem">SYSLOGD_ADDITIONAL_SOCKET_DHCP</code>
    in the file <code class="filename">/etc/sysconfig/syslog</code>.
   </p></div></div><div class="sect1 " id="sec.dhcp.addinfo"><div class="titlepage"><div><div><h2 class="title" id="sec.dhcp.addinfo"><span class="number">20.4 </span><span class="name">For More Information</span> <a title="Permalink" class="permalink" href="#sec.dhcp.addinfo">#</a></h2></div></div></div><p>
   More information about DHCP is available at the Web site of the
   <span class="emphasis"><em>Internet Systems Consortium</em></span>
   (<a class="link" href="http://www.isc.org/products/DHCP/" target="_blank">http://www.isc.org/products/DHCP/</a>). Information is
   also available in the <code class="option">dhcpd</code>, <code class="option">dhcpd.conf</code>,
   <code class="option">dhcpd.leases</code>, and <code class="option">dhcp-options</code> man pages.
  </p></div></div><div class="chapter " id="cha.samba"><div class="titlepage"><div><div><h2 class="title"><span class="number">21 </span><span class="name">Samba</span> <a title="Permalink" class="permalink" href="#cha.samba">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">Filename: </span>net_samba.xml</li><li><span class="ds-label">ID: </span>cha.samba</li></ul></div></div><div><div class="abstract"><div class="abstract-title-wrap"><h6 class="abstract-title">Abstract<a title="Permalink" class="permalink" href="#idm140019136651520">#</a></h6></div><p>
    Using Samba, a Unix machine can be configured as a file and print server
    for macOS, Windows, and OS/2 machines. Samba has developed into a
    fully-fledged and rather complex product. Configure Samba with YaST, or
    by editing the configuration file manually.
   </p></div></div></div></div><div class="line"><div class="toc"><dl><dt><span class="sect1"><a href="#sec.samba.term"><span class="number">21.1 </span><span class="name">Terminology</span></a></span></dt><dt><span class="sect1"><a href="#sec.samba.install"><span class="number">21.2 </span><span class="name">Installing a Samba Server</span></a></span></dt><dt><span class="sect1"><a href="#sec.samba.serv.start"><span class="number">21.3 </span><span class="name">Starting and Stopping Samba</span></a></span></dt><dt><span class="sect1"><a href="#sec.samba.serv.inst"><span class="number">21.4 </span><span class="name">Configuring a Samba Server</span></a></span></dt><dt><span class="sect1"><a href="#sec.samba.client.inst"><span class="number">21.5 </span><span class="name">Configuring Clients</span></a></span></dt><dt><span class="sect1"><a href="#sec.samba.anmeld.serv"><span class="number">21.6 </span><span class="name">Samba as Login Server</span></a></span></dt><dt><span class="sect1"><a href="#sec.samba.adnet"><span class="number">21.7 </span><span class="name">Samba Server in the Network with Active Directory</span></a></span></dt><dt><span class="sect1"><a href="#sec.samba.advanced"><span class="number">21.8 </span><span class="name">Advanced Topics</span></a></span></dt><dt><span class="sect1"><a href="#sec.samba.info"><span class="number">21.9 </span><span class="name">For More Information</span></a></span></dt></dl></div></div><div class="sect1 " id="sec.samba.term"><div class="titlepage"><div><div><h2 class="title" id="sec.samba.term"><span class="number">21.1 </span><span class="name">Terminology</span> <a title="Permalink" class="permalink" href="#sec.samba.term">#</a></h2></div></div></div><p>
   The following are some terms used in Samba documentation and in the YaST
   module.
  </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019136646896"><span class="term ">SMB protocol</span></dt><dd><p>
      Samba uses the SMB (server message block) protocol that is
      based on the <span class="productname">NetBIOS</span> services.
      Microsoft released the protocol so other software manufacturers could
      establish connections to a Microsoft domain network. With Samba, the SMB
      protocol works on top of the TCP/IP protocol, so the TCP/IP protocol must
      be installed on all clients.
     </p></dd><dt id="idm140019136644048"><span class="term ">CIFS protocol</span></dt><dd><p>
      CIFS (common Internet file system) protocol is another
      protocol supported by Samba. CIFS defines a standard remote file system
      access protocol for use over the network, enabling groups of users to
      work together and share documents across the network.
     </p></dd><dt id="idm140019136641984"><span class="term ">NetBIOS</span></dt><dd><p>
      NetBIOS is a software interface (API) designed for
      communication between machines providing a name service. It enables
      machines connected to the network to reserve names for themselves. After
      reservation, these machines can be addressed by name. There is no central
      process that checks names. Any machine on the network can reserve as many
      names as it wants as long as the names are not already in use. The
      NetBIOS interface can be implemented for different network architectures.
      An implementation that works relatively closely with network hardware is
      called <span class="productname">NetBEUI</span>, but this is often
      called <span class="productname">NetBIOS</span>. Network protocols
      implemented with NetBIOS are IPX from Novell (NetBIOS via TCP/IP) and
      TCP/IP.
     </p><p>
      The NetBIOS names sent via TCP/IP have nothing in common with the names
      used in <code class="filename">/etc/hosts</code> or those defined by DNS. NetBIOS
      uses its own, completely independent naming convention. However, it is
      recommended to use names that correspond to DNS host names to make
      administration easier or use DNS natively. This is the default used by
      Samba.
     </p></dd><dt id="idm140019136636800"><span class="term ">Samba server</span></dt><dd><p>
      Samba server provides SMB/CIFS services and NetBIOS over IP naming
      services to clients. For Linux, there are three daemons for Samba server:
      smbd for SMB/CIFS services, nmbd for naming services, and winbind for
      authentication.
     </p></dd><dt id="idm140019136634768"><span class="term ">Samba client</span></dt><dd><p>
      The Samba client is a system that uses Samba services from a Samba server
      over the SMB protocol. Common operating systems, such as Windows and
      macOS support the SMB protocol. The TCP/IP protocol must be
      installed on all computers. Samba provides a client for the different
      Unix flavors. For Linux, there is a kernel module for SMB that allows the
      integration of SMB resources on the Linux system level. You do not need
      to run any daemon for the Samba client.
     </p></dd><dt id="idm140019136632480"><span class="term ">Shares</span></dt><dd><p>
      SMB servers provide resources to the clients by means of
      shares. Shares are printers and directories with their subdirectories on
      the server. It is exported by means of a name and can be accessed by its
      name. The share name can be set to any name—it does not need to be
      the name of the export directory. A printer is also assigned a name.
      Clients can access the printer by its name.
     </p></dd><dt id="idm140019136630272"><span class="term ">DC</span></dt><dd><p>
      A domain controller (DC) is a server that handles accounts
      in a domain. For data replication, additional domain controllers are
      available in one domain.
     </p></dd></dl></div></div><div class="sect1 " id="sec.samba.install"><div class="titlepage"><div><div><h2 class="title" id="sec.samba.install"><span class="number">21.2 </span><span class="name">Installing a Samba Server</span> <a title="Permalink" class="permalink" href="#sec.samba.install">#</a></h2></div></div></div><p>
   To install a Samba server, start YaST and select
   <span class="guimenu">Software</span> › <span class="guimenu">Software
   Management</span>. Choose
   <span class="guimenu">View</span> › <span class="guimenu">Patterns</span>
   and select <span class="guimenu">File Server</span>. Confirm the installation of the
   required packages to finish the installation process.
  </p></div><div class="sect1 " id="sec.samba.serv.start"><div class="titlepage"><div><div><h2 class="title" id="sec.samba.serv.start"><span class="number">21.3 </span><span class="name">Starting and Stopping Samba</span> <a title="Permalink" class="permalink" href="#sec.samba.serv.start">#</a></h2></div></div></div><p>
   You can start or stop the Samba server automatically (during boot) or
   manually. Starting and stopping policy is a part of the YaST Samba server
   configuration described in <a class="xref" href="#sec.samba.yast2.conf" title="21.4.1. Configuring a Samba Server with YaST">Section 21.4.1, “Configuring a Samba Server with YaST”</a>.
  </p><p>
   From a command line, stop services required for Samba with
   <code class="command">systemctl stop smb nmb</code> and start them with
   <code class="command">systemctl start nmb smb</code>. The <code class="literal">smb</code>
   service cares about <code class="literal">winbind</code> if needed.
  </p><div id="idm140019136618640" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.png" /><h6>Tip: <code class="systemitem">winbind</code></h6><p>
    <code class="systemitem">winbind</code> is an independent service, and as such is
    also offered as an individual <code class="systemitem">samba-winbind</code>
    package.
   </p></div></div><div class="sect1 " id="sec.samba.serv.inst"><div class="titlepage"><div><div><h2 class="title" id="sec.samba.serv.inst"><span class="number">21.4 </span><span class="name">Configuring a Samba Server</span> <a title="Permalink" class="permalink" href="#sec.samba.serv.inst">#</a></h2></div></div></div><p>
   A Samba server in <span class="productname"><span class="phrase">openSUSE® Leap</span></span> can be configured in two different ways:
   with YaST or manually. Manual configuration offers a higher level of
   detail, but lacks the convenience of the YaST GUI.
  </p><div class="sect2 " id="sec.samba.yast2.conf"><div class="titlepage"><div><div><h3 class="title" id="sec.samba.yast2.conf"><span class="number">21.4.1 </span><span class="name">Configuring a Samba Server with YaST</span> <a title="Permalink" class="permalink" href="#sec.samba.yast2.conf">#</a></h3></div></div></div><p>
    To configure a Samba server, start YaST and select
    <span class="guimenu">Network Services</span> › <span class="guimenu">Samba
    Server</span>.
   </p><div class="sect3 " id="sec.samba.yast2.conf.inst"><div class="titlepage"><div><div><h4 class="title" id="sec.samba.yast2.conf.inst"><span class="number">21.4.1.1 </span><span class="name">Initial Samba Configuration</span> <a title="Permalink" class="permalink" href="#sec.samba.yast2.conf.inst">#</a></h4></div></div></div><p>
     When starting the module for the first time, the <span class="guimenu">Samba
     Installation</span> dialog starts, prompting you to make a few basic
     decisions concerning administration of the server. At the end of the
     configuration it prompts for the Samba administrator password
     (<span class="guimenu">Samba Root Password</span>). For later starts, the
     <span class="guimenu">Samba Configuration</span> dialog appears.
    </p><p>
     The <span class="guimenu">Samba Installation</span> dialog consists of two steps and
     optional detailed settings:
    </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019136605584"><span class="term ">Workgroup or Domain Name</span></dt><dd><p>
        Select an existing name from <span class="guimenu">Workgroup or Domain
        Name</span> or enter a new one and click <span class="guimenu">Next</span>.
       </p></dd><dt id="idm140019136602832"><span class="term ">Samba Server Type</span></dt><dd><p>
        In the next step, specify whether your server should act as a primary
        domain controller (PDC), backup domain controller (BDC), or not act
        as a domain controller. Continue with <span class="guimenu">Next</span>.
       </p></dd></dl></div><p>
     If you do not want to proceed with a detailed server configuration,
     confirm with <span class="guimenu">OK</span>. Then in the final pop-up box, set the
     <span class="guimenu">Samba root Password</span>.
    </p><p>
     You can change all settings later in the <span class="guimenu">Samba
     Configuration</span> dialog with the <span class="guimenu">Start-Up</span>,
     <span class="guimenu">Shares</span>, <span class="guimenu">Identity</span>, <span class="guimenu">Trusted
     Domains</span>, and <span class="guimenu">LDAP Settings</span> tabs.
    </p></div><div class="sect3 " id="sec.samba.yast2.conf.adv"><div class="titlepage"><div><div><h4 class="title" id="sec.samba.yast2.conf.adv"><span class="number">21.4.1.2 </span><span class="name">Advanced Samba Configuration</span> <a title="Permalink" class="permalink" href="#sec.samba.yast2.conf.adv">#</a></h4></div></div></div><p>
     During the first start of the Samba server module the <span class="guimenu">Samba
     Configuration</span> dialog appears directly after the two initial
     steps described in <a class="xref" href="#sec.samba.yast2.conf.inst" title="21.4.1.1. Initial Samba Configuration">Section 21.4.1.1, “Initial Samba Configuration”</a>. Use it to
     adjust your Samba server configuration.
    </p><p>
     After editing your configuration, click <span class="guimenu">OK</span> to save your
     settings.
    </p><div class="sect4 " id="sec.samba.yast2.conf.adv.start"><div class="titlepage"><div><div><h5 class="title" id="sec.samba.yast2.conf.adv.start"><span class="number">21.4.1.2.1 </span><span class="name">Starting the Server</span> <a title="Permalink" class="permalink" href="#sec.samba.yast2.conf.adv.start">#</a></h5></div></div></div><p>
      In the <span class="guimenu">Start Up</span> tab, configure the start of the Samba
      server. To start the service every time your system boots, select
      <span class="guimenu">During Boot</span>. To activate manual start, choose
      <span class="guimenu">Manually</span>. More information about starting a Samba
      server is provided in <a class="xref" href="#sec.samba.serv.start" title="21.3. Starting and Stopping Samba">Section 21.3, “Starting and Stopping Samba”</a>.
     </p><p>
      In this tab, you can also open ports in your firewall. To do so, select
      <span class="guimenu">Open Port in Firewall</span>. If you have multiple network
      interfaces, select the network interface for Samba services by clicking
      <span class="guimenu">Firewall Details</span>, selecting the interfaces, and
      clicking <span class="guimenu">OK</span>.
     </p></div><div class="sect4 " id="sec.samba.yast2.conf.adv.shares"><div class="titlepage"><div><div><h5 class="title" id="sec.samba.yast2.conf.adv.shares"><span class="number">21.4.1.2.2 </span><span class="name">Shares</span> <a title="Permalink" class="permalink" href="#sec.samba.yast2.conf.adv.shares">#</a></h5></div></div></div><p>
      In the <span class="guimenu">Shares</span> tab, determine the Samba shares to
      activate. There are some predefined shares, like homes and printers. Use
      <span class="guimenu">Toggle Status</span> to switch between
      <span class="guimenu">Active</span> and <span class="guimenu">Inactive</span>. Click
      <span class="guimenu">Add</span> to add new shares and <span class="guimenu">Delete</span> to
      delete the selected share.
     </p><p>
      <span class="guimenu">Allow Users to Share Their Directories</span> enables members
      of the group in <span class="guimenu">Permitted Group</span> to share directories
      they own with other users. For example, <code class="systemitem">users</code>
      for a local scope or <code class="systemitem">DOMAIN\Users</code> for a domain
      scope. The user also must make sure that the file system permissions
      allow access. With <span class="guimenu">Maximum Number of Shares</span>, limit the
      total amount of shares that may be created. To permit access to user
      shares without authentication, enable <span class="guimenu">Allow Guest
      Access</span>.

     </p></div><div class="sect4 " id="sec.samba.yast2.conf.adv.identity"><div class="titlepage"><div><div><h5 class="title" id="sec.samba.yast2.conf.adv.identity"><span class="number">21.4.1.2.3 </span><span class="name">Identity</span> <a title="Permalink" class="permalink" href="#sec.samba.yast2.conf.adv.identity">#</a></h5></div></div></div><p>
      In the <span class="guimenu">Identity</span> tab, you can determine the domain with
      which the host is associated (<span class="guimenu">Base Settings</span>) and
      whether to use an alternative host name in the network (<span class="guimenu">NetBIOS
      Hostname</span>).

      It is also possible to use Microsoft Windows Internet Name Service (WINS)
      for name resolution. In this case, activate <span class="guimenu">Use WINS for
      Hostname Resolution</span> and decide whether to <span class="guimenu">Retrieve
      WINS server via DHCP</span>. To set expert global settings or set a
      user authentication source, <span class="phrase">for example LDAP
      instead of TDB database, </span>click <span class="guimenu">Advanced
      Settings</span>.

     </p></div><div class="sect4 " id="sec.samba.yast2.conf.adv.trusted"><div class="titlepage"><div><div><h5 class="title" id="sec.samba.yast2.conf.adv.trusted"><span class="number">21.4.1.2.4 </span><span class="name">Trusted Domains</span> <a title="Permalink" class="permalink" href="#sec.samba.yast2.conf.adv.trusted">#</a></h5></div></div></div><p>
      To enable users from other domains to access your domain, make the
      appropriate settings in the <span class="guimenu">Trusted Domains</span> tab. To
      add a new domain, click <span class="guimenu">Add</span>. To remove the selected
      domain, click <span class="guimenu">Delete</span>.
     </p></div><div class="sect4 " id="sec.samba.yast2.conf.adv.ldap"><div class="titlepage"><div><div><h5 class="title" id="sec.samba.yast2.conf.adv.ldap"><span class="number">21.4.1.2.5 </span><span class="name">LDAP Settings</span> <a title="Permalink" class="permalink" href="#sec.samba.yast2.conf.adv.ldap">#</a></h5></div></div></div><p>
      In the tab <span class="guimenu">LDAP Settings</span>, you can determine the LDAP
      server to use for authentication. To test the connection to your LDAP
      server, click <span class="guimenu">Test Connection</span>. To set expert LDAP
      settings or use default values, click <span class="guimenu">Advanced
      Settings</span>.
     </p><p>
      For more information about LDAP configuration, see
      <span class="intraxref">Book “<em class="citetitle ">Security Guide</em>”, Chapter 5 “LDAP—A Directory Service”</span>.
     </p></div></div></div><div class="sect2 " id="sec.samba.serv.inst.manual"><div class="titlepage"><div><div><h3 class="title" id="sec.samba.serv.inst.manual"><span class="number">21.4.2 </span><span class="name">Configuring the Server Manually</span> <a title="Permalink" class="permalink" href="#sec.samba.serv.inst.manual">#</a></h3></div></div></div><p>
    If you intend to use Samba as a server, install
    <code class="systemitem">samba</code>. The main configuration
    file for Samba is <code class="filename">/etc/samba/smb.conf</code>. This file can
    be divided into two logical parts. The <code class="literal">[global]</code> section
    contains the central and global settings. The following default sections
    contain the individual file and printer shares:
   </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
      [homes]
     </p></li><li class="listitem "><p>
      [profiles]
     </p></li><li class="listitem "><p>
      [users]
     </p></li><li class="listitem "><p>
      [groups]
     </p></li><li class="listitem "><p>
      [printers]
     </p></li><li class="listitem "><p>
      [print$]
     </p></li></ul></div><p>
    Using this approach, options of the shares can be set
    differently or globally in the <code class="literal">[global]</code> section, which
    makes the configuration file easier to understand.
   </p><div class="sect3 " id="sec.samba.smb.conf.Erlaeuterung"><div class="titlepage"><div><div><h4 class="title" id="sec.samba.smb.conf.Erlaeuterung"><span class="number">21.4.2.1 </span><span class="name">The global Section</span> <a title="Permalink" class="permalink" href="#sec.samba.smb.conf.Erlaeuterung">#</a></h4></div></div></div><p>
     The following parameters of the <code class="literal">[global]</code> section should
     be modified to match the requirements of your network setup, so other
     machines can access your Samba server via SMB in a Windows environment.
    </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019136549856"><span class="term "><code class="literal">workgroup = WORKGROUP</code>
      </span></dt><dd><p>
        This line assigns the Samba server to a workgroup. Replace
        <code class="literal">WORKGROUP</code> with an appropriate workgroup of your
        networking environment. Your Samba server appears under its DNS name
        unless this name has been assigned to some other machine in the
        network. If the DNS name is not available, set the server name using
        <code class="literal">netbiosname=<em class="replaceable ">MYNAME</em></code>. For
        more details about this parameter, see the
        <code class="systemitem">smb.conf</code> man page.
       </p></dd><dt id="idm140019136545776"><span class="term "><code class="literal">os level = 20</code>
      </span></dt><dd><p>
        This parameter triggers whether your Samba server tries to become LMB
        (local master browser) for its workgroup. Choose a very low value such
        as <code class="literal">2</code> to spare the existing Windows network from any
        interruptions caused by a misconfigured Samba server. More information
        about this topic can be found in the Network Browsing chapter
        of the Samba 3 Howto; for more information on the Samba 3 Howto, see
        <a class="xref" href="#sec.samba.info" title="21.9. For More Information">Section 21.9, “For More Information”</a>.
       </p><p>
        If no other SMB server is in your network (such as a Windows 2000
        server) and you want the Samba server to keep a list of all systems
        present in the local environment, set the <code class="literal">os level</code>
        to a higher value (for example, <code class="literal">65</code>). Your Samba
        server is then chosen as LMB for your local network.
       </p><p>
        When changing this setting, consider carefully how this could affect an
        existing Windows network environment. First test the changes in an
        isolated network or at a noncritical time of day.
       </p></dd><dt id="idm140019136539968"><span class="term "><code class="literal">wins support</code> and <code class="literal">wins server</code>
      </span></dt><dd><p>
        To integrate your Samba server into an existing Windows network with an
        active WINS server, enable the <code class="option">wins server</code> option and
        set its value to the IP address of that WINS server.
       </p><p>
        If your Windows machines are connected to separate subnets and need to
        still be aware of each other, you have to set up a WINS server. To turn
        a Samba server into such a WINS server, set the option <code class="literal">wins
        support = Yes</code>. Make sure that only one Samba server of the
        network has this setting enabled. The options <code class="literal">wins
        server</code> and <code class="literal">wins support</code> must never be
        enabled at the same time in your <code class="filename">smb.conf</code> file.
       </p></dd></dl></div></div><div class="sect3 " id="sec.samba.smb.conf.shares"><div class="titlepage"><div><div><h4 class="title" id="sec.samba.smb.conf.shares"><span class="number">21.4.2.2 </span><span class="name">Shares</span> <a title="Permalink" class="permalink" href="#sec.samba.smb.conf.shares">#</a></h4></div></div></div><p>
     The following examples illustrate how a CD-ROM drive and the user
     directories (<code class="literal">homes</code>) are made available to the SMB
     clients.
    </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019136531360"><span class="term ">[cdrom]</span></dt><dd><p>
        To avoid having the CD-ROM drive accidentally made available, these
        lines are deactivated with comment marks (semicolons in this case).
        Remove the semicolons in the first column to share the CD-ROM drive
        with Samba.
       </p><div class="example" id="dat.cd.rom"><div class="example-title-wrap"><h6 class="example-title"><span class="number">Example 21.1: </span><span class="name">A CD-ROM Share </span><a title="Permalink" class="permalink" href="#dat.cd.rom">#</a></h6></div><div class="example-contents"><div class="verbatim-wrap"><pre class="screen">[cdrom]
       comment = Linux CD-ROM
       path = /media/cdrom
       locking = No</pre></div></div></div><div class="variablelist "><dl class="variablelist"><dt id="idm140019136527520"><span class="term "><code class="option">[cdrom]</code> and <code class="option">comment</code>
         </span></dt><dd><p>
           The <code class="literal">[cdrom]</code> section entry is the name of the
           share that can be seen by all SMB clients on the network. An
           additional <code class="literal">comment</code> can be added to further
           describe the share.
          </p></dd><dt id="idm140019136523936"><span class="term "><code class="option">path = /media/cdrom</code>
         </span></dt><dd><p>
           <code class="option">path</code> exports the directory
           <code class="filename">/media/cdrom</code>.
          </p></dd></dl></div><p>
        By means of a very restrictive default configuration, this kind of
        share is only made available to the users present on this system. If
        this share should be made available to everybody, add a line
        <code class="literal">guest ok = yes</code> to the configuration. This setting
        gives read permissions to anyone on the network. It is recommended to
        handle this parameter with great care. This applies even more to the
        use of this parameter in the <code class="literal">[global]</code> section.
       </p></dd><dt id="idm140019136518752"><span class="term "><code class="option">[homes]</code>
      </span></dt><dd><p>
        The <code class="option">[homes]</code> share is of special importance here. If
        the user has a valid account and password for the Linux file server and
        his own home directory, he can be connected to it.
       </p><div class="example" id="dat.homes.frei"><div class="example-title-wrap"><h6 class="example-title"><span class="number">Example 21.2: </span><span class="name">[homes] Share </span><a title="Permalink" class="permalink" href="#dat.homes.frei">#</a></h6></div><div class="example-contents"><div class="verbatim-wrap"><pre class="screen">[homes]
        comment = Home Directories
        valid users = %S
        browseable = No
        read only = No
        inherit acls = Yes</pre></div></div></div><div class="variablelist "><dl class="variablelist"><dt id="idm140019136514176"><span class="term ">[homes]</span></dt><dd><p>
           As long as there is no other share using the share name of the user
           connecting to the SMB server, a share is dynamically generated using
           the <code class="literal">[homes]</code> share directives. The resulting name
           of the share is the user name.
          </p></dd><dt id="idm140019136511696"><span class="term "><code class="option">valid users = %S</code>
         </span></dt><dd><p>
           <code class="literal">%S</code> is replaced with the concrete name of the
           share when a connection has been successfully established. For a
           <code class="option">[homes]</code> share, this is always the user name. As a
           consequence, access rights to a user's share are restricted
           exclusively to that user.
          </p></dd><dt id="idm140019136508464"><span class="term "><code class="option">browseable = No</code>
         </span></dt><dd><p>
           This setting makes the share invisible in the network environment.
          </p></dd><dt id="idm140019136506304"><span class="term "><code class="option">read only = No</code>
         </span></dt><dd><p>
           By default, Samba prohibits write access to any exported share by
           means of the <code class="literal">read only = Yes</code> parameter. To make a
           share writable, set the value <code class="literal">read only = No</code>,
           which is synonymous with <code class="literal">writable = Yes</code>.
          </p></dd><dt id="idm140019136502736"><span class="term "><code class="option">create mask = 0640</code>
         </span></dt><dd><p>
           Systems that are not based on MS Windows NT do not understand the
           concept of Unix permissions, so they cannot assign permissions when
           creating a file. The parameter <code class="literal">create mask</code>
           defines the access permissions assigned to newly created files. This
           only applies to writable shares. In effect, this setting means the
           owner has read and write permissions and the members of the owner's
           primary group have read permissions. <code class="option">valid users =
           %S</code> prevents read access even if the group has read
           permissions. For the group to have read or write access, deactivate
           the line <code class="option">valid users = %S</code>.
          </p></dd></dl></div></dd></dl></div><div id="idm140019136498080" class="admonition warning normal"><img class="symbol" alt="Warning" title="Warning" src="static/images/icon-warning.png" /><h6>Warning: Do not share <code class="literal">NFS</code> mounts with Samba</h6><p>
      Sharing <code class="literal">NFS</code> mounts with samba may result in data loss
      and is not supported. Install Samba directly on the file server or
      consider using alternatives such as <code class="literal">iSCSI</code>.
     </p></div></div><div class="sect3 " id="sec.samba.rechte"><div class="titlepage"><div><div><h4 class="title" id="sec.samba.rechte"><span class="number">21.4.2.3 </span><span class="name">Security Levels</span> <a title="Permalink" class="permalink" href="#sec.samba.rechte">#</a></h4></div></div></div><p>
     To improve security, each share access can be protected with a password.
     SMB offers the following ways of checking permissions:
    </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019136493056"><span class="term ">User Level Security (<code class="literal">security = user</code>)</span></dt><dd><p>
        This variant introduces the concept of the user to SMB. Each user must
        register with the server with his or her own password. After
        registration, the server can grant access to individual exported shares
        dependent on user names.
       </p></dd><dt id="idm140019136490560"><span class="term ">ADS Level Security (<code class="literal">security = ADS</code>)</span></dt><dd><p>
        In this mode, Samba will act as a domain member in an Active Directory
        environment. To operate in this mode, the machine running Samba needs
        Kerberos installed and configured. You must join the machine using
        Samba to the ADS realm. This can be done using the YaST
        <span class="guimenu">Windows Domain Membership</span> module.
       </p></dd><dt id="idm140019136487568"><span class="term ">Domain Level Security (<code class="literal">security = domain</code>)</span></dt><dd><p>
        This mode will only work correctly if the machine has been joined into
        a Windows NT Domain. Samba will try to validate user name and password
        by passing it to a Windows NT Primary or Backup Domain Controller. The
        same way as a Windows NT Server would do. It expects the encrypted
        passwords parameter to be set to <code class="literal">yes</code>.
       </p></dd></dl></div><p>
     The selection of share, user, server, or domain level security applies to
     the entire server. It is not possible to offer individual shares of a
     server configuration with share level security and others with user level
     security. However, you can run a separate Samba server for each configured
     IP address on a system.
    </p><p>
     More information about this subject can be found in the Samba 3 HOWTO.
     For multiple servers on one system, pay attention to the options
     <code class="option">interfaces</code> and <code class="option">bind interfaces only</code>.
    </p></div></div></div><div class="sect1 " id="sec.samba.client.inst"><div class="titlepage"><div><div><h2 class="title" id="sec.samba.client.inst"><span class="number">21.5 </span><span class="name">Configuring Clients</span> <a title="Permalink" class="permalink" href="#sec.samba.client.inst">#</a></h2></div></div></div><p>
   Clients can only access the Samba server via TCP/IP. NetBEUI and NetBIOS via
   IPX cannot be used with Samba.
  </p><div class="sect2 " id="sec.samba.client.inst.yast"><div class="titlepage"><div><div><h3 class="title" id="sec.samba.client.inst.yast"><span class="number">21.5.1 </span><span class="name">Configuring a Samba Client with YaST</span> <a title="Permalink" class="permalink" href="#sec.samba.client.inst.yast">#</a></h3></div></div></div><p>
    Configure a Samba client to access resources (files or printers) on the
    Samba or Windows server. Enter the NT or Active Directory domain or
    workgroup in the dialog <span class="guimenu">Network Services</span> › <span class="guimenu">Windows Domain Membership</span>. If you activate
    <span class="guimenu">Also Use SMB Information for Linux Authentication</span>, the
    user authentication runs over the Samba, NT or Kerberos server.
   </p><p>
    Click <span class="guimenu">Expert Settings</span> for advanced configuration
    options. For example, use the <span class="guimenu">Mount Server Directories</span>
    table to enable mounting server home directory automatically with
    authentication. This way users can access their home directories when
    hosted on CIFS. For details, see the <code class="systemitem">pam_mount</code> man
    page.
   </p><p>
    After completing all settings, confirm the dialog to finish the
    configuration.
   </p></div></div><div class="sect1 " id="sec.samba.anmeld.serv"><div class="titlepage"><div><div><h2 class="title" id="sec.samba.anmeld.serv"><span class="number">21.6 </span><span class="name">Samba as Login Server</span> <a title="Permalink" class="permalink" href="#sec.samba.anmeld.serv">#</a></h2></div></div></div><p>
   In networks where predominantly Windows clients are found, it is often
   preferable that users may only register with a valid account and password.
   In a Windows-based network, this task is handled by a primary domain
   controller (PDC). You can use a Windows NT server configured as PDC, but
   this task can also be done with a Samba server. The entries that must be
   made in the <code class="literal">[global]</code> section of
   <code class="filename">smb.conf</code> are shown in
   <a class="xref" href="#dat.samba.smb.conf.dom" title="Global Section in smb.conf">Example 21.3, “Global Section in smb.conf”</a>.
  </p><div class="example" id="dat.samba.smb.conf.dom"><div class="example-title-wrap"><h6 class="example-title"><span class="number">Example 21.3: </span><span class="name">Global Section in smb.conf </span><a title="Permalink" class="permalink" href="#dat.samba.smb.conf.dom">#</a></h6></div><div class="example-contents"><div class="verbatim-wrap"><pre class="screen">[global]
    workgroup = WORKGROUP
    domain logons = Yes
    domain master = Yes</pre></div></div></div><p>
   It is necessary to prepare user accounts and passwords in an encryption
   format that conforms with Windows. Do this with the command
   <code class="command">smbpasswd</code> <code class="option">-a name</code>. Create the domain
   account for the computers, required by the Windows domain concept, with the
   following commands:
  </p><div class="verbatim-wrap"><pre class="screen">useradd hostname\$
smbpasswd -a -m hostname</pre></div><p>
   With the <code class="command">useradd</code> command, a dollar sign is added. The
   command <code class="command">smbpasswd</code> inserts this automatically when the
   parameter <code class="option">-m</code> is used. The commented configuration example
   (<code class="filename">/usr/share/doc/packages/samba/examples/smb.conf.SUSE</code>)
   contains settings that automate this task.
  </p><div class="verbatim-wrap"><pre class="screen">add machine script = /usr/sbin/useradd -g nogroup -c "NT Machine Account" \
-s /bin/false %m\$</pre></div><p>
   To make sure that Samba can execute this script correctly, choose a Samba
   user with the required administrator permissions and add it to the
   <code class="systemitem">ntadmin</code> group. Then all users
   belonging to this Linux group can be assigned <code class="literal">Domain
   Admin</code> status with the command:
  </p><div class="verbatim-wrap"><pre class="screen">net groupmap add ntgroup="Domain Admins" unixgroup=ntadmin</pre></div></div><div class="sect1 " id="sec.samba.adnet"><div class="titlepage"><div><div><h2 class="title" id="sec.samba.adnet"><span class="number">21.7 </span><span class="name">Samba Server in the Network with Active Directory</span> <a title="Permalink" class="permalink" href="#sec.samba.adnet">#</a></h2></div></div></div><p>
   If you run Linux servers and Windows servers together, you can build two
   independent authentication systems and networks or connect servers to one
   network with one central authentication system. Because Samba can cooperate
   with an active directory domain, you can join your SUSE Linux Enterprise Server to Active Directory
   (AD).
  </p><p>
   To join an AD domain proceed as follows:
  </p><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
     Log in as <code class="systemitem">root</code> and start YaST.
    </p></li><li class="step "><p>
     Start <span class="guimenu">Network Services</span> › <span class="guimenu">Windows
     Domain Membership</span>.
    </p></li><li class="step "><p>
     Enter the domain to join at <span class="guimenu">Domain or Workgroup</span> in the
     <span class="guimenu">Windows Domain Membership</span> screen.
    </p><div class="figure" id="idm140019136452128"><div class="figure-contents"><div class="mediaobject"><a xmlns="" href="images/ad_sambaclient.png"><img src="images/ad_sambaclient.png" width="" alt="Determining Windows Domain Membership" /></a></div></div><div class="figure-title-wrap"><h6 class="figure-title"><span class="number">Figure 21.1: </span><span class="name">Determining Windows Domain Membership </span><a title="Permalink" class="permalink" href="#idm140019136452128">#</a></h6></div></div></li><li class="step "><p>
     Check <span class="guimenu">Also Use SMB Information for Linux Authentication</span>
     to use the SMB source for Linux authentication on your server.
    </p></li><li class="step "><p>
     Click <span class="guimenu">OK</span> and confirm the domain join when prompted for
     it.
    </p></li><li class="step "><p>
     Provide the password for the Windows Administrator on the AD server and
     click <span class="guimenu">OK</span>.
    </p><p>
     Your server is now set up to pull in all authentication data from the
     Active Directory domain controller.
    </p></li></ol></div></div><div id="idm140019136441984" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.png" /><h6>Tip: Identity Mapping</h6><p>
    In an environment with more than one Samba server, UIDs and GIDs will not
    be created consistently. The UIDs that get assigned to users will be
    dependent on the order in which they first log in, which results in UID
    conflicts across servers. To fix this, you need to use identity mapping.
    See
    <a class="link" href="https://www.samba.org/samba/docs/man/Samba-HOWTO-Collection/idmapper.html" target="_blank">https://www.samba.org/samba/docs/man/Samba-HOWTO-Collection/idmapper.html</a>
    for more details.
   </p></div></div><div class="sect1 " id="sec.samba.advanced"><div class="titlepage"><div><div><h2 class="title" id="sec.samba.advanced"><span class="number">21.8 </span><span class="name">Advanced Topics</span> <a title="Permalink" class="permalink" href="#sec.samba.advanced">#</a></h2></div></div></div><p>
   This section introduces more advanced techniques to manage both the client
   and server part of the Samba suite.
  </p><div class="sect2 " id="sec.samba.advanced.compress"><div class="titlepage"><div><div><h3 class="title" id="sec.samba.advanced.compress"><span class="number">21.8.1 </span><span class="name">Transparent File Compression on Btrfs</span> <a title="Permalink" class="permalink" href="#sec.samba.advanced.compress">#</a></h3></div></div></div><p>
    Samba allows clients to remotely manipulate file and directory compression
    flags for shares placed on the Btrfs file system. Windows Explorer provides
    the ability to flag files/directories for transparent compression via the
    <span class="guimenu">File</span> › <span class="guimenu">Properties</span> › <span class="guimenu">Advanced</span>
    dialog:
   </p><div class="figure" id="idm140019136434768"><div class="figure-contents"><div class="mediaobject"><a xmlns="" href="images/samba_win_expl_advattr.png"><img src="images/samba_win_expl_advattr.png" width="" alt="Windows Explorer Advanced Attributes Dialog" /></a></div></div><div class="figure-title-wrap"><h6 class="figure-title"><span class="number">Figure 21.2: </span><span class="name">Windows Explorer <span class="guimenu">Advanced Attributes</span> Dialog </span><a title="Permalink" class="permalink" href="#idm140019136434768">#</a></h6></div></div><p>
    Files flagged for compression are transparently compressed and decompressed
    by the underlying file system when accessed or modified. This normally
    results in storage capacity savings at the expense of extra CPU overhead
    when accessing the file. New files and directories inherit the compression
    flag from the parent directory, unless created with the FILE_NO_COMPRESSION
    option.
   </p><p>
    Windows Explorer presents compressed files and directories visually
    differently to those that are not compressed:
   </p><div class="figure" id="idm140019136427904"><div class="figure-contents"><div class="mediaobject"><a xmlns="" href="images/samba_win_expl_view_compressed.png"><img src="images/samba_win_expl_view_compressed.png" width="" alt="Windows Explorer Directory Listing with Compressed Files" /></a></div></div><div class="figure-title-wrap"><h6 class="figure-title"><span class="number">Figure 21.3: </span><span class="name">Windows Explorer Directory Listing with Compressed Files </span><a title="Permalink" class="permalink" href="#idm140019136427904">#</a></h6></div></div><p>
    You can enable Samba share compression either manually by adding
   </p><div class="verbatim-wrap"><pre class="screen">vfs objects = btrfs</pre></div><p>
    to the share configuration in <code class="filename">/etc/samba/smb.conf</code>, or
    using YaST: <span class="guimenu">Network Services</span> › <span class="guimenu">Samba
    Server</span> › <span class="guimenu">Add</span>, and checking
    <span class="guimenu">Utilize Btrfs Features</span>.
   </p></div><div class="sect2 " id="sec.samba.advanced.snapshots"><div class="titlepage"><div><div><h3 class="title" id="sec.samba.advanced.snapshots"><span class="number">21.8.2 </span><span class="name">Snapshots</span> <a title="Permalink" class="permalink" href="#sec.samba.advanced.snapshots">#</a></h3></div></div></div><p>
    Snapshots, also called Shadow Copies, are copies of the state of a file
    system subvolume at a certain point of time. Snapper is the tool to manage
    these snapshots in Linux. Snapshots are supported on the Btrfs file system
    or thin-provisioned LVM volumes. The Samba suite supports managing of
    remote snapshots through the FSRVP protocol on both the server and client
    side.
   </p><div class="sect3 " id="sec.samba.advanced.snapshots.client"><div class="titlepage"><div><div><h4 class="title" id="sec.samba.advanced.snapshots.client"><span class="number">21.8.2.1 </span><span class="name">Previous Versions</span> <a title="Permalink" class="permalink" href="#sec.samba.advanced.snapshots.client">#</a></h4></div></div></div><p>
     Snapshots on a Samba server can be exposed to remote Windows clients as
     file or directory previous versions.
    </p><p>
     To enable snapshots on a Samba server, the following conditions must be
     fulfilled:
    </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
       The SMB network share resides on a Btrfs subvolume.
      </p></li><li class="listitem "><p>
       The SMB network share path has a related snapper configuration file. You
       can create the snapper file with
      </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> snapper -c &lt;cfg_name&gt; create-config <code class="option">/path/to/share</code></pre></div><p>
       For more information on snapper, see <a class="xref" href="#cha.snapper" title="Chapter 3. System Recovery and Snapshot Management with Snapper">Chapter 3, <em>System Recovery and Snapshot Management with Snapper</em></a>.
      </p></li><li class="listitem "><p>
       The snapshot directory tree must allow access for relevant users. For
       more information, see the PERMISSIONS section of the vfs_snapper manual
       page (<code class="command">man 8 vfs_snapper</code>).
      </p></li></ul></div><p>
     To support remote snapshots, you need to modify the
     <code class="filename">/etc/samba/smb.conf</code> file. You can do it either with
     <span class="guimenu">YaST</span> › <span class="guimenu">Network
     Services</span> › <span class="guimenu">Samba Server</span>, or
     manually by enhancing the relevant share section with
    </p><div class="verbatim-wrap"><pre class="screen">vfs objects = snapper</pre></div><p>
     Note that you need to restart the Samba service for manual
     <code class="filename">smb.conf</code> changes to take effect:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> systemctl restart nmb smb</pre></div><div class="figure" id="fig.yast2.samba.snapshot"><div class="figure-contents"><div class="mediaobject"><a xmlns="" href="images/yast2_samba_snapshot.png"><img src="images/yast2_samba_snapshot.png" width="" alt="Adding a New Samba Share with Snapshotting Enabled" /></a></div></div><div class="figure-title-wrap"><h6 class="figure-title"><span class="number">Figure 21.4: </span><span class="name">Adding a New Samba Share with Snapshotting Enabled </span><a title="Permalink" class="permalink" href="#fig.yast2.samba.snapshot">#</a></h6></div></div><p>
     After being configured, snapshots created by snapper for the Samba share
     path can be accessed from Windows Explorer from a file or directory's
     <span class="guimenu">Previous Versions</span> tab.
    </p><div class="figure" id="fig.samba.win_explorer"><div class="figure-contents"><div class="mediaobject"><a xmlns="" href="images/samba_winexpl_previous_versions.png"><img src="images/samba_winexpl_previous_versions.png" width="" alt="The Previous Versions tab in Windows Explorer" /></a></div></div><div class="figure-title-wrap"><h6 class="figure-title"><span class="number">Figure 21.5: </span><span class="name">The <span class="guimenu">Previous Versions</span> tab in Windows Explorer </span><a title="Permalink" class="permalink" href="#fig.samba.win_explorer">#</a></h6></div></div></div><div class="sect3 " id="sec.samba.advanced.snapshots.server"><div class="titlepage"><div><div><h4 class="title" id="sec.samba.advanced.snapshots.server"><span class="number">21.8.2.2 </span><span class="name">Remote Share Snapshots</span> <a title="Permalink" class="permalink" href="#sec.samba.advanced.snapshots.server">#</a></h4></div></div></div><p>
     By default, snapshots can only be created and deleted on the Samba server
     locally, via the snapper command line utility, or using snapper's time
     line feature.
    </p><p>
     Samba can be configured to process share snapshot creation and deletion
     requests from remote hosts using the File Server Remote VSS Protocol
     (FSRVP).
    </p><p>
     In addition to the configuration and prerequisites documented in
     <a class="xref" href="#sec.samba.advanced.snapshots.client" title="21.8.2.1. Previous Versions">Section 21.8.2.1, “Previous Versions”</a>, the following global
     configuration is required in <code class="filename">/etc/samba/smb.conf</code>:
    </p><div class="verbatim-wrap"><pre class="screen">[global]
rpc_daemon:fssd = fork
registry shares = yes
include = registry</pre></div><p>
     FSRVP clients, including Samba's <code class="command">rpcclient</code> and Windows
     Server 2012 <code class="command">DiskShadow.exe</code>, can then instruct Samba to
     create or delete a snapshot for a given share, and expose the snapshot as
     a new share.
    </p></div><div class="sect3 " id="sec.samba.advanced.snapshots.client.linux"><div class="titlepage"><div><div><h4 class="title" id="sec.samba.advanced.snapshots.client.linux"><span class="number">21.8.2.3 </span><span class="name">Managing Snapshots Remotely from Linux with <code class="command">rpcclient</code></span> <a title="Permalink" class="permalink" href="#sec.samba.advanced.snapshots.client.linux">#</a></h4></div></div></div><p>
     The <code class="systemitem">samba-client</code> package contains an FSRVP client
     that can remotely request a Windows/Samba server to create and expose a
     snapshot of a given share. You can then use existing tools in
     <span class="productname"><span class="phrase">openSUSE Leap</span></span> to mount the exposed share and back up its files. Requests
     to the server are sent using the <code class="command">rpcclient</code> binary.
    </p><div class="complex-example"><div class="example" id="idm140019136380400"><div class="example-title-wrap"><h6 class="example-title"><span class="number">Example 21.4: </span><span class="name">Using <code class="command">rpcclient</code> to Request a Windows Server 2012 Share Snapshot </span><a title="Permalink" class="permalink" href="#idm140019136380400">#</a></h6></div><div class="example-contents"><p>
      Connect to <code class="literal">win-server.example.com</code> server as an
      administrator in an <code class="literal">EXAMPLE</code> domain:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>rpcclient -U '<em class="replaceable ">EXAMPLE</em>\Administrator' ncacn_np:<em class="replaceable ">win-server.example.com</em>[ndr64,sign]
Enter EXAMPLE/Administrator's password:</pre></div><p>
      Check that the SMB share is visible for <code class="command">rpcclient</code>:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>rpcclient $&gt; netshareenum
netname: windows_server_2012_share
remark:
path:   C:\Shares\windows_server_2012_share
password:       (null)</pre></div><p>
      Check that the SMB share supports snapshot creation:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>rpcclient $&gt; fss_is_path_sup windows_server_2012_share \
UNC \\WIN-SERVER\windows_server_2012_share\ supports shadow copy requests</pre></div><p>
      Request the creation of a share snapshot:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>rpcclient $&gt; fss_create_expose backup ro windows_server_2012_share
13fe880e-e232-493d-87e9-402f21019fb6: shadow-copy set created
13fe880e-e232-493d-87e9-402f21019fb6(1c26544e-8251-445f-be89-d1e0a3938777): \
\\WIN-SERVER\windows_server_2012_share\ shadow-copy added to set
13fe880e-e232-493d-87e9-402f21019fb6: prepare completed in 0 secs
13fe880e-e232-493d-87e9-402f21019fb6: commit completed in 1 secs
13fe880e-e232-493d-87e9-402f21019fb6(1c26544e-8251-445f-be89-d1e0a3938777): \
share windows_server_2012_share@{1C26544E-8251-445F-BE89-D1E0A3938777} \
exposed as a snapshot of \\WIN-SERVER\windows_server_2012_share\</pre></div><p>
      Confirm that the snapshot share is exposed by the server:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>rpcclient $&gt; netshareenum
netname: windows_server_2012_share
remark:
path:   C:\Shares\windows_server_2012_share
password:       (null)

netname: windows_server_2012_share@{1C26544E-8251-445F-BE89-D1E0A3938777}
remark: (null)
path:   \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy{F6E6507E-F537-11E3-9404-B8AC6F927453}\Shares\windows_server_2012_share\
password:       (null)</pre></div><p>
      Attempt to delete the snapshot share:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>rpcclient $&gt; fss_delete windows_server_2012_share \
13fe880e-e232-493d-87e9-402f21019fb6 1c26544e-8251-445f-be89-d1e0a3938777
13fe880e-e232-493d-87e9-402f21019fb6(1c26544e-8251-445f-be89-d1e0a3938777): \
\\WIN-SERVER\windows_server_2012_share\ shadow-copy deleted</pre></div><p>
      Confirm that the snapshot share has been removed by the server:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>rpcclient $&gt; netshareenum
netname: windows_server_2012_share
remark:
path:   C:\Shares\windows_server_2012_share
password:       (null)</pre></div></div></div></div></div><div class="sect3 " id="sec.samba.advanced.snapshots.client.winserver"><div class="titlepage"><div><div><h4 class="title" id="sec.samba.advanced.snapshots.client.winserver"><span class="number">21.8.2.4 </span><span class="name">Managing Snapshots Remotely from Windows with <code class="command">DiskShadow.exe</code></span> <a title="Permalink" class="permalink" href="#sec.samba.advanced.snapshots.client.winserver">#</a></h4></div></div></div><p>
     You can manage snapshots of SMB shares on the Linux Samba server from the
     Windows environment acting as a client as well. Windows Server 2012
     includes the <code class="command">DiskShadow.exe</code> utility that can manage
     remote shares similar to the <code class="command">rpcclient</code> described in
     <a class="xref" href="#sec.samba.advanced.snapshots.client.linux" title="21.8.2.3. Managing Snapshots Remotely from Linux with rpcclient">Section 21.8.2.3, “Managing Snapshots Remotely from Linux with <code class="command">rpcclient</code>”</a>. Note that you
     need to carefully set up the Samba server first.
    </p><p>
     Following is an example procedure to set up the Samba server so that the
     Windows Server client can manage its share's snapshots. Note that <em class="replaceable ">EXAMPLE</em>
     is the Active Directory domain used in the testing environment,
     <code class="uri">fsrvp-server.example.com</code> is the host name of the Samba server, and
     <code class="filename">/srv/smb</code> is the path to the SMB share.
    </p><div class="procedure " id="idm140019136358752"><div class="procedure-title-wrap"><h6 class="procedure-title"><span class="number">Procedure 21.1: </span><span class="name">Detailed Samba Server Configuration </span><a title="Permalink" class="permalink" href="#idm140019136358752">#</a></h6></div><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
       Join Active Directory domain via YaST.<span class="phrase"> For
       more information, <a class="xref" href="#sec.samba.adnet" title="21.7. Samba Server in the Network with Active Directory">Section 21.7, “Samba Server in the Network with Active Directory”</a>.</span>
      </p></li><li class="step "><p>
       Ensure that the Active Domain DNS entry was correct:
      </p><div class="verbatim-wrap"><pre class="screen">fsrvp-server:~ # net -U 'Administrator' ads dns register \
fsrvp-server.example.com &lt;IP address&gt;
Successfully registered hostname with DNS</pre></div></li><li class="step "><p>
       Create Btrfs subvolume at <code class="filename">/srv/smb</code>
      </p><div class="verbatim-wrap"><pre class="screen">fsrvp-server:~ # btrfs subvolume create /srv/smb</pre></div></li><li class="step "><p>
       Create snapper configuration file for path <code class="filename">/srv/smb</code>
      </p><div class="verbatim-wrap"><pre class="screen">fsrvp-server:~ # snapper -c &lt;snapper_config&gt; create-config /srv/smb</pre></div></li><li class="step "><p>
       Create new share with path <code class="filename">/srv/smb</code>, and YaST
       <span class="guimenu">Expose Snapshots</span> check box enabled. Make sure to add
       the following snippets to the global section of
       <code class="filename">/etc/samba/smb.conf</code> as mentioned in
       <a class="xref" href="#sec.samba.advanced.snapshots.server" title="21.8.2.2. Remote Share Snapshots">Section 21.8.2.2, “Remote Share Snapshots”</a>:
      </p><div class="verbatim-wrap"><pre class="screen">[global]
 rpc_daemon:fssd = fork
 registry shares = yes
 include = registry</pre></div></li><li class="step "><p>
       Restart Samba with <code class="command">systemctl restart nmb smb</code>
      </p></li><li class="step "><p>
       Configure snapper permissions:
      </p><div class="verbatim-wrap"><pre class="screen">fsrvp-server:~ # snapper -c &lt;snapper_config&gt; set-config \
ALLOW_USERS="EXAMPLE\\\\Administrator EXAMPLE\\\\win-client$"</pre></div><p>
       Ensure that any ALLOW_USERS are also permitted traversal of the
       <code class="filename">.snapshots</code> subdirectory.
      </p><div class="verbatim-wrap"><pre class="screen">fsrvp-server:~ # snapper -c &lt;snapper_config&gt; set-config SYNC_ACL=yes</pre></div><div id="idm140019136342960" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.png" /><h6>Important: Path Escaping</h6><p>
        Be careful about the '\' escapes! Escape twice to ensure that the value
        stored in
        <code class="filename">/etc/snapper/configs/&lt;snapper_config&gt;</code> is
        escaped once.
       </p></div><p>
       "EXAMPLE\win-client$" corresponds to the Windows client computer
       account. Windows issues initial FSRVP requests while authenticated with
       this account.
      </p></li><li class="step "><p>
       Grant Windows client account necessary privileges:
      </p><div class="verbatim-wrap"><pre class="screen">fsrvp-server:~ # net -U 'Administrator' rpc rights grant \
"EXAMPLE\\win-client$" SeBackupPrivilege
Successfully granted rights.</pre></div><p>
       The previous command is not needed for the "EXAMPLE\Administrator" user,
       which has privileges already granted.
      </p></li></ol></div></div><div class="procedure " id="idm140019136338048"><div class="procedure-title-wrap"><h6 class="procedure-title"><span class="number">Procedure 21.2: </span><span class="name">Windows Client Setup and <code class="command">DiskShadow.exe</code> in Action </span><a title="Permalink" class="permalink" href="#idm140019136338048">#</a></h6></div><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
       Boot Windows Server 2012 (example host name WIN-CLIENT).
      </p></li><li class="step "><p>
       Join the same Active Directory domain EXAMPLE as with the <span class="productname"><span class="phrase">openSUSE Leap</span></span>.
      </p></li><li class="step "><p>
       Reboot.
      </p></li><li class="step "><p>
       Open Powershell.
      </p></li><li class="step "><p>
       Start <code class="command">DiskShadow.exe</code> and begin the backup procedure:
      </p><div class="verbatim-wrap"><pre class="screen">PS C:\Users\Administrator.EXAMPLE&gt; diskshadow.exe
Microsoft DiskShadow version 1.0
Copyright (C) 2012 Microsoft Corporation
On computer:  WIN-CLIENT,  6/17/2014 3:53:54 PM

DISKSHADOW&gt; begin backup</pre></div></li><li class="step "><p>
       Specify that shadow copy persists across program exit, reset or reboot:
      </p><div class="verbatim-wrap"><pre class="screen">DISKSHADOW&gt; set context PERSISTENT</pre></div></li><li class="step "><p>
       Check whether the specified share supports snapshots, and create one:
      </p><div class="verbatim-wrap"><pre class="screen">DISKSHADOW&gt; add volume \\fsrvp-server\sles_snapper

DISKSHADOW&gt; create
Alias VSS_SHADOW_1 for shadow ID {de4ddca4-4978-4805-8776-cdf82d190a4a} set as \
 environment variable.
Alias VSS_SHADOW_SET for shadow set ID {c58e1452-c554-400e-a266-d11d5c837cb1} \
 set as environment variable.

Querying all shadow copies with the shadow copy set ID \
 {c58e1452-c554-400e-a266-d11d5c837cb1}

 * Shadow copy ID = {de4ddca4-4978-4805-8776-cdf82d190a4a}     %VSS_SHADOW_1%
    - Shadow copy set: {c58e1452-c554-400e-a266-d11d5c837cb1}  %VSS_SHADOW_SET%
    - Original count of shadow copies = 1
    - Original volume name: \\FSRVP-SERVER\SLES_SNAPPER\ \
      [volume not on this machine]
    - Creation time: 6/17/2014 3:54:43 PM
    - Shadow copy device name:
      \\FSRVP-SERVER\SLES_SNAPPER@{31afd84a-44a7-41be-b9b0-751898756faa}
    - Originating machine: FSRVP-SERVER
    - Service machine: win-client.example.com
    - Not exposed
    - Provider ID: {89300202-3cec-4981-9171-19f59559e0f2}
    - Attributes:  No_Auto_Release Persistent FileShare

Number of shadow copies listed: 1</pre></div></li><li class="step "><p>
       Finish the backup procedure:
      </p><div class="verbatim-wrap"><pre class="screen">DISKSHADOW&gt; end backup</pre></div></li><li class="step "><p>
       After the snapshot was created, try to delete it and verify the
       deletion:
      </p><div class="verbatim-wrap"><pre class="screen">DISKSHADOW&gt; delete shadows volume \\FSRVP-SERVER\SLES_SNAPPER\
Deleting shadow copy {de4ddca4-4978-4805-8776-cdf82d190a4a} on volume \
 \\FSRVP-SERVER\SLES_SNAPPER\ from provider \
{89300202-3cec-4981-9171-19f59559e0f2} [Attributes: 0x04000009]...

Number of shadow copies deleted: 1

DISKSHADOW&gt; list shadows all

Querying all shadow copies on the computer ...
No shadow copies found in system.</pre></div></li></ol></div></div></div></div></div><div class="sect1 " id="sec.samba.info"><div class="titlepage"><div><div><h2 class="title" id="sec.samba.info"><span class="number">21.9 </span><span class="name">For More Information</span> <a title="Permalink" class="permalink" href="#sec.samba.info">#</a></h2></div></div></div><p>
   Documentation for Samba ships with the <code class="systemitem">samba-doc</code>
   package which is not installed by default. Install it with <code class="command">zypper
   install samba-doc</code>. Enter <code class="command">apropos</code>
   <code class="option">samba</code> at the command line to display some manual pages or
   browse the <code class="filename">/usr/share/doc/packages/samba</code> directory for
   more online documentation and examples. Find a commented example
   configuration (<code class="filename">smb.conf.SUSE</code>) in the
   <code class="filename">examples</code> subdirectory. Another file to look for Samba
   related information is
   <code class="filename">/usr/share/doc/packages/samba/README.SUSE</code>.
  </p><p>
   The Samba HOWTO (see <a class="link" href="https://wiki.samba.org" target="_blank">https://wiki.samba.org</a>) provided
   by the Samba team includes a section about troubleshooting. In addition to
   that, Part V of the document provides a step-by-step guide to checking your
   configuration.
  </p></div></div><div class="chapter " id="cha.nfs"><div class="titlepage"><div><div><h2 class="title"><span class="number">22 </span><span class="name">Sharing File Systems with NFS</span> <a title="Permalink" class="permalink" href="#cha.nfs">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">Filename: </span>net_nfs.xml</li><li><span class="ds-label">ID: </span>cha.nfs</li></ul></div></div><div><div class="abstract"><div class="abstract-title-wrap"><h6 class="abstract-title">Abstract<a title="Permalink" class="permalink" href="#idm140019136312672">#</a></h6></div><p>
    The <span class="emphasis"><em>Network File System</em></span> (<span class="emphasis"><em>NFS</em></span>)
    is a protocol that allows access to files on a server very similar to
    accessing local files.
   </p></div></div></div></div><div class="line"><div class="toc"><dl><dt><span class="sect1"><a href="#sec.nfs.overview"><span class="number">22.1 </span><span class="name">Overview</span></a></span></dt><dt><span class="sect1"><a href="#sec.nfs.installation"><span class="number">22.2 </span><span class="name">Installing NFS Server</span></a></span></dt><dt><span class="sect1"><a href="#sec.nfs.configuring-nfs-server"><span class="number">22.3 </span><span class="name">Configuring NFS Server</span></a></span></dt><dt><span class="sect1"><a href="#sec.nfs.configuring-nfs-clients"><span class="number">22.4 </span><span class="name">Configuring Clients</span></a></span></dt><dt><span class="sect1"><a href="#sec.nfs.info"><span class="number">22.5 </span><span class="name">For More Information</span></a></span></dt></dl></div></div><div class="sect1 " id="sec.nfs.overview"><div class="titlepage"><div><div><h2 class="title" id="sec.nfs.overview"><span class="number">22.1 </span><span class="name">Overview</span> <a title="Permalink" class="permalink" href="#sec.nfs.overview">#</a></h2></div></div></div><p>
   The <span class="emphasis"><em>Network File System</em></span> (NFS) is a standardized,
   well-proven and widely supported network protocol that allows files to
   be shared between separate hosts.
  </p><p>
   The <span class="emphasis"><em>Network Information Service</em></span> (NIS) can be used
   to have a centralized user management in the network. Combining NFS
   and NIS allows using file and directory permissions for access control
   in the network. NFS with NIS makes a network transparent to the user.
  </p><p>
   In the default configuration, NFS completely trusts the network and
   thus any machine which is connected to a trusted network. Any user
   with administrator privileges on any computer with physical access to
   any network which the NFS server trusts at all, can access any files
   that the server makes available.
  </p><p>
   In many cases, this level of security is perfectly satisfactory, such
   as when the network that is trusted is truly private, often localized
   to a single cabinet or machine room, and no unauthorized access is
   possible. In other cases the need to trust a whole subnet as a unit
   is restrictive and there is a need for more fine-grained trust. To
   meet the need in these cases, NFS supports various security levels
   using the <span class="emphasis"><em>Kerberos</em></span> infrastructure. Kerberos requires
   NFSv4, which is used by default. For details, see
   <span class="intraxref">Book “<em class="citetitle ">Security Guide</em>”, Chapter 6 “Network Authentication with Kerberos”</span>.
  </p><p>
   The following are terms used in the YaST module.
  </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019136302480"><span class="term ">Exports</span></dt><dd><p>
      A directory <span class="emphasis"><em>exported</em></span> by an NFS server, which clients
      can integrate it into their system.
     </p></dd><dt id="idm140019136300176"><span class="term ">NFS Client</span></dt><dd><p>
      The NFS client is a system that uses NFS services from an NFS server over
      the Network File System protocol. The TCP/IP protocol is already
      integrated into the Linux kernel; there is no need to install any
      additional software.
     </p></dd><dt id="idm140019136298144"><span class="term ">NFS Server</span></dt><dd><p>
      The NFS server provides NFS services to clients. A running server depends
      on the following daemons: <code class="systemitem">nfsd</code>
      (worker), <code class="systemitem">idmapd</code> (ID-to-name
      mapping for NFSv4, needed for certain scenarios only), <code class="systemitem">statd</code> (file locking), and <code class="systemitem">mountd</code> (mount requests).
     </p></dd><dt id="idm140019136293296"><span class="term ">NFSv3</span></dt><dd><p>
      NFSv3 is the version 3 implementation, the <span class="quote">“<span class="quote">old</span>”</span> stateless
      NFS that supports client authentication.
     </p></dd><dt id="idm140019136290976"><span class="term ">NFSv4</span></dt><dd><p>
      NFSv4 is the new version 4 implementation that supports secure user
      authentication via kerberos. NFSv4 requires one single port only and thus
      is better suited for environments behind a firewall than NFSv3.
     </p><p>
      The protocol is specified as
      <a class="link" href="http://tools.ietf.org/html/rfc3530" target="_blank">http://tools.ietf.org/html/rfc3530</a>.
     </p></dd><dt id="idm140019136287920"><span class="term ">pNFS</span></dt><dd><p>
      Parallel NFS, a protocol extension of NFSv4. Any pNFS clients can
      directly access the data on an NFS server.
     </p></dd></dl></div><div id="idm140019136285856" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.png" /><h6>Important: Need for DNS</h6><p>
    In principle, all exports can be made using IP addresses only. To avoid
    time-outs, you need a working DNS system. DNS is necessary at least for
    logging purposes, because the mountd daemon does reverse lookups.
   </p></div></div><div class="sect1 " id="sec.nfs.installation"><div class="titlepage"><div><div><h2 class="title" id="sec.nfs.installation"><span class="number">22.2 </span><span class="name">Installing NFS Server</span> <a title="Permalink" class="permalink" href="#sec.nfs.installation">#</a></h2></div></div></div><p>
   The NFS server is not part of the default installation. To install the NFS
   server using YaST, choose <span class="guimenu">Software</span> › <span class="guimenu">Software Management</span>, select
   <span class="guimenu">Patterns</span>, and enable the <span class="guimenu">File Server</span>
   option in the <span class="guimenu">Server Functions</span> section. Press
   <span class="guimenu">Accept</span> to install the required packages.
  </p><p>
   Like NIS, NFS is a client/server system. However, a machine can be
   both—it can supply file systems over the network (export) and mount
   file systems from other hosts (import).
  </p><div id="idm140019136278272" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note: Mounting NFS Volumes Locally on the Exporting Server</h6><p>
    Mounting NFS volumes locally on the exporting server is not supported on
    <span class="productname"><span class="phrase">openSUSE Leap</span></span>.
   </p></div></div><div class="sect1 " id="sec.nfs.configuring-nfs-server"><div class="titlepage"><div><div><h2 class="title" id="sec.nfs.configuring-nfs-server"><span class="number">22.3 </span><span class="name">Configuring NFS Server</span> <a title="Permalink" class="permalink" href="#sec.nfs.configuring-nfs-server">#</a></h2></div></div></div><p>
   Configuring an NFS server can be done either through YaST or manually. For
   authentication, NFS can also be combined with Kerberos.
  </p><div class="sect2 " id="sec.nfs.export-yast2"><div class="titlepage"><div><div><h3 class="title" id="sec.nfs.export-yast2"><span class="number">22.3.1 </span><span class="name">Exporting File Systems with YaST</span> <a title="Permalink" class="permalink" href="#sec.nfs.export-yast2">#</a></h3></div></div></div><p>
    With YaST, turn a host in your network into an NFS server—a server
    that exports directories and files to all hosts granted access to it or to
    all members of a group. Thus, the server can also provide applications
    without installing the applications locally on every host.
   </p><p>
    To set up such a server, proceed as follows:
   </p><div class="procedure " id="pro.nfs.export-yast2.nfs"><div class="procedure-title-wrap"><h6 class="procedure-title"><span class="number">Procedure 22.1: </span><span class="name">Setting Up an NFS Server </span><a title="Permalink" class="permalink" href="#pro.nfs.export-yast2.nfs">#</a></h6></div><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
      Start YaST and select <span class="guimenu">Network Services</span> › <span class="guimenu">NFS Server</span>; see
      <a class="xref" href="#fig.inst.nfsserver1" title="NFS Server Configuration Tool">Figure 22.1, “NFS Server Configuration Tool”</a>. You may be prompted to install
      additional software.
     </p><div class="figure" id="fig.inst.nfsserver1"><div class="figure-contents"><div class="mediaobject"><a xmlns="" href="images/yast2_inst_nfsserver1_kde.png"><img src="images/yast2_inst_nfsserver1_kde.png" width="" alt="NFS Server Configuration Tool" /></a></div></div><div class="figure-title-wrap"><h6 class="figure-title"><span class="number">Figure 22.1: </span><span class="name">NFS Server Configuration Tool </span><a title="Permalink" class="permalink" href="#fig.inst.nfsserver1">#</a></h6></div></div></li><li class="step "><p>
      Activate the <span class="guimenu">Start</span> radio button.
     </p></li><li class="step "><p>
      If a firewall is active on your system (SuSEfirewall2), check
      <span class="guimenu">Open Ports in Firewall</span>. YaST adapts its
      configuration for the NFS server by enabling the
      <code class="systemitem">nfs</code> service.
     </p></li><li class="step "><p>
      Check whether you want to <span class="guimenu">Enable NFSv4</span>. If you
      deactivate NFSv4, YaST will only support NFSv3. For information about
      enabling NFSv2, see <a class="xref" href="#sec.nfs.export.manual.nsfv2" title="Note: NFSv2">Note: NFSv2</a>.
     </p><ol type="a" class="substeps "><li class="step "><p>
        If NFSv4 is selected, additionally enter the appropriate NFSv4 domain
        name. This parameter is used by the <code class="systemitem">idmapd</code> daemon that is required for Kerberos
        setups or if clients cannot work with numeric user names. Leave it as
        <code class="literal">localdomain</code> (the default) if you do not run
        <code class="systemitem">idmapd</code> or do not have any
        special requirements. For more information on the <code class="systemitem">idmapd</code> daemon see <a class="xref" href="#var.nfs.export.manual.idmapd"><code class="filename">/etc/idmapd.conf</code></a>.
       </p></li></ol></li><li class="step "><p>
      Click <span class="guimenu">Enable GSS Security</span> if you need secure access to
      the server. A prerequisite for this is to have Kerberos installed on your
      domain and to have both the server and the clients kerberized.
      
      Click <span class="guimenu">Next</span> to proceed with the next configuration
      dialog.
     </p></li><li class="step "><p>
      Click <span class="guimenu">Add Directory</span> in the upper half of the dialog to
      export your directory.
     </p></li><li class="step "><p>
      If you have not configured the allowed hosts already, another dialog for
      entering the client information and options pops up automatically. Enter
      the host wild card (usually you can leave the default settings as they
      are).
     </p><p>
      There are four possible types of host wild cards that can be set for each
      host: a single host (name or IP address), netgroups, wild cards (such as
      <code class="literal">*</code> indicating all machines can access the server), and
      IP networks.
     </p><p>
      For more information about these options, see the
      <code class="literal">exports</code> man page.
     </p></li><li class="step "><p>
      Click <span class="guimenu">Finish</span> to complete the configuration.
     </p></li></ol></div></div></div><div class="sect2 " id="sec.nfs.export.manual"><div class="titlepage"><div><div><h3 class="title" id="sec.nfs.export.manual"><span class="number">22.3.2 </span><span class="name">Exporting File Systems Manually</span> <a title="Permalink" class="permalink" href="#sec.nfs.export.manual">#</a></h3></div></div></div><p>
    The configuration files for the NFS export service are
    <code class="filename">/etc/exports</code> and
    <code class="filename">/etc/sysconfig/nfs</code>. In addition to these files,
    <code class="filename">/etc/idmapd.conf</code> is needed for the NFSv4 server
    configuration with kerberized NFS or if the clients cannot work with
    numeric user names.
   </p><p>
    To start or restart the services, run the command
    <code class="command">systemctl restart nfsserver</code>. This also restarts the
    RPC portmapper that is required by the NFS server.
   </p><p>
    To make sure the NFS server always starts at boot time, run <code class="command">sudo
    systemctl enable nfsserver</code>.
   </p><div id="idm140019136236160" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note: NFSv4</h6><p>
     NFSv4 is the latest version of NFS protocol available on <span class="productname"><span class="phrase">openSUSE Leap</span></span>.
     Configuring directories for export with NFSv4 is now the same as with
     NFSv3.
    </p><p>
     On <span class="phrase">openSUSE
     prior to Leap</span>, the bind mount in
     <code class="filename">/etc/exports</code> was mandatory. It is still supported,
     but now deprecated.
    </p></div><div class="variablelist "><dl class="variablelist"><dt id="idm140019136231584"><span class="term "><code class="filename">/etc/exports</code></span></dt><dd><p>
       The <code class="filename">/etc/exports</code> file contains a list of entries.
       Each entry indicates a directory that is shared and how it is shared. A
       typical entry in <code class="filename">/etc/exports</code> consists of:
      </p><div class="verbatim-wrap"><pre class="screen">/<em class="replaceable ">SHARED</em>/<em class="replaceable ">DIRECTORY</em>   <em class="replaceable ">HOST</em>(<em class="replaceable ">OPTION_LIST</em>)</pre></div><p>
       For example:
      </p><div class="verbatim-wrap"><pre class="screen">/export/data   192.168.1.2(rw,sync)</pre></div><p>
       Here the IP address <code class="literal">192.168.1.2</code> is used to identify
       the allowed client. You can also use the name of the host, a wild card
       indicating a set of hosts (<code class="literal">*.abc.com</code>,
       <code class="literal">*</code>, etc.), or netgroups
       (<code class="literal">@my-hosts</code>).
      </p><p>
       For a detailed explanation of all options and their meaning, refer to
       the man page of <code class="filename">/etc/exports</code> (<code class="command">man
       exports</code>).
      </p><p>
       In case you have modified <code class="filename">/etc/exports</code> while the
       NFS server was running, you need to restart it for the changes to become
       active: <code class="command">sudo systemctl restart nfsserver</code>.
      </p></dd><dt id="idm140019136220192"><span class="term "><code class="filename">/etc/sysconfig/nfs</code></span></dt><dd><p>
       The <code class="filename">/etc/sysconfig/nfs</code> file contains a few
       parameters that determine NFSv4 server daemon behavior. It is important
       to set the parameter <code class="systemitem">NFS4_SUPPORT</code> to
       <code class="literal">yes</code> (default). <code class="systemitem">NFS4_SUPPORT</code>
       determines whether the NFS server supports NFSv4 exports and clients.
      </p><p>
       In case you have modified <code class="filename">/etc/sysconfig/nfs</code> while
       the NFS server was running, you need to restart it for the changes to
       become active: <code class="command">sudo systemctl restart nfsserver</code>.
      </p><div id="idm140019136215152" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.png" /><h6>Tip: Mount Options</h6><p>
        On <span class="phrase">openSUSE prior to Leap</span>, the
        <code class="option">--bind</code> mount in <code class="filename">/etc/exports</code> was
        mandatory. It is still supported, but now deprecated. Configuring
        directories for export with NFSv4 is now the same as with NFSv3.
       </p></div><div id="sec.nfs.export.manual.nsfv2" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note: NFSv2</h6><p>
        If NFS clients still depend on NFSv2, enable it on the server in
        <code class="filename">/etc/sysconfig/nfs</code> by setting:
       </p><div class="verbatim-wrap"><pre class="screen">NFSD_OPTIONS="-V2"
MOUNTD_OPTIONS="-V2"</pre></div><p>
        After restarting the service, check whether version 2 is available
        with the command:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>cat /proc/fs/nfsd/versions
+2 +3 +4 +4.1 -4.2</pre></div></div></dd><dt id="var.nfs.export.manual.idmapd"><span class="term "><code class="filename">/etc/idmapd.conf</code></span></dt><dd><p>
       Starting with SLE 12 SP1, the <code class="systemitem">idmapd</code> daemon is only required if Kerberos
       authentication is used, or if clients cannot work with numeric user
       names. Linux clients can work with numeric user names since Linux kernel
       2.6.39. The <code class="systemitem">idmapd</code> daemon does
       the name-to-ID mapping for NFSv4 requests to the server and replies to
       the client.
      </p><p>
       If required, <code class="systemitem">idmapd</code>
       needs to run on the NFSv4 server. Name-to-ID mapping on the client will
       be done by <code class="command">nfsidmap</code> provided by the package
       <span class="package">nfs-client</span>.
      </p><p>
       Make sure that there is a uniform way in which user names and IDs (uid)
       are assigned to users across machines that might probably be sharing
       file systems using NFS. This can be achieved by using NIS, LDAP, or any
       uniform domain authentication mechanism in your domain.
      </p><p>
       The parameter <code class="literal">Domain</code> must be set the same for both,
       client and server in the <code class="filename">/etc/idmapd.conf</code> file. If
       you are not sure, leave the domain as <code class="literal">localdomain</code> in
       the server and client files. A sample configuration file looks like the
       following:
      </p><div class="verbatim-wrap"><pre class="screen">[General]
Verbosity = 0
Pipefs-Directory = /var/lib/nfs/rpc_pipefs
Domain = localdomain

[Mapping]
Nobody-User = nobody
Nobody-Group = nobody</pre></div><p>
       To start the <code class="systemitem">idmapd</code> daemon, run
       <code class="command">systemctl start nfs-idmapd</code>. In case you have modified
       <code class="filename">/etc/idmapd.conf</code> while the daemon was running, you
       need to restart it for the changes to become active: <code class="command">systemctl
       start nfs-idmapd</code>.
      </p><p>
       For more information, see the man pages of <code class="literal">idmapd</code> and
       <code class="literal">idmapd.conf</code> (<code class="literal">man idmapd</code> and
       <code class="literal">man idmapd.conf</code>).
      </p></dd></dl></div></div><div class="sect2 " id="sec.nfs.kerberos"><div class="titlepage"><div><div><h3 class="title" id="sec.nfs.kerberos"><span class="number">22.3.3 </span><span class="name">NFS with Kerberos</span> <a title="Permalink" class="permalink" href="#sec.nfs.kerberos">#</a></h3></div></div></div><p>
    To use Kerberos authentication for NFS, Generic Security Services (GSS) must be enabled.
    Select <span class="guimenu">Enable GSS Security</span> in the initial YaST NFS
    Server dialog. You must have a working Kerberos server to use this feature.
    YaST does not set up the server but only uses the provided functionality.
    If you want to use Kerberos authentication in addition to the YaST
    configuration, complete at least the following steps before running the NFS
    configuration:
   </p><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
      Make sure that both the server and the client are in the same Kerberos
      domain. They must access the same KDC (Key Distribution Center) server
      and share their <code class="filename">krb5.keytab</code> file (the default
      location on any machine is <code class="filename">/etc/krb5.keytab</code>). For
      more information about Kerberos, see
      <span class="intraxref">Book “<em class="citetitle ">Security Guide</em>”, Chapter 6 “Network Authentication with Kerberos”</span>.
     </p></li><li class="step "><p>
      Start the gssd service on the client with <code class="command">systemctl start
      rpc-gssd.service</code>.
     </p></li><li class="step "><p>
      Start the svcgssd service on the server with <code class="command">systemctl start
      rpc-svcgssd.service</code>.
     </p></li></ol></div></div><p>
    Kerberos authentication also requires the <code class="systemitem">idmapd</code> daemon to run on the server. For more
    information refer to <a class="xref" href="#var.nfs.export.manual.idmapd"><code class="filename">/etc/idmapd.conf</code></a>.
   </p><p>
    For more information about configuring kerberized NFS, refer to the links
    in <a class="xref" href="#sec.nfs.info" title="22.5. For More Information">Section 22.5, “For More Information”</a>.
   </p></div></div><div class="sect1 " id="sec.nfs.configuring-nfs-clients"><div class="titlepage"><div><div><h2 class="title" id="sec.nfs.configuring-nfs-clients"><span class="number">22.4 </span><span class="name">Configuring Clients</span> <a title="Permalink" class="permalink" href="#sec.nfs.configuring-nfs-clients">#</a></h2></div></div></div><p>
   To configure your host as an NFS client, you do not need to install
   additional software. All needed packages are installed by default.
  </p><div class="sect2 " id="sec.nfs.import-yast2"><div class="titlepage"><div><div><h3 class="title" id="sec.nfs.import-yast2"><span class="number">22.4.1 </span><span class="name">Importing File Systems with YaST</span> <a title="Permalink" class="permalink" href="#sec.nfs.import-yast2">#</a></h3></div></div></div><p>
    Authorized users can mount NFS directories from an NFS server into the
    local file tree using the YaST NFS client module. Proceed as follows:
   </p><div class="procedure " id="pro.nfs.import-yast2"><div class="procedure-title-wrap"><h6 class="procedure-title"><span class="number">Procedure 22.2: </span><span class="name">Importing NFS Directories </span><a title="Permalink" class="permalink" href="#pro.nfs.import-yast2">#</a></h6></div><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
      Start the YaST NFS client module.
     </p></li><li class="step "><p>
      Click <span class="guimenu">Add</span> in the <span class="guimenu">NFS Shares</span> tab.
      Enter the host name of the NFS server, the directory to import, and the
      mount point at which to mount this directory locally.
     </p></li><li class="step "><p>
      When using NFSv4, select <span class="guimenu">Enable NFSv4</span> in the
      <span class="guimenu">NFS Settings</span> tab. Additionally, the <span class="guimenu">NFSv4
      Domain Name</span> must contain the same value as used by the NFSv4
      server. The default domain is <code class="literal">localdomain</code>.
     </p></li><li class="step "><p>
      To use Kerberos authentication for NFS, GSS security must be enabled.
      Select <span class="guimenu">Enable GSS Security</span>.
     </p></li><li class="step "><p>
      Enable <span class="guimenu">Open Port in Firewall</span> in the <span class="guimenu">NFS
      Settings</span> tab if you use a Firewall and want to allow access to
      the service from remote computers. The firewall status is displayed next
      to the check box.
     </p></li><li class="step "><p>
      Click <span class="guimenu">OK</span> to save your changes.
     </p></li></ol></div></div><p>
    The configuration is written to <code class="filename">/etc/fstab</code> and the
    specified file systems are mounted. When you start the YaST configuration
    client at a later time, it also reads the existing configuration from this
    file.
   </p><div id="idm140019136164416" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.png" /><h6>Tip: NFS as a Root File System</h6><p>
     On (diskless) systems, where the root partition is mounted via network as
     an NFS share, you need to be careful when configuring the network device
     with which the NFS share is accessible.
    </p><p>
     When shutting down or rebooting the system, the default processing order
     is to turn off network connections, then unmount the root partition. With
     NFS root, this order causes problems as the root partition cannot be
     cleanly unmounted as the network connection to the NFS share is already
     not activated. To prevent the system from deactivating the relevant
     network device, open the network device configuration tab as described in
     <a class="xref" href="#sec.network.yast.change.start" title="13.4.1.2.5. Activating the Network Device">Section 13.4.1.2.5, “Activating the Network Device”</a> and choose <span class="guimenu">On
     NFSroot</span> in the <span class="guimenu">Device Activation</span> pane.
    </p></div></div><div class="sect2 " id="sec.nfs.import"><div class="titlepage"><div><div><h3 class="title" id="sec.nfs.import"><span class="number">22.4.2 </span><span class="name">Importing File Systems Manually</span> <a title="Permalink" class="permalink" href="#sec.nfs.import">#</a></h3></div></div></div><p>
    The prerequisite for importing file systems manually from an NFS server is
    a running RPC port mapper. The <code class="option">nfs</code> service takes care to
    start it properly; thus, start it by entering <code class="command">systemctl start
    nfs</code> as <code class="systemitem">root</code>. Then
    remote file systems can be mounted in the file system like local partitions
    using <code class="command">mount</code>:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> mount <em class="replaceable ">HOST</em>:<em class="replaceable ">REMOTE-PATH</em><em class="replaceable ">LOCAL-PATH</em></pre></div><p>
    To import user directories from the <code class="systemitem">nfs.example.com</code>
    machine, for example, use:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> mount nfs.example.com:/home /home</pre></div><div class="sect3 " id="sec.nfs.automount"><div class="titlepage"><div><div><h4 class="title" id="sec.nfs.automount"><span class="number">22.4.2.1 </span><span class="name">Using the Automount Service</span> <a title="Permalink" class="permalink" href="#sec.nfs.automount">#</a></h4></div></div></div><p>
     The autofs daemon can be used to mount remote file systems automatically.
     Add the following entry to the <code class="filename">/etc/auto.master</code> file:
    </p><div class="verbatim-wrap"><pre class="screen">/nfsmounts /etc/auto.nfs</pre></div><p>
     Now the <code class="filename">/nfsmounts</code> directory acts as the root for all
     the NFS mounts on the client if the <code class="filename">auto.nfs</code> file is
     filled appropriately. The name <code class="filename">auto.nfs</code> is chosen for
     the sake of convenience—you can choose any name. In
     <code class="filename">auto.nfs</code> add entries for all the NFS mounts as
     follows:
    </p><div class="verbatim-wrap"><pre class="screen">localdata -fstype=nfs server1:/data
nfs4mount -fstype=nfs4 server2:/</pre></div><p>
     Activate the settings with <code class="command">systemctl start autofs</code> as
     <code class="systemitem">root</code>. In this example, <code class="filename">/nfsmounts/localdata</code>,
     the <code class="filename">/data</code> directory of
     <code class="systemitem">server1</code>, is mounted with NFS and
     <code class="filename">/nfsmounts/nfs4mount</code> from
     <code class="systemitem">server2</code> is mounted with NFSv4.
    </p><p>
     If the <code class="filename">/etc/auto.master</code> file is edited while the
     service autofs is running, the automounter must be restarted for the
     changes to take effect with <code class="command">systemctl restart autofs</code>.
    </p></div><div class="sect3 " id="sec.nfs.fstab"><div class="titlepage"><div><div><h4 class="title" id="sec.nfs.fstab"><span class="number">22.4.2.2 </span><span class="name">Manually Editing <code class="filename">/etc/fstab</code></span> <a title="Permalink" class="permalink" href="#sec.nfs.fstab">#</a></h4></div></div></div><p>
     A typical NFSv3 mount entry in <code class="filename">/etc/fstab</code> looks like
     this:
    </p><div class="verbatim-wrap"><pre class="screen">nfs.example.com:/data /local/path nfs rw,noauto 0 0</pre></div><p>
     For NFSv4 mounts, use <code class="literal">nfs4</code> instead of
     <code class="literal">nfs</code> in the third column:
    </p><div class="verbatim-wrap"><pre class="screen">nfs.example.com:/data /local/pathv4 nfs4 rw,noauto 0 0</pre></div><p>
     The <code class="literal">noauto</code> option prevents the file system from being
     mounted automatically at start-up. If you want to mount the respective
     file system manually, it is possible to shorten the mount command
     specifying the mount point only:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> mount /local/path</pre></div><div id="idm140019136134384" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note: Mounting at Start-Up</h6><p>
      If you do not enter the <code class="literal">noauto</code> option, the init
      scripts of the system will handle the mount of those file systems at
      start-up.
     </p></div></div></div><div class="sect2 " id="sec.nfs.pnfs"><div class="titlepage"><div><div><h3 class="title" id="sec.nfs.pnfs"><span class="number">22.4.3 </span><span class="name">Parallel NFS (pNFS)</span> <a title="Permalink" class="permalink" href="#sec.nfs.pnfs">#</a></h3></div></div></div><p>
    NFS is one of the oldest protocols, developed in the '80s. As such, NFS is
    usually sufficient if you want to share small files. However, when you want
    to transfer big files or large numbers of clients want to access data, an
    NFS server becomes a bottleneck and has a significant impact on the system
    performance. This is because of files quickly getting bigger, whereas the
    relative speed of your Ethernet has not fully kept up.
   </p><p>
    When you request a file from a regular NFS server, the server
    looks up the file metadata, collects all the data and transfers it over the
    network to your client. However, the performance bottleneck becomes
    apparent no matter how small or big the files are:
   </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
      With small files most of the time is spent collecting the metadata.
     </p></li><li class="listitem "><p>
      With big files most of the time is spent on transferring the data from
      server to client.
     </p></li></ul></div><p>
    pNFS, or parallel NFS, overcomes this limitation as it separates the file
    system metadata from the location of the data. As such, pNFS requires two
    types of servers:
   </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
      A <span class="emphasis"><em>metadata</em></span> or <span class="emphasis"><em>control server</em></span>
      that handles all the non-data traffic
     </p></li><li class="listitem "><p>
      One or more <span class="emphasis"><em>storage server(s)</em></span> that hold(s) the data
     </p></li></ul></div><p>
    The metadata and the storage servers form a single, logical NFS server.
    When a client wants to read or write, the metadata server tells the NFSv4
    client which storage server to use to access the file chunks. The client
    can access the data directly on the server.
   </p><p>
    <span class="productname"><span class="phrase">openSUSE Leap</span></span> supports pNFS on the client side only.
   </p><div class="sect3 " id="sec.nfs.pnfs.yast"><div class="titlepage"><div><div><h4 class="title" id="sec.nfs.pnfs.yast"><span class="number">22.4.3.1 </span><span class="name">Configuring pNFS Client With YaST</span> <a title="Permalink" class="permalink" href="#sec.nfs.pnfs.yast">#</a></h4></div></div></div><p>
     Proceed as described in <a class="xref" href="#pro.nfs.import-yast2" title="Importing NFS Directories">Procedure 22.2, “Importing NFS Directories”</a>, but click
     the <span class="guimenu">pNFS (v4.1)</span> check box and optionally <span class="guimenu">NFSv4
     share</span>. YaST will do all the necessary steps and will write all
     the required options in the file <code class="filename">/etc/exports</code>.
     
    </p></div><div class="sect3 " id="sec.nfs.pnfs.manual"><div class="titlepage"><div><div><h4 class="title" id="sec.nfs.pnfs.manual"><span class="number">22.4.3.2 </span><span class="name">Configuring pNFS Client Manually</span> <a title="Permalink" class="permalink" href="#sec.nfs.pnfs.manual">#</a></h4></div></div></div><p>
     Refer to <a class="xref" href="#sec.nfs.import" title="22.4.2. Importing File Systems Manually">Section 22.4.2, “Importing File Systems Manually”</a> to start. Most of the
     configuration is done by the NFSv4 server. For pNFS, the only difference
     is to add the <code class="option">minorversion</code> option and the metadata server
     <em class="replaceable ">MDS_SERVER</em> to your <code class="command">mount</code>
     command:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> mount -t nfs4 -o minorversion=1 <em class="replaceable ">MDS_SERVER</em> <em class="replaceable ">MOUNTPOINT</em></pre></div><p>
     To help with debugging, change the value in the <code class="filename">/proc</code>
     file system:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> echo 32767 &gt; /proc/sys/sunrpc/nfsd_debug
<code class="prompt user">tux &gt; </code><code class="command">sudo</code> echo 32767 &gt; /proc/sys/sunrpc/nfs_debug</pre></div></div></div></div><div class="sect1 " id="sec.nfs.info"><div class="titlepage"><div><div><h2 class="title" id="sec.nfs.info"><span class="number">22.5 </span><span class="name">For More Information</span> <a title="Permalink" class="permalink" href="#sec.nfs.info">#</a></h2></div></div></div><p>
   In addition to the man pages of <code class="command">exports</code>,
   <code class="command">nfs</code>, and <code class="command">mount</code>, information about
   configuring an NFS server and client is available in
   <code class="filename">/usr/share/doc/packages/nfsidmap/README</code>. For further
   documentation online refer to the following Web sites:
  </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
     Find the detailed technical documentation online at
     <a class="link" href="http://nfs.sourceforge.net/" target="_blank">SourceForge</a>.
    </p></li><li class="listitem "><p>
     For instructions for setting up kerberized NFS, refer to
     <a class="link" href="http://www.citi.umich.edu/projects/nfsv4/linux/krb5-setup.html" target="_blank">NFS
     Version 4 Open Source Reference Implementation</a>.
    </p></li><li class="listitem "><p>
     If you have questions on NFSv4, refer to the
     <a class="link" href="http://www.citi.umich.edu/projects/nfsv4/linux/faq/" target="_blank">Linux
     NFSv4 FAQ</a>.
    </p></li></ul></div></div></div><div class="chapter " id="cha.autofs"><div class="titlepage"><div><div><h2 class="title"><span class="number">23 </span><span class="name">On-Demand Mounting with Autofs</span> <a title="Permalink" class="permalink" href="#cha.autofs">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">Filename: </span>autofs.xml</li><li><span class="ds-label">ID: </span>cha.autofs</li></ul></div></div><div><div class="abstract"><div class="abstract-title-wrap"><h6 class="abstract-title">Abstract<a title="Permalink" class="permalink" href="#idm140019136092432">#</a></h6></div><p>
    <code class="systemitem">autofs</code> is a program that automatically mounts
    specified directories on an on-demand basis. It is based on a kernel module
    for high efficiency, and can manage both local directories and network
    shares. These automatic mount points are mounted only when they are
    accessed, and unmounted after a certain period of inactivity. This
    on-demand behavior saves bandwidth and results in better performance than
    static mounts managed by <code class="filename">/etc/fstab</code>. While
    <code class="systemitem">autofs</code> is a control script,
    <code class="command">automount</code> is the command (daemon) that does the actual
    auto-mounting.
   </p></div></div></div></div><div class="line"><div class="toc"><dl><dt><span class="sect1"><a href="#sec.autofs.installation"><span class="number">23.1 </span><span class="name">Installation</span></a></span></dt><dt><span class="sect1"><a href="#sec.autofs.configuration"><span class="number">23.2 </span><span class="name">Configuration</span></a></span></dt><dt><span class="sect1"><a href="#sec.autofs.debugging"><span class="number">23.3 </span><span class="name">Operation and Debugging</span></a></span></dt><dt><span class="sect1"><a href="#sec.autofs.nfs"><span class="number">23.4 </span><span class="name">Auto-Mounting an NFS Share</span></a></span></dt><dt><span class="sect1"><a href="#sec.autofs.advanced"><span class="number">23.5 </span><span class="name">Advanced Topics</span></a></span></dt></dl></div></div><div class="sect1 " id="sec.autofs.installation"><div class="titlepage"><div><div><h2 class="title" id="sec.autofs.installation"><span class="number">23.1 </span><span class="name">Installation</span> <a title="Permalink" class="permalink" href="#sec.autofs.installation">#</a></h2></div></div></div><p>
   <code class="systemitem">autofs</code> is not installed on <span class="productname"><span class="phrase">openSUSE Leap</span></span> by
   default. To use its auto-mounting capabilities, first install it with
  </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> sudo zypper install autofs</pre></div></div><div class="sect1 " id="sec.autofs.configuration"><div class="titlepage"><div><div><h2 class="title" id="sec.autofs.configuration"><span class="number">23.2 </span><span class="name">Configuration</span> <a title="Permalink" class="permalink" href="#sec.autofs.configuration">#</a></h2></div></div></div><p>
   You need to configure <code class="systemitem">autofs</code> manually by editing
   its configuration files with a text editor, such as <code class="command">vim</code>.
   There are two basic steps to configure
   <code class="systemitem">autofs</code>—the <span class="emphasis"><em>master</em></span> map
   file, and specific map files.
  </p><div class="sect2 " id="sec.autofs.configuration.master_map"><div class="titlepage"><div><div><h3 class="title" id="sec.autofs.configuration.master_map"><span class="number">23.2.1 </span><span class="name">The Master Map File</span> <a title="Permalink" class="permalink" href="#sec.autofs.configuration.master_map">#</a></h3></div></div></div><p>
    The default master configuration file for <code class="systemitem">autofs</code>
    is <code class="filename">/etc/auto.master</code>. You can change its location by
    changing the value of the <code class="option">DEFAULT_MASTER_MAP_NAME</code> option
    in <code class="filename">/etc/sysconfig/autofs</code>. Here is the content of the
    default one for <span class="productname"><span class="phrase">openSUSE Leap</span></span>:
   </p><div class="verbatim-wrap"><pre class="screen">#
# Sample auto.master file
# This is an automounter map and it has the following format
# key [ -mount-options-separated-by-comma ] location
# For details of the format look at autofs(5).<span id="co.autofs.manpage"></span><span class="callout">1</span>
#
#/misc  /etc/auto.misc<span id="co.autofs.map"></span><span class="callout">2</span>
#/net -hosts
#
# Include /etc/auto.master.d/*.autofs<span id="co.autofs.include"></span><span class="callout">3</span>
#
#+dir:/etc/auto.master.d
#
# Include central master map if it can be found using
# nsswitch sources.
#
# Note that if there are entries for /net or /misc (as
# above) in the included master map any keys that are the
# same will not be seen as the first read key seen takes
# precedence.
#
+auto.master<span id="co.autofs.plus"></span><span class="callout">4</span></pre></div><div class="calloutlist "><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#co.autofs.manpage"><span class="callout">1</span></a> </p></td><td valign="top" align="left"><p>
      The <code class="systemitem">autofs</code> manual page (<code class="command">man 5
      autofs</code>) offers a lot of valuable information on the format of
      the automounter maps.
     </p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#co.autofs.map"><span class="callout">2</span></a> </p></td><td valign="top" align="left"><p>
      Although commented out (#) by default, this is an example of a simple
      automounter mapping syntax.
     </p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#co.autofs.include"><span class="callout">3</span></a> </p></td><td valign="top" align="left"><p>
      In case you need to split the master map into several files, uncomment
      the line, and put the mappings (suffixed with <code class="literal">.autofs</code>)
      in the <code class="filename">/etc/auto.master.d/</code> directory.
     </p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#co.autofs.plus"><span class="callout">4</span></a> </p></td><td valign="top" align="left"><p>
      <code class="literal">+auto.master</code> ensures that those using NIS
      <span class="phrase">(see <span class="intraxref">Book “<em class="citetitle ">Security Guide</em>”, Chapter 3 “Using NIS”, Section 3.1 “Configuring NIS Servers”</span> for more
      information on NIS)</span> will still find their master map.
     </p></td></tr></table></div><p>
    Entries in <code class="filename">auto.master</code> have three fields with the
    following syntax:
   </p><div class="verbatim-wrap"><pre class="screen">mount point      map name      options</pre></div><div class="variablelist "><dl class="variablelist"><dt id="idm140019136062032"><span class="term ">mount point</span></dt><dd><p>
       The base location where to mount the <code class="systemitem">autofs</code>
       file system, such as <code class="literal">/home</code>.
      </p></dd><dt id="idm140019136059296"><span class="term ">map name</span></dt><dd><p>
       The name of a map source to use for mounting. For the syntax of the maps
       files, see <a class="xref" href="#sec.autofs.mapfiles" title="23.2.2. Map Files">Section 23.2.2, “Map Files”</a>.
      </p></dd><dt id="idm140019136056864"><span class="term ">options</span></dt><dd><p>
       These options (if specified) will apply as defaults to all entries in
       the given map.
      </p></dd></dl></div><div id="idm140019136054816" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.png" /><h6>Tip: For More Information</h6><p>
     For more detailed information on the specific values of the optional
     <code class="literal">map-type</code>, <code class="literal">format</code>, and
     <code class="literal">options</code>, see the <span class="guimenu">auto.master</span> manual
     page (<code class="command">man 5 auto.master</code>).
    </p></div><p>
    The following entry in <code class="filename">auto.master</code> tells
    <code class="systemitem">autofs</code> to look in
    <code class="filename">/etc/auto.smb</code>, and create mount points in the
    <code class="filename">/smb</code> directory.
   </p><div class="verbatim-wrap"><pre class="screen">/smb   /etc/auto.smb</pre></div><div class="sect3 " id="sec.autofs.directmount"><div class="titlepage"><div><div><h4 class="title" id="sec.autofs.directmount"><span class="number">23.2.1.1 </span><span class="name">Direct Mounts</span> <a title="Permalink" class="permalink" href="#sec.autofs.directmount">#</a></h4></div></div></div><p>
     Direct mounts create a mount point at the path specified inside the
     relevant map file. Instead of specifying the mount point in
     <code class="filename">auto.master</code>, replace the mount point field with
     <code class="literal">/-</code>. For example, the following line tells
     <code class="systemitem">autofs</code> to create a mount point at the place
     specified in <code class="filename">auto.smb</code>:
    </p><div class="verbatim-wrap"><pre class="screen">/-        /etc/auto.smb</pre></div><div id="idm140019136044352" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.png" /><h6>Tip: Maps without Full Path</h6><p>
      If the map file is not specified with its full local or network path, it
      is located using the Name Service Switch (NSS) configuration:
     </p><div class="verbatim-wrap"><pre class="screen">/-        auto.smb</pre></div></div></div></div><div class="sect2 " id="sec.autofs.mapfiles"><div class="titlepage"><div><div><h3 class="title" id="sec.autofs.mapfiles"><span class="number">23.2.2 </span><span class="name">Map Files</span> <a title="Permalink" class="permalink" href="#sec.autofs.mapfiles">#</a></h3></div></div></div><div id="idm140019136040928" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.png" /><h6>Important: Other Types of Maps</h6><p>
     Although <span class="emphasis"><em>files</em></span> are the most common types of maps for
     auto-mounting with <code class="systemitem">autofs</code>, there are other types
     as well. A map specification can be the output of a command, or a result
     of a query in LDAP or database. For more detailed information on map
     types, see the manual page <code class="command">man 5 auto.master</code>.
    </p></div><p>
    Map files specify the (local or network) source location, and the mount
    point where to mount the source locally. The general format of maps is
    similar to the master map. The difference is that the
    <span class="emphasis"><em>options</em></span> appear between the mount point and the
    location instead of at the end of the entry:
   </p><div class="verbatim-wrap"><pre class="screen">mount point      options      location</pre></div><p>
    Make sure that map files are not marked as executable. You can remove
    the executable bits by executing <code class="command">chmod -x <em class="replaceable ">MAP_FILE</em></code>.
   </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019136034800"><span class="term ">mount point</span></dt><dd><p>
       Specifies where to mount the source location. This can be either a
       single directory name (so-called <span class="emphasis"><em>indirect</em></span> mount) to
       be added to the base mount point specified in
       <code class="filename">auto.master</code>, or the full path of the mount point
       (direct mount, see <a class="xref" href="#sec.autofs.directmount" title="23.2.1.1. Direct Mounts">Section 23.2.1.1, “Direct Mounts”</a>).
      </p></dd><dt id="idm140019136031360"><span class="term ">options</span></dt><dd><p>
       Specifies optional comma-separated list of mount options for the
       relevant entries. If <code class="filename">auto.master</code> contains options
       for this map file as well, theses are appended.
      </p></dd><dt id="idm140019136028976"><span class="term ">location</span></dt><dd><p>
       Specifies from where the file system is to be mounted. It is usually an
       NFS or SMB volume in the usual notation
       <code class="literal">host_name:path_name</code>. If the file system to be mounted
       begins with a '/' (such as local <code class="filename">/dev</code> entries or
       smbfs shares), a colon symbol ':' needs to be prefixed, such as
       <code class="literal">:/dev/sda1</code>.
      </p></dd></dl></div></div></div><div class="sect1 " id="sec.autofs.debugging"><div class="titlepage"><div><div><h2 class="title" id="sec.autofs.debugging"><span class="number">23.3 </span><span class="name">Operation and Debugging</span> <a title="Permalink" class="permalink" href="#sec.autofs.debugging">#</a></h2></div></div></div><p>
   This section introduces information on how to control the
   <code class="systemitem">autofs</code> service operation, and how to view more
   debugging information when tuning the automounter operation.
  </p><div class="sect2 " id="sec.autofs.debugging.service"><div class="titlepage"><div><div><h3 class="title" id="sec.autofs.debugging.service"><span class="number">23.3.1 </span><span class="name">Controlling the <code class="systemitem">autofs</code> Service</span> <a title="Permalink" class="permalink" href="#sec.autofs.debugging.service">#</a></h3></div></div></div><p>
    The operation of the <code class="systemitem">autofs</code> service is controlled
    by <code class="systemitem">systemd</code>. The general syntax of the <code class="command">systemctl</code>
    command for <code class="systemitem">autofs</code> is
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> systemctl <em class="replaceable ">SUB_COMMAND</em> autofs</pre></div><p>
    where <em class="replaceable ">SUB_COMMAND</em> is one of:
   </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019136016032"><span class="term ">enable</span></dt><dd><p>
       Starts the automounter daemon at boot.
      </p></dd><dt id="idm140019136014208"><span class="term ">start</span></dt><dd><p>
       Starts the automounter daemon.
      </p></dd><dt id="idm140019136012384"><span class="term ">stop</span></dt><dd><p>
       Stops the automounter daemon. Automatic mount points are not accessible.
      </p></dd><dt id="idm140019136010528"><span class="term ">status</span></dt><dd><p>
       Prints the current status of the <code class="systemitem">autofs</code> service
       together with a part of a relevant log file.
      </p></dd><dt id="idm140019136008208"><span class="term ">restart</span></dt><dd><p>
       Stops and starts the automounter, terminating all running daemons and
       starting new ones.
      </p></dd><dt id="idm140019136006320"><span class="term ">reload</span></dt><dd><p>
       Checks the current <code class="filename">auto.master</code> map, restarts those
       daemons whose entries have changed, and starts new ones for new entries.
      </p></dd></dl></div></div><div class="sect2 " id="sec.autofs.debugging.problems"><div class="titlepage"><div><div><h3 class="title" id="sec.autofs.debugging.problems"><span class="number">23.3.2 </span><span class="name">Debugging the Automounter Problems</span> <a title="Permalink" class="permalink" href="#sec.autofs.debugging.problems">#</a></h3></div></div></div><p>
    If you experience problems when mounting directories with
    <code class="systemitem">autofs</code>, it is useful to run the
    <code class="command">automount</code> daemon manually and watch its output messages:
   </p><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
      Stop <code class="systemitem">autofs</code>.
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> systemctl stop autofs</pre></div></li><li class="step "><p>
      From one terminal, run <code class="command">automount</code> manually in the
      foreground, producing verbose output.
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> automount -f -v</pre></div></li><li class="step "><p>
      From another terminal, try to mount the auto-mounting file systems by
      accessing the mount points (for example by <code class="command">cd</code> or
      <code class="command">ls</code>).
     </p></li><li class="step "><p>
      Check the output of <code class="command">automount</code> from the first terminal
      for more information why the mount failed, or why it was not even
      attempted.
     </p></li></ol></div></div></div></div><div class="sect1 " id="sec.autofs.nfs"><div class="titlepage"><div><div><h2 class="title" id="sec.autofs.nfs"><span class="number">23.4 </span><span class="name">Auto-Mounting an NFS Share</span> <a title="Permalink" class="permalink" href="#sec.autofs.nfs">#</a></h2></div></div></div><p>
   The following procedure illustrates how to configure
   <code class="systemitem">autofs</code> to auto-mount an NFS share available on your
   network. It makes use of the information mentioned above, and assumes you
   are familiar with NFS exports. For more information on NFS, see
   <a class="xref" href="#cha.nfs" title="Chapter 22. Sharing File Systems with NFS">Chapter 22, <em>Sharing File Systems with NFS</em></a>.
  </p><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
     Edit the master map file <code class="filename">/etc/auto.master</code>:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> vim /etc/auto.master</pre></div><p>
     Add a new entry for the new NFS mount at the end of
     <code class="filename">/etc/auto.master</code>:
    </p><div class="verbatim-wrap"><pre class="screen">/nfs      /etc/auto.nfs      --timeout=10</pre></div><p>
     It tells <code class="systemitem">autofs</code> that the base mount point is
     <code class="filename">/nfs</code>, the NFS shares are specified in the
     <code class="filename">/etc/auto.nfs</code> map, and that all shares in this map
     will be automatically unmounted after 10 seconds of inactivity.
    </p></li><li class="step "><p>
     Create a new map file for NFS shares:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> vim /etc/auto.nfs</pre></div><p>
     <code class="filename">/etc/auto.nfs</code> normally contains a separate line for
     each NFS share. Its format is described in
     <a class="xref" href="#sec.autofs.mapfiles" title="23.2.2. Map Files">Section 23.2.2, “Map Files”</a>. Add the line describing the mount point
     and the NFS share network address:
    </p><div class="verbatim-wrap"><pre class="screen">export      jupiter.com:/home/geeko/doc/export</pre></div><p>
     The above line means that the <code class="filename">/home/geeko/doc/export</code>
     directory on the <code class="literal">jupiter.com</code> host will be auto-mounted
     to the <code class="filename">/nfs/export</code> directory on the local host
     (<code class="filename">/nfs</code> is taken from the
     <code class="filename">auto.master</code> map) when requested. The
     <code class="filename">/nfs/export</code> directory will be created automatically
     by <code class="systemitem">autofs</code>.
    </p></li><li class="step "><p>
     Optionally comment out the related line in <code class="filename">/etc/fstab</code>
     if you previously mounted the same NFS share statically. The line should
     look similar to this:
    </p><div class="verbatim-wrap"><pre class="screen">#jupiter.com:/home/geeko/doc/export /nfs/export nfs defaults 0 0</pre></div></li><li class="step "><p>
     Reload <code class="systemitem">autofs</code> and check if it works:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> systemctl restart autofs</pre></div><div class="verbatim-wrap"><pre class="screen"># ls -l /nfs/export
total 20
drwxr-xr-x  6 1001 users 4096 Oct 25 08:56 ./
drwxr-xr-x  3 root root     0 Apr  1 09:47 ../
drwxr-xr-x  5 1001 users 4096 Jan 14  2013 .images/
drwxr-xr-x 10 1001 users 4096 Aug 16  2013 .profiled/
drwxr-xr-x  3 1001 users 4096 Aug 30  2013 .tmp/
drwxr-xr-x  4 1001 users 4096 Oct 25 08:56 SLE-12-manual/</pre></div><p>
     If you can see the list of files on the remote share, then
     <code class="systemitem">autofs</code> is functioning.
    </p></li></ol></div></div></div><div class="sect1 " id="sec.autofs.advanced"><div class="titlepage"><div><div><h2 class="title" id="sec.autofs.advanced"><span class="number">23.5 </span><span class="name">Advanced Topics</span> <a title="Permalink" class="permalink" href="#sec.autofs.advanced">#</a></h2></div></div></div><p>
   This section describes topics that are beyond the basic introduction to
   <code class="systemitem">autofs</code>—auto-mounting of NFS shares that are
   available on your network, using wild cards in map files, and information
   specific to the CIFS file system.
  </p><div class="sect2 " id="sec.autofs.advanced.net"><div class="titlepage"><div><div><h3 class="title" id="sec.autofs.advanced.net"><span class="number">23.5.1 </span><span class="name"><code class="filename">/net</code> Mount Point</span> <a title="Permalink" class="permalink" href="#sec.autofs.advanced.net">#</a></h3></div></div></div><p>
    This helper mount point is useful if you use a lot of NFS shares.
    <code class="filename">/net</code> auto-mounts all NFS shares on your local network
    on demand. The entry is already present in the
    <code class="filename">auto.master</code> file, so all you need to do is uncomment
    it and restart <code class="systemitem">autofs</code>:
   </p><div class="verbatim-wrap"><pre class="screen">/net      -hosts</pre></div><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> systemctl restart autofs</pre></div><p>
    For example, if you have a server named <code class="literal">jupiter</code> with an
    NFS share called <code class="filename">/export</code>, you can mount it by typing
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> cd /net/jupiter/export</pre></div><p>
    on the command line.
   </p></div><div class="sect2 " id="sec.autofs.advanced.wildcards"><div class="titlepage"><div><div><h3 class="title" id="sec.autofs.advanced.wildcards"><span class="number">23.5.2 </span><span class="name">Using Wild Cards to Auto-Mount Subdirectories</span> <a title="Permalink" class="permalink" href="#sec.autofs.advanced.wildcards">#</a></h3></div></div></div><p>
    If you have a directory with subdirectories that you need to auto-mount
    individually—the typical case is the <code class="filename">/home</code>
    directory with individual users' home directories inside—
    <code class="systemitem">autofs</code> offers a clever solution for that.
   </p><p>
    In case of home directories, add the following line in
    <code class="filename">auto.master</code>:
   </p><div class="verbatim-wrap"><pre class="screen">/home      /etc/auto.home</pre></div><p>
    Now you need to add the correct mapping to the
    <code class="filename">/etc/auto.home</code> file, so that the users' home
    directories are mounted automatically. One solution is to create separate
    entries for each directory:
   </p><div class="verbatim-wrap"><pre class="screen">wilber      jupiter.com:/home/wilber
penguin      jupiter.com:/home/penguin
tux      jupiter.com:/home/tux
[...]</pre></div><p>
    This is very awkward as you need to manage the list of users inside
    <code class="filename">auto.home</code>. You can use the asterisk '*' instead of the
    mount point, and the ampersand '&amp;' instead of the directory to be
    mounted:
   </p><div class="verbatim-wrap"><pre class="screen">*      jupiter:/home/&amp;</pre></div></div><div class="sect2 " id="sec.autofs.advanced.cifs"><div class="titlepage"><div><div><h3 class="title" id="sec.autofs.advanced.cifs"><span class="number">23.5.3 </span><span class="name">Auto-Mounting CIFS File System</span> <a title="Permalink" class="permalink" href="#sec.autofs.advanced.cifs">#</a></h3></div></div></div><p>
    If you want to auto-mount an SMB/CIFS share (see
    <a class="xref" href="#cha.samba" title="Chapter 21. Samba">Chapter 21, <em>Samba</em></a> for more information on the SMB/CIFS protocol),
    you need to modify the syntax of the map file. Add
    <code class="option">-fstype=cifs</code> in the option field, and prefix the share
    location with a colon ':'.
   </p><div class="verbatim-wrap"><pre class="screen">mount point      -fstype=cifs      ://jupiter.com/export</pre></div></div></div></div><div class="chapter " id="cha.apache2"><div class="titlepage"><div><div><h2 class="title"><span class="number">24 </span><span class="name">The Apache HTTP Server</span> <a title="Permalink" class="permalink" href="#cha.apache2">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">Filename: </span>apache2.xml</li><li><span class="ds-label">ID: </span>cha.apache2</li></ul></div></div><div><div class="abstract"><div class="abstract-title-wrap"><h6 class="abstract-title">Abstract<a title="Permalink" class="permalink" href="#idm140019135944800">#</a></h6></div><p>
    According to the survey from <a class="link" href="http://www.netcraft.com/" target="_blank">http://www.netcraft.com/</a>,
    the Apache HTTP Server (Apache) is the world's most widely-used Web server.
    Developed by the Apache Software Foundation
    (<a class="link" href="http://www.apache.org/" target="_blank">http://www.apache.org/</a>), it is available for most
    operating systems. <span class="productname"><span class="phrase">openSUSE® Leap</span></span> includes Apache version 2.4. In this
    chapter, learn how to install, configure and set up a Web server; how to
    use SSL, CGI, and additional modules; and how to troubleshoot Apache.
   </p></div></div></div></div><div class="line"><div class="toc"><dl><dt><span class="sect1"><a href="#sec.apache2.quickstart"><span class="number">24.1 </span><span class="name">Quick Start</span></a></span></dt><dt><span class="sect1"><a href="#sec.apache2.configuration"><span class="number">24.2 </span><span class="name">Configuring Apache</span></a></span></dt><dt><span class="sect1"><a href="#sec.apache2.start_stop"><span class="number">24.3 </span><span class="name">Starting and Stopping Apache</span></a></span></dt><dt><span class="sect1"><a href="#sec.apache2.modules"><span class="number">24.4 </span><span class="name">Installing, Activating, and Configuring Modules</span></a></span></dt><dt><span class="sect1"><a href="#sec.apache2.cgi"><span class="number">24.5 </span><span class="name">Enabling CGI Scripts</span></a></span></dt><dt><span class="sect1"><a href="#sec.apache2.ssl"><span class="number">24.6 </span><span class="name">Setting Up a Secure Web Server with SSL</span></a></span></dt><dt><span class="sect1"><a href="#sec.apache2.multiple_instances"><span class="number">24.7 </span><span class="name">Running Multiple Apache Instances on the Same Server</span></a></span></dt><dt><span class="sect1"><a href="#sec.apache2.security"><span class="number">24.8 </span><span class="name">Avoiding Security Problems</span></a></span></dt><dt><span class="sect1"><a href="#sec.apache2.troubleeshooting"><span class="number">24.9 </span><span class="name">Troubleshooting</span></a></span></dt><dt><span class="sect1"><a href="#sec.apache2.more_information"><span class="number">24.10 </span><span class="name">For More Information</span></a></span></dt></dl></div></div><div class="sect1 " id="sec.apache2.quickstart"><div class="titlepage"><div><div><h2 class="title" id="sec.apache2.quickstart"><span class="number">24.1 </span><span class="name">Quick Start</span> <a title="Permalink" class="permalink" href="#sec.apache2.quickstart">#</a></h2></div></div></div><p>
   With this section, quickly set up and start Apache. You must be <code class="systemitem">root</code>
   to install and configure Apache.
  </p><div class="sect2 " id="sec.apache.quickstart.requirements"><div class="titlepage"><div><div><h3 class="title" id="sec.apache.quickstart.requirements"><span class="number">24.1.1 </span><span class="name">Requirements</span> <a title="Permalink" class="permalink" href="#sec.apache.quickstart.requirements">#</a></h3></div></div></div><p>
    Make sure the following requirements are met before trying to set up the
    Apache Web server:
   </p><div class="orderedlist "><ol class="orderedlist" type="1"><li class="listitem "><p>
      The machine's network is configured properly. For more information about
      this topic, refer to <a class="xref" href="#cha.network" title="Chapter 13. Basic Networking">Chapter 13, <em>Basic Networking</em></a>.
     </p></li><li class="listitem "><p>
      The machine's exact system time is maintained by synchronizing with a
      time server. This is necessary because parts of the HTTP protocol depend
      on the correct time. See <a class="xref" href="#cha.ntp" title="Chapter 18. Time Synchronization with NTP">Chapter 18, <em>Time Synchronization with NTP</em></a> to learn more
      about this topic.
     </p></li><li class="listitem "><p>
      The latest security updates are installed. If in doubt, run a YaST
      Online Update.
     </p></li><li class="listitem "><p>
      The default Web server port (<code class="literal">80</code>) is opened in the
      firewall. For this, configure <code class="systemitem">firewalld</code> to allow the service
      <code class="literal">http</code> in the public zone.
      See <span class="intraxref">Book “<em class="citetitle ">Security Guide</em>”, Chapter 15 “Masquerading and Firewalls”, Section 15.4.1 “Configuring the Firewall on the Command Line”</span> for details.
     </p></li></ol></div></div><div class="sect2 " id="sec.apache2.quickstart.installation"><div class="titlepage"><div><div><h3 class="title" id="sec.apache2.quickstart.installation"><span class="number">24.1.2 </span><span class="name">Installation</span> <a title="Permalink" class="permalink" href="#sec.apache2.quickstart.installation">#</a></h3></div></div></div><p>
    Apache on <span class="productname"><span class="phrase">openSUSE Leap</span></span> is not installed by default. To install it with a
    standard, predefined configuration that runs <span class="quote">“<span class="quote">out of the box</span>”</span>,
    proceed as follows:
   </p><div class="procedure " id="idm140019135924128"><div class="procedure-title-wrap"><h6 class="procedure-title"><span class="number">Procedure 24.1: </span><span class="name">Installing Apache with the Default Configuration </span><a title="Permalink" class="permalink" href="#idm140019135924128">#</a></h6></div><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
      Start YaST and select <span class="guimenu">Software</span> › <span class="guimenu">Software Management</span>.
     </p></li><li class="step "><p>
      Choose <span class="guimenu">View</span> › <span class="guimenu">Patterns</span> and select <span class="guimenu">Web and LAMP Server</span>.
     </p></li><li class="step "><p>
      Confirm the installation of the dependent packages to finish the
      installation process.
     </p></li></ol></div></div></div><div class="sect2 " id="sec.apache.quickstart.start"><div class="titlepage"><div><div><h3 class="title" id="sec.apache.quickstart.start"><span class="number">24.1.3 </span><span class="name">Start</span> <a title="Permalink" class="permalink" href="#sec.apache.quickstart.start">#</a></h3></div></div></div><p>
    You can start Apache automatically at boot time or start it manually.
   </p><p>
    To make sure that Apache is automatically started during boot in the
    targets <code class="literal">multi-user.target</code> and
    <code class="literal">graphical.target</code>, execute the following command:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> systemctl enable apache2</pre></div><p>
    
   </p><p>
    For more information about the systemd targets in <span class="productname"><span class="phrase">openSUSE Leap</span></span> and a
    description of the YaST <span class="guimenu">Services Manager</span>, refer to
    <a class="xref" href="#sec.boot.runlevel.edit" title="10.4. Managing Services with YaST">Section 10.4, “Managing Services with YaST”</a>.
   </p><p>
    To manually start Apache using the shell, run <code class="command">systemctl start
    apache2</code>.
   </p><div class="procedure " id="idm140019135908224"><div class="procedure-title-wrap"><h6 class="procedure-title"><span class="number">Procedure 24.2: </span><span class="name">Checking if Apache is Running </span><a title="Permalink" class="permalink" href="#idm140019135908224">#</a></h6></div><div class="procedure-contents"><p>
     If you do not receive error messages when starting Apache, this usually
     indicates that the Web server is running. To test this:
    </p><ol class="procedure" type="1"><li class="step "><p>
      Start a browser and open <a class="link" href="http://localhost/" target="_blank">http://localhost/</a>.
     </p><p>
      If Apache is up and running, you get a test page stating <span class="quote">“<span class="quote">It
      works!</span>”</span>.
     </p></li><li class="step "><p>
      If you do not see this page, refer to
      <a class="xref" href="#sec.apache2.troubleeshooting" title="24.9. Troubleshooting">Section 24.9, “Troubleshooting”</a>.
     </p></li></ol></div></div><p>
    Now that the Web server is running, you can add your own documents, adjust
    the configuration according to your needs, or add functionality by
    installing modules.
   </p></div></div><div class="sect1 " id="sec.apache2.configuration"><div class="titlepage"><div><div><h2 class="title" id="sec.apache2.configuration"><span class="number">24.2 </span><span class="name">Configuring Apache</span> <a title="Permalink" class="permalink" href="#sec.apache2.configuration">#</a></h2></div></div></div><p>
   <span class="productname"><span class="phrase">openSUSE Leap</span></span> offers two configuration options:
  </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
     <a class="xref" href="#sec.apache2.configuration.manually" title="24.2.2. Configuring Apache Manually">Configuring Apache Manually</a>
    </p></li><li class="listitem "><p>
     <a class="xref" href="#sec.apache2.configuration.yast" title="24.2.3. Configuring Apache with YaST">Configuring Apache with YaST</a>
    </p></li></ul></div><p>
   Manual configuration offers a higher level of detail, but lacks the
   convenience of the YaST GUI.
  </p><div id="idm140019135894080" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.png" /><h6>Important: Reload or Restart Apache after Configuration Changes</h6><p>
    Most configuration changes require a reload (some also a restart) of Apache
    to take effect. Manually reload Apache with <code class="command">systemctl reload
    apache2</code> or use one of the restart options as described in
    <a class="xref" href="#sec.apache2.start_stop" title="24.3. Starting and Stopping Apache">Section 24.3, “Starting and Stopping Apache”</a>.
   </p><p>
    If you configure Apache with YaST, this can be taken care of
    automatically if you set <span class="guimenu">HTTP Service</span> to
    <span class="guimenu">Enabled</span> as described in
    <a class="xref" href="#sec.apache2.configuration.yast.server_configuration" title="24.2.3.2. HTTP Server Configuration">Section 24.2.3.2, “HTTP Server Configuration”</a>.
   </p></div><div class="sect2 " id="sec.apache2.configuration.manually.configfiles"><div class="titlepage"><div><div><h3 class="title" id="sec.apache2.configuration.manually.configfiles"><span class="number">24.2.1 </span><span class="name">Apache Configuration Files</span> <a title="Permalink" class="permalink" href="#sec.apache2.configuration.manually.configfiles">#</a></h3></div></div></div><p>
    This section gives an overview of the Apache configuration files. If you
    use YaST for configuration, you do not need to touch these
    files—however, the information might be useful for you if you want to
    switch to manual configuration later on.
   </p><p>
    Apache configuration files can be found in two different locations:
   </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
      <a class="xref" href="#sec.apache2.configuration.manually.configfiles.etc_sysconfig_apache2" title="24.2.1.1. /etc/sysconfig/apache2"><code class="filename">/etc/sysconfig/apache2</code></a>
     </p></li><li class="listitem "><p>
      <a class="xref" href="#sec.apache2.configuration.manually.configfiles.etc_apache2" title="24.2.1.2. /etc/apache2/"><code class="filename">/etc/apache2/</code></a>
     </p></li></ul></div><div class="sect3 " id="sec.apache2.configuration.manually.configfiles.etc_sysconfig_apache2"><div class="titlepage"><div><div><h4 class="title" id="sec.apache2.configuration.manually.configfiles.etc_sysconfig_apache2"><span class="number">24.2.1.1 </span><span class="name"><code class="filename">/etc/sysconfig/apache2</code></span> <a title="Permalink" class="permalink" href="#sec.apache2.configuration.manually.configfiles.etc_sysconfig_apache2">#</a></h4></div></div></div><p>
     <code class="filename">/etc/sysconfig/apache2</code> controls some global settings
     of Apache, like modules to load, additional configuration files to
     include, flags with which the server should be started, and flags that
     should be added to the command line. Every configuration option in this
     file is extensively documented and therefore not mentioned here. For a
     general-purpose Web server, the settings in
     <code class="filename">/etc/sysconfig/apache2</code> should be sufficient for any
     configuration needs.
    </p></div><div class="sect3 " id="sec.apache2.configuration.manually.configfiles.etc_apache2"><div class="titlepage"><div><div><h4 class="title" id="sec.apache2.configuration.manually.configfiles.etc_apache2"><span class="number">24.2.1.2 </span><span class="name"><code class="filename">/etc/apache2/</code></span> <a title="Permalink" class="permalink" href="#sec.apache2.configuration.manually.configfiles.etc_apache2">#</a></h4></div></div></div><p>
     <code class="filename">/etc/apache2/</code> hosts all configuration files for
     Apache. In the following, the purpose of each file is explained. Each file
     includes several configuration options (also called
     <span class="emphasis"><em>directives</em></span>). Every configuration option in these
     files is extensively documented and therefore not mentioned here.
    </p><p>
     The Apache configuration files are organized as follows:
    </p><div class="verbatim-wrap"><pre class="screen">/etc/apache2/
     |
     |- charset.conv
     |- conf.d/
     |   |
     |   |- *.conf
     |
     |- default-server.conf
     |- errors.conf
     |- httpd.conf
     |- listen.conf
     |- magic
     |- mime.types
     |- mod_*.conf
     |- server-tuning.conf
     |- ssl.*
     |- ssl-global.conf
     |- sysconfig.d
     |   |
     |   |- global.conf
     |   |- include.conf
     |   |- loadmodule.conf . .
     |
     |- uid.conf
     |- vhosts.d
     |   |- *.conf</pre></div><div class="variablelist "><div class="variablelist-title-wrap"><h6 class="variablelist-title"><span class="name">Apache Configuration Files in /etc/apache2/ </span><a title="Permalink" class="permalink" href="#idm140019135874816">#</a></h6></div><dl class="variablelist"><dt id="idm140019135874048"><span class="term "><code class="filename">charset.conv</code>
      </span></dt><dd><p>
        Specifies which character sets to use for different languages. Do not
        edit this file.
       </p></dd><dt id="idm140019135871872"><span class="term "><code class="filename">conf.d/*.conf</code>
      </span></dt><dd><p>
        Configuration files added by other modules. These configuration files
        can be included into your virtual host configuration where needed. See
        <code class="filename">vhosts.d/vhost.template</code> for examples. By doing so,
        you can provide different module sets for different virtual hosts.
       </p></dd><dt id="idm140019135869104"><span class="term "><code class="filename">default-server.conf</code>
      </span></dt><dd><p>
        Global configuration for all virtual hosts with reasonable defaults.
        Instead of changing the values, overwrite them with a virtual host
        configuration.
       </p></dd><dt id="idm140019135866864"><span class="term "><code class="filename">errors.conf</code>
      </span></dt><dd><p>
        Defines how Apache responds to errors. To customize these messages for
        all virtual hosts, edit this file. Otherwise overwrite these directives
        in your virtual host configurations.
       </p></dd><dt id="idm140019135864592"><span class="term "><code class="filename">httpd.conf</code>
      </span></dt><dd><p>
        The main Apache server configuration file. Avoid changing this file. It
        primarily contains include statements and global settings. Overwrite
        global settings in the pertinent configuration files listed here.
        Change host-specific settings (such as document root) in your virtual
        host configuration.
       </p></dd><dt id="idm140019135862176"><span class="term "><code class="filename">listen.conf</code>
      </span></dt><dd><p>
        Binds Apache to specific IP addresses and ports. Name-based virtual
        hosting is also configured here. For details, see
        <a class="xref" href="#sec.apache2.configuration.manually.vhost.named_vhosts" title="24.2.2.1.1. Name-Based Virtual Hosts">Section 24.2.2.1.1, “Name-Based Virtual Hosts”</a>.
       </p></dd><dt id="idm140019135859376"><span class="term "><code class="filename">magic</code>
      </span></dt><dd><p>
        Data for the mime_magic module that helps Apache automatically
        determine the MIME type of an unknown file. Do not change this file.
       </p></dd><dt id="idm140019135857152"><span class="term "><code class="filename">mime.types</code>
      </span></dt><dd><p>
        MIME types known by the system (this actually is a link to
        <code class="filename">/etc/mime.types</code>). Do not edit this file. If you
        need to add MIME types not listed here, add them to
        <code class="filename">mod_mime-defaults.conf</code>.
       </p></dd><dt id="idm140019135854032"><span class="term "><code class="filename">mod_*.conf</code>
      </span></dt><dd><p>
        Configuration files for the modules that are installed by default.
        Refer to <a class="xref" href="#sec.apache2.modules" title="24.4. Installing, Activating, and Configuring Modules">Section 24.4, “Installing, Activating, and Configuring Modules”</a> for details. Note that
        configuration files for optional modules reside in the directory
        <code class="filename">conf.d</code>.
       </p></dd><dt id="idm140019135850768"><span class="term "><code class="filename">server-tuning.conf</code>
      </span></dt><dd><p>
        Contains configuration directives for the different MPMs (see
        <a class="xref" href="#sec.apache2.modules.mpm" title="24.4.4. Multiprocessing Modules">Section 24.4.4, “Multiprocessing Modules”</a>) and general configuration
        options that control Apache's performance. Properly test your Web
        server when making changes here.
       </p></dd><dt id="idm140019135847936"><span class="term "><code class="filename">ssl-global.conf</code> and <code class="filename">ssl.*</code>
      </span></dt><dd><p>
        Global SSL configuration and SSL certificate data. Refer to
        <a class="xref" href="#sec.apache2.ssl" title="24.6. Setting Up a Secure Web Server with SSL">Section 24.6, “Setting Up a Secure Web Server with SSL”</a> for details.
       </p></dd><dt id="idm140019135844784"><span class="term "><code class="filename">sysconfig.d/*.conf</code>
      </span></dt><dd><p>
        Configuration files automatically generated from
        <code class="filename">/etc/sysconfig/apache2</code>. Do not change any of these
        files—edit <code class="filename">/etc/sysconfig/apache2</code> instead.
        Do not put other configuration files in this directory.
       </p></dd><dt id="idm140019135841664"><span class="term "><code class="filename">uid.conf</code>
      </span></dt><dd><p>
        Specifies under which user and group ID Apache runs. Do not change this
        file.
       </p></dd><dt id="idm140019135839504"><span class="term "><code class="filename">vhosts.d/*.conf</code>
      </span></dt><dd><p>
        Your virtual host configuration should be located here. The directory
        contains template files for virtual hosts with and without SSL. Every
        file in this directory ending with <code class="filename">.conf</code> is
        automatically included in the Apache configuration. Refer to
        <a class="xref" href="#sec.apache2.configuration.manually.vhost" title="24.2.2.1. Virtual Host Configuration">Section 24.2.2.1, “Virtual Host Configuration”</a> for details.
       </p></dd></dl></div></div></div><div class="sect2 " id="sec.apache2.configuration.manually"><div class="titlepage"><div><div><h3 class="title" id="sec.apache2.configuration.manually"><span class="number">24.2.2 </span><span class="name">Configuring Apache Manually</span> <a title="Permalink" class="permalink" href="#sec.apache2.configuration.manually">#</a></h3></div></div></div><p>
    Configuring Apache manually involves editing plain text configuration files
    as user <code class="systemitem">root</code>.
   </p><div class="sect3 " id="sec.apache2.configuration.manually.vhost"><div class="titlepage"><div><div><h4 class="title" id="sec.apache2.configuration.manually.vhost"><span class="number">24.2.2.1 </span><span class="name">Virtual Host Configuration</span> <a title="Permalink" class="permalink" href="#sec.apache2.configuration.manually.vhost">#</a></h4></div></div></div><p>
     The term <span class="emphasis"><em>virtual host</em></span> refers to Apache's ability to
     serve multiple universal resource identifiers (URIs) from the same
     physical machine. This means that several domains, such as www.example.com and
     www.example.net, are run by a single Web server on one physical machine.
    </p><p>
     It is common practice to use virtual hosts to save administrative effort
     (only a single Web server needs to be maintained) and hardware expenses
     (each domain does not require a dedicated server). Virtual hosts can be
     name based, IP based, or port based.
    </p><p>
     To list all existing virtual hosts, use the command
     <code class="command">apache2ctl</code> <code class="option">-S</code>. This outputs a list
     showing the default server and all virtual hosts together with their IP
     addresses and listening ports. Furthermore, the list also contains an
     entry for each virtual host showing its location in the configuration
     files.
    </p><p>
     Virtual hosts can be configured via YaST as described in
     <a class="xref" href="#sec.apache2.configuration.yast.wizard.virtual_hosts" title="24.2.3.1.4. Virtual Hosts">Section 24.2.3.1.4, “Virtual Hosts”</a> or
     by manually editing a configuration file. By default, Apache in
     <span class="productname"><span class="phrase">openSUSE Leap</span></span> is prepared for one configuration file per virtual host in
     <code class="filename">/etc/apache2/vhosts.d/</code>. All files in this directory
     with the extension <code class="filename">.conf</code> are automatically included
     to the configuration. A basic template for a virtual host is provided in
     this directory (<code class="filename">vhost.template</code> or
     <code class="filename">vhost-ssl.template</code> for a virtual host with SSL
     support).
    </p><div id="idm140019135824144" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.png" /><h6>Tip: Always Create a Virtual Host Configuration</h6><p>
      It is recommended to always create a virtual host configuration file,
      even if your Web server only hosts one domain. By doing so, you not only
      have the domain-specific configuration in one file, but you can always
      fall back to a working basic configuration by simply moving, deleting, or
      renaming the configuration file for the virtual host. For the same
      reason, you should also create separate configuration files for each
      virtual host.
     </p><p>
      When using name-based virtual hosts it is recommended to set up a default
      configuration that will be used when a domain name does not match a
      virtual host configuration. The default virtual host is the one whose
      configuration is loaded first. Since the order of the configuration files
      is determined by file name, start the file name of the default virtual
      host configuration with an underscore character (<code class="literal">_</code>) to
      make sure it is loaded first (for example:
      <code class="filename">_default_vhost.conf</code>).
     </p></div><p>
     The
     <code class="systemitem">&lt;VirtualHost&gt;</code><code class="systemitem">&lt;/VirtualHost&gt;</code>
     block holds the information that applies to a particular domain. When
     Apache receives a client request for a defined virtual host, it uses the
     directives enclosed in this section. Almost all directives can be used in
     a virtual host context. See
     <a class="link" href="http://httpd.apache.org/docs/2.4/mod/quickreference.html" target="_blank">http://httpd.apache.org/docs/2.4/mod/quickreference.html</a>
     for further information about Apache's configuration directives.
    </p><div class="sect4 " id="sec.apache2.configuration.manually.vhost.named_vhosts"><div class="titlepage"><div><div><h5 class="title" id="sec.apache2.configuration.manually.vhost.named_vhosts"><span class="number">24.2.2.1.1 </span><span class="name">Name-Based Virtual Hosts</span> <a title="Permalink" class="permalink" href="#sec.apache2.configuration.manually.vhost.named_vhosts">#</a></h5></div></div></div><p>
      With name-based virtual hosts, more than one Web site is served per IP
      address. Apache uses the host field in the HTTP header that is sent by
      the client to connect the request to a matching
      <code class="systemitem">ServerName</code> entry of one of the virtual host
      declarations. If no matching <code class="systemitem">ServerName</code> is
      found, the first specified virtual host is used as a default.
     </p><p>
      The first step is to create a <code class="literal">&lt;VirtualHost&gt;</code>
      block for each different name-based host that you want to serve. Inside
      each <code class="literal">&lt;VirtualHost&gt;</code> block, you will need at
      minimum a <code class="literal">ServerName</code> directive to designate which host
      is served and a <code class="literal">DocumentRoot</code> directive to show where
      in the file system the content for that host resides.
     </p><div class="example" id="ex.apache2.virtual_hosts.name_based"><div class="example-title-wrap"><h6 class="example-title"><span class="number">Example 24.1: </span><span class="name">Basic Examples of Name-Based <code class="systemitem">VirtualHost</code> Entries </span><a title="Permalink" class="permalink" href="#ex.apache2.virtual_hosts.name_based">#</a></h6></div><div class="example-contents"><div class="verbatim-wrap"><pre class="screen">&lt;VirtualHost *:80&gt;
# This first-listed virtual host is also the default for *:80
ServerName www.example.com
ServerAlias example.com
DocumentRoot /srv/www/htdocs/domain
&lt;/VirtualHost&gt;

&lt;VirtualHost *:80&gt;
ServerName other.example.com
DocumentRoot /srv/www/htdocs/otherdomain
&lt;/VirtualHost&gt;</pre></div></div></div><p>
      The opening <code class="systemitem">VirtualHost</code> tag takes the IP address
      (or fully qualified domain name) as an argument in a name-based virtual
      host configuration. A port number directive is optional.
     </p><p>
      The wild card <span class="emphasis"><em>*</em></span> is also allowed as a substitute for
      the IP address. When using IPv6 addresses, the address must be included
      in square brackets.
     </p><div class="example" id="ex.apache.directives.virtualhost.name_based"><div class="example-title-wrap"><h6 class="example-title"><span class="number">Example 24.2: </span><span class="name">Name-Based <code class="systemitem">VirtualHost</code> Directives </span><a title="Permalink" class="permalink" href="#ex.apache.directives.virtualhost.name_based">#</a></h6></div><div class="example-contents"><div class="verbatim-wrap"><pre class="screen">&lt;VirtualHost 192.168.3.100:80&gt;
  ...
&lt;/VirtualHost&gt;

&lt;VirtualHost 192.168.3.100&gt;
  ...
&lt;/VirtualHost&gt;

&lt;VirtualHost *:80&gt;
  ...
&lt;/VirtualHost&gt;

&lt;VirtualHost *&gt;
  ...
&lt;/VirtualHost&gt;

&lt;VirtualHost [2002:c0a8:364::]&gt;
  ...
&lt;/VirtualHost&gt;</pre></div></div></div></div><div class="sect4 " id="sec.apache2.configuration.manually.vhost.ip_vhosts"><div class="titlepage"><div><div><h5 class="title" id="sec.apache2.configuration.manually.vhost.ip_vhosts"><span class="number">24.2.2.1.2 </span><span class="name">IP-Based Virtual Hosts</span> <a title="Permalink" class="permalink" href="#sec.apache2.configuration.manually.vhost.ip_vhosts">#</a></h5></div></div></div><p>
      This alternative virtual host configuration requires the setup of
      multiple IPs for a machine. One instance of Apache hosts several domains,
      each of which is assigned a different IP.
     </p><p>
      The physical server must have one IP address for each IP-based virtual
      host. If the machine does not have multiple network cards, virtual
      network interfaces (IP aliasing) can also be used.
     </p><p>
      The following example shows Apache running on a machine with the IP
      <code class="systemitem">192.168.3.100</code>, hosting two domains
      on the additional IPs <code class="systemitem">192.168.3.101</code>
      and <code class="systemitem">192.168.3.102</code>. A separate
      <code class="systemitem">VirtualHost</code> block is needed for every virtual
      server.
     </p><div class="example" id="ex.apache.directives.virtualhost.ip_based"><div class="example-title-wrap"><h6 class="example-title"><span class="number">Example 24.3: </span><span class="name">IP-Based <code class="systemitem">VirtualHost</code> Directives </span><a title="Permalink" class="permalink" href="#ex.apache.directives.virtualhost.ip_based">#</a></h6></div><div class="example-contents"><div class="verbatim-wrap"><pre class="screen">&lt;VirtualHost 192.168.3.101&gt;
  ...
&lt;/VirtualHost&gt;

&lt;VirtualHost 192.168.3.102&gt;
  ...
&lt;/VirtualHost&gt;</pre></div></div></div><p>
      Here, <code class="systemitem">VirtualHost</code> directives are only specified
      for interfaces other than <code class="systemitem">192.168.3.100</code>. When a
      <code class="systemitem">Listen</code> directive is also configured for
      <code class="systemitem">192.168.3.100</code>, a separate IP-based virtual host must
      be created to answer HTTP requests to that interface—otherwise the
      directives found in the default server configuration
      (<code class="filename">/etc/apache2/default-server.conf</code>) are applied.
     </p></div><div class="sect4 " id="sec.apache2.configuration.manually.vhost.basic_configuration"><div class="titlepage"><div><div><h5 class="title" id="sec.apache2.configuration.manually.vhost.basic_configuration"><span class="number">24.2.2.1.3 </span><span class="name">Basic Virtual Host Configuration</span> <a title="Permalink" class="permalink" href="#sec.apache2.configuration.manually.vhost.basic_configuration">#</a></h5></div></div></div><p>
      At least the following directives should be in each virtual host
      configuration to set up a virtual host. See
      <code class="filename">/etc/apache2/vhosts.d/vhost.template</code> for more
      options.
     </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019135791824"><span class="term "><code class="systemitem">ServerName</code>
       </span></dt><dd><p>
         The fully qualified domain name under which the host should be
         addressed.
        </p></dd><dt id="idm140019135789664"><span class="term "><code class="systemitem">DocumentRoot</code>
       </span></dt><dd><p>
         Path to the directory from which Apache should serve files for this
         host. For security reasons, access to the entire file system is
         forbidden by default, so you must explicitly unlock this directory
         within a <code class="systemitem">Directory</code> container.
        </p></dd><dt id="idm140019135786912"><span class="term "><code class="systemitem">ServerAdmin</code>
       </span></dt><dd><p>
         E-mail address of the server administrator. This address is, for
         example, shown on error pages Apache creates.
        </p></dd><dt id="idm140019135784704"><span class="term "><code class="systemitem">ErrorLog</code>
       </span></dt><dd><p>
         The error log file for this virtual host. Although it is not necessary
         to create separate error log files for each virtual host, it is common
         practice to do so, because it makes the debugging of errors much
         easier. <code class="filename">/var/log/apache2/</code> is the default
         directory for Apache's log files.
        </p></dd><dt id="idm140019135781968"><span class="term "><code class="systemitem">CustomLog</code>
       </span></dt><dd><p>
         The access log file for this virtual host. Although it is not
         necessary to create separate access log files for each virtual host,
         it is common practice to do so, because it allows the separate
         analysis of access statistics for each host.
         <code class="filename">/var/log/apache2/</code> is the default directory for
         Apache's log files.
        </p></dd></dl></div><p>
      As mentioned above, access to the whole file system is forbidden by
      default for security reasons. Therefore, explicitly unlock the
      directories in which you have placed the files Apache should
      serve—for example the <code class="systemitem">DocumentRoot</code>:
     </p><div class="verbatim-wrap"><pre class="screen">&lt;Directory "/srv/www/www.example.com/htdocs"&gt;
  Require all granted
&lt;/Directory&gt;</pre></div><div id="idm140019135777328" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note: <code class="literal">Require all granted</code></h6><p>
       In previous versions of Apache, the statement <code class="literal">Require all
       granted</code> was expressed as:
      </p><div class="verbatim-wrap"><pre class="screen">Order allow,deny
Allow from all</pre></div><p>
       This old syntax is still supported by the
       <code class="literal">mod_access_compat</code> module.
      </p></div><p>
      The complete configuration file looks like this:
     </p><div class="example" id="ex.apache.directives.virtualhost.basic_configuration"><div class="example-title-wrap"><h6 class="example-title"><span class="number">Example 24.4: </span><span class="name">Basic <code class="systemitem">VirtualHost</code> Configuration </span><a title="Permalink" class="permalink" href="#ex.apache.directives.virtualhost.basic_configuration">#</a></h6></div><div class="example-contents"><div class="verbatim-wrap"><pre class="screen">&lt;VirtualHost 192.168.3.100&gt;
  ServerName www.example.com
  DocumentRoot /srv/www/www.example.com/htdocs
  ServerAdmin webmaster@example.com
  ErrorLog /var/log/apache2/www.example.com_log
  CustomLog /var/log/apache2/www.example.com-access_log common
  &lt;Directory "/srv/www/www.example.com/htdocs"&gt;
  Require all granted
  &lt;/Directory&gt;
&lt;/VirtualHost&gt;</pre></div></div></div></div></div></div><div class="sect2 " id="sec.apache2.configuration.yast"><div class="titlepage"><div><div><h3 class="title" id="sec.apache2.configuration.yast"><span class="number">24.2.3 </span><span class="name">Configuring Apache with YaST</span> <a title="Permalink" class="permalink" href="#sec.apache2.configuration.yast">#</a></h3><div class="doc-status"><ul><li><span class="ds-label">Filename: </span>apache2_yast_i.xml</li><li><span class="ds-label">ID: </span>sec.apache2.configuration.yast</li></ul></div></div></div></div><p>
  To configure your Web server with YaST, start YaST and select
  <span class="guimenu">Network Services</span> › <span class="guimenu">HTTP
  Server</span>. When starting the module for the first time,
  the <span class="guimenu">HTTP Server Wizard</span> starts, prompting you to make a few
  basic decisions concerning administration of the server. After having
  finished the wizard, the <span class="guimenu">HTTP Server Configuration</span> dialog
  starts each time you call the <span class="guimenu">HTTP Server</span> module. For more
  information, see
  <a class="xref" href="#sec.apache2.configuration.yast.server_configuration" title="24.2.3.2. HTTP Server Configuration">Section 24.2.3.2, “HTTP Server Configuration”</a>.
 </p><div class="sect3 " id="sec.apache2.configuration.yast.wizard"><div class="titlepage"><div><div><h4 class="title" id="sec.apache2.configuration.yast.wizard"><span class="number">24.2.3.1 </span><span class="name">HTTP Server Wizard</span> <a title="Permalink" class="permalink" href="#sec.apache2.configuration.yast.wizard">#</a></h4></div></div></div><p>
   The HTTP Server Wizard consists of five steps. In the last step of the
   dialog, you may enter the expert configuration mode to make even more
   specific settings.
  </p><div class="sect4 " id="sec.apache2.configuration.yast.wizard.network_device"><div class="titlepage"><div><div><h5 class="title" id="sec.apache2.configuration.yast.wizard.network_device"><span class="number">24.2.3.1.1 </span><span class="name">Network Device Selection</span> <a title="Permalink" class="permalink" href="#sec.apache2.configuration.yast.wizard.network_device">#</a></h5></div></div></div><p>
    Here, specify the network interfaces and ports Apache uses to listen for
    incoming requests. You can select any combination of existing network
    interfaces and their respective IP addresses. Ports from all three ranges
    (well-known ports, registered ports, and dynamic or private ports) that are
    not reserved by other services can be used. The default setting is to
    listen on all network interfaces (IP addresses) on port
    <code class="systemitem">80</code>.
   </p><p>
    Check <span class="guimenu">Open Port In Firewall</span> to open the ports in the
    firewall that the Web server listens on. This is necessary to make the Web
    server available on the network, which can be a LAN, WAN, or the public
    Internet. Keeping the port closed is only useful in test situations where
    no external access to the Web server is necessary. If you have multiple
    network interfaces, click <span class="guimenu">Firewall Details</span> to specify on
    which interface(s) the port(s) should be opened.
   </p><p>
    Click <span class="guimenu">Next</span> to continue with the configuration.
   </p></div><div class="sect4 " id="sec.apache2.configuration.yast.wizard.modules"><div class="titlepage"><div><div><h5 class="title" id="sec.apache2.configuration.yast.wizard.modules"><span class="number">24.2.3.1.2 </span><span class="name">Modules</span> <a title="Permalink" class="permalink" href="#sec.apache2.configuration.yast.wizard.modules">#</a></h5></div></div></div><p>
    The <span class="guimenu">Modules</span> configuration option allows for the
    activation or deactivation of the script languages that the Web server
    should support. For the activation or deactivation of other modules, refer
    to
    <a class="xref" href="#sec.apache2.configuration.yast.server_configuration.modules" title="24.2.3.2.2. Server Modules">Section 24.2.3.2.2, “Server Modules”</a>.
    Click <span class="guimenu">Next</span> to advance to the next dialog.
   </p></div><div class="sect4 " id="sec.apache2.configuration.yast.wizard.default_host"><div class="titlepage"><div><div><h5 class="title" id="sec.apache2.configuration.yast.wizard.default_host"><span class="number">24.2.3.1.3 </span><span class="name">Default Host</span> <a title="Permalink" class="permalink" href="#sec.apache2.configuration.yast.wizard.default_host">#</a></h5></div></div></div><p>
    This option pertains to the default Web server. As explained in
    <a class="xref" href="#sec.apache2.configuration.manually.vhost" title="24.2.2.1. Virtual Host Configuration">Section 24.2.2.1, “Virtual Host Configuration”</a>, Apache can
    serve multiple virtual hosts from a single physical machine. The first
    declared virtual host in the configuration file is commonly called the
    <span class="emphasis"><em>default host</em></span>. Each virtual host inherits the default
    host's configuration.
   </p><p>
    To edit the host settings (also called <span class="emphasis"><em>directives</em></span>),
    select the appropriate entry in the table then click
    <span class="guimenu">Edit</span>. To add new directives, click
    <span class="guimenu">Add</span>. To delete a directive, select it and click
    <span class="guimenu">Delete</span>.
   </p><div class="figure" id="fig.apache2.configuration.yast.host"><div class="figure-contents"><div class="mediaobject"><a xmlns="" href="images/yast2_apache_wizard3.png"><img src="images/yast2_apache_wizard3.png" width="" alt="HTTP Server Wizard: Default Host" /></a></div></div><div class="figure-title-wrap"><h6 class="figure-title"><span class="number">Figure 24.1: </span><span class="name">HTTP Server Wizard: Default Host </span><a title="Permalink" class="permalink" href="#fig.apache2.configuration.yast.host">#</a></h6></div></div><p>
    Here is list of the default settings of the server:
   </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019135740144"><span class="term "><code class="systemitem">Document Root</code>
     </span></dt><dd><p>
       Path to the directory from which Apache serves files for this host.
       <code class="filename">/srv/www/htdocs</code> is the default location.
      </p></dd><dt id="idm140019135737536"><span class="term "><code class="systemitem">Alias</code>
     </span></dt><dd><p>
       Using <code class="systemitem">Alias</code> directives, URLs can be
       mapped to physical file system locations. This means that a certain path
       even outside the <code class="literal">Document Root</code> in the file system can
       be accessed via a URL aliasing that path.
      </p><p>
       The default <span class="productname"><span class="phrase">openSUSE Leap</span></span> <code class="systemitem">Alias</code>
       <code class="filename">/icons</code> points to
       <code class="filename">/usr/share/apache2/icons</code> for the Apache icons
       displayed in the directory index view.
      </p></dd><dt id="idm140019135731392"><span class="term "><code class="systemitem">ScriptAlias</code>
     </span></dt><dd><p>
       Similar to the <code class="systemitem">Alias</code> directive, the
       <code class="systemitem">ScriptAlias</code> directive maps a URL to a file
       system location. The difference is that
       <code class="systemitem">ScriptAlias</code> designates the target directory as
       a CGI location, meaning that CGI scripts should be executed in that
       location.
      </p></dd><dt id="idm140019135727792"><span class="term "><code class="systemitem">Directory</code>
     </span></dt><dd><p>
       With <code class="systemitem">Directory</code> settings, you can enclose a
       group of configuration options that will only apply to the specified
       directory.
      </p><p>
       Access and display options for the directories
       <code class="filename">/srv/www/htdocs</code>,
       <code class="filename">/usr/share/apache2/icons</code> and
       <code class="filename">/srv/www/cgi-bin</code> are configured here. It should not
       be necessary to change the defaults.
      </p></dd><dt id="idm140019135723232"><span class="term "><code class="systemitem">Include</code>
     </span></dt><dd><p>
       With include, additional configuration files can be specified. Two
       <code class="systemitem">Include</code> directives are already preconfigured:
       <code class="filename">/etc/apache2/conf.d/</code> is the directory containing
       the configuration files that come with external modules. With this
       directive, all files in this directory ending in
       <code class="filename">.conf</code> are included. With the second directive,
       <code class="filename">/etc/apache2/conf.d/apache2-manual.conf</code>, the
       <code class="filename">apache2-manual</code> configuration file is included.
      </p></dd><dt id="idm140019135718608"><span class="term "><code class="systemitem">Server Name</code>
     </span></dt><dd><p>
       This specifies the default URL used by clients to contact the Web
       server. Use a fully qualified domain name (FQDN) to reach the Web server
       at <code class="literal">http://<em class="replaceable ">FQDN</em>/</code> or its IP
       address. You cannot choose an arbitrary name here—the server must
       be <span class="quote">“<span class="quote">known</span>”</span> under this name.
      </p></dd><dt id="idm140019135714944"><span class="term "><code class="systemitem">Server Administrator E-Mail</code>
     </span></dt><dd><p>
       E-mail address of the server administrator. This address is, for
       example, shown on error pages Apache creates.
      </p></dd></dl></div><p>
    After finishing with the <span class="guimenu">Default Host</span> step, click
    <span class="guimenu">Next</span> to continue with the configuration.
   </p></div><div class="sect4 " id="sec.apache2.configuration.yast.wizard.virtual_hosts"><div class="titlepage"><div><div><h5 class="title" id="sec.apache2.configuration.yast.wizard.virtual_hosts"><span class="number">24.2.3.1.4 </span><span class="name">Virtual Hosts</span> <a title="Permalink" class="permalink" href="#sec.apache2.configuration.yast.wizard.virtual_hosts">#</a></h5></div></div></div><p>
    In this step, the wizard displays a list of already configured virtual
    hosts (see <a class="xref" href="#sec.apache2.configuration.manually.vhost" title="24.2.2.1. Virtual Host Configuration">Section 24.2.2.1, “Virtual Host Configuration”</a>). If
    you have not made manual changes prior to starting the YaST HTTP wizard,
    no virtual host is present.
   </p><p>
    To add a host, click <span class="guimenu">Add</span> to open a dialog in which to
    enter basic information about the host, such as <span class="guimenu">Server
    Name</span>, <span class="guimenu">Server Contents Root</span>
    (<code class="systemitem">DocumentRoot</code>), and the <span class="guimenu">Administrator
    E-Mail</span>. <span class="guimenu">Server Resolution</span> is used to determine
    how a host is identified (name based or IP based). Specify the name or IP
    address with <span class="guimenu">Change Virtual Host ID</span>
   </p><p>
    Clicking <span class="guimenu">Next</span> advances to the second part of the virtual
    host configuration dialog.
   </p><p>
    In part two of the virtual host configuration you can specify whether to
    enable CGI scripts and which directory to use for these scripts. It is also
    possible to enable SSL. If you do so, you must specify the path to the
    certificate as well. See <a class="xref" href="#sec.apache2.ssl.configuration" title="24.6.2. Configuring Apache with SSL">Section 24.6.2, “Configuring Apache with SSL”</a>
    for details on SSL and certificates. With the <span class="guimenu">Directory
    Index</span> option, you can specify which file to display when the
    client requests a directory (by default, <code class="filename">index.html</code>).
    Add one or more file names (space-separated) to change this.
    With <span class="guimenu">Enable Public HTML</span>, the content of the users public
    directories
    (<code class="filename">~<em class="replaceable ">USER</em>/public_html/</code>) is
    made available on the server under
    <code class="literal">http://www.example.com/~<em class="replaceable ">USER</em></code>.
   </p><div id="idm140019135699344" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.png" /><h6>Important: Creating Virtual Hosts</h6><p>
     It is not possible to add virtual hosts at will. If using name-based
     virtual hosts, each host name must be resolved on the network. If using
     IP-based virtual hosts, you can assign only one host to each IP address
     available.
    </p></div></div><div class="sect4 " id="sec.apache2.configuration.yast.wizard.summary"><div class="titlepage"><div><div><h5 class="title" id="sec.apache2.configuration.yast.wizard.summary"><span class="number">24.2.3.1.5 </span><span class="name">Summary</span> <a title="Permalink" class="permalink" href="#sec.apache2.configuration.yast.wizard.summary">#</a></h5></div></div></div><p>
    This is the final step of the wizard. Here, determine how and when the
    Apache server is started: when booting or manually. Also see a short
    summary of the configuration made so far. If you are satisfied with your
    settings, click <span class="guimenu">Finish</span> to complete configuration. To change something, click <span class="guimenu">Back</span> until you have
    reached the desired dialog. Clicking <span class="guimenu">HTTP Server Expert
    Configuration</span> opens the dialog described in
    <a class="xref" href="#sec.apache2.configuration.yast.server_configuration" title="24.2.3.2. HTTP Server Configuration">Section 24.2.3.2, “HTTP Server Configuration”</a>.
   </p><div class="figure" id="fig.apache2.configuration.yast.summary"><div class="figure-contents"><div class="mediaobject"><a xmlns="" href="images/yast2_apache_wizard5.png"><img src="images/yast2_apache_wizard5.png" width="" alt="HTTP Server Wizard: Summary" /></a></div></div><div class="figure-title-wrap"><h6 class="figure-title"><span class="number">Figure 24.2: </span><span class="name">HTTP Server Wizard: Summary </span><a title="Permalink" class="permalink" href="#fig.apache2.configuration.yast.summary">#</a></h6></div></div></div></div><div class="sect3 " id="sec.apache2.configuration.yast.server_configuration"><div class="titlepage"><div><div><h4 class="title" id="sec.apache2.configuration.yast.server_configuration"><span class="number">24.2.3.2 </span><span class="name">HTTP Server Configuration</span> <a title="Permalink" class="permalink" href="#sec.apache2.configuration.yast.server_configuration">#</a></h4></div></div></div><p>
   The <span class="guimenu">HTTP Server Configuration</span> dialog also lets you make
   even more adjustments to the configuration than the wizard (which only runs
   if you configure your Web server for the first time). It consists of four
   tabs described in the following. No configuration option you change here is
   effective immediately—you always must confirm your changes with
   <span class="guimenu">Finish</span> to make them effective. Clicking
   <span class="guimenu">Abort</span> leaves the configuration module and discards your
   changes.
  </p><div class="sect4 " id="sec.apache2.configuration.yast.server_configuration.listen"><div class="titlepage"><div><div><h5 class="title" id="sec.apache2.configuration.yast.server_configuration.listen"><span class="number">24.2.3.2.1 </span><span class="name">Listen Ports and Addresses</span> <a title="Permalink" class="permalink" href="#sec.apache2.configuration.yast.server_configuration.listen">#</a></h5></div></div></div><p>
    In <span class="guimenu">HTTP Service</span>, select whether Apache should be running
    (<span class="guimenu">Enabled</span>) or stopped (<span class="guimenu">Disabled</span>). In
    <span class="guimenu">Listen on Ports</span>, <span class="guimenu">Add</span>,
    <span class="guimenu">Edit</span>, or <span class="guimenu">Delete</span> addresses and ports
    on which the server should be available. The default is to listen on all
    interfaces on port <code class="literal">80</code>. You should always check
    <span class="guimenu">Open Port In Firewall</span>, because otherwise the Web server
    is not reachable from outside. Keeping the port closed is only useful in
    test situations where no external access to the Web server is necessary. If
    you have multiple network interfaces, click <span class="guimenu">Firewall
    Details</span> to specify on which interface(s) the port(s) should be
    opened.
   </p><p>
    With <span class="guimenu">Log Files</span>, watch either the access log file or the
    error log file. This is useful if you want to test your configuration. The
    log file opens in a separate window from which you can also restart or
    reload the Web server. For details, see
    <a class="xref" href="#sec.apache2.start_stop" title="24.3. Starting and Stopping Apache">Section 24.3, “Starting and Stopping Apache”</a>. These commands are effective
    immediately and their log messages are also displayed immediately.
   </p><div class="figure" id="fig.apache2.configuration.yast.server_configuration.listen"><div class="figure-contents"><div class="mediaobject"><a xmlns="" href="images/yast2_apache_config_listen.png"><img src="images/yast2_apache_config_listen.png" width="" alt="HTTP Server Configuration: Listen Ports and Addresses" /></a></div></div><div class="figure-title-wrap"><h6 class="figure-title"><span class="number">Figure 24.3: </span><span class="name">HTTP Server Configuration: Listen Ports and Addresses </span><a title="Permalink" class="permalink" href="#fig.apache2.configuration.yast.server_configuration.listen">#</a></h6></div></div></div><div class="sect4 " id="sec.apache2.configuration.yast.server_configuration.modules"><div class="titlepage"><div><div><h5 class="title" id="sec.apache2.configuration.yast.server_configuration.modules"><span class="number">24.2.3.2.2 </span><span class="name">Server Modules</span> <a title="Permalink" class="permalink" href="#sec.apache2.configuration.yast.server_configuration.modules">#</a></h5></div></div></div><p>
    You can change the status (enabled or disabled) of Apache2 modules by
    clicking <span class="guimenu">Toggle Status</span>. Click <span class="guimenu">Add
    Module</span> to add a new module that is already installed but not yet
    listed. Learn more about modules in <a class="xref" href="#sec.apache2.modules" title="24.4. Installing, Activating, and Configuring Modules">Section 24.4, “Installing, Activating, and Configuring Modules”</a>.
   </p><div class="figure" id="fig.apache2.configuration.yast.server_configuration.modules"><div class="figure-contents"><div class="mediaobject"><a xmlns="" href="images/yast2_apache_config_modules.png"><img src="images/yast2_apache_config_modules.png" width="" alt="HTTP Server Configuration: Server Modules" /></a></div></div><div class="figure-title-wrap"><h6 class="figure-title"><span class="number">Figure 24.4: </span><span class="name">HTTP Server Configuration: Server Modules </span><a title="Permalink" class="permalink" href="#fig.apache2.configuration.yast.server_configuration.modules">#</a></h6></div></div></div><div class="sect4 " id="sec.apache2.configuration.yast.server_configuration.host"><div class="titlepage"><div><div><h5 class="title" id="sec.apache2.configuration.yast.server_configuration.host"><span class="number">24.2.3.2.3 </span><span class="name">Main Host or Hosts</span> <a title="Permalink" class="permalink" href="#sec.apache2.configuration.yast.server_configuration.host">#</a></h5></div></div></div><p>
    These dialogs are identical to the ones already described. Refer to
    <a class="xref" href="#sec.apache2.configuration.yast.wizard.default_host" title="24.2.3.1.3. Default Host">Section 24.2.3.1.3, “Default Host”</a> and
    <a class="xref" href="#sec.apache2.configuration.yast.wizard.virtual_hosts" title="24.2.3.1.4. Virtual Hosts">Section 24.2.3.1.4, “Virtual Hosts”</a>.
   </p></div></div></div></div><div class="sect1 " id="sec.apache2.start_stop"><div class="titlepage"><div><div><h2 class="title" id="sec.apache2.start_stop"><span class="number">24.3 </span><span class="name">Starting and Stopping Apache</span> <a title="Permalink" class="permalink" href="#sec.apache2.start_stop">#</a></h2></div></div></div><p>
   If configured with YaST as described in
   <a class="xref" href="#sec.apache2.configuration.yast" title="24.2.3. Configuring Apache with YaST">Section 24.2.3, “Configuring Apache with YaST”</a>, Apache is started at boot
   time in the <code class="systemitem">multi-user.target</code> and
   <code class="systemitem">graphical.target</code>. You can change this behavior
   using YaST's <span class="guimenu">Services Manager</span> or with the
   <code class="command">systemctl</code> command line tool (<code class="command">systemctl
   enable</code> or <code class="command">systemctl disable</code>).
  </p><p>
   To start, stop, or manipulate Apache on a running system, use either the
   <code class="command">systemctl</code> or the <code class="command">apachectl</code> commands as
   described below.
  </p><p>
   For general information about <code class="command">systemctl</code> commands, refer
   to <a class="xref" href="#sec.boot.systemd.basics.services" title="10.2.1. Managing Services in a Running System">Section 10.2.1, “Managing Services in a Running System”</a>.
  </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019135649184"><span class="term "><code class="command">systemctl status apache2</code>
    </span></dt><dd><p>
      Checks if Apache is started.
     </p></dd><dt id="idm140019135647056"><span class="term "><code class="command">systemctl start apache2</code>
    </span></dt><dd><p>
      Starts Apache if it is not already running.
     </p></dd><dt id="idm140019135645008"><span class="term "><code class="command">systemctl stop apache2</code>
    </span></dt><dd><p>
      Stops Apache by terminating the parent process.
     </p></dd><dt id="idm140019135642880"><span class="term "><code class="command">systemctl restart apache2</code>
    </span></dt><dd><p>
      Stops and then restarts Apache. Starts the Web server if it was not
      running before.
     </p></dd><dt id="idm140019135640704"><span class="term "><code class="command">systemctl try-restart apache2</code>
    </span></dt><dd><p>
      Stops then restarts Apache only if it is already running.
     </p></dd><dt id="idm140019135638560"><span class="term "><code class="command">systemctl reload apache2</code>
    </span></dt><dd><p>
      Stops the Web server by advising all forked Apache processes to first
      finish their requests before shutting down. As each process dies, it is
      replaced by a newly started one, resulting in a complete
      <span class="quote">“<span class="quote">restart</span>”</span> of Apache.
     </p><div id="idm140019135636128" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.png" /><h6>Tip: Restarting Apache in Production Environments</h6><p>
       This command allows activating changes in the Apache configuration
       without causing connection break-offs.
      </p></div></dd><dt id="idm140019135634320"><span class="term "><code class="command">systemctl stop apache2</code></span></dt><dd><p>
      Stops the Web server after a defined period of time configured with
      <code class="systemitem">GracefulShutdownTimeout</code> to ensure that existing
      requests can be finished.
     </p></dd><dt id="idm140019135631840"><span class="term "><code class="command">apachectl configtest</code>
    </span></dt><dd><p>
      Checks the syntax of the configuration files without affecting a running
      Web server. Because this check is forced every time the server is
      started, reloaded, or restarted, it is usually not necessary to run the
      test explicitly (if a configuration error is found, the Web server is not
      started, reloaded, or restarted).
     </p></dd><dt id="idm140019135629424"><span class="term "><code class="command">apachectl status</code> and
      <code class="command">apachectl fullstatus</code>
    </span></dt><dd><p>
      Dumps a short or full status screen, respectively. Requires the module
      <code class="systemitem">mod_status</code> to be enabled and a text-based
      browser (such as <code class="command">links</code> or
      <code class="command">w3m</code>) installed.
      
      In addition to that,
      <code class="literal">status</code> must be added to
      <code class="systemitem">APACHE_SERVER_FLAGS</code> in the file
      <code class="filename">/etc/sysconfig/apache2</code>.
     </p></dd></dl></div><div id="idm140019135623360" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.png" /><h6>Tip: Additional Flags</h6><p>
    If you specify additional flags to the commands,
    these are passed through to the Web server.
   </p></div></div><div class="sect1 " id="sec.apache2.modules"><div class="titlepage"><div><div><h2 class="title" id="sec.apache2.modules"><span class="number">24.4 </span><span class="name">Installing, Activating, and Configuring Modules</span> <a title="Permalink" class="permalink" href="#sec.apache2.modules">#</a></h2></div></div></div><p>
   The Apache software is built in a modular fashion: all functionality except
   some core tasks are handled by modules. This has progressed so far that even
   HTTP is processed by a module (<code class="systemitem">http_core</code>).
  </p><p>
   Apache modules can be compiled into the Apache binary at build time or
   be dynamically loaded at runtime. Refer to
   <a class="xref" href="#sec.apache2.modules.activating" title="24.4.2. Activation and Deactivation">Section 24.4.2, “Activation and Deactivation”</a> for details of how to load
   modules dynamically.
  </p><p>
   Apache modules can be divided into four different categories:
  </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019135617536"><span class="term ">Base Modules</span></dt><dd><p>
      Base modules are compiled into Apache by default. Apache in <span class="productname"><span class="phrase">openSUSE Leap</span></span>
      has only <code class="systemitem">mod_so</code> (needed to load other modules)
      and <code class="systemitem">http_core</code> compiled in. All others are
      available as shared objects: rather than being included in the server
      binary itself, they can be included at runtime.
     </p></dd><dt id="idm140019135613504"><span class="term ">Extension Modules</span></dt><dd><p>
      In general, modules labeled as extensions are included in the Apache
      software package, but are usually not compiled into the server
      statically. In <span class="productname"><span class="phrase">openSUSE Leap</span></span>, they are available as shared objects that
      can be loaded into Apache at runtime.
     </p></dd><dt id="idm140019135610368"><span class="term ">External Modules</span></dt><dd><p>
      Modules labeled external are not included in the official Apache
      distribution. However, <span class="productname"><span class="phrase">openSUSE Leap</span></span> provides several of them.
     </p></dd><dt id="idm140019135607360"><span class="term ">Multiprocessing Modules (MPMs)</span></dt><dd><p>
      MPMs are responsible for accepting and handling requests to the Web
      server, representing the core of the Web server software.
     </p></dd></dl></div><div class="sect2 " id="sec.apache2.modules.installing"><div class="titlepage"><div><div><h3 class="title" id="sec.apache2.modules.installing"><span class="number">24.4.1 </span><span class="name">Module Installation</span> <a title="Permalink" class="permalink" href="#sec.apache2.modules.installing">#</a></h3></div></div></div><p>
    If you have done a default installation as described in
    <a class="xref" href="#sec.apache2.quickstart.installation" title="24.1.2. Installation">Section 24.1.2, “Installation”</a>, the following
    modules are already installed: all base and extension modules, the
    multiprocessing module Prefork MPM, and the external module
    <code class="systemitem">mod_python</code>.
   </p><p>
    You can install additional external modules by starting YaST and choosing
    <span class="guimenu">Software</span> › <span class="guimenu">Software
    Management</span>. Now choose
    <span class="guimenu">View</span> › <span class="guimenu">Search</span>
    and search for <code class="literal">apache</code>. Among other packages, the
    results list contains all available external Apache modules.
   </p></div><div class="sect2 " id="sec.apache2.modules.activating"><div class="titlepage"><div><div><h3 class="title" id="sec.apache2.modules.activating"><span class="number">24.4.2 </span><span class="name">Activation and Deactivation</span> <a title="Permalink" class="permalink" href="#sec.apache2.modules.activating">#</a></h3></div></div></div><p>
    Activate or deactivate particular modules either manually or with YaST.
    In YaST, script language modules (PHP 5, and Python) need to be
    enabled or disabled with the module configuration described in
    <a class="xref" href="#sec.apache2.configuration.yast.wizard" title="24.2.3.1. HTTP Server Wizard">Section 24.2.3.1, “HTTP Server Wizard”</a>. All other modules
    can be enabled or disabled as described in
    <a class="xref" href="#sec.apache2.configuration.yast.server_configuration.modules" title="24.2.3.2.2. Server Modules">Section 24.2.3.2.2, “Server Modules”</a>.
   </p><p>
    If you prefer to activate or deactivate the modules manually, use the
    commands <code class="command">a2enmod</code> <em class="replaceable ">MODULE</em> or
    <code class="command">a2dismod</code> <em class="replaceable ">MODULE</em>,
    respectively. <code class="command">a2enmod -l</code> outputs a list of all currently
    active modules.
   </p><div id="idm140019135593232" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.png" /><h6>Important: Including Configuration Files for External Modules</h6><p>
     If you have activated external modules manually, make sure to load their
     configuration files in all virtual host configurations. Configuration
     files for external modules are located under
     <code class="filename">/etc/apache2/conf.d/</code> and are loaded in
     <code class="filename">/etc/apache2/default-server.conf</code> by default. For more
     fine-grained control you can comment out the inclusion in
     <code class="filename">/etc/apache2/default-server.conf</code> and add it to
     specific virtual hosts only. See
     <code class="filename">/etc/apache2/vhosts.d/vhost.template</code> for examples.
    </p></div></div><div class="sect2 " id="sec.apache2.modules.base_extension"><div class="titlepage"><div><div><h3 class="title" id="sec.apache2.modules.base_extension"><span class="number">24.4.3 </span><span class="name">Base and Extension Modules</span> <a title="Permalink" class="permalink" href="#sec.apache2.modules.base_extension">#</a></h3></div></div></div><p>
    All base and extension modules are described in detail in the Apache
    documentation. Only a brief description of the most important modules is
    available here. Refer to
    <a class="link" href="http://httpd.apache.org/docs/2.4/mod/" target="_blank">http://httpd.apache.org/docs/2.4/mod/</a>
    to learn details about each module.
   </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019135585936"><span class="term "><code class="systemitem">mod_actions</code>
     </span></dt><dd><p>
       Provides methods to execute a script whenever a certain MIME type (such
       as <code class="systemitem">application/pdf</code>), a file with a specific
       extension (like <code class="filename">.rpm</code>), or a certain request method
       (such as <code class="systemitem">GET</code>) is requested. This module is
       enabled by default.
      </p></dd><dt id="idm140019135582320"><span class="term "><code class="systemitem">mod_alias</code>
     </span></dt><dd><p>
       Provides <code class="systemitem">Alias</code> and
       <code class="systemitem">Redirect</code> directives with which you can map a
       URL to a specific directory (<code class="systemitem">Alias</code>) or redirect
       a requested URL to another location. This module is enabled by default.
      </p></dd><dt id="idm140019135578752"><span class="term "><code class="systemitem">mod_auth*</code>
     </span></dt><dd><p>
       The authentication modules provide different authentication methods:
       basic authentication with <code class="systemitem">mod_auth_basic</code> or
       digest authentication with <code class="systemitem">mod_auth_digest</code>.
      </p><p>
       <code class="systemitem">mod_auth_basic</code> and
       <code class="systemitem">mod_auth_digest</code> must be combined with an
       authentication provider module, <code class="systemitem">mod_authn_*</code>
       (for example, <code class="systemitem">mod_authn_file</code> for text
       file–based authentication) and with an authorization module
       <code class="systemitem">mod_authz_*</code> (for example,
       <code class="systemitem">mod_authz_user</code> for user authorization).
      </p><p>
       More information about this topic is available in the
       <em class="citetitle ">Authentication HOWTO</em> at
       <a class="link" href="http://httpd.apache.org/docs/2.4/howto/auth.html" target="_blank">http://httpd.apache.org/docs/2.4/howto/auth.html</a>.
      </p></dd><dt id="idm140019135570864"><span class="term "><code class="systemitem">mod_autoindex</code>
     </span></dt><dd><p>
       Autoindex generates directory listings when no index file (for example,
       <code class="filename">index.html</code>) is present. The look and feel of these
       indexes is configurable. This module is enabled by default. However,
       directory listings are disabled by default via the
       <code class="systemitem">Options</code> directive—overwrite this setting
       in your virtual host configuration. The default configuration file for
       this module is located at
       <code class="filename">/etc/apache2/mod_autoindex-defaults.conf</code>.
      </p></dd><dt id="idm140019135567040"><span class="term "><code class="systemitem">mod_cgi</code>
     </span></dt><dd><p>
       <code class="systemitem">mod_cgi</code> is needed to execute CGI scripts. This
       module is enabled by default.
      </p></dd><dt id="idm140019135564448"><span class="term "><code class="systemitem">mod_deflate</code>
     </span></dt><dd><p>
       Using this module, Apache can be configured to compress given file types
       on the fly before delivering them.
      </p></dd><dt id="idm140019135562256"><span class="term "><code class="systemitem">mod_dir</code>
     </span></dt><dd><p>
       <code class="systemitem">mod_dir</code> provides the
       <code class="systemitem">DirectoryIndex</code> directive with which you can
       configure which files are automatically delivered when a directory is
       requested (<code class="filename">index.html</code> by default). It also provides
       an automatic redirect to the correct URL when a directory request does
       not contain a trailing slash. This module is enabled by default.
      </p></dd><dt id="idm140019135558544"><span class="term "><code class="systemitem">mod_env</code>
     </span></dt><dd><p>
       Controls the environment that is passed to CGI scripts or SSI pages.
       Environment variables can be set or unset or passed from the shell that
       invoked the httpd process. This module is enabled by default.
      </p></dd><dt id="idm140019135556256"><span class="term "><code class="systemitem">mod_expires</code>
     </span></dt><dd><p>
       With <code class="systemitem">mod_expires</code>, you can control how often
       proxy and browser caches refresh your documents by sending an
       <code class="systemitem">Expires</code> header. This module is enabled by
       default.
      </p></dd><dt id="idm140019135553136"><span class="term "><code class="systemitem">mod_http2</code>
     </span></dt><dd><p>
       With <code class="systemitem">mod_http2</code>, Apache gains support for the
       HTTP/2 protocol. It can be enabled by specifying
       <code class="literal">Protocols h2 http/1.1</code> in a
       <code class="systemitem">VirtualHost</code>.
      </p></dd><dt id="idm140019135549632"><span class="term "><code class="systemitem">mod_include</code>
     </span></dt><dd><p>
       <code class="systemitem">mod_include</code> lets you use Server Side Includes
       (SSI), which provide a basic functionality to generate HTML pages
       dynamically. This module is enabled by default.
      </p></dd><dt id="idm140019135546944"><span class="term "><code class="systemitem">mod_info</code>
     </span></dt><dd><p>
       Provides a comprehensive overview of the server configuration under
       http://localhost/server-info/. For security reasons, you should always
       limit access to this URL. By default only
       <code class="systemitem">localhost</code> is allowed to
       access this URL. <code class="systemitem">mod_info</code> is configured at
       <code class="filename">/etc/apache2/mod_info.conf</code>.
      </p></dd><dt id="idm140019135543008"><span class="term "><code class="systemitem">mod_log_config</code>
     </span></dt><dd><p>
       With this module, you can configure the look of the Apache log files.
       This module is enabled by default.
      </p></dd><dt id="idm140019135540816"><span class="term "><code class="systemitem">mod_mime</code>
     </span></dt><dd><p>
       The mime module ensures that a file is delivered with the correct
       MIME header based on the file name's extension (for example
       <code class="systemitem">text/html</code> for HTML documents). This module is
       enabled by default.
      </p></dd><dt id="idm140019135538112"><span class="term "><code class="systemitem">mod_negotiation</code>
     </span></dt><dd><p>
       Necessary for content negotiation. See
       <a class="link" href="http://httpd.apache.org/docs/2.4/content-negotiation.html" target="_blank">http://httpd.apache.org/docs/2.4/content-negotiation.html</a>
       for more information. This module is enabled by default.
      </p></dd><dt id="idm140019135535136"><span class="term "><code class="systemitem">mod_rewrite</code>
     </span></dt><dd><p>
       Provides the functionality of <code class="systemitem">mod_alias</code>, but
       offers more features and flexibility. With
       <code class="systemitem">mod_rewrite</code>, you can redirect URLs based on
       multiple rules, request headers, and more.
      </p></dd><dt id="idm140019135532016"><span class="term "><code class="systemitem">mod_setenvif</code>
     </span></dt><dd><p>
       Sets environment variables based on details of the client's request,
       such as the browser string the client sends, or the client's IP address.
       This module is enabled by default.
      </p></dd><dt id="idm140019135529744"><span class="term "><code class="systemitem">mod_spelling</code>
     </span></dt><dd><p>
       <code class="systemitem">mod_spelling</code> attempts to automatically correct
       typographical errors in URLs, such as capitalization errors.
      </p></dd><dt id="idm140019135527120"><span class="term "><code class="systemitem">mod_ssl</code>
     </span></dt><dd><p>
       Enables encrypted connections between Web server and clients. See
       <a class="xref" href="#sec.apache2.ssl" title="24.6. Setting Up a Secure Web Server with SSL">Section 24.6, “Setting Up a Secure Web Server with SSL”</a> for details. This module is enabled by
       default.
      </p></dd><dt id="idm140019135524368"><span class="term "><code class="systemitem">mod_status</code>
     </span></dt><dd><p>
       Provides information on server activity and performance under
       http://localhost/server-status/. For security reasons, you should always
       limit access to this URL. By default, only
       <code class="systemitem">localhost</code> is allowed to
       access this URL. <code class="systemitem">mod_status</code> is configured at
       <code class="filename">/etc/apache2/mod_status.conf</code>.
      </p></dd><dt id="idm140019135520432"><span class="term "><code class="systemitem">mod_suexec</code>
     </span></dt><dd><p>
       <code class="systemitem">mod_suexec</code> lets you run CGI scripts under a
       different user and group. This module is enabled by default.
      </p></dd><dt id="idm140019135517808"><span class="term "><code class="systemitem">mod_userdir</code>
     </span></dt><dd><p>
       Enables user-specific directories available under
       <code class="filename">~<em class="replaceable ">USER</em>/</code>. The
       <code class="systemitem">UserDir</code> directive must be specified in the
       configuration. This module is enabled by default.
      </p></dd></dl></div></div><div class="sect2 " id="sec.apache2.modules.mpm"><div class="titlepage"><div><div><h3 class="title" id="sec.apache2.modules.mpm"><span class="number">24.4.4 </span><span class="name">Multiprocessing Modules</span> <a title="Permalink" class="permalink" href="#sec.apache2.modules.mpm">#</a></h3></div></div></div><p>
    <span class="productname"><span class="phrase">openSUSE Leap</span></span> provides two different multiprocessing modules (MPMs) for use
    with Apache:
   </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
      <a class="xref" href="#sec.apache2.modules.mpm.prefork" title="24.4.4.1. Prefork MPM">Prefork MPM</a>
     </p></li><li class="listitem "><p>
      <a class="xref" href="#sec.apache2.modules.mpm.worker" title="24.4.4.2. Worker MPM">Worker MPM</a>
     </p></li></ul></div><div class="sect3 " id="sec.apache2.modules.mpm.prefork"><div class="titlepage"><div><div><h4 class="title" id="sec.apache2.modules.mpm.prefork"><span class="number">24.4.4.1 </span><span class="name">Prefork MPM</span> <a title="Permalink" class="permalink" href="#sec.apache2.modules.mpm.prefork">#</a></h4></div></div></div><p>
     The prefork MPM implements a non-threaded, preforking Web server. It makes
     the Web server behave similarly to Apache version 1.x. In this version it
     isolates each request and handles it by forking a separate child process.
     Thus problematic requests cannot affect others, avoiding a lockup of the
     Web server.
    </p><p>
     While providing stability with this process-based approach, the prefork
     MPM consumes more system resources than its counterpart, the worker MPM.
     The prefork MPM is considered the default MPM for Unix-based operating
     systems.
    </p><div id="idm140019135503952" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.png" /><h6>Important: MPMs in This Document</h6><p>
      This document assumes Apache is used with the prefork MPM.
     </p></div></div><div class="sect3 " id="sec.apache2.modules.mpm.worker"><div class="titlepage"><div><div><h4 class="title" id="sec.apache2.modules.mpm.worker"><span class="number">24.4.4.2 </span><span class="name">Worker MPM</span> <a title="Permalink" class="permalink" href="#sec.apache2.modules.mpm.worker">#</a></h4></div></div></div><p>
     The worker MPM provides a multi-threaded Web server. A thread is a
     <span class="quote">“<span class="quote">lighter</span>”</span> form of a process. The advantage of a thread over a
     process is its lower resource consumption. Instead of only forking child
     processes, the worker MPM serves requests by using threads with server
     processes. The preforked child processes are multi-threaded. This approach
     makes Apache perform better by consuming fewer system resources than the
     prefork MPM.
    </p><p>
     One major disadvantage is the stability of the worker MPM: if a thread
     becomes corrupt, all threads of a process can be affected. In the worst
     case, this may result in a server crash. Especially when using the Common
     Gateway Interface (CGI) with Apache under heavy load, internal server
     errors might occur because of threads being unable to communicate with
     system resources. Another argument against using the worker MPM with
     Apache is that not all available Apache modules are thread-safe and thus
     cannot be used with the worker MPM.
    </p><div id="idm140019135498864" class="admonition warning normal"><img class="symbol" alt="Warning" title="Warning" src="static/images/icon-warning.png" /><h6>Warning: Using PHP Modules with MPMs</h6><p>
      Not all available PHP modules are thread-safe. Using the worker MPM with
      <code class="systemitem">mod_php</code> is strongly discouraged.
     </p></div></div></div><div class="sect2 " id="sec.apache2.modules.external"><div class="titlepage"><div><div><h3 class="title" id="sec.apache2.modules.external"><span class="number">24.4.5 </span><span class="name">External Modules</span> <a title="Permalink" class="permalink" href="#sec.apache2.modules.external">#</a></h3></div></div></div><p>
    Find a list of all external modules shipped with <span class="productname"><span class="phrase">openSUSE Leap</span></span> here. Find
    the module's documentation in the listed directory.
   </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019135493520"><span class="term "><code class="systemitem">mod_apparmor</code>
     </span></dt><dd><p>
       Adds support to Apache to provide <span class="phrase">AppArmor</span> confinement to individual CGI
       scripts handled by modules like <code class="systemitem">mod_php5</code>.
      </p><table border="0" summary="Simple list" class="simplelist "><tr><td>
        Package Name: <code class="systemitem">apache2-mod_apparmor</code>
       </td></tr><tr><td>
        More Information: <span class="intraxref">Book “<em class="citetitle ">Security Guide</em>”</span>
       </td></tr></table></dd><dt id="idm140019135488144"><span class="term "><code class="systemitem">mod_php5</code>
     </span></dt><dd><p>
       PHP is a server-side, cross-platform HTML embedded scripting language.
      </p><table border="0" summary="Simple list" class="simplelist "><tr><td>
        Package Name: <code class="systemitem">apache2-mod_php5</code>
       </td></tr><tr><td>
        Configuration File: <code class="filename">/etc/apache2/conf.d/php5.conf</code>
       </td></tr><tr><td>
        More Information:
        <code class="filename">/usr/share/doc/packages/apache2-mod_php5</code>
       </td></tr></table></dd><dt id="idm140019135482784"><span class="term "><code class="systemitem">mod_python</code>
     </span></dt><dd><p>
       <code class="systemitem">mod_python</code> allows embedding Python within the
       Apache HTTP server for a considerable boost in performance and added
       flexibility in designing Web-based applications.
      </p><table border="0" summary="Simple list" class="simplelist "><tr><td>
        Package Name: <code class="systemitem">apache2-mod_python</code>
       </td></tr><tr><td>
        More Information:
        <code class="filename">/usr/share/doc/packages/apache2-mod_python</code>
       </td></tr></table></dd><dt id="idm140019135477808"><span class="term "><code class="systemitem">mod_security</code>
     </span></dt><dd><p>
       <code class="systemitem">mod_security</code> provides a Web application
       firewall to protect Web applications from a range of attacks. It also
       enables HTTP traffic monitoring and real-time analysis.
      </p><table border="0" summary="Simple list" class="simplelist "><tr><td>
        Package Name: <code class="systemitem">apache2-mod_security2</code>
       </td></tr><tr><td>
        Configuration File: <code class="filename">/etc/apache2/conf.d/mod_security2.conf</code>
       </td></tr><tr><td>
        More Information: <code class="filename">/usr/share/doc/packages/apache2-mod_security2</code>
       </td></tr><tr><td>
        Documentation: <a class="link" href="http://modsecurity.org/documentation/" target="_blank">http://modsecurity.org/documentation/</a>
       </td></tr></table></dd></dl></div></div><div class="sect2 " id="sec.apache2.modules.building_modules"><div class="titlepage"><div><div><h3 class="title" id="sec.apache2.modules.building_modules"><span class="number">24.4.6 </span><span class="name">Compilation</span> <a title="Permalink" class="permalink" href="#sec.apache2.modules.building_modules">#</a></h3></div></div></div><p>
    Apache can be extended by advanced users by writing custom modules. To
    develop modules for Apache or compile third-party modules, the package
    <code class="systemitem">apache2-devel</code> is required along with the
    corresponding development tools. <code class="systemitem">apache2-devel</code>
    also contains the <code class="command">apxs2</code> tools, which are necessary for
    compiling additional modules for Apache.
   </p><p>
    <code class="command">apxs2</code> enables the compilation and installation of
    modules from source code (including the required changes to the
    configuration files), which creates <span class="emphasis"><em>dynamic shared
    objects</em></span> (DSOs) that can be loaded into Apache at runtime.
   </p><p>
    The <code class="command">apxs2</code> binaries are located under
    <code class="filename">/usr/sbin</code>:
   </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
      <code class="filename">/usr/sbin/apxs2</code>—suitable for building an
      extension module that works with any MPM. The installation location is
      <code class="filename">/usr/lib64/apache2</code>.
     </p></li><li class="listitem "><p>
      <code class="filename">/usr/sbin/apxs2-prefork</code>—suitable for prefork
      MPM modules. The installation location is
      <code class="filename">/usr/lib64/apache2-prefork</code>.
     </p></li><li class="listitem "><p>
      <code class="filename">/usr/sbin/apxs2-worker</code>—suitable for worker MPM
      modules. The installation location is
      <code class="filename">/usr/lib64/apache2-worker</code>.
     </p></li></ul></div><p>
    Install and activate a module from source code with the following commands:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> cd /path/to/module/source
<code class="prompt user">tux &gt; </code><code class="command">sudo</code> apxs2 -cia <em class="replaceable ">MODULE</em>.c</pre></div><p>
    where <code class="option">-c</code> compiles the module, <code class="option">-i</code> installs
    it, and <code class="option">-a</code> activates it. Other options of
    <code class="command">apxs2</code> are described in the
    <code class="systemitem">apxs2(1)</code> man page.
   </p></div></div><div class="sect1 " id="sec.apache2.cgi"><div class="titlepage"><div><div><h2 class="title" id="sec.apache2.cgi"><span class="number">24.5 </span><span class="name">Enabling CGI Scripts</span> <a title="Permalink" class="permalink" href="#sec.apache2.cgi">#</a></h2></div></div></div><p>
   Apache's Common Gateway Interface (CGI) lets you create dynamic content with
   programs or scripts usually called CGI scripts. CGI scripts can be written
   in any programming language. Usually, script languages such as PHP
   are used.
  </p><p>
   To enable Apache to deliver content created by CGI scripts,
   <code class="systemitem">mod_cgi</code> needs to be activated.
   <code class="systemitem">mod_alias</code> is also needed. Both modules are enabled
   by default. Refer to <a class="xref" href="#sec.apache2.modules.activating" title="24.4.2. Activation and Deactivation">Section 24.4.2, “Activation and Deactivation”</a> for
   details on activating modules.
  </p><div id="idm140019135448096" class="admonition warning normal"><img class="symbol" alt="Warning" title="Warning" src="static/images/icon-warning.png" /><h6>Warning: CGI Security</h6><p>
    Allowing the server to execute CGI scripts is a potential security hole.
    Refer to <a class="xref" href="#sec.apache2.security" title="24.8. Avoiding Security Problems">Section 24.8, “Avoiding Security Problems”</a> for additional information.
   </p></div><div class="sect2 " id="sec.apache2.cgi.configuration"><div class="titlepage"><div><div><h3 class="title" id="sec.apache2.cgi.configuration"><span class="number">24.5.1 </span><span class="name">Apache Configuration</span> <a title="Permalink" class="permalink" href="#sec.apache2.cgi.configuration">#</a></h3></div></div></div><p>
    In <span class="productname"><span class="phrase">openSUSE Leap</span></span>, the execution of CGI scripts is only allowed in the
    directory <code class="filename">/srv/www/cgi-bin/</code>. This location is already
    configured to execute CGI scripts. If you have created a virtual host
    configuration (see
    <a class="xref" href="#sec.apache2.configuration.manually.vhost" title="24.2.2.1. Virtual Host Configuration">Section 24.2.2.1, “Virtual Host Configuration”</a>) and want to
    place your scripts in a host-specific directory, you must unlock and
    configure this directory.
   </p><div class="example" id="ex.apache2.cgi.configuration"><div class="example-title-wrap"><h6 class="example-title"><span class="number">Example 24.5: </span><span class="name">VirtualHost CGI Configuration </span><a title="Permalink" class="permalink" href="#ex.apache2.cgi.configuration">#</a></h6></div><div class="example-contents"><div class="verbatim-wrap"><pre class="screen">ScriptAlias /cgi-bin/ "/srv/www/www.example.com/cgi-bin/"<span id="co.apache2.cgi.script_alias"></span><span class="callout">1</span>

&lt;Directory "/srv/www/www.example.com/cgi-bin/"&gt;
 Options +ExecCGI<span id="co.apache2.cgi.options"></span><span class="callout">2</span>
 AddHandler cgi-script .cgi .pl<span id="co.apache2.cgi.handler"></span><span class="callout">3</span>
 Require all granted<span id="co.apache2.cgi.order"></span><span class="callout">4</span>
&lt;/Directory&gt;</pre></div><div class="calloutlist "><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#co.apache2.cgi.script_alias"><span class="callout">1</span></a> </p></td><td valign="top" align="left"><p>
       Tells Apache to handle all files within this directory as CGI scripts.
      </p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#co.apache2.cgi.options"><span class="callout">2</span></a> </p></td><td valign="top" align="left"><p>
       Enables CGI script execution
      </p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#co.apache2.cgi.handler"><span class="callout">3</span></a> </p></td><td valign="top" align="left"><p>
       Tells the server to treat files with the extensions .pl and .cgi as CGI
       scripts. Adjust according to your needs.
      </p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#co.apache2.cgi.order"><span class="callout">4</span></a> </p></td><td valign="top" align="left"><p>
       The <code class="systemitem">Require</code> directive controls the default
       access state. In this case, access is granted to the specified directory
       without limitation. For more information on authentication and
       authorization, see
       <a class="link" href="http://httpd.apache.org/docs/2.4/howto/auth.html" target="_blank">http://httpd.apache.org/docs/2.4/howto/auth.html</a>.
      </p></td></tr></table></div></div></div></div><div class="sect2 " id="sec.apache2.cgi.example_script"><div class="titlepage"><div><div><h3 class="title" id="sec.apache2.cgi.example_script"><span class="number">24.5.2 </span><span class="name">Running an Example Script</span> <a title="Permalink" class="permalink" href="#sec.apache2.cgi.example_script">#</a></h3></div></div></div><p>
    CGI programming differs from "regular" programming in that the CGI programs
    and scripts must be preceded by a MIME-Type header such as
    <code class="literal">Content-type: text/html</code>. This header is sent to the
    client, so it understands what kind of content it receives. Secondly, the
    script's output must be something the client, usually a Web browser,
    understands—HTML usually, or plain text or images, for example.
   </p><p>
    A simple test script available under
    <code class="filename">/usr/share/doc/packages/apache2/test-cgi</code> is part of
    the Apache package. It outputs the content of some environment variables as
    plain text. Copy this script to either
    <code class="filename">/srv/www/cgi-bin/</code> or the script directory of your
    virtual host (<code class="filename">/srv/www/www.example.com/cgi-bin/</code>) and name it
    <code class="filename">test.cgi</code>. Edit the file to have
    <code class="literal">#!/bin/sh</code> as the first line.
   </p><p>
    Files accessible by the Web server should be owned by the user
    <code class="systemitem">root</code>. For additional information
    see <a class="xref" href="#sec.apache2.security" title="24.8. Avoiding Security Problems">Section 24.8, “Avoiding Security Problems”</a>. Because the Web server runs
    with a different user, the CGI scripts must be world-executable and
    world-readable. Change into the CGI directory and use the command
    <code class="command">chmod 755 test.cgi</code> to apply the proper permissions.
   </p><p>
    Now call <code class="literal">http://localhost/cgi-bin/test.cgi</code> or
    <code class="literal">http://www.example.com/cgi-bin/test.cgi</code>. You should see the
    <span class="quote">“<span class="quote">CGI/1.0 test script report</span>”</span>.
   </p></div><div class="sect2 " id="sec.apache2.cgi.troubleshooting"><div class="titlepage"><div><div><h3 class="title" id="sec.apache2.cgi.troubleshooting"><span class="number">24.5.3 </span><span class="name">CGI Troubleshooting</span> <a title="Permalink" class="permalink" href="#sec.apache2.cgi.troubleshooting">#</a></h3></div></div></div><p>
    If you do not see the output of the test program but an error message
    instead, check the following:
   </p><div class="itemizedlist "><div class="itemizedlist-title-wrap"><h6 class="itemizedlist-title"><span class="name">CGI Troubleshooting </span><a title="Permalink" class="permalink" href="#idm140019135418768">#</a></h6></div><ul class="itemizedlist"><li class="listitem "><p>
      <span class="emphasis"><em>Have you reloaded the server after having changed the
      configuration?</em></span>
      If not, reload with <code class="command">systemctl reload apache2</code>
     </p></li><li class="listitem "><p>
      <span class="emphasis"><em>If you have configured your custom CGI directory, is it
      configured properly?</em></span>
      If in doubt, try the script within the default CGI directory
      <code class="filename">/srv/www/cgi-bin/</code> and call it with
      <code class="literal">http://localhost/cgi-bin/test.cgi</code>.
     </p></li><li class="listitem "><p>
      <span class="emphasis"><em>Are the file permissions correct?</em></span>
      Change into the CGI directory and
      execute <code class="command">ls -l test.cgi</code>. The output should start with
     </p><div class="verbatim-wrap"><pre class="screen">-rwxr-xr-x  1 root root</pre></div></li><li class="listitem "><p>
      Make sure that the script does not contain programming errors. If you
      have not changed <code class="filename">test.cgi</code>, this should not be the
      case, but if you are using your own programs, always make sure that they
      do not contain programming errors.
     </p></li></ul></div></div></div><div class="sect1 " id="sec.apache2.ssl"><div class="titlepage"><div><div><h2 class="title" id="sec.apache2.ssl"><span class="number">24.6 </span><span class="name">Setting Up a Secure Web Server with SSL</span> <a title="Permalink" class="permalink" href="#sec.apache2.ssl">#</a></h2></div></div></div><p>
   Whenever sensitive data, such as credit card information, is transferred
   between Web server and client, it is desirable to have a secure, encrypted
   connection with authentication.  <code class="systemitem">mod_ssl</code> provides
   strong encryption using the secure sockets layer (SSL) and transport layer
   security (TLS) protocols for HTTP communication between a client and the Web
   server. Using SSL/TLS, a private connection between Web server and client is
   established. Data integrity is ensured and client and server can
   authenticate each other.
  </p><p>
   For this purpose, the server sends an SSL certificate that holds information
   proving the server's valid identity before any request to a URL is answered.
   In turn, this guarantees that the server is the uniquely correct end point
   for the communication. Additionally, the certificate generates an encrypted
   connection between client and server that can transport information without
   the risk of exposing sensitive, plain-text content.
  </p><p>
   <code class="systemitem">mod_ssl</code> does not implement the SSL/TLS protocols
   itself, but acts as an interface between Apache and an SSL library. In
   <span class="productname"><span class="phrase">openSUSE Leap</span></span>, the OpenSSL library is used. OpenSSL is automatically
   installed with Apache.
  </p><p>
   The most visible effect of using <code class="systemitem">mod_ssl</code> with
   Apache is that URLs are prefixed with <code class="literal">https://</code> instead of
   <code class="literal">http://</code>.
  </p><div class="sect2 " id="sec.apache2.ssl.certificate"><div class="titlepage"><div><div><h3 class="title" id="sec.apache2.ssl.certificate"><span class="number">24.6.1 </span><span class="name">Creating an SSL Certificate</span> <a title="Permalink" class="permalink" href="#sec.apache2.ssl.certificate">#</a></h3></div></div></div><p>
    To use SSL/TLS with the Web server, you need to create an SSL
    certificate. This certificate is needed for the authorization between Web
    server and client, so that each party can clearly identify the other
    party. To ensure the integrity of the certificate, it must be signed by a
    party every user trusts.
   </p><p>
    There are three types of certificates you can create: a
    <span class="quote">“<span class="quote">dummy</span>”</span> certificate for testing purposes only, a self-signed
    certificate for a defined circle of users that trust you, and a certificate
    signed by an independent, publicly-known certificate authority (CA).
   </p><p>
    Creating a certificate is a two step process. First, a private key for the
    certificate authority is generated then the server certificate is signed
    with this key.
   </p><div id="idm140019135397696" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.png" /><h6>Tip: For More Information</h6><p>
     To learn more about concepts and definitions of SSL/TLS, refer to
     <a class="link" href="http://httpd.apache.org/docs/2.4/ssl/ssl_intro.html" target="_blank">http://httpd.apache.org/docs/2.4/ssl/ssl_intro.html</a>.
    </p></div><div class="sect3 " id="sec.apache2.ssl.certificate.dummy"><div class="titlepage"><div><div><h4 class="title" id="sec.apache2.ssl.certificate.dummy"><span class="number">24.6.1.1 </span><span class="name">Creating a <span class="quote">“<span class="quote">Dummy</span>”</span> Certificate</span> <a title="Permalink" class="permalink" href="#sec.apache2.ssl.certificate.dummy">#</a></h4></div></div></div><p>
     To generate a dummy certificate, call the script
     <code class="command">/usr/bin/gensslcert</code>. It creates or overwrites the files
     listed below. Use <code class="command">gensslcert</code>'s optional switches to
     fine-tune the certificate. Call <code class="command">/usr/bin/gensslcert </code>
     <code class="option">-h</code> for more information.
    </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
       <code class="filename">/etc/apache2/ssl.crt/ca.crt</code>
      </p></li><li class="listitem "><p>
       <code class="filename">/etc/apache2/ssl.crt/server.crt</code>
      </p></li><li class="listitem "><p>
       <code class="filename">/etc/apache2/ssl.key/server.key</code>
      </p></li><li class="listitem "><p>
       <code class="filename">/etc/apache2/ssl.csr/server.csr</code>
      </p></li></ul></div><p>
     A copy of <code class="filename">ca.crt</code> is also placed at
     <code class="filename">/srv/www/htdocs/CA.crt</code> for download.
    </p><div id="idm140019135383664" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.png" /><h6>Important: For Testing Purposes Only</h6><p>
      A dummy certificate should never be used on a production system. Only use
      it for testing purposes.
     </p></div></div><div class="sect3 " id="sec.apache2.ssl.certificate.custom"><div class="titlepage"><div><div><h4 class="title" id="sec.apache2.ssl.certificate.custom"><span class="number">24.6.1.2 </span><span class="name">Creating a Self-Signed Certificate</span> <a title="Permalink" class="permalink" href="#sec.apache2.ssl.certificate.custom">#</a></h4></div></div></div><p>
     If you are setting up a secure Web server for an intranet or for a defined
     circle of users, it is probably sufficient if you sign a certificate with
     your own certificate authority (CA). Note that visitors to such a site
     will see a warning like <span class="quote">“<span class="quote">this is an untrusted site</span>”</span>, as Web
     browsers do not recognize self-signed certificates.
    </p><div id="idm140019135379616" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.png" /><h6>Important: Self-Signed Certificates</h6><p>
      Only use a self-signed certificate on a Web server that is accessed by
      people who know and trust you as a certificate authority. It is not
      recommended to use such a certificate for a public shop, for example.
     </p></div><p>
     First you need to generate a certificate signing request (CSR). You are
     going to use <code class="command">openssl</code>, with <code class="literal">PEM</code> as
     the certificate format. During this step, you will be asked for a
     passphrase, and to answer several questions. Remember the passphrase you
     enter as you will need it in the future.
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> openssl req -new &gt; new.cert.csr
Generating a 1024 bit RSA private key
..++++++
.........++++++
writing new private key to 'privkey.pem'
Enter PEM pass phrase:<span id="co.ssl.self.pass1"></span><span class="callout">1</span>
Verifying - Enter PEM pass phrase:<span id="co.ssl.self.pass2"></span><span class="callout">2</span>
-----
You are about to be asked to enter information that will be incorporated
into your certificate request.
What you are about to enter is what is called a Distinguished Name or a DN.
There are quite a few fields but you can leave some blank
For some fields there will be a default value,
If you enter '.', the field will be left blank.
-----
Country Name (2 letter code) [AU]:<span id="co.ssl.self.country"></span><span class="callout">3</span>
State or Province Name (full name) [Some-State]:<span id="co.ssl.self.state"></span><span class="callout">4</span>
Locality Name (eg, city) []:<span id="co.ssl.self.city"></span><span class="callout">5</span>
Organization Name (eg, company) [Internet Widgits Pty Ltd]:<span id="co.ssl.self.org"></span><span class="callout">6</span>
Organizational Unit Name (eg, section) []:<span id="co.ssl.self.uname"></span><span class="callout">7</span>
Common Name (for example server FQDN, or YOUR name) []:<span id="co.ssl.self.cname"></span><span class="callout">8</span>
Email Address []:<span id="co.ssl.self.email"></span><span class="callout">9</span>

Please enter the following 'extra' attributes
to be sent with your certificate request
A challenge password []:<span id="co.ssl.self.challenge"></span><span class="callout">10</span>
An optional company name []:<span id="co.ssl.self.optional"></span><span class="callout">11</span></pre></div><div class="calloutlist "><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#co.ssl.self.pass1"><span class="callout">1</span></a> </p></td><td valign="top" align="left"><p>
       Fill in your passphrase,
      </p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#co.ssl.self.pass2"><span class="callout">2</span></a> </p></td><td valign="top" align="left"><p>
       ...fill it in once more (and remember it).
      </p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#co.ssl.self.country"><span class="callout">3</span></a> </p></td><td valign="top" align="left"><p>
       Fill in your 2 letter country code, such as <code class="literal">GB</code> or
       <code class="literal">CZ</code>.
      </p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#co.ssl.self.state"><span class="callout">4</span></a> </p></td><td valign="top" align="left"><p>
       Fill in the name of the state where you live.
      </p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#co.ssl.self.city"><span class="callout">5</span></a> </p></td><td valign="top" align="left"><p>
       Fill in the city name, such as <code class="literal">Prague</code>.
      </p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#co.ssl.self.org"><span class="callout">6</span></a> </p></td><td valign="top" align="left"><p>
       Fill in the name of the organization you work for.
      </p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#co.ssl.self.uname"><span class="callout">7</span></a> </p></td><td valign="top" align="left"><p>
       Fill in your organization unit, or leave blank if you have none.
      </p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#co.ssl.self.cname"><span class="callout">8</span></a> </p></td><td valign="top" align="left"><p>
       Fill in either the domain name of the server, or your first and last
       name.
      </p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#co.ssl.self.email"><span class="callout">9</span></a> </p></td><td valign="top" align="left"><p>
       Fill in your work e-mail address.
      </p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#co.ssl.self.challenge"><span class="callout">10</span></a> </p></td><td valign="top" align="left"><p>
       Leave the challenge password empty, otherwise you will need to enter it
       every time you restart the Apache Web server.
      </p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#co.ssl.self.optional"><span class="callout">11</span></a> </p></td><td valign="top" align="left"><p>
       Fill in the optional company name, or leave blank.
      </p></td></tr></table></div><p>
     Now you can generate the certificate. You are going to use
     <code class="command">openssl</code> again, and the format of the certificate is the
     default <code class="literal">PEM</code>.
    </p><div class="procedure " id="idm140019135350176"><div class="procedure-title-wrap"><h6 class="procedure-title"><span class="number">Procedure 24.3: </span><span class="name">Generating the Certificate </span><a title="Permalink" class="permalink" href="#idm140019135350176">#</a></h6></div><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
       Export the private part of the key to <code class="filename">new.cert.key</code>.
       You will be prompted for the passphrase you entered when creating the
       certificate signing request (CSR).
      </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> openssl rsa -in privkey.pem -out new.cert.key</pre></div></li><li class="step "><p>
       Generate the public part of the certificate according to the information
       you filled out in the signing request. The <code class="option">-days</code> option
       specifies the length of time before the certificate expires. You can
       revoke a certificate, or replace one before it expires.
      </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> openssl x509 -in new.cert.csr -out new.cert.cert -req \
-signkey new.cert.key -days 365</pre></div></li><li class="step "><p>
       Copy the certificate files to the relevant directories, so that the
       Apache server can read them. Make sure that the private key
       <code class="filename">/etc/apache2/ssl.key/server.key</code> is not
       world-readable, while the public PEM certificate
       <code class="filename">/etc/apache2/ssl.crt/server.crt</code> is.
      </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> cp new.cert.cert /etc/apache2/ssl.crt/server.crt
<code class="prompt user">tux &gt; </code><code class="command">sudo</code> cp new.cert.key /etc/apache2/ssl.key/server.key</pre></div></li></ol></div></div><div id="idm140019135340192" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.png" /><h6>Tip: Public Certificate Location</h6><p>
      The last step is to copy the public certificate file from
      <code class="filename">/etc/apache2/ssl.crt/server.crt</code> to a location where
      your users can access it to incorporate it into the list of known and
      trusted CAs in their Web browsers. Otherwise a browser complains that the
      certificate was issued by an unknown authority.
     </p></div></div><div class="sect3 " id="sec.apache2.ssl.certificate.official"><div class="titlepage"><div><div><h4 class="title" id="sec.apache2.ssl.certificate.official"><span class="number">24.6.1.3 </span><span class="name">Getting an Officially Signed Certificate</span> <a title="Permalink" class="permalink" href="#sec.apache2.ssl.certificate.official">#</a></h4></div></div></div><p>
     There are several official certificate authorities that sign your
     certificates. The certificate is signed by a trustworthy third party, so
     can be fully trusted. Publicly operating secure Web servers usually have
     an officially signed certificate.  A list of the most used Certificate
     Authorities (CAs) is available at <a class="link" href="https://en.wikipedia.org/wiki/Certificate_authority#Providers" target="_blank">https://en.wikipedia.org/wiki/Certificate_authority#Providers</a>.
    </p><p>
     When requesting an officially signed certificate, you do not send a
     certificate to the CA. Instead, issue a Certificate Signing Request

     (CSR). To create a CSR, run the following command:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>openssl req -new -newkey rsa:2048 -nodes -keyout newkey.pem -out newreq.pem</pre></div><p>

     You are asked to enter a distinguished name. This requires you to answer a
     few questions, such as country name or organization name. Enter valid
     data—everything you enter here later shows up in the certificate and
     is checked. You do not need to answer every question. If one does not
     apply to you or you want to leave it blank, use <span class="quote">“<span class="quote">.</span>”</span>. Common
     name is the name of the CA itself—choose a significant name, such as
     <em class="replaceable ">My company</em> CA. Last, a challenge password and
     an alternative company name must be entered.
    </p><p>
     Find the CSR in the directory from which you called the script. The file
     is named <code class="filename">newreq.pem</code>.
    </p></div></div><div class="sect2 " id="sec.apache2.ssl.configuration"><div class="titlepage"><div><div><h3 class="title" id="sec.apache2.ssl.configuration"><span class="number">24.6.2 </span><span class="name">Configuring Apache with SSL</span> <a title="Permalink" class="permalink" href="#sec.apache2.ssl.configuration">#</a></h3></div></div></div><p>
    The default port for SSL and TLS requests on the Web server side is 443.
    There is no conflict between a <span class="quote">“<span class="quote">regular</span>”</span> Apache listening on
    port 80 and an SSL/TLS-enabled Apache listening on port 443. In fact, HTTP
    and HTTPS can be run with the same Apache instance. Usually separate
    virtual hosts are used to dispatch requests to port 80 and port 443 to
    separate virtual servers.
   </p><div id="idm140019135328256" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.png" /><h6>Important: Firewall Configuration</h6><p>
     Do not forget to open the firewall for SSL-enabled Apache on port 443.
     This can be done with <code class="systemitem">firewalld</code> as described in
     <span class="intraxref">Book “<em class="citetitle ">Security Guide</em>”, Chapter 15 “Masquerading and Firewalls”, Section 15.4.1 “Configuring the Firewall on the Command Line”</span>.
    </p></div><p>
    The SSL module is enabled by default in the global server configuration.
    In case it has been disabled on your host, activate it with the following
    command: <code class="command">a2enmod ssl</code>. To finally enable SSL, the server
    needs to be started with the flag <span class="quote">“<span class="quote">SSL</span>”</span>. To do so, call
    <code class="command">a2enflag SSL</code> (case-sensitive!).  If you have chosen to
    encrypt your server certificate with a password, you should also increase
    the value for <code class="systemitem">APACHE_TIMEOUT</code> in
    <code class="filename">/etc/sysconfig/apache2</code>, so you have enough time to
    enter the passphrase when Apache starts. Restart the server to make these
    changes active. A reload is not sufficient.
   </p><p>
    The virtual host configuration directory contains a template
    <code class="filename">/etc/apache2/vhosts.d/vhost-ssl.template</code> with
    SSL-specific directives that are extensively documented. Refer to
    <a class="xref" href="#sec.apache2.configuration.manually.vhost" title="24.2.2.1. Virtual Host Configuration">Section 24.2.2.1, “Virtual Host Configuration”</a> for the general
    virtual host configuration.
   </p><p>
    To get started, copy the template to
    <code class="filename">/etc/apache2/vhosts.d/<em class="replaceable ">MYSSL-HOST</em>.conf</code>
    and edit it. Adjusting the values for the following directives should be
    sufficient:
   </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
      <code class="systemitem">DocumentRoot</code>
     </p></li><li class="listitem "><p>
      <code class="systemitem">ServerName</code>
     </p></li><li class="listitem "><p>
      <code class="systemitem">ServerAdmin</code>
     </p></li><li class="listitem "><p>
      <code class="systemitem">ErrorLog</code>
     </p></li><li class="listitem "><p>
      <code class="systemitem">TransferLog</code>
     </p></li></ul></div><div class="sect3 " id="sec.apache2.ssl.configuration.name-based"><div class="titlepage"><div><div><h4 class="title" id="sec.apache2.ssl.configuration.name-based"><span class="number">24.6.2.1 </span><span class="name">Name-Based Virtual Hosts and SSL</span> <a title="Permalink" class="permalink" href="#sec.apache2.ssl.configuration.name-based">#</a></h4></div></div></div><p>
     By default it is not possible to run multiple SSL-enabled virtual hosts on
     a server with only one IP address. Name-based virtual hosting requires
     that Apache knows which server name has been requested. The problem with
     SSL connections is, that such a request can only be read after the SSL
     connection has already been established (by using the default virtual
     host). As a result, users will receive a warning message stating that the
     certificate does not match the server name.
    </p><p>
     <span class="productname"><span class="phrase">openSUSE Leap</span></span> comes with an extension to the SSL protocol called Server
     Name Indication (SNI) addresses this issue by sending the name of the
     virtual domain as part of the SSL negotiation. This enables the server to
     <span class="quote">“<span class="quote">switch</span>”</span> to the correct virtual domain early and present the
     browser the correct certificate.
    </p><p>
     SNI is enabled by default on <span class="productname"><span class="phrase">openSUSE Leap</span></span>. To enable Name-Based Virtual
     Hosts for SSL, configure the server as described in
     <a class="xref" href="#sec.apache2.configuration.manually.vhost.named_vhosts" title="24.2.2.1.1. Name-Based Virtual Hosts">Section 24.2.2.1.1, “Name-Based Virtual Hosts”</a>
     (note that you need to use port <code class="literal">443</code> rather than port
     <code class="literal">80</code> with SSL).
    </p><div id="idm140019135303840" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.png" /><h6>Important: SNI Browser Support</h6><p>
      SNI must also be supported on the client side. However, SNI is
      supported by most browsers, except for certain older browsers. For more
      information, see
      <a class="link" href="https://en.wikipedia.org/wiki/Server_Name_Indication#Support" target="_blank">https://en.wikipedia.org/wiki/Server_Name_Indication#Support</a>.
     </p><p>
      To configure handling of non-SNI capable browsers, use the directive
      <code class="systemitem">SSLStrictSNIVHostCheck</code>. When set to
      <code class="literal">on</code> in the server configuration, non-SNI capable
      browser will be rejected for all virtual hosts. When set to
      <code class="literal">on</code> within a <code class="systemitem">VirtualHost</code>
      directive, access to this particular host will be rejected.
     </p><p>
      When set to <code class="literal">off</code> in the server configuration, the
      server will behave as if not having SNI support. SSL requests will be
      handled by the <span class="emphasis"><em>first</em></span> virtual host defined (for port
      443).
     </p></div></div></div></div><div class="sect1 " id="sec.apache2.multiple_instances"><div class="titlepage"><div><div><h2 class="title" id="sec.apache2.multiple_instances"><span class="number">24.7 </span><span class="name">Running Multiple Apache Instances on the Same Server</span> <a title="Permalink" class="permalink" href="#sec.apache2.multiple_instances">#</a></h2></div></div></div><p>
   As of <span class="productname"><span class="phrase">openSUSE® Leap</span></span> <span class="phrase">42.1</span>, you can run multiple Apache instances on the same
   server. This has several advantages over running multiple virtual hosts (see
   <a class="xref" href="#sec.apache2.configuration.manually.vhost" title="24.2.2.1. Virtual Host Configuration">Section 24.2.2.1, “Virtual Host Configuration”</a>):
  </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
     When a virtual host needs to be disabled for some time, you need to change
     the Web server configuration and restart it so that the change takes
     effect.
    </p></li><li class="listitem "><p>
     In case of problems with one virtual host, you need to restart all of
     them.
    </p></li></ul></div><p>
   You can run the default Apache instance as usual:
  </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> systemctl start apache2</pre></div><p>
   It reads the default <code class="filename">/etc/sysconfig/apache2</code> file. If
   the file is not present, or it is present but it does not set the
   <code class="systemitem">APACHE_HTTPD_CONF</code> variable, it reads
   <code class="filename">/etc/apache2/httpd.conf</code>.
  </p><p>
   To activate another Apache instance, run:
  </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> systemctl start apache2@<em class="replaceable ">INSTANCE_NAME</em></pre></div><p>
   For example:
  </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> systemctl start apache2@example_web.org</pre></div><p>
   By default, the instance uses
   <code class="filename">/etc/apache2@example_web.org/httpd.conf</code> as a main
   configuration file, which can be overwritten by setting
   <code class="systemitem">APACHE_HTTPD_CONF</code> in
   <code class="filename">/etc/sysconfig/apache2@example_web.org</code>.
  </p><p>
   An example to set up an additional instance of Apache follows. Note that you
   need to execute all the commands as <code class="systemitem">root</code>.
  </p><div class="procedure " id="idm140019135280688"><div class="procedure-title-wrap"><h6 class="procedure-title"><span class="number">Procedure 24.4: </span><span class="name">Configuring an Additional Apache Instance </span><a title="Permalink" class="permalink" href="#idm140019135280688">#</a></h6></div><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
     Create a new configuration file based on
     <code class="filename">/etc/sysconfig/apache2</code>, for example
     <code class="filename">/etc/sysconfig/apache2@example_web.org</code>:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> cp /etc/sysconfig/apache2 /etc/sysconfig/apache2@example_web.org</pre></div></li><li class="step "><p>
     Edit the file <code class="filename">/etc/sysconfig/apache2@example_web.org</code>
     and change the line containing
    </p><div class="verbatim-wrap"><pre class="screen">APACHE_HTTPD_CONF</pre></div><p>
     to
    </p><div class="verbatim-wrap"><pre class="screen">APACHE_HTTPD_CONF="/etc/apache2/httpd@example_web.org.conf"</pre></div></li><li class="step "><p>
     Create the file
     <code class="filename">/etc/apache2/httpd@example_web.org.conf</code> based on
     <code class="filename">/etc/apache2/httpd.conf</code>.
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> cp /etc/apache2/httpd.conf /etc/apache2/httpd@example_web.org.conf</pre></div></li><li class="step "><p>
     Edit <code class="filename">/etc/apache2/httpd@example_web.org.conf</code> and
     change
    </p><div class="verbatim-wrap"><pre class="screen">Include /etc/apache2/listen.conf</pre></div><p>
     to
    </p><div class="verbatim-wrap"><pre class="screen">Include /etc/apache2/listen@example_web.org.conf</pre></div><p>
     Review all the directives and change them to fit your needs. You will
     probably want to change
    </p><div class="verbatim-wrap"><pre class="screen">Include /etc/apache2/global.conf</pre></div><p>
     and create new <code class="filename">global@example_web.org.conf</code> for each
     instance. We suggest to change
    </p><div class="verbatim-wrap"><pre class="screen">ErrorLog /var/log/apache2/error_log</pre></div><p>
     to
    </p><div class="verbatim-wrap"><pre class="screen">ErrorLog /var/log/apache2/error@example_web.org_log</pre></div><p>
     to have separate logs for each instance.
    </p></li><li class="step "><p>
     Create <code class="filename">/etc/apache2/listen@example_web.org.conf</code> based
     on <code class="filename">/etc/apache2/listen.conf</code>.
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> cp /etc/apache2/listen.conf /etc/apache2/listen@example_web.org.conf</pre></div></li><li class="step "><p>
     Edit <code class="filename">/etc/apache2/listen@example_web.org.conf</code> and
     change
    </p><div class="verbatim-wrap"><pre class="screen">Listen 80</pre></div><p>
     to the port number you want the new instance to run on, for example 82:
    </p><div class="verbatim-wrap"><pre class="screen">Listen 82</pre></div><p>
     To run the new Apache instance over a secured protocol (see
     <a class="xref" href="#sec.apache2.ssl" title="24.6. Setting Up a Secure Web Server with SSL">Section 24.6, “Setting Up a Secure Web Server with SSL”</a>), change also the line
    </p><div class="verbatim-wrap"><pre class="screen">Listen 443</pre></div><p>
     for example to
    </p><div class="verbatim-wrap"><pre class="screen">Listen 445</pre></div></li><li class="step "><p>
     Start the new Apache instance:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> systemctl start apache2@example_web.org</pre></div></li><li class="step "><p>
     Check if the server is running by pointing your Web browser at
     <code class="literal">http://server_name:82</code>. If you previously changed the
     name of the error log file for the new instance, you can check it:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> tail -f /var/log/apache2/error@example_web.org_log</pre></div></li></ol></div></div><p>
   Here are several points to consider when setting up more Apache instances on
   the same server:
  </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
     The file
     <code class="filename">/etc/sysconfig/apache2@<em class="replaceable ">INSTANCE_NAME</em></code>
     can include the same variables as
     <code class="filename">/etc/sysconfig/apache2</code>, including module loading and
     MPM setting.
    </p></li><li class="listitem "><p>
     The default Apache instance does not need to be running while other
     instances run.
    </p></li><li class="listitem "><p>
     The Apache helper utilities <code class="command">a2enmod</code>,
     <code class="command">a2dismod</code> and <code class="command">apachectl</code> operate on
     the default Apache instance if not specified otherwise with the
     <code class="systemitem">HTTPD_INSTANCE</code> environment variable. The
     following example
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> export HTTPD_INSTANCE=example_web.org
<code class="prompt user">tux &gt; </code><code class="command">sudo</code> a2enmod access_compat
<code class="prompt user">tux &gt; </code><code class="command">sudo</code> a2enmod status
<code class="prompt user">tux &gt; </code><code class="command">sudo</code> apachectl start</pre></div><p>
     will add <code class="systemitem">access_compat</code> and
     <code class="systemitem">status</code> modules to the
     <code class="systemitem">APACHE_MODULES</code> variable of
     <code class="filename">/etc/sysconfig/apache2@example_web.org</code>, and then
     start the <code class="literal">example_web.org</code> instance.
    </p></li></ul></div></div><div class="sect1 " id="sec.apache2.security"><div class="titlepage"><div><div><h2 class="title" id="sec.apache2.security"><span class="number">24.8 </span><span class="name">Avoiding Security Problems</span> <a title="Permalink" class="permalink" href="#sec.apache2.security">#</a></h2></div></div></div><p>
   A Web server exposed to the public Internet requires an ongoing
   administrative effort. It is inevitable that security issues appear, both
   related to the software and to accidental misconfiguration. Here are some
   tips for how to deal with them.
  </p><div class="sect2 " id="sec.apache2.security.up-to-date"><div class="titlepage"><div><div><h3 class="title" id="sec.apache2.security.up-to-date"><span class="number">24.8.1 </span><span class="name">Up-to-Date Software</span> <a title="Permalink" class="permalink" href="#sec.apache2.security.up-to-date">#</a></h3></div></div></div><p>
    If there are vulnerabilities found in the Apache software, a security
    advisory will be issued by SUSE. It contains instructions for fixing the
    vulnerabilities, which in turn should be applied when possible. The SUSE
    security announcements are available from the following locations:
   </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p><span class="formalpara-title">Web Page. </span>
       <a class="link" href="http://www.suse.com/support/security/" target="_blank">http://www.suse.com/support/security/</a>
      </p></li><li class="listitem "><p><span class="formalpara-title">Mailing List Archive. </span>
       <a class="link" href="http://lists.opensuse.org/opensuse-security-announce/" target="_blank">http://lists.opensuse.org/opensuse-security-announce/</a>
      </p></li><li class="listitem "><p><span class="formalpara-title">List of Security Announcements. </span>
       <a class="link" href="http://www.suse.com/support/update/" target="_blank">http://www.suse.com/support/update/</a>
      </p></li></ul></div></div><div class="sect2 " id="sec.apache2.security.permissions"><div class="titlepage"><div><div><h3 class="title" id="sec.apache2.security.permissions"><span class="number">24.8.2 </span><span class="name">DocumentRoot Permissions</span> <a title="Permalink" class="permalink" href="#sec.apache2.security.permissions">#</a></h3></div></div></div><p>
    By default in <span class="productname"><span class="phrase">openSUSE Leap</span></span>, the <code class="systemitem">DocumentRoot</code>
    directory <code class="filename">/srv/www/htdocs</code> and the CGI directory
    <code class="filename">/srv/www/cgi-bin</code> belong to the user and group
    <code class="systemitem">root</code>. You should not change these permissions. If
    the directories are writable for all, any user can place files into them.
    These files might then be executed by Apache with the permissions of
    <code class="systemitem">wwwrun</code>, which may give the user unintended access
    to file system resources. Use subdirectories of
    <code class="filename">/srv/www</code> to place the
    <code class="systemitem">DocumentRoot</code> and CGI directories for your virtual
    hosts and make sure that directories and files belong to user and group
    <code class="systemitem">root</code>.
   </p></div><div class="sect2 " id="sec.apache2.security.filesystem"><div class="titlepage"><div><div><h3 class="title" id="sec.apache2.security.filesystem"><span class="number">24.8.3 </span><span class="name">File System Access</span> <a title="Permalink" class="permalink" href="#sec.apache2.security.filesystem">#</a></h3></div></div></div><p>
    By default, access to the whole file system is denied in
    <code class="filename">/etc/apache2/httpd.conf</code>. You should never overwrite
    these directives, but specifically enable access to all directories Apache
    should be able to read. For details, see
    <a class="xref" href="#sec.apache2.configuration.manually.vhost.basic_configuration" title="24.2.2.1.3. Basic Virtual Host Configuration">Section 24.2.2.1.3, “Basic Virtual Host Configuration”</a>.
    In doing so, ensure that no critical files, such as password or system
    configuration files, can be read from the outside.
   </p></div><div class="sect2 " id="sec.apache2.security.cgi"><div class="titlepage"><div><div><h3 class="title" id="sec.apache2.security.cgi"><span class="number">24.8.4 </span><span class="name">CGI Scripts</span> <a title="Permalink" class="permalink" href="#sec.apache2.security.cgi">#</a></h3></div></div></div><p>
    Interactive scripts in PHP, SSI, or any other programming language
    can essentially run arbitrary commands and therefore present a general
    security issue. Scripts that will be executed from the server should only
    be installed from sources the server administrator trusts—allowing
    users to run their own scripts is generally not a good idea. It is also
    recommended to do security audits for all scripts.
   </p><p>
    To make the administration of scripts as easy as possible, it is common
    practice to limit the execution of CGI scripts to specific directories
    instead of globally allowing them. The directives
    <code class="systemitem">ScriptAlias</code> and <code class="systemitem">Option
    ExecCGI</code> are used for configuration. The <span class="productname"><span class="phrase">openSUSE Leap</span></span> default
    configuration does not allow execution of CGI scripts from everywhere.
   </p><p>
    All CGI scripts run as the same user, so different scripts can potentially
    conflict with each other. The module suEXEC lets you run CGI scripts under
    a different user and group.
   </p></div><div class="sect2 " id="sec.apache2.security.users"><div class="titlepage"><div><div><h3 class="title" id="sec.apache2.security.users"><span class="number">24.8.5 </span><span class="name">User Directories</span> <a title="Permalink" class="permalink" href="#sec.apache2.security.users">#</a></h3></div></div></div><p>
    When enabling user directories (with <code class="systemitem">mod_userdir</code>
    or <code class="systemitem">mod_rewrite</code>) you should strongly consider not
    allowing <code class="filename">.htaccess</code> files, which would allow users to
    overwrite security settings. At least you should limit the user's
    engagement by using the directive <code class="systemitem">AllowOverRide</code>.
    In <span class="productname"><span class="phrase">openSUSE Leap</span></span>, <code class="filename">.htaccess</code> files are enabled by
    default, but the user is not allowed to overwrite any
    <code class="systemitem">Option</code> directives when using
    <code class="systemitem">mod_userdir</code> (see the
    <code class="filename">/etc/apache2/mod_userdir.conf</code> configuration file).
   </p></div></div><div class="sect1 " id="sec.apache2.troubleeshooting"><div class="titlepage"><div><div><h2 class="title" id="sec.apache2.troubleeshooting"><span class="number">24.9 </span><span class="name">Troubleshooting</span> <a title="Permalink" class="permalink" href="#sec.apache2.troubleeshooting">#</a></h2></div></div></div><p>
   If Apache does not start, the Web page is not accessible, or users cannot
   connect to the Web server, it is important to find the cause of the problem.
   Here are some typical places to look for error explanations and important
   things to check:
  </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019135201648"><span class="term ">Output of the <code class="systemitem">apache2.service</code>
     subcommand:</span></dt><dd><p>
      Instead of starting and stopping the Web server with the binary
      <code class="filename">/usr/sbin/apache2ctl</code>, rather use the
      <code class="command">systemctl</code> commands instead (described in <a class="xref" href="#sec.apache2.start_stop" title="24.3. Starting and Stopping Apache">Section 24.3, “Starting and Stopping Apache”</a>). <code class="command">systemctl status
      apache2</code> is verbose about errors, and it even provides tips and
      hints for fixing configuration errors.
     </p></dd><dt id="idm140019135197088"><span class="term ">Log Files and Verbosity</span></dt><dd><p>
      In case of both fatal and nonfatal errors, check the Apache log files for
      causes, mainly the error log file located at
      <code class="filename">/var/log/apache2/error_log</code> by default. Additionally,
      you can control the verbosity of the logged messages with the
      <code class="systemitem">LogLevel</code> directive if more detail is needed in
      the log files.
     </p><div id="idm140019135194448" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.png" /><h6>Tip: A Simple Test</h6><p>
       Watch the Apache log messages with the command <code class="command">tail -F
       /var/log/apache2/<em class="replaceable ">MY_ERROR_LOG</em></code>.
       Then run
       <code class="command">systemctl restart apache2</code>. Now, try to connect with a
       browser and check the output.
      </p></div></dd><dt id="idm140019135191456"><span class="term ">Firewall and Ports</span></dt><dd><p>
      A common mistake is to not open the ports for Apache in the firewall
      configuration of the server. If you configure Apache with YaST, there
      is a separate option available to take care of this specific issue (see
      <a class="xref" href="#sec.apache2.configuration.yast" title="24.2.3. Configuring Apache with YaST">Section 24.2.3, “Configuring Apache with YaST”</a>). If you are configuring
      Apache manually, open firewall ports for HTTP and HTTPS via YaST's
      firewall module.
     </p></dd></dl></div><p>
   If the error cannot be tracked down with any of these, check the online
   Apache bug database at
   <a class="link" href="http://httpd.apache.org/bug_report.html" target="_blank">http://httpd.apache.org/bug_report.html</a>. Additionally,
   the Apache user community can be reached via a mailing list available at
   <a class="link" href="http://httpd.apache.org/userslist.html" target="_blank">http://httpd.apache.org/userslist.html</a>.
  </p></div><div class="sect1 " id="sec.apache2.more_information"><div class="titlepage"><div><div><h2 class="title" id="sec.apache2.more_information"><span class="number">24.10 </span><span class="name">For More Information</span> <a title="Permalink" class="permalink" href="#sec.apache2.more_information">#</a></h2></div></div></div><p>
   The package <code class="systemitem">apache2-doc</code> contains the complete
   Apache manual in various localizations for local installation and reference.
   It is not installed by default—the quickest way to install it is to
   use the command <code class="command">zypper in apache2-doc</code>. having been
   installed, the Apache manual is available at
   <a class="link" href="http://localhost/manual/" target="_blank">http://localhost/manual/</a>. You may also access it on the
   Web at <a class="link" href="http://httpd.apache.org/docs-2.4/" target="_blank">http://httpd.apache.org/docs-2.4/</a>. SUSE-specific
   configuration hints are available in the directory
   <code class="filename">/usr/share/doc/packages/apache2/README.*</code>.
  </p><div class="sect2 " id="sec.apache2.more_information.apache22"><div class="titlepage"><div><div><h3 class="title" id="sec.apache2.more_information.apache22"><span class="number">24.10.1 </span><span class="name">Apache 2.4</span> <a title="Permalink" class="permalink" href="#sec.apache2.more_information.apache22">#</a></h3></div></div></div><p>
    For a list of new features in Apache 2.4, refer to
    <a class="link" href="http://httpd.apache.org/docs/2.4/new_features_2_4.html" target="_blank">http://httpd.apache.org/docs/2.4/new_features_2_4.html</a>.
    Information about upgrading from version 2.2 to 2.4 is available at
    <a class="link" href="http://httpd.apache.org/docs-2.4/upgrading.html" target="_blank">http://httpd.apache.org/docs-2.4/upgrading.html</a>.
   </p></div><div class="sect2 " id="sec.apache2.more_information.modules"><div class="titlepage"><div><div><h3 class="title" id="sec.apache2.more_information.modules"><span class="number">24.10.2 </span><span class="name">Apache Modules</span> <a title="Permalink" class="permalink" href="#sec.apache2.more_information.modules">#</a></h3></div></div></div><p>
    More information about external Apache modules that are briefly described
    in <a class="xref" href="#sec.apache2.modules.external" title="24.4.5. External Modules">Section 24.4.5, “External Modules”</a> is available at the
    following locations:
   </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019135176448"><span class="term "><code class="systemitem">mod_apparmor</code>
     </span></dt><dd><p>
       <a class="link" href="http://en.opensuse.org/SDB:AppArmor" target="_blank">http://en.opensuse.org/SDB:AppArmor</a>
      </p></dd><dt id="idm140019135173792"><span class="term "><code class="systemitem">mod_php5</code>
     </span></dt><dd><p>
       <a class="link" href="http://www.php.net/manual/en/install.unix.apache2.php" target="_blank">http://www.php.net/manual/en/install.unix.apache2.php</a>
      </p></dd><dt id="idm140019135171120"><span class="term "><code class="systemitem">mod_python</code>
     </span></dt><dd><p>
       <a class="link" href="http://www.modpython.org/" target="_blank">http://www.modpython.org/</a>
      </p></dd><dt id="idm140019135168464"><span class="term "><code class="systemitem">mod_security</code>
     </span></dt><dd><p>
       <a class="link" href="http://modsecurity.org/" target="_blank">http://modsecurity.org/</a>
      </p></dd></dl></div></div><div class="sect2 " id="sec.apache2.more_information.cgi"><div class="titlepage"><div><div><h3 class="title" id="sec.apache2.more_information.cgi"><span class="number">24.10.3 </span><span class="name">Development</span> <a title="Permalink" class="permalink" href="#sec.apache2.more_information.cgi">#</a></h3></div></div></div><p>
    More information about developing Apache modules or about getting involved
    in the Apache Web server project are available at the following locations:
   </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019135163408"><span class="term ">Apache Developer Information</span></dt><dd><p>
       <a class="link" href="http://httpd.apache.org/dev/" target="_blank">http://httpd.apache.org/dev/</a>
      </p></dd><dt id="idm140019135161024"><span class="term ">Apache Developer Documentation</span></dt><dd><p>
       <a class="link" href="http://httpd.apache.org/docs/2.4/developer/" target="_blank">http://httpd.apache.org/docs/2.4/developer/</a>
      </p></dd></dl></div></div></div></div><div class="chapter " id="cha.ftp"><div class="titlepage"><div><div><h2 class="title"><span class="number">25 </span><span class="name">Setting Up an FTP Server with YaST</span> <a title="Permalink" class="permalink" href="#cha.ftp">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">Filename: </span>yast2_ftp.xml</li><li><span class="ds-label">ID: </span>cha.ftp</li></ul></div></div><div><div class="abstract"><div class="abstract-title-wrap"><h6 class="abstract-title">Abstract<a title="Permalink" class="permalink" href="#idm140019135155312">#</a></h6></div><p>
    Using the YaST <span class="guimenu">FTP Server</span> module, you can configure
    your machine to function as an FTP (File Transfer Protocol) server.
    Anonymous and/or authenticated users can connect to your machine and
    download files using the FTP protocol. Depending on the configuration, they
    can also upload files to the FTP server. YaST uses vsftpd (Very Secure
    FTP Daemon).
   </p></div></div></div></div><div class="line"><div class="toc"><dl><dt><span class="sect1"><a href="#sec.ftp.start"><span class="number">25.1 </span><span class="name">Starting the FTP Server</span></a></span></dt><dt><span class="sect1"><a href="#sec.ftp.general"><span class="number">25.2 </span><span class="name">FTP General Settings</span></a></span></dt><dt><span class="sect1"><a href="#sec.ftp.performance"><span class="number">25.3 </span><span class="name">FTP Performance Settings</span></a></span></dt><dt><span class="sect1"><a href="#sec.ftp.auth"><span class="number">25.4 </span><span class="name">Authentication</span></a></span></dt><dt><span class="sect1"><a href="#sec.ftp.expert"><span class="number">25.5 </span><span class="name">Expert Settings</span></a></span></dt><dt><span class="sect1"><a href="#sec.ftp.info"><span class="number">25.6 </span><span class="name">For More Information</span></a></span></dt></dl></div></div><p>
  If the YaST FTP Server module is not available in your system, install the
  <code class="systemitem">yast2-ftp-server</code> package.
 </p><p>
  To configure the FTP server using YaST, follow these steps:
 </p><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
    Open the YaST control center and choose <span class="guimenu">Network
    Services</span> › <span class="guimenu">FTP Server</span> or run the
    <code class="command">yast2 ftp-server</code> command as <code class="systemitem">root</code>.
   </p></li><li class="step "><p>
    If there is not any FTP server installed in your system, you will be asked
    which server to install when the YaST FTP Server module starts. Choose
    the vsftpd server and confirm the dialog.
   </p></li><li class="step "><p>
    In the <span class="guimenu">Start-Up</span> dialog, configure the options for
    starting of the FTP server. For more information, see
    <a class="xref" href="#sec.ftp.start" title="25.1. Starting the FTP Server">Section 25.1, “Starting the FTP Server”</a>.
   </p><p>
    In the <span class="guimenu">General</span> dialog, configure FTP directories,
    welcome message, file creation masks and other parameters. For more
    information, see <a class="xref" href="#sec.ftp.general" title="25.2. FTP General Settings">Section 25.2, “FTP General Settings”</a>.
   </p><p>
    In the <span class="guimenu">Performance</span> dialog, set the parameters that
    affect the load on the FTP server. For more information, see
    <a class="xref" href="#sec.ftp.performance" title="25.3. FTP Performance Settings">Section 25.3, “FTP Performance Settings”</a>.
   </p><p>
    In the <span class="guimenu">Authentication</span> dialog, set whether the FTP server
    should be available for anonymous and/or authenticated users. For more
    information, see <a class="xref" href="#sec.ftp.auth" title="25.4. Authentication">Section 25.4, “Authentication”</a>.
   </p><p>
    In the <span class="guimenu">Expert Settings</span> dialog, configure the operation
    mode of the FTP server, SSL connections and firewall settings. For more
    information, see <a class="xref" href="#sec.ftp.expert" title="25.5. Expert Settings">Section 25.5, “Expert Settings”</a>.
   </p></li><li class="step "><p>
    Press <span class="guimenu">Finish</span> to save the configurations.
   </p></li></ol></div></div><div class="sect1 " id="sec.ftp.start"><div class="titlepage"><div><div><h2 class="title" id="sec.ftp.start"><span class="number">25.1 </span><span class="name">Starting the FTP Server</span> <a title="Permalink" class="permalink" href="#sec.ftp.start">#</a></h2></div></div></div><p>
   In the <span class="guimenu">Service Start</span> frame of the <span class="guimenu">FTP
   Start-Up</span> dialog set the way the FTP server is started up. You can
   choose between starting the server automatically during the system boot and
   starting it manually. If the FTP server should be started only after an FTP
   connection request, choose <span class="guimenu">Via socket</span>.
  </p><p>
   The current status of the FTP server is shown in the <span class="guimenu">Switch On and
   Off</span> frame of the <span class="guimenu">FTP Start-Up</span> dialog. Start the
   FTP server by clicking <span class="guimenu">Start FTP Now</span>. To stop the server,
   click <span class="guimenu">Stop FTP Now</span>. After having changed the settings of
   the server click <span class="guimenu">Save Settings and Restart FTP Now</span>. Your
   configurations will be saved by leaving the configuration module with
   <span class="guimenu">Finish</span>.
  </p><p>
   The <span class="guimenu">Selected Service</span> frame of the <span class="guimenu">FTP
   Start-Up</span> dialog shows which FTP server is used: either vsftpd or
   pure-ftpd. If both servers are installed, you can switch between
   them—the current configuration will automatically be converted.
  </p><div class="figure" id="fig.yast2.ftp-start-up"><div class="figure-contents"><div class="mediaobject"><a xmlns="" href="images/yast2_ftp-start-up.png"><img src="images/yast2_ftp-start-up.png" width="" alt="FTP Server Configuration — Start-Up" /></a></div></div><div class="figure-title-wrap"><h6 class="figure-title"><span class="number">Figure 25.1: </span><span class="name">FTP Server Configuration — Start-Up </span><a title="Permalink" class="permalink" href="#fig.yast2.ftp-start-up">#</a></h6></div></div></div><div class="sect1 " id="sec.ftp.general"><div class="titlepage"><div><div><h2 class="title" id="sec.ftp.general"><span class="number">25.2 </span><span class="name">FTP General Settings</span> <a title="Permalink" class="permalink" href="#sec.ftp.general">#</a></h2></div></div></div><p>
   In the <span class="guimenu">General Settings</span> frame of the <span class="guimenu">FTP General
   Settings</span> dialog you can set the <span class="guimenu">Welcome message</span>
   which is shown after connecting to the FTP server.
  </p><p>
   If you check the <span class="guimenu">Chroot Everyone</span> option, all local users
   will be placed in a chroot jail in their home directory after login. This
   option has security implications, especially if the users have upload
   permission or shell access, so be careful enabling this option.
  </p><p>
   If you check the <span class="guimenu">Verbose Logging</span> option, all FTP requests
   and responses are logged.
  </p><p>
   You can limit permissions of files created by anonymous and/or authenticated
   users with umask. Set the file creation mask for anonymous users in
   <span class="guimenu">Umask for Anonymous</span> and the file creation mask for
   authenticated users in <span class="guimenu">Umask for Authenticated Users</span>. The
   masks should be entered as octal numbers with a leading zero. For more
   information about umask, see the umask man page
   (<code class="command">man 1p umask</code>).
  </p><p>
   In the <span class="guimenu">FTP Directories</span> frame set the directories used for
   anonymous and authorized users. With <span class="guimenu">Browse</span>, you can
   select a directory to be used from the local file system. The default FTP
   directory for anonymous users is <code class="filename">/srv/ftp</code>. Note that
   vsftpd does not allow this directory to be writable for all users. The
   subdirectory <code class="filename">upload</code> with write permissions for
   anonymous users is created instead.
  </p><div id="idm140019135112448" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note: Write Permissions in FTP Directory</h6><p>
    The pure-ftpd server allows the FTP directory for anonymous users to be
    writable. When switching between servers, make sure you remove the write
    permissions in the directory that was used with pure-ftpd before switching
    back to the vsftpd server.
   </p></div></div><div class="sect1 " id="sec.ftp.performance"><div class="titlepage"><div><div><h2 class="title" id="sec.ftp.performance"><span class="number">25.3 </span><span class="name">FTP Performance Settings</span> <a title="Permalink" class="permalink" href="#sec.ftp.performance">#</a></h2></div></div></div><p>
   In the <span class="guimenu">Performance</span> dialog set the parameters which affect
   the load on the FTP server. <span class="guimenu">Max Idle Time</span> is the maximum
   time (in minutes) the remote client may spend between FTP commands. In case
   of longer inactivity, the remote client is disconnected. <span class="guimenu">Max
   Clients for One IP</span> determines the maximum number of clients which
   can be connected from a single IP address. <span class="guimenu">Max Clients</span>
   determines the maximum number of clients which may be connected. Any
   additional clients will get an error message.
  </p><p>
   The maximum data transfer rate (in KB/s) is set in <span class="guimenu">Local Max
   Rate</span> for local authenticated users, and in <span class="guimenu">Anonymous Max
   Rate</span> for anonymous clients respectively. The default value for the
   rate settings is <code class="literal">0</code>, which means unlimited data transfer
   rate.
  </p></div><div class="sect1 " id="sec.ftp.auth"><div class="titlepage"><div><div><h2 class="title" id="sec.ftp.auth"><span class="number">25.4 </span><span class="name">Authentication</span> <a title="Permalink" class="permalink" href="#sec.ftp.auth">#</a></h2></div></div></div><p>
   In the <span class="guimenu">Enable/Disable Anonymous and Local Users</span> frame of
   the <span class="guimenu">Authentication</span> dialog, you can set which users are
   allowed to access your FTP server. You can choose between the following
   options: granting access to anonymous users only, to authenticated users
   only (with accounts on the system) or to both types of users.
  </p><p>
   To allow users to upload files to the FTP server, check
   <span class="guimenu">Enable Upload</span> in the <span class="guimenu">Uploading</span> frame
   of the <span class="guimenu">Authentication</span> dialog. Here you can allow
   uploading or creating directories even for anonymous users by checking the
   respective box.
  </p><div id="idm140019135100016" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note: vsftp—Allowing File Upload for Anonymous Users</h6><p>
    If a vsftpd server is used and you want anonymous users to be able to
    upload files or create directories, a subdirectory with writing permissions
    for all users needs to be created in the anonymous FTP directory.
   </p></div></div><div class="sect1 " id="sec.ftp.expert"><div class="titlepage"><div><div><h2 class="title" id="sec.ftp.expert"><span class="number">25.5 </span><span class="name">Expert Settings</span> <a title="Permalink" class="permalink" href="#sec.ftp.expert">#</a></h2></div></div></div><p>
   An FTP server can run in active or in passive mode. By default the server
   runs in passive mode. To switch into active mode, uncheck <span class="guimenu">Enable
   Passive Mode</span> option in <span class="guimenu">Expert Settings</span> dialog.
   You can also change the range of ports on the server used for the data
   stream by tweaking the <span class="guimenu">Min Port for Pas. Mode</span> and
   <span class="guimenu">Max Port for Pas. Mode</span> options.
  </p><p>
   If you want encrypted communication between clients and the server, you can
   <span class="guimenu">Enable SSL</span>. Check the versions of the protocol to be
   supported and specify the DSA certificate to be used for SSL encrypted
   connections.

  </p><p>
   If your system is protected by a firewall, check <span class="guimenu">Open Port in
   Firewall</span> to enable a connection to the FTP server.
  </p></div><div class="sect1 " id="sec.ftp.info"><div class="titlepage"><div><div><h2 class="title" id="sec.ftp.info"><span class="number">25.6 </span><span class="name">For More Information</span> <a title="Permalink" class="permalink" href="#sec.ftp.info">#</a></h2></div></div></div><p>
   For more information about the FTP server read the manual pages of
   <code class="command">vsftpd</code> and <code class="command">vsftpd.conf</code>.
  </p></div></div><div class="chapter " id="cha.squid"><div class="titlepage"><div><div><h2 class="title"><span class="number">26 </span><span class="name">The Proxy Server Squid</span> <a title="Permalink" class="permalink" href="#cha.squid">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">Filename: </span>net_proxy.xml</li><li><span class="ds-label">ID: </span>cha.squid</li></ul></div></div><div><div class="abstract"><div class="abstract-title-wrap"><h6 class="abstract-title">Abstract<a title="Permalink" class="permalink" href="#idm140019135086864">#</a></h6></div><p>
    Squid is a widely-used proxy cache for Linux and Unix platforms. This means
    that it stores requested Internet objects, such as data on a Web or FTP
    server, on a machine that is closer to the requesting workstation than the
    server. It can be set up in multiple hierarchies to assure optimal response
    times and low bandwidth usage, even in modes that are transparent to end
    users.
   </p></div></div></div></div><div class="line"><div class="toc"><dl><dt><span class="sect1"><a href="#sec.squid.cacheinfos"><span class="number">26.1 </span><span class="name">Some Facts about Proxy Caches</span></a></span></dt><dt><span class="sect1"><a href="#sec.squid.sysneeds"><span class="number">26.2 </span><span class="name">System Requirements</span></a></span></dt><dt><span class="sect1"><a href="#sec.squid.start"><span class="number">26.3 </span><span class="name">Basic Usage of Squid</span></a></span></dt><dt><span class="sect1"><a href="#sec.squid.yast"><span class="number">26.4 </span><span class="name">The YaST Squid Module</span></a></span></dt><dt><span class="sect1"><a href="#sec.squid.configfile"><span class="number">26.5 </span><span class="name">The Squid Configuration File</span></a></span></dt><dt><span class="sect1"><a href="#sec.squid.proxyconfigtrans"><span class="number">26.6 </span><span class="name">Configuring a Transparent Proxy</span></a></span></dt><dt><span class="sect1"><a href="#sec.squid.cachemgr"><span class="number">26.7 </span><span class="name">Using the Squid Cache Manager CGI Interface (<code class="systemitem">cachemgr.cgi</code>)</span></a></span></dt><dt><span class="sect1"><a href="#sec.squid.calamaris"><span class="number">26.8 </span><span class="name">Cache Report Generation with Calamaris</span></a></span></dt><dt><span class="sect1"><a href="#sec.squid.moreinfo"><span class="number">26.9 </span><span class="name">For More Information</span></a></span></dt></dl></div></div><p>
  Squid acts as a proxy cache. It redirects object requests from clients (in
  this case, from Web browsers) to the server. When the requested objects
  arrive from the server, it delivers the objects to the client and keeps a
  copy of them in the hard disk cache. An advantage of caching is that several
  clients requesting the same object can be served from the hard disk cache.
  This enables clients to receive the data much faster than from the Internet.
  This procedure also reduces the network traffic.
 </p><p>
  Along with actual caching, Squid offers a wide range of features:
 </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
    Distributing load over intercommunicating hierarchies of proxy servers
   </p></li><li class="listitem "><p>
    Defining strict access control lists for all clients accessing the proxy
   </p></li><li class="listitem "><p>
    Allowing or denying access to specific Web pages using other applications
   </p></li><li class="listitem "><p>
    Generating statistics about frequently-visited Web pages for the assessment
    of surfing habits
   </p></li></ul></div><p>
  Squid is not a generic proxy. It normally proxies only HTTP connections. It
  supports the protocols FTP, Gopher, SSL, and WAIS, but it does not support
  other Internet protocols, such as the news protocol, or video conferencing
  protocols. Because Squid only supports the UDP protocol to provide
  communication between different caches, many multimedia programs are not
  supported.
 </p><div class="sect1 " id="sec.squid.cacheinfos"><div class="titlepage"><div><div><h2 class="title" id="sec.squid.cacheinfos"><span class="number">26.1 </span><span class="name">Some Facts about Proxy Caches</span> <a title="Permalink" class="permalink" href="#sec.squid.cacheinfos">#</a></h2></div></div></div><p>
   As a proxy cache, Squid can be used in several ways. When combined with a
   firewall, it can help with security. Multiple proxies can be used together.
   It can also determine what types of objects should be cached and for how
   long.
  </p><div class="sect2 " id="sec.squid.security"><div class="titlepage"><div><div><h3 class="title" id="sec.squid.security"><span class="number">26.1.1 </span><span class="name">Squid and Security</span> <a title="Permalink" class="permalink" href="#sec.squid.security">#</a></h3></div></div></div><p>
    It is possible to use Squid together with a firewall to secure internal
    networks from the outside using a proxy cache. The firewall denies all
    clients access to external services except Squid. All Web connections must
    be established by the proxy. With this configuration, Squid completely
    controls Web access.
   </p><p>
    If the firewall configuration includes a DMZ, the proxy should
    operate within this zone. <a class="xref" href="#sec.squid.proxyconfigtrans" title="26.6. Configuring a Transparent Proxy">Section 26.6, “Configuring a Transparent Proxy”</a>
    describes how to implement a <span class="emphasis"><em>transparent</em></span> proxy. This
    simplifies the configuration of the clients, because in this case, they do
    not need any information about the proxy.
   </p></div><div class="sect2 " id="sec.squid.morecaches"><div class="titlepage"><div><div><h3 class="title" id="sec.squid.morecaches"><span class="number">26.1.2 </span><span class="name">Multiple Caches</span> <a title="Permalink" class="permalink" href="#sec.squid.morecaches">#</a></h3></div></div></div><p>
    Several instances of Squid can be configured to exchange objects between
    them. This reduces the total system load and increases the chances of
    retrieving an object from the local network. It is also possible to
    configure cache hierarchies, so a cache can forward object requests to
    sibling caches or to a parent cache—causing it to request objects
    from another cache in the local network or directly from the source.
   </p><p>
    Choosing the appropriate topology for the cache hierarchy is very
    important, because it is not desirable to increase the overall traffic on
    the network. For a very large network, it would make sense to configure a
    proxy server for every subnet and connect them to a parent proxy, which in
    turn is connected to the proxy cache of the ISP.
   </p><p>
    All this communication is handled by ICP (Internet cache protocol) running
    on top of the UDP protocol. Data transfers between caches are handled using
    HTTP (hypertext transmission protocol) based on TCP.
   </p><p>
    To find the most appropriate server from which to request objects, a cache
    sends an ICP request to all sibling proxies. The sibling proxies answer
    these requests via ICP responses. If the object was detected, they use the
    code <code class="literal">HIT</code>, if not, they use <code class="literal">MISS</code>.
   </p><p>
    If multiple <code class="literal">HIT</code> responses were found, the proxy server
    decides from which server to download, depending on factors such as which
    cache sent the fastest answer or which one is closer. If no satisfactory
    responses are received, the request is sent to the parent cache.
    
   </p><div id="idm140019135065168" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note: How Squid Avoids Duplication of Objects</h6><p>
     To avoid duplication of objects in different caches in the network, other
     ICP protocols are used, such as CARP (cache array routing protocol) or
     HTCP (hypertext cache protocol). The more objects maintained in the
     network, the greater the possibility of finding the desired one.
    </p></div></div><div class="sect2 " id="sec.squid.latching"><div class="titlepage"><div><div><h3 class="title" id="sec.squid.latching"><span class="number">26.1.3 </span><span class="name">Caching Internet Objects</span> <a title="Permalink" class="permalink" href="#sec.squid.latching">#</a></h3></div></div></div><p>
    Many objects available in the network are not static, such as dynamically
    generated pages and TLS/SSL-encrypted content. Objects like these are not
    cached because they change each time they are accessed.
    
   </p><p>
    To determine how long objects should remain in the cache, objects are
    assigned one of several states. Web and proxy servers find out the status
    of an object by adding headers to these objects, such as <span class="quote">“<span class="quote">Last
    modified</span>”</span> or <span class="quote">“<span class="quote">Expires</span>”</span> and the corresponding date.
    Other headers specifying that objects must not be cached can be used as
    well.
   </p><p>
    Objects in the cache are normally replaced, because of a lack of free disk
    space, using algorithms such as LRU (last recently used). This means that
    the proxy expunges those objects that have not been requested for the
    longest time.
   </p></div></div><div class="sect1 " id="sec.squid.sysneeds"><div class="titlepage"><div><div><h2 class="title" id="sec.squid.sysneeds"><span class="number">26.2 </span><span class="name">System Requirements</span> <a title="Permalink" class="permalink" href="#sec.squid.sysneeds">#</a></h2></div></div></div><p>
   System requirements largely depend on the maximum network load that the
   system must bear. Therefore, examine load peaks, as during those times, load
   might be more than four times the day's average. When in doubt, slightly
   overestimate the system's requirements. Having Squid working close to the
   limit of its capabilities can lead to a severe loss in quality of service.
   The following sections point to system factors in order of significance:
  </p><div class="orderedlist "><ol class="orderedlist" type="1"><li class="listitem "><p>
     RAM size
    </p></li><li class="listitem "><p>
     CPU speed/physical CPU cores
    </p></li><li class="listitem "><p>
     Size of the disk cache
    </p></li><li class="listitem "><p>
     Hard disks/SSDs and their architecture
    </p></li></ol></div><div class="sect2 " id="sec.squid.ram"><div class="titlepage"><div><div><h3 class="title" id="sec.squid.ram"><span class="number">26.2.1 </span><span class="name">RAM</span> <a title="Permalink" class="permalink" href="#sec.squid.ram">#</a></h3></div></div></div><p>
    The amount of memory (RAM) required by Squid directly correlates with the
    number of objects in the cache. Random access memory is much faster than a
    hard disk/SSD. Therefore, it is very important to have sufficient memory
    for the Squid process, because system performance is dramatically reduced
    if the swap disk is used.
   </p><p>
    Squid also stores cache object references and frequently requested objects
    in the main memory to speed up retrieval of this data. In addition to that,
    there is other data that Squid needs to keep in memory, such as a table
    with all the IP addresses handled, an exact domain name cache, the most
    frequently requested objects, access control lists, buffers, and more.
   </p></div><div class="sect2 " id="sec.squid.cpu"><div class="titlepage"><div><div><h3 class="title" id="sec.squid.cpu"><span class="number">26.2.2 </span><span class="name">CPU</span> <a title="Permalink" class="permalink" href="#sec.squid.cpu">#</a></h3></div></div></div><p>
    Squid is tuned to work best with lower processor core counts (4–8
    physical cores), with each providing high performance. Technologies
    providing virtual cores such as hyperthreading can hurt performance.
   </p><p>
    To make the best use of multiple CPU cores, it is necessary to set up
    multiple worker threads writing to different caching devices. By default,
    multi-core support is mostly disabled.
   </p></div><div class="sect2 " id="sec.squid.sysneeds.cache_size"><div class="titlepage"><div><div><h3 class="title" id="sec.squid.sysneeds.cache_size"><span class="number">26.2.3 </span><span class="name">Size of the Disk Cache</span> <a title="Permalink" class="permalink" href="#sec.squid.sysneeds.cache_size">#</a></h3></div></div></div><p>
    In a small cache, the probability of a <code class="literal">HIT</code> (finding the
    requested object already located there) is small, because the cache is
    easily filled and less requested objects are replaced by newer ones. If,
    for example, 1 GB is available for the cache and the users use up only
    10 MB per day surfing, it would take more than one hundred days to
    fill the cache.
   </p><p>
    The easiest way to determine the necessary cache size is to consider the
    maximum transfer rate of the connection. With a 1 Mbit/s connection,
    the maximum transfer rate is 128 KB/s. If all this traffic ended up in
    the cache, in one hour it would add up to 460 MB. Assuming that all
    this traffic is generated in only eight working hours, it would reach
    3.6 GB in one day. Because the connection is normally not used to its
    upper volume limit, it can be assumed that the total data volume handled by
    the cache is approximately 2 GB. Hence, in this example, 2 GB of
    disk space is required for Squid to keep one day's worth of browsing data
    cached.
   </p></div><div class="sect2 " id="sec.squid.sysneeds.disk"><div class="titlepage"><div><div><h3 class="title" id="sec.squid.sysneeds.disk"><span class="number">26.2.4 </span><span class="name">Hard Disk/SSD Architecture</span> <a title="Permalink" class="permalink" href="#sec.squid.sysneeds.disk">#</a></h3></div></div></div><p>
    Speed plays an important role in the caching process, so this factor
    deserves special attention. For hard disks/SSDs, this parameter is
    described as <span class="emphasis"><em>random seek time</em></span> or <span class="emphasis"><em>random read
    performance</em></span>, measured in milliseconds. Because the data blocks
    that Squid reads from or writes to the hard disk/SSD tend to be small, the
    seek time/read performance of the hard disk/SSD is more important than its
    data throughput.
   </p><p>
    For use as a proxy, hard disks with high rotation speeds or SSDs are the
    best choice. When using hard disks, it can be better to use multiple
    smaller hard disks, each with a single cache directory to avoid excessive
    read times.
   </p><p>
    Using a RAID system allows increasing reliability at expense of speed.
    However, for performance reasons, avoid (software) RAID5 and similar
    settings.
   </p><p>
    File system choice is usually not decisive. However, using the mount option
    <code class="literal">noatime</code> can improve performance—Squid provides its
    own time stamps and thus does not need the file system to track access
    times.
   </p></div></div><div class="sect1 " id="sec.squid.start"><div class="titlepage"><div><div><h2 class="title" id="sec.squid.start"><span class="number">26.3 </span><span class="name">Basic Usage of Squid</span> <a title="Permalink" class="permalink" href="#sec.squid.start">#</a></h2></div></div></div><p>
   If not already installed, install the package
   <span class="package">squid</span>
   . <code class="systemitem">squid</code> is not among the packages installed by
   default on <span class="productname"><span class="phrase">openSUSE® Leap</span></span>.
  </p><p>
   Squid is already preconfigured in <span class="productname"><span class="phrase">openSUSE Leap</span></span>, you can start it directly
   after the installation. To ensure a smooth start-up, the network should be
   configured in a way that at least one name server and the Internet can be
   reached. Problems can arise if a dial-up connection is used with a dynamic
   DNS configuration. In this case, at least the name server should be
   specified, because Squid does not start if it does not detect a DNS server
   in <code class="filename">/etc/resolv.conf</code>.
  </p><div class="sect2 " id="sec.squid.start.commands"><div class="titlepage"><div><div><h3 class="title" id="sec.squid.start.commands"><span class="number">26.3.1 </span><span class="name">Starting Squid</span> <a title="Permalink" class="permalink" href="#sec.squid.start.commands">#</a></h3></div></div></div><p>
    To start Squid, use:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> <code class="command">systemctl start squid</code></pre></div><p>
    If you want Squid to start together with the system, enable the service
    with <code class="command">systemctl enable squid</code>.
   </p></div><div class="sect2 " id="sec.squid.check"><div class="titlepage"><div><div><h3 class="title" id="sec.squid.check"><span class="number">26.3.2 </span><span class="name">Checking Whether Squid Is Working</span> <a title="Permalink" class="permalink" href="#sec.squid.check">#</a></h3></div></div></div><p>
    To check whether Squid is running, choose one of the following ways:
   </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
      Using <code class="command">systemctl</code>:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">systemctl status squid</code></pre></div><p>
      The output of this command should indicate that Squid is
      <code class="literal">loaded</code> and <code class="literal">active (running)</code>.
     </p></li><li class="listitem "><p>
      Using Squid itself:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> <code class="command">squid -k check | echo $?</code></pre></div><p>
      The output of this command should be <code class="literal">0</code>, but may
      contain additional warnings or messages.
     </p></li></ul></div><p>
    To test the functionality of Squid on the local system, choose one of the
    following ways:
   </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
      To test, you can use <code class="command">squidclient</code>, a command-line tool
      that can output the response to a Web request, similar to
      <code class="command">wget</code> or <code class="command">curl</code>.
     </p><p>
      Unlike those tools, <code class="command">squidclient</code> will automatically
      connect to the default proxy setup of Squid,
      <code class="literal">localhost:3128</code>. However, if you changed the
      configuration of Squid, you need to configure
      <code class="command">squidclient</code> to use different settings using command
      line options. For more information, see <code class="command">squidclient
      --help</code>.
     </p><div class="complex-example"><div class="example" id="ex.squidclient.request"><div class="example-title-wrap"><h6 class="example-title"><span class="number">Example 26.1: </span><span class="name">A Request With <code class="command">squidclient</code> </span><a title="Permalink" class="permalink" href="#ex.squidclient.request">#</a></h6></div><div class="example-contents"><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">squidclient http://www.example.org</code>
HTTP/1.1 200 OK
Cache-Control: max-age=604800
Content-Type: text/html
Date: Fri, 22 Jun 2016 12:00:00 GMT
Expires: Fri, 29 Jun 2016 12:00:00 GMT
Last-Modified: Fri, 09 Aug 2013 23:54:35 GMT
Server: ECS (iad/182A)
Vary: Accept-Encoding
X-Cache: HIT
x-ec-custom-error: 1
Content-Length: 1270
X-Cache: MISS from moon<span id="co.squid.miss"></span><span class="callout">1</span>
X-Cache-Lookup: MISS from moon:3128
Via: 1.1 moon (squid/3.5.16)<span id="co.squid.via"></span><span class="callout">2</span>
Connection: close

&lt;!doctype html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;Example Domain&lt;/title&gt;
[...]
&lt;/body&gt;
&lt;/html&gt;</pre></div><p>
       The output shown in <a class="xref" href="#ex.squidclient.request" title="A Request With squidclient">Example 26.1, “A Request With <code class="command">squidclient</code>”</a> can be
       split into two parts:
      </p><div class="orderedlist "><ol class="orderedlist" type="1"><li class="listitem "><p>
         The protocol headers of the response: the lines before the blank line.
        </p></li><li class="listitem "><p>
         The actual content of the response: the lines after the blank line.
        </p></li></ol></div><p>
       To verify that Squid is used, refer to the selected header lines:
      </p><div class="calloutlist "><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#co.squid.miss"><span class="callout">1</span></a> </p></td><td valign="top" align="left"><p>
         The value of the header <code class="literal">X-Cache</code> tells you that the
         requested document was not in the Squid cache
         (<code class="literal">MISS</code>) of the computer
         <code class="systemitem">moon</code>.
        </p><p>
         The example above contains two <code class="literal">X-Cache</code> lines. You
         can ignore the first <code class="literal">X-Cache</code> header. It is produced
         by the internal caching software of the originating Web server.
        </p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#co.squid.via"><span class="callout">2</span></a> </p></td><td valign="top" align="left"><p>
         The value of the header <code class="literal">Via</code> tells you the HTTP
         version, the name of the computer, and the version of Squid in use.
        </p></td></tr></table></div></div></div></div></li><li class="listitem "><p>
      Using a browser: Set up <code class="option">localhost</code> as the proxy and
      <code class="option">3128</code> as the port. You can then load a page and check the
      response headers in the <span class="guimenu">Network</span> panel of the browser's
      <span class="emphasis"><em>Inspector</em></span> or <span class="emphasis"><em>Developer Tools</em></span>.
      The headers should be reproduced similarly to the way shown in
      <a class="xref" href="#ex.squidclient.request" title="A Request With squidclient">Example 26.1, “A Request With <code class="command">squidclient</code>”</a>.
     </p></li></ul></div><p>
    To allow users from the local system and other systems to access Squid and
    the Internet, change the entry in the configuration files
    <code class="filename">/etc/squid/squid.conf</code> from <code class="option">http_access deny
    all</code> to <code class="option">http_access allow all</code>. However, in doing
    so, consider that Squid is made completely accessible to anyone by this
    action. Therefore, define ACLs (access control lists) that control access
    to the proxy. After modifying the configuration file, Squid must be
    reloaded or restarted. For more information on ACLs, see
    <a class="xref" href="#sec.squid.acl" title="26.5.2. Options for Access Controls">Section 26.5.2, “Options for Access Controls”</a>.
   </p><p>
    If Squid quits after a short period of time even though it was started
    successfully, check whether there is a faulty name server entry or whether
    the <code class="filename">/etc/resolv.conf</code> file is missing. Squid logs the
    cause of a start-up failure in the file
    <code class="filename">/var/log/squid/cache.log</code>.
   </p></div><div class="sect2 " id="sec.squid.stop"><div class="titlepage"><div><div><h3 class="title" id="sec.squid.stop"><span class="number">26.3.3 </span><span class="name">Stopping, Reloading, and Restarting Squid</span> <a title="Permalink" class="permalink" href="#sec.squid.stop">#</a></h3></div></div></div><p>
     To reload Squid, choose one of the following ways:
   </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>Using <code class="command">systemctl</code>:</p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> <code class="command">systemctl</code> reload squid</pre></div><p>or</p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> <code class="command">systemctl</code> restart squid</pre></div></li><li class="listitem "><p>Using YaST:</p><p> In the Squid module, click the <span class="guimenu">Save Settings and Restart
       Squid Now</span>. button. </p></li></ul></div><p>To stop Squid, choose one of the following ways:</p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>Using <code class="command">systemctl</code>:</p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> <code class="command">systemctl</code> stop squid</pre></div></li><li class="listitem "><p>Using YaST</p><p> In the Squid module click the <span class="guimenu">Stop Squid Now</span>.
      button. </p></li></ul></div><p>
    Shutting down Squid can take a while, because Squid waits up to half a minute
    before dropping the connections to the clients and writing its data to the disk
    (see <code class="option">shutdown_lifetime</code> option in
    <code class="filename">/etc/squid/squid.conf</code>),
   </p><div id="idm140019134973328" class="admonition warning normal"><img class="symbol" alt="Warning" title="Warning" src="static/images/icon-warning.png" /><h6>Warning: Terminating Squid</h6><p>
     Terminating Squid with <code class="command">kill</code> or
     <code class="command">killall</code> can damage the cache. To be able to restart
     Squid, damaged caches must be deleted.
    </p></div></div><div class="sect2 " id="sec.squid.remove"><div class="titlepage"><div><div><h3 class="title" id="sec.squid.remove"><span class="number">26.3.4 </span><span class="name">Removing Squid</span> <a title="Permalink" class="permalink" href="#sec.squid.remove">#</a></h3></div></div></div><p>
    Removing Squid from the system does not remove the cache hierarchy and log
    files. To remove these, delete the <code class="filename">/var/cache/squid</code>
    directory manually.
   </p></div><div class="sect2 " id="sec.squid.start.local_dns"><div class="titlepage"><div><div><h3 class="title" id="sec.squid.start.local_dns"><span class="number">26.3.5 </span><span class="name">Local DNS Server</span> <a title="Permalink" class="permalink" href="#sec.squid.start.local_dns">#</a></h3></div></div></div><p>
    Setting up a local DNS server makes sense even if it does not manage its
    own domain. It then simply acts as a caching-only name server and is also
    able to resolve DNS requests via the root name servers without requiring
    any special configuration (see <a class="xref" href="#sec.dns.bind" title="19.4. Starting the BIND Name Server">Section 19.4, “Starting the BIND Name Server”</a>). How this
    can be done depends on whether you chose dynamic DNS during the
    configuration of the Internet connection.
   </p><div class="variablelist "><dl class="variablelist"><dt id="vle.squid.dynamicdns"><span class="term ">Dynamic DNS</span></dt><dd><p>
       Normally, with dynamic DNS, the DNS server is set by the provider during
       the establishment of the Internet connection and the local
       <code class="filename">/etc/resolv.conf</code> file is adjusted automatically.
       This behavior is controlled in the
       <code class="filename">/etc/sysconfig/network/config</code> file with the
       <code class="constant">NETCONFIG_DNS_POLICY</code> sysconfig variable. Set
       <code class="constant">NETCONFIG_DNS_POLICY</code> to <code class="constant">""</code>
       with the YaST sysconfig editor.
      </p><p>
       Then, add the local DNS server in the
       <code class="filename">/etc/resolv.conf</code> file with the IP address
       <code class="systemitem">127.0.0.1</code> for
       <code class="systemitem">localhost</code>. This way, Squid
       can always find the local name server when it starts.
      </p><p>
       To make the provider's name server accessible, specify it in the
       configuration file <code class="filename">/etc/named.conf</code> under
       <code class="systemitem">forwarders</code> along with its IP address. With
       dynamic DNS, this can be achieved automatically when establishing the
       connection by setting the sysconfig variable
       <code class="constant">NETCONFIG_DNS_POLICY</code> to <code class="constant">auto</code>.
      </p></dd><dt id="idm140019134955488"><span class="term ">Static DNS</span></dt><dd><p>
       With static DNS, no automatic DNS adjustments take place while
       establishing a connection, so there is no need to change any sysconfig
       variables. However, you must specify the local DNS server in the file
       <code class="filename">/etc/resolv.conf</code> as described in
       <a class="xref" href="#vle.squid.dynamicdns">Dynamic DNS</a>. Additionally, the provider's
       static name server must be specified manually in the
       <code class="filename">/etc/named.conf</code> file under
       <code class="systemitem">forwarders</code> along with its IP address.
      </p></dd></dl></div><div id="idm140019134951296" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.png" /><h6>Tip: DNS and Firewall</h6><p>
     If you have a firewall running, make sure DNS requests can pass it.
    </p></div></div></div><div class="sect1 " id="sec.squid.yast"><div class="titlepage"><div><div><h2 class="title" id="sec.squid.yast"><span class="number">26.4 </span><span class="name">The YaST Squid Module</span> <a title="Permalink" class="permalink" href="#sec.squid.yast">#</a></h2></div></div></div><p>The YaST Squid module contains the following tabs:</p><div class="variablelist "><dl class="variablelist"><dt id="idm140019134947632"><span class="term "><span class="guimenu">Start-Up</span></span></dt><dd><p>Specifies how Squid is started and which Firewall port is
      open on which interfaces.</p></dd><dt id="idm140019134945632"><span class="term "><span class="guimenu">HTTP Ports</span></span></dt><dd><p>
      Define all ports where Squid will listen for clients' http requests.
     </p></dd><dt id="idm140019134943648"><span class="term "><span class="guimenu">Refresh Patterns</span></span></dt><dd><p>Defines how Squid treats objects in the cache.</p></dd><dt id="idm140019134941696"><span class="term "><span class="guimenu">Cache Settings</span></span></dt><dd><p>
      Defines settings in regard to cache memory, maximum and minimum object
      size, and more.
     </p></dd><dt id="idm140019134939680"><span class="term "><span class="guimenu">Cache Directory</span></span></dt><dd><p>
      Defines the top-level directory where Squid stores all cache swap files.
     </p></dd><dt id="idm140019134937696"><span class="term "><span class="guimenu">Access Control</span></span></dt><dd><p>
      Controls the access to the Squid server via ACL groups.
     </p></dd><dt id="idm140019134935728"><span class="term "><span class="guimenu">Logging and Timeout</span></span></dt><dd><p>
      Define paths to access, cache, and cache store log files in addition
      with connection timeouts and client lifetime.
     </p></dd><dt id="idm140019134933696"><span class="term "><span class="guimenu">Miscellaneous</span></span></dt><dd><p>
      Sets language and mail address of administrator.
     </p></dd></dl></div></div><div class="sect1 " id="sec.squid.configfile"><div class="titlepage"><div><div><h2 class="title" id="sec.squid.configfile"><span class="number">26.5 </span><span class="name">The Squid Configuration File</span> <a title="Permalink" class="permalink" href="#sec.squid.configfile">#</a></h2></div></div></div><p>
   All Squid proxy server settings are made in the
   <code class="filename">/etc/squid/squid.conf</code> file. To start Squid for the
   first time, no changes are necessary in this file, but external clients are
   initially denied access. The proxy is available for
   <code class="systemitem">localhost</code>. The default port
   is <code class="option">3128</code>. The preinstalled configuration file
   <code class="filename">/etc/squid/squid.conf</code> provides detailed information
   about the options and many examples.
  </p><p>
   Many entries are commented and therefore begin with the comment character
   <code class="literal">#</code>. The relevant specifications can be found at the end of
   the line.
   
   The given values usually correlate with the default values, so removing the
   comment signs without changing any of the parameters usually has no effect.
   If possible, leave the commented lines as they are and insert the options
   along with the modified values in the line below. This way, the default
   values may easily be recovered and compared with the changes.
  </p><div id="idm140019134925552" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.png" /><h6>Tip: Adapting the Configuration File After an Update</h6><p>
    If you have updated from an earlier Squid version, it is recommended to
    edit the new <code class="filename">/etc/squid/squid.conf</code> and only apply the
    changes made in the previous file.
   </p><p>
    Sometimes, Squid options are added, removed, or modified. Therefore, if you
    try to use the old <code class="filename">squid.conf</code>, Squid might stop
    working properly.
   </p></div><div class="sect2 " id="sec.squid.configfile.general"><div class="titlepage"><div><div><h3 class="title" id="sec.squid.configfile.general"><span class="number">26.5.1 </span><span class="name">General Configuration Options</span> <a title="Permalink" class="permalink" href="#sec.squid.configfile.general">#</a></h3></div></div></div><p>
    The following is a list of a selection of configuration options for
    Squid. It is not exhaustive. The Squid package contains a full, lightly
    documented list of options in
    <code class="filename">/etc/squid/squid.conf.documented</code>.
   </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019134919984"><span class="term "><code class="literal">http_port <em class="replaceable ">PORT</em></code>
     </span></dt><dd><p>
       This is the port on which Squid listens for client requests. The default
       port is <code class="option">3128</code>, but <code class="option">8080</code> is also common.
      </p></dd><dt id="idm140019134916640"><span class="term ">
       <code class="literal">cache_peer <em class="replaceable ">HOST_NAME</em>
       <em class="replaceable ">TYPE</em> <em class="replaceable ">PROXY_PORT</em> <em class="replaceable ">ICP_PORT</em></code>
     </span></dt><dd><p>
       This option allows creating a network of caches that work together. The
       cache peer is a computer that also hosts a network cache and stands in a
       relationship to your own. The type of relationship is specified as the
       <em class="replaceable ">TYPE</em>. The type can either be
       <code class="literal">parent</code> or <code class="literal">sibling</code>.
      </p><p>
       As the <em class="replaceable ">HOST_NAME</em>, specify the name or IP
       address of the proxy to use. For <em class="replaceable ">PROXY_PORT</em>,
       specify the port number for use in a browser (usually
       <code class="option">8080</code>). Set <em class="replaceable ">ICP_PORT</em> to
       <code class="option">7</code> or, if the ICP port of the parent is not known and
       its use is irrelevant to the provider, to <code class="option">0</code>.
      </p><p>
       To make Squid behave like a Web browser instead of like a proxy,
       prohibit the use of the ICP protocol. You can do so by appending the
       options <code class="option">default</code> and <code class="option">no-query</code>.
      </p></dd><dt id="idm140019134906384"><span class="term "><code class="literal">cache_mem <em class="replaceable ">SIZE</em></code>
     </span></dt><dd><p>
       This option defines the amount of memory Squid can use for very popular
       replies. The default is <code class="option">8 MB</code>. This does not specify the
       memory usage of Squid and may be exceeded.
      </p></dd><dt id="idm140019134903408"><span class="term ">
       <code class="literal">cache_dir
       <em class="replaceable ">STORAGE_TYPE</em> <em class="replaceable ">CACHE_DIRECTORY</em>
       <em class="replaceable ">CACHE_SIZE</em>
       <em class="replaceable ">LEVEL_1_DIRECTORIES</em>
       <em class="replaceable ">LEVEL_2_DIRECTORIES</em></code>
     </span></dt><dd><p>
       The option <code class="literal">cache_dir</code> defines the directory for the
       disk cache. In the default configuration on <span class="productname"><span class="phrase">openSUSE Leap</span></span>, Squid does
       not create a disk cache.
      </p><p>
       The placeholder <em class="replaceable ">STORAGE_TYPE</em> can be one of
       the following:
      </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
         Directory-based storage types: <code class="literal">ufs</code>,
         <code class="literal">aufs</code> (the default), <code class="literal">diskd</code>. All
         three are variations of the storage format <code class="literal">ufs</code>.
         However, while <code class="literal">ufs</code> runs as part of the core Squid
         thread, <code class="literal">aufs</code> runs in a separate thread, and
         <code class="literal">diskd</code> uses a separate process. This means that the
         latter two types avoid blocking Squid because of disk I/O.
        </p></li><li class="listitem "><p>
         Database-based storage systems: <code class="literal">rock</code>. This storage
         format relies on a single database file, in which each object takes up
         one or more memory units of a fixed size (<span class="quote">“<span class="quote">slots</span>”</span>).
        </p></li></ul></div><p>
       In the following, only the parameters for storage types based on
       <code class="literal">ufs</code> will be discussed. <code class="literal">rock</code> has
       somewhat different parameters.
      </p><p>
       The <em class="replaceable ">CACHE_DIRECTORY</em> is the directory for the
       disk cache. By default, that is <code class="filename">/var/cache/squid</code>.
       <em class="replaceable ">CACHE_SIZE</em> is the maximum size of that
       directory in megabytes; by default, this is set to 100 MB. Set it
       to between 50% and a maximum of 80% of available disk space.
      </p><p>
       The final two values, <em class="replaceable ">LEVEL_1_DIRECTORIES</em> and
       <em class="replaceable ">LEVEL_2_DIRECTORIES</em> specify how many
       subdirectories are created in the
       <em class="replaceable ">CACHE_DIRECTORY</em>. By default, 16
       subdirectories are created at the first level below
       <em class="replaceable ">CACHE_DIRECTORY</em> and 256 within each of these.
       These values should only be increased with caution, because creating too
       many directories can lead to performance problems.
      </p><p>
       If you have several disks that share a cache, specify several
       <code class="option">cache_dir</code> lines.
      </p></dd><dt id="idm140019134882848"><span class="term "><code class="option">cache_access_log <em class="replaceable ">LOG_FILE</em></code>
     , </span><span class="term "><code class="option">cache_log <em class="replaceable ">LOG_FILE</em></code>
     , </span><span class="term "><code class="option">cache_store_log <em class="replaceable ">LOG_FILE</em></code>
     </span></dt><dd><p>
         These three options specify the paths where Squid logs all
       its actions. Normally, nothing needs to be changed here. If Squid is
       burdened by heavy usage, it might make sense to distribute the cache and
       the log files over several disks.
      </p></dd><dt id="idm140019134878176"><span class="term "><code class="option">client_netmask <em class="replaceable ">NETMASK</em></code>
     </span></dt><dd><p>
       This option allows masking IP addresses of clients in the log files by
       applying a subnet mask. For example, to set the last digit of the IP
       address to <code class="literal">0</code>, specify
       <code class="systemitem">255.255.255.0</code>.
      </p></dd><dt id="idm140019134874480"><span class="term "><code class="option">ftp_user <em class="replaceable ">E-MAIL</em></code>
     </span></dt><dd><p>
       This option allows setting the password that Squid should use for
       anonymous FTP login. Specify a valid e-mail address here, because some
       FTP servers check these for validity.
      </p></dd><dt id="idm140019134871920"><span class="term "><code class="option">cache_mgr <em class="replaceable ">E-MAIL</em></code>
     </span></dt><dd><p>
       If it unexpectedly crashes, Squid sends a message to this e-mail
       address. The default is <span class="emphasis"><em>webmaster</em></span>.
      </p></dd><dt id="idm140019134869008"><span class="term "><code class="option">logfile_rotate <em class="replaceable ">VALUE</em></code>
     </span></dt><dd><p>
       If you run <code class="command">squid</code> <code class="option">-k rotate</code>,
       <code class="command">squid</code> can rotate log files. The files are numbered in
       this process and, after reaching the specified value, the oldest file is
       overwritten. The default value is <code class="option">10</code> which rotates log
       files with the numbers 0 to 9.
      </p><p>
       However, on <span class="productname"><span class="phrase">openSUSE Leap</span></span>, rotating log files is performed automatically
       using <code class="systemitem">logrotate</code> and the
       configuration file <code class="filename">/etc/logrotate.d/squid</code>.
      </p></dd><dt id="idm140019134861840"><span class="term "><code class="option">append_domain <em class="replaceable ">DOMAIN</em></code>
     </span></dt><dd><p>
       Use <span class="emphasis"><em>append_domain</em></span> to specify which domain to append
       automatically when none is given. Usually, your own domain is specified
       here, so specifying <span class="emphasis"><em>www</em></span> in the browser accesses
       your own Web server.
      </p></dd><dt id="idm140019134858400"><span class="term "><code class="option">forwarded_for <em class="replaceable ">STATE</em></code>
     </span></dt><dd><p>
       If this option is set to <code class="literal">on</code>, it adds a line to the
       header similar to this:
      </p><div class="verbatim-wrap"><pre class="screen">X-Forwarded-For: 192.168.0.1</pre></div><p>
       If you set this option to <code class="literal">off</code>, Squid removes the IP
       address and the system name of the client from HTTP requests.
      </p></dd><dt id="idm140019134854064"><span class="term "><code class="option">negative_ttl <em class="replaceable ">TIME</em></code>
     , </span><span class="term "><code class="option">negative_dns_ttl <em class="replaceable ">TIME</em></code>
     </span></dt><dd><p>
       If these options are set, Squid will cache some types of failures, such
       as <code class="literal">404</code> responses. It will then refuse to issue new
       requests, even if the resource would be available then.
      </p><p>
       By default, <code class="option">negative_ttl</code> is set to
       <code class="literal">0</code>, <code class="option">negative_dns_ttl</code> is set to
       <code class="literal">1 minutes</code>.

       This means that negative responses to Web requests are not cached by
       default, while negative responses to DNS requests are cached for 1
       minute.
      </p></dd><dt id="idm140019134847648"><span class="term "><code class="option">never_direct allow <em class="replaceable ">ACL_NAME</em></code>
     </span></dt><dd><p>
       To prevent Squid from taking requests directly from the Internet, use
       the option <code class="literal">never_direct</code> to force connection to
       another proxy. This must have previously been specified in
       <code class="option">cache_peer</code>. If <code class="literal">all</code> is specified as
       the <em class="replaceable ">ACL_NAME</em>, all requests are forwarded
       directly to the <code class="literal">parent</code>. This can be necessary, for
       example, if you are using a provider that dictates the use of its
       proxies or denies its firewall direct Internet access.
      </p></dd></dl></div></div><div class="sect2 " id="sec.squid.acl"><div class="titlepage"><div><div><h3 class="title" id="sec.squid.acl"><span class="number">26.5.2 </span><span class="name">Options for Access Controls</span> <a title="Permalink" class="permalink" href="#sec.squid.acl">#</a></h3></div></div></div><p>
    Squid provides a detailed system for controlling the access to the proxy.
    These Access Control Lists (ACL) are lists with rules that are processed
    sequentially. ACLs must be defined before they can be used. Some default
    ACLs, such as <code class="literal">all</code> and <code class="literal">localhost</code>,
    already exist. However, the mere definition of an ACL does not mean that it
    is actually applied. This only happens when there is a corresponding
    <code class="option">http_access</code> rule.
   </p><p>
    The syntax for the option <code class="option">acl</code> is as follows:
   </p><div class="verbatim-wrap"><pre class="screen">acl <em class="replaceable ">ACL_NAME</em> <em class="replaceable ">TYPE</em> <em class="replaceable ">DATA</em></pre></div><p>
    The placeholders within this syntax stand for the following:
   </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
      The name <em class="replaceable ">ACL_NAME</em> can be chosen arbitrarily.
     </p></li><li class="listitem "><p>
      For <em class="replaceable ">TYPE</em>, select from a variety of different
      options which can be found in the <code class="literal">ACCESS CONTROLS</code>
      section in the <code class="filename">/etc/squid/squid.conf</code> file.
     </p></li><li class="listitem "><p>
      The specification for <em class="replaceable ">DATA</em> depends on the
      individual ACL type and can also be read from a file. For example,
      <span class="quote">“<span class="quote">via</span>”</span> host names, IP addresses, or URLs.
     </p></li></ul></div><p>
    To add rules in the YaST squid module, open the module and click the
    <span class="guimenu">Access Control</span> tab. Click <span class="guimenu">Add</span> under
    the ACL Groups list and enter the name of your rule, the type, and its
    parameters.
   </p><p>
    For more information on types of ACL rules, see the Squid documentation at
    <a class="link" href="http://www.squid-cache.org/Versions/v3/3.5/cfgman/acl.html" target="_blank">http://www.squid-cache.org/Versions/v3/3.5/cfgman/acl.html</a>.
   </p><div class="example" id="ex.squid.school"><div class="example-title-wrap"><h6 class="example-title"><span class="number">Example 26.2: </span><span class="name">Defining ACL Rules </span><a title="Permalink" class="permalink" href="#ex.squid.school">#</a></h6></div><div class="example-contents"><div class="verbatim-wrap"><pre class="screen">acl mysurfers srcdomain .example.com <span id="co.squid.school.surfer"></span><span class="callout">1</span>
acl teachers src 192.168.1.0/255.255.255.0 <span id="co.squid.school.teacher"></span><span class="callout">2</span>
acl students src 192.168.7.0-192.168.9.0/255.255.255.0 <span id="co.squid.school.student"></span><span class="callout">3</span>
acl lunch time MTWHF 12:00-15:00 <span id="co.squid.school.time"></span><span class="callout">4</span></pre></div><div class="calloutlist "><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#co.squid.school.surfer"><span class="callout">1</span></a> </p></td><td valign="top" align="left"><p>
       This ACL defines <code class="literal">mysurfers</code> to be all users coming
       from within <code class="literal">.example.com</code> (as determined by a reverse
       lookup for the IP).
      </p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#co.squid.school.teacher"><span class="callout">2</span></a> </p></td><td valign="top" align="left"><p>
       This ACL defines <code class="literal">teachers</code> to be the users of
       computers with IP addresses starting with <code class="literal">192.168.1.</code>.
      </p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#co.squid.school.student"><span class="callout">3</span></a> </p></td><td valign="top" align="left"><p>
       This ACL defines <code class="literal">students</code> to be the users of the
       computer with IP addresses starting with <code class="literal">192.168.7.</code>,
       <code class="literal">192.168.8.</code>, or <code class="literal">192.168.9.</code>.
      </p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#co.squid.school.time"><span class="callout">4</span></a> </p></td><td valign="top" align="left"><p>
       This ACL defines <code class="literal">lunch</code> as a time on the days
       Monday, Tuesday, ... Friday between noon and 3 p.m.
      </p></td></tr></table></div></div></div><div class="variablelist "><dl class="variablelist"><dt id="idm140019134812224"><span class="term ">http_access allow <em class="replaceable ">ACL_NAME</em>
     </span></dt><dd><p>
       <code class="option">http_access</code> defines who is allowed to use the proxy and
       who can access what on the Internet. For this, ACLs must be defined.
       <code class="literal">localhost</code> and <code class="literal">all</code> have already
       been defined above for which you can deny or allow access via
       <code class="literal">deny</code> or <code class="literal">allow</code>. A list containing
       any number of <code class="option">http_access</code> entries can be created,
       processed from top to bottom. Depending on which occurs first, access is
       allowed or denied to the respective URL. The last entry should always be
       <code class="option">http_access deny all</code>. In the following example,
       <code class="literal">localhost</code> has free access to everything while all
       other hosts are denied access completely:
      </p><div class="verbatim-wrap"><pre class="screen">http_access allow localhost
http_access deny all</pre></div><p>
       In another example using these rules, the group
       <code class="systemitem">teachers</code> always has access to
       the Internet. The group
       <code class="systemitem">students</code> only has access
       between Monday and Friday during lunch time:
      </p><div class="verbatim-wrap"><pre class="screen">http_access deny localhost
http_access allow teachers
http_access allow students lunch time
http_access deny all</pre></div><p>
       For readability, within the configuration file
       <code class="filename">/etc/squid/squid.conf</code>, specify all
       <code class="option">http_access</code> options as a block.
      </p></dd><dt id="idm140019134801424"><span class="term "><code class="option">url_rewrite_program <em class="replaceable ">PATH</em></code>
     </span></dt><dd><p>
       With this option, specify a URL rewriter.
      </p></dd><dt id="idm140019134799008"><span class="term "><code class="option">auth_param basic program
       <em class="replaceable ">PATH</em></code>
     </span></dt><dd><p>
       If users must be authenticated on the proxy, set a corresponding
       program, such as <code class="filename">/usr/sbin/pam_auth</code>. When accessing
       <code class="command">pam_auth</code> for the first time, the user sees a login
       window in which they need to specify a user name and a password. In
       addition, you need an ACL, so only clients with a valid login can use
       the Internet:
      </p><div class="verbatim-wrap"><pre class="screen">acl password proxy_auth REQUIRED

http_access allow password
http_access deny all</pre></div><p>
       In the <code class="option">acl proxy_auth</code> option, using
       <code class="literal">REQUIRED</code> means that all valid user names are
       accepted. <code class="literal">REQUIRED</code> can also be replaced with a list
       of permitted user names.
      </p></dd><dt id="idm140019134792384"><span class="term "><code class="option">ident_lookup_access allow
       <em class="replaceable ">ACL_NAME</em></code>
     </span></dt><dd><p>
       With this option, have an ident request run to find each user's identity
       for all clients defined by an ACL of the type <code class="literal">src</code>.
       Alternatively, use this for all clients, apply the predefined ACL
       <code class="literal">all</code> as the <em class="replaceable ">ACL_NAME</em>.
      </p><p>
       All clients covered by <code class="option">ident_lookup_access</code> must run an
       ident daemon. On Linux, you can use
       <code class="systemitem">pidentd</code> (package
       <span class="package">pidentd</span>
       ) as the ident daemon. For other operating systems, free software is
       usually available. To ensure that only clients with a successful ident
       lookup are permitted, define a corresponding ACL:
      </p><div class="verbatim-wrap"><pre class="screen">acl identhosts ident REQUIRED

http_access allow identhosts
http_access deny all</pre></div><p>
       In the <code class="option">acl identhosts ident</code> option, using
       <code class="literal">REQUIRED</code> means that all valid user names are
       accepted. <code class="literal">REQUIRED</code> can also be replaced with a list
       of permitted user names.
      </p><p>
       Using <code class="literal">ident</code> can slow down access time, because ident
       lookups are repeated for each request.
      </p></dd></dl></div></div></div><div class="sect1 " id="sec.squid.proxyconfigtrans"><div class="titlepage"><div><div><h2 class="title" id="sec.squid.proxyconfigtrans"><span class="number">26.6 </span><span class="name">Configuring a Transparent Proxy</span> <a title="Permalink" class="permalink" href="#sec.squid.proxyconfigtrans">#</a></h2></div></div></div><p>
   The usual way of working with proxy servers is as follows: the Web
   browser sends requests to a certain port of the proxy server and the proxy
   always provides these required objects, regardless of whether they are in
   its cache. However, in some cases the transparent proxy mode of Squid makes
   sense:
  </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
     If, for security reasons, it is recommended that all clients use a proxy
     to surf the Internet.
    </p></li><li class="listitem "><p>
     If all clients must use a proxy, regardless of whether they are aware of
     it.
    </p></li><li class="listitem "><p>
     If the proxy in a network is moved, but the existing clients need to
     retain their old configuration.
    </p></li></ul></div><p>
   A transparent proxy intercepts and answers the requests of the Web browser,
   so the Web browser receives the requested pages without knowing where they
   are coming from. As the name indicates, the entire process is transparent to
   the user.
  </p><div class="procedure " id="pro.squid.transparent.cli"><div class="procedure-title-wrap"><h6 class="procedure-title"><span class="number">Procedure 26.1: </span><span class="name">Squid as a Transparent Proxy (Command Line) </span><a title="Permalink" class="permalink" href="#pro.squid.transparent.cli">#</a></h6></div><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
     In <code class="filename">/etc/squid/squid.conf</code>, on the line of the option
     <code class="option">http_port</code> add the parameter
     <code class="literal">transparent</code>:
    </p><div class="verbatim-wrap"><pre class="screen">http_port 3128 transparent</pre></div></li><li class="step "><p>
     Restart Squid:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> <code class="command">systemctl restart squid</code></pre></div></li><li class="step " id="st.squid.transparent.cli.fwrules"><p>
     Set up SuSEfirewall2 to redirect HTTP traffic to the port given in
     <code class="option">http_proxy</code> (in the example above, that was port 3128). To
     do so, edit the configuration file
     <code class="filename">/etc/sysconfig/SuSEfirewall2</code>.
    </p><p>
     This example assumes that you are using the following devices:
    </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
       Device pointing to the Internet: <code class="literal">FW_DEV_EXT="eth1"</code>
      </p></li><li class="listitem "><p>
       Device pointing to the network: <code class="literal">FW_DEV_INT="eth0"</code>
      </p></li></ul></div><p>
     Define ports and services (see <code class="filename">/etc/services</code>) on the
     firewall that are accessed from untrusted (external) networks such as the
     Internet. In this example, only Web services are offered to the outside:
    </p><div class="verbatim-wrap"><pre class="screen">FW_SERVICES_EXT_TCP="www"</pre></div><p>
     Define ports or services (see <code class="filename">/etc/services</code>) on the
     firewall that are accessed from the secure (internal) network, both via
     TCP and UDP:
    </p><div class="verbatim-wrap"><pre class="screen">FW_SERVICES_INT_TCP="domain www 3128"
FW_SERVICES_INT_UDP="domain"</pre></div><p>
     This allows accessing Web services and Squid (whose default port is
     <code class="option">3128</code>). The service <span class="quote">“<span class="quote">domain</span>”</span> stands for DNS
     (domain name service). This service is commonly used. Otherwise, simply
     remove <code class="literal">domain</code> from the above entries and set the
     following option to <code class="literal">no</code>:
    </p><div class="verbatim-wrap"><pre class="screen">FW_SERVICE_DNS="yes"</pre></div><p>
     The option <code class="option">FW_REDIRECT</code> is very important, as it is used
     for the actual redirection of HTTP traffic to a specific port. The
     configuration file explains the syntax in a comment above the option:
    </p><div class="verbatim-wrap"><pre class="screen"># Format:
# list of &lt;source network&gt;[,&lt;destination network&gt;,&lt;protocol&gt;[,dport[:lport]]
# Where protocol is either tcp or udp. dport is the original
# destination port and lport the port on the local machine to
# redirect the traffic to
#
# An exclamation mark in front of source or destination network
# means everything EXCEPT the specified network</pre></div><p>
     That is:
    </p><div class="orderedlist "><ol class="orderedlist" type="1"><li class="listitem "><p>
       Specify the IP address and the netmask of the internal networks
       accessing the proxy firewall.
      </p></li><li class="listitem "><p>
       Specify the IP address and the netmask to which these clients send their
       requests. In the case of Web browsers, specify the networks
       <code class="literal">0/0</code>, a wild card that means <span class="quote">“<span class="quote">to
       everywhere.</span>”</span>
      </p></li><li class="listitem "><p>
       Specify the original port to which these requests are sent.
      </p></li><li class="listitem "><p>
       Specify the port to which all these requests are redirected. In the
       example below, only Web services (port <code class="literal">80</code>) are
       redirected to the proxy port (port <code class="literal">3128</code>). If there
       are more networks or services to add, separate them with a space in the
       respective entry.
      </p><p>
       Because Squid supports protocols other than HTTP, you can also redirect
       requests from other ports to the proxy. For example, you can also
       redirect port 21 (FTP) and port 443 (HTTPS or SSL).
      </p></li></ol></div><p>
     Therefore, for a Squid configuration, you could use:
    </p><div class="verbatim-wrap"><pre class="screen">FW_REDIRECT="192.168.0.0/16,0/0,tcp,80,3128"</pre></div></li><li class="step "><p>
     In the configuration file
     <code class="filename">/etc/sysconfig/SuSEfirewall2</code>, make sure that
     the entry <code class="option">START_FW</code> is set to <code class="literal">"yes"</code>.
    </p></li><li class="step "><p>
     Restart SuSEfirewall2:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> <code class="command">systemctl restart SuSEfirewall2</code></pre></div></li><li class="step "><p>
     To verify that everything is working properly, check the Squid log files
     in <code class="filename">/var/log/squid/access.log</code>. To verify that all
     ports are correctly configured, perform a port scan on the machine from
     any computer outside your network. Only the Web services (port 80) should
     be open. To scan the ports with <code class="command">nmap</code>, use:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="command">nmap</code> <code class="option">-O <em class="replaceable ">IP_ADDRESS</em></code></pre></div></li></ol></div></div><div class="procedure " id="pro.squid.transparent.yast"><div class="procedure-title-wrap"><h6 class="procedure-title"><span class="number">Procedure 26.2: </span><span class="name">Squid as a Transparent Proxy (YaST) </span><a title="Permalink" class="permalink" href="#pro.squid.transparent.yast">#</a></h6></div><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>Start the YaST Squid module:</p><ol type="a" class="substeps "><li class="step "><p>
       In the <span class="guimenu">Start-Up</span> tab, enable <span class="guimenu">Open Ports in
        Firewall</span>. Click <span class="guimenu">Firewall Details</span> to
       select the interfaces on which to open the port. This option is
       available only if the Firewall is enabled. </p></li><li class="step "><p>
       In the <span class="guimenu">HTTP Ports</span> tab, select the first line
       with the port <code class="systemitem">3128</code>.
      </p></li><li class="step "><p>
       Click the <span class="guimenu">Edit</span> button. A small window appear
       where you can edit the current HTTP port. Select
        <span class="guimenu">Transparent</span>. </p></li><li class="step "><p>Finish with <span class="guimenu">Ok</span>.</p></li></ol></li><li class="step "><p>
     Configure the Firewall settings as described in <a class="xref" href="#st.squid.transparent.cli.fwrules" title="Step 3">Step 3</a> of <a class="xref" href="#pro.squid.transparent.cli" title="Squid as a Transparent Proxy (Command Line)">Procedure 26.1, “Squid as a Transparent Proxy (Command Line)”</a>.
    </p></li></ol></div></div></div><div class="sect1 " id="sec.squid.cachemgr"><div class="titlepage"><div><div><h2 class="title" id="sec.squid.cachemgr"><span class="number">26.7 </span><span class="name">Using the Squid Cache Manager CGI Interface (<code class="systemitem">cachemgr.cgi</code>)</span> <a title="Permalink" class="permalink" href="#sec.squid.cachemgr">#</a></h2></div></div></div><p>
   The Squid cache manager CGI interface (<code class="filename">cachemgr.cgi</code>) is
   a CGI utility for displaying statistics about the memory usage of a running
   Squid process. It is also a convenient way to manage the cache and view
   statistics without logging the server.
  </p><div class="procedure " id="pro.squid.setup.cachemgr"><div class="procedure-title-wrap"><h6 class="procedure-title"><span class="number">Procedure 26.3: </span><span class="name">Setting up <code class="systemitem">cachemgr.cgi</code> </span><a title="Permalink" class="permalink" href="#pro.squid.setup.cachemgr">#</a></h6></div><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
     Make sure the Apache Web server is running on your system. Configure
     Apache as described in <a class="xref" href="#cha.apache2" title="Chapter 24. The Apache HTTP Server">Chapter 24, <em>The Apache HTTP Server</em></a>. In particular, see
     <a class="xref" href="#sec.apache2.cgi" title="24.5. Enabling CGI Scripts">Section 24.5, “Enabling CGI Scripts”</a>. To check whether Apache is already
     running, use:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> <code class="command">systemctl status apache2</code></pre></div><p>
     If <code class="literal">inactive</code> is shown, you can start Apache with the
     <span class="productname"><span class="phrase">openSUSE Leap</span></span> default settings:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> <code class="command">systemctl start apache2</code></pre></div></li><li class="step "><p>
     Now enable <code class="systemitem">cachemgr.cgi</code> in
     Apache. To do so, create a configuration file for a
     <code class="literal">ScriptAlias</code>.
    </p><p>
     Create the file in the directory <code class="filename">/etc/apache2/conf.d</code>
     and name it <code class="filename">cachemgr.conf</code>. In it, add the following:
    </p><div class="verbatim-wrap"><pre class="screen">ScriptAlias /squid/cgi-bin/ /usr/lib64/squid/

&lt;Directory "/usr/lib64/squid/"&gt;
Options +ExecCGI
AddHandler cgi-script .cgi
Require host <em class="replaceable ">HOST_NAME</em>
&lt;/Directory&gt;</pre></div><p>
     Replace <em class="replaceable ">HOST_NAME</em> with the host name of the
     computer you want to access
     <code class="systemitem">cachemgr.cgi</code> from. This allows
     only your computer to access
     <code class="systemitem">cachemgr.cgi</code>. To allow access
     from anywhere, use <code class="literal">Require all granted</code> instead.
    </p></li><li class="step "><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
       If Squid and your Apache Web server run on the same computer, there
       should be no changes that need to be made to
       <code class="filename">/etc/squid/squid.conf</code>. However, verify that
       <code class="filename">/etc/squid/squid.conf</code> contains the following lines:
      </p><div class="verbatim-wrap"><pre class="screen">  http_access allow manager localhost
  http_access deny manager</pre></div><p>
       These lines allow you to access the manager interface from your own
       computer (<code class="literal">localhost</code>) but not from elsewhere.
      </p></li><li class="listitem "><p>
       If Squid and your Apache Web server run on different computers, you need
       to add extra rules to allow access from the CGI script to Squid. Define
       an ACL for your server (replace <em class="replaceable ">WEB_SERVER_IP</em>
       with the IP address of your Web server):
      </p><div class="verbatim-wrap"><pre class="screen">acl webserver src <em class="replaceable ">WEB_SERVER_IP</em>/255.255.255.255</pre></div><p>
       Make sure the following rules are in the configuration file. Compared to
       the default configuration, only the rule in the middle is new. However,
       the sequence is important.
      </p><div class="verbatim-wrap"><pre class="screen">http_access allow manager localhost
http_access allow manager webserver
http_access deny manager</pre></div></li></ul></div></li><li class="step "><p><span class="step-optional">(Optional)</span> 
     Optionally, you can configure one or more passwords for
     <code class="systemitem">cachemgr.cgi</code>. This also allows
     access to more actions such as closing the cache remotely or viewing more
     information about the cache. For this, configure the options
     <code class="option">cache_mgr</code> and <code class="option">cachemgr_passwd</code> with one
     or more password for the manager and a list of allowed actions.
    </p><p>
     For example, to explicitly enable viewing the index page, the menu,
     60-minute average of counters without authentication, to enable toggling
     offline mode using the password <code class="literal">secretpassword</code>, and to
     completely disable everything else, use the following configuration:
    </p><div class="verbatim-wrap"><pre class="screen">cache_mgr user
cachemgr_passwd none index menu 60min
cachemgr_passwd secretpassword offline_toggle
cachemgr_passwd disable all</pre></div><p>
     <code class="option">cache_mgr</code> defines a user name. <code class="option">cache_mgr</code>
     defines which actions are allowed using which password.
    </p><p>
     The keywords <code class="literal">none</code> and <code class="literal">disable</code> are
     special: <code class="literal">none</code> removes the need for a password,
     <code class="literal">disable</code> disables functionality outright.
    </p><p>
     The full list of actions can be best seen after logging in to
     <code class="systemitem">cachemgr.cgi</code>. To find out how
     the operation needs to be referenced in the configuration file, see the
     string after <code class="literal">&amp;operation=</code> in the URL of the action
     page. <code class="literal">all</code> is a special keyword meaning all actions.
    </p></li><li class="step "><p>
     Reload Squid and Apache after the configuration file changes:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> <code class="command">systemctl reload squid</code></pre></div></li><li class="step "><p>
     To view the statistics, go to the
     <code class="systemitem">cachemgr.cgi</code> page that you set
     up before. For example, it could be
     <code class="literal">http://webserver.example.org/squid/cgi-bin/cachemgr.cgi</code>.
    </p><p>
     Choose the right server, and, if set, specify user name and password. Then
     click <span class="guimenu">Continue</span> and browse through the different
     statistics.
    </p></li></ol></div></div></div><div class="sect1 " id="sec.squid.calamaris"><div class="titlepage"><div><div><h2 class="title" id="sec.squid.calamaris"><span class="number">26.8 </span><span class="name">Cache Report Generation with Calamaris</span> <a title="Permalink" class="permalink" href="#sec.squid.calamaris">#</a></h2></div></div></div><p>
   Calamaris is a Perl script used to generate reports of cache activity in
   ASCII or HTML format. It works with native Squid access log files. The
   Calamaris home page is located at
   <a class="link" href="http://cord.de/calamaris-english" target="_blank">http://cord.de/calamaris-english</a>. This tool does not
   belong to the <span class="productname"><span class="phrase">openSUSE Leap</span></span> default installation scope—to use it,
   install the <code class="systemitem">calamaris</code> package.
  </p><p>
   Log in as <code class="systemitem">root</code>, then enter:
  </p><div class="verbatim-wrap"><pre class="screen">cat access1.log [access2.log access3.log] | calamaris <em class="replaceable ">OPTIONS</em> &gt; reportfile</pre></div><p>
   When using more than one log file, make sure they are chronologically
   ordered, with older files listed first. This can be achieved by either
   listing the files one after the other as in the example above, or by using
   <code class="filename">access{1..3}.log</code>.
  </p><p>
   <code class="command">calamaris</code> takes the following options:
  </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019134674160"><span class="term "><code class="option">-a</code>
    </span></dt><dd><p>
      output all available reports
     </p></dd><dt id="idm140019134672048"><span class="term "><code class="option">-w</code>
    </span></dt><dd><p>
      output as HTML report
     </p></dd><dt id="idm140019134669952"><span class="term "><code class="option">-l</code>
    </span></dt><dd><p>
      include a message or logo in report header
     </p></dd></dl></div><p>
   More information about the various options can be found in the program's
   manual page with <code class="command">man</code> <code class="option">calamaris</code>.
  </p><p>
   A typical example is:
  </p><div class="verbatim-wrap"><pre class="screen">cat access.log.{10..1} access.log | calamaris -a -w \
&gt; /usr/local/httpd/htdocs/Squid/squidreport.html</pre></div><p>
   This puts the report in the directory of the Web server. Apache is required
   to view the reports.
  </p></div><div class="sect1 " id="sec.squid.moreinfo"><div class="titlepage"><div><div><h2 class="title" id="sec.squid.moreinfo"><span class="number">26.9 </span><span class="name">For More Information</span> <a title="Permalink" class="permalink" href="#sec.squid.moreinfo">#</a></h2></div></div></div><p>
   Visit the home page of Squid at
   <a class="link" href="http://www.squid-cache.org/" target="_blank">http://www.squid-cache.org/</a>. Here, find the
   <span class="quote">“<span class="quote">Squid User Guide</span>”</span> and a very extensive collection of FAQs on
   Squid.
  </p><p>
   In addition, mailing lists are available for Squid at
   <a class="link" href="http://www.squid-cache.org/Support/mailing-lists.html" target="_blank">http://www.squid-cache.org/Support/mailing-lists.html</a>.
  </p></div></div></div><div class="part" id="part.reference.mobility"><div class="titlepage"><div><div><h1 class="title"><span class="number">Part IV </span><span class="name">Mobile Computers </span><a title="Permalink" class="permalink" href="#part.reference.mobility">#</a></h1></div></div></div><div class="toc"><dl><dt><span class="chapter"><a href="#cha.mobile"><span class="number">27 </span><span class="name">Mobile Computing with Linux</span></a></span></dt><dd class="toc-abstract"><p>
    Mobile computing is mostly associated with laptops, PDAs and cellular
    phones (and the data exchange between them). Mobile hardware components,
    such as external hard disks, flash disks, or digital cameras, can be
    connected to laptops or desktop systems. A number of software components
    are involved in mobile computing scenarios and some applications are
    tailor-made for mobile use.
   </p></dd><dt><span class="chapter"><a href="#cha.nm"><span class="number">28 </span><span class="name">Using NetworkManager</span></a></span></dt><dd class="toc-abstract"><p>NetworkManager is the ideal solution for laptops and other portable computers. It supports state-of-the-art encryption types and standards for network connections, including connections to 802.1X protected networks. 802.1X is the “IEEE Standard for Local and Metropolitan Area Networks—Port-Based Net…</p></dd><dt><span class="chapter"><a href="#cha.power-mgmt"><span class="number">29 </span><span class="name">Power Management</span></a></span></dt><dd class="toc-abstract"><p>Power management is especially important on laptop computers, but is also useful on other systems. ACPI (Advanced Configuration and Power Interface) is available on all modern computers (laptops, desktops, and servers). Power management technologies require suitable hardware and BIOS routines. Most …</p></dd></dl></div><div class="chapter " id="cha.mobile"><div class="titlepage"><div><div><h2 class="title"><span class="number">27 </span><span class="name">Mobile Computing with Linux</span> <a title="Permalink" class="permalink" href="#cha.mobile">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">Filename: </span>mobile.xml</li><li><span class="ds-label">ID: </span>cha.mobile</li></ul></div></div><div><div class="abstract"><div class="abstract-title-wrap"><h6 class="abstract-title">Abstract<a title="Permalink" class="permalink" href="#idm140019134655104">#</a></h6></div><p>
    Mobile computing is mostly associated with laptops, PDAs and cellular
    phones (and the data exchange between them). Mobile hardware components,
    such as external hard disks, flash disks, or digital cameras, can be
    connected to laptops or desktop systems. A number of software components
    are involved in mobile computing scenarios and some applications are
    tailor-made for mobile use.
   </p></div></div></div></div><div class="line"><div class="toc"><dl><dt><span class="sect1"><a href="#sec.mobile.nbook"><span class="number">27.1 </span><span class="name">Laptops</span></a></span></dt><dt><span class="sect1"><a href="#sec.mobile.hw"><span class="number">27.2 </span><span class="name">Mobile Hardware</span></a></span></dt><dt><span class="sect1"><a href="#sec.mobile.comm"><span class="number">27.3 </span><span class="name">Cellular Phones and PDAs</span></a></span></dt><dt><span class="sect1"><a href="#sec.mobile.info"><span class="number">27.4 </span><span class="name">For More Information</span></a></span></dt></dl></div></div><div class="sect1 " id="sec.mobile.nbook"><div class="titlepage"><div><div><h2 class="title" id="sec.mobile.nbook"><span class="number">27.1 </span><span class="name">Laptops</span> <a title="Permalink" class="permalink" href="#sec.mobile.nbook">#</a></h2></div></div></div><p>
   The hardware of laptops differs from that of a normal desktop system. This
   is because criteria like exchangeability, space requirements and power
   consumption must be taken into account. The manufacturers of mobile hardware
   have developed standard interfaces like Mini PCI and Mini PCIe that can be
   used to extend the hardware of laptops. The standards cover memory cards,
   network interface cards, and external hard disks.
  </p><div class="sect2 " id="sec.mobile.powerm"><div class="titlepage"><div><div><h3 class="title" id="sec.mobile.powerm"><span class="number">27.1.1 </span><span class="name">Power Conservation</span> <a title="Permalink" class="permalink" href="#sec.mobile.powerm">#</a></h3></div></div></div><p>
    The inclusion of energy-optimized system components during laptop
    manufacturing contributes to their suitability for use without access to
    the electrical power grid. Their contribution to conservation of power
    is at least as important as that of the operating system. <span class="productname"><span class="phrase">openSUSE® Leap</span></span>
    supports various methods that control the power consumption of a laptop
    and have varying effects on the operating time under battery power. The
    following list is in descending order of contribution to power
    conservation:
   </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
      Throttling the CPU speed.
     </p></li><li class="listitem "><p>
      Switching off the display illumination during pauses.
     </p></li><li class="listitem "><p>
      Manually adjusting the display illumination.
     </p></li><li class="listitem "><p>
      Disconnecting unused, hotplug-enabled accessories (USB CD-ROM, external
      mouse, Wi-Fi, etc.).
     </p></li><li class="listitem "><p>
      Spinning down the hard disk when idling.
     </p></li></ul></div><p>
    Detailed background information about power management in <span class="productname"><span class="phrase">openSUSE Leap</span></span> is
    provided in <a class="xref" href="#cha.power-mgmt" title="Chapter 29. Power Management">Chapter 29, <em>Power Management</em></a>.

   </p></div><div class="sect2 " id="sec.mobile.nbook.change"><div class="titlepage"><div><div><h3 class="title" id="sec.mobile.nbook.change"><span class="number">27.1.2 </span><span class="name">Integration in Changing Operating Environments</span> <a title="Permalink" class="permalink" href="#sec.mobile.nbook.change">#</a></h3></div></div></div><p>
    Your system needs to adapt to changing operating environments when used for
    mobile computing. Many services depend on the environment and the
    underlying clients must be reconfigured. <span class="productname"><span class="phrase">openSUSE Leap</span></span> handles this task
    for you.
   </p><div class="figure" id="fig.mobile.scpm"><div class="figure-contents"><div class="mediaobject"><a xmlns="" href="images/mobile_scpm.png"><img src="images/mobile_scpm.png" width="" alt="Integrating a Mobile Computer in an Existing Environment" /></a></div></div><div class="figure-title-wrap"><h6 class="figure-title"><span class="number">Figure 27.1: </span><span class="name">Integrating a Mobile Computer in an Existing Environment </span><a title="Permalink" class="permalink" href="#fig.mobile.scpm">#</a></h6></div></div><p>
    The services affected in the case of a laptop commuting back and forth
    between a small home network and an office network are:
   </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019134631024"><span class="term ">Network</span></dt><dd><p>
       This includes IP address assignment, name resolution, Internet
       connectivity and connectivity to other networks.
      </p></dd><dt id="idm140019134629120"><span class="term ">Printing</span></dt><dd><p>
       A current database of available printers and an available print server
       must be present, depending on the network.
      </p></dd><dt id="idm140019134627216"><span class="term ">E-Mail and Proxies</span></dt><dd><p>
       As with printing, the list of the corresponding servers must be current.
      </p></dd><dt id="idm140019134625360"><span class="term ">X (Graphical Environment)</span></dt><dd><p>
       If your laptop is temporarily connected to a projector or an external
       monitor, different display configurations must be available.
      </p></dd></dl></div><p>
    <span class="productname"><span class="phrase">openSUSE Leap</span></span> offers several ways of integrating laptops into existing
    operating environments:
   </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019134621312"><span class="term ">NetworkManager</span></dt><dd><p>
       NetworkManager is especially tailored for mobile networking on
       laptops. It provides a means to easily and automatically switch between
       network environments or different types of networks such as mobile
       broadband (such as GPRS, EDGE, or 3G), wireless LAN, and Ethernet. NetworkManager
       supports WEP and WPA-PSK encryption in wireless LANs. It also supports
       dial-up connections. The GNOME desktop includes a front-end for NetworkManager.
       For more information, see <a class="xref" href="#sec.nm.configure" title="28.3. Configuring Network Connections">Section 28.3, “Configuring Network Connections”</a>.
      </p><div class="table" id="idm140019134618784"><div class="table-title-wrap"><h6 class="table-title"><span class="number">Table 27.1: </span><span class="name">Use Cases for NetworkManager </span><a title="Permalink" class="permalink" href="#idm140019134618784">#</a></h6></div><div class="table-contents"><table summary="Use Cases for NetworkManager" border="1"><colgroup><col /><col /></colgroup><thead><tr><th>
           <p>
            My computer…
           </p>
          </th><th>
           <p>
            Use NetworkManager
           </p>
          </th></tr></thead><tbody><tr><td>
           <p>
            is a laptop
           </p>
          </td><td>
           <p>
            Yes
           </p>
          </td></tr><tr><td>
           <p>
            is sometimes attached to different networks
           </p>
          </td><td>
           <p>
            Yes
           </p>
          </td></tr><tr><td>
           <p>
            provides network services (such as DNS or DHCP)
           </p>
          </td><td>
           <p>
            No
           </p>
          </td></tr><tr><td>
           <p>
            only uses a static IP address
           </p>
          </td><td>
           <p>
            No
           </p>
          </td></tr></tbody></table></div></div><p>
       Use the YaST tools to configure networking whenever NetworkManager should not
       handle network configuration.
      </p><div id="idm140019134604224" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.png" /><h6>Tip: DNS Configuration and Various Types of Network Connections</h6><p>
        If you travel frequently with your laptop and change different types of
        network connections, NetworkManager works fine when all DNS addresses are
        assigned correctly assigned with DHCP. If some connections use static
        DNS address(es), add it to the
        <code class="literal">NETCONFIG_DNS_STATIC_SERVERS</code> option in
        <code class="filename">/etc/sysconfig/network/config</code>.
       </p></div></dd><dt id="idm140019134601312"><span class="term ">SLP</span></dt><dd><p>
       The service location protocol (SLP) simplifies the
       connection of a laptop to an existing network. Without SLP, the
       administrator of a laptop usually requires detailed knowledge of the
       services available in a network. SLP broadcasts the availability of a
       certain type of service to all clients in a local network. Applications
       that support SLP can process the information dispatched by SLP and be
       configured automatically. SLP can also be used to install a system,
       minimizing the effort of searching for a suitable installation
       source.<span class="phrase"> Find detailed information about SLP in
       <a class="xref" href="#cha.slp" title="Chapter 17. SLP">Chapter 17, <em>SLP</em></a>.</span>
      </p></dd></dl></div></div><div class="sect2 " id="sec.mobile.nbook.soft"><div class="titlepage"><div><div><h3 class="title" id="sec.mobile.nbook.soft"><span class="number">27.1.3 </span><span class="name">Software Options</span> <a title="Permalink" class="permalink" href="#sec.mobile.nbook.soft">#</a></h3></div></div></div><p>
    There are various task areas in mobile use that are covered by dedicated
    software: system monitoring (especially the battery charge), data
    synchronization, and wireless communication with peripherals and the
    Internet. The following sections cover the most important applications that
    <span class="productname"><span class="phrase">openSUSE Leap</span></span> provides for each task.
   </p><div class="sect3 " id="sec.mobile.nbook.soft.mon"><div class="titlepage"><div><div><h4 class="title" id="sec.mobile.nbook.soft.mon"><span class="number">27.1.3.1 </span><span class="name">System Monitoring</span> <a title="Permalink" class="permalink" href="#sec.mobile.nbook.soft.mon">#</a></h4></div></div></div><p>
     Two system monitoring tools are provided by <span class="productname"><span class="phrase">openSUSE Leap</span></span>:
    </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019134591136"><span class="term ">Power Management</span></dt><dd><p>
        <span class="guimenu">Power Management</span> is an application that
        lets you adjust the energy saving related behavior of the GNOME
        desktop. You can typically access it via
        <span class="guimenu">Computer</span> › <span class="guimenu">Control
        Center</span> › <span class="guimenu">System</span> › <span class="guimenu">Power
        Management</span>.

       </p></dd><dt id="idm140019134586864"><span class="term ">System Monitor</span></dt><dd><p>
        The <span class="guimenu">System Monitor</span> gathers measurable
        system parameters into one monitoring environment. It presents the
        output information in three tabs by default.
        <span class="guimenu">Processes</span> gives detailed information about currently
        running processes, such as CPU load, memory usage, or process ID number
        and priority. The presentation and filtering of the collected data can
        be customized—to add a new type of process information,
        left-click the process table header and choose which column to hide or
        add to the view. It is also possible to monitor different system
        parameters in various data pages or collect the data of various
        machines in parallel over the network. The <span class="guimenu">Resources</span>
        tab shows graphs of CPU, memory and network history and the
        <span class="guimenu">File System</span> tab lists all partitions and their
        usage.
       </p></dd></dl></div></div><div class="sect3 " id="sec.mobile.nbook.soft.sync"><div class="titlepage"><div><div><h4 class="title" id="sec.mobile.nbook.soft.sync"><span class="number">27.1.3.2 </span><span class="name">Synchronizing Data</span> <a title="Permalink" class="permalink" href="#sec.mobile.nbook.soft.sync">#</a></h4></div></div></div><p>
     When switching between working on a mobile machine disconnected from the
     network and working at a networked workstation in an office, it is
     necessary to keep processed data synchronized across all instances. This
     could include e-mail folders, directories and individual files that need
     to be present for work on the road and at the office. The solution in both
     cases is as follows:
    </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019134579792"><span class="term ">Synchronizing E-Mail</span></dt><dd><p>
        Use an IMAP account for storing your e-mails in the office
        network. Then access the e-mails from the workstation using any
        disconnected IMAP-enabled e-mail client, like Mozilla Thunderbird or
        Evolution as described in <span class="intraxref">Book “<em class="citetitle ">GNOME User Guide</em>”</span>. The e-mail
        client must be configured so that the same folder is always accessed
        for <code class="literal">Sent messages</code>. This ensures that all messages
        are available along with their status information after the
        synchronization process has completed. Use an SMTP server implemented
        in the mail client for sending messages instead of the system-wide MTA
        postfix or sendmail to receive reliable feedback about unsent mail.
       </p></dd><dt id="idm140019134576352"><span class="term ">Synchronizing Files and Directories</span></dt><dd><p>
        There are several utilities suitable for synchronizing
        data between a laptop and a workstation. One of the most widely used is
        a command-line tool called <code class="command">rsync</code>. For more
        information, see its manual page (<code class="command">man 1 rsync</code>).
       </p></dd></dl></div></div><div class="sect3 " id="sec.mobile.nbook.soft.wifi"><div class="titlepage"><div><div><h4 class="title" id="sec.mobile.nbook.soft.wifi"><span class="number">27.1.3.3 </span><span class="name">Wireless Communication: Wi-Fi</span> <a title="Permalink" class="permalink" href="#sec.mobile.nbook.soft.wifi">#</a></h4></div></div></div><p>
     With the largest range of these wireless technologies, Wi-Fi is the only
     one suitable for the operation of large and sometimes even spatially
     separate networks. Single machines can connect with each other to form an
     independent wireless network or access the Internet. Devices called
     <span class="emphasis"><em>access points</em></span> act as base stations for Wi-Fi-enabled
     devices and act as intermediaries for access to the Internet. A mobile
     user can switch among access points depending on location and which access
     point is offering the best connection. Like in cellular telephony, a large
     network is available to Wi-Fi users without binding them to a specific
     location for accessing it.
    </p><p>
     Wi-Fi cards communicate using the 802.11 standard, prepared by the IEEE
     organization. Originally, this standard provided for a maximum
     transmission rate of 2 Mbit/s. Meanwhile, several supplements have
     been added to increase the data rate. These supplements define details
     such as the modulation, transmission output, and transmission rates (see
     <a class="xref" href="#tab.mobile.wifistd" title="Overview of Various Wi-Fi Standards">Table 27.2, “Overview of Various Wi-Fi Standards”</a>). Additionally, many companies
     implement hardware with proprietary or draft features.
    </p><div class="table" id="tab.mobile.wifistd"><div class="table-title-wrap"><h6 class="table-title"><span class="number">Table 27.2: </span><span class="name">Overview of Various Wi-Fi Standards </span><a title="Permalink" class="permalink" href="#tab.mobile.wifistd">#</a></h6></div><div class="table-contents"><table summary="Overview of Various Wi-Fi Standards" border="1"><colgroup><col /><col /><col /><col /></colgroup><thead><tr><th>
         <p>
          Name (802.11)
         </p>
        </th><th>
         <p>
          Frequency (GHz)
         </p>
        </th><th>
         <p>
          Maximum Transmission Rate (Mbit/s)
         </p>
        </th><th>
         <p>
          Note
         </p>
        </th></tr></thead><tbody><tr><td>
         <p>
          a
         </p>
        </td><td>
         <p>
          5
         </p>
        </td><td>
         <p>
          54
         </p>
        </td><td>
         <p>
          Less interference-prone
         </p>
        </td></tr><tr><td>
         <p>
          b
         </p>
        </td><td>
         <p>
          2.4
         </p>
        </td><td>
         <p>
          11
         </p>
        </td><td>
         <p>
          Less common
         </p>
        </td></tr><tr><td>
         <p>
          g
         </p>
        </td><td>
         <p>
          2.4
         </p>
        </td><td>
         <p>
          54
         </p>
        </td><td>
         <p>
          Widespread, backward-compatible with 11b
         </p>
        </td></tr><tr><td>
         <p>
          n
         </p>
        </td><td>
         <p>
          2.4 and/or 5
         </p>
        </td><td>
         <p>
          300
          
          
         </p>
        </td><td>
         <p>
          Common
         </p>
        </td></tr><tr><td>
         <p>
          ac
         </p>
        </td><td>
         <p>
          5
         </p>
        </td><td>
         <p>
          up to ~865
         </p>
        </td><td>
         <p>
          Expected to be common in 2015
         </p>
        </td></tr><tr><td>
         <p>
          ad
         </p>
        </td><td>
         <p>
          60
         </p>
        </td><td>
         <p>
          up to appr. 7000
         </p>
        </td><td>
         <p>
          Released 2012, currently less common; not supported in <span class="productname"><span class="phrase">openSUSE Leap</span></span>
         </p>
        </td></tr></tbody></table></div></div><p>
     802.11 Legacy cards are not supported by <span class="productname"><span class="phrase">openSUSE® Leap</span></span>. Most cards
     using 802.11 a/b/g/n are supported. New cards usually comply with the
     802.11n standard, but cards using 802.11g are still available.
    </p><div class="sect4 " id="sec.mobile.wlan.modes"><div class="titlepage"><div><div><h5 class="title" id="sec.mobile.wlan.modes"><span class="number">27.1.3.3.1 </span><span class="name">Operating Modes</span> <a title="Permalink" class="permalink" href="#sec.mobile.wlan.modes">#</a></h5></div></div></div><p>
      In wireless networking, various techniques and configurations are used to
      ensure fast, high-quality, and secure connections. Usually your Wi-Fi
      card operates in <span class="emphasis"><em>managed mode</em></span>. However, different
      operating types need different setups. Wireless networks can be
      classified into four network modes:
     </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019134530992"><span class="term ">Managed Mode (Infrastructure Mode), via Access Point (default mode)</span></dt><dd><p>
         Managed networks have a managing element: the access point. In this
         mode (also called infrastructure or default mode), all connections of
         the Wi-Fi stations in the network run through the access point, which
         may also serve as a connection to an Ethernet. To make sure only
         authorized stations can connect, various authentication mechanisms
         (WPA, etc.) are used. This is also the main mode that consumes the
         least amount of energy.
        </p></dd><dt id="idm140019134528672"><span class="term ">Ad-hoc Mode (Peer-to-Peer Network)</span></dt><dd><p>
         Ad-hoc networks do not have an access point. The stations communicate
         directly with each other, therefore an ad-hoc network is usually
         slower than a managed network. However, the transmission range and
         number of participating stations are greatly limited in ad-hoc
         networks. They also do not support WPA authentication. Additionally,
         not all cards support ad-hoc mode reliably.
        </p></dd><dt id="idm140019134526432"><span class="term ">Master Mode</span></dt><dd><p>
         In master mode, your Wi-Fi card is used as the access point, assuming
         your card supports this mode. Find out the details of your Wi-Fi card
         at <a class="link" href="http://linux-wless.passys.nl" target="_blank">http://linux-wless.passys.nl</a>.
        </p></dd><dt id="idm140019134523904"><span class="term ">Mesh Mode</span></dt><dd><p>
         Wireless mesh networks are organized in a <span class="emphasis"><em>mesh
         topology</em></span>. A wireless mesh network's connection is spread
         among all wireless mesh <span class="emphasis"><em>nodes</em></span>. Each node
         belonging to this network is connected to other nodes to share the
         connection, possibly over a large area. 
        </p></dd></dl></div></div><div class="sect4 " id="sec.mobile.wlan.func.auth"><div class="titlepage"><div><div><h5 class="title" id="sec.mobile.wlan.func.auth"><span class="number">27.1.3.3.2 </span><span class="name">Authentication</span> <a title="Permalink" class="permalink" href="#sec.mobile.wlan.func.auth">#</a></h5></div></div></div><p>
      Because a wireless network is much easier to intercept and compromise
      than a wired network, the various standards include authentication and
      encryption methods.
     </p><p>
      Old Wi-Fi cards support only WEP (Wired Equivalent Privacy). However,
      because WEP has proven to be insecure, the Wi-Fi industry has defined an
      extension called WPA, which is supposed to eliminate the weaknesses of
      WEP. WPA, sometimes synonymous with WPA2, should be the default
      authentication method.
     </p><p>
      Usually the user cannot choose the authentication method. For example,
      when a card operates in managed mode the authentication is set by the
      access point. NetworkManager shows the authentication method.
     </p></div><div class="sect4 " id="sec.mobile.wlan.func.encr"><div class="titlepage"><div><div><h5 class="title" id="sec.mobile.wlan.func.encr"><span class="number">27.1.3.3.3 </span><span class="name">Encryption</span> <a title="Permalink" class="permalink" href="#sec.mobile.wlan.func.encr">#</a></h5></div></div></div><p>
      There are various encryption methods to ensure that no unauthorized
      person can read the data packets that are exchanged in a wireless network
      or gain access to the network:
     </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019134515104"><span class="term ">WEP (defined in IEEE 802.11)</span></dt><dd><p>
         This standard uses the RC4 encryption algorithm, originally with a key
         length of 40 bits, later also with 104 bits. Often, the
         length is declared as 64 bits or 128 bits, depending on
         whether the 24 bits of the initialization vector are included.
         However, this standard has some weaknesses. Attacks against the keys
         generated by this system may be successful. Nevertheless, it is better
         to use WEP than not to encrypt the network.
        </p><p>
         Some vendors have implemented the non-standard <span class="quote">“<span class="quote">Dynamic
         WEP</span>”</span>. It works exactly as WEP and shares the same weaknesses,
         except that the key is periodically changed by a key management
         service.
        </p></dd><dt id="idm140019134511760"><span class="term ">TKIP (defined in WPA/IEEE 802.11i)</span></dt><dd><p>
         This key management protocol defined in the WPA standard uses the same
         encryption algorithm as WEP, but eliminates its weakness. Because a
         new key is generated for every data packet, attacks against these keys
         are fruitless. TKIP is used together with WPA-PSK.
        </p></dd><dt id="idm140019134509664"><span class="term ">CCMP (defined in IEEE 802.11i)</span></dt><dd><p>
         CCMP describes the key management. Usually, it is used in connection
         with WPA-EAP, but it can also be used with WPA-PSK. The encryption
         takes place according to AES and is stronger than the RC4 encryption
         of the WEP standard.
        </p></dd></dl></div></div></div><div class="sect3 " id="sec.mobile.nbook.soft.bluetooth"><div class="titlepage"><div><div><h4 class="title" id="sec.mobile.nbook.soft.bluetooth"><span class="number">27.1.3.4 </span><span class="name">Wireless Communication: Bluetooth</span> <a title="Permalink" class="permalink" href="#sec.mobile.nbook.soft.bluetooth">#</a></h4></div></div></div><p>
     Bluetooth has the broadest application spectrum of all
     wireless technologies. It can be used for communication between computers
     (laptops) and PDAs or cellular phones, as can IrDA. It can also be used to
     connect various computers within range. Bluetooth is also used to connect
     wireless system components, like a keyboard or a mouse. The range of this
     technology is, however, not sufficient to connect remote systems to a
     network. Wi-Fi is the technology of choice for communicating through
     physical obstacles like walls.

    </p></div><div class="sect3 " id="sec.mobile.nbook.soft.irda"><div class="titlepage"><div><div><h4 class="title" id="sec.mobile.nbook.soft.irda"><span class="number">27.1.3.5 </span><span class="name">Wireless Communication: IrDA</span> <a title="Permalink" class="permalink" href="#sec.mobile.nbook.soft.irda">#</a></h4></div></div></div><p>
     IrDA is the wireless technology with the shortest range. Both
     communication parties must be within viewing distance of each other.
     Obstacles like walls cannot be overcome. One possible application of IrDA
     is the transmission of a file from a laptop to a cellular phone. The short
     path from the laptop to the cellular phone is then covered using IrDA.
     Long-range transmission of the file to the recipient is handled by the
     mobile network. Another application of IrDA is the wireless transmission
     of printing jobs in the office.

    </p></div></div><div class="sect2 " id="sec.mobile.nbook.sec"><div class="titlepage"><div><div><h3 class="title" id="sec.mobile.nbook.sec"><span class="number">27.1.4 </span><span class="name">Data Security</span> <a title="Permalink" class="permalink" href="#sec.mobile.nbook.sec">#</a></h3></div></div></div><p>
    Ideally, you protect data on your laptop against unauthorized access in
    multiple ways. Possible security measures can be taken in the following
    areas:
   </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019134500144"><span class="term ">Protection against Theft</span></dt><dd><p>
       Always physically secure your system against theft whenever possible.
       Various securing tools (like chains) are available in retail stores.
      </p></dd><dt id="idm140019134498192"><span class="term ">Strong Authentication</span></dt><dd><p>
       Use biometric authentication in addition to standard authentication via
       login and password. <span class="productname"><span class="phrase">openSUSE Leap</span></span> supports fingerprint authentication.

      </p></dd><dt id="idm140019134495152"><span class="term ">Securing Data on the System</span></dt><dd><p>
       Important data should not only be encrypted during transmission, but
       also on the hard disk. This ensures its safety in case of theft. The
       creation of an encrypted partition with <span class="productname"><span class="phrase">openSUSE Leap</span></span> is described in
       <span class="intraxref">Book “<em class="citetitle ">Security Guide</em>”, Chapter 11 “Encrypting Partitions and Files”</span>. Another possibility is to
       create encrypted home directories when adding the user with YaST.
      </p><div id="idm140019134491680" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.png" /><h6>Important: Data Security and Suspend to Disk</h6><p>
        Encrypted partitions are not unmounted during a suspend to disk event.
        Thus, all data on these partitions is available to any party who
        manages to steal the hardware and issue a resume of the hard disk.
       </p></div></dd><dt id="idm140019134489776"><span class="term ">Network Security</span></dt><dd><p>
       Any transfer of data should be secured, no matter how the transfer is
       done. Find general security issues regarding Linux and networks in
       <span class="intraxref">Book “<em class="citetitle ">Security Guide</em>”, Chapter 1 “Security and Confidentiality”</span>.
      </p></dd></dl></div></div></div><div class="sect1 " id="sec.mobile.hw"><div class="titlepage"><div><div><h2 class="title" id="sec.mobile.hw"><span class="number">27.2 </span><span class="name">Mobile Hardware</span> <a title="Permalink" class="permalink" href="#sec.mobile.hw">#</a></h2></div></div></div><p>
   <span class="productname"><span class="phrase">openSUSE Leap</span></span> supports the automatic detection of mobile storage devices
   over FireWire (IEEE 1394) or USB. The term <span class="emphasis"><em>mobile storage
   device</em></span> applies to any kind of FireWire or USB hard disk, flash
   disk, or digital camera. These devices are automatically detected and
   configured when they are connected with the system over the corresponding
   interface. The file manager of GNOME offers flexible handling of mobile
   hardware items. To unmount any of these media safely, use the
   <span class="guimenu">Unmount Volume</span> (GNOME) feature of the file manager. For
   more details refer to <span class="intraxref">Book “<em class="citetitle ">GNOME User Guide</em>”</span>.
  </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019134481824"><span class="term ">External Hard Disks (USB and FireWire)</span></dt><dd><p>
      When an external hard disk is correctly recognized by the system, its
      icon appears in the file manager. Clicking the icon displays the contents
      of the drive. It is possible to create directories and files here and
      edit or delete them. To rename a hard disk, select the corresponding menu
      item from the right-click contextual menu. This name change is limited to display in
      the file manager. The descriptor by which the device is mounted in
      <code class="filename">/media</code> remains unaffected.
     </p></dd><dt id="idm140019134478448"><span class="term ">USB Flash Disks</span></dt><dd><p>
      These devices are handled by the system like external hard disks. It is
      similarly possible to rename the entries in the file manager.
     </p></dd><dt id="idm140019134476512"><span class="term ">Digital Cameras (USB and FireWire)</span></dt><dd><p>
      Digital cameras recognized by the system also appear as external drives
      in the overview of the file manager. The images can then be processed
      using Shotwell. For advanced photo processing use The GIMP. For a short
      introduction to The GIMP, see <span class="intraxref">Book “<em class="citetitle ">GNOME User Guide</em>”, Chapter 18 “GIMP: Manipulating Graphics”</span>.
     </p></dd></dl></div></div><div class="sect1 " id="sec.mobile.comm"><div class="titlepage"><div><div><h2 class="title" id="sec.mobile.comm"><span class="number">27.3 </span><span class="name">Cellular Phones and PDAs</span> <a title="Permalink" class="permalink" href="#sec.mobile.comm">#</a></h2></div></div></div><p>
   A desktop system or a laptop can communicate with a cellular phone via
   Bluetooth or IrDA. Some models support both protocols and some only one of
   the two. The usage areas for the two protocols and the corresponding
   extended documentation has already been mentioned in
   <a class="xref" href="#sec.mobile.nbook.soft.wifi" title="27.1.3.3. Wireless Communication: Wi-Fi">Section 27.1.3.3, “Wireless Communication: Wi-Fi”</a>. The configuration of these
   protocols on the cellular phones themselves is described in their manuals.
  </p></div><div class="sect1 " id="sec.mobile.info"><div class="titlepage"><div><div><h2 class="title" id="sec.mobile.info"><span class="number">27.4 </span><span class="name">For More Information</span> <a title="Permalink" class="permalink" href="#sec.mobile.info">#</a></h2></div></div></div><p>
   The central point of reference for all questions regarding mobile devices
   and Linux is <a class="link" href="http://tuxmobil.org/" target="_blank">http://tuxmobil.org/</a>. Various sections of
   that Web site deal with the hardware and software aspects of laptops, PDAs,
   cellular phones and other mobile hardware.
  </p><p>
   A similar approach to that of <a class="link" href="http://tuxmobil.org/" target="_blank">http://tuxmobil.org/</a> is
   made by <a class="link" href="http://www.linux-on-laptops.com/" target="_blank">http://www.linux-on-laptops.com/</a>. Information
   about laptops and handhelds can be found here.
  </p><p>
   SUSE maintains a mailing list in German dedicated to the subject of
   laptops. See
   <a class="link" href="http://lists.opensuse.org/opensuse-mobile-de/" target="_blank">http://lists.opensuse.org/opensuse-mobile-de/</a>. On this
   list, users and developers discuss all aspects of mobile computing with
   <span class="productname"><span class="phrase">openSUSE Leap</span></span>. Postings in English are answered, but the majority of the
   archived information is only available in German. Use
   <a class="link" href="http://lists.opensuse.org/opensuse-mobile/" target="_blank">http://lists.opensuse.org/opensuse-mobile/</a> for English
   postings.
  </p></div></div><div class="chapter " id="cha.nm"><div class="titlepage"><div><div><h2 class="title"><span class="number">28 </span><span class="name">Using NetworkManager</span> <a title="Permalink" class="permalink" href="#cha.nm">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">Filename: </span>nm.xml</li><li><span class="ds-label">ID: </span>cha.nm</li></ul></div></div></div></div><div class="line"><div class="toc"><dl><dt><span class="sect1"><a href="#sec.nm.usecase"><span class="number">28.1 </span><span class="name">Use Cases for NetworkManager</span></a></span></dt><dt><span class="sect1"><a href="#sec.nm.activate"><span class="number">28.2 </span><span class="name">Enabling or Disabling NetworkManager</span></a></span></dt><dt><span class="sect1"><a href="#sec.nm.configure"><span class="number">28.3 </span><span class="name">Configuring Network Connections</span></a></span></dt><dt><span class="sect1"><a href="#sec.nm.security"><span class="number">28.4 </span><span class="name">NetworkManager and Security</span></a></span></dt><dt><span class="sect1"><a href="#sec.nm.faq"><span class="number">28.5 </span><span class="name">Frequently Asked Questions</span></a></span></dt><dt><span class="sect1"><a href="#sec.nm.trouble"><span class="number">28.6 </span><span class="name">Troubleshooting</span></a></span></dt><dt><span class="sect1"><a href="#sec.nm.more"><span class="number">28.7 </span><span class="name">For More Information</span></a></span></dt></dl></div></div><p>
  NetworkManager is the ideal solution for laptops and other portable computers. It
  supports state-of-the-art encryption types and standards for network
  connections, including connections to 802.1X protected networks. 802.1X is
  the <span class="quote">“<span class="quote">IEEE Standard for Local and Metropolitan Area
  Networks—Port-Based Network Access Control</span>”</span>. With NetworkManager, you need
  not worry about configuring network interfaces and switching between wired or
  wireless networks when you are moving. NetworkManager can automatically connect to
  known wireless networks or manage several network connections in
  parallel—the fastest connection is then used as default. Furthermore,
  you can manually switch between available networks and manage your network
  connection using an applet in the system tray.

 </p><p>
  Instead of only one connection being active, multiple connections may be
  active at once. This enables you to unplug your laptop from an Ethernet and
  remain connected via a wireless connection.
 </p><div class="sect1 " id="sec.nm.usecase"><div class="titlepage"><div><div><h2 class="title" id="sec.nm.usecase"><span class="number">28.1 </span><span class="name">Use Cases for NetworkManager</span> <a title="Permalink" class="permalink" href="#sec.nm.usecase">#</a></h2></div></div></div><p>
   NetworkManager provides a sophisticated and intuitive user interface, which enables
   users to easily switch their network environment. However, NetworkManager is not a
   suitable solution in the following cases:
  </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
     Your computer provides network services for other computers in your
     network, for example, it is a DHCP or DNS server.
    </p></li><li class="listitem "><p>
     Your computer is a Xen server or your system is a virtual system inside
     Xen.
    </p></li></ul></div></div><div class="sect1 " id="sec.nm.activate"><div class="titlepage"><div><div><h2 class="title" id="sec.nm.activate"><span class="number">28.2 </span><span class="name">Enabling or Disabling NetworkManager</span> <a title="Permalink" class="permalink" href="#sec.nm.activate">#</a></h2></div></div></div><p>
   On laptop computers, NetworkManager is enabled by default. However, it can be at any
   time enabled or disabled in the YaST Network Settings module.
  </p><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
     Run YaST and go to <span class="guimenu">System</span> › <span class="guimenu">Network Settings</span>.
    </p></li><li class="step "><p>
     The <span class="guimenu">Network Settings</span> dialog opens. Go to the
     <span class="guimenu">Global Options</span> tab.
    </p></li><li class="step "><p>
     To configure and manage your network connections with NetworkManager:
    </p><ol type="a" class="substeps "><li class="step "><p>
       In the <span class="guimenu">Network Setup Method</span> field, select
       <span class="guimenu">User Controlled with NetworkManager</span>.
      </p></li><li class="step "><p>
       Click <span class="guimenu">OK</span> and close YaST.
      </p></li><li class="step "><p>
       Configure your network connections with NetworkManager as described in
       <a class="xref" href="#sec.nm.configure" title="28.3. Configuring Network Connections">Section 28.3, “Configuring Network Connections”</a>.
      </p></li></ol></li><li class="step "><p>
     To deactivate NetworkManager and control the network with your own configuration
    </p><ol type="a" class="substeps "><li class="step "><p>
       In the <span class="guimenu">Network Setup Method</span> field, choose
       <span class="guimenu">Controlled by wicked</span>.
      </p></li><li class="step "><p>
       Click <span class="guimenu">OK</span>.
      </p></li><li class="step "><p>
       Set up your network card with YaST using automatic configuration via
       DHCP or a static IP address.
      </p><p>
       Find a detailed description of the network configuration with YaST in
       <a class="xref" href="#sec.network.yast" title="13.4. Configuring a Network Connection with YaST">Section 13.4, “Configuring a Network Connection with YaST”</a>.
      </p></li></ol></li></ol></div></div></div><div class="sect1 " id="sec.nm.configure"><div class="titlepage"><div><div><h2 class="title" id="sec.nm.configure"><span class="number">28.3 </span><span class="name">Configuring Network Connections</span> <a title="Permalink" class="permalink" href="#sec.nm.configure">#</a></h2></div></div></div><p>
   After having enabled NetworkManager in YaST, configure your network connections with
   the NetworkManager front-end available in GNOME. It shows tabs for all types of
   network connections, such as wired, wireless, mobile broadband, DSL, and VPN
   connections.
  </p><p>
   To open the network configuration dialog in GNOME, open the settings menu
   via the status menu and click the <span class="guimenu">Network</span> entry.
  </p><div id="idm140019134429728" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note: Availability of Options</h6><p>
    Depending on your system setup, you may not be allowed to configure
    connections. In a secured environment, some options may be locked or
    require <code class="systemitem">root</code> permission. Ask your system administrator for details.
   </p></div><div class="figure" id="idm140019134427472"><div class="figure-contents"><div class="mediaobject"><a xmlns="" href="images/nm_gnome_tabs.png"><img src="images/nm_gnome_tabs.png" width="" alt="GNOME Network Connections Dialog" /></a></div></div><div class="figure-title-wrap"><h6 class="figure-title"><span class="number">Figure 28.1: </span><span class="name">GNOME Network Connections Dialog </span><a title="Permalink" class="permalink" href="#idm140019134427472">#</a></h6></div></div><div class="procedure " id="pro.nm.configure.add"><div class="procedure-title-wrap"><h6 class="procedure-title"><span class="number">Procedure 28.1: </span><span class="name">Adding and Editing Connections </span><a title="Permalink" class="permalink" href="#pro.nm.configure.add">#</a></h6></div><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
     Open the NetworkManager configuration dialog.
    </p></li><li class="step "><p>
     To add a Connection:
    </p><ol type="a" class="substeps "><li class="step "><p>
       Click the <span class="guimenu">+</span> icon in the lower left corner.
      </p></li><li class="step "><p>
       Select your preferred connection type and follow the instructions.
      </p></li><li class="step "><p>
       When you are finished click <span class="guimenu">Add</span>.
      </p></li><li class="step "><p>
       After having confirmed your changes, the newly configured network
       connection appears in the list of available networks you get by opening
       the Status Menu.
      </p></li></ol></li><li class="step "><p>
     To edit a connection:
    </p><ol type="a" class="substeps "><li class="step "><p>
       Select the entry to edit.
      </p></li><li class="step "><p>
       Click the gear icon to open the <span class="guimenu">Connection Settings</span>
       dialog.
      </p></li><li class="step "><p>
       Insert your changes and click <span class="guimenu">Apply</span> to save them.
      </p></li><li class="step "><p>
       To Make your connection available as system connection go to the
       <span class="guimenu">Identity</span> tab and set the check box <span class="guimenu">Make
       available to other users</span>. For more information about User and
       System Connections, see <a class="xref" href="#sec.nm.sec.types" title="28.4.1. User and System Connections">Section 28.4.1, “User and System Connections”</a>.
      </p></li></ol></li></ol></div></div><div class="sect2 " id="sec.nm.gome.applet.wired"><div class="titlepage"><div><div><h3 class="title" id="sec.nm.gome.applet.wired"><span class="number">28.3.1 </span><span class="name">Managing Wired Network Connections</span> <a title="Permalink" class="permalink" href="#sec.nm.gome.applet.wired">#</a></h3></div></div></div><p>
    If your computer is connected to a wired network, use the NetworkManager applet to
    manage the connection.
   </p><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
      Open the Status Menu and click <span class="guimenu">Wired</span> to change the
      connection details or to switch it off.
     </p></li><li class="step "><p>
      To change the settings click <span class="guimenu">Wired Settings</span> and then
      click the gear icon.
     </p></li><li class="step "><p>
      To switch off all network connections, activate the <span class="guimenu">Airplane
      Mode</span> setting.
     </p></li></ol></div></div></div><div class="sect2 " id="sec.nm.gnome.applet.wireless"><div class="titlepage"><div><div><h3 class="title" id="sec.nm.gnome.applet.wireless"><span class="number">28.3.2 </span><span class="name">Managing Wireless Network Connections</span> <a title="Permalink" class="permalink" href="#sec.nm.gnome.applet.wireless">#</a></h3></div></div></div><p>
    Visible wireless networks are listed in the GNOME NetworkManager applet menu under
    <span class="guimenu">Wireless Networks</span>. The signal strength of each network
    is also shown in the menu. Encrypted wireless networks are marked with a
    shield icon.
   </p><div class="procedure " id="idm140019134397696"><div class="procedure-title-wrap"><h6 class="procedure-title"><span class="number">Procedure 28.2: </span><span class="name">Connecting to a visible Wireless Network </span><a title="Permalink" class="permalink" href="#idm140019134397696">#</a></h6></div><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
      To connect to a visible wireless network, open the Status Menu and click
      <span class="guimenu">Wi-Fi</span>.
     </p></li><li class="step "><p>
      Click <span class="guimenu">Turn On</span> to enable it.
     </p></li><li class="step "><p>
      Click <span class="guimenu">Select Network</span>, select your Wi-Fi Network and
      click <span class="guimenu">Connect</span>.
     </p></li><li class="step "><p>
      If the network is encrypted, a configuration dialog opens. It shows the
      type of encryption the network uses and text boxes for entering the login
      credentials.
     </p></li></ol></div></div><div class="procedure " id="idm140019134391136"><div class="procedure-title-wrap"><h6 class="procedure-title"><span class="number">Procedure 28.3: </span><span class="name">Connecting to an Invisible Wireless Network </span><a title="Permalink" class="permalink" href="#idm140019134391136">#</a></h6></div><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
      To connect to a network that does not broadcast its service set
      identifier (SSID or ESSID) and therefore cannot be detected
      automatically, open the Status Menu and click <span class="guimenu">Wi-Fi</span>.
     </p></li><li class="step "><p>
      Click <span class="guimenu">Wi-Fi Settings</span> to open the detailed settings
      menu.
     </p></li><li class="step "><p>
      Make sure your Wi-Fi is enabled and click <span class="guimenu">Connect to Hidden
      Network</span>.
     </p></li><li class="step "><p>
      In the dialog that opens, enter the SSID or ESSID in <span class="guimenu">Network
      Name</span> and set encryption parameters if necessary.
     </p></li></ol></div></div><p>
    A wireless network that has been chosen explicitly will remain connected as
    long as possible. If a network cable is plugged in during that time, any
    connections that have been set to <span class="guimenu">Stay connected when
    possible</span> will be connected, while the wireless connection remains
    up.
   </p></div><div class="sect2 " id="sec.nm.gnome.applet.accesspoint"><div class="titlepage"><div><div><h3 class="title" id="sec.nm.gnome.applet.accesspoint"><span class="number">28.3.3 </span><span class="name">Configuring Your Wi-Fi/Bluetooth Card as an Access Point</span> <a title="Permalink" class="permalink" href="#sec.nm.gnome.applet.accesspoint">#</a></h3></div></div></div><p>
    If your Wi-Fi/Bluetooth card supports access point mode, you can use NetworkManager
    for the configuration.
   </p><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
      Open the Status Menu and click <span class="guimenu">Wi-Fi</span>.
     </p></li><li class="step "><p>
      Click <span class="guimenu">Wi-Fi Settings</span> to open the detailed settings
      menu.
     </p></li><li class="step "><p>
      Click <span class="guimenu">Use as Hotspot</span> and follow the instructions.
     </p></li><li class="step "><p>
      Use the credentials shown in the resulting dialog to connect to the
      hotspot from a remote machine.
     </p></li></ol></div></div></div><div class="sect2 " id="sec.nm.vpn"><div class="titlepage"><div><div><h3 class="title" id="sec.nm.vpn"><span class="number">28.3.4 </span><span class="name">NetworkManager and VPN</span> <a title="Permalink" class="permalink" href="#sec.nm.vpn">#</a></h3></div></div></div><p>
    NetworkManager supports several Virtual Private Network (VPN) technologies. For each
    technology, <span class="productname"><span class="phrase">openSUSE Leap</span></span> comes with a base package providing the generic
    support for NetworkManager. In addition to that, you also need to install the
    respective desktop-specific package for your applet.
   </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019134372416"><span class="term ">OpenVPN</span></dt><dd><p>
       To use this VPN technology, install:
      </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
         <code class="systemitem">NetworkManager-openvpn</code>
        </p></li><li class="listitem "><p>
         <code class="systemitem">NetworkManager-openvpn-gnome</code>
        </p></li></ul></div></dd><dt id="idm140019134366352"><span class="term ">openconnect</span></dt><dd><p>
       To use this VPN technology, install:
      </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
         <code class="systemitem">NetworkManager-openconnect</code>
        </p></li><li class="listitem "><p>
         <code class="systemitem">NetworkManager-openconnect-gnome</code>
        </p></li></ul></div></dd><dt id="idm140019134360272"><span class="term ">PPTP (Point-to-Point Tunneling Protocol)</span></dt><dd><p>
       To use this VPN technology, install:
      </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
         <code class="systemitem">NetworkManager-pptp</code>
        </p></li><li class="listitem "><p>
         <code class="systemitem">NetworkManager-pptp-gnome</code>
        </p></li></ul></div></dd></dl></div><p>
    The following procedure describes how to set up your computer as an OpenVPN
    client using NetworkManager. Setting up other types of VPNs works analogously.
   </p><p>
    Before you begin, make sure that the package
    <code class="systemitem">NetworkManager-openvpn-gnome</code> is
    installed and all dependencies have been resolved.
   </p><div class="procedure " id="idm140019134352160"><div class="procedure-title-wrap"><h6 class="procedure-title"><span class="number">Procedure 28.4: </span><span class="name">Setting Up OpenVPN with NetworkManager </span><a title="Permalink" class="permalink" href="#idm140019134352160">#</a></h6></div><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
      Open the application <span class="guimenu">Settings</span> by clicking the status
      icons at the right end of the panel and clicking the <span class="guimenu">wrench and
      screwdriver</span> icon. In the window
      <span class="guimenu">All Settings</span>, choose <span class="guimenu">Network</span>.
     </p></li><li class="step "><p>
      Click the <span class="guimenu">+</span> icon.
     </p></li><li class="step "><p>
      Select <span class="guimenu">VPN</span> and then <span class="guimenu">OpenVPN</span>.
     </p></li><li class="step "><p>
      Choose the <span class="guimenu">Authentication</span> type. Depending on the
      setup of your OpenVPN server, choose <span class="guimenu">Certificates
      (TLS)</span> or <span class="guimenu">Password with Certificates (TLS)</span>.
     </p></li><li class="step "><p>
      Insert the necessary values into the respective text boxes. For our
      example configuration, these are:
     </p><div class="informaltable"><table border="1"><colgroup><col class="field" /><col class="desc" /></colgroup><tbody><tr><td>
          <p>
           <span class="guimenu">Gateway</span>
          </p>
         </td><td>
          <p>
           The remote endpoint of the VPN server
          </p>
         </td></tr><tr><td>
          <p>
           <span class="guimenu">User name</span>
          </p>
         </td><td>
          <p>
           The user (only available when you have selected <span class="guimenu">Password
           with Certificates (TLS)</span>)
          </p>
         </td></tr><tr><td>
          <p>
           <span class="guimenu">Password</span>
          </p>
         </td><td>
          <p>
           The password for the user (only available when you have selected
           <span class="guimenu">Password with Certificates (TLS)</span>)
          </p>
         </td></tr><tr><td>
          <p>
           <span class="guimenu">User Certificate</span>
          </p>
         </td><td>
          <p>
           <code class="filename">/etc/openvpn/client1.crt</code>
          </p>
         </td></tr><tr><td>
          <p>
           <span class="guimenu">CA Certificate</span>
          </p>
         </td><td>
          <p>
           <code class="filename">/etc/openvpn/ca.crt</code>
          </p>
         </td></tr><tr><td>
          <p>
           <span class="guimenu">Private Key</span>
          </p>
         </td><td>
          <p>
           <code class="filename">/etc/openvpn/client1.key</code>
          </p>
         </td></tr></tbody></table></div></li><li class="step "><p>
      Finish the configuration with <span class="guimenu">Add</span>.
     </p></li><li class="step "><p>
      To enable the connection, in the <span class="guimenu">Network</span> panel of the
      <span class="guimenu">Settings</span> application click the switch button.
      Alternatively, click the status icons at the right end of the panel, click
      the name of your VPN and then <span class="guimenu">Connect</span>.
     </p></li></ol></div></div></div></div><div class="sect1 " id="sec.nm.security"><div class="titlepage"><div><div><h2 class="title" id="sec.nm.security"><span class="number">28.4 </span><span class="name">NetworkManager and Security</span> <a title="Permalink" class="permalink" href="#sec.nm.security">#</a></h2></div></div></div><p>
   NetworkManager distinguishes two types of wireless connections, trusted and untrusted.
   A trusted connection is any network that you explicitly selected in the
   past. All others are untrusted. Trusted connections are identified by the
   name and MAC address of the access point. Using the MAC address ensures that
   you cannot use a different access point with the name of your trusted
   connection.
  </p><p>
   NetworkManager periodically scans for available wireless networks. If multiple trusted
   networks are found, the most recently used is automatically selected. NetworkManager
   waits for your selection in case that all networks are untrusted.
  </p><p>
   If the encryption setting changes but the name and MAC address remain the
   same, NetworkManager attempts to connect, but first you are asked to confirm the new
   encryption settings and provide any updates, such as a new key.
  </p><p>
   If you switch from using a wireless connection to offline mode,
   NetworkManager blanks the SSID or ESSID. This ensures that the card is
   disconnected.
  </p><div class="sect2 " id="sec.nm.sec.types"><div class="titlepage"><div><div><h3 class="title" id="sec.nm.sec.types"><span class="number">28.4.1 </span><span class="name">User and System Connections</span> <a title="Permalink" class="permalink" href="#sec.nm.sec.types">#</a></h3></div></div></div><p>
    NetworkManager knows two types of connections: <code class="literal">user</code> and
    <code class="literal">system</code> connections. User connections are connections
    that become available to NetworkManager when the first user logs in. Any required
    credentials are asked from the user and when the user logs out, the
    connections are disconnected and removed from NetworkManager. Connections that are
    defined as system connection can be shared by all users and are made
    available right after NetworkManager is started—before any users log in. In
    case of system connections, all credentials must be provided at the time
    the connection is created. Such system connections can be used to
    automatically connect to networks that require authorization. For
    information how to configure user or system connections with NetworkManager, refer to
    <a class="xref" href="#sec.nm.configure" title="28.3. Configuring Network Connections">Section 28.3, “Configuring Network Connections”</a>.
   </p></div><div class="sect2 " id="sec.nm.sec.store"><div class="titlepage"><div><div><h3 class="title" id="sec.nm.sec.store"><span class="number">28.4.2 </span><span class="name">Storing Passwords and Credentials</span> <a title="Permalink" class="permalink" href="#sec.nm.sec.store">#</a></h3></div></div></div><p>
    If you do not want to re-enter your credentials each time you want to
    connect to an encrypted network, you can use the GNOME Keyring Manager to
    store your credentials encrypted on the disk, secured by a master password.
   </p><p>
    NetworkManager can also retrieve its certificates for secure connections (for
    example, encrypted wired, wireless or VPN connections) from the certificate
    store. For more information, refer to <span class="intraxref">Book “<em class="citetitle ">Security Guide</em>”, Chapter 12 “Certificate Store”</span>.
   </p></div></div><div class="sect1 " id="sec.nm.faq"><div class="titlepage"><div><div><h2 class="title" id="sec.nm.faq"><span class="number">28.5 </span><span class="name">Frequently Asked Questions</span> <a title="Permalink" class="permalink" href="#sec.nm.faq">#</a></h2></div></div></div><p>
   In the following, find some frequently asked questions about configuring
   special network options with NetworkManager.
  </p><div class="qandaset" id="idm140019134302320"><div class="free-id" id="idm140019134302032"></div><dl class="qandaentry"><dt class="question" id="idm140019134301744">
      How to tie a connection to a specific device?
     </dt><dd class="answer" id="idm140019134300800"><p>
      By default, connections in NetworkManager are device type-specific: they apply to
      all physical devices with the same type. If more than one physical device
      per connection type is available (for example, your machine is equipped
      with two Ethernet cards), you can tie a connection to a certain device.

     </p><p>
      To do this in GNOME, first look up the MAC address of your device (use
      the <span class="guimenu">Connection Information</span> available from the applet,
      or use the output of command line tools like <code class="command">nm-tool</code>
      or <code class="command">wicked show all</code>). Then start the dialog for
      configuring network connections and choose the connection you want to
      modify. On the <span class="guimenu">Wired</span> or <span class="guimenu">Wireless</span>
      tab, enter the <span class="guimenu">MAC Address</span> of the device and confirm
      your changes.
     </p></dd></dl><div class="free-id" id="idm140019134296000"></div><dl class="qandaentry"><dt class="question" id="idm140019134295712">
      How to specify a certain access point in case multiple access points with
      the same ESSID are detected?
     </dt><dd class="answer" id="idm140019134294704"><p>
      When multiple access points with different wireless bands (a/b/g/n) are
      available, the access point with the strongest signal is automatically
      chosen by default. To override this, use the <span class="guimenu">BSSID</span>
      field when configuring wireless connections.
     </p><p>
      The Basic Service Set Identifier (BSSID) uniquely identifies each Basic
      Service Set. In an infrastructure Basic Service Set, the BSSID is the MAC
      address of the wireless access point. In an independent (ad-hoc) Basic
      Service Set, the BSSID is a locally administered MAC address generated
      from a 46-bit random number.
     </p><p>
      Start the dialog for configuring network connections as described in
      <a class="xref" href="#sec.nm.configure" title="28.3. Configuring Network Connections">Section 28.3, “Configuring Network Connections”</a>. Choose the wireless connection you
      want to modify and click <span class="guimenu">Edit</span>. On the
      <span class="guimenu">Wireless</span> tab, enter the BSSID.
     </p></dd></dl><div class="free-id" id="idm140019134290144"></div><dl class="qandaentry"><dt class="question" id="idm140019134289856">
      How to share network connections to other computers?
     </dt><dd class="answer" id="idm140019134288912"><p>
      The primary device (the device which is connected to the Internet) does
      not need any special configuration. However, you need to configure the
      device that is connected to the local hub or machine as follows:
     </p><div class="orderedlist "><ol class="orderedlist" type="1"><li class="listitem "><p>
        Start the dialog for configuring network connections as described in
        <a class="xref" href="#sec.nm.configure" title="28.3. Configuring Network Connections">Section 28.3, “Configuring Network Connections”</a>. Choose the connection you want to
        modify and click <span class="guimenu">Edit</span>. Switch to the <span class="guimenu">IPv4
        Settings</span> tab and from the <span class="guimenu">Method</span> drop-down
        box, activate <span class="guimenu">Shared to other computers</span>. That will
        enable IP traffic forwarding and run a DHCP server on the device.
        Confirm your changes in NetworkManager.
       </p></li><li class="listitem "><p>
        As the DCHP server uses port <code class="literal">67</code>, make sure that it
        is not blocked by the firewall: On the machine sharing the connections,
        start YaST and select <span class="guimenu">Security and
        Users</span> › <span class="guimenu">Firewall</span>. Switch to
        the <span class="guimenu">Allowed Services</span> category. If <span class="guimenu">DCHP
        Server</span> is not already shown as <span class="guimenu">Allowed
        Service</span>, select <span class="guimenu">DCHP Server</span> from
        <span class="guimenu">Services to Allow</span> and click <span class="guimenu">Add</span>.
        Confirm your changes in YaST.
       </p></li></ol></div></dd></dl><div class="free-id" id="idm140019134277808"></div><dl class="qandaentry"><dt class="question" id="idm140019134277520">
      How to provide static DNS information with automatic (DHCP, PPP, VPN)
      addresses?
     </dt><dd class="answer" id="idm140019134276544"><p>
      In case a DHCP server provides invalid DNS information (and/or routes),
      you can override it. Start the dialog for configuring network connections
      as described in <a class="xref" href="#sec.nm.configure" title="28.3. Configuring Network Connections">Section 28.3, “Configuring Network Connections”</a>. Choose the connection
      you want to modify and click <span class="guimenu">Edit</span>. Switch to the
      <span class="guimenu">IPv4 Settings</span> tab, and from the
      <span class="guimenu">Method</span> drop-down box, activate <span class="guimenu">Automatic
      (DHCP) addresses only</span>. Enter the DNS information in the
      <span class="guimenu">DNS Servers</span> and <span class="guimenu">Search Domains</span>
      fields. To <span class="guimenu">Ignore automatically obtained routes</span> click
      <span class="guimenu">Routes</span> and activate the respective check box. Confirm
      your changes.
     </p></dd></dl><div class="free-id" id="idm140019134270976"></div><dl class="qandaentry"><dt class="question" id="idm140019134270688">
      How to make NetworkManager connect to password protected networks before a user
      logs in?
     </dt><dd class="answer" id="idm140019134269696"><p>
      Define a <code class="literal">system connection</code> that can be used for such
      purposes. For more information, refer to
      <a class="xref" href="#sec.nm.sec.types" title="28.4.1. User and System Connections">Section 28.4.1, “User and System Connections”</a>.
     </p></dd></dl></div></div><div class="sect1 " id="sec.nm.trouble"><div class="titlepage"><div><div><h2 class="title" id="sec.nm.trouble"><span class="number">28.6 </span><span class="name">Troubleshooting</span> <a title="Permalink" class="permalink" href="#sec.nm.trouble">#</a></h2></div></div></div><p>
   Connection problems can occur. Some common problems related to NetworkManager include
   the applet not starting or a missing VPN option. Methods for resolving and
   preventing these problems depend on the tool used.
  </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019134265136"><span class="term ">NetworkManager Desktop Applet Does Not Start</span></dt><dd><p>
      The applets starts automatically if the network is set up for NetworkManager
      control. If the applet does not start, check if NetworkManager is enabled in YaST
      as described in <a class="xref" href="#sec.nm.activate" title="28.2. Enabling or Disabling NetworkManager">Section 28.2, “Enabling or Disabling NetworkManager”</a>. Then make sure that
      the NetworkManager-gnome package is also installed.
     </p><p>
      If the desktop applet is installed but is not running for some reason,
      start it manually. If the desktop applet is installed but is not running
      for some reason, start it manually with the command
      <code class="command">nm-applet</code>.
     </p></dd><dt id="idm140019134261408"><span class="term ">NetworkManager Applet Does Not Include the VPN Option</span></dt><dd><p>
      Support for NetworkManager, applets, and VPN for NetworkManager is distributed in separate
      packages. If your NetworkManager applet does not include the VPN option, check if
      the packages with NetworkManager support for your VPN technology are installed. For
      more information, see <a class="xref" href="#sec.nm.vpn" title="28.3.4. NetworkManager and VPN">Section 28.3.4, “NetworkManager and VPN”</a>.
     </p></dd><dt id="idm140019134258736"><span class="term ">No Network Connection Available</span></dt><dd><p>
      If you have configured your network connection correctly and all other
      components for the network connection (router, etc.) are also up and
      running, it sometimes helps to restart the network interfaces on your
      computer. To do so, log in to a command line as <code class="systemitem">root</code> and run
      <code class="command">systemctl restart wickeds</code>.
     </p></dd></dl></div></div><div class="sect1 " id="sec.nm.more"><div class="titlepage"><div><div><h2 class="title" id="sec.nm.more"><span class="number">28.7 </span><span class="name">For More Information</span> <a title="Permalink" class="permalink" href="#sec.nm.more">#</a></h2></div></div></div><p>
   More information about NetworkManager can be found on the following Web sites and
   directories:
  </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019134253152"><span class="term ">NetworkManager Project Page</span></dt><dd><p>
      <a class="link" href="http://projects.gnome.org/NetworkManager/" target="_blank">http://projects.gnome.org/NetworkManager/</a>
     </p></dd><dt id="idm140019134250752"><span class="term ">Package Documentation</span></dt><dd><p>
      Also check out the information in the following directories for the
      latest information about NetworkManager and the GNOME applet:
     </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
        <code class="filename">/usr/share/doc/packages/NetworkManager/</code>,
       </p></li><li class="listitem "><p>
        <code class="filename">/usr/share/doc/packages/NetworkManager-gnome/</code>.
       </p></li></ul></div></dd></dl></div></div></div><div class="chapter " id="cha.power-mgmt"><div class="titlepage"><div><div><h2 class="title"><span class="number">29 </span><span class="name">Power Management</span> <a title="Permalink" class="permalink" href="#cha.power-mgmt">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">Filename: </span>powermanagement.xml</li><li><span class="ds-label">ID: </span>cha.power-mgmt</li></ul></div></div></div></div><div class="line"><div class="toc"><dl><dt><span class="sect1"><a href="#sec.power-mgmt.save"><span class="number">29.1 </span><span class="name">Power Saving Functions</span></a></span></dt><dt><span class="sect1"><a href="#sec.power-mgmt.acpi"><span class="number">29.2 </span><span class="name">Advanced Configuration and Power Interface (ACPI)</span></a></span></dt><dt><span class="sect1"><a href="#sec.power-mgmt.silenthd"><span class="number">29.3 </span><span class="name">Rest for the Hard Disk</span></a></span></dt><dt><span class="sect1"><a href="#sec.power-mgmt.faq"><span class="number">29.4 </span><span class="name">Troubleshooting</span></a></span></dt><dt><span class="sect1"><a href="#sec.power-mgmt.info"><span class="number">29.5 </span><span class="name">For More Information</span></a></span></dt></dl></div></div><p>
  Power management is especially important on laptop computers, but is also
  useful on other systems. ACPI (Advanced Configuration and Power Interface) is
  available on all modern computers (laptops, desktops, and servers). Power
  management technologies require suitable hardware and BIOS routines. Most
  laptops and many modern desktops and servers meet these requirements. It is
  also possible to control CPU frequency scaling to save power or decrease
  noise.
 </p><div class="sect1 " id="sec.power-mgmt.save"><div class="titlepage"><div><div><h2 class="title" id="sec.power-mgmt.save"><span class="number">29.1 </span><span class="name">Power Saving Functions</span> <a title="Permalink" class="permalink" href="#sec.power-mgmt.save">#</a></h2></div></div></div><p>
   Power saving functions are not only significant for the mobile use of
   laptops, but also for desktop systems. The main functions and their use in
   ACPI are:
  </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019134237520"><span class="term ">Standby</span></dt><dd><p>
      not supported.
     </p></dd><dt id="idm140019134235712"><span class="term ">Suspend (to memory)</span></dt><dd><p>
      This mode writes the entire system state to the RAM. Subsequently, the
      entire system except the RAM is put to sleep. In this state, the computer
      consumes very little power. The advantage of this state is the
      possibility of resuming work at the same point within a few seconds
      without having to boot and restart applications. This function
      corresponds to the ACPI state <code class="literal">S3</code>.

     </p></dd><dt id="idm140019134233088"><span class="term ">Hibernation (suspend to disk)
    </span></dt><dd><p>
      In this operating mode, the entire system state is written to the hard
      disk and the system is powered off. There must be a swap partition at
      least as big as the RAM to write all the active data. Reactivation from
      this state takes about 30 to 90 seconds. The state prior to the suspend
      is restored. Some manufacturers offer useful hybrid variants of this
      mode, such as RediSafe in IBM Thinkpads. The corresponding ACPI state is
      <code class="literal">S4</code>. In Linux, suspend to disk is performed by kernel
      routines that are independent from ACPI.
     </p><div id="idm140019134230624" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note: Changed UUID for Swap Partitions when Formatting via <code class="command">mkswap</code></h6><p>Do not reformat existing swap partitions with <code class="command">mkswap</code>
     if possible. Reformatting with <code class="command">mkswap</code> will change
     the UUID value of the swap partition. Either reformat via YaST (will
     update <code class="filename">/etc/fstab</code>) or adjust
     <code class="filename">/etc/fstab</code> manually.
  </p></div></dd><dt id="idm140019134226720"><span class="term ">Battery Monitor
    </span></dt><dd><p>
      ACPI checks the battery charge status and provides information about it.
      Additionally, it coordinates actions to perform when a critical charge
      status is reached.
     </p></dd><dt id="idm140019134224752"><span class="term ">Automatic Power-Off</span></dt><dd><p>
      Following a shutdown, the computer is powered off. This is especially
      important when an automatic shutdown is performed shortly before the
      battery is empty.
     </p></dd><dt id="idm140019134222800"><span class="term ">Processor Speed Control</span></dt><dd><p>
      In connection with the CPU, energy can be saved in three different ways:
      frequency and voltage scaling (also known as
      <span class="productname">PowerNow!</span> or
      <span class="productname">Speedstep</span>), throttling and putting
      the processor to sleep (C-states). Depending on the operating mode of the
      computer, these methods can also be combined.
     </p></dd></dl></div></div><div class="sect1 " id="sec.power-mgmt.acpi"><div class="titlepage"><div><div><h2 class="title" id="sec.power-mgmt.acpi"><span class="number">29.2 </span><span class="name">Advanced Configuration and Power Interface (ACPI)</span> <a title="Permalink" class="permalink" href="#sec.power-mgmt.acpi">#</a></h2></div></div></div><p>
   ACPI was designed to enable the operating system to set up and control the
   individual hardware components. ACPI supersedes both Power Management Plug
   and Play (PnP) and Advanced Power Management (APM). It delivers information
   about the battery, AC adapter, temperature, fan and system events, like
   <span class="quote">“<span class="quote">close lid</span>”</span> or <span class="quote">“<span class="quote">battery low.</span>”</span>
  </p><p>
   The BIOS provides tables containing information about the individual
   components and hardware access methods. The operating system uses this
   information for tasks like assigning interrupts or activating and
   deactivating components. Because the operating system executes commands
   stored in the BIOS, the functionality depends on the BIOS implementation.
   The tables ACPI can detect and load are reported in journald. See
   <a class="xref" href="#cha.journalctl" title="Chapter 11. journalctl: Query the systemd Journal">Chapter 11, <em><code class="command">journalctl</code>: Query the <code class="systemitem">systemd</code> Journal</em></a> for more information on viewing the journal
   log messages. See <a class="xref" href="#sec.power-mgmt.acpi.trouble" title="29.2.2. Troubleshooting">Section 29.2.2, “Troubleshooting”</a> for more information
   about troubleshooting ACPI problems.
  </p><div class="sect2 " id="sec.power-mgmt.acpi.powernow"><div class="titlepage"><div><div><h3 class="title" id="sec.power-mgmt.acpi.powernow"><span class="number">29.2.1 </span><span class="name">Controlling the CPU Performance</span> <a title="Permalink" class="permalink" href="#sec.power-mgmt.acpi.powernow">#</a></h3></div></div></div><p>
    The CPU can save energy in three ways:
   </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
      Frequency and Voltage Scaling
     </p></li><li class="listitem "><p>
      Throttling the Clock Frequency (T-states)
     </p></li><li class="listitem "><p>
      Putting the Processor to Sleep (C-states)
     </p></li></ul></div><p>
    Depending on the operating mode of the computer, these methods can be
    combined. Saving energy also means that the system heats up less and the
    fans are activated less frequently.
   </p><p>
    Frequency scaling and throttling are only relevant if the processor is
    busy, because the most economic C-state is applied anyway when the
    processor is idle. If the CPU is busy, frequency scaling is the recommended
    power saving method. Often the processor only works with a partial load. In
    this case, it can be run with a lower frequency. Usually, dynamic frequency
    scaling controlled by the kernel on-demand governor is the best approach.
   </p><p>
    Throttling should be used as the last resort, for example, to extend the
    battery operation time despite a high system load. However, some systems do
    not run smoothly when they are throttled too much. Moreover, CPU throttling
    does not make sense if the CPU has little to do.
   </p><p>
    For in-depth information, refer to <span class="intraxref">Book “<em class="citetitle ">System Analysis and Tuning Guide</em>”, Chapter 11 “Power Management”</span>.
   </p></div><div class="sect2 " id="sec.power-mgmt.acpi.trouble"><div class="titlepage"><div><div><h3 class="title" id="sec.power-mgmt.acpi.trouble"><span class="number">29.2.2 </span><span class="name">Troubleshooting</span> <a title="Permalink" class="permalink" href="#sec.power-mgmt.acpi.trouble">#</a></h3></div></div></div><p>
    There are two different types of problems. On one hand, the ACPI code of
    the kernel may contain bugs that were not detected in time. In this case, a
    solution will be made available for download. More often, the problems are
    caused by the BIOS. Sometimes, deviations from the ACPI specification are
    purposely integrated in the BIOS to circumvent errors in the ACPI
    implementation of other widespread operating systems. Hardware components
    that have serious errors in the ACPI implementation are recorded in a
    blacklist that prevents the Linux kernel from using ACPI for these
    components.
   </p><p>
    The first thing to do when problems are encountered is to update the BIOS.
    If the computer does not boot, one of the following boot parameters may be
    helpful:
   </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019134201904"><span class="term ">pci=noacpi</span></dt><dd><p>
       Do not use ACPI for configuring the PCI devices.
      </p></dd><dt id="idm140019134200064"><span class="term ">acpi=ht</span></dt><dd><p>
       Only perform a simple resource configuration. Do not use ACPI for other
       purposes.
      </p></dd><dt id="idm140019134198192"><span class="term ">acpi=off</span></dt><dd><p>
       Disable ACPI.
      </p></dd></dl></div><div id="idm140019134196272" class="admonition warning normal"><img class="symbol" alt="Warning" title="Warning" src="static/images/icon-warning.png" /><h6>Warning: Problems Booting without ACPI</h6><p>
     Some newer machines (especially SMP systems and AMD64 systems) need ACPI
     for configuring the hardware correctly. On these machines, disabling ACPI
     can cause problems.
    </p></div><p>
    Sometimes, the machine is confused by hardware that is attached over USB or
    FireWire. If a machine refuses to boot, unplug all unneeded hardware and
    try again.
   </p><p>
    Monitor the boot messages of the system with the command <code class="command">dmesg
    -T</code> <code class="option">| grep -2i acpi</code> (or all messages, because the
    problem may not be caused by ACPI) after booting. If an error occurs while
    parsing an ACPI table, the most important table—the DSDT
    (<span class="emphasis"><em>Differentiated System Description Table</em></span>)—can be
    replaced with an improved version. In this case, the faulty DSDT of the
    BIOS is ignored. The procedure is described in
    <a class="xref" href="#sec.power-mgmt.faq" title="29.4. Troubleshooting">Section 29.4, “Troubleshooting”</a>.
   </p><p>
    In the kernel configuration, there is a switch for activating ACPI debug
    messages. If a kernel with ACPI debugging is compiled and installed,
    detailed information is issued.
   </p><p>
    If you experience BIOS or hardware problems, it is always advisable to
    contact the manufacturers. Especially if they do not always provide
    assistance for Linux, they should be confronted with the problems.
    Manufacturers will only take the issue seriously if they realize that an
    adequate number of their customers use Linux.
   </p><div class="sect3 " id="sec.power-mgmt.acpi.trouble.info"><div class="titlepage"><div><div><h4 class="title" id="sec.power-mgmt.acpi.trouble.info"><span class="number">29.2.2.1 </span><span class="name">For More Information</span> <a title="Permalink" class="permalink" href="#sec.power-mgmt.acpi.trouble.info">#</a></h4></div></div></div><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
       <a class="link" href="http://tldp.org/HOWTO/ACPI-HOWTO/" target="_blank">http://tldp.org/HOWTO/ACPI-HOWTO/</a> (detailed ACPI
       HOWTO, contains DSDT patches)
      </p></li><li class="listitem "><p>
       <a class="link" href="http://www.acpi.info" target="_blank">http://www.acpi.info</a> (Advanced Configuration &amp;
       Power Interface Specification)
      </p></li><li class="listitem "><p>
       <a class="link" href="http://acpi.sourceforge.net/dsdt/index.php" target="_blank">http://acpi.sourceforge.net/dsdt/index.php</a> (DSDT
       patches by Bruno Ducrot)
      </p></li></ul></div></div></div></div><div class="sect1 " id="sec.power-mgmt.silenthd"><div class="titlepage"><div><div><h2 class="title" id="sec.power-mgmt.silenthd"><span class="number">29.3 </span><span class="name">Rest for the Hard Disk</span> <a title="Permalink" class="permalink" href="#sec.power-mgmt.silenthd">#</a></h2></div></div></div><p>
   In Linux, the hard disk can be put to sleep entirely if it is not needed or
   it can be run in a more economic or quieter mode. On modern laptops, you do
   not need to switch off the hard disks manually, because they automatically
   enter an economic operating mode whenever they are not needed. However, if
   you want to maximize power savings, test some of the following methods,
   using the <code class="command">hdparm</code> command.
  </p><p>
   It can be used to modify various hard disk settings. The option
   <code class="option">-y</code> instantly switches the hard disk to the standby mode.
   <code class="option">-Y</code> puts it to sleep. <code class="command">hdparm</code>
   <code class="option">-S</code> <em class="replaceable ">X</em> causes the hard disk to be
   spun down after a certain period of inactivity. Replace
   <em class="replaceable ">X</em> as follows: <code class="literal">0</code> disables this
   mechanism, causing the hard disk to run continuously. Values from
   <code class="literal">1</code> to <code class="literal">240</code> are multiplied by 5
   seconds. Values from <code class="literal">241</code> to <code class="literal">251</code>
   correspond to 1 to 11 times 30 minutes.
  </p><p>
   Internal power saving options of the hard disk can be controlled with the
   option <code class="literal">-B</code>. Select a value from <code class="literal">0</code> to
   <code class="literal">255</code> for maximum saving to maximum throughput. The result
   depends on the hard disk used and is difficult to assess. To make a hard
   disk quieter, use the option <code class="literal">-M</code>. Select a value from
   <code class="literal">128</code> to <code class="literal">254</code> for quiet to fast.
  </p><p>
   Often, it is not so easy to put the hard disk to sleep. In Linux, numerous
   processes write to the hard disk, waking it up repeatedly. Therefore, it is
   important to understand how Linux handles data that needs to be written to
   the hard disk. First, all data is buffered in the RAM. This buffer is
   monitored by the <code class="systemitem">pdflush</code> daemon.
   When the data reaches a certain age limit or when the buffer is filled to a
   certain degree, the buffer content is flushed to the hard disk. The buffer
   size is dynamic and depends on the size of the memory and the system load.
   By default, pdflush is set to short intervals to achieve maximum data
   integrity. It checks the buffer every 5 seconds and writes the data to the
   hard disk. The following variables are interesting:
  </p><div class="variablelist "><dl class="variablelist"><dt id="idm140019134169088"><span class="term "><code class="filename">/proc/sys/vm/dirty_writeback_centisecs</code>
    </span></dt><dd><p>
      Contains the delay until a pdflush thread wakes up (in hundredths of a
      second).
     </p></dd><dt id="idm140019134166912"><span class="term "><code class="filename">/proc/sys/vm/dirty_expire_centisecs</code>
    </span></dt><dd><p>
      Defines after which timeframe a dirty page should be written out latest.
      Default is <code class="literal">3000</code>, which means 30 seconds.
     </p></dd><dt id="idm140019134164272"><span class="term "><code class="filename">/proc/sys/vm/dirty_background_ratio</code>
    </span></dt><dd><p>
      Maximum percentage of dirty pages until pdflush begins to write them.
      Default is <code class="literal">5</code>%.
     </p></dd><dt id="idm140019134161648"><span class="term "><code class="filename">/proc/sys/vm/dirty_ratio</code>
    </span></dt><dd><p>
      When the dirty page exceeds this percentage of the total memory,
      processes are forced to write dirty buffers during their time slice
      instead of continuing to write.
     </p></dd></dl></div><div id="idm140019134159216" class="admonition warning normal"><img class="symbol" alt="Warning" title="Warning" src="static/images/icon-warning.png" /><h6>Warning: Impairment of the Data Integrity</h6><p>
    Changes to the <code class="systemitem">pdflush</code> daemon
    settings endanger the data integrity.
   </p></div><p>
   Apart from these processes, journaling file systems, like
   <code class="systemitem">Btrfs</code>,
   <code class="systemitem">Ext3</code>,
   <code class="systemitem">Ext4</code> and others write their
   metadata independently from <code class="systemitem">pdflush</code>,
   which also prevents the hard disk from spinning down.
   <span class="phrase">To avoid this, a special kernel extension has been
   developed for mobile devices. To use the extension, install the
   <code class="systemitem">laptop-mode-tools</code> package and
   see
   <code class="filename">/usr/src/linux/Documentation/laptops/laptop-mode.txt</code>
   for details.</span>
  </p><p>
   Another important factor is the way active programs behave. For example,
   good editors regularly write hidden backups of the currently modified file
   to the hard disk, causing the disk to wake up. Features like this can be
   disabled at the expense of data integrity.
  </p><p>
   In this connection, the mail daemon postfix uses the variable
   <code class="systemitem">POSTFIX_LAPTOP</code>. If this variable is set to
   <code class="literal">yes</code>, postfix accesses the hard disk far less frequently.
  </p><p>

   In <span class="productname"><span class="phrase">openSUSE Leap</span></span> these technologies are controlled by
   <code class="systemitem">laptop-mode-tools</code>.
  </p></div><div class="sect1 " id="sec.power-mgmt.faq"><div class="titlepage"><div><div><h2 class="title" id="sec.power-mgmt.faq"><span class="number">29.4 </span><span class="name">Troubleshooting</span> <a title="Permalink" class="permalink" href="#sec.power-mgmt.faq">#</a></h2></div></div></div><p>
   All error messages and alerts are logged in the system journal that can be
   queried with the command <code class="command">journalctl</code> (see
   <a class="xref" href="#cha.journalctl" title="Chapter 11. journalctl: Query the systemd Journal">Chapter 11, <em><code class="command">journalctl</code>: Query the <code class="systemitem">systemd</code> Journal</em></a> for more information). The following
   sections cover the most common problems.
  </p><div class="sect2 " id="sec.power-mgmt.faq.cpufreq"><div class="titlepage"><div><div><h3 class="title" id="sec.power-mgmt.faq.cpufreq"><span class="number">29.4.1 </span><span class="name">CPU Frequency Does Not Work</span> <a title="Permalink" class="permalink" href="#sec.power-mgmt.faq.cpufreq">#</a></h3></div></div></div><p>
    Refer to the kernel sources to see if your processor is supported. You may
    need a special kernel module or module option to activate CPU frequency
    control. If the <code class="systemitem">kernel-source</code>
    package is installed, this information is available in
    <code class="filename">/usr/src/linux/Documentation/cpu-freq/*</code>.
   </p></div></div><div class="sect1 " id="sec.power-mgmt.info"><div class="titlepage"><div><div><h2 class="title" id="sec.power-mgmt.info"><span class="number">29.5 </span><span class="name">For More Information</span> <a title="Permalink" class="permalink" href="#sec.power-mgmt.info">#</a></h2></div></div></div><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
     <a class="link" href="http://en.opensuse.org/SDB:Suspend_to_RAM" target="_blank">http://en.opensuse.org/SDB:Suspend_to_RAM</a>—How
     to get Suspend to RAM working
    </p></li><li class="listitem "><p>
     <a class="link" href="http://old-en.opensuse.org/Pm-utils" target="_blank">http://old-en.opensuse.org/Pm-utils</a>—How to
     modify the general suspend framework
    </p></li></ul></div></div></div></div><div class="appendix " id="app.nwscheme"><div class="titlepage"><div><div><h1 class="title"><span class="number">A </span><span class="name">An Example Network</span> <a title="Permalink" class="permalink" href="#app.nwscheme">#</a></h1><div class="doc-status"><ul><li><span class="ds-label">Filename: </span>network_scheme.xml</li><li><span class="ds-label">ID: </span>app.nwscheme</li></ul></div></div></div></div><div class="line"></div><p>
  This example network is used across all network-related chapters of the
  <span class="productname"><span class="phrase">openSUSE® Leap</span></span> documentation.
 </p><div class="informalfigure"><div class="mediaobject"><a xmlns="" href="images/network_schema.png"><img src="images/network_schema.png" width="" /></a></div></div></div><div class="legal-section"><div class="appendix " id="idm140019134120304"><div class="titlepage"><div><div><h1 class="title"><span class="number">B </span><span class="name">GNU Licenses</span> <a title="Permalink" class="permalink" href="#idm140019134120304">#</a></h1><div class="doc-status"><ul><li><span class="ds-label">Filename: </span>common_legal.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><div class="line"><div class="toc"><dl><dt><span class="sect1"><a href="#idm140019134115664"><span class="number">B.1 </span><span class="name">GNU Free Documentation License</span></a></span></dt></dl></div></div><p>
  This appendix contains the GNU Free Documentation License version 1.2.
 </p><div class="sect1 " id="idm140019134115664"><div class="titlepage"><div><div><h2 class="title legal" id="idm140019134115664"><span class="name">GNU Free Documentation License</span> <a title="Permalink" class="permalink" href="#idm140019134115664">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">Filename: </span>common_gfdl1.2_i.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>
  Copyright (C) 2000, 2001, 2002 Free Software Foundation, Inc. 51 Franklin St,
  Fifth Floor, Boston, MA 02110-1301 USA. Everyone is permitted to copy and
  distribute verbatim copies of this license document, but changing it is not
  allowed.
 </p><div class="sect4 bridgehead"><h5 class="title legal" id="idm140019134112144"><span class="name">
    0. PREAMBLE
  </span><a title="Permalink" class="permalink" href="#idm140019134112144">#</a></h5></div><p>
  The purpose of this License is to make a manual, textbook, or other
  functional and useful document "free" in the sense of freedom: to assure
  everyone the effective freedom to copy and redistribute it, with or without
  modifying it, either commercially or non-commercially. Secondarily, this
  License preserves for the author and publisher a way to get credit for their
  work, while not being considered responsible for modifications made by
  others.
 </p><p>
  This License is a kind of "copyleft", which means that derivative works of
  the document must themselves be free in the same sense. It complements the
  GNU General Public License, which is a copyleft license designed for free
  software.
 </p><p>
  We have designed this License to use it for manuals for free software,
  because free software needs free documentation: a free program should come
  with manuals providing the same freedoms that the software does. But this
  License is not limited to software manuals; it can be used for any textual
  work, regardless of subject matter or whether it is published as a printed
  book. We recommend this License principally for works whose purpose is
  instruction or reference.
 </p><div class="sect4 bridgehead"><h5 class="title legal" id="idm140019134108944"><span class="name">
    1. APPLICABILITY AND DEFINITIONS
  </span><a title="Permalink" class="permalink" href="#idm140019134108944">#</a></h5></div><p>
  This License applies to any manual or other work, in any medium, that
  contains a notice placed by the copyright holder saying it can be distributed
  under the terms of this License. Such a notice grants a world-wide,
  royalty-free license, unlimited in duration, to use that work under the
  conditions stated herein. The "Document", below, refers to any such manual or
  work. Any member of the public is a licensee, and is addressed as "you". You
  accept the license if you copy, modify or distribute the work in a way
  requiring permission under copyright law.
 </p><p>
  A "Modified Version" of the Document means any work containing the Document
  or a portion of it, either copied verbatim, or with modifications and/or
  translated into another language.
 </p><p>
  A "Secondary Section" is a named appendix or a front-matter section of the
  Document that deals exclusively with the relationship of the publishers or
  authors of the Document to the Document's overall subject (or to related
  matters) and contains nothing that could fall directly within that overall
  subject. (Thus, if the Document is in part a textbook of mathematics, a
  Secondary Section may not explain any mathematics.) The relationship could be
  a matter of historical connection with the subject or with related matters,
  or of legal, commercial, philosophical, ethical or political position
  regarding them.
 </p><p>
  The "Invariant Sections" are certain Secondary Sections whose titles are
  designated, as being those of Invariant Sections, in the notice that says
  that the Document is released under this License. If a section does not fit
  the above definition of Secondary then it is not allowed to be designated as
  Invariant. The Document may contain zero Invariant Sections. If the Document
  does not identify any Invariant Sections then there are none.
 </p><p>
  The "Cover Texts" are certain short passages of text that are listed, as
  Front-Cover Texts or Back-Cover Texts, in the notice that says that the
  Document is released under this License. A Front-Cover Text may be at most 5
  words, and a Back-Cover Text may be at most 25 words.
 </p><p>
  A "Transparent" copy of the Document means a machine-readable copy,
  represented in a format whose specification is available to the general
  public, that is suitable for revising the document straightforwardly with
  generic text editors or (for images composed of pixels) generic paint
  programs or (for drawings) some widely available drawing editor, and that is
  suitable for input to text formatters or for automatic translation to a
  variety of formats suitable for input to text formatters. A copy made in an
  otherwise Transparent file format whose markup, or absence of markup, has
  been arranged to thwart or discourage subsequent modification by readers is
  not Transparent. An image format is not Transparent if used for any
  substantial amount of text. A copy that is not "Transparent" is called
  "Opaque".
 </p><p>
  Examples of suitable formats for Transparent copies include plain ASCII
  without markup, Texinfo input format, LaTeX input format, SGML or XML using a
  publicly available DTD, and standard-conforming simple HTML, PostScript or
  PDF designed for human modification. Examples of transparent image formats
  include PNG, XCF and JPG. Opaque formats include proprietary formats that can
  be read and edited only by proprietary word processors, SGML or XML for which
  the DTD and/or processing tools are not generally available, and the
  machine-generated HTML, PostScript or PDF produced by some word processors
  for output purposes only.
 </p><p>
  The "Title Page" means, for a printed book, the title page itself, plus such
  following pages as are needed to hold, legibly, the material this License
  requires to appear in the title page. For works in formats which do not have
  any title page as such, "Title Page" means the text near the most prominent
  appearance of the work's title, preceding the beginning of the body of the
  text.
 </p><p>
  A section "Entitled XYZ" means a named subunit of the Document whose title
  either is precisely XYZ or contains XYZ in parentheses following text that
  translates XYZ in another language. (Here XYZ stands for a specific section
  name mentioned below, such as "Acknowledgements", "Dedications",
  "Endorsements", or "History".) To "Preserve the Title" of such a section when
  you modify the Document means that it remains a section "Entitled XYZ"
  according to this definition.
 </p><p>
  The Document may include Warranty Disclaimers next to the notice which states
  that this License applies to the Document. These Warranty Disclaimers are
  considered to be included by reference in this License, but only as regards
  disclaiming warranties: any other implication that these Warranty Disclaimers
  may have is void and has no effect on the meaning of this License.
 </p><div class="sect4 bridgehead"><h5 class="title legal" id="idm140019134099008"><span class="name">
    2. VERBATIM COPYING
  </span><a title="Permalink" class="permalink" href="#idm140019134099008">#</a></h5></div><p>
  You may copy and distribute the Document in any medium, either commercially
  or non-commercially, provided that this License, the copyright notices, and
  the license notice saying this License applies to the Document are reproduced
  in all copies, and that you add no other conditions whatsoever to those of
  this License. You may not use technical measures to obstruct or control the
  reading or further copying of the copies you make or distribute. However, you
  may accept compensation in exchange for copies. If you distribute a large
  enough number of copies you must also follow the conditions in section 3.
 </p><p>
  You may also lend copies, under the same conditions stated above, and you may
  publicly display copies.
 </p><div class="sect4 bridgehead"><h5 class="title legal" id="idm140019134096672"><span class="name">
    3. COPYING IN QUANTITY
  </span><a title="Permalink" class="permalink" href="#idm140019134096672">#</a></h5></div><p>
  If you publish printed copies (or copies in media that commonly have printed
  covers) of the Document, numbering more than 100, and the Document's license
  notice requires Cover Texts, you must enclose the copies in covers that
  carry, clearly and legibly, all these Cover Texts: Front-Cover Texts on the
  front cover, and Back-Cover Texts on the back cover. Both covers must also
  clearly and legibly identify you as the publisher of these copies. The front
  cover must present the full title with all words of the title equally
  prominent and visible. You may add other material on the covers in addition.
  Copying with changes limited to the covers, as long as they preserve the
  title of the Document and satisfy these conditions, can be treated as
  verbatim copying in other respects.
 </p><p>
  If the required texts for either cover are too voluminous to fit legibly, you
  should put the first ones listed (as many as fit reasonably) on the actual
  cover, and continue the rest onto adjacent pages.
 </p><p>
  If you publish or distribute Opaque copies of the Document numbering more
  than 100, you must either include a machine-readable Transparent copy along
  with each Opaque copy, or state in or with each Opaque copy a
  computer-network location from which the general network-using public has
  access to download using public-standard network protocols a complete
  Transparent copy of the Document, free of added material. If you use the
  latter option, you must take reasonably prudent steps, when you begin
  distribution of Opaque copies in quantity, to ensure that this Transparent
  copy will remain thus accessible at the stated location until at least one
  year after the last time you distribute an Opaque copy (directly or through
  your agents or retailers) of that edition to the public.
 </p><p>
  It is requested, but not required, that you contact the authors of the
  Document well before redistributing any large number of copies, to give them
  a chance to provide you with an updated version of the Document.
 </p><div class="sect4 bridgehead"><h5 class="title legal" id="idm140019134092176"><span class="name">
    4. MODIFICATIONS
  </span><a title="Permalink" class="permalink" href="#idm140019134092176">#</a></h5></div><p>
  You may copy and distribute a Modified Version of the Document under the
  conditions of sections 2 and 3 above, provided that you release the Modified
  Version under precisely this License, with the Modified Version filling the
  role of the Document, thus licensing distribution and modification of the
  Modified Version to whoever possesses a copy of it. In addition, you must do
  these things in the Modified Version:
 </p><div class="orderedlist "><ol class="orderedlist" type="A"><li class="listitem "><p>
    Use in the Title Page (and on the covers, if any) a title distinct from
    that of the Document, and from those of previous versions (which should, if
    there were any, be listed in the History section of the Document). You may
    use the same title as a previous version if the original publisher of that
    version gives permission.
   </p></li><li class="listitem "><p>
    List on the Title Page, as authors, one or more persons or entities
    responsible for authorship of the modifications in the Modified Version,
    together with at least five of the principal authors of the Document (all
    of its principal authors, if it has fewer than five), unless they release
    you from this requirement.
   </p></li><li class="listitem "><p>
    State on the Title page the name of the publisher of the Modified Version,
    as the publisher.
   </p></li><li class="listitem "><p>
    Preserve all the copyright notices of the Document.
   </p></li><li class="listitem "><p>
    Add an appropriate copyright notice for your modifications adjacent to the
    other copyright notices.
   </p></li><li class="listitem "><p>
    Include, immediately after the copyright notices, a license notice giving
    the public permission to use the Modified Version under the terms of this
    License, in the form shown in the Addendum below.
   </p></li><li class="listitem "><p>
    Preserve in that license notice the full lists of Invariant Sections and
    required Cover Texts given in the Document's license notice.
   </p></li><li class="listitem "><p>
    Include an unaltered copy of this License.
   </p></li><li class="listitem "><p>
    Preserve the section Entitled "History", Preserve its Title, and add to it
    an item stating at least the title, year, new authors, and publisher of the
    Modified Version as given on the Title Page. If there is no section
    Entitled "History" in the Document, create one stating the title, year,
    authors, and publisher of the Document as given on its Title Page, then add
    an item describing the Modified Version as stated in the previous sentence.
   </p></li><li class="listitem "><p>
    Preserve the network location, if any, given in the Document for public
    access to a Transparent copy of the Document, and likewise the network
    locations given in the Document for previous versions it was based on.
    These may be placed in the "History" section. You may omit a network
    location for a work that was published at least four years before the
    Document itself, or if the original publisher of the version it refers to
    gives permission.
   </p></li><li class="listitem "><p>
    For any section Entitled "Acknowledgements" or "Dedications", Preserve the
    Title of the section, and preserve in the section all the substance and
    tone of each of the contributor acknowledgements and/or dedications given
    therein.
   </p></li><li class="listitem "><p>
    Preserve all the Invariant Sections of the Document, unaltered in their
    text and in their titles. Section numbers or the equivalent are not
    considered part of the section titles.
   </p></li><li class="listitem "><p>
    Delete any section Entitled "Endorsements". Such a section may not be
    included in the Modified Version.
   </p></li><li class="listitem "><p>
    Do not retitle any existing section to be Entitled "Endorsements" or to
    conflict in title with any Invariant Section.
   </p></li><li class="listitem "><p>
    Preserve any Warranty Disclaimers.
   </p></li></ol></div><p>
  If the Modified Version includes new front-matter sections or appendices that
  qualify as Secondary Sections and contain no material copied from the
  Document, you may at your option designate some or all of these sections as
  invariant. To do this, add their titles to the list of Invariant Sections in
  the Modified Version's license notice. These titles must be distinct from any
  other section titles.
 </p><p>
  You may add a section Entitled "Endorsements", provided it contains nothing
  but endorsements of your Modified Version by various parties--for example,
  statements of peer review or that the text has been approved by an
  organization as the authoritative definition of a standard.
 </p><p>
  You may add a passage of up to five words as a Front-Cover Text, and a
  passage of up to 25 words as a Back-Cover Text, to the end of the list of
  Cover Texts in the Modified Version. Only one passage of Front-Cover Text and
  one of Back-Cover Text may be added by (or through arrangements made by) any
  one entity. If the Document already includes a cover text for the same cover,
  previously added by you or by arrangement made by the same entity you are
  acting on behalf of, you may not add another; but you may replace the old
  one, on explicit permission from the previous publisher that added the old
  one.
 </p><p>
  The author(s) and publisher(s) of the Document do not by this License give
  permission to use their names for publicity for or to assert or imply
  endorsement of any Modified Version.
 </p><div class="sect4 bridgehead"><h5 class="title legal" id="idm140019134070080"><span class="name">
    5. COMBINING DOCUMENTS
  </span><a title="Permalink" class="permalink" href="#idm140019134070080">#</a></h5></div><p>
  You may combine the Document with other documents released under this
  License, under the terms defined in section 4 above for modified versions,
  provided that you include in the combination all of the Invariant Sections of
  all of the original documents, unmodified, and list them all as Invariant
  Sections of your combined work in its license notice, and that you preserve
  all their Warranty Disclaimers.
 </p><p>
  The combined work need only contain one copy of this License, and multiple
  identical Invariant Sections may be replaced with a single copy. If there are
  multiple Invariant Sections with the same name but different contents, make
  the title of each such section unique by adding at the end of it, in
  parentheses, the name of the original author or publisher of that section if
  known, or else a unique number. Make the same adjustment to the section
  titles in the list of Invariant Sections in the license notice of the
  combined work.
 </p><p>
  In the combination, you must combine any sections Entitled "History" in the
  various original documents, forming one section Entitled "History"; likewise
  combine any sections Entitled "Acknowledgements", and any sections Entitled
  "Dedications". You must delete all sections Entitled "Endorsements".
 </p><div class="sect4 bridgehead"><h5 class="title legal" id="idm140019134066784"><span class="name">
    6. COLLECTIONS OF DOCUMENTS
  </span><a title="Permalink" class="permalink" href="#idm140019134066784">#</a></h5></div><p>
  You may make a collection consisting of the Document and other documents
  released under this License, and replace the individual copies of this
  License in the various documents with a single copy that is included in the
  collection, provided that you follow the rules of this License for verbatim
  copying of each of the documents in all other respects.
 </p><p>
  You may extract a single document from such a collection, and distribute it
  individually under this License, provided you insert a copy of this License
  into the extracted document, and follow this License in all other respects
  regarding verbatim copying of that document.
 </p><div class="sect4 bridgehead"><h5 class="title legal" id="idm140019134064528"><span class="name">
    7. AGGREGATION WITH INDEPENDENT WORKS
  </span><a title="Permalink" class="permalink" href="#idm140019134064528">#</a></h5></div><p>
  A compilation of the Document or its derivatives with other separate and
  independent documents or works, in or on a volume of a storage or
  distribution medium, is called an "aggregate" if the copyright resulting from
  the compilation is not used to limit the legal rights of the compilation's
  users beyond what the individual works permit. When the Document is included
  in an aggregate, this License does not apply to the other works in the
  aggregate which are not themselves derivative works of the Document.
 </p><p>
  If the Cover Text requirement of section 3 is applicable to these copies of
  the Document, then if the Document is less than one half of the entire
  aggregate, the Document's Cover Texts may be placed on covers that bracket
  the Document within the aggregate, or the electronic equivalent of covers if
  the Document is in electronic form. Otherwise they must appear on printed
  covers that bracket the whole aggregate.
 </p><div class="sect4 bridgehead"><h5 class="title legal" id="idm140019134061952"><span class="name">
    8. TRANSLATION
  </span><a title="Permalink" class="permalink" href="#idm140019134061952">#</a></h5></div><p>
  Translation is considered a kind of modification, so you may distribute
  translations of the Document under the terms of section 4. Replacing
  Invariant Sections with translations requires special permission from their
  copyright holders, but you may include translations of some or all Invariant
  Sections in addition to the original versions of these Invariant Sections.
  You may include a translation of this License, and all the license notices in
  the Document, and any Warranty Disclaimers, provided that you also include
  the original English version of this License and the original versions of
  those notices and disclaimers. In case of a disagreement between the
  translation and the original version of this License or a notice or
  disclaimer, the original version will prevail.
 </p><p>
  If a section in the Document is Entitled "Acknowledgements", "Dedications",
  or "History", the requirement (section 4) to Preserve its Title (section 1)
  will typically require changing the actual title.
 </p><div class="sect4 bridgehead"><h5 class="title legal" id="idm140019134059360"><span class="name">
    9. TERMINATION
  </span><a title="Permalink" class="permalink" href="#idm140019134059360">#</a></h5></div><p>
  You may not copy, modify, sublicense, or distribute the Document except as
  expressly provided for under this License. Any other attempt to copy, modify,
  sublicense or distribute the Document is void, and will automatically
  terminate your rights under this License. However, parties who have received
  copies, or rights, from you under this License will not have their licenses
  terminated so long as such parties remain in full compliance.
 </p><div class="sect4 bridgehead"><h5 class="title legal" id="idm140019134057760"><span class="name">
    10. FUTURE REVISIONS OF THIS LICENSE
  </span><a title="Permalink" class="permalink" href="#idm140019134057760">#</a></h5></div><p>
  The Free Software Foundation may publish new, revised versions of the GNU
  Free Documentation License from time to time. Such new versions will be
  similar in spirit to the present version, but may differ in detail to address
  new problems or concerns. See
  <a class="link" href="http://www.gnu.org/copyleft/" target="_blank">http://www.gnu.org/copyleft/</a>.
 </p><p>
  Each version of the License is given a distinguishing version number. If the
  Document specifies that a particular numbered version of this License "or any
  later version" applies to it, you have the option of following the terms and
  conditions either of that specified version or of any later version that has
  been published (not as a draft) by the Free Software Foundation. If the
  Document does not specify a version number of this License, you may choose
  any version ever published (not as a draft) by the Free Software Foundation.
 </p><div class="sect4 bridgehead"><h5 class="title legal" id="idm140019134054576"><span class="name">
    ADDENDUM: How to use this License for your documents
  </span><a title="Permalink" class="permalink" href="#idm140019134054576">#</a></h5></div><div class="verbatim-wrap"><pre class="screen">Copyright (c) YEAR YOUR NAME.
Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.2
or any later version published by the Free Software Foundation;
with no Invariant Sections, no Front-Cover Texts, and no Back-Cover Texts.
A copy of the license is included in the section entitled “GNU
Free Documentation License”.</pre></div><p>
  If you have Invariant Sections, Front-Cover Texts and Back-Cover Texts,
  replace the “with...Texts.” line with this:
 </p><div class="verbatim-wrap"><pre class="screen">with the Invariant Sections being LIST THEIR TITLES, with the
Front-Cover Texts being LIST, and with the Back-Cover Texts being LIST.</pre></div><p>
  If you have Invariant Sections without Cover Texts, or some other combination
  of the three, merge those two alternatives to suit the situation.
 </p><p>
  If your document contains nontrivial examples of program code, we recommend
  releasing these examples in parallel under your choice of free software
  license, such as the GNU General Public License, to permit their use in free
  software.
 </p></div></div></div></div></div><div class="page-bottom"><div id="_share-print"><div class="online-contents share"><strong>Share this page: </strong><span class="share-buttons"><span id="_share-fb" class="bottom-button">Facebook</span><span class="spacer"> • </span><span id="_share-gp" class="bottom-button">Google+</span><span class="spacer"> • </span><span id="_share-tw" class="bottom-button">Twitter</span></span></div><div class="print"><span id="_print-button" class="bottom-button">Print this page</span></div><div class="clearme"></div></div></div></div><div id="_inward"></div></div><div id="_footer-wrap"><div id="_footer"><p>©
        2018 
        SUSE</p></div></div></body></html>