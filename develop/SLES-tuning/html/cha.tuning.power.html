<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang=""><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Power Management | System Analysis and Tuning Guide | SUSE Linux Enterprise Server 15</title><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" /><link rel="stylesheet" type="text/css" href="static/css/style.css" /><link rel="stylesheet" type="text/css" href="static/css/highlight.css" /><meta name="generator" content="DAPS 2.4.0 using SUSE XSL Stylesheets 2.0.8 (based on DocBook XSL Stylesheets 1.78.1) - chunked" /><meta name="product-name" content="SUSE Linux Enterprise Server" /><meta name="product-number" content="15" /><meta name="book-title" content="System Analysis and Tuning Guide" /><meta name="chapter-title" content="Chapter 11. Power Management" /><meta name="description" content="Power management aims at reducing operating costs for energy and cooling systems while at the same time keeping the performance of a system at a level that matches the current requirements. Thus, power management is always a matter of balancing the actual performance needs and power saving options for a system. Power management can be implemented and used at different levels of the system. A set of specifications for power management functions of devices and the operating system interface to them has been defined in the Advanced Configuration and Power Interface (ACPI). As power savings in server environments can primarily be achieved at the processor level, this chapter introduces some main concepts and highlights some tools for analyzing and influencing relevant parameters." /><meta name="tracker-url" content="https://bugzilla.suse.com/enter_bug.cgi" /><meta name="tracker-type" content="bsc" /><meta name="tracker-bsc-assignee" content="fs@suse.com" /><meta name="tracker-bsc-component" content="Documentation" /><meta name="tracker-bsc-product" content="Beta SUSE Linux Enterprise Server 15" /><link rel="home" href="index.html" title="SUSE Linux Enterprise Server Documentation" /><link rel="up" href="part.tuning.resources.html" title="Part IV. Resource Management" /><link rel="prev" href="cha.tuning.numactl.html" title="Chapter 10. Automatic Non-Uniform Memory Access (NUMA) Balancing" /><link rel="next" href="part.tuning.kernel.html" title="Part V. Kernel Tuning" /><script type="text/javascript">

var protocol = window.location.protocol.toLowerCase();
if ( protocol != 'file:' ) {
  var agent = navigator.userAgent.toLowerCase();
  var wanted = ( protocol == 'https:') ? 'https' : 'http';
  var file = 'fonts.css';
  document.write('<link rel="stylesheet" type="text/css" href="' + wanted + '://static.opensuse.org/fonts/'+ file +'"></link>');
}
else {
   document.write('<link rel="stylesheet" type="text/css" href="static/css/fonts-onlylocal.css"></link>');
}

</script><noscript><link rel="stylesheet" type="text/css" href="http://static.opensuse.org/fonts/fonts.css" /></noscript><script src="static/js/jquery-1.10.2.min.js" type="text/javascript"></script><script src="static/js/script.js" type="text/javascript"></script><script src="static/js/highlight.min.js" type="text/javascript"></script><script>

$(document).ready(function() {
  $('.verbatim-wrap.highlight').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});
hljs.configure({
  useBR: false
});

</script></head><body class="draft offline js-off"><div id="_outer-wrap"><div id="_white-bg"><div id="_header"><div id="_logo"><img src="static/images/logo.png" alt="Logo" /></div><div class="crumbs"><a class="book-link" href="index.html" title="SUSE Linux Enterprise Server Documentation"><span class="book-icon">SUSE Linux Enterprise Server Documentation</span></a><span> › </span><a class="crumb" href="book.sle.tuning.html">System Analysis and Tuning Guide</a><span> › </span><a class="crumb" href="part.tuning.resources.html">Resource Management</a><span> › </span><a class="crumb" href="cha.tuning.power.html">Power Management</a></div><div class="clearme"></div></div></div><div id="_toolbar-wrap"><div id="_toolbar"><div id="_toc-area" class="inactive"><a id="_toc-area-button" class="tool" title="Contents" accesskey="c" href="index.html"><span class="tool-spacer"><span class="toc-icon">Contents</span><span class="clearme"></span></span><span class="tool-label">Contents</span></a><div class="active-contents bubble-corner"></div><div class="active-contents bubble"><div class="bubble-container"><h6>System Analysis and Tuning Guide</h6><div id="_bubble-toc"><ol><li class="inactive"><a href="preface.tuning.html"><span class="number"> </span><span class="name">About This Guide</span></a></li><li class="inactive"><a href="part.tuning.basics.html"><span class="number">I </span><span class="name">Basics</span></a><ol><li class="inactive"><a href="cha.tuning.basics.html"><span class="number">1 </span><span class="name">General Notes on System Tuning</span></a></li></ol></li><li class="inactive"><a href="part.tuning.monitoring.html"><span class="number">II </span><span class="name">System Monitoring</span></a><ol><li class="inactive"><a href="cha.util.html"><span class="number">2 </span><span class="name">System Monitoring Utilities</span></a></li><li class="inactive"><a href="cha.tuning.logfiles.html"><span class="number">3 </span><span class="name">Analyzing and Managing System Log Files</span></a></li></ol></li><li class="inactive"><a href="part.tuning.kerneltrace.html"><span class="number">III </span><span class="name">Kernel Monitoring</span></a><ol><li class="inactive"><a href="cha.tuning.systemtap.html"><span class="number">4 </span><span class="name">SystemTap—Filtering and Analyzing System Data</span></a></li><li class="inactive"><a href="cha.tuning.kprobes.html"><span class="number">5 </span><span class="name">Kernel Probes</span></a></li><li class="inactive"><a href="cha.perf.html"><span class="number">6 </span><span class="name">Hardware-Based Performance Monitoring with Perf</span></a></li><li class="inactive"><a href="cha.tuning.oprofile.html"><span class="number">7 </span><span class="name">OProfile—System-Wide Profiler</span></a></li></ol></li><li class="inactive"><a href="part.tuning.resources.html"><span class="number">IV </span><span class="name">Resource Management</span></a><ol><li class="inactive"><a href="cha.tuning.resources.html"><span class="number">8 </span><span class="name">General System Resource Management</span></a></li><li class="inactive"><a href="cha.tuning.cgroups.html"><span class="number">9 </span><span class="name">Kernel Control Groups</span></a></li><li class="inactive"><a href="cha.tuning.numactl.html"><span class="number">10 </span><span class="name">Automatic Non-Uniform Memory Access (NUMA) Balancing</span></a></li><li class="inactive"><a href="cha.tuning.power.html"><span class="number">11 </span><span class="name">Power Management</span></a></li></ol></li><li class="inactive"><a href="part.tuning.kernel.html"><span class="number">V </span><span class="name">Kernel Tuning</span></a><ol><li class="inactive"><a href="cha.tuning.io.html"><span class="number">12 </span><span class="name">Tuning I/O Performance</span></a></li><li class="inactive"><a href="cha.tuning.taskscheduler.html"><span class="number">13 </span><span class="name">Tuning the Task Scheduler</span></a></li><li class="inactive"><a href="cha.tuning.memory.html"><span class="number">14 </span><span class="name">Tuning the Memory Management Subsystem</span></a></li><li class="inactive"><a href="cha.tuning.network.html"><span class="number">15 </span><span class="name">Tuning the Network</span></a></li></ol></li><li class="inactive"><a href="part.tuning.dumps.html"><span class="number">VI </span><span class="name">Handling System Dumps</span></a><ol><li class="inactive"><a href="cha.tuning.tracing.html"><span class="number">16 </span><span class="name">Tracing Tools</span></a></li><li class="inactive"><a href="cha.tuning.kexec.html"><span class="number">17 </span><span class="name">Kexec and Kdump</span></a></li></ol></li><li class="inactive"><a href="part.tuning.ptp.html"><span class="number">VII </span><span class="name">Synchronized Clocks with Precision Time Protocol</span></a><ol><li class="inactive"><a href="cha.tuning.ptp.html"><span class="number">18 </span><span class="name">Precision Time Protocol</span></a></li></ol></li><li class="inactive"><a href="bk07apa.html"><span class="number">A </span><span class="name">GNU Licenses</span></a></li></ol></div><div class="clearme"></div></div></div></div><div id="_nav-area" class="inactive"><div class="tool"><span class="nav-inner"><span class="tool-label">Navigation</span><a accesskey="p" class="tool-spacer" title="Chapter 10. Automatic Non-Uniform Memory Access (NUMA) Balancing" href="cha.tuning.numactl.html"><span class="prev-icon">←</span></a><a accesskey="n" class="tool-spacer" title="Part V. Kernel Tuning" href="part.tuning.kernel.html"><span class="next-icon">→</span></a></span></div></div></div></div><div id="_fixed-header-wrap" class="inactive"><div id="_fixed-header"><div class="crumbs"><a class="book-link" href="index.html" title="SUSE Linux Enterprise Server Documentation"><span class="book-icon">SUSE Linux Enterprise Server Documentation</span></a><span> › </span><a class="crumb" href="book.sle.tuning.html">System Analysis and Tuning Guide</a><span> › </span><a class="crumb" href="part.tuning.resources.html">Resource Management</a><span> › </span><a class="crumb" href="cha.tuning.power.html">Power Management</a></div><div class="buttons"><a class="top-button button" href="#">Top</a><div class="button"><a accesskey="p" class="tool-spacer" title="Chapter 10. Automatic Non-Uniform Memory Access (NUMA) Balancing" href="cha.tuning.numactl.html"><span class="prev-icon">←</span></a><a accesskey="n" class="tool-spacer" title="Part V. Kernel Tuning" href="part.tuning.kernel.html"><span class="next-icon">→</span></a></div><div class="clearme"></div></div><div class="clearme"></div></div></div><div id="_content" class="draft "><div class="documentation"><div class="chapter " id="cha.tuning.power"><div class="titlepage"><div><div class="version-info">Applies to  <span class="productname"><span class="productname"><span class="phrase">SUSE Linux Enterprise Server</span></span></span> <span class="productnumber"><span class="productnumber"><span class="phrase">15</span></span></span></div><div><h2 class="title"><span class="number">11 </span><span class="name">Power Management</span> </h2><div class="doc-status"><ul><li><span class="ds-label">Filename: </span>tuning_power.xml</li><li><span class="ds-label">ID: </span>cha.tuning.power</li></ul></div></div><div><div class="abstract"><div class="abstract-title-wrap"><h6 class="abstract-title">Abstract<a title="Permalink" class="permalink" href="cha.tuning.power.html#idm139897171243760">#</a></h6></div><p>
    Power management aims at reducing operating costs for energy and cooling
    systems while at the same time keeping the performance of a system at a
    level that matches the current requirements. Thus, power management is
    always a matter of balancing the actual performance needs and power
    saving options for a system. Power management can be implemented and
    used at different levels of the system. A set of specifications for
    power management functions of devices and the operating system interface
    to them has been defined in the Advanced Configuration and Power
    Interface (ACPI). As power savings in server environments can primarily
    be achieved at the processor level, this chapter introduces some
    main concepts and highlights some tools for analyzing and influencing
    relevant parameters.
   </p></div></div></div></div><div class="line"><div class="toc"><dl><dt><span class="sect1"><a href="cha.tuning.power.html#sec.tuning.power.cpu"><span class="number">11.1 </span><span class="name">Power Management at CPU Level</span></a></span></dt><dt><span class="sect1"><a href="cha.tuning.power.html#sec.tuning.power.governors"><span class="number">11.2 </span><span class="name">In-Kernel Governors</span></a></span></dt><dt><span class="sect1"><a href="cha.tuning.power.html#sec.tuning.power.tools.cpupower"><span class="number">11.3 </span><span class="name">The <code class="systemitem">cpupower</code> Tools</span></a></span></dt><dt><span class="sect1"><a href="cha.tuning.power.html#sec.tuning.power.options"><span class="number">11.4 </span><span class="name">Special Tuning Options</span></a></span></dt><dt><span class="sect1"><a href="cha.tuning.power.html#sec.tuning.power.trouble"><span class="number">11.5 </span><span class="name">Troubleshooting</span></a></span></dt><dt><span class="sect1"><a href="cha.tuning.power.html#sec.tuning.power.more"><span class="number">11.6 </span><span class="name">For More Information</span></a></span></dt></dl></div></div><div class="sect1 " id="sec.tuning.power.cpu"><div class="titlepage"><div><div><h2 class="title" id="sec.tuning.power.cpu"><span class="number">11.1 </span><span class="name">Power Management at CPU Level</span> <a title="Permalink" class="permalink" href="cha.tuning.power.html#sec.tuning.power.cpu">#</a></h2></div></div></div><p>
   At the CPU level, you can control power usage in various ways. For
   example by using idling power states (C-states), changing CPU frequency
   (P-states), and throttling the CPU (T-states). The following sections
   give a short introduction to each approach and its significance for power
   savings. Detailed specifications can be found at
   <a class="link" href="http://www.acpi.info/spec.htm" target="_blank">http://www.acpi.info/spec.htm</a>.
  </p><div class="sect2 " id="sec.tuning.power.cpu.cstates"><div class="titlepage"><div><div><h3 class="title" id="sec.tuning.power.cpu.cstates"><span class="number">11.1.1 </span><span class="name">C-States (Processor Operating States)</span> <a title="Permalink" class="permalink" href="cha.tuning.power.html#sec.tuning.power.cpu.cstates">#</a></h3></div></div></div><p>
    Modern processors have several power saving modes called
    <code class="literal">C-states</code>. They reflect the capability of an idle
    processor to turn off unused components to save power.
   </p><p>
    When a processor is in the <code class="literal">C0</code> state, it is executing
    instructions. A processor running in any other C-state is idle. The
    higher the C number, the deeper the CPU sleep mode: more components are
    shut down to save power. Deeper sleep states can save large amounts of
    energy. Their downside is that they introduce latency. This means, it
    takes more time for the CPU to go back to <code class="literal">C0</code>.
    Depending on workload (threads waking up, triggering CPU usage and then
    going back to sleep again for a short period of time) and hardware (for
    example, interrupt activity of a network device), disabling the deepest
    sleep states can significantly increase overall performance. For details
    on how to do so, refer to
    <a class="xref" href="cha.tuning.power.html#sec.tuning.power.tools.cpupower.idle-info" title="11.3.2. Viewing Kernel Idle Statistics with cpupower">Section 11.3.2, “Viewing Kernel Idle Statistics with <code class="command">cpupower</code>”</a>.
   </p><p>
    Some states also have submodes with different power saving latency
    levels. Which C-states and submodes are supported depends on the
    respective processor. However, <code class="literal">C1</code> is always
    available.
   </p><p>
    <a class="xref" href="cha.tuning.power.html#tab.tuning.power.cstates" title="C-States">Table 11.1, “C-States”</a> gives an overview of the most
    common C-states.
   </p><div class="table" id="tab.tuning.power.cstates"><div class="table-title-wrap"><h6 class="table-title"><span class="number">Table 11.1: </span><span class="name">C-States </span><a title="Permalink" class="permalink" href="cha.tuning.power.html#tab.tuning.power.cstates">#</a></h6></div><div class="table-contents"><table summary="C-States" border="1"><colgroup><col /><col /></colgroup><thead><tr><th>
        <p>
         Mode
        </p>
       </th><th>
        <p>
         Definition
        </p>
       </th></tr></thead><tbody><tr><td>
        <p>
         C0
        </p>
       </td><td>
        <p>
         Operational state. CPU fully turned on.
        </p>
       </td></tr><tr><td>
        <p>
         C1
        </p>
       </td><td>
        <p>
         First idle state. Stops CPU main internal clocks via software. Bus
         interface unit and APIC are kept running at full speed.
        </p>
       </td></tr><tr><td>
        <p>
         C2
        </p>
       </td><td>
        <p>
         Stops CPU main internal clocks via hardware. State in which the
         processor maintains all software-visible states, but may take
         longer to wake up through interrupts.
        </p>
       </td></tr><tr><td>
        <p>
         C3
        </p>
       </td><td>
        <p>
         Stops all CPU internal clocks. The processor does not need to keep
         its cache coherent, but maintains other states. Some processors
         have variations of the C3 state that differ in how long it takes to
         wake the processor through interrupts.
        </p>
       </td></tr></tbody></table></div></div><p>
    To avoid needless power consumption, it is recommended to test your
    workloads with deep sleep states enabled versus deep sleep states
    disabled. For more information, refer to
    <a class="xref" href="cha.tuning.power.html#sec.tuning.power.tools.cpupower.idle-info" title="11.3.2. Viewing Kernel Idle Statistics with cpupower">Section 11.3.2, “Viewing Kernel Idle Statistics with <code class="command">cpupower</code>”</a> or the
    <code class="command">cpupower-idle-set(1)</code> man page.
   </p></div><div class="sect2 " id="sec.tuning.power.cpu.pstates"><div class="titlepage"><div><div><h3 class="title" id="sec.tuning.power.cpu.pstates"><span class="number">11.1.2 </span><span class="name">P-States (Processor Performance States)</span> <a title="Permalink" class="permalink" href="cha.tuning.power.html#sec.tuning.power.cpu.pstates">#</a></h3></div></div></div><p>
    While a processor operates (in C0 state), it can be in one of several
    CPU performance states <code class="literal">(P-states)</code>. Whereas C-states
    are idle states (all but C0), <code class="literal">P-states</code> are
    operational states that relate to CPU frequency and voltage.
   </p><p>
    The higher the P-state, the lower the frequency and voltage at which the
    processor runs. The number of P-states is processor-specific and the
    implementation differs across the various types. However,
    <code class="literal">P0</code> is always the highest-performance state (except for <a class="xref" href="cha.tuning.power.html#sec.tuning.cpu.power.turbo" title="11.1.3. Turbo Features">Section 11.1.3, “Turbo Features”</a>). Higher
    P-state numbers represent slower processor speeds and lower power
    consumption. For example, a processor in <code class="literal">P3</code> state runs
    more slowly and uses less power than a processor running in the
    <code class="literal">P1</code> state. To operate at any P-state, the processor
    must be in the <code class="literal">C0</code> state, which means that it is
    working and not idling. The CPU P-states are also defined in the ACPI
    specification, see <a class="link" href="http://www.acpi.info/spec.htm" target="_blank">http://www.acpi.info/spec.htm</a>.
   </p><p>
    C-states and P-states can vary independently of one another.
   </p></div><div class="sect2 " id="sec.tuning.cpu.power.turbo"><div class="titlepage"><div><div><h3 class="title" id="sec.tuning.cpu.power.turbo"><span class="number">11.1.3 </span><span class="name">Turbo Features</span> <a title="Permalink" class="permalink" href="cha.tuning.power.html#sec.tuning.cpu.power.turbo">#</a></h3></div></div></div><p>
    Turbo features allow to dynamically <code class="literal">overtick</code> active CPU
    cores while other cores are in deep sleep states. This increases the performance
    of active threads while still
    complying with Thermal Design Power (TDP) limits.
   </p><p>
    However, the conditions under which a CPU core can use turbo frequencies
    are architecture-specific. Learn how to evaluate the efficiency of those
    new features in <a class="xref" href="cha.tuning.power.html#sec.tuning.power.tools.cpupower" title="11.3. The cpupower Tools">Section 11.3, “The <code class="systemitem">cpupower</code> Tools”</a>.
   </p></div></div><div class="sect1 " id="sec.tuning.power.governors"><div class="titlepage"><div><div><h2 class="title" id="sec.tuning.power.governors"><span class="number">11.2 </span><span class="name">In-Kernel Governors</span> <a title="Permalink" class="permalink" href="cha.tuning.power.html#sec.tuning.power.governors">#</a></h2></div></div></div><p> The in-kernel governors belong to the Linux kernel CPUfreq infrastructure and can be
   used to dynamically scale processor frequencies at runtime. You can think of the governors as a
   sort of preconfigured power scheme for the CPU. The CPUfreq governors use P-states to
   change frequencies and lower power consumption. The dynamic governors can switch between CPU
   frequencies, based on CPU usage, to allow for power savings while not sacrificing performance.
  </p><p>
    The following governors are available with the CPUfreq subsystem:
   </p><div class="variablelist "><dl class="variablelist"><dt id="idm139897171200608"><span class="term ">Performance Governor</span></dt><dd><p>
       The CPU frequency is statically set to the highest possible for
       maximum performance. Consequently, saving power is not the focus of
       this governor.
      </p><p>See also <a class="xref" href="cha.tuning.power.html#sec.tuning.power.options.p-states" title="11.4.1. Tuning Options for P-States">Section 11.4.1, “Tuning Options for P-States”</a>.
      </p></dd><dt id="idm139897171197680"><span class="term ">Powersave Governor</span></dt><dd><p>
       The CPU frequency is statically set to the lowest possible. This can
       have severe impact on the performance, as the system will never rise
       above this frequency no matter how busy the processors are. An important
       exception is the <code class="literal">intel_pstate</code> which defaults to the
       <code class="literal">powersave</code> mode. This is due to a hardware-specific
       decision but functionally it operates similarly to the
       <code class="literal">on-demand</code> governor.
      </p><p>
       However, using this governor often does not lead to the expected
       power savings as the highest savings can usually be achieved at idle
       through entering C-states. With the powersave governor, processes run
       at the lowest frequency and thus take longer to finish. This means it
       takes longer until the system can go into an idle C-state.
      </p><p>
       Tuning options: The range of minimum frequencies available to the
       governor can be adjusted (for example, with the
       <code class="command">cpupower</code> command line tool).
      </p></dd><dt id="idm139897171192352"><span class="term ">On-demand Governor</span></dt><dd><p>
       The kernel implementation of a dynamic CPU frequency policy: The
       governor monitors the processor usage. When it exceeds a
       certain threshold, the governor will set the frequency to the highest
       available. If the usage is less than the threshold, the next lowest
       frequency is used. If the system continues to be underemployed, the
       frequency is again reduced until the lowest available frequency is
       set.
      </p></dd></dl></div><div id="idm139897171189952" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.png" /><h6>Important: Drivers and In-kernel Governors</h6><p>Not all drivers use the in-kernel governors to dynamically scale power frequency at
    runtime. For example, the <code class="literal">intel_pstate</code> driver adjusts power frequency itself. Use
    the <code class="command">cpupower frequency-info</code> command to find out which driver your system
    uses.</p></div></div><div class="sect1 " id="sec.tuning.power.tools.cpupower"><div class="titlepage"><div><div><h2 class="title" id="sec.tuning.power.tools.cpupower"><span class="number">11.3 </span><span class="name">The <code class="systemitem">cpupower</code> Tools</span> <a title="Permalink" class="permalink" href="cha.tuning.power.html#sec.tuning.power.tools.cpupower">#</a></h2></div></div></div><p>The <code class="command">cpupower</code> tools are designed to give an overview
   of <span class="emphasis"><em>all</em></span> CPU power-related parameters that are supported
   on a given machine, including turbo (or boost) states.  Use the tool set to
   view and modify settings of the kernel-related CPUfreq and cpuidle systems
   and other settings not related to frequency scaling or idle states. The
   integrated monitoring framework can access both kernel-related parameters
   and hardware statistics. Therefore, it is ideally suited for performance
   benchmarks. It also helps you to identify the dependencies between turbo and
   idle states.
   </p><p> After installing the <code class="systemitem">cpupower</code> package, view the
   available <code class="command">cpupower</code> subcommands with
   <code class="command">cpupower --help</code>. Access the general man page with
   <code class="command">man cpupower</code>, and the man pages of the subcommands with
   <code class="command">man cpupower-<em class="replaceable ">SUBCOMMAND</em></code>.
   </p><div class="sect2 " id="sec.tuning.power.tools.cpupower.freq-info"><div class="titlepage"><div><div><h3 class="title" id="sec.tuning.power.tools.cpupower.freq-info"><span class="number">11.3.1 </span><span class="name">Viewing Current Settings with <code class="command">cpupower</code></span> <a title="Permalink" class="permalink" href="cha.tuning.power.html#sec.tuning.power.tools.cpupower.freq-info">#</a></h3></div></div></div><p>
     The <code class="command">cpupower frequency-info</code> command shows the
     statistics of the cpufreq driver used in the kernel. Additionally, it
     shows if turbo (boost) states are supported and enabled in the BIOS.
     Run without any options, it shows an output similar to the following:
    </p><div class="example" id="idm139897171177520"><div class="example-title-wrap"><h6 class="example-title"><span class="number">Example 11.1: </span><span class="name">Example Output of <code class="command">cpupower frequency-info</code> </span><a title="Permalink" class="permalink" href="cha.tuning.power.html#idm139897171177520">#</a></h6></div><div class="example-contents"><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>cpupower frequency-info
analyzing CPU 0:
  driver: intel_pstate
  CPUs which run at the same hardware frequency: 0
  CPUs which need to have their frequency coordinated by software: 0
  maximum transition latency: 0.97 ms.
  hardware limits: 1.20 GHz - 3.80 GHz
  available cpufreq governors: performance, powersave
  current policy: frequency should be within 1.20 GHz and 3.80 GHz.
                  The governor "powersave" may decide which speed to use
                  within this range.
  current CPU frequency is 3.40 GHz (asserted by call to hardware).
  boost state support:
    Supported: yes
    Active: yes
    3500 MHz max turbo 4 active cores
    3600 MHz max turbo 3 active cores
    3600 MHz max turbo 2 active cores
    3800 MHz max turbo 1 active cores</pre></div></div></div><p>
     To get the current values for all CPUs, use
     <code class="command">cpupower -c all frequency-info</code>.
    </p></div><div class="sect2 " id="sec.tuning.power.tools.cpupower.idle-info"><div class="titlepage"><div><div><h3 class="title" id="sec.tuning.power.tools.cpupower.idle-info"><span class="number">11.3.2 </span><span class="name">Viewing Kernel Idle Statistics with <code class="command">cpupower</code></span> <a title="Permalink" class="permalink" href="cha.tuning.power.html#sec.tuning.power.tools.cpupower.idle-info">#</a></h3></div></div></div><p>
     The <code class="command">idle-info</code> subcommand shows the statistics of the
     cpuidle driver used in the kernel. It works on all architectures that
     use the cpuidle kernel framework.
    </p><div class="example" id="idm139897171170896"><div class="example-title-wrap"><h6 class="example-title"><span class="number">Example 11.2: </span><span class="name">Example Output of <code class="command">cpupower idle-info</code> </span><a title="Permalink" class="permalink" href="cha.tuning.power.html#idm139897171170896">#</a></h6></div><div class="example-contents"><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>cpupower idle-info
CPUidle driver: intel_idle
CPUidle governor: menu

Analyzing CPU 0:
Number of idle states: 6
Available idle states: POLL C1-SNB C1E-SNB C3-SNB C6-SNB C7-SNB
POLL:
Flags/Description: CPUIDLE CORE POLL IDLE
Latency: 0
Usage: 163128
Duration: 17585669
C1-SNB:
Flags/Description: MWAIT 0x00
Latency: 2
Usage: 16170005
Duration: 697658910
C1E-SNB:
Flags/Description: MWAIT 0x01
Latency: 10
Usage: 4421617
Duration: 757797385
C3-SNB:
Flags/Description: MWAIT 0x10
Latency: 80
Usage: 2135929
Duration: 735042875
C6-SNB:
Flags/Description: MWAIT 0x20
Latency: 104
Usage: 53268
Duration: 229366052
C7-SNB:
Flags/Description: MWAIT 0x30
Latency: 109
Usage: 62593595
Duration: 324631233978</pre></div></div></div><p>
     After finding out which processor idle states are supported with
     <code class="command">cpupower idle-info</code>, individual states can be
     disabled using the <code class="command">cpupower idle-set</code> command.
     Typically one wants to disable the deepest sleep state, for example:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>cpupower idle-set -d 5</pre></div><p>Or, for disabling all CPUs with latencies equal to or higher than <code class="literal">80</code>:</p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>cpupower idle-set -D 80</pre></div></div><div class="sect2 " id="sec.tuning.power.tools.cpupower.monitor"><div class="titlepage"><div><div><h3 class="title" id="sec.tuning.power.tools.cpupower.monitor"><span class="number">11.3.3 </span><span class="name">Monitoring Kernel and Hardware Statistics with <code class="command">cpupower</code></span> <a title="Permalink" class="permalink" href="cha.tuning.power.html#sec.tuning.power.tools.cpupower.monitor">#</a></h3></div></div></div><p>
     Use the <code class="command">monitor</code> subcommand to report processor topology, and monitor frequency
     and idle power state statistics over a certain period of time. The
     default interval is <code class="literal">1</code> second, but it can be changed
     with the <code class="option">-i</code>. Independent processor sleep states and
     frequency counters are implemented in the tool—some retrieved
     from kernel statistics, others reading out hardware registers. The
     available monitors depend on the underlying hardware and the system.
     List them with <code class="command">cpupower monitor -l</code>.
     For a description of the individual monitors, refer to the
     cpupower-monitor man page.
    </p><p>
     The <code class="command">monitor</code> subcommand allows you to execute
     performance benchmarks. To compare kernel statistics with hardware
     statistics for specific workloads, concatenate the respective command, for example:</p><div class="verbatim-wrap"><pre class="screen"><code class="command">cpupower</code> <code class="option">monitor</code> db_test.sh</pre></div><div class="complex-example"><div class="example" id="ex.cpupower.monitor"><div class="example-title-wrap"><h6 class="example-title"><span class="number">Example 11.3: </span><span class="name">Example <code class="command">cpupower monitor</code> Output </span><a title="Permalink" class="permalink" href="cha.tuning.power.html#ex.cpupower.monitor">#</a></h6></div><div class="example-contents"><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>cpupower monitor
|Mperf                   || Idle_Stats
 <span id="co.cpupower.mon.mperf"></span><span class="callout">1</span>                         <span id="co.cpupower.mon.idle"></span><span class="callout">2</span> 
CPU | C0   | Cx   | Freq || POLL | C1   | C2   | C3
   0|  3.71| 96.29|  2833||  0.00|  0.00|  0.02| 96.32
   1| 100.0| -0.00|  2833||  0.00|  0.00|  0.00|  0.00
   2|  9.06| 90.94|  1983||  0.00|  7.69|  6.98| 76.45
   3|  7.43| 92.57|  2039||  0.00|  2.60| 12.62| 77.52</pre></div><div class="calloutlist "><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#co.cpupower.mon.mperf"><span class="callout">1</span></a> </p></td><td valign="top" align="left"><p>
        Mperf shows the average frequency of a CPU, including boost
        frequencies, over time. Additionally, it shows the
        percentage of time the CPU has been active (<code class="literal">C0</code>)
        or in any sleep state (<code class="literal">Cx</code>). As the turbo states are managed by the
        BIOS, it is impossible to get the frequency values at a given
        instant. On modern processors with turbo features the Mperf monitor
        is the only way to find out about the frequency a certain CPU has
        been running in.
       </p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#co.cpupower.mon.idle"><span class="callout">2</span></a> </p></td><td valign="top" align="left"><p>
        Idle_Stats shows the statistics of the cpuidle kernel subsystem. The
        kernel updates these values every time an idle state is entered or
        left. Therefore there can be some inaccuracy when cores are in an
        idle state for some time when the measure starts or ends.
       </p></td></tr></table></div><p>
      Apart from the (general) monitors in the example above, other
      architecture-specific monitors are available. For detailed
      information, refer to the <code class="command">cpupower-monitor</code> man
      page.
     </p></div></div></div><p>
     By comparing the values of the individual monitors, you can find
     correlations and dependencies and evaluate how well the power saving
     mechanism works for a certain workload. In
     <a class="xref" href="cha.tuning.power.html#ex.cpupower.monitor" title="Example cpupower monitor Output">Example 11.3</a> you can
     see that CPU <code class="literal">0</code> is idle (the value of
     <code class="literal">Cx</code> is near 100%), but runs at a very high frequency.
     This is because the CPUs <code class="literal">0</code> and <code class="literal">1</code>
     have the same frequency values which means that there is a dependency
     between them.
    </p></div><div class="sect2 " id="sec.tuning.power.tools.cpupower.freq-set"><div class="titlepage"><div><div><h3 class="title" id="sec.tuning.power.tools.cpupower.freq-set"><span class="number">11.3.4 </span><span class="name">Modifying Current Settings with <code class="command">cpupower</code></span> <a title="Permalink" class="permalink" href="cha.tuning.power.html#sec.tuning.power.tools.cpupower.freq-set">#</a></h3></div></div></div><p>
     You can use
     <code class="command">cpupower frequency-set</code> command as <code class="systemitem">root</code> to
     modify current settings. It allows you to set values for the minimum or
     maximum CPU frequency the governor may select or to create a new
     governor. With the <code class="option">-c</code> option, you can also specify for
     which of the processors the settings should be modified. That makes it
     easy to use a consistent policy across all processors without adjusting
     the settings for each processor individually. For more details and the
     available options, see the man page
     <code class="literal">cpupower-frequency-set</code> or run
     <code class="command">cpupower frequency-set</code>
     <code class="option">--help</code>.
    </p></div></div><div class="sect1 " id="sec.tuning.power.options"><div class="titlepage"><div><div><h2 class="title" id="sec.tuning.power.options"><span class="number">11.4 </span><span class="name">Special Tuning Options</span> <a title="Permalink" class="permalink" href="cha.tuning.power.html#sec.tuning.power.options">#</a></h2></div></div></div><p>
   The following sections highlight important settings.
  </p><div class="sect2 " id="sec.tuning.power.options.p-states"><div class="titlepage"><div><div><h3 class="title" id="sec.tuning.power.options.p-states"><span class="number">11.4.1 </span><span class="name">Tuning Options for P-States</span> <a title="Permalink" class="permalink" href="cha.tuning.power.html#sec.tuning.power.options.p-states">#</a></h3></div></div></div><p>
    The CPUfreq subsystem offers several tuning options for P-states:
    You can switch between the different governors, influence minimum or
    maximum CPU frequency to be used or change individual governor
    parameters.
   </p><p>
    To switch to another governor at runtime, use
    <code class="command">cpupower frequency-set</code> with the <code class="option">-g</code> option. For
    example, running the following command (as <code class="systemitem">root</code>) will activate the
    performance governor:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>cpupower frequency-set -g performance</pre></div><p>
    To set values for the minimum or maximum CPU frequency the governor may
    select, use the <code class="option">-d</code> or <code class="option">-u</code> option,
    respectively.
   </p></div></div><div class="sect1 " id="sec.tuning.power.trouble"><div class="titlepage"><div><div><h2 class="title" id="sec.tuning.power.trouble"><span class="number">11.5 </span><span class="name">Troubleshooting</span> <a title="Permalink" class="permalink" href="cha.tuning.power.html#sec.tuning.power.trouble">#</a></h2></div></div></div><div class="variablelist "><dl class="variablelist"><dt id="idm139897170869616"><span class="term ">BIOS options enabled?</span></dt><dd><p>
      To use C-states or P-states, check your BIOS options:
     </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
        To use C-states, make sure to enable <code class="literal">CPU C State</code>
        or similar options to benefit from power savings at idle.
       </p></li><li class="listitem "><p>
        To use P-states and the CPUfreq governors, make sure to enable
        <code class="literal">Processor Performance States</code> options or similar.
       </p></li><li class="listitem "><p>
        Even if P-states and C-states are available, it is possible that the
        platform firmware is managing CPU frequencies which may be sub-optimal.
        For example, if <code class="literal">pcc-cpufreq</code> is loaded then the
        OS is only giving hints to the firmware, which is free to ignore the
        hints. This can be addressed by selecting "OS Management" or similar
        for CPU frequency managed in the BIOS. After reboot, an alternative
        driver will be used but the performance impact should be carefully
        measured.
       </p></li></ul></div><p>
      In case of a CPU upgrade, make sure to upgrade your BIOS, too. The
      BIOS needs to know the new CPU and its frequency stepping to
      pass this information on to the operating system.
     </p></dd><dt id="idm139897170861472"><span class="term ">Log file information?</span></dt><dd><p>
      Check the <code class="systemitem">systemd</code> journal (see <span class="intraxref">Book “<em class="citetitle ">Administration Guide</em>”, Chapter 15 “<code class="command">journalctl</code>: Query the <code class="systemitem">systemd</code> Journal”</span>)
      for any output regarding the CPUfreq subsystem. Only severe
      errors are reported there.
     </p><p>
      If you suspect problems with the CPUfreq subsystem on your
      machine, you can also enable additional debug output. To do so, either
      use <code class="command">cpufreq.debug=7</code> as boot parameter or execute
      the following command as <code class="systemitem">root</code>:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>echo 7 &gt; /sys/module/cpufreq/parameters/debug</pre></div><p>
      This will cause CPUfreq to log more information to
      <code class="command">dmesg</code> on state transitions, which is useful for
      diagnosis. But as this additional output of kernel messages can be
      rather comprehensive, use it only if you are fairly sure that a
      problem exists.
     </p></dd></dl></div></div><div class="sect1 " id="sec.tuning.power.more"><div class="titlepage"><div><div><h2 class="title" id="sec.tuning.power.more"><span class="number">11.6 </span><span class="name">For More Information</span> <a title="Permalink" class="permalink" href="cha.tuning.power.html#sec.tuning.power.more">#</a></h2></div></div></div><p>
   Platforms with a Baseboard Management Controller (BMC) may have additional
   power management configuration options accessible via the service
   processor. These configurations are vendor specific and therefore not
   subject of this guide. For more information, refer to the manuals provided
   by your vendor.
   
  </p></div></div></div><div class="page-bottom"><div id="_bottom-navigation"><a class="nav-link" href="part.tuning.kernel.html"><span class="next-icon">→</span><span class="nav-label"><span class="number">Part V </span>Kernel Tuning</span></a><a class="nav-link" href="cha.tuning.numactl.html"><span class="prev-icon">←</span><span class="nav-label"><span class="number">Chapter 10 </span>Automatic Non-Uniform Memory Access (NUMA) Balancing</span></a></div><div id="_share-print"><div class="online-contents share"><strong>Share this page: </strong><span class="share-buttons"><span id="_share-fb" class="bottom-button">Facebook</span><span class="spacer"> • </span><span id="_share-gp" class="bottom-button">Google+</span><span class="spacer"> • </span><span id="_share-tw" class="bottom-button">Twitter</span><span class="spacer"> • </span><span id="_share-mail" class="bottom-button">E-Mail</span></span></div><div class="print"><span id="_print-button" class="bottom-button">Print this page</span></div><div class="clearme"></div></div></div></div><div id="_inward"></div></div><div id="_footer-wrap"><div id="_footer"><p>©
        2018 
        SUSE</p><ul><li><a href="http://www.suse.com/company/careers/" target="_top">Careers</a></li><li><a href="http://www.suse.com/company/legal/" target="_top">Legal</a></li><li><a href="http://www.suse.com/company/" target="_top">About</a></li><li><a href="http://www.suse.com/ContactsOffices/contacts_offices.jsp" target="_top">Contact Us</a></li></ul></div></div></body></html>