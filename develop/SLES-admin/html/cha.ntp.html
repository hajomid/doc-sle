<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang=""><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Time Synchronization with NTP | Administration Guide | SUSE Linux Enterprise Server 15</title><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" /><link rel="stylesheet" type="text/css" href="static/css/style.css" /><link rel="stylesheet" type="text/css" href="static/css/highlight.css" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><meta name="product-name" content="SUSE Linux Enterprise Server" /><meta name="product-number" content="15" /><meta name="book-title" content="Administration Guide" /><meta name="chapter-title" content="Chapter 27. Time Synchronization with NTP" /><meta name="description" content="The NTP (network time protocol) mechanism is a protocol for synchronizing the system time over the network. First, a machine can obtain the time from a server that is a reliable time source. Second, a machine can itself act as a time source for other computers in the network. The goal is twofold—maintaining the absolute time and synchronizing the system time of all machines within a network." /><meta name="tracker-url" content="https://bugzilla.suse.com/enter_bug.cgi" /><meta name="tracker-type" content="bsc" /><meta name="tracker-bsc-assignee" content="fs@suse.com" /><meta name="tracker-bsc-component" content="Documentation" /><meta name="tracker-bsc-product" content="SUSE Linux Enterprise Server 15" /><link rel="home" href="index.html" title="SUSE Linux Enterprise Server Documentation" /><link rel="up" href="part.services.html" title="Part IV. Services" /><link rel="prev" href="part.services.html" title="Part IV. Services" /><link rel="next" href="cha.dns.html" title="Chapter 28. The Domain Name System" /><script type="text/javascript">

var protocol = window.location.protocol.toLowerCase();
if ( protocol != 'file:' ) {
  var agent = navigator.userAgent.toLowerCase();
  var wanted = ( protocol == 'https:') ? 'https' : 'http';
  var file = 'fonts.css';
  document.write('<link rel="stylesheet" type="text/css" href="' + wanted + '://static.opensuse.org/fonts/'+ file +'"></link>');
}
else {
   document.write('<link rel="stylesheet" type="text/css" href="static/css/fonts-onlylocal.css"></link>');
}

</script><noscript><link rel="stylesheet" type="text/css" href="http://static.opensuse.org/fonts/fonts.css" /></noscript><script src="static/js/jquery-1.10.2.min.js" type="text/javascript"></script><script src="static/js/script.js" type="text/javascript"></script><script src="static/js/highlight.min.js" type="text/javascript"></script><script>

$(document).ready(function() {
  $('.verbatim-wrap.highlight').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});
hljs.configure({
  useBR: false
});

</script></head><body class="draft offline js-off"><div id="_outer-wrap"><div id="_white-bg"><div id="_header"><div id="_logo"><img src="static/images/logo.png" alt="Logo" /></div><div class="crumbs"><a class="book-link" href="index.html" title="SUSE Linux Enterprise Server Documentation"><span class="book-icon">SUSE Linux Enterprise Server Documentation</span></a><span> › </span><a class="crumb" href="book.sle.admin.html">Administration Guide</a><span> › </span><a class="crumb" href="part.services.html">Services</a><span> › </span><a class="crumb" href="cha.ntp.html">Time Synchronization with NTP</a></div><div class="clearme"></div></div></div><div id="_toolbar-wrap"><div id="_toolbar"><div id="_toc-area" class="inactive"><a id="_toc-area-button" class="tool" title="Contents" accesskey="c" href="index.html"><span class="tool-spacer"><span class="toc-icon">Contents</span><span class="clearme"></span></span><span class="tool-label">Contents</span></a><div class="active-contents bubble-corner"></div><div class="active-contents bubble"><div class="bubble-container"><h6>Administration Guide</h6><div id="_bubble-toc"><ol><li class="inactive"><a href="pre.sle.html"><span class="number"> </span><span class="name">About This Guide</span></a></li><li class="inactive"><a href="part.administration.html"><span class="number">I </span><span class="name">Common Tasks</span></a><ol><li class="inactive"><a href="cha.adm.shell.html"><span class="number">1 </span><span class="name">Bash and Bash Scripts</span></a></li><li class="inactive"><a href="cha.adm.sudo.html"><span class="number">2 </span><span class="name">sudo
</span></a></li><li class="inactive"><a href="cha.onlineupdate.you.html"><span class="number">3 </span><span class="name">YaST Online Update</span></a></li><li class="inactive"><a href="cha.yast.gui.html"><span class="number">4 </span><span class="name">YaST</span></a></li><li class="inactive"><a href="cha.yast.text.html"><span class="number">5 </span><span class="name">YaST in Text Mode</span></a></li><li class="inactive"><a href="cha.sw_cl.html"><span class="number">6 </span><span class="name">Managing Software with Command Line Tools</span></a></li><li class="inactive"><a href="cha.snapper.html"><span class="number">7 </span><span class="name">System Recovery and Snapshot Management with Snapper</span></a></li><li class="inactive"><a href="cha.vnc.html"><span class="number">8 </span><span class="name">Remote Access with VNC</span></a></li><li class="inactive"><a href="cha.net.rsync.html"><span class="number">9 </span><span class="name">File Copying with RSync</span></a></li></ol></li><li class="inactive"><a href="part.boot.html"><span class="number">II </span><span class="name">Booting a Linux System</span></a><ol><li class="inactive"><a href="cha.boot.html"><span class="number">10 </span><span class="name">Introduction to the Booting Process</span></a></li><li class="inactive"><a href="cha.uefi.html"><span class="number">11 </span><span class="name">UEFI (Unified Extensible Firmware Interface)</span></a></li><li class="inactive"><a href="cha.grub2.html"><span class="number">12 </span><span class="name">The Boot Loader GRUB 2</span></a></li><li class="inactive"><a href="cha.systemd.html"><span class="number">13 </span><span class="name">The <code class="systemitem">systemd</code> Daemon</span></a></li></ol></li><li class="inactive"><a href="part.system.html"><span class="number">III </span><span class="name">System</span></a><ol><li class="inactive"><a href="cha.64bit.html"><span class="number">14 </span><span class="name">32-Bit and 64-Bit Applications in a 64-Bit System Environment</span></a></li><li class="inactive"><a href="cha.journalctl.html"><span class="number">15 </span><span class="name"><code class="command">journalctl</code>: Query the <code class="systemitem">systemd</code> Journal</span></a></li><li class="inactive"><a href="cha.update-alternative.html"><span class="number">16 </span><span class="name"><code class="command">update-alternatives</code>: Managing Multiple Versions of Commands and Files</span></a></li><li class="inactive"><a href="cha.network.html"><span class="number">17 </span><span class="name">Basic Networking</span></a></li><li class="inactive"><a href="cha.print.html"><span class="number">18 </span><span class="name">Printer Operation</span></a></li><li class="inactive"><a href="cha.x11.html"><span class="number">19 </span><span class="name">The X Window System</span></a></li><li class="inactive"><a href="cha.fuse.html"><span class="number">20 </span><span class="name">Accessing File Systems with FUSE</span></a></li><li class="inactive"><a href="cha.mod.html"><span class="number">21 </span><span class="name">Managing Kernel Modules</span></a></li><li class="inactive"><a href="cha.udev.html"><span class="number">22 </span><span class="name">Dynamic Kernel Device Management with <code class="systemitem">udev</code></span></a></li><li class="inactive"><a href="cha.kgraft.html"><span class="number">23 </span><span class="name">Live Patching the Linux Kernel Using kGraft</span></a></li><li class="inactive"><a href="cha.suse.html"><span class="number">24 </span><span class="name">Special System Features</span></a></li><li class="inactive"><a href="cha.nm.html"><span class="number">25 </span><span class="name">Using NetworkManager</span></a></li><li class="inactive"><a href="cha.power-mgmt.html"><span class="number">26 </span><span class="name">Power Management</span></a></li></ol></li><li class="inactive"><a href="part.services.html"><span class="number">IV </span><span class="name">Services</span></a><ol><li class="inactive"><a href="cha.ntp.html"><span class="number">27 </span><span class="name">Time Synchronization with NTP</span></a></li><li class="inactive"><a href="cha.dns.html"><span class="number">28 </span><span class="name">The Domain Name System</span></a></li><li class="inactive"><a href="cha.dhcp.html"><span class="number">29 </span><span class="name">DHCP</span></a></li><li class="inactive"><a href="cha.nfs.html"><span class="number">30 </span><span class="name">Sharing File Systems with NFS</span></a></li><li class="inactive"><a href="cha.samba.html"><span class="number">31 </span><span class="name">Samba</span></a></li><li class="inactive"><a href="cha.autofs.html"><span class="number">32 </span><span class="name">On-Demand Mounting with Autofs</span></a></li><li class="inactive"><a href="cha.slp.html"><span class="number">33 </span><span class="name">SLP</span></a></li><li class="inactive"><a href="cha.apache2.html"><span class="number">34 </span><span class="name">The Apache HTTP Server</span></a></li><li class="inactive"><a href="cha.ftp.html"><span class="number">35 </span><span class="name">Setting Up an FTP Server with YaST</span></a></li><li class="inactive"><a href="cha.squid.html"><span class="number">36 </span><span class="name">The Proxy Server Squid</span></a></li><li class="inactive"><a href="cha.wbem.html"><span class="number">37 </span><span class="name">Web Based Enterprise Management Using SFCB</span></a></li></ol></li><li class="inactive"><a href="part.trouble.html"><span class="number">V </span><span class="name">Troubleshooting</span></a><ol><li class="inactive"><a href="cha.adminhelp.html"><span class="number">38 </span><span class="name">Help and Documentation</span></a></li><li class="inactive"><a href="cha.adm.support.html"><span class="number">39 </span><span class="name">Gathering System Information for Support</span></a></li><li class="inactive"><a href="cha.trouble.html"><span class="number">40 </span><span class="name">Common Problems and Their Solutions</span></a></li></ol></li><li class="inactive"><a href="app.nwscheme.html"><span class="number">A </span><span class="name">An Example Network</span></a></li><li class="inactive"><a href="bk01apb.html"><span class="number">B </span><span class="name">GNU Licenses</span></a></li></ol></div><div class="clearme"></div></div></div></div><div id="_nav-area" class="inactive"><div class="tool"><span class="nav-inner"><span class="tool-label">Navigation</span><a accesskey="p" class="tool-spacer" title="Part IV. Services" href="part.services.html"><span class="prev-icon">←</span></a><a accesskey="n" class="tool-spacer" title="Chapter 28. The Domain Name System" href="cha.dns.html"><span class="next-icon">→</span></a></span></div></div></div></div><div id="_fixed-header-wrap" class="inactive"><div id="_fixed-header"><div class="crumbs"><a class="book-link" href="index.html" title="SUSE Linux Enterprise Server Documentation"><span class="book-icon">SUSE Linux Enterprise Server Documentation</span></a><span> › </span><a class="crumb" href="book.sle.admin.html">Administration Guide</a><span> › </span><a class="crumb" href="part.services.html">Services</a><span> › </span><a class="crumb" href="cha.ntp.html">Time Synchronization with NTP</a></div><div class="buttons"><a class="top-button button" href="#">Top</a><div class="button"><a accesskey="p" class="tool-spacer" title="Part IV. Services" href="part.services.html"><span class="prev-icon">←</span></a><a accesskey="n" class="tool-spacer" title="Chapter 28. The Domain Name System" href="cha.dns.html"><span class="next-icon">→</span></a></div><div class="clearme"></div></div><div class="clearme"></div></div></div><div id="_content" class="draft "><div class="documentation"><div class="chapter " id="cha.ntp"><div class="titlepage"><div><div class="version-info">Applies to  <span class="productname"><span class="productname"><span class="phrase">SUSE Linux Enterprise Server</span></span></span> <span class="productnumber"><span class="productnumber"><span class="phrase">15</span></span></span></div><div><h2 class="title"><span class="number">27 </span><span class="name">Time Synchronization with NTP</span> </h2><div class="doc-status"><ul><li><span class="ds-label">Filename: </span>chrony.xml</li><li><span class="ds-label">ID: </span>cha.ntp</li></ul></div></div><div><div class="abstract"><div class="abstract-title-wrap"><h6 class="abstract-title">Abstract<a title="Permalink" class="permalink" href="cha.ntp.html#idm140374840234336">#</a></h6></div><p>
    The NTP (network time protocol) mechanism is a protocol for synchronizing
    the system time over the network. First, a machine can obtain the time from
    a server that is a reliable time source. Second, a machine can itself act
    as a time source for other computers in the network. The goal is
    twofold—maintaining the absolute time and synchronizing the system
    time of all machines within a network.
   </p></div></div></div></div><div class="line"><div class="toc"><dl><dt><span class="sect1"><a href="cha.ntp.html#sec.ntp.yast"><span class="number">27.1 </span><span class="name">Configuring an NTP Client with YaST</span></a></span></dt><dt><span class="sect1"><a href="cha.ntp.html#sec.netz.xntp.netconf"><span class="number">27.2 </span><span class="name">Manually Configuring NTP in the Network</span></a></span></dt><dt><span class="sect1"><a href="cha.ntp.html#ntp.chronyc"><span class="number">27.3 </span><span class="name">Configure <code class="systemitem">chronyd</code> at Runtime using <code class="command">chronyc</code></span></a></span></dt><dt><span class="sect1"><a href="cha.ntp.html#sec.netz.xntp.dynamic"><span class="number">27.4 </span><span class="name">Dynamic Time Synchronization at Runtime</span></a></span></dt><dt><span class="sect1"><a href="cha.ntp.html#sec.netz.xntp.normal"><span class="number">27.5 </span><span class="name">Setting Up a Local Reference Clock</span></a></span></dt><dt><span class="sect1"><a href="cha.ntp.html#sec.netz.xntp.etr"><span class="number">27.6 </span><span class="name">Clock Synchronization to an External Time Reference (ETR)</span></a></span></dt></dl></div></div><p>
  Maintaining an exact system time is important in many situations. The
  built-in hardware clock does often not meet the requirements of applications
  such as databases or clusters. Manual correction of the system time would
  lead to severe problems because, for example, a backward leap can cause
  malfunction of critical applications. Within a network, it is usually
  necessary to synchronize the system time of all machines, but manual time
  adjustment is a bad approach. NTP provides a mechanism to solve these
  problems. The NTP service continuously adjusts the system time with reliable
  time servers in the network. It further enables the management of local
  reference clocks, such as radio-controlled clocks.
 </p><p>
  Since <span class="productname"><span class="phrase">SUSE Linux Enterprise Server</span></span> 15, <code class="systemitem">chrony</code> is the default implementation of NTP.
  <code class="systemitem">chrony</code> includes two parts; <code class="systemitem">chronyd</code> is a daemon that can be started at
  boot time and <code class="command">chronyc</code> is a command line interface program to monitor the
  performance of <code class="systemitem">chronyd</code>, and to change various operating parameters at
  runtime.
 </p><div class="sect1 " id="sec.ntp.yast"><div class="titlepage"><div><div><h2 class="title" id="sec.ntp.yast"><span class="number">27.1 </span><span class="name">Configuring an NTP Client with YaST</span> <a title="Permalink" class="permalink" href="cha.ntp.html#sec.ntp.yast">#</a></h2></div></div></div><p>
   The NTP daemon (<code class="systemitem">chronyd</code>) coming with the <code class="systemitem">chrony</code>
   package is preset to use the local computer hardware clock as a time
   reference.  The precision of a hardware clock heavily depends on its time
   source. For example, an atomic clock or GPS receiver is a very precise time
   source, while a common RTC chip is not a reliable time source.  YaST
   simplifies the configuration of an NTP client.
  </p><p>
   In the YaST NTP client configuration (<span class="guimenu">Network
   Services</span> › <span class="guimenu">NTP Configuration</span>)
   window, you can specify when to start NTP daemon, the type of the
   configuration source, and add custom time servers.
  </p><div class="figure" id="idm140374840220544"><div class="figure-contents"><div class="mediaobject"><a xmlns="" href="images/ntp_client.png"><img src="images/ntp_client.png" width="" alt="NTP Configuration Window" /></a></div></div><div class="figure-title-wrap"><h6 class="figure-title"><span class="number">Figure 27.1: </span><span class="name">NTP Configuration Window </span><a title="Permalink" class="permalink" href="cha.ntp.html#idm140374840220544">#</a></h6></div></div><div class="sect2 " id="idm140374840215536"><div class="titlepage"><div><div><h3 class="title" id="idm140374840215536"><span class="number">27.1.1 </span><span class="name">NTP Daemon Start</span> <a title="Permalink" class="permalink" href="cha.ntp.html#idm140374840215536">#</a></h3></div></div></div><p>
    You can choose from three options when to start the NTP daemon:
   </p><div class="variablelist "><dl class="variablelist"><dt id="idm140374840214000"><span class="term "><span class="guimenu">Only Manually</span>
     </span></dt><dd><p>
       Select <span class="guimenu">Only Manually</span>, if you want to manually start
       the <code class="systemitem">chrony</code> daemon.
      </p></dd><dt id="idm140374840210720"><span class="term "><span class="guimenu">Synchronize without Daemon</span>
     </span></dt><dd><p>
       Select <span class="guimenu">Synchronize without Daemon</span> to set the system
       time periodically without a permanently running <code class="systemitem">chrony</code>. You can set
       the <span class="guimenu">Interval of the Synchronization in Minutes</span>.
      </p></dd><dt id="idm140374840206880"><span class="term "><span class="guimenu">Now and On Boot</span>
     </span></dt><dd><p>
       Select <span class="guimenu">Now and On Boot</span> to start <code class="systemitem">chronyd</code>
       automatically when the system is booted. This setting is recommended.
      </p></dd></dl></div></div><div class="sect2 " id="idm140374840203248"><div class="titlepage"><div><div><h3 class="title" id="idm140374840203248"><span class="number">27.1.2 </span><span class="name">Type of the Configuration Source</span> <a title="Permalink" class="permalink" href="cha.ntp.html#idm140374840203248">#</a></h3></div></div></div><p>
    In the <span class="guimenu">Configuration Source</span> drop-down list, select
    either <span class="guimenu">Dynamic</span> or <span class="guimenu">Static</span>. Set
    <span class="guimenu">Static</span> if your server uses only a fixed set of (public)
    NTP servers, while <span class="guimenu">Dynamic</span> is better if your internal
    network offers NTP servers via DHCP.
   </p></div><div class="sect2 " id="sec.net.ntp.yast.new_sync"><div class="titlepage"><div><div><h3 class="title" id="sec.net.ntp.yast.new_sync"><span class="number">27.1.3 </span><span class="name">Configure Time Servers</span> <a title="Permalink" class="permalink" href="cha.ntp.html#sec.net.ntp.yast.new_sync">#</a></h3></div></div></div><p>
    Time servers for the client to query are listed in the lower part of the
    <span class="guimenu">NTP Configuration</span> window. Modify this list as needed
    with <span class="guimenu">Add</span>, <span class="guimenu">Edit</span>, and
    <span class="guimenu">Delete</span>.
   </p><p>
    Click <span class="guimenu">Add</span> to add a new time server:
   </p><div class="figure" id="idm140374840195120"><div class="figure-contents"><div class="mediaobject"><a xmlns="" href="images/ntp_client_serveradd.png"><img src="images/ntp_client_serveradd.png" width="" alt="Adding a Time Server" /></a></div></div><div class="figure-title-wrap"><h6 class="figure-title"><span class="number">Figure 27.2: </span><span class="name">Adding a Time Server </span><a title="Permalink" class="permalink" href="cha.ntp.html#idm140374840195120">#</a></h6></div></div><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
      In the <span class="guimenu">Address</span> field, type the URL of the time server
      or pool of time servers with which you want to synchronize the machine
      time. After the URL is complete, click <span class="guimenu">Test</span> to verify
      that it points to a valid time source.
     </p></li><li class="step "><p>
      Activate <span class="guimenu">Quick Initial Sync</span> to speed up the time
      synchronization by sending more requests at the <code class="systemitem">chronyd</code> daemon start.
     </p></li><li class="step "><p>
      Activate <span class="guimenu">Start Offline</span> to speed up the boot time on
      systems that start the <code class="systemitem">chronyd</code> daemon automatically and may not have an
      internet connection at boot time. This option is useful for example for
      laptops whose network connection is managed by NetworkManager.
     </p></li><li class="step "><p>
      Confirm with <span class="guimenu">OK</span>
     </p></li></ol></div></div></div></div><div class="sect1 " id="sec.netz.xntp.netconf"><div class="titlepage"><div><div><h2 class="title" id="sec.netz.xntp.netconf"><span class="number">27.2 </span><span class="name">Manually Configuring NTP in the Network</span> <a title="Permalink" class="permalink" href="cha.ntp.html#sec.netz.xntp.netconf">#</a></h2></div></div></div><p>
   <code class="systemitem">chrony</code> reads its configuration from the
   <code class="filename">/etc/chrony.conf</code> file. To keep the computer clock
   synchronized, you need to tell <code class="systemitem">chrony</code> what time servers to use. You can
   use specific server names or IP addresses, for example:
  </p><div class="verbatim-wrap"><pre class="screen">server 0.europe.pool.ntp.org
server 1.europe.pool.ntp.org
server 2.europe.pool.ntp.org</pre></div><p>
   You can also specify a <span class="emphasis"><em>pool</em></span> name. Pool name resolves to
   several IP addresses:
  </p><div class="verbatim-wrap"><pre class="screen">pool pool.ntp.org</pre></div><div id="idm140374840176064" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.png" /><h6>Tip: Computers on the Same Network</h6><p>
    To synchronize time on multiple computers on the same network, we do not
    recommend to synchronize all of them with an external server. A good
    practice is to make one computer the time server which is synchronized with
    an external time server, and the other computers act as its clients. Add a
    <code class="literal">local</code> directive to the server's
    <code class="filename">/etc/chrony.conf</code> to distinguish it from an
    authoritative time server:
   </p><div class="verbatim-wrap"><pre class="screen">local stratum 10</pre></div></div><p>
   To start <code class="systemitem">chrony</code>, run:
  </p><div class="verbatim-wrap"><pre class="screen">systemctl start chronyd.service</pre></div><p>
   After initializing <code class="systemitem">chronyd</code>, it takes some time before the time is
   stabilized and the drift file for correcting the local computer clock is
   created. With the drift file, the systematic error of the hardware clock can
   be computed when the computer is powered on. The correction is used
   immediately, resulting in a higher stability of the system time.
  </p><p>
   To enable the service so that <code class="systemitem">chrony</code> starts automatically at boot time,
   run:
  </p><div class="verbatim-wrap"><pre class="screen">systemctl enable chronyd.service</pre></div></div><div class="sect1 " id="ntp.chronyc"><div class="titlepage"><div><div><h2 class="title" id="ntp.chronyc"><span class="number">27.3 </span><span class="name">Configure <code class="systemitem">chronyd</code> at Runtime using <code class="command">chronyc</code></span> <a title="Permalink" class="permalink" href="cha.ntp.html#ntp.chronyc">#</a></h2></div></div></div><p>
   You can use <code class="command">chronyc</code> to change the behavior of <code class="systemitem">chronyd</code> at runtime. It
   also generates status reports about the operation of <code class="systemitem">chronyd</code>.
  </p><p>
   You can run <code class="command">chronyc</code> either in interactive a or non-interactive mode. To
   run <code class="command">chronyc</code> interactively, enter <code class="command">chronyc</code> on the command line. It
   displays a prompt and waits for your command input. For example, to check
   how many NTP sources are online or offline, run:
  </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code><code class="command">chronyc</code>
chronyc&gt; activity
200 OK
4 sources online
2 sources offline
1 sources doing burst (return to online)
1 sources doing burst (return to offline)
0 sources with unknown address</pre></div><p>
   To exit <code class="command">chronyc</code>'s prompt, enter <code class="command">quit</code> or
   <code class="command">exit</code>.
  </p><p>
   If you do not need to use the interactive prompt, enter the command
   directly:
  </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code><code class="command">chronyc</code> activity</pre></div><div id="idm140374840156400" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note: Temporary Changes</h6><p>
    Changes made using <code class="command">chronyc</code> are not permanent. They will be lost after the
    next <code class="systemitem">chronyd</code> restart. For permanent changes, modify
    <code class="filename">/etc/chrony.conf</code>.
   </p></div><p>
   For a complete list of <code class="command">chronyc</code> commands, see its manual page (<code class="command">man
   1 chronyc</code>).
  </p></div><div class="sect1 " id="sec.netz.xntp.dynamic"><div class="titlepage"><div><div><h2 class="title" id="sec.netz.xntp.dynamic"><span class="number">27.4 </span><span class="name">Dynamic Time Synchronization at Runtime</span> <a title="Permalink" class="permalink" href="cha.ntp.html#sec.netz.xntp.dynamic">#</a></h2></div></div></div><p>
   If the system boots without network connection, <code class="systemitem">chronyd</code> starts up, but it
   cannot resolve DNS names of the time servers set in the configuration file.
   This can happen if you use NetworkManager with an encrypted Wi-Fi.
  </p><p>
   <code class="systemitem">chronyd</code> keeps trying to resolve the time server names specified by the
   <code class="option">server</code>, <code class="option">pool</code>, and <code class="option">peer</code>
   directives in an increasing time interval until it succeeds.
  </p><p>
   If the time server will not be reachable when <code class="systemitem">chronyd</code> is started, you can
   specify the <code class="option">offline</code> option:
  </p><div class="verbatim-wrap"><pre class="screen">server <em class="replaceable ">server_address</em> offline</pre></div><p>
   <code class="systemitem">chronyd</code> will then not try to poll the server until it is enabled using the
   following command:
  </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>chronyc online <em class="replaceable ">server_address</em></pre></div><p>
   When the <code class="option">auto_offline</code> option is set, <code class="systemitem">chronyd</code> assumes that
   the time server has gone offline when 2 requests have been sent to it
   without receiving a response. This option avoids the need to run the
   'offline' command from <code class="command">chronyc</code> when disconnecting the network link.
  </p></div><div class="sect1 " id="sec.netz.xntp.normal"><div class="titlepage"><div><div><h2 class="title" id="sec.netz.xntp.normal"><span class="number">27.5 </span><span class="name">Setting Up a Local Reference Clock</span> <a title="Permalink" class="permalink" href="cha.ntp.html#sec.netz.xntp.normal">#</a></h2></div></div></div><p>
   The software package <code class="systemitem">chrony</code> relies on other programs (such as
   <code class="systemitem">gpsd</code>) to access the timing data via the SHM or SOCK
   driver. Use the <code class="option">refclock</code> directive in
   <code class="filename">/etc/chrony.conf</code> to specify a hardware reference clock
   to be used as a time source. It has two mandatory parameters; a driver name
   and a driver-specific parameter. The two parameters are followed by zero or
   more <code class="option">refclock</code> options. <code class="systemitem">chronyd</code> includes the following
   drivers:
  </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
     PPS - driver for the kernel 'pulse per second' API. For example:
    </p><div class="verbatim-wrap"><pre class="screen">refclock PPS /dev/pps0 lock NMEA refid GPS</pre></div></li><li class="listitem "><p>
     SHM - NTP shared memory driver. For example:
    </p><div class="verbatim-wrap"><pre class="screen">refclock SHM 0 poll 3 refid GPS1
refclock SHM 1:perm=0644 refid GPS2</pre></div></li><li class="listitem "><p>
     SOCK - Unix domain socket driver. For example:
    </p><div class="verbatim-wrap"><pre class="screen">refclock SOCK /var/run/chrony.ttyS0.sock</pre></div></li><li class="listitem "><p>
     PHC - PTP hardware clock driver. For example:
    </p><div class="verbatim-wrap"><pre class="screen">refclock PHC /dev/ptp0 poll 0 dpoll -2 offset -37
refclock PHC /dev/ptp1:nocrossts poll 3 pps</pre></div></li></ul></div><p>
   For more information on individual drivers' options, see <code class="command">man 8
   chrony.conf</code>.
  </p></div><div class="sect1 " id="sec.netz.xntp.etr"><div class="titlepage"><div><div><h2 class="title" id="sec.netz.xntp.etr"><span class="number">27.6 </span><span class="name">Clock Synchronization to an External Time Reference (ETR)</span> <a title="Permalink" class="permalink" href="cha.ntp.html#sec.netz.xntp.etr">#</a></h2></div></div></div><p>
   Support for clock synchronization to an external time reference (ETR) is
   available. The external time reference sends an oscillator signal and a
   synchronization signal every 2**20 (2 to the power of 20) microseconds to
   keep TOD clocks of all connected servers synchronized.
  </p><p>
   For availability two ETR units can be connected to a machine. If the clock
   deviates for more than the sync-check tolerance all CPUs get a machine check
   that indicates that the clock is out of sync. If this happens, all DASD I/O
   to XRC enabled devices is stopped until the clock is synchronized again.
  </p><p>
   The ETR support is activated via two <code class="literal">sysfs</code> attributes;
   run the following commands as <code class="systemitem">root</code>:
  </p><div class="verbatim-wrap"><pre class="screen">echo 1 &gt; /sys/devices/system/etr/etr0/online
echo 1 &gt; /sys/devices/system/etr/etr1/online</pre></div></div></div></div><div class="page-bottom"><div id="_bottom-navigation"><a class="nav-link" href="cha.dns.html"><span class="next-icon">→</span><span class="nav-label"><span class="number">Chapter 28 </span>The Domain Name System</span></a><a class="nav-link" href="part.services.html"><span class="prev-icon">←</span><span class="nav-label"><span class="number">Part IV </span>Services</span></a></div><div id="_share-print"><div class="online-contents share"><strong>Share this page: </strong><span class="share-buttons"><span id="_share-fb" class="bottom-button">Facebook</span><span class="spacer"> • </span><span id="_share-gp" class="bottom-button">Google+</span><span class="spacer"> • </span><span id="_share-tw" class="bottom-button">Twitter</span><span class="spacer"> • </span><span id="_share-mail" class="bottom-button">E-Mail</span></span></div><div class="print"><span id="_print-button" class="bottom-button">Print this page</span></div><div class="clearme"></div></div></div></div><div id="_inward"></div></div><div id="_footer-wrap"><div id="_footer"><p>©
        2018 
        SUSE</p><ul><li><a href="http://www.suse.com/company/careers/" target="_top">Careers</a></li><li><a href="http://www.suse.com/company/legal/" target="_top">Legal</a></li><li><a href="http://www.suse.com/company/" target="_top">About</a></li><li><a href="http://www.suse.com/ContactsOffices/contacts_offices.jsp" target="_top">Contact Us</a></li></ul></div></div></body></html>