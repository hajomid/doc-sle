<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang=""><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Cloning Disk Images | Deployment Guide | SUSE Linux Enterprise Server 15</title><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" /><link rel="stylesheet" type="text/css" href="static/css/style.css" /><link rel="stylesheet" type="text/css" href="static/css/highlight.css" /><meta name="generator" content="DAPS 2.4.0 using SUSE XSL Stylesheets 2.0.8 (based on DocBook XSL Stylesheets 1.78.1) - chunked" /><meta name="product-name" content="SUSE Linux Enterprise Server" /><meta name="product-number" content="15" /><meta name="book-title" content="Deployment Guide" /><meta name="chapter-title" content="Chapter 11. Cloning Disk Images" /><meta name="description" content="This chapter describes how to use cloned images for installing SUSE Linux Enterprise Server. This is mostly used in virtualized environments." /><meta name="tracker-url" content="https://bugzilla.suse.com/enter_bug.cgi" /><meta name="tracker-type" content="bsc" /><meta name="tracker-bsc-assignee" content="fs@suse.com" /><meta name="tracker-bsc-component" content="Documentation" /><meta name="tracker-bsc-product" content="Beta SUSE Linux Enterprise Server 15" /><link rel="home" href="index.html" title="SUSE Linux Enterprise Server Documentation" /><link rel="up" href="part.deployment.html" title="Part II. Installation Procedure" /><link rel="prev" href="cha.remote_installation.html" title="Chapter 10. Remote Installation" /><link rel="next" href="cha.installation_troubleshooting.html" title="Chapter 12. Troubleshooting" /><script type="text/javascript">

var protocol = window.location.protocol.toLowerCase();
if ( protocol != 'file:' ) {
  var agent = navigator.userAgent.toLowerCase();
  var wanted = ( protocol == 'https:') ? 'https' : 'http';
  var file = 'fonts.css';
  document.write('<link rel="stylesheet" type="text/css" href="' + wanted + '://static.opensuse.org/fonts/'+ file +'"></link>');
}
else {
   document.write('<link rel="stylesheet" type="text/css" href="static/css/fonts-onlylocal.css"></link>');
}

</script><noscript><link rel="stylesheet" type="text/css" href="http://static.opensuse.org/fonts/fonts.css" /></noscript><script src="static/js/jquery-1.10.2.min.js" type="text/javascript"></script><script src="static/js/script.js" type="text/javascript"></script><script src="static/js/highlight.min.js" type="text/javascript"></script><script>

$(document).ready(function() {
  $('.verbatim-wrap.highlight').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});
hljs.configure({
  useBR: false
});

</script></head><body class="draft offline js-off"><div id="_outer-wrap"><div id="_white-bg"><div id="_header"><div id="_logo"><img src="static/images/logo.png" alt="Logo" /></div><div class="crumbs"><a class="book-link" href="index.html" title="SUSE Linux Enterprise Server Documentation"><span class="book-icon">SUSE Linux Enterprise Server Documentation</span></a><span> › </span><a class="crumb" href="book.sle.deployment.html">Deployment Guide</a><span> › </span><a class="crumb" href="part.deployment.html">Installation Procedure</a><span> › </span><a class="crumb" href="cha.deployment.clone_image.html">Cloning Disk Images</a></div><div class="clearme"></div></div></div><div id="_toolbar-wrap"><div id="_toolbar"><div id="_toc-area" class="inactive"><a id="_toc-area-button" class="tool" title="Contents" accesskey="c" href="index.html"><span class="tool-spacer"><span class="toc-icon">Contents</span><span class="clearme"></span></span><span class="tool-label">Contents</span></a><div class="active-contents bubble-corner"></div><div class="active-contents bubble"><div class="bubble-container"><h6>Deployment Guide</h6><div id="_bubble-toc"><ol><li class="inactive"><a href="preface.deployment.html"><span class="number"> </span><span class="name">About This Guide</span></a></li><li class="inactive"><a href="part.prep.html"><span class="number">I </span><span class="name">Installation Preparation</span></a><ol><li class="inactive"><a href="cha.planning.html"><span class="number">1 </span><span class="name">Planning for <span class="productname"><span class="phrase">SUSE Linux Enterprise Server</span></span></span></a></li><li class="inactive"><a href="cha.x86.html"><span class="number">2 </span><span class="name">Installation on AMD64 and Intel 64</span></a></li><li class="inactive"><a href="cha.aarch64.html"><span class="number">3 </span><span class="name">Installation on ARM AArch64</span></a></li><li class="inactive"><a href="cha.power.html"><span class="number">4 </span><span class="name">Installation on IBM POWER</span></a></li><li class="inactive"><a href="cha.zseries.html"><span class="number">5 </span><span class="name">Installation on IBM Z</span></a></li><li class="inactive"><a href="cha.kiso.html"><span class="number">6 </span><span class="name">Installation on Hardware Not Supported at Release</span></a></li></ol></li><li class="inactive"><a href="part.deployment.html"><span class="number">II </span><span class="name">Installation Procedure</span></a><ol><li class="inactive"><a href="cha.boot_parameters.html"><span class="number">7 </span><span class="name">Boot Parameters</span></a></li><li class="inactive"><a href="cha.install.html"><span class="number">8 </span><span class="name">Installation Steps</span></a></li><li class="inactive"><a href="cha.expert_partitioner.html"><span class="number">9 </span><span class="name">Expert Partitioner</span></a></li><li class="inactive"><a href="cha.remote_installation.html"><span class="number">10 </span><span class="name">Remote Installation</span></a></li><li class="inactive"><a href="cha.deployment.clone_image.html"><span class="number">11 </span><span class="name">Cloning Disk Images</span></a></li><li class="inactive"><a href="cha.installation_troubleshooting.html"><span class="number">12 </span><span class="name">Troubleshooting</span></a></li></ol></li><li class="inactive"><a href="part.installserver.html"><span class="number">III </span><span class="name">Setting Up an Installation Server</span></a><ol><li class="inactive"><a href="cha.deployment.instserver.html"><span class="number">13 </span><span class="name">Setting Up a Network Installation Source</span></a></li><li class="inactive"><a href="cha.deployment.prep_pxe.html"><span class="number">14 </span><span class="name">Preparing Network Boot Environment</span></a></li></ol></li><li class="inactive"><a href="part.sysconfig.html"><span class="number">IV </span><span class="name">Initial System Configuration</span></a><ol><li class="inactive"><a href="cha.yast.hw.html"><span class="number">15 </span><span class="name">Setting Up Hardware Components with YaST</span></a></li><li class="inactive"><a href="cha.yast-software.html"><span class="number">16 </span><span class="name">Installing or Removing Software</span></a></li><li class="inactive"><a href="cha.add-ons.html"><span class="number">17 </span><span class="name">Installing Modules, Extensions, and Third Party Add-On Products</span></a></li><li class="inactive"><a href="cha.tuning.multikernel.html"><span class="number">18 </span><span class="name">Installing Multiple Kernel Versions</span></a></li><li class="inactive"><a href="cha.yast.userman.html"><span class="number">19 </span><span class="name">Managing Users with YaST</span></a></li><li class="inactive"><a href="cha.yast.lang.html"><span class="number">20 </span><span class="name">Changing Language and Country Settings with YaST</span></a></li></ol></li><li class="inactive"><a href="app.create-os-image.html"><span class="number">A </span><span class="name">Imaging and Creating Products</span></a></li><li class="inactive"><a href="bk02apb.html"><span class="number">B </span><span class="name">GNU Licenses</span></a></li></ol></div><div class="clearme"></div></div></div></div><div id="_nav-area" class="inactive"><div class="tool"><span class="nav-inner"><span class="tool-label">Navigation</span><a accesskey="p" class="tool-spacer" title="Chapter 10. Remote Installation" href="cha.remote_installation.html"><span class="prev-icon">←</span></a><a accesskey="n" class="tool-spacer" title="Chapter 12. Troubleshooting" href="cha.installation_troubleshooting.html"><span class="next-icon">→</span></a></span></div></div></div></div><div id="_fixed-header-wrap" class="inactive"><div id="_fixed-header"><div class="crumbs"><a class="book-link" href="index.html" title="SUSE Linux Enterprise Server Documentation"><span class="book-icon">SUSE Linux Enterprise Server Documentation</span></a><span> › </span><a class="crumb" href="book.sle.deployment.html">Deployment Guide</a><span> › </span><a class="crumb" href="part.deployment.html">Installation Procedure</a><span> › </span><a class="crumb" href="cha.deployment.clone_image.html">Cloning Disk Images</a></div><div class="buttons"><a class="top-button button" href="#">Top</a><div class="button"><a accesskey="p" class="tool-spacer" title="Chapter 10. Remote Installation" href="cha.remote_installation.html"><span class="prev-icon">←</span></a><a accesskey="n" class="tool-spacer" title="Chapter 12. Troubleshooting" href="cha.installation_troubleshooting.html"><span class="next-icon">→</span></a></div><div class="clearme"></div></div><div class="clearme"></div></div></div><div id="_content" class="draft "><div class="documentation"><div class="chapter " id="cha.deployment.clone_image"><div class="titlepage"><div><div class="version-info">Applies to  <span class="productname"><span class="productname"><span class="phrase">SUSE Linux Enterprise Server</span></span></span> <span class="productnumber"><span class="productnumber"><span class="phrase">15</span></span></span></div><div><h2 class="title"><span class="number">11 </span><span class="name">Cloning Disk Images</span> </h2><div class="doc-status"><ul><li><span class="ds-label">Filename: </span>deployment_image.xml</li><li><span class="ds-label">ID: </span>cha.deployment.clone_image</li></ul></div></div><div><div class="abstract"><div class="abstract-title-wrap"><h6 class="abstract-title">Abstract<a title="Permalink" class="permalink" href="cha.deployment.clone_image.html#idm139830468559936">#</a></h6></div><p>
    This chapter describes how to use cloned images for installing <span class="productname"><span class="phrase">SUSE Linux Enterprise Server</span></span>.
    This is mostly used in virtualized environments.
   </p></div></div></div></div><div class="line"><div class="toc"><dl><dt><span class="sect1"><a href="cha.deployment.clone_image.html#sec.deployment.clone_image.overview"><span class="number">11.1 </span><span class="name">Overview</span></a></span></dt><dt><span class="sect1"><a href="cha.deployment.clone_image.html#sec.deployment.clone_image.clean"><span class="number">11.2 </span><span class="name">Cleaning Up Unique System Identifiers</span></a></span></dt></dl></div></div><div class="sect1 " id="sec.deployment.clone_image.overview"><div class="titlepage"><div><div><h2 class="title" id="sec.deployment.clone_image.overview"><span class="number">11.1 </span><span class="name">Overview</span> <a title="Permalink" class="permalink" href="cha.deployment.clone_image.html#sec.deployment.clone_image.overview">#</a></h2></div></div></div><p>
   <span class="productname"><span class="phrase">SUSE Linux Enterprise Server</span></span> provides a script to clean up configuration that is unique
   to each installation. With the introduction of systemd, unique system
   identifiers are used and set in different locations and files. Therefore,
   cloning is no longer the recommended way to build system images.
   Images can be created with KIWI, see
   <a class="link" href="https://doc.opensuse.org/projects/kiwi/doc/" target="_blank">https://doc.opensuse.org/projects/kiwi/doc/</a>
  </p><p>
   To clone disks of machines, refer to the documentation of your
   virtualization environment.
  </p></div><div class="sect1 " id="sec.deployment.clone_image.clean"><div class="titlepage"><div><div><h2 class="title" id="sec.deployment.clone_image.clean"><span class="number">11.2 </span><span class="name">Cleaning Up Unique System Identifiers</span> <a title="Permalink" class="permalink" href="cha.deployment.clone_image.html#sec.deployment.clone_image.clean">#</a></h2></div></div></div><div id="idm139830468550784" class="admonition warning normal"><img class="symbol" alt="Warning" title="Warning" src="static/images/icon-warning.png" /><h6>Warning: Important Configuration Loss</h6><p>
    Executing the following procedure permanently deletes important
    system configuration data. If the source system for the clone is
    used in production, run the clean up script on the cloned image.
   </p></div><p>
   To clean all unique system identifiers, execute the following procedure
   before or after cloning a disk image. If run on the clone, this procedure
   needs to be run on each clone. Therefore, we recommend to create a
   <code class="literal">golden image</code> that is not used in production and only
   serves as a source for new clones. The golden image is already cleaned
   up and clones can be used immediately.
  </p><p>
   The <code class="command">clone-master-clean-up</code> command for example removes:
  </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>Swap files</p></li><li class="listitem "><p>Zypper repositories</p></li><li class="listitem "><p>SSH host and client keys</p></li><li class="listitem "><p>Temporary directories, like <code class="filename">/tmp/*</code></p></li><li class="listitem "><p>Postfix data</p></li><li class="listitem "><p>HANA firewall script</p></li><li class="listitem "><p>systemd journal</p></li></ul></div><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
     Use <code class="command">zypper</code> to install <span class="package">clone-master-clean-up</span>:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> <code class="command">zypper</code> install clone-master-clean-up</pre></div></li><li class="step "><p>
     Configure the behavior of <code class="command">clone-master-clean-up</code> by
     editing the <code class="filename">/etc/sysconfig/clone-master-clean-up</code>.
     This configuration file defines if users with a UID larger than 1000,
     the <code class="filename">/etc/sudoers</code> file, Zypper repositories and
     Btrfs snapshots should be removed.
    </p></li><li class="step "><p>
     Remove existing configuration and unique identifiers by running the script:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> <code class="command">clone-master-clean-up</code></pre></div></li></ol></div></div></div></div></div><div class="page-bottom"><div id="_bottom-navigation"><a class="nav-link" href="cha.installation_troubleshooting.html"><span class="next-icon">→</span><span class="nav-label"><span class="number">Chapter 12 </span>Troubleshooting</span></a><a class="nav-link" href="cha.remote_installation.html"><span class="prev-icon">←</span><span class="nav-label"><span class="number">Chapter 10 </span>Remote Installation</span></a></div><div id="_share-print"><div class="online-contents share"><strong>Share this page: </strong><span class="share-buttons"><span id="_share-fb" class="bottom-button">Facebook</span><span class="spacer"> • </span><span id="_share-gp" class="bottom-button">Google+</span><span class="spacer"> • </span><span id="_share-tw" class="bottom-button">Twitter</span><span class="spacer"> • </span><span id="_share-mail" class="bottom-button">E-Mail</span></span></div><div class="print"><span id="_print-button" class="bottom-button">Print this page</span></div><div class="clearme"></div></div></div></div><div id="_inward"></div></div><div id="_footer-wrap"><div id="_footer"><p>©
        2018 
        SUSE</p><ul><li><a href="http://www.suse.com/company/careers/" target="_top">Careers</a></li><li><a href="http://www.suse.com/company/legal/" target="_top">Legal</a></li><li><a href="http://www.suse.com/company/" target="_top">About</a></li><li><a href="http://www.suse.com/ContactsOffices/contacts_offices.jsp" target="_top">Contact Us</a></li></ul></div></div></body></html>