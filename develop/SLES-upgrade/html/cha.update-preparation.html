<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang=""><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Preparing the Upgrade | Upgrade Guide | SUSE Linux Enterprise Server 15</title><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" /><link rel="stylesheet" type="text/css" href="static/css/style.css" /><link rel="stylesheet" type="text/css" href="static/css/highlight.css" /><meta name="generator" content="DAPS 2.4.0 using SUSE XSL Stylesheets 2.0.8 (based on DocBook XSL Stylesheets 1.78.1) - chunked" /><meta name="product-name" content="SUSE Linux Enterprise Server" /><meta name="product-number" content="15" /><meta name="book-title" content="Upgrade Guide" /><meta name="chapter-title" content="Chapter 3. Preparing the Upgrade" /><meta name="description" content="Before starting the upgrade procedure, make sure your system is properly prepared. Among others, preparation involves backing up data and checking the release notes." /><meta name="tracker-url" content="https://bugzilla.suse.com/enter_bug.cgi" /><meta name="tracker-type" content="bsc" /><meta name="tracker-bsc-assignee" content="fs@suse.com" /><meta name="tracker-bsc-component" content="Documentation" /><meta name="tracker-bsc-product" content="Beta SUSE Linux Enterprise Server 15" /><link rel="home" href="index.html" title="SUSE Linux Enterprise Server Documentation" /><link rel="up" href="book.sle.upgrade.html" title="Upgrade Guide" /><link rel="prev" href="cha.update.sle.html" title="Chapter 2. Upgrade Paths and Methods" /><link rel="next" href="cha.update.offline.html" title="Chapter 4. Upgrading Offline" /><script type="text/javascript">

var protocol = window.location.protocol.toLowerCase();
if ( protocol != 'file:' ) {
  var agent = navigator.userAgent.toLowerCase();
  var wanted = ( protocol == 'https:') ? 'https' : 'http';
  var file = 'fonts.css';
  document.write('<link rel="stylesheet" type="text/css" href="' + wanted + '://static.opensuse.org/fonts/'+ file +'"></link>');
}
else {
   document.write('<link rel="stylesheet" type="text/css" href="static/css/fonts-onlylocal.css"></link>');
}

</script><noscript><link rel="stylesheet" type="text/css" href="http://static.opensuse.org/fonts/fonts.css" /></noscript><script src="static/js/jquery-1.10.2.min.js" type="text/javascript"></script><script src="static/js/script.js" type="text/javascript"></script><script src="static/js/highlight.min.js" type="text/javascript"></script><script>

$(document).ready(function() {
  $('.verbatim-wrap.highlight').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});
hljs.configure({
  useBR: false
});

</script></head><body class="draft offline js-off"><div id="_outer-wrap"><div id="_white-bg"><div id="_header"><div id="_logo"><img src="static/images/logo.png" alt="Logo" /></div><div class="crumbs"><a class="book-link" href="index.html" title="SUSE Linux Enterprise Server Documentation"><span class="book-icon">SUSE Linux Enterprise Server Documentation</span></a><span> › </span><a class="crumb" href="book.sle.upgrade.html">Upgrade Guide</a><span> › </span><a class="crumb" href="cha.update-preparation.html">Preparing the Upgrade</a></div><div class="clearme"></div></div></div><div id="_toolbar-wrap"><div id="_toolbar"><div id="_toc-area" class="inactive"><a id="_toc-area-button" class="tool" title="Contents" accesskey="c" href="index.html"><span class="tool-spacer"><span class="toc-icon">Contents</span><span class="clearme"></span></span><span class="tool-label">Contents</span></a><div class="active-contents bubble-corner"></div><div class="active-contents bubble"><div class="bubble-container"><h6>Upgrade Guide</h6><div id="_bubble-toc"><ol><li class="inactive"><a href="preface.upgrade.html"><span class="number"> </span><span class="name">About This Guide</span></a></li><li class="inactive"><a href="cha.update.background.html"><span class="number">1 </span><span class="name">Life Cycle and Support</span></a></li><li class="inactive"><a href="cha.update.sle.html"><span class="number">2 </span><span class="name">Upgrade Paths and Methods</span></a></li><li class="inactive"><a href="cha.update-preparation.html"><span class="number">3 </span><span class="name">Preparing the Upgrade</span></a></li><li class="inactive"><a href="cha.update.offline.html"><span class="number">4 </span><span class="name">Upgrading Offline</span></a></li><li class="inactive"><a href="cha.update.online.html"><span class="number">5 </span><span class="name">Upgrading Online</span></a></li><li class="inactive"><a href="cha.update.backporting.html"><span class="number">6 </span><span class="name">Backporting Source Code</span></a></li><li class="inactive"><a href="bk03apa.html"><span class="number">A </span><span class="name">GNU Licenses</span></a></li></ol></div><div class="clearme"></div></div></div></div><div id="_nav-area" class="inactive"><div class="tool"><span class="nav-inner"><span class="tool-label">Navigation</span><a accesskey="p" class="tool-spacer" title="Chapter 2. Upgrade Paths and Methods" href="cha.update.sle.html"><span class="prev-icon">←</span></a><a accesskey="n" class="tool-spacer" title="Chapter 4. Upgrading Offline" href="cha.update.offline.html"><span class="next-icon">→</span></a></span></div></div></div></div><div id="_fixed-header-wrap" class="inactive"><div id="_fixed-header"><div class="crumbs"><a class="book-link" href="index.html" title="SUSE Linux Enterprise Server Documentation"><span class="book-icon">SUSE Linux Enterprise Server Documentation</span></a><span> › </span><a class="crumb" href="book.sle.upgrade.html">Upgrade Guide</a><span> › </span><a class="crumb" href="cha.update-preparation.html">Preparing the Upgrade</a></div><div class="buttons"><a class="top-button button" href="#">Top</a><div class="button"><a accesskey="p" class="tool-spacer" title="Chapter 2. Upgrade Paths and Methods" href="cha.update.sle.html"><span class="prev-icon">←</span></a><a accesskey="n" class="tool-spacer" title="Chapter 4. Upgrading Offline" href="cha.update.offline.html"><span class="next-icon">→</span></a></div><div class="clearme"></div></div><div class="clearme"></div></div></div><div id="_content" class="draft "><div class="documentation"><div class="chapter " id="cha.update-preparation"><div class="titlepage"><div><div class="version-info">Applies to  <span class="productname"><span class="productname"><span class="phrase">SUSE Linux Enterprise Server</span></span></span> <span class="productnumber"><span class="productnumber"><span class="phrase">15</span></span></span></div><div><h1 class="title"><span class="number">3 </span><span class="name">Preparing the Upgrade</span> </h1><div class="doc-status"><ul><li><span class="ds-label">Filename: </span>sle_update_preparation.xml</li><li><span class="ds-label">ID: </span>cha.update-preparation</li></ul></div></div><div><div class="abstract"><div class="abstract-title-wrap"><h6 class="abstract-title">Abstract<a title="Permalink" class="permalink" href="cha.update-preparation.html#idm139696324713872">#</a></h6></div><p>
    Before starting the upgrade procedure, make sure your system is properly
    prepared. Among others, preparation involves backing up data and checking
    the release notes.
   </p></div></div></div></div><div class="line"><div class="toc"><dl><dt><span class="sect1"><a href="cha.update-preparation.html#sec.update-preparation.update"><span class="number">3.1 </span><span class="name">Make Sure the Current System is Up-To-Date</span></a></span></dt><dt><span class="sect1"><a href="cha.update-preparation.html#sec.update-preparation.relnotes"><span class="number">3.2 </span><span class="name">Read the Release Notes</span></a></span></dt><dt><span class="sect1"><a href="cha.update-preparation.html#sec.update-preparation.backup"><span class="number">3.3 </span><span class="name">Make a Backup</span></a></span></dt><dt><span class="sect1"><a href="cha.update-preparation.html#sec.update-preparation.sle11"><span class="number">3.4 </span><span class="name">Upgrading from <span class="productname"><span class="phrase">SUSE Linux Enterprise Server</span></span> 11 SP4</span></a></span></dt><dt><span class="sect1"><a href="cha.update-preparation.html#sec.update-preparation.vms"><span class="number">3.5 </span><span class="name">Shut Down Virtual Machine Guests</span></a></span></dt><dt><span class="sect1"><a href="cha.update-preparation.html#sec.update-preparation.smt"><span class="number">3.6 </span><span class="name">Check the <code class="command">clientSetup4SMT.sh</code> Script on SMT Clients</span></a></span></dt><dt><span class="sect1"><a href="cha.update-preparation.html#sec.update-preparation.disk"><span class="number">3.7 </span><span class="name">Disk Space</span></a></span></dt><dt><span class="sect1"><a href="cha.update-preparation.html#sec.update-preparation.multiversion"><span class="number">3.8 </span><span class="name">Temporarily Disabling Kernel Multiversion Support</span></a></span></dt><dt><span class="sect1"><a href="cha.update-preparation.html#sec.update-preparation.zseries"><span class="number">3.9 </span><span class="name">Upgrading on IBM z Systems</span></a></span></dt><dt><span class="sect1"><a href="cha.update-preparation.html#sec.update-preparation.ppc"><span class="number">3.10 </span><span class="name">IBM POWER: Starting an X Server</span></a></span></dt></dl></div></div><div class="sect1 " id="sec.update-preparation.update"><div class="titlepage"><div><div><h2 class="title" id="sec.update-preparation.update"><span class="number">3.1 </span><span class="name">Make Sure the Current System is Up-To-Date</span> <a title="Permalink" class="permalink" href="cha.update-preparation.html#sec.update-preparation.update">#</a></h2></div></div></div><p>
   Upgrading the system is only supported from the most recent
   patch-level. Make sure the latest system updates are installed by either
   running <code class="command">zypper patch</code> or by starting the YaST module
   <span class="guimenu">Online-Update</span>.
  </p></div><div class="sect1 " id="sec.update-preparation.relnotes"><div class="titlepage"><div><div><h2 class="title" id="sec.update-preparation.relnotes"><span class="number">3.2 </span><span class="name">Read the Release Notes</span> <a title="Permalink" class="permalink" href="cha.update-preparation.html#sec.update-preparation.relnotes">#</a></h2></div></div></div><p>
   In the release notes you can find additional information on changes
   since the previous release of <span class="productname"><span class="phrase">SUSE Linux Enterprise Server</span></span>. Check the release notes
   to see whether:
  </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
     your hardware needs special considerations;
    </p></li><li class="listitem "><p>
     any used software packages have changed significantly;
    </p></li><li class="listitem "><p>
     special precautions are necessary for your installation.
    </p></li></ul></div><p>
   The release notes also provide information that could not make it
   into the manual on time. They also contain notes about known issues.
  </p><p>
   If you are skipping one or more Service Packs, check the release
   notes of the skipped Service Packs as well. The release notes
   usually only contain the changes between two subsequent releases.
   You can miss important changes if you are only reading the
   current release notes.
  </p><p>
   Find the release notes locally in the directory
   <code class="filename">/usr/share/doc/release-notes</code> or online at
   <a class="link" href="https://www.suse.com/releasenotes/" target="_blank">https://www.suse.com/releasenotes/</a>.
  </p></div><div class="sect1 " id="sec.update-preparation.backup"><div class="titlepage"><div><div><h2 class="title" id="sec.update-preparation.backup"><span class="number">3.3 </span><span class="name">Make a Backup</span> <a title="Permalink" class="permalink" href="cha.update-preparation.html#sec.update-preparation.backup">#</a></h2></div></div></div><p>
   Before updating, copy existing configuration files to a separate medium
   (such as tape device, removable hard disk, etc.) to back up the data. This
   primarily applies to files stored in <code class="filename">/etc</code> and some
   directories and files in <code class="filename">/var</code> and
   <code class="filename">/opt</code>. You may also want to write the user data in
   <code class="filename">/home</code> (the <code class="envar">HOME</code> directories) to a
   backup medium. Back up this data as <code class="systemitem">root</code>. Only <code class="systemitem">root</code> has read
   permissions for all local files.
  </p><p>
   If you have selected <span class="guimenu">Update an Existing System</span> as the
   installation mode in YaST, you can choose to do a (system) backup at a
   later point in time. You can choose to include all modified files and files
   from the <code class="filename">/etc/sysconfig</code> directory. However, this is
   not a complete backup, as all the other important directories mentioned
   above are missing. Find the backup in the
   <code class="filename">/var/adm/backup</code> directory.
  </p><div class="sect2 " id="sec.update-preparation.backup.packagelist"><div class="titlepage"><div><div><h3 class="title" id="sec.update-preparation.backup.packagelist"><span class="number">3.3.1 </span><span class="name">Listing Installed Packages and Repositories</span> <a title="Permalink" class="permalink" href="cha.update-preparation.html#sec.update-preparation.backup.packagelist">#</a></h3></div></div></div><p>
    It is often useful to have a list of installed packages,
    for example when doing a fresh install of a new major SLE release or reverting
    to the old version.
   </p><p>
    Be aware that not all installed packages or used repositories are
    available in newer releases of SUSE Linux Enterprise. Some may have been renamed and
    others replaced. It is also possible that some packages are still
    available for legacy purposes while another package is used by
    default. Therefore some manual editing of the files might be
    necessary. This can be done with any text editor.
   </p><p>
    Create a file named <code class="filename">repositories.bak.repo</code> containing a
    list of all used repositories:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code><code class="command">zypper</code> lr -e repositories.bak</pre></div><p>
    Also create a file named <code class="filename">installed-software.bak</code>
    containing a list of all installed packages:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code><code class="command">rpm</code> -qa --queryformat '%{NAME}\n' &gt; installed-software.bak</pre></div><p>
    Back up both files. The repositories and installed packages can be
    restored with the following commands:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code><code class="command">zypper</code> ar repositories.bak.repo
<code class="prompt root">root # </code><code class="command">zypper</code> install $(cat installed-software.bak)</pre></div><div id="note.update.prep.backup.package_amount" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note: 
     Amount of Packages Increases with an Update to a new Major Release
    </h6><p>
     A system upgraded to a new major version
     (SLE <em class="replaceable ">X+1</em>) may contain more packages than
     the initial system (SLE <em class="replaceable ">X</em>). It will also
     contain more packages than a fresh installation of
     SLE <em class="replaceable ">X+1</em> with the same pattern
     selection. Reasons for this are:
    </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
       Packages got split to allow a more fine-grained package selection. For
       example, 37 <span class="package">texlive</span> packages on SLE 11 were split
       into 422 packages on SLE 12.
      </p></li><li class="listitem "><p>
       When a package got split into other packages all new packages are
       installed in the upgrade case to retain the same functionality as with
       the previous version. However, the new default for a fresh installation
       of SLE <em class="replaceable ">X+1</em> may be to not install all
       packages.
      </p></li><li class="listitem "><p>
       Legacy packages from SLE <em class="replaceable ">X</em> may be kept
       for compatibility reasons.
      </p></li><li class="listitem "><p>
       Package dependencies and the scope of patterns may have changed.
      </p></li></ul></div></div></div></div><div class="sect1 " id="sec.update-preparation.sle11"><div class="titlepage"><div><div><h2 class="title" id="sec.update-preparation.sle11"><span class="number">3.4 </span><span class="name">Upgrading from <span class="productname"><span class="phrase">SUSE Linux Enterprise Server</span></span> 11 SP4</span> <a title="Permalink" class="permalink" href="cha.update-preparation.html#sec.update-preparation.sle11">#</a></h2></div></div></div><p>
   If you are using MySQL, PostgreSQL or Java MD5 based certificates on
   <span class="productname"><span class="phrase">SUSE Linux Enterprise Server</span></span> 11 SP4, prepare your system as described in the following
   sections.
  </p><div class="sect2 " id="sec.update-preparation.sle11.mariadb"><div class="titlepage"><div><div><h3 class="title" id="sec.update-preparation.sle11.mariadb"><span class="number">3.4.1 </span><span class="name">Migrate your MySQL Database</span> <a title="Permalink" class="permalink" href="cha.update-preparation.html#sec.update-preparation.sle11.mariadb">#</a></h3></div></div></div><p>
    As of SUSE Linux Enterprise 12, SUSE switched from MySQL to MariaDB. Before you start any
    upgrade, it is highly recommended to back up your database.
   </p><p>
    To perform the database migration, do the following:
   </p><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
      Log in to your SUSE Linux Enterprise 11 machine.
     </p></li><li class="step "><p>
      Create a dump file:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code><code class="command">mysqldump</code> -u root -p --all-databases &gt; mysql_backup.sql</pre></div><p>
      By default, <code class="command">mysqldump</code> does not dump the
      <code class="literal">INFORMATION_SCHEMA</code> or
      <code class="literal">performance_schema</code> database. For more details refer to
      <a class="link" href="https://dev.mysql.com/doc/refman/5.5/en/mysqldump.html" target="_blank">https://dev.mysql.com/doc/refman/5.5/en/mysqldump.html</a>.
     </p></li><li class="step "><p>
      Store your dump file, the configuration file
      <code class="filename">/etc/my.cnf</code>, and the directory
      <code class="filename">/etc/mysql/</code> for later investigation
      (<span class="emphasis"><em>NOT</em></span> installation!) in a safe place.
     </p></li><li class="step "><p>
      Perform your upgrade. After the upgrade, your former configuration file
      <code class="filename">/etc/my.cnf</code> is still intact. You can find the new
      configuration in the file <code class="filename">/etc/my.cnf.rpmnew</code>.
     </p></li><li class="step "><p>
      Configure your MariaDB database to your needs. Do
      <span class="emphasis"><em>NOT</em></span> use the former configuration file and directory,
      but use it as a reminder and adapt it.
     </p></li><li class="step "><p>
      Make sure you start the MariaDB server:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code><code class="command">systemctl</code> start mysql</pre></div><p>
      If you want to start the MariaDB server on every boot, enable the
      service:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code><code class="command">systemctl</code> enable mysql</pre></div></li><li class="step "><p>
      Verify that MariaDB is running properly by connecting to the database:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code><code class="command">mysql</code> -u root -p</pre></div></li></ol></div></div></div><div class="sect2 " id="sec.update-preparation.sle11.postgresql"><div class="titlepage"><div><div><h3 class="title" id="sec.update-preparation.sle11.postgresql"><span class="number">3.4.2 </span><span class="name">Migrate your PostgreSQL Database</span> <a title="Permalink" class="permalink" href="cha.update-preparation.html#sec.update-preparation.sle11.postgresql">#</a></h3></div></div></div><p>
    SLE15 gets a newer version of the PostgreSQL database. Because of the
    required migration work of the database, there is no automatic upgrade
    process. As such, the switch from one version to another needs to be done
    manually.
   </p><p>
    The migration process is conducted by the <code class="command">pg_upgrade</code>
    command which is an alternative method of the classic dump and reload. In
    comparison with the <span class="quote">“<span class="quote">dump &amp; reload</span>”</span> method,
    <code class="command">pg_upgrade</code> makes the migration less time-consuming.
   </p><p>
    Each PostgreSQL version stores its files in different, version-dependent
    directories. After the update the directories will change from
    <code class="filename">/usr/lib/postgresql96/</code> to
    <code class="filename">/usr/lib/postgresql10/</code>.
   </p><p>
    To perform the database migration, do the following:
   </p><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
      Make sure the following preconditions are fulfilled:
     </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
        If not already done, upgrade any package of the old PostgreSQL
        version to the latest release through a maintenance update.
       </p></li><li class="listitem "><p>
        Create a backup of your existing database.
       </p></li><li class="listitem "><p>
        Install the packages of the new PostgreSQL major version. For
        SLE15 this means to install
        <span class="package">postgresql10-server</span>
        and all the packages it depends on.
       </p></li><li class="listitem "><p>
        Install the package
        <span class="package">postgresql10-contrib</span>
        which contains the command <code class="command">pg_upgrade</code>.
       </p></li><li class="listitem "><p>
        Make sure you have enough free space in your PostgreSQL data area,
        which is <code class="filename">/var/lib/pgsql/data</code> by default. If space
        is tight, try to reduce size with the following SQL command on each
        database (can take very long!):
       </p><div class="verbatim-wrap"><pre class="screen">VACUUM FULL</pre></div></li></ul></div></li><li class="step "><p>
      Stop the PostgreSQL server:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>systemctl stop postgresql.service</pre></div></li><li class="step "><p>
      Rename your old data directory:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code><code class="command">mv</code> /var/lib/pgsql/data /var/lib/pgsql/data.old</pre></div></li><li class="step "><p>
      Create a new data directory:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code><code class="command">mkdir</code> -p /var/lib/pgsql/data</pre></div></li><li class="step "><p>
      If you have changed your configuration files in the old version, copy the
      files <code class="filename">postgresql.conf</code>
      <code class="filename">pg_hba.conf</code> to your new <code class="filename">data</code>
      directory:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code><code class="command">cp</code> /var/lib/pgsql/data.old/*.conf \
    /var/lib/pgsql/data</pre></div></li><li class="step "><p>
      Initialize your new database instance either manually with
      <code class="command">initdb</code> or by starting and stopping PostgreSQL, which
      will do it automatically:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>systemctl start postgresql.service
<code class="prompt root">root # </code>systemctl stop postgresql.service</pre></div></li><li class="step "><p>
      Start the migration process:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code><code class="command">pg_upgrade</code> \
  --old-datadir "/var/lib/pgsql/data.old" \
  --new-datadir "/var/lib/pgsql/data" \
  --old-bindir "/usr/lib/postgresqli96/bin/" \
  --new-bindir "/usr/lib/postgresql10/bin/"</pre></div></li><li class="step "><p>
      Start your new database instance:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>systemctl start postgresql.service</pre></div></li><li class="step "><p>
      Check if the migration was successful. There is no general tool to
      automate this step. It depends on your use case how much and what you
      want to test.
     </p></li><li class="step "><p>
      Remove any old PostgreSQL packages and your old data directory:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code><code class="command">zypper</code> search -s postgresql94 | xargs zypper rm -u
<code class="prompt root">root # </code><code class="command">rm</code> -rf /var/lib/pgsql/data.old</pre></div></li></ol></div></div></div><div class="sect2 " id="sec.update-preparation.sle11.ssl"><div class="titlepage"><div><div><h3 class="title" id="sec.update-preparation.sle11.ssl"><span class="number">3.4.3 </span><span class="name">Create Non-MD5 Server Certificates for Java Applications</span> <a title="Permalink" class="permalink" href="cha.update-preparation.html#sec.update-preparation.sle11.ssl">#</a></h3></div></div></div><p>
    During the update from SP1 to SP2, MD5-based certificates were disabled as
    part of a security fix. If you have certificates created as MD5, re-create
    your certificates with the following steps:
   </p><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
      Open a terminal and log in as <code class="systemitem">root</code>.
     </p></li><li class="step "><p>
      Create a private key:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code><code class="command">openssl</code> genrsa -out server.key 1024</pre></div><p>
      If you want a stronger key, replace <code class="literal">1024</code> with a
      higher number, for example, <code class="literal">4096</code>.
     </p></li><li class="step "><p>
      Create a certificate signing request (CSR):
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code><code class="command">openssl</code> req -new -key server.key -out server.csr</pre></div></li><li class="step "><p>
      Self-sign the certificate:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code><code class="command">openssl</code> x509 -req -days 365 -in server.csr -signkey server.key -out server.crt</pre></div></li><li class="step "><p>
      Create the PEM file:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code><code class="command">cat</code> server.key server.crt &gt; server.pem</pre></div></li><li class="step "><p>Place the files <code class="filename">server.crt</code>,
      <code class="filename">server.csr</code>, <code class="filename">server.key</code>, and
      <code class="filename">server.pem</code> in the respective directories where
      the keys can be found. For Tomcat, for example, this directory is
      <code class="filename">/etc/tomcat/ssl/</code>.
     </p></li></ol></div></div></div></div><div class="sect1 " id="sec.update-preparation.vms"><div class="titlepage"><div><div><h2 class="title" id="sec.update-preparation.vms"><span class="number">3.5 </span><span class="name">Shut Down Virtual Machine Guests</span> <a title="Permalink" class="permalink" href="cha.update-preparation.html#sec.update-preparation.vms">#</a></h2></div></div></div><p>
   If your machine serves as a VM Host Server for KVM or Xen, make sure to
   properly shut down all running VM Guests prior to the update. Otherwise
   you may not be able to access the guests after the update.
  </p></div><div class="sect1 " id="sec.update-preparation.smt"><div class="titlepage"><div><div><h2 class="title" id="sec.update-preparation.smt"><span class="number">3.6 </span><span class="name">Check the <code class="command">clientSetup4SMT.sh</code> Script on SMT Clients</span> <a title="Permalink" class="permalink" href="cha.update-preparation.html#sec.update-preparation.smt">#</a></h2></div></div></div><p>
   If you are migrating your client OS that is registered against an RMT server, you need to check if the version
   of the <code class="command">clientSetup4SMT.sh</code> script on your host is up to date.
<code class="command">clientSetup4SMT.sh</code> from older versions of RMT cannot manage RMT 12 clients.
   If you apply software patches regularly on your SMT server, you can always find the latest version
   of <code class="command">clientSetup4SMT.sh</code> at <code class="filename">&lt;SMT_HOSTNAME&gt;/repo/tools/clientSetup4SMT.sh</code>.
  </p></div><div class="sect1 " id="sec.update-preparation.disk"><div class="titlepage"><div><div><h2 class="title" id="sec.update-preparation.disk"><span class="number">3.7 </span><span class="name">Disk Space</span> <a title="Permalink" class="permalink" href="cha.update-preparation.html#sec.update-preparation.disk">#</a></h2></div></div></div><p>
   Software tends to grow from version to version. Therefore,
   take a look at the available partition space before updating. If you suspect
   you are running short of disk space, back up your data before increasing the
   available space by resizing partitions, for example. There is no general
   rule regarding how much space each partition should have. Space requirements
   depend on your particular partitioning profile and the software selected.
  </p><div id="idm139696333934448" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note: Automatic Check for Enough Space in YaST</h6><p>
    During the update procedure, YaST will check how much free disk space is
    available and display a warning to the user if the installation may exceed
    the available amount. In that case, performing the update may lead to an
    <span class="emphasis"><em>unusable system</em></span>! Only if you know exactly what you are
    doing (by testing beforehand), you can skip the warning and continue the
    update.
   </p></div><div class="sect2 " id="sec.update-preparation.disk.space"><div class="titlepage"><div><div><h3 class="title" id="sec.update-preparation.disk.space"><span class="number">3.7.1 </span><span class="name">Checking Disk Space on Non-Btrfs File Systems</span> <a title="Permalink" class="permalink" href="cha.update-preparation.html#sec.update-preparation.disk.space">#</a></h3></div></div></div><p>
    Use the <code class="command">df</code> command to list available disk space. For
    example, in <a class="xref" href="cha.update-preparation.html#aus.update.df" title="List with df -h">Example 3.1, “List with <code class="command">df -h</code>”</a>, the root partition is
    <code class="filename">/dev/sda3</code> (mounted as <code class="filename">/</code>).
   </p><div class="example" id="aus.update.df"><div class="example-title-wrap"><h6 class="example-title"><span class="number">Example 3.1: </span><span class="name">List with <code class="command">df -h</code> </span><a title="Permalink" class="permalink" href="cha.update-preparation.html#aus.update.df">#</a></h6></div><div class="example-contents"><div class="verbatim-wrap"><pre class="screen">Filesystem     Size  Used Avail Use% Mounted on
/dev/sda3       74G   22G   53G  29% /
tmpfs          506M     0  506M   0% /dev/shm
/dev/sda5      116G  5.8G  111G   5% /home
/dev/sda1       44G    4G   40G   9% /data</pre></div></div></div></div><div class="sect2 " id="sec.update-preparation.disk.btrfs-on-root"><div class="titlepage"><div><div><h3 class="title" id="sec.update-preparation.disk.btrfs-on-root"><span class="number">3.7.2 </span><span class="name">Checking Disk Space on Btrfs Root File Systems</span> <a title="Permalink" class="permalink" href="cha.update-preparation.html#sec.update-preparation.disk.btrfs-on-root">#</a></h3></div></div></div><p>
    If you use Btrfs as root file systems on your machine, make sure there is
    enough free space. In the worst case, an upgrade needs as much disk space as the current root
    file system (without <code class="filename">/.snapshot</code>) for a new snapshot.
    To display available disk space use the command:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code><code class="command">df</code> -h /</pre></div><p>
    Check the available space on all other mounted partitions as well. The
    following recommendations have been proven:
   </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
      For all file systems including Btrfs you need enough free disk space to
      download and install big RPMs. The space of old RPMs are only freed after
      new RPMs are installed.
     </p></li><li class="listitem "><p>
      For Btrfs with snapshots, you need at minimum as much free space as your
      current installation takes. We recommend to have twice as much free
      space as the current installation.
     </p><p>
      If you do not have enough free space, you can try to delete old snapshots
      with <code class="command">snapper</code>:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code><code class="command">snapper</code> list
<code class="prompt root">root # </code><code class="command">snapper</code> delete NUMBER</pre></div><p>
      However, this may not help in all cases. Before migration, most snapshots
      occupy only little space.
     </p></li></ul></div></div></div><div class="sect1 " id="sec.update-preparation.multiversion"><div class="titlepage"><div><div><h2 class="title" id="sec.update-preparation.multiversion"><span class="number">3.8 </span><span class="name">Temporarily Disabling Kernel Multiversion Support</span> <a title="Permalink" class="permalink" href="cha.update-preparation.html#sec.update-preparation.multiversion">#</a></h2></div></div></div><p>
   <span class="productname"><span class="phrase">SUSE Linux Enterprise Server</span></span> allows installing multiple kernel versions by enabling the
   respective settings in <code class="filename">/etc/zypp/zypp.conf</code>. Support
   for this feature needs to be temporarily disabled to upgrade to a service
   pack. When the update has successfully finished, multiversion support can be
   re-enabled. To disable multiversion support, comment the respective
   lines in <code class="filename">/etc/zypp/zypp.conf</code>. The result should look
   similar to:
  </p><div class="verbatim-wrap"><pre class="screen">#multiversion = provides:multiversion(kernel)
#multiversion.kernels = latest,running</pre></div><p>
   To re-activate this feature after a successful update, remove the comment
   signs. For more information about multiversion support, refer to
   <span class="intraxref">Book “<em class="citetitle ">Deployment Guide</em>”, Chapter 18 “Installing Multiple Kernel Versions”, Section 18.1 “Enabling and Configuring Multiversion Support”</span>.
  </p></div><div class="sect1 " id="sec.update-preparation.zseries"><div class="titlepage"><div><div><h2 class="title" id="sec.update-preparation.zseries"><span class="number">3.9 </span><span class="name">Upgrading on IBM z Systems</span> <a title="Permalink" class="permalink" href="cha.update-preparation.html#sec.update-preparation.zseries">#</a></h2></div></div></div><p>Upgrading a SUSE Linux Enterprise installation on z Systems requires the
   <code class="command">Upgrade=1</code> kernel parameter, for example via the
   parmfile. See <span class="intraxref">Book “<em class="citetitle ">Deployment Guide</em>”, Chapter 5 “Installation on IBM z Systems”, Section 5.4 “The Parmfile—Automating the System Configuration”</span>.
  </p></div><div class="sect1 " id="sec.update-preparation.ppc"><div class="titlepage"><div><div><h2 class="title" id="sec.update-preparation.ppc"><span class="number">3.10 </span><span class="name">IBM POWER: Starting an X Server</span> <a title="Permalink" class="permalink" href="cha.update-preparation.html#sec.update-preparation.ppc">#</a></h2></div></div></div><p>
   On SLES 12 for IBM POWER the display manager is configured not to start a
   local X Server by default. This setting was reversed on SLES 12
   SP1—the display manager now starts an X Server.
  </p><p>
   To avoid problems during upgrade, the <span class="productname"><span class="phrase">SUSE Linux Enterprise Server</span></span> setting is not changed
   automatically. If you want the display manager to start an X Server after
   the upgrade, change the setting of
   <code class="envar">DISPLAYMANAGER_STARTS_XSERVER</code> in
   <code class="filename">/etc/sysconfig/displaymanager</code> as follows:
  </p><div class="verbatim-wrap"><pre class="screen">DISPLAYMANAGER_STARTS_XSERVER="yes"</pre></div></div></div></div><div class="page-bottom"><div id="_bottom-navigation"><a class="nav-link" href="cha.update.offline.html"><span class="next-icon">→</span><span class="nav-label"><span class="number">Chapter 4 </span>Upgrading Offline</span></a><a class="nav-link" href="cha.update.sle.html"><span class="prev-icon">←</span><span class="nav-label"><span class="number">Chapter 2 </span>Upgrade Paths and Methods</span></a></div><div id="_share-print"><div class="online-contents share"><strong>Share this page: </strong><span class="share-buttons"><span id="_share-fb" class="bottom-button">Facebook</span><span class="spacer"> • </span><span id="_share-gp" class="bottom-button">Google+</span><span class="spacer"> • </span><span id="_share-tw" class="bottom-button">Twitter</span><span class="spacer"> • </span><span id="_share-mail" class="bottom-button">E-Mail</span></span></div><div class="print"><span id="_print-button" class="bottom-button">Print this page</span></div><div class="clearme"></div></div></div></div><div id="_inward"></div></div><div id="_footer-wrap"><div id="_footer"><p>©
        2018 
        SUSE</p><ul><li><a href="http://www.suse.com/company/careers/" target="_top">Careers</a></li><li><a href="http://www.suse.com/company/legal/" target="_top">Legal</a></li><li><a href="http://www.suse.com/company/" target="_top">About</a></li><li><a href="http://www.suse.com/ContactsOffices/contacts_offices.jsp" target="_top">Contact Us</a></li></ul></div></div></body></html>