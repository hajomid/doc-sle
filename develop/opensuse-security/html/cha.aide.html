<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang=""><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Intrusion Detection with AIDE | Security Guide | openSUSE Leap 42.3</title><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" /><link rel="stylesheet" type="text/css" href="static/css/style.css" /><link rel="stylesheet" type="text/css" href="static/css/highlight.css" /><link rel="stylesheet" type="text/css" href="static/css/brand.css" /><meta name="generator" content="DAPS 2.4.0 using openSUSE XSL Stylesheets 2.0.8 (based on DocBook XSL Stylesheets 1.78.1) - chunked" /><meta name="product-name" content="openSUSE Leap" /><meta name="product-number" content="42.3" /><meta name="book-title" content="Security Guide" /><meta name="chapter-title" content="Chapter 13. Intrusion Detection with AIDE" /><meta name="description" content="Securing your systems is a mandatory task for any mission-critical system administrator. Because it is impossible to always guarantee that the system is not compromised, it is very important to do extra checks regularly (for example with cron) to ensure that the system is still under your control. This is where AIDE, the Advanced Intrusion Detection Environment, comes into play." /><meta name="tracker-url" content="https://bugzilla.opensuse.org/enter_bug.cgi" /><meta name="tracker-type" content="bsc" /><meta name="tracker-bsc-assignee" content="fs@suse.com" /><meta name="tracker-bsc-component" content="Documentation" /><meta name="tracker-bsc-product" content="openSUSE Distribution" /><meta name="tracker-bsc-version" content="Leap 42.2" /><link rel="home" href="index.html" title="openSUSE Leap Documentation" /><link rel="up" href="part.local_security.html" title="Part II. Local Security" /><link rel="prev" href="cha.certstore.html" title="Chapter 12. Certificate Store" /><link rel="next" href="part.network_security.html" title="Part III. Network Security" /><script type="text/javascript">

var protocol = window.location.protocol.toLowerCase();
if ( protocol != 'file:' ) {
  var agent = navigator.userAgent.toLowerCase();
  var wanted = ( protocol == 'https:') ? 'https' : 'http';
  var file = 'fonts.css';
  document.write('<link rel="stylesheet" type="text/css" href="' + wanted + '://static.opensuse.org/fonts/'+ file +'"></link>');
}
else {
   document.write('<link rel="stylesheet" type="text/css" href="static/css/fonts-onlylocal.css"></link>');
}

</script><noscript><link rel="stylesheet" type="text/css" href="http://static.opensuse.org/fonts/fonts.css" /></noscript><script src="static/js/jquery-1.10.2.min.js" type="text/javascript"></script><script src="static/js/script.js" type="text/javascript"></script><script src="static/js/highlight.min.js" type="text/javascript"></script><script>

$(document).ready(function() {
  $('.verbatim-wrap.highlight').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});
hljs.configure({
  useBR: false
});

</script></head><body class="draft offline js-off"><div id="_outer-wrap"><div id="_white-bg"><div id="_header"><div id="_logo"><img src="static/images/logo.png" alt="Logo" /></div><div class="crumbs"><a class="book-link" href="index.html" title="openSUSE Leap Documentation"><span class="book-icon">openSUSE Leap Documentation</span></a><span> › </span><a class="crumb" href="book.security.html">Security Guide</a><span> › </span><a class="crumb" href="part.local_security.html">Local Security</a><span> › </span><a class="crumb" href="cha.aide.html">Intrusion Detection with AIDE</a></div><div class="clearme"></div></div></div><div id="_toolbar-wrap"><div id="_toolbar"><div id="_toc-area" class="inactive"><a id="_toc-area-button" class="tool" title="Contents" accesskey="c" href="index.html"><span class="tool-spacer"><span class="toc-icon">Contents</span><span class="clearme"></span></span><span class="tool-label">Contents</span></a><div class="active-contents bubble-corner"></div><div class="active-contents bubble"><div class="bubble-container"><h6>Security Guide</h6><div id="_bubble-toc"><ol><li class="inactive"><a href="preface.security.html"><span class="number"> </span><span class="name">About This Guide</span></a></li><li class="inactive"><a href="cha.security.html"><span class="number">1 </span><span class="name">Security and Confidentiality</span></a></li><li class="inactive"><a href="part.auth.html"><span class="number">I </span><span class="name">Authentication</span></a><ol><li class="inactive"><a href="cha.pam.html"><span class="number">2 </span><span class="name">Authentication with PAM</span></a></li><li class="inactive"><a href="cha.nis.html"><span class="number">3 </span><span class="name">Using NIS</span></a></li><li class="inactive"><a href="cha.security.auth.html"><span class="number">4 </span><span class="name">Setting Up Authentication Servers and Clients Using YaST</span></a></li><li class="inactive"><a href="cha.security.ldap.html"><span class="number">5 </span><span class="name">LDAP—A Directory Service</span></a></li><li class="inactive"><a href="cha.security.kerberos.html"><span class="number">6 </span><span class="name">Network Authentication with Kerberos</span></a></li><li class="inactive"><a href="cha.security.ad.html"><span class="number">7 </span><span class="name">Active Directory Support</span></a></li></ol></li><li class="inactive"><a href="part.local_security.html"><span class="number">II </span><span class="name">Local Security</span></a><ol><li class="inactive"><a href="cha.security.yast_security.html"><span class="number">8 </span><span class="name">Configuring Security Settings with YaST</span></a></li><li class="inactive"><a href="cha.security.policykit.html"><span class="number">9 </span><span class="name">Authorization with PolKit</span></a></li><li class="inactive"><a href="cha.security.acls.html"><span class="number">10 </span><span class="name">Access Control Lists in Linux</span></a></li><li class="inactive"><a href="cha.security.cryptofs.html"><span class="number">11 </span><span class="name">Encrypting Partitions and Files</span></a></li><li class="inactive"><a href="cha.certstore.html"><span class="number">12 </span><span class="name">Certificate Store</span></a></li><li class="inactive"><a href="cha.aide.html"><span class="number">13 </span><span class="name">Intrusion Detection with AIDE</span></a></li></ol></li><li class="inactive"><a href="part.network_security.html"><span class="number">III </span><span class="name">Network Security</span></a><ol><li class="inactive"><a href="cha.ssh.html"><span class="number">14 </span><span class="name">SSH: Secure Network Operations</span></a></li><li class="inactive"><a href="cha.security.firewall.html"><span class="number">15 </span><span class="name">Masquerading and Firewalls</span></a></li><li class="inactive"><a href="cha.security.vpnserver.html"><span class="number">16 </span><span class="name">Configuring a VPN Server</span></a></li><li class="inactive"><a href="cha.security.yast_ca.html"><span class="number">17 </span><span class="name">Managing X.509 Certification</span></a></li></ol></li><li class="inactive"><a href="part.apparmor.html"><span class="number">IV </span><span class="name">Confining Privileges with <span class="phrase">AppArmor</span></span></a><ol><li class="inactive"><a href="cha.apparmor.intro.html"><span class="number">18 </span><span class="name">Introducing <span class="phrase">AppArmor</span></span></a></li><li class="inactive"><a href="cha.apparmor.start.html"><span class="number">19 </span><span class="name">Getting Started</span></a></li><li class="inactive"><a href="cha.apparmor.concept.html"><span class="number">20 </span><span class="name">Immunizing Programs</span></a></li><li class="inactive"><a href="cha.apparmor.profiles.html"><span class="number">21 </span><span class="name">Profile Components and Syntax</span></a></li><li class="inactive"><a href="cha.apparmor.repos.html"><span class="number">22 </span><span class="name"><span class="phrase">AppArmor</span> Profile Repositories</span></a></li><li class="inactive"><a href="cha.apparmor.yast.html"><span class="number">23 </span><span class="name">Building and Managing Profiles with YaST</span></a></li><li class="inactive"><a href="cha.apparmor.commandline.html"><span class="number">24 </span><span class="name">Building Profiles from the Command Line</span></a></li><li class="inactive"><a href="cha.apparmor.hat.html"><span class="number">25 </span><span class="name">Profiling Your Web Applications Using ChangeHat</span></a></li><li class="inactive"><a href="cha.apparmor.pam.html"><span class="number">26 </span><span class="name">Confining Users with <code class="systemitem">pam_apparmor</code></span></a></li><li class="inactive"><a href="cha.apparmor.managing.html"><span class="number">27 </span><span class="name">Managing Profiled Applications</span></a></li><li class="inactive"><a href="cha.apparmor.support.html"><span class="number">28 </span><span class="name">Support</span></a></li><li class="inactive"><a href="cha.apparmor.glossary.html"><span class="number">29 </span><span class="name"><span class="phrase">AppArmor</span> Glossary</span></a></li></ol></li><li class="inactive"><a href="bk04pt05.html"><span class="number">V </span><span class="name">SELinux</span></a><ol><li class="inactive"><a href="cha.selinux.html"><span class="number">30 </span><span class="name">Configuring SELinux</span></a></li></ol></li><li class="inactive"><a href="part.audit.html"><span class="number">VI </span><span class="name"><em class="citetitle ">The Linux Audit Framework</em></span></a><ol><li class="inactive"><a href="cha.audit.comp.html"><span class="number">31 </span><span class="name">Understanding Linux Audit</span></a></li><li class="inactive"><a href="cha.audit.setup.html"><span class="number">32 </span><span class="name">Setting Up the Linux Audit Framework</span></a></li><li class="inactive"><a href="cha.audit.scenarios.html"><span class="number">33 </span><span class="name">Introducing an Audit Rule Set</span></a></li><li class="inactive"><a href="cha.audit.moreinfo.html"><span class="number">34 </span><span class="name">Useful Resources</span></a></li></ol></li><li class="inactive"><a href="bk04apa.html"><span class="number">A </span><span class="name">GNU Licenses</span></a></li></ol></div><div class="clearme"></div></div></div></div><div id="_nav-area" class="inactive"><div class="tool"><span class="nav-inner"><span class="tool-label">Navigation</span><a accesskey="p" class="tool-spacer" title="Chapter 12. Certificate Store" href="cha.certstore.html"><span class="prev-icon">←</span></a><a accesskey="n" class="tool-spacer" title="Part III. Network Security" href="part.network_security.html"><span class="next-icon">→</span></a></span></div></div></div></div><div id="_fixed-header-wrap" class="inactive"><div id="_fixed-header"><div class="crumbs"><a class="book-link" href="index.html" title="openSUSE Leap Documentation"><span class="book-icon">openSUSE Leap Documentation</span></a><span> › </span><a class="crumb" href="book.security.html">Security Guide</a><span> › </span><a class="crumb" href="part.local_security.html">Local Security</a><span> › </span><a class="crumb" href="cha.aide.html">Intrusion Detection with AIDE</a></div><div class="buttons"><a class="top-button button" href="#">Top</a><div class="button"><a accesskey="p" class="tool-spacer" title="Chapter 12. Certificate Store" href="cha.certstore.html"><span class="prev-icon">←</span></a><a accesskey="n" class="tool-spacer" title="Part III. Network Security" href="part.network_security.html"><span class="next-icon">→</span></a></div><div class="clearme"></div></div><div class="clearme"></div></div></div><div id="_content" class="draft "><div class="documentation"><div class="chapter " id="cha.aide"><div class="titlepage"><div><div class="version-info">Applies to  <span class="productname"><span class="productname"><span class="phrase">openSUSE Leap</span></span></span> <span class="productnumber"><span class="productnumber"><span class="phrase">42.3</span></span></span></div><div><h2 class="title"><span class="number">13 </span><span class="name">Intrusion Detection with AIDE</span> </h2><div class="doc-status"><ul><li><span class="ds-label">Filename: </span>security_aide.xml</li><li><span class="ds-label">ID: </span>cha.aide</li></ul></div></div><div><div class="abstract"><div class="abstract-title-wrap"><h6 class="abstract-title">Abstract<a title="Permalink" class="permalink" href="cha.aide.html#idm140706740413264">#</a></h6></div><p>
    Securing your systems is a mandatory task for any mission-critical
    system administrator. Because it is impossible to always guarantee that
    the system is not compromised, it is very important to do extra checks
    regularly (for example with
    <code class="systemitem">cron</code>) to ensure that the system
    is still under your control. This is where AIDE, the
    <span class="emphasis"><em>Advanced Intrusion Detection Environment</em></span>, comes
    into play.
   </p></div></div></div></div><div class="line"><div class="toc"><dl><dt><span class="sect1"><a href="cha.aide.html#sec.aide.why"><span class="number">13.1 </span><span class="name">Why Use AIDE?</span></a></span></dt><dt><span class="sect1"><a href="cha.aide.html#sec.aide.setup"><span class="number">13.2 </span><span class="name">Setting Up an AIDE Database</span></a></span></dt><dt><span class="sect1"><a href="cha.aide.html#sec.aide.check"><span class="number">13.3 </span><span class="name">Local AIDE Checks</span></a></span></dt><dt><span class="sect1"><a href="cha.aide.html#sec.aide.independent"><span class="number">13.4 </span><span class="name">System Independent Checking</span></a></span></dt><dt><span class="sect1"><a href="cha.aide.html#sec.aide.more"><span class="number">13.5 </span><span class="name">For More Information</span></a></span></dt></dl></div></div><div class="sect1 " id="sec.aide.why"><div class="titlepage"><div><div><h2 class="title" id="sec.aide.why"><span class="number">13.1 </span><span class="name">Why Use AIDE?</span> <a title="Permalink" class="permalink" href="cha.aide.html#sec.aide.why">#</a></h2></div></div></div><p>
   An easy check that often can reveal unwanted changes can be done by means
   of RPM. The package manager has a built-in verify function that checks
   all the managed files in the system for changes. To verify of all files,
   run the command <code class="command">rpm -Va</code>. However, this command will
   also display changes in configuration files and you will need to do some
   filtering to detect important changes.
  </p><p>
   An additional problem to the method with RPM is that an intelligent
   attacker will modify <code class="command">rpm</code> itself to hide any changes
   that might have been done by some kind of root-kit which allows the
   attacker to mask its intrusion and gain root privilege. To solve this,
   you should implement a secondary check that can also be run completely
   independent of the installed system.
  </p></div><div class="sect1 " id="sec.aide.setup"><div class="titlepage"><div><div><h2 class="title" id="sec.aide.setup"><span class="number">13.2 </span><span class="name">Setting Up an AIDE Database</span> <a title="Permalink" class="permalink" href="cha.aide.html#sec.aide.setup">#</a></h2></div></div></div><div id="idm140706740404688" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.png" /><h6>Important: Initialize AIDE Database After Installation</h6><p>
    Before you install your system, verify the checksum of your medium (see
    <span class="intraxref">Book “<em class="citetitle ">Start-Up</em>”, Chapter 4 “Troubleshooting”, Section 4.1 “Checking Media”</span>) to make sure you do not use
    a compromised source. After you have installed the system, initialize
    the AIDE database. To make sure that all went well during and
    after the installation, do an installation directly on the console,
    without any network attached to the computer. Do not leave the computer
    unattended or connected to any network before AIDE creates its
    database.
   </p></div><p>
   AIDE is not installed by default on <span class="productname"><span class="phrase">openSUSE Leap</span></span>. To install it,
   either use <span class="guimenu">Computer</span> › <span class="guimenu">Install
   Software</span>, or enter <code class="literal">zypper install
   aide</code> on the command line as <code class="systemitem">root</code>.
  </p><p>
   To tell AIDE which attributes of which files should be checked, use
   the <code class="filename">/etc/aide.conf</code> configuration file. It must be
   modified to become the actual configuration. The first section handles
   general parameters like the location of the AIDE database file. More
   relevant for local configurations are the <code class="systemitem">Custom
   Rules</code> and the <code class="systemitem">Directories and Files</code>
   sections. A typical rule looks like the following:
  </p><div class="verbatim-wrap"><pre class="screen">Binlib     = p+i+n+u+g+s+b+m+c+md5+sha1</pre></div><p>
   After defining the variable <code class="literal">Binlib</code>, the respective
   check boxes are used in the files section. Important options include the
   following:
  </p><div class="table" id="tab.aide.options"><div class="table-title-wrap"><h6 class="table-title"><span class="number">Table 13.1: </span><span class="name">Important AIDE Check Boxes </span><a title="Permalink" class="permalink" href="cha.aide.html#tab.aide.options">#</a></h6></div><div class="table-contents"><table summary="Important AIDE Check Boxes" border="1"><colgroup><col /><col /></colgroup><thead><tr><th>
       <p>
        Option
       </p>
      </th><th>
       <p>
        Description
       </p>
      </th></tr></thead><tbody><tr><td>
       <p>
        p
       </p>
      </td><td>
       <p>
        Check for the file permissions of the selected files or directories.
       </p>
      </td></tr><tr><td>
       <p>
        i
       </p>
      </td><td>
       <p>
        Check for the inode number. Every file name has a unique inode
        number that should not change.
       </p>
      </td></tr><tr><td>
       <p>
        n
       </p>
      </td><td>
       <p>
        Check for the number of links pointing to the relevant file.
       </p>
      </td></tr><tr><td>
       <p>
        u
       </p>
      </td><td>
       <p>
        Check if the owner of the file has changed.
       </p>
      </td></tr><tr><td>
       <p>
        g
       </p>
      </td><td>
       <p>
        Check if the group of the file has changed.
       </p>
      </td></tr><tr><td>
       <p>
        s
       </p>
      </td><td>
       <p>
        Check if the file size has changed.
       </p>
      </td></tr><tr><td>
       <p>
        b
       </p>
      </td><td>
       <p>
        Check if the block count used by the file has changed.
       </p>
      </td></tr><tr><td>
       <p>
        m
       </p>
      </td><td>
       <p>
        Check if the modification time of the file has changed.
       </p>
      </td></tr><tr><td>
       <p>
        c
       </p>
      </td><td>
       <p>
        Check if the files access time has changed.
       </p>
      </td></tr><tr><td>
       <p>
        md5
       </p>
      </td><td>
       <p>
        Check if the md5 checksum of the file has changed.
       </p>
      </td></tr><tr><td>
       <p>
        sha1
       </p>
      </td><td>
       <p>
        Check if the sha1 (160 Bit) checksum of the file has changed.
       </p>
      </td></tr></tbody></table></div></div><p>
   This is a configuration that checks for all files in
   <code class="filename">/sbin</code> with the options defined in
   <code class="literal">Binlib</code> but omits the
   <code class="filename">/sbin/conf.d/</code> directory:
  </p><div class="verbatim-wrap"><pre class="screen">/sbin  Binlib
!/sbin/conf.d</pre></div><p>
   To create the AIDE database, proceed as follows:
  </p><div class="procedure " id="pro.aide.setup.db"><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
     Open <code class="filename">/etc/aide.conf</code>.
    </p></li><li class="step "><p>
     Define which files should be checked with which check boxes. For a
     complete list of available check boxes, see
     <code class="filename">/usr/share/doc/packages/aide/manual.html</code>. The
     definition of the file selection needs some knowledge about regular
     expressions. Save your modifications.
    </p></li><li class="step "><p>
     To check whether the configuration file is valid, run:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>aide --config-check</pre></div><p>
     Any output of this command is a hint that the configuration is not
     valid. For example, if you get the following output:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>aide --config-check
35:syntax error:!
35:Error while reading configuration:!
Configuration error</pre></div><p>
     The error is to be expected in line 36 of
     <code class="filename">/etc/aide.conf</code>. Note that the error message
     contains the last successfully read line of the configuration file.
    </p></li><li class="step "><p>
     Initialize the AIDE database. Run the command:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>aide -i</pre></div></li><li class="step "><p>
     Copy the generated database to a save location like a CD-R or DVD-R, a
     remote server or a flash disk for later use.
    </p><div id="idm140706740350560" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.png" /><h6>Important: </h6><p>
      This step is essential as it avoids compromising your database. It is
      recommended to use a medium which can be written only once to prevent
      the database being modified. <span class="emphasis"><em>Never</em></span> leave the
      database on the computer which you want to monitor.
     </p></div></li></ol></div></div></div><div class="sect1 " id="sec.aide.check"><div class="titlepage"><div><div><h2 class="title" id="sec.aide.check"><span class="number">13.3 </span><span class="name">Local AIDE Checks</span> <a title="Permalink" class="permalink" href="cha.aide.html#sec.aide.check">#</a></h2></div></div></div><p>
   To perform a file system check, proceed as follows:
  </p><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
     Rename the database:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>mv /var/lib/aide/aide.db.new /var/lib/aide/aide.db</pre></div></li><li class="step "><p>
     After any configuration change, you always need to re-initialize the
     AIDE database and subsequently move the newly generated database.
     It is also a good idea to make a backup of this database. See
     <a class="xref" href="cha.aide.html#sec.aide.setup" title="13.2. Setting Up an AIDE Database">Section 13.2, “Setting Up an AIDE Database”</a> for more information.
    </p></li><li class="step "><p>
     Perform the check with the following command:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>aide --check</pre></div></li></ol></div></div><p>
   If the output is empty, everything is fine. If AIDE found changes,
   it displays a summary of changes, for example:
  </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>aide --check
AIDE found differences between database and filesystem!!

Summary:
  Total number of files:        1992
  Added files:                  0
  Removed files:                0
  Changed files:                1</pre></div><p>
   To learn about the actual changes, increase the verbose level of the
   check with the parameter <code class="literal">-V</code>. For the previous example,
   this could look like the following:
  </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>aide --check -V
AIDE found differences between database and filesystem!!
Start timestamp: 2009-02-18 15:14:10

Summary:
  Total number of files:        1992
  Added files:                  0
  Removed files:                0
  Changed files:                1


---------------------------------------------------
Changed files:
---------------------------------------------------

changed: /etc/passwd

--------------------------------------------------
Detailed information about changes:
---------------------------------------------------


File: /etc/passwd
  Mtime    : 2009-02-18 15:11:02              , 2009-02-18 15:11:47
  Ctime    : 2009-02-18 15:11:02              , 2009-02-18 15:11:47</pre></div><p>
   In this example, the file <code class="filename">/etc/passwd</code> was touched to
   demonstrate the effect.
  </p></div><div class="sect1 " id="sec.aide.independent"><div class="titlepage"><div><div><h2 class="title" id="sec.aide.independent"><span class="number">13.4 </span><span class="name">System Independent Checking</span> <a title="Permalink" class="permalink" href="cha.aide.html#sec.aide.independent">#</a></h2></div></div></div><p>
   To avoid risk, it is advisable to also run the AIDE binary from a
   trusted source. This excludes the risk that some attacker also modified
   the aide binary to hide its traces.
  </p><p>
   To accomplish this task, AIDE must be run from a rescue system that
   is independent of the installed system. With <span class="productname"><span class="phrase">openSUSE Leap</span></span> it is
   relatively easy to extend the rescue system with arbitrary programs, and
   thus add the needed functionality.
  </p><p>
   Before you can start using the rescue system, you need to provide two
   packages to the system. These are included with the same syntax as you
   would add a driver update disk to the system. For a detailed description
   about the possibilities of linuxrc that are used for this purpose, see
   <a class="link" href="http://en.opensuse.org/SDB:Linuxrc" target="_blank">http://en.opensuse.org/SDB:Linuxrc</a>. In the
   following, one possible way to accomplish this task is discussed.
  </p><div class="procedure " id="idm140706740330000"><div class="procedure-title-wrap"><h6 class="procedure-title"><span class="number">Procedure 13.1: </span><span class="name">Starting a Rescue System with AIDE </span><a title="Permalink" class="permalink" href="cha.aide.html#idm140706740330000">#</a></h6></div><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
     Provide an FTP server as a second machine.
    </p></li><li class="step "><p>
     Copy the packages <code class="systemitem">aide</code> and
     <code class="systemitem">mhash</code> to the FTP server directory, in our case
     <code class="filename">/srv/ftp/</code>. Replace the placeholders
     <em class="replaceable ">ARCH</em> and <em class="replaceable ">VERSION</em>
     with the corresponding values:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>cp DVD1/suse/<em class="replaceable ">ARCH</em>/aide<em class="replaceable ">VERSION</em>.<em class="replaceable ">ARCH</em>.rpm /srv/ftp
<code class="prompt root">root # </code>cp DVD1/suse/<em class="replaceable ">ARCH</em>/mhash<em class="replaceable ">VERSION</em>.<em class="replaceable ">ARCH</em>.rpm /srv/ftp</pre></div></li><li class="step "><p>
     Create an info file <code class="filename">/srv/ftp/info.txt</code> that
     provides the needed boot parameters for the rescue system:
    </p><div class="verbatim-wrap"><pre class="screen">dud:ftp://ftp.example.com/aide<em class="replaceable ">VERSION</em>.<em class="replaceable ">ARCH</em>.rpm
dud:ftp://ftp.example.com/mhash<em class="replaceable ">VERSION</em>.<em class="replaceable ">ARCH</em>.rpm</pre></div><p>
     Replace your FTP domain name, <em class="replaceable ">VERSION</em> and
     <em class="replaceable ">ARCH</em> with the values used on your system.
    </p></li><li class="step "><p>
     Restart the server that needs to go through an AIDE check with the
     Rescue system from your DVD. Add the following string to the boot
     parameters:
    </p><div class="verbatim-wrap"><pre class="screen">info=ftp://ftp.example.com/info.txt</pre></div><p>
     This parameter tells <code class="command">linuxrc</code> to also read in all
     information from the <code class="filename">info.txt</code> file.
    </p></li></ol></div></div><p>
   After the rescue system has booted, the AIDE program is ready for
   use.
  </p></div><div class="sect1 " id="sec.aide.more"><div class="titlepage"><div><div><h2 class="title" id="sec.aide.more"><span class="number">13.5 </span><span class="name">For More Information</span> <a title="Permalink" class="permalink" href="cha.aide.html#sec.aide.more">#</a></h2></div></div></div><p>
   Information about AIDE is available at the following places:
  </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
     The home page of AIDE:
     <a class="link" href="http://aide.sourceforge.net" target="_blank">http://aide.sourceforge.net</a>
    </p></li><li class="listitem "><p>
     In the documented template configuration
     <code class="filename">/etc/aide.conf</code>.
    </p></li><li class="listitem "><p>
     In several files below
     <code class="filename">/usr/share/doc/packages/aide</code> after installing the
     <code class="systemitem">aide</code> package.
    </p></li><li class="listitem "><p>
     On the AIDE user mailing list at
     <a class="link" href="https://mailman.cs.tut.fi/mailman/listinfo/aide" target="_blank">https://mailman.cs.tut.fi/mailman/listinfo/aide</a>.
    </p></li></ul></div></div></div></div><div class="page-bottom"><div id="_bottom-navigation"><a class="nav-link" href="part.network_security.html"><span class="next-icon">→</span><span class="nav-label"><span class="number">Part III </span>Network Security</span></a><a class="nav-link" href="cha.certstore.html"><span class="prev-icon">←</span><span class="nav-label"><span class="number">Chapter 12 </span>Certificate Store</span></a></div><div id="_share-print"><div class="online-contents share"><strong>Share this page: </strong><span class="share-buttons"><span id="_share-fb" class="bottom-button">Facebook</span><span class="spacer"> • </span><span id="_share-gp" class="bottom-button">Google+</span><span class="spacer"> • </span><span id="_share-tw" class="bottom-button">Twitter</span></span></div><div class="print"><span id="_print-button" class="bottom-button">Print this page</span></div><div class="clearme"></div></div></div></div><div id="_inward"></div></div><div id="_footer-wrap"><div id="_footer"><p>©
        2018 
        SUSE</p></div></div></body></html>