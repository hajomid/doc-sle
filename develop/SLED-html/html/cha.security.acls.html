<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang=""><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Access Control Lists in Linux | Security Guide | SUSE Linux Enterprise Desktop 15</title><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" /><link rel="stylesheet" type="text/css" href="static/css/style.css" /><link rel="stylesheet" type="text/css" href="static/css/highlight.css" /><meta name="generator" content="DAPS 2.4.0 using SUSE XSL Stylesheets 2.0.8 (based on DocBook XSL Stylesheets 1.78.1) - chunked" /><meta name="product-name" content="SUSE Linux Enterprise Desktop" /><meta name="product-number" content="15" /><meta name="book-title" content="Security Guide" /><meta name="chapter-title" content="Chapter 10. Access Control Lists in Linux" /><meta name="description" content="POSIX ACLs (access control lists) can be used as an expansion of the traditional permission concept for file system objects. With ACLs, permissions can be defined more flexibly than with the traditional permission concept." /><meta name="tracker-url" content="https://bugzilla.suse.com/enter_bug.cgi" /><meta name="tracker-type" content="bsc" /><meta name="tracker-bsc-assignee" content="fs@suse.com" /><meta name="tracker-bsc-component" content="Documentation" /><meta name="tracker-bsc-product" content="Beta SUSE Linux Enterprise Desktop 15" /><link rel="home" href="index.html" title="SUSE Linux Enterprise Desktop Documentation" /><link rel="up" href="part.local_security.html" title="Part II. Local Security" /><link rel="prev" href="cha.security.policykit.html" title="Chapter 9. Authorization with PolKit" /><link rel="next" href="cha.security.cryptofs.html" title="Chapter 11. Encrypting Partitions and Files" /><script type="text/javascript">

var protocol = window.location.protocol.toLowerCase();
if ( protocol != 'file:' ) {
  var agent = navigator.userAgent.toLowerCase();
  var wanted = ( protocol == 'https:') ? 'https' : 'http';
  var file = 'fonts.css';
  document.write('<link rel="stylesheet" type="text/css" href="' + wanted + '://static.opensuse.org/fonts/'+ file +'"></link>');
}
else {
   document.write('<link rel="stylesheet" type="text/css" href="static/css/fonts-onlylocal.css"></link>');
}

</script><noscript><link rel="stylesheet" type="text/css" href="http://static.opensuse.org/fonts/fonts.css" /></noscript><script src="static/js/jquery-1.10.2.min.js" type="text/javascript"></script><script src="static/js/script.js" type="text/javascript"></script><script src="static/js/highlight.min.js" type="text/javascript"></script><script>

$(document).ready(function() {
  $('.verbatim-wrap.highlight').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});
hljs.configure({
  useBR: false
});

</script></head><body class="draft offline js-off"><div id="_outer-wrap"><div id="_white-bg"><div id="_header"><div id="_logo"><img src="static/images/logo.png" alt="Logo" /></div><div class="crumbs"><a class="book-link" href="index.html" title="SUSE Linux Enterprise Desktop Documentation"><span class="book-icon">SUSE Linux Enterprise Desktop Documentation</span></a><span> › </span><a class="crumb" href="book.security.html">Security Guide</a><span> › </span><a class="crumb" href="part.local_security.html">Local Security</a><span> › </span><a class="crumb" href="cha.security.acls.html">Access Control Lists in Linux</a></div><div class="clearme"></div></div></div><div id="_toolbar-wrap"><div id="_toolbar"><div id="_toc-area" class="inactive"><a id="_toc-area-button" class="tool" title="Contents" accesskey="c" href="index.html"><span class="tool-spacer"><span class="toc-icon">Contents</span><span class="clearme"></span></span><span class="tool-label">Contents</span></a><div class="active-contents bubble-corner"></div><div class="active-contents bubble"><div class="bubble-container"><h6>Security Guide</h6><div id="_bubble-toc"><ol><li class="inactive"><a href="preface.security.html"><span class="number"> </span><span class="name">About This Guide</span></a></li><li class="inactive"><a href="cha.security.html"><span class="number">1 </span><span class="name">Security and Confidentiality</span></a></li><li class="inactive"><a href="part.auth.html"><span class="number">I </span><span class="name">Authentication</span></a><ol><li class="inactive"><a href="cha.pam.html"><span class="number">2 </span><span class="name">Authentication with PAM</span></a></li><li class="inactive"><a href="cha.nis.html"><span class="number">3 </span><span class="name">Using NIS</span></a></li><li class="inactive"><a href="cha.security.auth.html"><span class="number">4 </span><span class="name">Setting Up Authentication Servers and Clients Using YaST</span></a></li><li class="inactive"><a href="cha.security.ldap.html"><span class="number">5 </span><span class="name">LDAP—A Directory Service</span></a></li><li class="inactive"><a href="cha.security.kerberos.html"><span class="number">6 </span><span class="name">Network Authentication with Kerberos</span></a></li><li class="inactive"><a href="cha.security.ad.html"><span class="number">7 </span><span class="name">Active Directory Support</span></a></li></ol></li><li class="inactive"><a href="part.local_security.html"><span class="number">II </span><span class="name">Local Security</span></a><ol><li class="inactive"><a href="cha.security.yast_security.html"><span class="number">8 </span><span class="name">Configuring Security Settings with YaST</span></a></li><li class="inactive"><a href="cha.security.policykit.html"><span class="number">9 </span><span class="name">Authorization with PolKit</span></a></li><li class="inactive"><a href="cha.security.acls.html"><span class="number">10 </span><span class="name">Access Control Lists in Linux</span></a></li><li class="inactive"><a href="cha.security.cryptofs.html"><span class="number">11 </span><span class="name">Encrypting Partitions and Files</span></a></li><li class="inactive"><a href="cha.certstore.html"><span class="number">12 </span><span class="name">Certificate Store</span></a></li><li class="inactive"><a href="cha.aide.html"><span class="number">13 </span><span class="name">Intrusion Detection with AIDE</span></a></li></ol></li><li class="inactive"><a href="part.network_security.html"><span class="number">III </span><span class="name">Network Security</span></a><ol><li class="inactive"><a href="cha.ssh.html"><span class="number">14 </span><span class="name">SSH: Secure Network Operations</span></a></li><li class="inactive"><a href="cha.security.firewall.html"><span class="number">15 </span><span class="name">Masquerading and Firewalls</span></a></li><li class="inactive"><a href="cha.security.vpnserver.html"><span class="number">16 </span><span class="name">Configuring a VPN Server</span></a></li><li class="inactive"><a href="cha.security.yast_ca.html"><span class="number">17 </span><span class="name">Managing X.509 Certification</span></a></li></ol></li><li class="inactive"><a href="part.apparmor.html"><span class="number">IV </span><span class="name">Confining Privileges with <span class="phrase">AppArmor</span></span></a><ol><li class="inactive"><a href="cha.apparmor.intro.html"><span class="number">18 </span><span class="name">Introducing <span class="phrase">AppArmor</span></span></a></li><li class="inactive"><a href="cha.apparmor.start.html"><span class="number">19 </span><span class="name">Getting Started</span></a></li><li class="inactive"><a href="cha.apparmor.concept.html"><span class="number">20 </span><span class="name">Immunizing Programs</span></a></li><li class="inactive"><a href="cha.apparmor.profiles.html"><span class="number">21 </span><span class="name">Profile Components and Syntax</span></a></li><li class="inactive"><a href="cha.apparmor.repos.html"><span class="number">22 </span><span class="name"><span class="phrase">AppArmor</span> Profile Repositories</span></a></li><li class="inactive"><a href="cha.apparmor.yast.html"><span class="number">23 </span><span class="name">Building and Managing Profiles with YaST</span></a></li><li class="inactive"><a href="cha.apparmor.commandline.html"><span class="number">24 </span><span class="name">Building Profiles from the Command Line</span></a></li><li class="inactive"><a href="cha.apparmor.hat.html"><span class="number">25 </span><span class="name">Profiling Your Web Applications Using ChangeHat</span></a></li><li class="inactive"><a href="cha.apparmor.pam.html"><span class="number">26 </span><span class="name">Confining Users with <code class="systemitem">pam_apparmor</code></span></a></li><li class="inactive"><a href="cha.apparmor.managing.html"><span class="number">27 </span><span class="name">Managing Profiled Applications</span></a></li><li class="inactive"><a href="cha.apparmor.support.html"><span class="number">28 </span><span class="name">Support</span></a></li><li class="inactive"><a href="cha.apparmor.glossary.html"><span class="number">29 </span><span class="name"><span class="phrase">AppArmor</span> Glossary</span></a></li></ol></li><li class="inactive"><a href="part.audit.html"><span class="number">V </span><span class="name"><em class="citetitle ">The Linux Audit Framework</em></span></a><ol><li class="inactive"><a href="cha.audit.comp.html"><span class="number">30 </span><span class="name">Understanding Linux Audit</span></a></li><li class="inactive"><a href="cha.audit.setup.html"><span class="number">31 </span><span class="name">Setting Up the Linux Audit Framework</span></a></li><li class="inactive"><a href="cha.audit.scenarios.html"><span class="number">32 </span><span class="name">Introducing an Audit Rule Set</span></a></li><li class="inactive"><a href="cha.audit.moreinfo.html"><span class="number">33 </span><span class="name">Useful Resources</span></a></li></ol></li><li class="inactive"><a href="bk05apa.html"><span class="number">A </span><span class="name">GNU Licenses</span></a></li></ol></div><div class="clearme"></div></div></div></div><div id="_nav-area" class="inactive"><div class="tool"><span class="nav-inner"><span class="tool-label">Navigation</span><a accesskey="p" class="tool-spacer" title="Chapter 9. Authorization with PolKit" href="cha.security.policykit.html"><span class="prev-icon">←</span></a><a accesskey="n" class="tool-spacer" title="Chapter 11. Encrypting Partitions and Files" href="cha.security.cryptofs.html"><span class="next-icon">→</span></a></span></div></div></div></div><div id="_fixed-header-wrap" class="inactive"><div id="_fixed-header"><div class="crumbs"><a class="book-link" href="index.html" title="SUSE Linux Enterprise Desktop Documentation"><span class="book-icon">SUSE Linux Enterprise Desktop Documentation</span></a><span> › </span><a class="crumb" href="book.security.html">Security Guide</a><span> › </span><a class="crumb" href="part.local_security.html">Local Security</a><span> › </span><a class="crumb" href="cha.security.acls.html">Access Control Lists in Linux</a></div><div class="buttons"><a class="top-button button" href="#">Top</a><div class="button"><a accesskey="p" class="tool-spacer" title="Chapter 9. Authorization with PolKit" href="cha.security.policykit.html"><span class="prev-icon">←</span></a><a accesskey="n" class="tool-spacer" title="Chapter 11. Encrypting Partitions and Files" href="cha.security.cryptofs.html"><span class="next-icon">→</span></a></div><div class="clearme"></div></div><div class="clearme"></div></div></div><div id="_content" class="draft "><div class="documentation"><div class="chapter " id="cha.security.acls"><div class="titlepage"><div><div class="version-info">Applies to  <span class="productname"><span class="productname"><span class="phrase">SUSE Linux Enterprise Desktop</span></span></span> <span class="productnumber"><span class="productnumber"><span class="phrase">15</span></span></span></div><div><h2 class="title"><span class="number">10 </span><span class="name">Access Control Lists in Linux</span> </h2><div class="doc-status"><ul><li><span class="ds-label">Filename: </span>security_acls.xml</li><li><span class="ds-label">ID: </span>cha.security.acls</li></ul></div></div><div><div class="abstract"><div class="abstract-title-wrap"><h6 class="abstract-title">Abstract<a title="Permalink" class="permalink" href="cha.security.acls.html#idm139839471454320">#</a></h6></div><p>
    POSIX ACLs (access control lists) can be used as an expansion of the
    traditional permission concept for file system objects. With ACLs,
    permissions can be defined more flexibly than with the traditional
    permission concept.
   </p></div></div></div></div><div class="line"><div class="toc"><dl><dt><span class="sect1"><a href="cha.security.acls.html#sec.security.acls.traditional"><span class="number">10.1 </span><span class="name">Traditional File Permissions</span></a></span></dt><dt><span class="sect1"><a href="cha.security.acls.html#sec.security.acls.intro"><span class="number">10.2 </span><span class="name">Advantages of ACLs</span></a></span></dt><dt><span class="sect1"><a href="cha.security.acls.html#sec.security.acls.defs"><span class="number">10.3 </span><span class="name">Definitions</span></a></span></dt><dt><span class="sect1"><a href="cha.security.acls.html#sec.security.acls.handle"><span class="number">10.4 </span><span class="name">Handling ACLs</span></a></span></dt><dt><span class="sect1"><a href="cha.security.acls.html#sec.security.acls.future"><span class="number">10.5 </span><span class="name">ACL Support in Applications</span></a></span></dt><dt><span class="sect1"><a href="cha.security.acls.html#sec.security.acls.info"><span class="number">10.6 </span><span class="name">For More Information</span></a></span></dt></dl></div></div><p>
  The term <span class="emphasis"><em>POSIX ACL</em></span> suggests that this is a true POSIX
  (<span class="emphasis"><em>portable operating system interface</em></span>) standard. The
  respective draft standards POSIX 1003.1e and POSIX 1003.2c have been
  withdrawn for several reasons. Nevertheless, ACLs (as found on many
  systems belonging to the Unix family) are based on these drafts and the
  implementation of file system ACLs (as described in this chapter) follows
  these two standards.
 </p><div class="sect1 " id="sec.security.acls.traditional"><div class="titlepage"><div><div><h2 class="title" id="sec.security.acls.traditional"><span class="number">10.1 </span><span class="name">Traditional File Permissions</span> <a title="Permalink" class="permalink" href="cha.security.acls.html#sec.security.acls.traditional">#</a></h2></div></div></div><p>
   Find detailed information about the traditional file permissions in the
   GNU Coreutils Info page, Node <span class="emphasis"><em>File permissions</em></span>
   (<code class="command">info coreutils "File permissions"</code>). More advanced
   features are the setuid, setgid, and sticky bit.
  </p><div class="sect2 " id="sec.security.acls.traditional.setuid"><div class="titlepage"><div><div><h3 class="title" id="sec.security.acls.traditional.setuid"><span class="number">10.1.1 </span><span class="name">The setuid Bit</span> <a title="Permalink" class="permalink" href="cha.security.acls.html#sec.security.acls.traditional.setuid">#</a></h3></div></div></div><p>
    In certain situations, the access permissions may be too restrictive.
    Therefore, Linux has additional settings that enable the temporary
    change of the current user and group identity for a specific action. For
    example, the <code class="command">passwd</code> program normally requires root
    permissions to access <code class="filename">/etc/passwd</code>. This file
    contains some important information, like the home directories of users
    and user and group IDs. Thus, a normal user would not be able to change
    <code class="filename">passwd</code>, because it would be too dangerous to grant
    all users direct access to this file. A possible solution to this
    problem is the <span class="emphasis"><em>setuid</em></span> mechanism. setuid (set user
    ID) is a special file attribute that instructs the system to execute
    programs marked accordingly under a specific user ID. Consider the
    <code class="command">passwd</code> command:
   </p><div class="verbatim-wrap"><pre class="screen">-rwsr-xr-x  1 root shadow 80036 2004-10-02 11:08 /usr/bin/passwd</pre></div><p>
    You can see the <code class="literal">s</code> that denotes that the setuid bit is
    set for the user permission. By means of the setuid bit, all users
    starting the <code class="command">passwd</code> command execute it as
    <code class="systemitem">root</code>.
   </p></div><div class="sect2 " id="sec.security.acls.traditional.setgid"><div class="titlepage"><div><div><h3 class="title" id="sec.security.acls.traditional.setgid"><span class="number">10.1.2 </span><span class="name">The setgid Bit</span> <a title="Permalink" class="permalink" href="cha.security.acls.html#sec.security.acls.traditional.setgid">#</a></h3></div></div></div><p>
    The setuid bit applies to users. However, there is also an equivalent
    property for groups: the <span class="emphasis"><em>setgid</em></span> bit. A program for
    which this bit was set runs under the group ID under which it was saved,
    no matter which user starts it. Therefore, in a directory with the
    setgid bit, all newly created files and subdirectories are assigned to
    the group to which the directory belongs. Consider the following example
    directory:
   </p><div class="verbatim-wrap"><pre class="screen">drwxrws--- 2 tux archive 48 Nov 19 17:12  backup</pre></div><p>
    You can see the <code class="literal">s</code> that denotes that the setgid bit is
    set for the group permission. The owner of the directory and members of
    the group <code class="systemitem">archive</code> may access
    this directory. Users that are not members of this group are
    <span class="quote">“<span class="quote">mapped</span>”</span> to the respective group. The effective group ID of
    all written files will be
    <code class="systemitem">archive</code>. For example, a
    backup program that runs with the group ID
    <code class="systemitem">archive</code> can access
    this directory even without root privileges.
   </p></div><div class="sect2 " id="sec.security.acls.traditional.sticky"><div class="titlepage"><div><div><h3 class="title" id="sec.security.acls.traditional.sticky"><span class="number">10.1.3 </span><span class="name">The Sticky Bit</span> <a title="Permalink" class="permalink" href="cha.security.acls.html#sec.security.acls.traditional.sticky">#</a></h3></div></div></div><p>
    There is also the <span class="emphasis"><em>sticky bit</em></span>. It makes a difference
    whether it belongs to an executable program or a directory. If it
    belongs to a program, a file marked in this way is loaded to RAM to
    avoid needing to get it from the hard disk each time it is used. This
    attribute is used rarely, because modern hard disks are fast enough. If
    this bit is assigned to a directory, it prevents users from deleting
    each other's files. Typical examples include the
    <code class="filename">/tmp</code> and <code class="filename">/var/tmp</code> directories:
   </p><div class="verbatim-wrap"><pre class="screen">drwxrwxrwt 2 root root 1160 2002-11-19 17:15 /tmp</pre></div></div></div><div class="sect1 " id="sec.security.acls.intro"><div class="titlepage"><div><div><h2 class="title" id="sec.security.acls.intro"><span class="number">10.2 </span><span class="name">Advantages of ACLs</span> <a title="Permalink" class="permalink" href="cha.security.acls.html#sec.security.acls.intro">#</a></h2></div></div></div><p>
   Traditionally, three permission sets are defined for each file object on
   a Linux system. These sets include the read (<code class="literal">r</code>), write
   (<code class="literal">w</code>), and execute (<code class="literal">x</code>) permissions
   for each of three types of users—the file owner, the group, and
   other users. In addition to that, it is possible to set the <span class="emphasis"><em>set
   user id</em></span>, the <span class="emphasis"><em>set group id</em></span>, and the
   <span class="emphasis"><em>sticky</em></span> bit. This lean concept is fully adequate for
   most practical cases. However, for more complex scenarios or advanced
   applications, system administrators formerly needed to use several
   workarounds to circumvent the limitations of the traditional permission
   concept.
  </p><p>
   ACLs can be used as an extension of the traditional file permission
   concept. They allow the assignment of permissions to individual users or
   groups even if these do not correspond to the original owner or the
   owning group. Access control lists are a feature of the Linux kernel and
   are currently supported by Ext2, Ext3, Ext4, JFS, and XFS. Using
   ACLs, complex scenarios can be realized without implementing complex
   permission models on the application level.
  </p><p>
   The advantages of ACLs are evident if you want to replace a Windows
   server with a Linux server. Some connected workstations may
   continue to run under Windows even after the migration. The Linux system
   offers file and print services to the Windows clients with Samba. With
   Samba supporting access control lists, user permissions can be configured
   both on the Linux server and in Windows with a graphical user interface
   (only Windows NT and later). With <code class="command">winbindd</code>, part of
   the Samba suite, it is even possible to assign permissions to users only
   existing in the Windows domain without any account on the Linux server.
  </p></div><div class="sect1 " id="sec.security.acls.defs"><div class="titlepage"><div><div><h2 class="title" id="sec.security.acls.defs"><span class="number">10.3 </span><span class="name">Definitions</span> <a title="Permalink" class="permalink" href="cha.security.acls.html#sec.security.acls.defs">#</a></h2></div></div></div><div class="variablelist "><dl class="variablelist"><dt id="idm139839471420208"><span class="term ">User Class</span></dt><dd><p>
      The conventional POSIX permission concept uses three
      <span class="emphasis"><em>classes</em></span> of users for assigning permissions in the
      file system: the owner, the owning group, and other users. Three
      permission bits can be set for each user class, giving permission to
      read (<code class="literal">r</code>), write (<code class="literal">w</code>), and execute
      (<code class="literal">x</code>).
     </p></dd><dt id="idm139839471416384"><span class="term ">ACL</span></dt><dd><p>
      The user and group access permissions for all kinds of
      file system objects (files and directories) are determined by means of
      ACLs.
     </p></dd><dt id="idm139839471414448"><span class="term ">Default ACL</span></dt><dd><p>
      Default ACLs can only be applied to directories. They determine the
      permissions a file system object inherits from its parent directory
      when it is created.
     </p></dd><dt id="idm139839471412496"><span class="term ">ACL Entry</span></dt><dd><p>
      Each ACL consists of a set of ACL entries. An ACL entry contains a
      type, a qualifier for the user or group to which the entry refers, and
      a set of permissions. For some entry types, the qualifier for the
      group or users is undefined.
     </p></dd></dl></div></div><div class="sect1 " id="sec.security.acls.handle"><div class="titlepage"><div><div><h2 class="title" id="sec.security.acls.handle"><span class="number">10.4 </span><span class="name">Handling ACLs</span> <a title="Permalink" class="permalink" href="cha.security.acls.html#sec.security.acls.handle">#</a></h2></div></div></div><p>
   <a class="xref" href="cha.security.acls.html#tab.entrytype" title="ACL Entry Types">Table 10.1, “ACL Entry Types”</a> summarizes the six possible types of ACL
   entries, each defining permissions for a user or a group of users. The
   <span class="emphasis"><em>owner</em></span> entry defines the permissions of the user
   owning the file or directory. The <span class="emphasis"><em>owning group</em></span> entry
   defines the permissions of the file's owning group. The superuser can
   change the owner or owning group with <code class="command">chown</code> or
   <code class="command">chgrp</code>, in which case the owner and owning group
   entries refer to the new owner and owning group. Each <span class="emphasis"><em>named
   user</em></span> entry defines the permissions of the user specified in
   the entry's qualifier field. Each <span class="emphasis"><em>named group</em></span> entry
   defines the permissions of the group specified in the entry's qualifier
   field. Only the named user and named group entries have a qualifier field
   that is not empty. The <span class="emphasis"><em>other</em></span> entry defines the
   permissions of all other users.
  </p><p>
   The <span class="emphasis"><em>mask</em></span> entry further limits the permissions
   granted by named user, named group, and owning group entries by defining
   which of the permissions in those entries are effective and which are
   masked. If permissions exist in one of the mentioned entries and
   in the mask, they are effective. Permissions contained only in the mask
   or only in the actual entry are not effective—meaning the
   permissions are not granted. All permissions defined in the owner and
   owning group entries are always effective. The example in
   <a class="xref" href="cha.security.acls.html#tab.mask" title="Masking Access Permissions">Table 10.2, “Masking Access Permissions”</a> demonstrates this mechanism.
  </p><p>
   There are two basic classes of ACLs: A <span class="emphasis"><em>minimum</em></span> ACL
   contains only the entries for the types owner, owning group, and other,
   which correspond to the conventional permission bits for files and
   directories. An <span class="emphasis"><em>extended</em></span> ACL goes beyond this. It
   must contain a mask entry and may contain several entries of the named
   user and named group types.
  </p><div class="table" id="tab.entrytype"><div class="table-title-wrap"><h6 class="table-title"><span class="number">Table 10.1: </span><span class="name">ACL Entry Types </span><a title="Permalink" class="permalink" href="cha.security.acls.html#tab.entrytype">#</a></h6></div><div class="table-contents"><table summary="ACL Entry Types" border="1"><colgroup><col /><col /></colgroup><thead><tr><th>
       <p>
        Type
       </p>
      </th><th>
       <p>
        Text Form
       </p>
      </th></tr></thead><tbody><tr><td>
       <p>
        owner
       </p>
      </td><td>
       <p>
        <code class="literal">user::rwx</code>
       </p>
      </td></tr><tr><td>
       <p>
        named user
       </p>
      </td><td>
       <p>
        <code class="literal">user:name:rwx</code>
       </p>
      </td></tr><tr><td>
       <p>
        owning group
       </p>
      </td><td>
       <p>
        <code class="literal">group::rwx</code>
       </p>
      </td></tr><tr><td>
       <p>
        named group
       </p>
      </td><td>
       <p>
        <code class="literal">group:name:rwx</code>
       </p>
      </td></tr><tr><td>
       <p>
        mask
       </p>
      </td><td>
       <p>
        <code class="literal">mask::rwx</code>
       </p>
      </td></tr><tr><td>
       <p>
        other
       </p>
      </td><td>
       <p>
        <code class="literal">other::rwx</code>
       </p>
      </td></tr></tbody></table></div></div><div class="table" id="tab.mask"><div class="table-title-wrap"><h6 class="table-title"><span class="number">Table 10.2: </span><span class="name">Masking Access Permissions </span><a title="Permalink" class="permalink" href="cha.security.acls.html#tab.mask">#</a></h6></div><div class="table-contents"><table summary="Masking Access Permissions" border="1"><colgroup><col /><col /><col /></colgroup><thead><tr><th>
       <p>
        Entry Type
       </p>
      </th><th>
       <p>
        Text Form
       </p>
      </th><th>
       <p>
        Permissions
       </p>
      </th></tr></thead><tbody><tr><td>
       <p>
        named user
       </p>
      </td><td>
       <p>
        <code class="literal">user:geeko:r-x</code>
       </p>
      </td><td>
       <p>
        <code class="literal">r-x</code>
       </p>
      </td></tr><tr><td>
       <p>
        mask
       </p>
      </td><td>
       <p>
        <code class="literal">mask::rw-</code>
       </p>
      </td><td>
       <p>
        <code class="literal">rw-</code>
       </p>
      </td></tr><tr><td>
       
      </td><td>
       <p>
        effective permissions:
       </p>
      </td><td>
       <p>
        <code class="literal">r--</code>
       </p>
      </td></tr></tbody></table></div></div><div class="sect2 " id="sec.security.acls.handle.fmbits"><div class="titlepage"><div><div><h3 class="title" id="sec.security.acls.handle.fmbits"><span class="number">10.4.1 </span><span class="name">ACL Entries and File Mode Permission Bits</span> <a title="Permalink" class="permalink" href="cha.security.acls.html#sec.security.acls.handle.fmbits">#</a></h3></div></div></div><p>
    <a class="xref" href="cha.security.acls.html#fig.acls.map.mini" title="Minimum ACL: ACL Entries Compared to Permission Bits">Figure 10.1, “Minimum ACL: ACL Entries Compared to Permission Bits”</a> and
    <a class="xref" href="cha.security.acls.html#fig.acls.map.ext" title="Extended ACL: ACL Entries Compared to Permission Bits">Figure 10.2, “Extended ACL: ACL Entries Compared to Permission Bits”</a> illustrate the two cases of a minimum
    ACL and an extended ACL. The figures are structured in three
    blocks—the left block shows the type specifications of the ACL
    entries, the center block displays an example ACL, and the right block
    shows the respective permission bits according to the conventional
    permission concept (for example, as displayed by <code class="command">ls</code>
    <code class="option">-l</code>). In both cases, the <span class="emphasis"><em>owner
    class</em></span> permissions are mapped to the ACL entry owner.
    <span class="emphasis"><em>Other class</em></span> permissions are mapped to the
    respective ACL entry. However, the mapping of the <span class="emphasis"><em>group
    class</em></span> permissions is different in the two cases.
   </p><div class="figure" id="fig.acls.map.mini"><div class="figure-contents"><div class="mediaobject"><a xmlns="" href="images/acls_map_mini.png"><img src="images/acls_map_mini.png" width="" alt="Minimum ACL: ACL Entries Compared to Permission Bits" /></a></div></div><div class="figure-title-wrap"><h6 class="figure-title"><span class="number">Figure 10.1: </span><span class="name">Minimum ACL: ACL Entries Compared to Permission Bits </span><a title="Permalink" class="permalink" href="cha.security.acls.html#fig.acls.map.mini">#</a></h6></div></div><p>
    In the case of a minimum ACL—without mask—the group
    class permissions are mapped to the ACL entry owning group. This is
    shown in <a class="xref" href="cha.security.acls.html#fig.acls.map.mini" title="Minimum ACL: ACL Entries Compared to Permission Bits">Figure 10.1, “Minimum ACL: ACL Entries Compared to Permission Bits”</a>. In the case of an extended
    ACL—with mask—the group class permissions are mapped
    to the mask entry. This is shown in <a class="xref" href="cha.security.acls.html#fig.acls.map.ext" title="Extended ACL: ACL Entries Compared to Permission Bits">Figure 10.2, “Extended ACL: ACL Entries Compared to Permission Bits”</a>.
   </p><div class="figure" id="fig.acls.map.ext"><div class="figure-contents"><div class="mediaobject"><a xmlns="" href="images/acls_map_ext.png"><img src="images/acls_map_ext.png" width="" alt="Extended ACL: ACL Entries Compared to Permission Bits" /></a></div></div><div class="figure-title-wrap"><h6 class="figure-title"><span class="number">Figure 10.2: </span><span class="name">Extended ACL: ACL Entries Compared to Permission Bits </span><a title="Permalink" class="permalink" href="cha.security.acls.html#fig.acls.map.ext">#</a></h6></div></div><p>
    This mapping approach ensures the smooth interaction of applications,
    regardless of whether they have ACL support. The access permissions that
    were assigned by means of the permission bits represent the upper limit
    for all other <span class="quote">“<span class="quote">fine adjustments</span>”</span> made with an ACL. Changes
    made to the permission bits are reflected by the ACL and vice versa.
   </p></div><div class="sect2 " id="sec.security.acls.handle.accacl"><div class="titlepage"><div><div><h3 class="title" id="sec.security.acls.handle.accacl"><span class="number">10.4.2 </span><span class="name">A Directory with an ACL</span> <a title="Permalink" class="permalink" href="cha.security.acls.html#sec.security.acls.handle.accacl">#</a></h3></div></div></div><p>
    With <code class="command">getfacl</code> and <code class="command">setfacl</code> on the
    command line, you can access ACLs. The usage of these commands is
    demonstrated in the following example.
   </p><p>
    Before creating the directory, use the <code class="command">umask</code> command
    to define which access permissions should be masked each time a file
    object is created. The command <code class="command">umask</code>
    <code class="option">027</code> sets the default permissions by giving the owner
    the full range of permissions (<code class="literal">0</code>), denying the group
    write access (<code class="literal">2</code>), and giving other users no
    permissions (<code class="literal">7</code>). <code class="command">umask</code>
    actually masks the corresponding permission bits or turns them off. For
    details, consult the <code class="command">umask</code> man page.
   </p><p>
    <code class="command">mkdir mydir</code> creates the <code class="filename">mydir</code>
    directory with the default permissions as set by
    <code class="command">umask</code>. Use <code class="command">ls</code> <code class="option">-dl
    mydir</code> to check whether all permissions were assigned correctly.
    The output for this example is:
   </p><div class="verbatim-wrap"><pre class="screen">drwxr-x--- ... tux project3 ... mydir</pre></div><p>
    With <code class="command">getfacl</code> <code class="option">mydir</code>, check the
    initial state of the ACL. This gives information like:
   </p><div class="verbatim-wrap"><pre class="screen"># file: mydir
# owner: tux
# group: project3
user::rwx
group::r-x
other::---</pre></div><p>
    The first three output lines display the name, owner, and
    owning group of the directory. The next three lines contain the three
    ACL entries owner, owning group, and other. In fact, in the case of this
    minimum ACL, the <code class="command">getfacl</code> command does not produce any
    information you could not have obtained with <code class="command">ls</code>.
   </p><p>
    Modify the ACL to assign read, write, and execute permissions to an
    additional user <code class="literal">geeko</code> and an additional group
    <code class="literal">mascots</code> with:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>setfacl -m user:geeko:rwx,group:mascots:rwx mydir</pre></div><p>
    The option <code class="option">-m</code> prompts <code class="command">setfacl</code> to
    modify the existing ACL. The following argument indicates the ACL
    entries to modify (multiple entries are separated by commas). The final
    part specifies the name of the directory to which these modifications
    should be applied. Use the <code class="command">getfacl</code> command to take a
    look at the resulting ACL.
   </p><div class="verbatim-wrap"><pre class="screen"># file: mydir
# owner: tux
# group: project3
user::rwx
user:geeko:rwx
group::r-x
group:mascots:rwx
mask::rwx
other::---</pre></div><p>
    In addition to the entries initiated for the user
    <code class="literal">geeko</code> and the group <code class="literal">mascots</code>, a
    mask entry has been generated. This mask entry is set automatically so
    that all permissions are effective. <code class="command">setfacl</code>
    automatically adapts existing mask entries to the settings modified,
    unless you deactivate this feature with <code class="literal">-n</code>. The mask
    entry defines the maximum effective access permissions for all entries
    in the group class. This includes named user, named group, and owning
    group. The group class permission bits displayed by
    <code class="command">ls</code> <code class="option">-dl mydir</code> now correspond to the
    <code class="literal">mask</code> entry.
   </p><div class="verbatim-wrap"><pre class="screen">drwxrwx---+ ... tux project3 ... mydir</pre></div><p>
    The first column of the output contains an additional
    <code class="literal">+</code> to indicate that there is an
    <span class="emphasis"><em>extended</em></span> ACL for this item.
   </p><p>
    According to the output of the <code class="command">ls</code> command, the
    permissions for the mask entry include write access. Traditionally, such
    permission bits would mean that the owning group (here
    <code class="literal">project3</code>) also has write access to the directory
    <code class="filename">mydir</code>.
   </p><p>
    However, the effective access permissions for the owning group
    correspond to the overlapping portion of the permissions defined for the
    owning group and for the mask—which is <code class="literal">r-x</code>
    in our example (see <a class="xref" href="cha.security.acls.html#tab.mask" title="Masking Access Permissions">Table 10.2, “Masking Access Permissions”</a>). As far as the effective
    permissions of the owning group in this example are concerned, nothing
    has changed even after the addition of the ACL entries.
   </p><p>
    Edit the mask entry with <code class="command">setfacl</code> or
    <code class="command">chmod</code>. For example, use <code class="command">chmod</code>
    <code class="option">g-w mydir</code>. <code class="command">ls</code> <code class="option">-dl
    mydir</code> then shows:
   </p><div class="verbatim-wrap"><pre class="screen">drwxr-x---+ ... tux project3 ... mydir</pre></div><p>
    <code class="command">getfacl</code> <code class="option">mydir</code> provides the following
    output:
   </p><div class="verbatim-wrap"><pre class="screen"># file: mydir
# owner: tux
# group: project3
user::rwx
user:geeko:rwx          # effective: r-x
group::r-x
group:mascots:rwx       # effective: r-x
mask::r-x
other::---</pre></div><p>
    After executing <code class="command">chmod</code> to remove the write
    permission from the group class bits, the output of
    <code class="command">ls</code> is sufficient to see that the mask bits
    must have changed accordingly: write permission is again limited to the
    owner of <code class="filename">mydir</code>. The output of the
    <code class="command">getfacl</code> confirms this. This output includes a comment
    for all those entries in which the effective permission bits do not
    correspond to the original permissions, because they are filtered
    according to the mask entry. The original permissions can be restored at
    any time with <code class="command">chmod g+w mydir</code>.
   </p></div><div class="sect2 " id="sec.security.acls.handle.defacl"><div class="titlepage"><div><div><h3 class="title" id="sec.security.acls.handle.defacl"><span class="number">10.4.3 </span><span class="name">A Directory with a Default ACL</span> <a title="Permalink" class="permalink" href="cha.security.acls.html#sec.security.acls.handle.defacl">#</a></h3></div></div></div><p>
    Directories can have a default ACL, which is a special kind of ACL
    defining the access permissions that objects in the directory inherit
    when they are created. A default ACL affects both subdirectories and
    files.
   </p><div class="sect3 " id="sec.security.acls.handle.defacl.eff"><div class="titlepage"><div><div><h4 class="title" id="sec.security.acls.handle.defacl.eff"><span class="number">10.4.3.1 </span><span class="name">Effects of a Default ACL</span> <a title="Permalink" class="permalink" href="cha.security.acls.html#sec.security.acls.handle.defacl.eff">#</a></h4></div></div></div><p>
     There are two ways in which the permissions of a directory's default
     ACL are passed to the files and subdirectories:
    </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
       A subdirectory inherits the default ACL of the parent directory both
       as its default ACL and as an ACL.
      </p></li><li class="listitem "><p>
       A file inherits the default ACL as its ACL.
      </p></li></ul></div><p>
     All system calls that create file system objects use a
     <code class="literal">mode</code> parameter that defines the access permissions
     for the newly created file system object. If the parent directory does
     not have a default ACL, the permission bits as defined by the
     <code class="literal">umask</code> are subtracted from the permissions as passed
     by the <code class="literal">mode</code> parameter, with the result being
     assigned to the new object. If a default ACL exists for the parent
     directory, the permission bits assigned to the new object correspond to
     the overlapping portion of the permissions of the
     <code class="literal">mode</code> parameter and those that are defined in the
     default ACL. The <code class="literal">umask</code> is disregarded in this case.
    </p></div><div class="sect3 " id="sec.security.acls.handle.defacl.prac"><div class="titlepage"><div><div><h4 class="title" id="sec.security.acls.handle.defacl.prac"><span class="number">10.4.3.2 </span><span class="name">Application of Default ACLs</span> <a title="Permalink" class="permalink" href="cha.security.acls.html#sec.security.acls.handle.defacl.prac">#</a></h4></div></div></div><p>
     The following three examples show the main operations for directories
     and default ACLs:
    </p><div class="orderedlist "><ol class="orderedlist" type="1"><li class="listitem "><p>
       Add a default ACL to the existing directory
       <code class="filename">mydir</code> with:
      </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>setfacl -d -m group:mascots:r-x mydir</pre></div><p>
       The option <code class="literal">-d</code> of the <code class="command">setfacl</code>
       command prompts <code class="command">setfacl</code> to perform the following
       modifications (option <code class="literal">-m</code>) in the default ACL.
      </p><p>
       Take a closer look at the result of this command:
      </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>getfacl mydir

# file: mydir
# owner: tux
# group: project3
user::rwx
user:geeko:rwx
group::r-x
group:mascots:rwx
mask::rwx
other::---
default:user::rwx
default:group::r-x
default:group:mascots:r-x
default:mask::r-x
default:other::---</pre></div><p>
       <code class="command">getfacl</code> returns both the ACL and the default ACL.
       The default ACL is formed by all lines that start with
       <code class="literal">default</code>. Although you merely executed the
       <code class="command">setfacl</code> command with an entry for the
       <code class="literal">mascots</code> group for the default ACL,
       <code class="command">setfacl</code> automatically copied all other entries
       from the ACL to create a valid default ACL. Default ACLs do not have
       an immediate effect on access permissions. They only come into play
       when file system objects are created. These new objects inherit
       permissions only from the default ACL of their parent directory.
      </p></li><li class="listitem "><p>
       In the next example, use <code class="command">mkdir</code> to create a
       subdirectory in <code class="filename">mydir</code>, which inherits the
       default ACL.
      </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>mkdir mydir/mysubdir

getfacl mydir/mysubdir

# file: mydir/mysubdir
# owner: tux
# group: project3
user::rwx
group::r-x
group:mascots:r-x
mask::r-x
other::---
default:user::rwx
default:group::r-x
default:group:mascots:r-x
default:mask::r-x
default:other::---</pre></div><p>
       As expected, the newly-created subdirectory
       <code class="filename">mysubdir</code> has the permissions from the default
       ACL of the parent directory. The ACL of <code class="filename">mysubdir</code>
       is an exact reflection of the default ACL of
       <code class="filename">mydir</code>. The default ACL that this directory will
       hand down to its subordinate objects is also the same.
      </p></li><li class="listitem "><p>
       Use <code class="command">touch</code> to create a file in the
       <code class="filename">mydir</code> directory, for example,
       <code class="command">touch</code> <code class="option">mydir/myfile</code>.
       <code class="command">ls</code> <code class="option">-l mydir/myfile</code> then shows:
      </p><div class="verbatim-wrap"><pre class="screen">-rw-r-----+ ... tux project3 ... mydir/myfile</pre></div><p>
       The output of <code class="command">getfacl</code>
       <code class="option">mydir/myfile</code> is:
      </p><div class="verbatim-wrap"><pre class="screen"># file: mydir/myfile
# owner: tux
# group: project3
user::rw-
group::r-x          # effective:r--
group:mascots:r-x   # effective:r--
mask::r--
other::---</pre></div><p>
       <code class="command">touch</code> uses a <code class="literal">mode</code> with the
       value <code class="literal">0666</code> when creating new files, which means
       that the files are created with read and write permissions for all
       user classes, provided no other restrictions exist in
       <code class="command">umask</code> or in the default ACL (see
       <a class="xref" href="cha.security.acls.html#sec.security.acls.handle.defacl.eff" title="10.4.3.1. Effects of a Default ACL">Section 10.4.3.1, “Effects of a Default ACL”</a>). In effect,
       this means that all access permissions not contained in the
       <code class="literal">mode</code> value are removed from the respective ACL
       entries. Although no permissions were removed from the ACL entry of
       the group class, the mask entry was modified to mask permissions not
       set in <code class="literal">mode</code>.
      </p><p>
       This approach ensures the smooth interaction of applications (such as
       compilers) with ACLs. You can create files with restricted access
       permissions and subsequently mark them as executable. The
       <code class="command">mask</code> mechanism guarantees that the right users and
       groups can execute them as desired.
      </p></li></ol></div></div></div><div class="sect2 " id="sec.security.acls.handle.alg"><div class="titlepage"><div><div><h3 class="title" id="sec.security.acls.handle.alg"><span class="number">10.4.4 </span><span class="name">The ACL Check Algorithm</span> <a title="Permalink" class="permalink" href="cha.security.acls.html#sec.security.acls.handle.alg">#</a></h3></div></div></div><p>
    A check algorithm is applied before any process or application is
    granted access to an ACL-protected file system object. As a basic rule,
    the ACL entries are examined in the following sequence: owner, named
    user, owning group or named group, and other. The access is handled in
    accordance with the entry that best suits the process. Permissions do
    not accumulate.
   </p><p>
    Things are more complicated if a process belongs to more than one group
    and would potentially suit several group entries. An entry is randomly
    selected from the suitable entries with the required permissions. It is
    irrelevant which of the entries triggers the final result <span class="quote">“<span class="quote">access
    granted</span>”</span>. Likewise, if none of the suitable group entries contain
    the required permissions, a randomly selected entry triggers the final
    result <span class="quote">“<span class="quote">access denied</span>”</span>.
   </p></div></div><div class="sect1 " id="sec.security.acls.future"><div class="titlepage"><div><div><h2 class="title" id="sec.security.acls.future"><span class="number">10.5 </span><span class="name">ACL Support in Applications</span> <a title="Permalink" class="permalink" href="cha.security.acls.html#sec.security.acls.future">#</a></h2></div></div></div><p>
   ACLs can be used to implement very complex permission scenarios that meet
   the requirements of modern applications. The traditional permission
   concept and ACLs can be combined in a smart manner. The basic file
   commands (<code class="command">cp</code>, <code class="command">mv</code>,
   <code class="command">ls</code>, etc.) support ACLs, as do Samba and Nautilus.
  </p><p>
   Unfortunately, many editors and file managers still lack ACL support.
   When copying files with Emacs, for example, the ACLs of these files are
   lost.
   
   When modifying files with an editor, the ACLs of files are sometimes
   preserved and sometimes not, depending on the backup mode of the editor
   used. If the editor writes the changes to the original file, the ACL is
   preserved. If the editor saves the updated contents to a new file that is
   subsequently renamed to the old file name, the ACLs may be lost, unless
   the editor supports ACLs. Except for the <code class="command">star</code>
   archiver, there are currently no backup applications that preserve ACLs.
  </p></div><div class="sect1 " id="sec.security.acls.info"><div class="titlepage"><div><div><h2 class="title" id="sec.security.acls.info"><span class="number">10.6 </span><span class="name">For More Information</span> <a title="Permalink" class="permalink" href="cha.security.acls.html#sec.security.acls.info">#</a></h2></div></div></div><p>
   For more information about ACLs, see the man pages for
   <code class="command">getfacl(1)</code>, <code class="command">acl(5)</code>, and
   <code class="command">setfacl(1)</code>.
  </p></div></div></div><div class="page-bottom"><div id="_bottom-navigation"><a class="nav-link" href="cha.security.cryptofs.html"><span class="next-icon">→</span><span class="nav-label"><span class="number">Chapter 11 </span>Encrypting Partitions and Files</span></a><a class="nav-link" href="cha.security.policykit.html"><span class="prev-icon">←</span><span class="nav-label"><span class="number">Chapter 9 </span>Authorization with PolKit</span></a></div><div id="_share-print"><div class="online-contents share"><strong>Share this page: </strong><span class="share-buttons"><span id="_share-fb" class="bottom-button">Facebook</span><span class="spacer"> • </span><span id="_share-gp" class="bottom-button">Google+</span><span class="spacer"> • </span><span id="_share-tw" class="bottom-button">Twitter</span><span class="spacer"> • </span><span id="_share-mail" class="bottom-button">E-Mail</span></span></div><div class="print"><span id="_print-button" class="bottom-button">Print this page</span></div><div class="clearme"></div></div></div></div><div id="_inward"></div></div><div id="_footer-wrap"><div id="_footer"><p>©
        2018 
        SUSE</p><ul><li><a href="http://www.suse.com/company/careers/" target="_top">Careers</a></li><li><a href="http://www.suse.com/company/legal/" target="_top">Legal</a></li><li><a href="http://www.suse.com/company/" target="_top">About</a></li><li><a href="http://www.suse.com/ContactsOffices/contacts_offices.jsp" target="_top">Contact Us</a></li></ul></div></div></body></html>