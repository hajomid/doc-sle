<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang=""><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Mass Storage over IP Networks: iSCSI | Storage Administration Guide | SUSE Linux Enterprise Server 15</title><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" /><link rel="stylesheet" type="text/css" href="static/css/style.css" /><link rel="stylesheet" type="text/css" href="static/css/highlight.css" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><meta name="product-name" content="SUSE Linux Enterprise Server" /><meta name="product-number" content="15" /><meta name="book-title" content="Storage Administration Guide" /><meta name="chapter-title" content="Chapter 14. Mass Storage over IP Networks: iSCSI" /><meta name="tracker-url" content="https://bugzilla.suse.com/enter_bug.cgi" /><meta name="tracker-type" content="bsc" /><meta name="tracker-bsc-assignee" content="fs@suse.com" /><meta name="tracker-bsc-component" content="Documentation" /><meta name="tracker-bsc-product" content="SUSE Linux Enterprise Server 15" /><link rel="home" href="index.html" title="SUSE Linux Enterprise Server Documentation" /><link rel="up" href="part.net_storage.html" title="Part IV. Network Storage" /><link rel="prev" href="cha.isns.html" title="Chapter 13. iSNS for Linux" /><link rel="next" href="cha.fcoe.html" title="Chapter 15. Fibre Channel Storage over Ethernet Networks: FCoE" /><script type="text/javascript">

var protocol = window.location.protocol.toLowerCase();
if ( protocol != 'file:' ) {
  var agent = navigator.userAgent.toLowerCase();
  var wanted = ( protocol == 'https:') ? 'https' : 'http';
  var file = 'fonts.css';
  document.write('<link rel="stylesheet" type="text/css" href="' + wanted + '://static.opensuse.org/fonts/'+ file +'"></link>');
}
else {
   document.write('<link rel="stylesheet" type="text/css" href="static/css/fonts-onlylocal.css"></link>');
}

</script><noscript><link rel="stylesheet" type="text/css" href="http://static.opensuse.org/fonts/fonts.css" /></noscript><script src="static/js/jquery-1.10.2.min.js" type="text/javascript"></script><script src="static/js/script.js" type="text/javascript"></script><script src="static/js/highlight.min.js" type="text/javascript"></script><script>

$(document).ready(function() {
  $('.verbatim-wrap.highlight').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});
hljs.configure({
  useBR: false
});

</script></head><body class="draft offline js-off"><div id="_outer-wrap"><div id="_white-bg"><div id="_header"><div id="_logo"><img src="static/images/logo.png" alt="Logo" /></div><div class="crumbs"><a class="book-link" href="index.html" title="SUSE Linux Enterprise Server Documentation"><span class="book-icon">SUSE Linux Enterprise Server Documentation</span></a><span> › </span><a class="crumb" href="stor_admin.html">Storage Administration Guide</a><span> › </span><a class="crumb" href="part.net_storage.html">Network Storage</a><span> › </span><a class="crumb" href="cha.iscsi.html">Mass Storage over IP Networks: iSCSI</a></div><div class="clearme"></div></div></div><div id="_toolbar-wrap"><div id="_toolbar"><div id="_toc-area" class="inactive"><a id="_toc-area-button" class="tool" title="Contents" accesskey="c" href="index.html"><span class="tool-spacer"><span class="toc-icon">Contents</span><span class="clearme"></span></span><span class="tool-label">Contents</span></a><div class="active-contents bubble-corner"></div><div class="active-contents bubble"><div class="bubble-container"><h6>Storage Administration Guide</h6><div id="_bubble-toc"><ol><li class="inactive"><a href="storage.preface.html"><span class="number"> </span><span class="name">About This Guide</span></a></li><li class="inactive"><a href="part.filesystems.html"><span class="number">I </span><span class="name">File Systems and Mounting</span></a><ol><li class="inactive"><a href="cha.filesystems.html"><span class="number">1 </span><span class="name">Overview of File Systems in Linux</span></a></li><li class="inactive"><a href="cha.resize_fs.html"><span class="number">2 </span><span class="name">Resizing File Systems</span></a></li><li class="inactive"><a href="cha.uuid.html"><span class="number">3 </span><span class="name">Using UUIDs to Mount Devices</span></a></li><li class="inactive"><a href="cha.multitiercache.html"><span class="number">4 </span><span class="name">Multi-tier Caching for Block Device Operations</span></a></li></ol></li><li class="inactive"><a href="part.lvm.html"><span class="number">II </span><span class="name">Logical Volumes (LVM)</span></a><ol><li class="inactive"><a href="cha.lvm.html"><span class="number">5 </span><span class="name">LVM Configuration</span></a></li><li class="inactive"><a href="cha.lvm_snapshots.html"><span class="number">6 </span><span class="name">LVM Volume Snapshots</span></a></li></ol></li><li class="inactive"><a href="part.software_raid.html"><span class="number">III </span><span class="name">Software RAID</span></a><ol><li class="inactive"><a href="cha.raid.html"><span class="number">7 </span><span class="name">Software RAID Configuration</span></a></li><li class="inactive"><a href="cha.raidroot.html"><span class="number">8 </span><span class="name">Configuring Software RAID for the Root Partition</span></a></li><li class="inactive"><a href="cha.raid10.html"><span class="number">9 </span><span class="name">Creating Software RAID 10 Devices</span></a></li><li class="inactive"><a href="cha.raid_degraded.html"><span class="number">10 </span><span class="name">Creating a Degraded RAID Array</span></a></li><li class="inactive"><a href="cha.raid_resize.html"><span class="number">11 </span><span class="name">Resizing Software RAID Arrays with mdadm</span></a></li><li class="inactive"><a href="cha.raid_leds.html"><span class="number">12 </span><span class="name">Storage Enclosure LED Utilities for MD Software RAIDs</span></a></li></ol></li><li class="inactive"><a href="part.net_storage.html"><span class="number">IV </span><span class="name">Network Storage</span></a><ol><li class="inactive"><a href="cha.isns.html"><span class="number">13 </span><span class="name">iSNS for Linux</span></a></li><li class="inactive"><a href="cha.iscsi.html"><span class="number">14 </span><span class="name">Mass Storage over IP Networks: iSCSI</span></a></li><li class="inactive"><a href="cha.fcoe.html"><span class="number">15 </span><span class="name">Fibre Channel Storage over Ethernet Networks: FCoE</span></a></li><li class="inactive"><a href="cha.multipath.html"><span class="number">16 </span><span class="name">Managing Multipath I/O for Devices</span></a></li><li class="inactive"><a href="cha.nfs4_acls.html"><span class="number">17 </span><span class="name">Managing Access Control Lists over NFSv4</span></a></li></ol></li><li class="inactive"><a href="bk08apa.html"><span class="number">A </span><span class="name">GNU Licenses</span></a></li></ol></div><div class="clearme"></div></div></div></div><div id="_nav-area" class="inactive"><div class="tool"><span class="nav-inner"><span class="tool-label">Navigation</span><a accesskey="p" class="tool-spacer" title="Chapter 13. iSNS for Linux" href="cha.isns.html"><span class="prev-icon">←</span></a><a accesskey="n" class="tool-spacer" title="Chapter 15. Fibre Channel Storage over Ethernet Networks: FCoE" href="cha.fcoe.html"><span class="next-icon">→</span></a></span></div></div></div></div><div id="_fixed-header-wrap" class="inactive"><div id="_fixed-header"><div class="crumbs"><a class="book-link" href="index.html" title="SUSE Linux Enterprise Server Documentation"><span class="book-icon">SUSE Linux Enterprise Server Documentation</span></a><span> › </span><a class="crumb" href="stor_admin.html">Storage Administration Guide</a><span> › </span><a class="crumb" href="part.net_storage.html">Network Storage</a><span> › </span><a class="crumb" href="cha.iscsi.html">Mass Storage over IP Networks: iSCSI</a></div><div class="buttons"><a class="top-button button" href="#">Top</a><div class="button"><a accesskey="p" class="tool-spacer" title="Chapter 13. iSNS for Linux" href="cha.isns.html"><span class="prev-icon">←</span></a><a accesskey="n" class="tool-spacer" title="Chapter 15. Fibre Channel Storage over Ethernet Networks: FCoE" href="cha.fcoe.html"><span class="next-icon">→</span></a></div><div class="clearme"></div></div><div class="clearme"></div></div></div><div id="_content" class="draft "><div class="documentation"><div xml:lang="en" class="chapter " id="cha.iscsi" lang="en"><div class="titlepage"><div><div class="version-info">Applies to  <span class="productname"><span class="productname"><span class="phrase">SUSE Linux Enterprise Server</span></span></span> <span class="productnumber"><span class="productnumber"><span class="phrase">15</span></span></span></div><div><h2 class="title"><span class="number">14 </span><span class="name">Mass Storage over IP Networks: iSCSI</span> </h2><div class="doc-status"><ul><li><span class="ds-label">Filename: </span>storage_iscsi.xml</li><li><span class="ds-label">ID: </span>cha.iscsi</li></ul></div></div></div></div><div class="line"><div class="toc"><dl><dt><span class="sect1"><a href="cha.iscsi.html#sec.iscsi.install"><span class="number">14.1 </span><span class="name">Installing the iSCSI LIO Target Server and iSCSI Initiator</span></a></span></dt><dt><span class="sect1"><a href="cha.iscsi.html#sec.iscsi.target"><span class="number">14.2 </span><span class="name">Setting Up an iSCSI LIO Target Server</span></a></span></dt><dt><span class="sect1"><a href="cha.iscsi.html#sec.iscsi.initiator"><span class="number">14.3 </span><span class="name">Configuring iSCSI Initiator</span></a></span></dt><dt><span class="sect1"><a href="cha.iscsi.html#sec.iscsi.installation"><span class="number">14.4 </span><span class="name">Using iSCSI Disks when Installing</span></a></span></dt><dt><span class="sect1"><a href="cha.iscsi.html#sec.iscsi.trouble"><span class="number">14.5 </span><span class="name">Troubleshooting iSCSI</span></a></span></dt><dt><span class="sect1"><a href="cha.iscsi.html#sec.iscsi.terminology"><span class="number">14.6 </span><span class="name">iSCSI LIO Target Terminology</span></a></span></dt><dt><span class="sect1"><a href="cha.iscsi.html#sec.iscsi.info"><span class="number">14.7 </span><span class="name">Additional Information</span></a></span></dt></dl></div></div><p>
  One of the primary tasks of a computer center, or any site that supports
  servers, is to provide adequate disk capacity. Fibre Channel is often used
  for this purpose. iSCSI (Internet SCSI) solutions provide a lower-cost
  alternative to Fibre Channel that can leverage commodity servers and Ethernet
  networking equipment. Linux iSCSI provides iSCSI initiator and iSCSI LIO
  target software for connecting Linux servers to central storage systems.
 </p><div class="figure" id="idm140159793461040"><div class="figure-contents"><div class="mediaobject"><a xmlns="" href="images/iscsi_san_a.png"><img src="images/iscsi_san_a.png" width="" alt="iSCSI SAN with an iSNS Server" /></a></div></div><div class="figure-title-wrap"><h6 class="figure-title"><span class="number">Figure 14.1: </span><span class="name">iSCSI SAN with an iSNS Server </span><a title="Permalink" class="permalink" href="cha.iscsi.html#idm140159793461040">#</a></h6></div></div><div id="idm140159793456032" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note: LIO</h6><p>
   LIO (<a class="link" href="http://linux-iscsi.org" target="_blank">http://linux-iscsi.org</a>) is the standard open
   source multiprotocol SCSI target for Linux. LIO replaced the STGT (SCSI
   Target) framework as the standard unified storage target in Linux with Linux
   kernel version 2.6.38 and later. In <span class="productname"><span class="phrase">SUSE Linux Enterprise Server</span></span> 12 the iSCSI LIO Target
   Server replaces the iSCSI Target Server from previous versions.
  </p></div><p>
  iSCSI is a storage networking protocol that simplifies data transfers of SCSI
  packets over TCP/IP networks between block storage devices and servers. iSCSI
  target software runs on the target server and defines the logical units as
  iSCSI target devices. iSCSI initiator software runs on different servers and
  connects to the target devices to make the storage devices available on that
  server.
 </p><p>
  The iSCSI LIO target server and iSCSI initiator servers communicate by
  sending SCSI packets at the IP level in your LAN. When an application running
  on the initiator server starts an inquiry for an iSCSI LIO target device, the
  operating system produces the necessary SCSI commands. The SCSI commands are
  then embedded in IP packets and encrypted as necessary by software that is
  commonly known as the <span class="emphasis"><em>iSCSI initiator</em></span>. The packets are
  transferred across the internal IP network to the corresponding iSCSI remote
  station, called the <span class="emphasis"><em>iSCSI LIO target server</em></span>, or simply
  the <span class="emphasis"><em>iSCSI target</em></span>.
 </p><p>
  Many storage solutions provide access over iSCSI, but it is also possible to
  run a Linux server that provides an iSCSI target. In this case, it is
  important to set up a Linux server that is optimized for file system
  services. The iSCSI target accesses block devices in Linux. Therefore, it is
  possible to use RAID solutions to increase disk space and a lot of memory to
  improve data caching. For more information about RAID, also see
  <a class="xref" href="cha.raid.html" title="Chapter 7. Software RAID Configuration">Chapter 7, <em>Software RAID Configuration</em></a>.
 </p><div class="sect1 " id="sec.iscsi.install"><div class="titlepage"><div><div><h2 class="title" id="sec.iscsi.install"><span class="number">14.1 </span><span class="name">Installing the iSCSI LIO Target Server and iSCSI Initiator</span> <a title="Permalink" class="permalink" href="cha.iscsi.html#sec.iscsi.install">#</a></h2></div></div></div><p>
   While the iSCSI initiator is installed by default (packages
   <code class="systemitem">open-iscsi</code> and
   <code class="systemitem">yast2-iscsi-client</code>), the iSCSI LIO
   target packages need to be installed manually.
  </p><div id="idm140159793444672" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.png" /><h6>Important: Initiator and Target may not Run on the Same Server</h6><p>
    It is not supported to run iSCSI target software and iSCSI initiator
    software on the same server in a production environment.
   </p></div><p>
   To install the iSCSI LIO Target Server, run the following command in a
   terminal console:
  </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> zypper in yast2-iscsi-lio-server</pre></div><p>
   In case you need to install the iSCSI initiator or any of its dependencies,
   run the command <code class="command">sudo zypper in yast2-iscsi-client</code>.
  </p><p>
   Alternatively, use the YaST Software Management module for installation.
  </p><p>
   Any packages required in addition to the ones mentioned above will either be
   automatically pulled in by the installer, or be installed when you first run
   the respective YaST module.
  </p></div><div class="sect1 " id="sec.iscsi.target"><div class="titlepage"><div><div><h2 class="title" id="sec.iscsi.target"><span class="number">14.2 </span><span class="name">Setting Up an iSCSI LIO Target Server</span> <a title="Permalink" class="permalink" href="cha.iscsi.html#sec.iscsi.target">#</a></h2></div></div></div><p>
   This section describes how to use YaST to configure an iSCSI LIO Target
   Server and set up iSCSI LIO target devices. You can use any iSCSI initiator
   software to access the target devices.
  </p><div class="sect2 " id="sec.iscsi.target.start"><div class="titlepage"><div><div><h3 class="title" id="sec.iscsi.target.start"><span class="number">14.2.1 </span><span class="name">iSCSI LIO Target Service Start-up and Firewall Settings</span> <a title="Permalink" class="permalink" href="cha.iscsi.html#sec.iscsi.target.start">#</a></h3></div></div></div><p>
    The iSCSI LIO Target service is by default configured to be started
    manually. You can configure the service to start automatically at boot
    time. If you use a firewall on the server and you want the iSCSI LIO
    targets to be available to other computers, you must open a port in the
    firewall for each adapter that you want to use for target access. TCP port
    3260 is the port number for the iSCSI protocol, as defined by IANA
    (Internet Assigned Numbers Authority).
   </p><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
      Start YaST and launch <span class="guimenu">Network Services</span> › <span class="guimenu">iSCSI LIO Target</span>.
     </p></li><li class="step "><p>
      Switch to the <span class="guimenu">Service</span> tab.
     </p><div class="informalfigure"><div class="mediaobject"><a xmlns="" href="images/lio_service_a.png"><img src="images/lio_service_a.png" width="" /></a></div></div></li><li class="step "><p>
      Under <span class="guimenu">Service Start</span>, specify how you want the iSCSI
      LIO target service to be started:
     </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p><span class="formalpara-title">When Booting: </span>
         The service starts automatically on server restart.
        </p></li><li class="listitem "><p><span class="formalpara-title">Manually: </span>
         (Default) You must start the service manually after a server restart
         by running <code class="command">sudo systemctl start target</code>. The target
         devices are not available until you start the service.
        </p></li></ul></div></li><li class="step "><p>
      If you use a firewall on the server and you want the iSCSI LIO targets to
      be available to other computers, open port 3260 in the firewall for each
      adapter interface that you want to use for target access. If the port is
      closed for all of the network interfaces, the iSCSI LIO targets are not
      available to other computers.
     </p><p>
      If you do not use a firewall on the server, the firewall settings are
      disabled. In this case skip the following steps and leave the
      configuration dialog with <span class="guimenu">Finish</span> or switch to another
      tab to continue with the configuration.
     </p><ol type="a" class="substeps "><li class="step "><p>
        On the <span class="guimenu">Services</span> tab, select the <span class="guimenu">Open Port
        in Firewall</span> check box to enable the firewall settings.
       </p></li><li class="step "><p>
        Click <span class="guimenu">Firewall Details</span> to view or configure the
        network interfaces to use. All available network interfaces are listed,
        and all are selected by default. Deselect all interfaces on which the
        port should <span class="emphasis"><em>not</em></span> be opened. Save your settings with
        <span class="guimenu">OK</span>.
       </p></li></ol></li><li class="step "><p>
      Click <span class="guimenu">Finish</span> to save and apply the iSCSI LIO Target
      service settings.
     </p></li></ol></div></div></div><div class="sect2 " id="sec.iscsi.target.authenticate"><div class="titlepage"><div><div><h3 class="title" id="sec.iscsi.target.authenticate"><span class="number">14.2.2 </span><span class="name">Configuring Authentication for Discovery of iSCSI LIO Targets and Initiators</span> <a title="Permalink" class="permalink" href="cha.iscsi.html#sec.iscsi.target.authenticate">#</a></h3></div></div></div><p>
    The iSCSI LIO Target Server software supports the PPP-CHAP (Point-to-Point
    Protocol Challenge Handshake Authentication Protocol), a three-way
    authentication method defined in the <em class="citetitle ">Internet Engineering Task
    Force (IETF) RFC 1994</em>
    (<a class="link" href="http://www.ietf.org/rfc/rfc1994.txt" target="_blank">http://www.ietf.org/rfc/rfc1994.txt</a>). The server uses
    this authentication method for the discovery of iSCSI LIO targets and
    initiators, not for accessing files on the targets. If you do not want to
    restrict the access to the discovery, use <span class="guimenu">No
    Authentication</span>. The <span class="guimenu">No Discovery Authentication</span> option
    is enabled by default. Without requiring authentication all iSCSI LIO
    targets on this server can be discovered by any iSCSI initiator on the same
    network.
   </p><p>
    If authentication is needed for a more secure configuration, you can use
    incoming authentication, outgoing authentication, or both.
    <span class="guimenu">Authentication by Initiators</span> requires an iSCSI initiator to
    prove that it has the permissions to run a discovery on the iSCSI LIO
    target. The initiator must provide the incoming user name and password.
    <span class="guimenu">Authentication by Targets</span> requires the iSCSI LIO target to
    prove to the initiator that it is the expected target. The iSCSI LIO target
    must provide the outgoing user name and password to the iSCSI initiator.
    The password needs to be different for incoming and outgoing discovery. If
    authentication for discovery is enabled, its settings apply to all iSCSI
    LIO target groups.
   </p><div id="idm140159793405088" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.png" /><h6>Important: Security</h6><p>
     We recommend that you use authentication for target and initiator
     discovery in production environments for security reasons.
    </p></div><p>
    To configure authentication preferences for iSCSI LIO targets:
   </p><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
      Start YaST and launch <span class="guimenu">Network Services</span> › <span class="guimenu">iSCSI LIO Target</span>.
     </p></li><li class="step "><p>
      Switch to the <span class="guimenu">Global</span> tab.
     </p><div class="informalfigure"><div class="mediaobject"><a xmlns="" href="images/lio_global_noauth_a.png"><img src="images/lio_global_noauth_a.png" width="" /></a></div></div></li><li class="step "><p>
      By default, authentication is disabled (<span class="guimenu">No Discovery
      Authentication</span>). To enable Authentication, select
      <span class="guimenu">Authentication by Initiators</span>, <span class="guimenu">Outgoing
      Authentication</span> or both.
     </p></li><li class="step "><p>
      Provide credentials for the selected authentication method(s). The user
      name and password pair must be different for incoming and outgoing
      discovery.
     </p></li><li class="step "><p>
      Click <span class="guimenu">Finish</span> to save and apply the settings.
     </p></li></ol></div></div></div><div class="sect2 " id="sec.iscsi.target.storage"><div class="titlepage"><div><div><h3 class="title" id="sec.iscsi.target.storage"><span class="number">14.2.3 </span><span class="name">Preparing the Storage Space</span> <a title="Permalink" class="permalink" href="cha.iscsi.html#sec.iscsi.target.storage">#</a></h3></div></div></div><p>
    Before you configure LUNs for your iSCSI Target servers, you must prepare
    the storage you want to use. You can use the entire unformatted block
    device as a single LUN, or you can subdivide a device into unformatted
    partitions and use each partition as a separate LUN. The iSCSI target
    configuration exports the LUNs to iSCSI initiators.
   </p><p>
    You can use the Partitioner in YaST or the command line to set up the
    partitions. Refer to <a class="xref" href="cha.advdisk.html#sec.yast.partitioner" title="15.1. Using the YaST Partitioner">Section 15.1, “Using the YaST Partitioner”</a> for
    details. iSCSI LIO targets can use unformatted partitions with Linux, Linux
    LVM, or Linux RAID file system IDs.
   </p><div id="idm140159793386384" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.png" /><h6>Important: Do Not Mount iSCSI Target Devices</h6><p>
     After you set up a device or partition for use as an iSCSI target, you
     never access it directly via its local path. Do not mount the partitions
     on the target server.
    </p></div><div class="sect3 " id="sec.iscsi.target.storage.vm"><div class="titlepage"><div><div><h4 class="title" id="sec.iscsi.target.storage.vm"><span class="number">14.2.3.1 </span><span class="name">Partitioning Devices in a Virtual Environment</span> <a title="Permalink" class="permalink" href="cha.iscsi.html#sec.iscsi.target.storage.vm">#</a></h4></div></div></div><p>
     You can use a virtual machine guest server as an iSCSI LIO Target Server.
     This section describes how to assign partitions to a Xen virtual
     machine. You can also use other virtual environments that are supported by
     <span class="productname"><span class="phrase">SUSE Linux Enterprise Server</span></span>.
    </p><p>
     In a Xen virtual environment, you must assign the storage space you want
     to use for the iSCSI LIO target devices to the guest virtual machine, then
     access the space as virtual disks within the guest environment. Each
     virtual disk can be a physical block device, such as an entire disk,
     partition, or volume, or it can be a file-backed disk image where the
     virtual disk is a single image file on a larger physical disk on the Xen
     host server. For the best performance, create each virtual disk from a
     physical disk or a partition. After you set up the virtual disks for the
     guest virtual machine, start the guest server, then configure the new
     blank virtual disks as iSCSI target devices by following the same process
     as for a physical server.
    </p><p>
     File-backed disk images are created on the Xen host server, then
     assigned to the Xen guest server. By default, Xen stores file-backed
     disk images in the
     <code class="filename">/var/lib/xen/images/<em class="replaceable ">VM_NAME</em></code>
     directory, where <code class="filename"><em class="replaceable ">VM_NAME</em></code>
     is the name of the virtual machine.
    </p></div></div><div class="sect2 " id="sec.iscsi.target.target_group"><div class="titlepage"><div><div><h3 class="title" id="sec.iscsi.target.target_group"><span class="number">14.2.4 </span><span class="name">Setting Up an iSCSI LIO Target Group</span> <a title="Permalink" class="permalink" href="cha.iscsi.html#sec.iscsi.target.target_group">#</a></h3></div></div></div><p>
    You can use YaST to configure iSCSI LIO target devices. YaST uses APIs
    provided by the <code class="command">lio-utils</code> software. iSCSI LIO targets
    can use unformatted partitions with Linux, Linux LVM, or Linux RAID file
    system IDs.
   </p><div id="idm140159793376000" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.png" /><h6>Important: Partitions</h6><p>
     Before you begin, create the unformatted partitions that you want to use
     as iSCSI LIO targets as described in
     <a class="xref" href="cha.iscsi.html#sec.iscsi.target.storage" title="14.2.3. Preparing the Storage Space">Section 14.2.3, “Preparing the Storage Space”</a>.
    </p></div><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
      Start YaST and launch <span class="guimenu">Network Services</span> › <span class="guimenu">iSCSI LIO Target</span>.
     </p></li><li class="step "><p>
      Switch to the <span class="guimenu">Targets</span> tab.
     </p><div class="informalfigure"><div class="mediaobject"><a xmlns="" href="images/lio_targets_a.png"><img src="images/lio_targets_a.png" width="" /></a></div></div></li><li class="step "><p>
      Click <span class="guimenu">Add</span>, then define a new iSCSI LIO target group
      and devices:
     </p><p>
      The iSCSI LIO Target software automatically completes the
      <span class="guimenu">Target</span>, <span class="guimenu">Identifier</span>, <span class="guimenu">Portal
      Group</span>, <span class="guimenu">IP Address</span>, and <span class="guimenu">Port
      Number</span> fields. <span class="guimenu">Use Authentication</span> is
      selected by default.
     </p><ol type="a" class="substeps "><li class="step "><p>
        If you have multiple network interfaces, use the IP address drop-down
        box to select the IP address of the network interface to use for this
        target group. To make the server accessible under all addresses, choose
        <span class="guimenu">Bind All IP Addresses</span>.
       </p></li><li class="step "><p>
        Deselect <span class="guimenu">Use Authentication</span> if you do not want to
        require initiator authentication for this target group (not
        recommended).
       </p></li><li class="step "><p>
        Click <span class="guimenu">Add</span>. Enter the path of the device or partition
        or <span class="guimenu">Browse</span> to add it. Optionally specify a name, then
        click <span class="guimenu">OK</span>. The LUN number is automatically generated,
        beginning with 0. A name is automatically generated if you leave the
        field empty.
       </p></li><li class="step "><p>
        (Optional) Repeat the previous steps to add more targets to this target
        group.
       </p></li><li class="step "><p>
        After all desired targets have been added to the group, click
        <span class="guimenu">Next</span>.
       </p></li></ol></li><li class="step "><p>
      On the <span class="guimenu">Modify iSCSI Target Initiator Setup</span> page,
      configure information for the initiators that are permitted to access
      LUNs in the target group:
     </p><div class="informalfigure"><div class="mediaobject"><a xmlns="" href="images/lio_target_client_a.png"><img src="images/lio_target_client_a.png" width="" /></a></div></div><p>
      After you specify at least one initiator for the target group, the
      <span class="guimenu">Edit LUN</span>, <span class="guimenu">Edit Auth</span>,
      <span class="guimenu">Delete</span>, and <span class="guimenu">Copy</span> buttons are
      enabled. You can use <span class="guimenu">Add</span> or <span class="guimenu">Copy</span> to
      add more initiators for the target group:
     </p><div class="itemizedlist " id="il.iscsi.target.target_group.options"><div class="itemizedlist-title-wrap"><h6 class="itemizedlist-title"><span class="name">Modify iSCSI Target: Options </span><a title="Permalink" class="permalink" href="cha.iscsi.html#il.iscsi.target.target_group.options">#</a></h6></div><ul class="itemizedlist"><li class="listitem "><p><span class="formalpara-title">Add: </span>
         Add a new initiator entry for the selected iSCSI LIO target group.
        </p></li><li class="listitem "><p><span class="formalpara-title">Edit LUN: </span>
         Configure which LUNs in the iSCSI LIO target group to map to a
         selected initiator. You can map each of the allocated targets to a
         preferred initiator.
        </p></li><li class="listitem "><p><span class="formalpara-title">Edit Auth: </span>
         Configure the preferred authentication method for a selected
         initiator. You can specify no authentication, or you can configure
         incoming authentication, outgoing authentication, or both.
        </p></li><li class="listitem "><p><span class="formalpara-title">Delete: </span>
         Remove a selected initiator entry from the list of initiators
         allocated to the target group.
        </p></li><li class="listitem "><p><span class="formalpara-title">Copy: </span>
         Add a new initiator entry with the same LUN mappings and
         authentication settings as a selected initiator entry. This allows you
         to easily allocate the same shared LUNs, in turn, to each node in a
         cluster.
        </p></li></ul></div><ol type="a" class="substeps "><li class="step "><p>
        Click <span class="guimenu">Add</span>, specify the initiator name, select or
        deselect the <span class="guimenu">Import LUNs from TPG</span> check box, then
        click <span class="guimenu">OK</span> to save the settings.
       </p></li><li class="step "><p>
        Select an initiator entry, click <span class="guimenu">Edit LUN</span>, modify
        the LUN mappings to specify which LUNs in the iSCSI LIO target group to
        allocate to the selected initiator, then click <span class="guimenu">OK</span> to
        save the changes.
       </p><p>
        If the iSCSI LIO target group consists of multiple LUNs, you can
        allocate one or multiple LUNs to the selected initiator. By default,
        each of the available LUNs in the group are assigned to an initiator
        LUN.
       </p><p>
        To modify the LUN allocation, perform one or more of the following
        actions:
       </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p><span class="formalpara-title">Add: </span>
           Click <span class="guimenu">Add</span> to create a new <span class="guimenu">Initiator
           LUN</span> entry, then use the <span class="guimenu">Change</span>
           drop-down box to map a target LUN to it.
          </p></li><li class="listitem "><p><span class="formalpara-title">Delete: </span>
           Select the <span class="guimenu">Initiator LUN</span> entry, then click
           <span class="guimenu">Delete</span> to remove a target LUN mapping.
          </p></li><li class="listitem "><p><span class="formalpara-title">Change: </span>
           Select the <span class="guimenu">Initiator LUN</span> entry, then use the
           <span class="guimenu">Change</span> drop-down box to select which Target LUN
           to map to it.
          </p></li></ul></div><p>
        Typical allocation plans include the following:
       </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
          A single server is listed as an initiator. All of the LUNs in the
          target group are allocated to it.
         </p><p>
          You can use this grouping strategy to logically group the iSCSI SAN
          storage for a given server.
         </p></li><li class="listitem "><p>
          Multiple independent servers are listed as initiators. One or
          multiple target LUNs are allocated to each server. Each LUN is
          allocated to only one server.
         </p><p>
          You can use this grouping strategy to logically group the iSCSI SAN
          storage for a given department or service category in the data
          center.
         </p></li><li class="listitem "><p>
          Each node of a cluster is listed as an initiator. All of the shared
          target LUNs are allocated to each node. All nodes are attached to the
          devices, but for most file systems, the cluster software locks a
          device for access and mounts it on only one node at a time. Shared
          file systems (such as OCFS2) make it possible for multiple nodes to
          concurrently mount the same file structure and to open the same files
          with read and write access.
         </p><p>
          You can use this grouping strategy to logically group the iSCSI SAN
          storage for a given server cluster.
         </p></li></ul></div></li><li class="step "><p>
        Select an initiator entry, click <span class="guimenu">Edit Auth</span>, specify
        the authentication settings for the initiator, then click
        <span class="guimenu">OK</span> to save the settings.
       </p><p>
        You can require <span class="guimenu">No Discovery Authentication</span>, or you can
        configure <span class="guimenu">Authentication by Initiators</span>, <span class="guimenu">Outgoing
        Authentication</span>, or both. You can specify only one user name
        and password pair for each initiator. The credentials can be different
        for incoming and outgoing authentication for an initiator. The
        credentials can be different for each initiator.
       </p></li><li class="step "><p>
        Repeat the previous steps for each iSCSI initiator that can access this
        target group.
       </p></li><li class="step "><p>
        After the initiator assignments are configured, click
        <span class="guimenu">Next</span>.
       </p></li></ol></li><li class="step "><p>
      Click <span class="guimenu">Finish</span> to save and apply the settings.
     </p></li></ol></div></div></div><div class="sect2 " id="sec.iscsi.target.tg_modify"><div class="titlepage"><div><div><h3 class="title" id="sec.iscsi.target.tg_modify"><span class="number">14.2.5 </span><span class="name">Modifying an iSCSI LIO Target Group</span> <a title="Permalink" class="permalink" href="cha.iscsi.html#sec.iscsi.target.tg_modify">#</a></h3></div></div></div><p>
    You can modify an existing iSCSI LIO target group as follows:
   </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
      Add or remove target LUN devices from a target group
     </p></li><li class="listitem "><p>
      Add or remove initiators for a target group
     </p></li><li class="listitem "><p>
      Modify the initiator LUN-to-target LUN mappings for an initiator of a
      target group
     </p></li><li class="listitem "><p>
      Modify the user name and password credentials for an initiator
      authentication (incoming, outgoing, or both)
     </p></li></ul></div><p>
    To view or modify the settings for an iSCSI LIO target group:
   </p><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
      Start YaST and launch <span class="guimenu">Network Services</span> › <span class="guimenu">iSCSI LIO Target</span>.
     </p></li><li class="step "><p>
      Switch to the <span class="guimenu">Targets</span> tab.
     </p></li><li class="step "><p>
      Select the iSCSI LIO target group to be modified, then click
      <span class="guimenu">Edit</span>.
     </p></li><li class="step "><p>
      On the Modify iSCSI Target LUN Setup page, add LUNs to the target group,
      edit the LUN assignments, or remove target LUNs from the group. After all
      desired changes have been made to the group, click
      <span class="guimenu">Next</span>.
     </p><p>
      For option information, see
      <a class="xref" href="cha.iscsi.html#il.iscsi.target.target_group.options" title="Modify iSCSI Target: Options">Modify iSCSI Target: Options</a>.
     </p></li><li class="step "><p>
      On the Modify iSCSI Target Initiator Setup page, configure information
      for the initiators that are permitted to access LUNs in the target group.
      After all desired changes have been made to the group, click
      <span class="guimenu">Next</span>.
     </p></li><li class="step "><p>
      Click <span class="guimenu">Finish</span> to save and apply the settings.
     </p></li></ol></div></div></div><div class="sect2 " id="sec.iscsi.target.tg_delete"><div class="titlepage"><div><div><h3 class="title" id="sec.iscsi.target.tg_delete"><span class="number">14.2.6 </span><span class="name">Deleting an iSCSI LIO Target Group</span> <a title="Permalink" class="permalink" href="cha.iscsi.html#sec.iscsi.target.tg_delete">#</a></h3></div></div></div><p>
    Deleting an iSCSI LIO target group removes the definition of the group, and
    the related setup for initiators, including LUN mappings and authentication
    credentials. It does not destroy the data on the partitions. To give
    initiators access again, you can allocate the target LUNs to a different or
    new target group, and configure the initiator access for them.
   </p><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
      Start YaST and launch <span class="guimenu">Network Services</span> › <span class="guimenu">iSCSI LIO Target</span>.
     </p></li><li class="step "><p>
      Switch to the <span class="guimenu">Targets</span> tab.
     </p></li><li class="step "><p>
      Select the iSCSI LIO target group to be deleted, then click
      <span class="guimenu">Delete</span>.
     </p></li><li class="step "><p>
      When you are prompted, click <span class="guimenu">Continue</span> to confirm the
      deletion, or click <span class="guimenu">Cancel</span> to cancel it.
     </p></li><li class="step "><p>
      Click <span class="guimenu">Finish</span> to save and apply the settings.
     </p></li></ol></div></div></div></div><div class="sect1 " id="sec.iscsi.initiator"><div class="titlepage"><div><div><h2 class="title" id="sec.iscsi.initiator"><span class="number">14.3 </span><span class="name">Configuring iSCSI Initiator</span> <a title="Permalink" class="permalink" href="cha.iscsi.html#sec.iscsi.initiator">#</a></h2></div></div></div><p>
   The iSCSI initiator can be used to connect to any iSCSI target. This is not
   restricted to the iSCSI target solution explained in
   <a class="xref" href="cha.iscsi.html#sec.iscsi.target" title="14.2. Setting Up an iSCSI LIO Target Server">Section 14.2, “Setting Up an iSCSI LIO Target Server”</a>. The
   configuration of iSCSI initiator involves two major steps: the discovery of
   available iSCSI targets and the setup of an iSCSI session. Both can be done
   with YaST.
  </p><div class="sect2 " id="sec.iscsi.initiator.yast"><div class="titlepage"><div><div><h3 class="title" id="sec.iscsi.initiator.yast"><span class="number">14.3.1 </span><span class="name">Using YaST for the iSCSI Initiator Configuration</span> <a title="Permalink" class="permalink" href="cha.iscsi.html#sec.iscsi.initiator.yast">#</a></h3></div></div></div><p>
    The iSCSI Initiator Overview in YaST is divided into three tabs:
   </p><div class="variablelist "><dl class="variablelist"><dt id="idm140159793266384"><span class="term ">Service:</span></dt><dd><p>
       The <span class="guimenu">Service</span> tab can be used to enable the iSCSI
       initiator at boot time. It also offers to set a unique
       <span class="guimenu">Initiator Name</span> and an iSNS server to use for the
       discovery.
      </p></dd><dt id="idm140159793263552"><span class="term ">Connected Targets:</span></dt><dd><p>
       The <span class="guimenu">Connected Targets</span> tab gives an overview of the
       currently connected iSCSI targets. Like the <span class="guimenu">Discovered
       Targets</span> tab, it also gives the option to add new targets to
       the system.
      </p></dd><dt id="idm140159793260768"><span class="term ">Discovered Targets:</span></dt><dd><p>
       The <span class="guimenu">Discovered Targets</span> tab provides the possibility
       of manually discovering iSCSI targets in the network.
      </p></dd></dl></div><div class="sect3 " id="sec.iscsi.initiator.yast.configuration"><div class="titlepage"><div><div><h4 class="title" id="sec.iscsi.initiator.yast.configuration"><span class="number">14.3.1.1 </span><span class="name">Configuring the iSCSI Initiator</span> <a title="Permalink" class="permalink" href="cha.iscsi.html#sec.iscsi.initiator.yast.configuration">#</a></h4></div></div></div><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
       Start YaST and launch <span class="guimenu">Network Services</span> › <span class="guimenu">iSCSI Initiator</span>.
      </p></li><li class="step "><p>
       Switch to the <span class="guimenu">Services</span> tab.
      </p><div class="informalfigure"><div class="mediaobject"><a xmlns="" href="images/iscsi_init_service_a.png"><img src="images/iscsi_init_service_a.png" width="" /></a></div></div></li><li class="step "><p>
       Under <span class="guimenu">Service Start</span>, specify how you want the iSCSI
       initiator service to be started:
      </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p><span class="formalpara-title">When Booting: </span>
          The service starts automatically on server restart.
         </p></li><li class="listitem "><p><span class="formalpara-title">Manually: </span>
          (Default) You must start the service manually after a server restart
          by running <code class="command">sudo systemctl start iscsi iscsid</code>.
         </p></li></ul></div></li><li class="step "><p>
       Specify or verify the <span class="guimenu">Initiator Name</span>.
      </p><p>
       Specify a well-formed iSCSI qualified name (IQN) for the iSCSI initiator
       on this server. The initiator name must be globally unique on your
       network. The IQN uses the following general format:
      </p><div class="verbatim-wrap"><pre class="screen">iqn.yyyy-mm.com.mycompany:n1:n2</pre></div><p>
       where n1 and n2 are alphanumeric characters. For example:
      </p><div class="verbatim-wrap"><pre class="screen">iqn.1996-04.de.suse:01:a5dfcea717a</pre></div><p>
       The <span class="guimenu">Initiator Name</span> is automatically completed with
       the corresponding value from the
       <code class="filename">/etc/iscsi/initiatorname.iscsi</code> file on the server.
      </p><p>
       If the server has iBFT (iSCSI Boot Firmware Table) support, the
       <span class="guimenu">Initiator Name</span> is completed with the corresponding
       value in the IBFT, and you are not able to change the initiator name in
       this interface. Use the BIOS Setup to modify it instead. The iBFT is a
       block of information containing various parameters useful to the iSCSI
       boot process, including iSCSI target and initiator descriptions for the
       server.
      </p></li><li class="step "><p>
       Use either of the following methods to discover iSCSI targets on the
       network.
      </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p><span class="formalpara-title">iSNS: </span>
          To use iSNS (Internet Storage Name Service) for discovering iSCSI
          targets, continue with
          <a class="xref" href="cha.iscsi.html#sec.iscsi.initiator.yast.isn" title="14.3.1.2. Discovering iSCSI Targets by Using iSNS">Section 14.3.1.2, “Discovering iSCSI Targets by Using iSNS”</a>.
         </p></li><li class="listitem "><p><span class="formalpara-title">Discovered Targets: </span>
          To discover iSCSI target devices manually, continue with
          <a class="xref" href="cha.iscsi.html#sec.iscsi.initiator.yast.discovered" title="14.3.1.3. Discovering iSCSI Targets Manually">Section 14.3.1.3, “Discovering iSCSI Targets Manually”</a>.
         </p></li></ul></div></li></ol></div></div></div><div class="sect3 " id="sec.iscsi.initiator.yast.isn"><div class="titlepage"><div><div><h4 class="title" id="sec.iscsi.initiator.yast.isn"><span class="number">14.3.1.2 </span><span class="name">Discovering iSCSI Targets by Using iSNS</span> <a title="Permalink" class="permalink" href="cha.iscsi.html#sec.iscsi.initiator.yast.isn">#</a></h4></div></div></div><p>
     Before you can use this option, you must have already installed and
     configured an iSNS server in your environment. For information, see
     <a class="xref" href="cha.isns.html" title="Chapter 13. iSNS for Linux">Chapter 13, <em>iSNS for Linux</em></a>.
    </p><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
       In YaST, select<span class="guimenu"> iSCSI Initiator</span>, then select the
       <span class="guimenu">Service</span> tab.
      </p></li><li class="step "><p>
       Specify the IP address of the iSNS server and port. The default port is
       3205.
      </p></li><li class="step "><p>
       Click <span class="guimenu">OK</span> to save and apply your changes.
      </p></li></ol></div></div></div><div class="sect3 " id="sec.iscsi.initiator.yast.discovered"><div class="titlepage"><div><div><h4 class="title" id="sec.iscsi.initiator.yast.discovered"><span class="number">14.3.1.3 </span><span class="name">Discovering iSCSI Targets Manually</span> <a title="Permalink" class="permalink" href="cha.iscsi.html#sec.iscsi.initiator.yast.discovered">#</a></h4></div></div></div><p>
     Repeat the following process for each of the iSCSI target servers that you
     want to access from the server where you are setting up the iSCSI
     initiator.
    </p><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
       In YaST, select <span class="guimenu">iSCSI Initiator</span>, then select the
       <span class="guimenu">Discovered Targets</span> tab.
      </p></li><li class="step "><p>
       Click <span class="guimenu">Discovery</span> to open the iSCSI Initiator Discovery
       dialog.
      </p></li><li class="step "><p>
       Enter the IP address and change the port if needed. The default port is
       3260.
      </p></li><li class="step "><p>
       If authentication is required, deselect <span class="guimenu">No Discovery
       Authentication</span>, then specify the credentials for
       <span class="guimenu">Authentication by Initiator</span> or
       <span class="guimenu">Authentication by Targets</span>.
      </p></li><li class="step "><p>
       Click <span class="guimenu">Next</span> to start the discovery and connect to the
       iSCSI target server.
      </p></li><li class="step "><p>
       If credentials are required, after a successful discovery, use
       <span class="guimenu">Connect</span> to activate the target.
      </p><p>
       You are prompted for authentication credentials to use the selected
       iSCSI target.
      </p></li><li class="step "><p>
       Click <span class="guimenu">Next</span> to finish the configuration.
      </p><p>
       The target now appears in <span class="guimenu">Connected Targets</span> and the
       virtual iSCSI device is now available.
      </p></li><li class="step "><p>
       Click <span class="guimenu">OK</span> to save and apply your changes.
      </p></li><li class="step "><p>
       You can find the local device path for the iSCSI target device by using
       the <code class="command">lsscsi</code> command.
      </p></li></ol></div></div></div><div class="sect3 " id="sec.iscsi.initiator.yast.startup"><div class="titlepage"><div><div><h4 class="title" id="sec.iscsi.initiator.yast.startup"><span class="number">14.3.1.4 </span><span class="name">Setting the Start-up Preference for iSCSI Target Devices</span> <a title="Permalink" class="permalink" href="cha.iscsi.html#sec.iscsi.initiator.yast.startup">#</a></h4></div></div></div><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
       In YaST, select<span class="guimenu"> iSCSI Initiator</span>, then select the
       <span class="guimenu">Connected Targets</span> tab to view a list of the iSCSI
       target devices that are currently connected to the server.
      </p></li><li class="step "><p>
       Select the iSCSI target device that you want to manage.
      </p></li><li class="step "><p>
       Click <span class="guimenu">Toggle Start-Up</span> to modify the setting:
      </p><p><span class="formalpara-title">Automatic: </span>
        This option is used for iSCSI targets that are to be connected when the
        iSCSI service itself starts up. This is the typical configuration.
       </p><p><span class="formalpara-title">Onboot: </span>
        This option is used for iSCSI targets that are to be connected during
        boot; that is, when root (<code class="filename">/</code>) is on iSCSI. As such,
        the iSCSI target device will be evaluated from the initrd on server
        boots. This option is ignored on platforms that cannot boot from
        iSCSI, such as IBM z Systems. Therefore it should not be used on these
        platforms; use <span class="guimenu">Automatic</span> instead.
       </p></li><li class="step "><p>
       Click <span class="guimenu">OK</span> to save and apply your changes.
      </p></li></ol></div></div></div></div><div class="sect2 " id="sec.iscsi.initiator.manually"><div class="titlepage"><div><div><h3 class="title" id="sec.iscsi.initiator.manually"><span class="number">14.3.2 </span><span class="name">Setting Up the iSCSI Initiator Manually</span> <a title="Permalink" class="permalink" href="cha.iscsi.html#sec.iscsi.initiator.manually">#</a></h3></div></div></div><p>
    Both the discovery and the configuration of iSCSI connections require a
    running iscsid. When running the discovery the first time, the internal
    database of the iSCSI initiator is created in the directory
    <code class="filename">/etc/iscsi/</code>.
   </p><p>
    If your discovery is password protected, provide the authentication
    information to iscsid. Because the internal database does not exist when
    doing the first discovery, it cannot be used now. Instead, the
    configuration file <code class="filename">/etc/iscsid.conf</code> must be edited to
    provide the information. To add your password information for the
    discovery, add the following lines to the end of
    <code class="filename">/etc/iscsid.conf</code>:
   </p><div class="verbatim-wrap"><pre class="screen">discovery.sendtargets.auth.authmethod = CHAP
discovery.sendtargets.auth.username = <em class="replaceable ">USERNAME</em>
discovery.sendtargets.auth.password = <em class="replaceable ">PASSWORD</em></pre></div><p>
    The discovery stores all received values in an internal persistent
    database. In addition, it displays all detected targets. Run this discovery
    with the following command:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> iscsiadm <code class="option">-m discovery --type=st --portal=<em class="replaceable ">TARGET_IP</em></code></pre></div><p>
    The output should look like the following:
   </p><div class="verbatim-wrap"><pre class="screen">10.44.171.99:3260,1 iqn.2006-02.com.example.iserv:systems</pre></div><p>
    To discover the available targets on an <code class="literal">iSNS</code> server, use
    the following command:
   </p><div class="verbatim-wrap"><pre class="screen">sudo iscsiadm --mode discovery --type isns --portal <em class="replaceable ">TARGET_IP</em></pre></div><p>
    For each target defined on the iSCSI target, one line appears. For more
    information about the stored data, see
    <a class="xref" href="cha.iscsi.html#sec.iscsi.initiator.database" title="14.3.3. The iSCSI Initiator Databases">Section 14.3.3, “The iSCSI Initiator Databases”</a>.
   </p><p>
    The special <code class="option">--login</code> option of <code class="command">iscsiadm</code>
    creates all needed devices:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> iscsiadm -m node -n iqn.2006-02.com.example.iserv:systems --login</pre></div><p>
    The newly generated devices show up in the output of
    <code class="command">lsscsi</code> and can now be mounted.
   </p></div><div class="sect2 " id="sec.iscsi.initiator.database"><div class="titlepage"><div><div><h3 class="title" id="sec.iscsi.initiator.database"><span class="number">14.3.3 </span><span class="name">The iSCSI Initiator Databases</span> <a title="Permalink" class="permalink" href="cha.iscsi.html#sec.iscsi.initiator.database">#</a></h3></div></div></div><p>
    All information that was discovered by the iSCSI initiator is stored in two
    database files that reside in <code class="filename">/etc/iscsi</code>. There is one
    database for the discovery of targets and one for the discovered nodes.
    When accessing a database, you first must select if you want to get your
    data from the discovery or from the node database. Do this with the
    <code class="option">-m discovery</code> and <code class="option">-m node</code> parameters of
    <code class="command">iscsiadm</code>. Using <code class="command">iscsiadm</code> with one of
    these parameters gives an overview of the stored records:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> iscsiadm -m discovery
10.44.171.99:3260,1 iqn.2006-02.com.example.iserv:systems</pre></div><p>
    The target name in this example is
    <code class="literal">iqn.2006-02.com.example.iserv:systems</code>. This name is
    needed for all actions that relate to this special data set. To examine the
    content of the data record with the ID
    <code class="literal">iqn.2006-02.com.example.iserv:systems</code>, use the following
    command:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> iscsiadm -m node --targetname iqn.2006-02.com.example.iserv:systems
node.name = iqn.2006-02.com.example.iserv:systems
node.transport_name = tcp
node.tpgt = 1
node.active_conn = 1
node.startup = manual
node.session.initial_cmdsn = 0
node.session.reopen_max = 32
node.session.auth.authmethod = CHAP
node.session.auth.username = joe
node.session.auth.password = ********
node.session.auth.username_in = <em class="replaceable ">EMPTY</em>
node.session.auth.password_in = <em class="replaceable ">EMPTY</em>
node.session.timeo.replacement_timeout = 0
node.session.err_timeo.abort_timeout = 10
node.session.err_timeo.reset_timeout = 30
node.session.iscsi.InitialR2T = No
node.session.iscsi.ImmediateData = Yes
....</pre></div><p>
    To edit the value of one of these variables, use the command
    <code class="command">iscsiadm</code> with the <code class="option">update</code> operation. For
    example, if you want iscsid to log in to the iSCSI target when it
    initializes, set the variable <code class="option">node.startup</code> to the value
    <code class="option">automatic</code>:
   </p><div class="verbatim-wrap"><pre class="screen">sudo iscsiadm -m node -n iqn.2006-02.com.example.iserv:systems \
-p ip:port --op=update --name=node.startup --value=automatic</pre></div><p>
    Remove obsolete data sets with the <code class="literal">delete</code> operation. If
    the target <code class="literal">iqn.2006-02.com.example.iserv:systems</code> is no
    longer a valid record, delete this record with the following command:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> iscsiadm -m node -n iqn.2006-02.com.example.iserv:systems \
-p ip:port --op=delete</pre></div><div id="idm140159793161328" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.png" /><h6>Important: No Confirmation</h6><p>
     Use this option with caution because it deletes the record without any
     additional confirmation prompt.
    </p></div><p>
    To get a list of all discovered targets, run the <code class="command">sudo iscsiadm -m
    node</code> command.
   </p></div></div><div class="sect1 " id="sec.iscsi.installation"><div class="titlepage"><div><div><h2 class="title" id="sec.iscsi.installation"><span class="number">14.4 </span><span class="name">Using iSCSI Disks when Installing</span> <a title="Permalink" class="permalink" href="cha.iscsi.html#sec.iscsi.installation">#</a></h2></div></div></div><p>
   Booting from an iSCSI disk on AMD64/Intel 64 and IBM POWER architectures
   is supported when iSCSI-enabled firmware is used.
  </p><p>
   To use iSCSI disks during installation, it is necessary to add the following
   parameter to the boot option line:
  </p><div class="verbatim-wrap"><pre class="screen">withiscsi=1</pre></div><p>
   During installation, an additional screen appears that provides the option
   to attach iSCSI disks to the system and use them in the installation
   process.
  </p><div id="idm140159793155344" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note: Mount Point Support</h6><p>iSCSI devices will appear asynchronously during the
    boot process. While the initrd guarantees that those devices are
    set up correctly for the root file system, there are no such
    guarantees for any other file systems or mount points like
    <code class="filename">/usr</code>. Hence any system mount points like
    <code class="filename">/usr</code> or <code class="filename">/var</code> are not
    supported. To use those devices, ensure correct
    synchronization of the respective services and devices.</p></div></div><div class="sect1 " id="sec.iscsi.trouble"><div class="titlepage"><div><div><h2 class="title" id="sec.iscsi.trouble"><span class="number">14.5 </span><span class="name">Troubleshooting iSCSI</span> <a title="Permalink" class="permalink" href="cha.iscsi.html#sec.iscsi.trouble">#</a></h2></div></div></div><p>
   This section describes some known issues and possible solutions for iSCSI
   target and iSCSI initiator issues.
  </p><div class="sect2 " id="sec.iscsi.trouble.no_service"><div class="titlepage"><div><div><h3 class="title" id="sec.iscsi.trouble.no_service"><span class="number">14.5.1 </span><span class="name">Portal Error When Setting Up Target LUNs on an iSCSI LIO Target Server</span> <a title="Permalink" class="permalink" href="cha.iscsi.html#sec.iscsi.trouble.no_service">#</a></h3></div></div></div><p>
    When adding or editing an iSCSI LIO target group, you get an error:
   </p><div class="verbatim-wrap"><pre class="screen">Problem setting network portal <em class="replaceable ">IP_ADDRESS</em>:3260</pre></div><p>
    The <code class="filename">/var/log/YasT2/y2log</code> log file contains the
    following error:
   </p><div class="verbatim-wrap"><pre class="screen">find: `/sys/kernel/config/target/iscsi': No such file or directory</pre></div><p>
    This problem occurs if the iSCSI LIO Target Server software is not
    currently running. To resolve this issue, exit YaST, manually start iSCSI
    LIO at the command line with <code class="command">systemctl start target</code>,
    then try again.
   </p><p>
    You can also enter the following to check if <code class="command">configfs</code>,
    <code class="command">iscsi_target_mod</code>, and <code class="command">target_core_mod</code>
    are loaded. A sample response is shown.
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> lsmod | grep iscsi
iscsi_target_mod      295015  0
target_core_mod       346745  4
iscsi_target_mod,target_core_pscsi,target_core_iblock,target_core_file
configfs               35817  3 iscsi_target_mod,target_core_mod
scsi_mod              231620  16
iscsi_target_mod,target_core_pscsi,target_core_mod,sg,sr_mod,mptctl,sd_mod,
scsi_dh_rdac,scsi_dh_emc,scsi_dh_alua,scsi_dh_hp_sw,scsi_dh,libata,mptspi,
mptscsih,scsi_transport_spi</pre></div></div><div class="sect2 " id="sec.iscsi.trouble.not_visible"><div class="titlepage"><div><div><h3 class="title" id="sec.iscsi.trouble.not_visible"><span class="number">14.5.2 </span><span class="name">iSCSI LIO Targets Are Not Visible from Other Computers</span> <a title="Permalink" class="permalink" href="cha.iscsi.html#sec.iscsi.trouble.not_visible">#</a></h3></div></div></div><p>
    If you use a firewall on the target server, you must open the iSCSI port
    that you are using to allow other computers to see the iSCSI LIO targets.
    For information, see <a class="xref" href="cha.iscsi.html#sec.iscsi.target.start" title="14.2.1. iSCSI LIO Target Service Start-up and Firewall Settings">Section 14.2.1, “iSCSI LIO Target Service Start-up and Firewall Settings”</a>.
   </p></div><div class="sect2 " id="sec.iscsi.trouble.package_loss"><div class="titlepage"><div><div><h3 class="title" id="sec.iscsi.trouble.package_loss"><span class="number">14.5.3 </span><span class="name">Data Packets Dropped for iSCSI Traffic</span> <a title="Permalink" class="permalink" href="cha.iscsi.html#sec.iscsi.trouble.package_loss">#</a></h3></div></div></div><p>
    A firewall might drop packets if it gets too busy. The default for the SUSE
    Firewall is to drop packets after three minutes. If you find that iSCSI
    traffic packets are being dropped, you can consider configuring the SUSE
    Firewall to queue packets instead of dropping them when it gets too busy.
   </p></div><div class="sect2 " id="sec.iscsi.trouble.lvm"><div class="titlepage"><div><div><h3 class="title" id="sec.iscsi.trouble.lvm"><span class="number">14.5.4 </span><span class="name">Using iSCSI Volumes with LVM</span> <a title="Permalink" class="permalink" href="cha.iscsi.html#sec.iscsi.trouble.lvm">#</a></h3></div></div></div><p>
    Use the troubleshooting tips in this section when using LVM on iSCSI
    targets.
   </p><div class="sect3 " id="sec.iscsi.trouble.lvm.boot_initiator"><div class="titlepage"><div><div><h4 class="title" id="sec.iscsi.trouble.lvm.boot_initiator"><span class="number">14.5.4.1 </span><span class="name">Check if the iSCSI Initiator Discovery Occurs at Boot</span> <a title="Permalink" class="permalink" href="cha.iscsi.html#sec.iscsi.trouble.lvm.boot_initiator">#</a></h4></div></div></div><p>
     When you set up the iSCSI Initiator, ensure that you enable discovery at
     boot time so that udev can discover the iSCSI devices at boot time and set
     up the devices to be used by LVM.
    </p></div><div class="sect3 " id="sec.iscsi.trouble.lvm.boot_target"><div class="titlepage"><div><div><h4 class="title" id="sec.iscsi.trouble.lvm.boot_target"><span class="number">14.5.4.2 </span><span class="name">Check that iSCSI Target Discovery Occurs at Boot</span> <a title="Permalink" class="permalink" href="cha.iscsi.html#sec.iscsi.trouble.lvm.boot_target">#</a></h4></div></div></div><p>
     Remember that <code class="filename">udev</code> provides the default setup for
     devices. Ensure that all of the applications that create devices are
     started at boot time so that <code class="command">udev</code> can recognize and
     assign devices for them at system start-up. If the application or service
     is not started until later, <code class="command">udev</code> does not create the
     device automatically as it would at boot time.
    </p></div></div><div class="sect2 " id="sec.iscsi.trouble.mount"><div class="titlepage"><div><div><h3 class="title" id="sec.iscsi.trouble.mount"><span class="number">14.5.5 </span><span class="name">iSCSI Targets Are Mounted When the Configuration File Is Set to Manual</span> <a title="Permalink" class="permalink" href="cha.iscsi.html#sec.iscsi.trouble.mount">#</a></h3></div></div></div><p>
    When Open-iSCSI starts, it can mount the targets even if the
    <code class="literal">node.startup</code> option is set to manual in the
    <code class="filename">/etc/iscsi/iscsid.conf</code> file if you manually modified
    the configuration file.
   </p><p>
    Check the
    <code class="filename">/etc/iscsi/nodes/<em class="replaceable ">TARGET_NAME</em>/<em class="replaceable ">IP_ADDRESS</em>,<em class="replaceable ">PORT</em>/default</code>
    file. It contains a <code class="literal">node.startup</code> setting that overrides
    the <code class="filename">/etc/iscsi/iscsid.conf</code> file. Setting the mount
    option to manual by using the YaST interface also sets
    <code class="literal">node.startup = manual</code> in the
    <code class="filename">/etc/iscsi/nodes/<em class="replaceable ">TARGET_NAME</em>/<em class="replaceable ">IP_ADDRESS</em>,<em class="replaceable ">PORT</em>/default
    </code>files.
   </p></div></div><div class="sect1 " id="sec.iscsi.terminology"><div class="titlepage"><div><div><h2 class="title" id="sec.iscsi.terminology"><span class="number">14.6 </span><span class="name">iSCSI LIO Target Terminology</span> <a title="Permalink" class="permalink" href="cha.iscsi.html#sec.iscsi.terminology">#</a></h2></div></div></div><div class="variablelist "><dl class="variablelist"><dt id="idm140159793119936"><span class="term ">backstore</span></dt><dd><p>
      A physical storage object that provides the actual storage underlying an
      iSCSI endpoint.
     </p></dd><dt id="idm140159793118048"><span class="term ">CDB (command descriptor block)</span></dt><dd><p>
      The standard format for SCSI commands. CDBs are commonly 6, 10, or 12
      bytes long, though they can be 16 bytes or of variable length.
     </p></dd><dt id="idm140159793116112"><span class="term ">CHAP (Challenge Handshake Authentication Protocol)</span></dt><dd><p>
      A point-to-point protocol (PPP) authentication method used to confirm the
      identity of one computer to another. After the Link Control Protocol
      (LCP) connects the two computers, and the CHAP method is negotiated, the
      authenticator sends a random Challenge to the peer. The peer issues a
      cryptographically hashed Response that depends upon the Challenge and a
      secret key. The authenticator verifies the hashed Response against its
      own calculation of the expected hash value, and either acknowledges the
      authentication or terminates the connection. CHAP is defined in the RFC
      1994.
     </p></dd><dt id="idm140159793113664"><span class="term ">CID (connection identifier)</span></dt><dd><p>
      A 16‐bit number, generated by the initiator, that uniquely identifies a
      connection between two iSCSI devices. This number is presented during the
      login phase.
     </p></dd><dt id="idm140159793111680"><span class="term ">endpoint</span></dt><dd><p>
      The combination of an iSCSI Target Name with an iSCSI TPG (IQN + Tag).
     </p></dd><dt id="idm140159793109824"><span class="term ">EUI (extended unique identifier)</span></dt><dd><p>
      A 64‐bit number that uniquely identifies every device in the world. The
      format consists of 24 bits that are unique to a given company, and 40
      bits assigned by the company to each device it builds.
     </p></dd><dt id="idm140159793107808"><span class="term ">initiator</span></dt><dd><p>
      The originating end of an SCSI session. Typically a controlling device
      such as a computer.
     </p></dd><dt id="idm140159793105920"><span class="term ">IPS (Internet Protocol storage)</span></dt><dd><p>
      The class of protocols or devices that use the IP protocol to move data
      in a storage network. FCIP (Fibre Channel over Internet Protocol), iFCP
      (Internet Fibre Channel Protocol), and iSCSI (Internet SCSI) are all
      examples of IPS protocols.
     </p></dd><dt id="idm140159793103856"><span class="term ">IQN (iSCSI qualified name)</span></dt><dd><p>
      A name format for iSCSI that uniquely identifies every device in the
      world (for example:
      <code class="filename">iqn.5886.com.acme.tapedrive.sn‐a12345678</code>).
     </p></dd><dt id="idm140159793101472"><span class="term ">ISID (initiator session identifier)</span></dt><dd><p>
      A 48‐bit number, generated by the initiator, that uniquely identifies a
      session between the initiator and the target. This value is created
      during the login process, and is sent to the target with a Login PDU.
     </p></dd><dt id="idm140159793099440"><span class="term ">MCS (multiple connections per session)</span></dt><dd><p>
      A part of the iSCSI specification that allows multiple TCP/IP connections
      between an initiator and a target.
     </p></dd><dt id="idm140159793097520"><span class="term ">MPIO (multipath I/O)</span></dt><dd><p>
      A method by which data can take multiple redundant paths between a server
      and storage.
     </p></dd><dt id="idm140159793095632"><span class="term ">network portal</span></dt><dd><p>
      The combination of an iSCSI endpoint with an IP address plus a TCP
      (Transmission Control Protocol) port. TCP port 3260 is the port number
      for the iSCSI protocol, as defined by IANA (Internet Assigned Numbers
      Authority).
     </p></dd><dt id="idm140159793093600"><span class="term ">SAM (SCSI architectural model)</span></dt><dd><p>
      A document that describes the behavior of SCSI in general terms, allowing
      for different types of devices communicating over various media.
     </p></dd><dt id="idm140159793091648"><span class="term ">target</span></dt><dd><p>
      The receiving end of an SCSI session, typically a device such as a disk
      drive, tape drive, or scanner.
     </p></dd><dt id="idm140159793089744"><span class="term ">target group (TG)</span></dt><dd><p>
      A list of SCSI target ports that are all treated the same when creating
      views. Creating a view can help simplify LUN (logical unit number)
      mapping. Each view entry specifies a target group, host group, and a LUN.
     </p></dd><dt id="idm140159793087728"><span class="term ">target port</span></dt><dd><p>
      The combination of an iSCSI endpoint with one or more LUNs.
     </p></dd><dt id="idm140159793085872"><span class="term ">target port group (TPG)</span></dt><dd><p>
      A list of IP addresses and TCP port numbers that determines which
      interfaces a specific iSCSI target will listen to.
     </p></dd><dt id="idm140159793083968"><span class="term ">target session identifier (TSID)</span></dt><dd><p>
      A 16‐bit number, generated by the target, that uniquely identifies a
      session between the initiator and the target. This value is created
      during the login process, and is sent to the initiator with a Login
      Response PDU (protocol data units).
     </p></dd></dl></div></div><div class="sect1 " id="sec.iscsi.info"><div class="titlepage"><div><div><h2 class="title" id="sec.iscsi.info"><span class="number">14.7 </span><span class="name">Additional Information</span> <a title="Permalink" class="permalink" href="cha.iscsi.html#sec.iscsi.info">#</a></h2></div></div></div><p>
   The iSCSI protocol has been available for several years. There are many
   reviews comparing iSCSI with SAN solutions, benchmarking performance, and
   there also is documentation describing hardware solutions. For more
   information, see Open-iSCSI project homepage at
   <a class="link" href="http://www.open-iscsi.com/" target="_blank">http://www.open-iscsi.com/</a>.
  </p><p>
   Additionally, see the man pages for
   <code class="command">iscsiadm</code>, <code class="command">iscsid</code>,
   <code class="filename">ietd.conf</code>, and <code class="command">ietd</code> and the example
   configuration file <code class="filename">/etc/iscsid.conf</code>.
  </p></div></div></div><div class="page-bottom"><div id="_bottom-navigation"><a class="nav-link" href="cha.fcoe.html"><span class="next-icon">→</span><span class="nav-label"><span class="number">Chapter 15 </span>Fibre Channel Storage over Ethernet Networks: FCoE</span></a><a class="nav-link" href="cha.isns.html"><span class="prev-icon">←</span><span class="nav-label"><span class="number">Chapter 13 </span>iSNS for Linux</span></a></div><div id="_share-print"><div class="online-contents share"><strong>Share this page: </strong><span class="share-buttons"><span id="_share-fb" class="bottom-button">Facebook</span><span class="spacer"> • </span><span id="_share-gp" class="bottom-button">Google+</span><span class="spacer"> • </span><span id="_share-tw" class="bottom-button">Twitter</span><span class="spacer"> • </span><span id="_share-mail" class="bottom-button">E-Mail</span></span></div><div class="print"><span id="_print-button" class="bottom-button">Print this page</span></div><div class="clearme"></div></div></div></div><div id="_inward"></div></div><div id="_footer-wrap"><div id="_footer"><p>©
        2018 
        SUSE</p><ul><li><a href="http://www.suse.com/company/careers/" target="_top">Careers</a></li><li><a href="http://www.suse.com/company/legal/" target="_top">Legal</a></li><li><a href="http://www.suse.com/company/" target="_top">About</a></li><li><a href="http://www.suse.com/ContactsOffices/contacts_offices.jsp" target="_top">Contact Us</a></li></ul></div></div></body></html>