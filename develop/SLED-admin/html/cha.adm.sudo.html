<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang=""><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>sudo
 | Administration Guide | SUSE Linux Enterprise Desktop 15</title><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" /><link rel="stylesheet" type="text/css" href="static/css/style.css" /><link rel="stylesheet" type="text/css" href="static/css/highlight.css" /><meta name="generator" content="DAPS 2.4.0 using SUSE XSL Stylesheets 2.0.8 (based on DocBook XSL Stylesheets 1.78.1) - chunked" /><meta name="product-name" content="SUSE Linux Enterprise Desktop" /><meta name="product-number" content="15" /><meta name="book-title" content="Administration Guide" /><meta name="chapter-title" content="Chapter 2. sudo&#10;" /><meta name="tracker-url" content="https://bugzilla.suse.com/enter_bug.cgi" /><meta name="tracker-type" content="bsc" /><meta name="tracker-bsc-assignee" content="fs@suse.com" /><meta name="tracker-bsc-component" content="Documentation" /><meta name="tracker-bsc-product" content="Beta SUSE Linux Enterprise Desktop 15" /><link rel="home" href="index.html" title="SUSE Linux Enterprise Desktop Documentation" /><link rel="up" href="part.administration.html" title="Part I. Common Tasks" /><link rel="prev" href="cha.adm.shell.html" title="Chapter 1. Bash and Bash Scripts" /><link rel="next" href="cha.onlineupdate.you.html" title="Chapter 3. YaST Online Update" /><script type="text/javascript">

var protocol = window.location.protocol.toLowerCase();
if ( protocol != 'file:' ) {
  var agent = navigator.userAgent.toLowerCase();
  var wanted = ( protocol == 'https:') ? 'https' : 'http';
  var file = 'fonts.css';
  document.write('<link rel="stylesheet" type="text/css" href="' + wanted + '://static.opensuse.org/fonts/'+ file +'"></link>');
}
else {
   document.write('<link rel="stylesheet" type="text/css" href="static/css/fonts-onlylocal.css"></link>');
}

</script><noscript><link rel="stylesheet" type="text/css" href="http://static.opensuse.org/fonts/fonts.css" /></noscript><script src="static/js/jquery-1.10.2.min.js" type="text/javascript"></script><script src="static/js/script.js" type="text/javascript"></script><script src="static/js/highlight.min.js" type="text/javascript"></script><script>

$(document).ready(function() {
  $('.verbatim-wrap.highlight').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});
hljs.configure({
  useBR: false
});

</script></head><body class="draft offline js-off"><div id="_outer-wrap"><div id="_white-bg"><div id="_header"><div id="_logo"><img src="static/images/logo.png" alt="Logo" /></div><div class="crumbs"><a class="book-link" href="index.html" title="SUSE Linux Enterprise Desktop Documentation"><span class="book-icon">SUSE Linux Enterprise Desktop Documentation</span></a><span> › </span><a class="crumb" href="book.sle.admin.html">Administration Guide</a><span> › </span><a class="crumb" href="part.administration.html">Common Tasks</a><span> › </span><a class="crumb" href="cha.adm.sudo.html">sudo
</a></div><div class="clearme"></div></div></div><div id="_toolbar-wrap"><div id="_toolbar"><div id="_toc-area" class="inactive"><a id="_toc-area-button" class="tool" title="Contents" accesskey="c" href="index.html"><span class="tool-spacer"><span class="toc-icon">Contents</span><span class="clearme"></span></span><span class="tool-label">Contents</span></a><div class="active-contents bubble-corner"></div><div class="active-contents bubble"><div class="bubble-container"><h6>Administration Guide</h6><div id="_bubble-toc"><ol><li class="inactive"><a href="pre.sle.html"><span class="number"> </span><span class="name">About This Guide</span></a></li><li class="inactive"><a href="part.administration.html"><span class="number">I </span><span class="name">Common Tasks</span></a><ol><li class="inactive"><a href="cha.adm.shell.html"><span class="number">1 </span><span class="name">Bash and Bash Scripts</span></a></li><li class="inactive"><a href="cha.adm.sudo.html"><span class="number">2 </span><span class="name">sudo
</span></a></li><li class="inactive"><a href="cha.onlineupdate.you.html"><span class="number">3 </span><span class="name">YaST Online Update</span></a></li><li class="inactive"><a href="cha.yast.gui.html"><span class="number">4 </span><span class="name">YaST</span></a></li><li class="inactive"><a href="cha.yast.text.html"><span class="number">5 </span><span class="name">YaST in Text Mode</span></a></li><li class="inactive"><a href="cha.sw_cl.html"><span class="number">6 </span><span class="name">Managing Software with Command Line Tools</span></a></li><li class="inactive"><a href="cha.snapper.html"><span class="number">7 </span><span class="name">System Recovery and Snapshot Management with Snapper</span></a></li><li class="inactive"><a href="cha.vnc.html"><span class="number">8 </span><span class="name">Remote Access with VNC</span></a></li><li class="inactive"><a href="cha.net.rsync.html"><span class="number">9 </span><span class="name">File Copying with RSync</span></a></li><li class="inactive"><a href="cha.gnome-configuration.html"><span class="number">10 </span><span class="name">GNOME Configuration for Administrators</span></a></li></ol></li><li class="inactive"><a href="part.boot.html"><span class="number">II </span><span class="name">Booting a Linux System</span></a><ol><li class="inactive"><a href="cha.boot.html"><span class="number">11 </span><span class="name">Introduction to the Booting Process</span></a></li><li class="inactive"><a href="cha.uefi.html"><span class="number">12 </span><span class="name">UEFI (Unified Extensible Firmware Interface)</span></a></li><li class="inactive"><a href="cha.grub2.html"><span class="number">13 </span><span class="name">The Boot Loader GRUB 2</span></a></li><li class="inactive"><a href="cha.systemd.html"><span class="number">14 </span><span class="name">The <code class="systemitem">systemd</code> Daemon</span></a></li></ol></li><li class="inactive"><a href="part.system.html"><span class="number">III </span><span class="name">System</span></a><ol><li class="inactive"><a href="cha.64bit.html"><span class="number">15 </span><span class="name">32-Bit and 64-Bit Applications in a 64-Bit System Environment</span></a></li><li class="inactive"><a href="cha.journalctl.html"><span class="number">16 </span><span class="name"><code class="command">journalctl</code>: Query the <code class="systemitem">systemd</code> Journal</span></a></li><li class="inactive"><a href="cha.update-alternative.html"><span class="number">17 </span><span class="name"><code class="command">update-alternatives</code>: Managing Multiple Versions of Commands and Files</span></a></li><li class="inactive"><a href="cha.network.html"><span class="number">18 </span><span class="name">Basic Networking</span></a></li><li class="inactive"><a href="cha.print.html"><span class="number">19 </span><span class="name">Printer Operation</span></a></li><li class="inactive"><a href="cha.x11.html"><span class="number">20 </span><span class="name">The X Window System</span></a></li><li class="inactive"><a href="cha.fuse.html"><span class="number">21 </span><span class="name">Accessing File Systems with FUSE</span></a></li><li class="inactive"><a href="cha.mod.html"><span class="number">22 </span><span class="name">Managing Kernel Modules</span></a></li><li class="inactive"><a href="cha.udev.html"><span class="number">23 </span><span class="name">Dynamic Kernel Device Management with <code class="systemitem">udev</code></span></a></li><li class="inactive"><a href="cha.kgraft.html"><span class="number">24 </span><span class="name">Live Patching the Linux Kernel Using kGraft</span></a></li><li class="inactive"><a href="cha.suse.html"><span class="number">25 </span><span class="name">Special System Features</span></a></li><li class="inactive"><a href="cha.nm.html"><span class="number">26 </span><span class="name">Using NetworkManager</span></a></li><li class="inactive"><a href="cha.power-mgmt.html"><span class="number">27 </span><span class="name">Power Management</span></a></li></ol></li><li class="inactive"><a href="part.services.html"><span class="number">IV </span><span class="name">Services</span></a><ol><li class="inactive"><a href="cha.ntp.html"><span class="number">28 </span><span class="name">Time Synchronization with NTP</span></a></li><li class="inactive"><a href="cha.nfs.html"><span class="number">29 </span><span class="name">Sharing File Systems with NFS</span></a></li><li class="inactive"><a href="cha.samba.html"><span class="number">30 </span><span class="name">Samba</span></a></li><li class="inactive"><a href="cha.autofs.html"><span class="number">31 </span><span class="name">On-Demand Mounting with Autofs</span></a></li></ol></li><li class="inactive"><a href="part.trouble.html"><span class="number">V </span><span class="name">Troubleshooting</span></a><ol><li class="inactive"><a href="cha.adminhelp.html"><span class="number">32 </span><span class="name">Help and Documentation</span></a></li><li class="inactive"><a href="cha.adm.support.html"><span class="number">33 </span><span class="name">Gathering System Information for Support</span></a></li><li class="inactive"><a href="cha.trouble.html"><span class="number">34 </span><span class="name">Common Problems and Their Solutions</span></a></li></ol></li><li class="inactive"><a href="app.nwscheme.html"><span class="number">A </span><span class="name">An Example Network</span></a></li><li class="inactive"><a href="bk01apb.html"><span class="number">B </span><span class="name">GNU Licenses</span></a></li></ol></div><div class="clearme"></div></div></div></div><div id="_nav-area" class="inactive"><div class="tool"><span class="nav-inner"><span class="tool-label">Navigation</span><a accesskey="p" class="tool-spacer" title="Chapter 1. Bash and Bash Scripts" href="cha.adm.shell.html"><span class="prev-icon">←</span></a><a accesskey="n" class="tool-spacer" title="Chapter 3. YaST Online Update" href="cha.onlineupdate.you.html"><span class="next-icon">→</span></a></span></div></div></div></div><div id="_fixed-header-wrap" class="inactive"><div id="_fixed-header"><div class="crumbs"><a class="book-link" href="index.html" title="SUSE Linux Enterprise Desktop Documentation"><span class="book-icon">SUSE Linux Enterprise Desktop Documentation</span></a><span> › </span><a class="crumb" href="book.sle.admin.html">Administration Guide</a><span> › </span><a class="crumb" href="part.administration.html">Common Tasks</a><span> › </span><a class="crumb" href="cha.adm.sudo.html">sudo
</a></div><div class="buttons"><a class="top-button button" href="#">Top</a><div class="button"><a accesskey="p" class="tool-spacer" title="Chapter 1. Bash and Bash Scripts" href="cha.adm.shell.html"><span class="prev-icon">←</span></a><a accesskey="n" class="tool-spacer" title="Chapter 3. YaST Online Update" href="cha.onlineupdate.you.html"><span class="next-icon">→</span></a></div><div class="clearme"></div></div><div class="clearme"></div></div></div><div id="_content" class="draft "><div class="documentation"><div class="chapter " id="cha.adm.sudo"><div class="titlepage"><div><div class="version-info">Applies to  <span class="productname"><span class="productname"><span class="phrase">SUSE Linux Enterprise Desktop</span></span></span> <span class="productnumber"><span class="productnumber"><span class="phrase">15</span></span></span></div><div><h2 class="title"><span class="number">2 </span><span class="name">sudo
</span> </h2><div class="doc-status"><ul><li><span class="ds-label">Filename: </span>adm_sudo.xml</li><li><span class="ds-label">ID: </span>cha.adm.sudo</li></ul></div></div></div></div><div class="line"><div class="toc"><dl><dt><span class="sect1"><a href="cha.adm.sudo.html#sec.adm.sudo.usage"><span class="number">2.1 </span><span class="name">Basic <code class="command">sudo</code> Usage</span></a></span></dt><dt><span class="sect1"><a href="cha.adm.sudo.html#sec.sudo.conf"><span class="number">2.2 </span><span class="name">Configuring <code class="command">sudo</code></span></a></span></dt><dt><span class="sect1"><a href="cha.adm.sudo.html#sec.sudo.usecases"><span class="number">2.3 </span><span class="name">Common Use Cases</span></a></span></dt><dt><span class="sect1"><a href="cha.adm.sudo.html#sec.adm.sudo.moreinfo"><span class="number">2.4 </span><span class="name">More Information</span></a></span></dt></dl></div></div><p>
  Many commands and system utilities need to be run as <code class="systemitem">root</code> to modify
  files and/or perform tasks that only the super user is allowed to. For
  security reasons and to avoid accidentally running dangerous commands, it is
  generally advisable not to log in directly as <code class="systemitem">root</code>. Instead, it is
  recommended to work as a normal, unprivileged user and use the <code class="command">sudo</code>
  command to run commands with elevated privileges.
 </p><p>
  On <span class="productname"><span class="phrase">SUSE Linux Enterprise Desktop</span></span>, <code class="command">sudo</code> is configured by default to work similarly to su.
  However, <code class="command">sudo</code> offers the possibility to allow users to run commands with
  privileges of any other user in a highly configurable manner. This can be
  used to assign roles with specific privileges to certain users and groups. It
  is for example possible to allow members of the group <code class="systemitem">users</code> to run a
  command with the privileges of <code class="systemitem">wilber</code>. Access to the command can be
  further restricted by, for example, forbidding to specify any command
  options. While su always requires the <code class="systemitem">root</code> password for authentication
  with PAM, <code class="command">sudo</code> can be configured to authenticate with your own credentials.
  This increases security by not having to share the <code class="systemitem">root</code> password. For
  example, you can allow members of the group <code class="systemitem">users</code> to run a command
  <code class="command">frobnicate</code> as <code class="systemitem">wilber</code>, with the restriction that
  no arguments are specified. This can be used to assign roles with specific
  abilities to certain users and groups.
 </p><div class="sect1 " id="sec.adm.sudo.usage"><div class="titlepage"><div><div><h2 class="title" id="sec.adm.sudo.usage"><span class="number">2.1 </span><span class="name">Basic <code class="command">sudo</code> Usage</span> <a title="Permalink" class="permalink" href="cha.adm.sudo.html#sec.adm.sudo.usage">#</a></h2></div></div></div><p>
   <code class="command">sudo</code> is simple to use, yet very powerful.
  </p><div class="sect2 " id="sec.adm.sudo.usage.cmd"><div class="titlepage"><div><div><h3 class="title" id="sec.adm.sudo.usage.cmd"><span class="number">2.1.1 </span><span class="name">Running a Single Command</span> <a title="Permalink" class="permalink" href="cha.adm.sudo.html#sec.adm.sudo.usage.cmd">#</a></h3></div></div></div><p>
    Logged in as normal user, you can run any command as <code class="systemitem">root</code> by
    adding <code class="command">sudo</code> before it. It will prompt for the root password and, if
    authenticated successfully, run the command as <code class="systemitem">root</code>:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">id -un</code><span id="co.sudo.usage.id"></span><span class="callout">1</span>
tux
<code class="prompt user">tux &gt; </code><code class="command">sudo</code> <code class="command">id -un</code>
root's password:<span id="co.sudo.usage.pw"></span><span class="callout">2</span>
root
<code class="prompt user">tux &gt; </code><code class="command">id -un</code>
tux<span id="co.sudo.usage.after"></span><span class="callout">3</span>
<code class="prompt user">tux &gt; </code><code class="command">sudo</code> <code class="command">id -un</code>
<span id="co.sudo.usage.nopw"></span><span class="callout">4</span>
root</pre></div><div class="calloutlist "><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#co.sudo.usage.id"><span class="callout">1</span></a> </p></td><td valign="top" align="left"><p>
      The <code class="command">id -un</code> command prints the login name of the
      current user.
     </p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#co.sudo.usage.pw"><span class="callout">2</span></a> </p></td><td valign="top" align="left"><p>
      The password is not shown during input, neither as clear text nor as
      bullets.
     </p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#co.sudo.usage.after"><span class="callout">3</span></a> </p></td><td valign="top" align="left"><p>
      Only commands started with <code class="command">sudo</code> are run with elevated privileges. If
      you run the same command without the <code class="command">sudo</code> prefix, it is run with the
      privileges of the current user again.
     </p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#co.sudo.usage.nopw"><span class="callout">4</span></a> </p></td><td valign="top" align="left"><p>
      For a limited amount of time, you do not need to enter the <code class="systemitem">root</code>
      password again.
     </p></td></tr></table></div><div id="idm140453775664096" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.png" /><h6>Tip: I/O Redirection</h6><p>
     I/O redirection does not work as you would probably expect:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> echo s &gt; /proc/sysrq-trigger
bash: /proc/sysrq-trigger: Permission denied
<code class="prompt user">tux &gt; </code><code class="command">sudo</code> cat &lt; /proc/1/maps
bash: /proc/1/maps: Permission denied</pre></div><p>
     Only the <code class="command">echo</code>/<code class="command">cat</code> binary is run with
     elevated privileges, while the redirection is performed by the user's
     shell with user privileges. You can either start a shell like in
     <a class="xref" href="cha.adm.sudo.html#sec.sudo.shell" title="2.1.2. Starting a Shell">Section 2.1.2, “Starting a Shell”</a> or use the <code class="command">dd</code> utility
     instead:
    </p><div class="verbatim-wrap"><pre class="screen">echo s | sudo dd of=/proc/sysrq-trigger
sudo dd if=/proc/1/maps | cat</pre></div></div></div><div class="sect2 " id="sec.sudo.shell"><div class="titlepage"><div><div><h3 class="title" id="sec.sudo.shell"><span class="number">2.1.2 </span><span class="name">Starting a Shell</span> <a title="Permalink" class="permalink" href="cha.adm.sudo.html#sec.sudo.shell">#</a></h3></div></div></div><p>
    Having to add <code class="command">sudo</code> before every command can be cumbersome. While you
    could specify a shell as a command <code class="command">sudo bash</code>, it is
    recommended to rather use one of the built-in mechanisms to start a shell:
   </p><div class="variablelist "><dl class="variablelist"><dt id="idm140453775654576"><span class="term "><code class="literal">sudo -s (&lt;command&gt;)</code>
     </span></dt><dd><p>
       Starts a shell specified by the <code class="envar">SHELL</code> environment
       variable or the target user's default shell. If a command is given, it
       is passed to the shell (with the <code class="option">-c</code> option), else the
       shell is run in interactive mode.
      </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux:~ &gt; </code>sudo -i
root's password:
<code class="prompt user">root:/home/tux # </code>exit
<code class="prompt user">tux:~ &gt; </code></pre></div></dd><dt id="idm140453775649600"><span class="term "><code class="literal">sudo -i (&lt;command&gt;)</code>
     </span></dt><dd><p>
       Like <code class="option">-s</code>, but starts the shell as login shell. This
       means that the shell's start-up files (<code class="filename">.profile</code>
       etc.) are processed and the current working directory is set to the
       target user's home directory.
      </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux:~ &gt; </code>sudo -i
root's password:
<code class="prompt user">root:~ # </code>exit
<code class="prompt user">tux:~ &gt; </code></pre></div></dd></dl></div></div><div class="sect2 " id="sec.adm.sudo.usage.env"><div class="titlepage"><div><div><h3 class="title" id="sec.adm.sudo.usage.env"><span class="number">2.1.3 </span><span class="name">Environment Variables</span> <a title="Permalink" class="permalink" href="cha.adm.sudo.html#sec.adm.sudo.usage.env">#</a></h3></div></div></div><p>
    By default, <code class="command">sudo</code> does not propagate environment variables:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>ENVVAR=test env | grep ENVVAR
ENVVAR=test
<code class="prompt user">tux &gt; </code>ENVVAR=test sudo env | grep ENVVAR
root's password:
<span id="co.sudo.env.novar"></span><span class="callout">1</span>
<code class="prompt user">tux &gt; </code></pre></div><div class="calloutlist "><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#co.sudo.env.novar"><span class="callout">1</span></a> </p></td><td valign="top" align="left"><p>
      The empty output shows that the environment variable
      <code class="envar">ENVVAR</code> did not exist in the context of the command run
      with <code class="command">sudo</code>.
     </p></td></tr></table></div><p>
    This behavior can be changed by the <code class="literal">env_reset</code> option,
    see <a class="xref" href="cha.adm.sudo.html#tab.adm.sudo.options" title="Useful Flags and Options">Table 2.1, “Useful Flags and Options”</a>.
   </p></div></div><div class="sect1 " id="sec.sudo.conf"><div class="titlepage"><div><div><h2 class="title" id="sec.sudo.conf"><span class="number">2.2 </span><span class="name">Configuring <code class="command">sudo</code></span> <a title="Permalink" class="permalink" href="cha.adm.sudo.html#sec.sudo.conf">#</a></h2></div></div></div><p>
   <code class="command">sudo</code> is a very flexible tool with extensive configuration.
  </p><div id="idm140453775633024" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note: Locked yourself out of sudo</h6><p>
    If you accidentally locked yourself out of <code class="command">sudo</code>, use <code class="command">su
    -</code> and the <code class="systemitem">root</code> password to get a root shell.
    To fix the error, run <code class="command">visudo</code>.
   </p></div><div class="sect2 " id="sec.sudo.conf.edit"><div class="titlepage"><div><div><h3 class="title" id="sec.sudo.conf.edit"><span class="number">2.2.1 </span><span class="name">Editing the Configuration Files</span> <a title="Permalink" class="permalink" href="cha.adm.sudo.html#sec.sudo.conf.edit">#</a></h3></div></div></div><p>
    The main policy configuration file for <code class="command">sudo</code> is
    <code class="filename">/etc/sudoers</code>. As it is possible to lock yourself out
    of the system due to errors in this file, it is strongly
    recommended to use <code class="command">visudo</code> for editing. It will prevent
    simultaneous changes to the opened file and check for syntax errors before
    saving the modifications.
   </p><p>
    Despite its name, you can also use editors other than vi by setting the
    <code class="envar">EDITOR</code> environment variable, for example:
   </p><div class="verbatim-wrap"><pre class="screen">sudo EDITOR=<em class="replaceable ">/usr/bin/nano</em> visudo</pre></div><p>
    However, the <code class="filename">/etc/sudoers</code> file itself is supplied by
    the system packages and modifications may break on updates. Therefore, it
    is recommended to put custom configuration into files in the
    <code class="filename">/etc/sudoers.d/</code> directory. Any file in there is
    automatically included. To create or edit a file in that subdirectory, run:
   </p><div class="verbatim-wrap"><pre class="screen">sudo visudo -f /etc/sudoers.d/<em class="replaceable ">NAME</em></pre></div><p>
    Alternatively with a different editor (for example
    <code class="command">nano</code>):
   </p><div class="verbatim-wrap"><pre class="screen">sudo EDITOR=<em class="replaceable ">/usr/bin/nano</em> visudo -f /etc/sudoers.d/<em class="replaceable ">NAME</em></pre></div><div id="idm140453775619968" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note: Ignored Files in <code class="filename">/etc/sudoers.d</code></h6><p>
     The <code class="literal">#includedir</code> command in
     <code class="filename">/etc/sudoers</code>, used for
     <code class="filename">/etc/sudoers.d</code>, ignores files that end in
     <code class="literal">~</code> (tilde) or contain a <code class="literal">.</code> (dot).
    </p></div><p>
    For more information on the <code class="command">visudo</code> command, run
    <code class="command">man 8 visudo</code>.
   </p></div><div class="sect2 " id="sec.sudo.conf.syntax"><div class="titlepage"><div><div><h3 class="title" id="sec.sudo.conf.syntax"><span class="number">2.2.2 </span><span class="name">Basic sudoers Configuration Syntax</span> <a title="Permalink" class="permalink" href="cha.adm.sudo.html#sec.sudo.conf.syntax">#</a></h3></div></div></div><p>
    In the sudoers configuration files, there are two types of options: strings
    and flags. While strings can contain any value, flags can be turned either
    ON or OFF. The most important syntax constructs for sudoers configuration
    files are:
   </p><div class="verbatim-wrap"><pre class="screen"># Everything on a line after a # gets ignored <span id="co.sudo.syntax.comment"></span><span class="callout">1</span>
Defaults !insults # Disable the insults flag <span id="co.sudo.syntax.flag"></span><span class="callout">2</span>
Defaults env_keep += "DISPLAY HOME" # Add DISPLAY and HOME to env_keep
tux ALL = NOPASSWD: /usr/bin/frobnicate, PASSWD: /usr/bin/journalctl <span id="co.sudo.syntax.rule"></span><span class="callout">3</span></pre></div><div class="calloutlist "><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#co.sudo.syntax.comment"><span class="callout">1</span></a> </p></td><td valign="top" align="left"><p>
      There are two exceptions: <code class="literal">#include</code> and
      <code class="literal">#includedir</code> are normal commands. Followed by digits,
      it specifies a UID.
     </p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#co.sudo.syntax.flag"><span class="callout">2</span></a> </p></td><td valign="top" align="left"><p>
      Remove the <code class="literal">!</code> to set the specified flag to ON.
     </p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#co.sudo.syntax.rule"><span class="callout">3</span></a> </p></td><td valign="top" align="left"><p>
      See <a class="xref" href="cha.adm.sudo.html#sec.sudo.conf.rule" title="2.2.3. Rules in sudoers">Section 2.2.3, “Rules in sudoers”</a>.
     </p></td></tr></table></div><div class="table" id="tab.adm.sudo.options"><div class="table-title-wrap"><h6 class="table-title"><span class="number">Table 2.1: </span><span class="name">Useful Flags and Options </span><a title="Permalink" class="permalink" href="cha.adm.sudo.html#tab.adm.sudo.options">#</a></h6></div><div class="table-contents"><table summary="Useful Flags and Options" border="1"><colgroup><col /><col /><col /></colgroup><thead><tr><th>
        <p>
         Option name
        </p>
       </th><th>
        <p>
         Description
        </p>
       </th><th>
        <p>
         Example
        </p>
       </th></tr></thead><tbody><tr><td><code class="literal">targetpw</code>
       </td><td>
        <p>
         This flag controls whether the invoking user is required to enter the
         password of the target user (ON) (for example <code class="systemitem">root</code>) or the
         invoking user (OFF).
        </p>
       </td><td>
<div class="verbatim-wrap"><pre class="screen">Defaults targetpw # Turn targetpw flag ON</pre></div>
       </td></tr><tr><td><code class="literal">rootpw</code>
       </td><td>
        <p>
         If set, <code class="command">sudo</code> will prompt for the <code class="systemitem">root</code> password instead of the
         target user's or the invoker's. The default is OFF.
        </p>
       </td><td>
<div class="verbatim-wrap"><pre class="screen">Defaults !rootpw # Turn rootpw flag OFF</pre></div>
       </td></tr><tr><td><code class="literal">env_reset</code>
       </td><td>
        <p>
         If set, <code class="command">sudo</code> constructs a minimal environment with only
         <code class="envar">TERM</code>, <code class="envar">PATH</code>, <code class="envar">HOME</code>,
         <code class="envar">MAIL</code>, <code class="envar">SHELL</code>, <code class="envar">LOGNAME</code>,
         <code class="envar">USER</code>, <code class="envar">USERNAME</code>, and
         <code class="envar">SUDO_*</code> set. Additionally, variables listed in
         <code class="literal">env_keep</code> get imported from the calling
         environment. The default is ON.
        </p>
       </td><td>
<div class="verbatim-wrap"><pre class="screen">Defaults env_reset # Turn env_reset flag ON</pre></div>
       </td></tr><tr><td><code class="literal">env_keep</code>
       </td><td>
        <p>
         List of environment variables to keep when the
         <code class="literal">env_reset</code> flag is ON.
        </p>
       </td><td>
<div class="verbatim-wrap"><pre class="screen"># Set env_keep to contain EDITOR and PROMPT
Defaults env_keep = "EDITOR PROMPT"
Defaults env_keep += "JRE_HOME" # Add JRE_HOME
Defaults env_keep -= "JRE_HOME" # Remove JRE_HOME</pre></div>
       </td></tr><tr><td><code class="literal">env_delete</code>
       </td><td>
        <p>
         List of environment variables to remove when the
         <code class="literal">env_reset</code> flag is OFF.
        </p>
       </td><td>
<div class="verbatim-wrap"><pre class="screen"># Set env_delete to contain EDITOR and PROMPT
Defaults env_delete = "EDITOR PROMPT"
Defaults env_delete += "JRE_HOME" # Add JRE_HOME
Defaults env_delete -= "JRE_HOME" # Remove JRE_HOME</pre></div>
       </td></tr></tbody></table></div></div><p>
    The <code class="literal">Defaults</code> token can also be used to create aliases
    for a collection of users, hosts, and commands. Furthermore, it is possible
    to apply an option only to a specific set of users.
   </p><p>
    For detailed information about the <code class="filename">/etc/sudoers</code>
    configuration file, consult <code class="command">man 5 sudoers</code>.
   </p></div><div class="sect2 " id="sec.sudo.conf.rule"><div class="titlepage"><div><div><h3 class="title" id="sec.sudo.conf.rule"><span class="number">2.2.3 </span><span class="name">Rules in sudoers</span> <a title="Permalink" class="permalink" href="cha.adm.sudo.html#sec.sudo.conf.rule">#</a></h3></div></div></div><p>
    Rules in the sudoers configuration can be very complex, so this section
    will only cover the basics. Each rule follows the basic scheme
    (<code class="literal">[]</code> marks optional parts):
   </p><div class="verbatim-wrap"><pre class="screen">#Who      Where         As whom      Tag                What
User_List Host_List = [(User_List)] [NOPASSWD:|PASSWD:] Cmnd_List</pre></div><div class="variablelist "><div class="variablelist-title-wrap"><h6 class="variablelist-title"><span class="name">Syntax for sudoers Rules </span><a title="Permalink" class="permalink" href="cha.adm.sudo.html#idm140453775569152">#</a></h6></div><dl class="variablelist"><dt id="idm140453775568400"><span class="term "><code class="literal">User_List</code>
     </span></dt><dd><p>
       One or more (separated by <code class="literal">,</code>) identifiers: Either a
       user name, a group in the format <code class="literal">%GROUPNAME</code> or a user
       ID in the format <code class="literal">#UID</code>. Negation can be performed with
       a <code class="literal">!</code> prefix.
      </p></dd><dt id="idm140453775564416"><span class="term "><code class="literal">Host_List</code>
     </span></dt><dd><p>
       One or more (separated by <code class="literal">,</code>) identifiers: Either a
       (fully qualified) host name or an IP address. Negation can be performed
       with a <code class="literal">!</code> prefix. <code class="literal">ALL</code> is the usual
       choice for <code class="literal">Host_List</code>.
      </p></dd><dt id="idm140453775560416"><span class="term "><code class="literal">NOPASSWD:|PASSWD:</code>
     </span></dt><dd><p>
       The user will not be prompted for a password when running commands
       matching <code class="literal">CMDSPEC</code> after <code class="literal">NOPASSWD:</code>.
      </p><p>
       <code class="literal">PASSWD</code> is the default, it only needs to be specified
       when both are on the same line:
      </p><div class="verbatim-wrap"><pre class="screen">tux ALL = PASSWD: /usr/bin/foo, NOPASSWD: /usr/bin/bar</pre></div></dd><dt id="idm140453775555904"><span class="term "><code class="literal">Cmnd_List</code>
     </span></dt><dd><p>
       One or more (separated by <code class="literal">,</code>) specifiers: A path to an
       executable, followed by allowed arguments or nothing.
      </p><div class="verbatim-wrap"><pre class="screen">/usr/bin/foo     # Anything allowed
/usr/bin/foo bar # Only "/usr/bin/foo bar" allowed
/usr/bin/foo ""  # No arguments allowed</pre></div></dd></dl></div><p>
    <code class="literal">ALL</code> can be used as <code class="literal">User_List</code>,
    <code class="literal">Host_List</code>, and <code class="literal">Cmnd_List</code>.
   </p><p>
    A rule that allows <code class="systemitem">tux</code> to run all commands as root without
    entering a password:
   </p><div class="verbatim-wrap"><pre class="screen">tux ALL = NOPASSWD: ALL</pre></div><p>
    A rule that allows <code class="systemitem">tux</code> to run <code class="command">systemctl restart
    apache2</code>:
   </p><div class="verbatim-wrap"><pre class="screen">tux ALL = /usr/bin/systemctl restart apache2</pre></div><p>
    A rule that allows <code class="systemitem">tux</code> to run <code class="command">wall</code> as
    <code class="systemitem">admin</code> with no arguments:
   </p><div class="verbatim-wrap"><pre class="screen">tux ALL = (admin) /usr/bin/wall ""</pre></div><div id="idm140453775543968" class="admonition warning normal"><img class="symbol" alt="Warning" title="Warning" src="static/images/icon-warning.png" /><h6>Warning: Dangerous constructs</h6><p>
     Constructs of the kind
    </p><div class="verbatim-wrap"><pre class="screen">ALL ALL = ALL</pre></div><p>
     <span class="emphasis"><em>must not</em></span> be used without <code class="literal">Defaults
     targetpw</code>, otherwise anyone can run commands as <code class="systemitem">root</code>.
    </p></div></div></div><div class="sect1 " id="sec.sudo.usecases"><div class="titlepage"><div><div><h2 class="title" id="sec.sudo.usecases"><span class="number">2.3 </span><span class="name">Common Use Cases</span> <a title="Permalink" class="permalink" href="cha.adm.sudo.html#sec.sudo.usecases">#</a></h2></div></div></div><p>
   Although the default configuration is often sufficient for simple setups and
   desktop environments, custom configurations can be very useful.
  </p><div class="sect2 " id="sec.sudo.usecases.userpw"><div class="titlepage"><div><div><h3 class="title" id="sec.sudo.usecases.userpw"><span class="number">2.3.1 </span><span class="name">Using <code class="command">sudo</code> without <code class="systemitem">root</code> Password</span> <a title="Permalink" class="permalink" href="cha.adm.sudo.html#sec.sudo.usecases.userpw">#</a></h3></div></div></div><p>
    In cases with special restrictions (<span class="quote">“<span class="quote">user X can only run command Y as
    <code class="systemitem">root</code></span>”</span>) it is not possible. In other cases, it is still
    favorable to have some kind of separation. By convention, members of the
    group <code class="systemitem">wheel</code> can run all commands
    with <code class="command">sudo</code> as root.
   </p><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
      Add yourself to the <code class="systemitem">wheel</code>
      group
     </p><p>
      If your user account is not already member of the
      <code class="systemitem">wheel</code> group, add it by running
      <code class="command">sudo usermod -a -G wheel
      <em class="replaceable ">USERNAME</em></code> and logging out and in
      again. Verify that the change was successful by running <code class="command">groups
      <em class="replaceable ">USERNAME</em></code>.
     </p></li><li class="step "><p>
      Make authentication with the invoking user's password the default.
     </p><p>
      Create the file <code class="filename">/etc/sudoers.d/userpw</code> with
      <code class="command">visudo</code> (see <a class="xref" href="cha.adm.sudo.html#sec.sudo.conf.edit" title="2.2.1. Editing the Configuration Files">Section 2.2.1, “Editing the Configuration Files”</a>) and
      add:
     </p><div class="verbatim-wrap"><pre class="screen">Defaults !targetpw</pre></div></li><li class="step "><p>
      Select a new default rule.
     </p><p>
      Depending on whether you want users to re-enter their passwords,
      uncomment the specific line in <code class="filename">/etc/sudoers</code> and
      comment out the default rule.
     </p><div class="verbatim-wrap"><pre class="screen">## Uncomment to allow members of group wheel to execute any command
# %wheel ALL=(ALL) ALL

## Same thing without a password
# %wheel ALL=(ALL) NOPASSWD: ALL</pre></div></li><li class="step "><p>
      Make the default rule more restrictive
     </p><p>
      Comment out or remove the allow-everything rule in
      <code class="filename">/etc/sudoers</code>:
     </p><div class="verbatim-wrap"><pre class="screen">ALL     ALL=(ALL) ALL   # WARNING! Only use this together with 'Defaults targetpw'!</pre></div><div id="idm140453775520192" class="admonition warning normal"><img class="symbol" alt="Warning" title="Warning" src="static/images/icon-warning.png" /><h6>Warning: Dangerous rule in sudoers</h6><p>
       Do not forget this step, otherwise <span class="emphasis"><em>any</em></span> user can
       execute <span class="emphasis"><em>any</em></span> command as <code class="systemitem">root</code>!
      </p></div></li><li class="step "><p>
      Test the configuration
     </p><p>
      Try to run <code class="command">sudo</code> as member and non-member of
      <code class="systemitem">wheel</code>.
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux:~ &gt; </code>groups
users wheel
<code class="prompt user">tux:~ &gt; </code>sudo id -un
tux's password:
root
<code class="prompt user">wilber:~ &gt; </code>groups
users
<code class="prompt user">wilber:~ &gt; </code>sudo id -un
wilber is not in the sudoers file.  This incident will be reported.</pre></div></li></ol></div></div></div><div class="sect2 " id="sec.sudo.usecases.xorg"><div class="titlepage"><div><div><h3 class="title" id="sec.sudo.usecases.xorg"><span class="number">2.3.2 </span><span class="name">Using <code class="command">sudo</code> with X.Org Applications</span> <a title="Permalink" class="permalink" href="cha.adm.sudo.html#sec.sudo.usecases.xorg">#</a></h3></div></div></div><p>
    When starting graphical applications with <code class="command">sudo</code>, you will encounter the
    following error:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> xterm
xterm: Xt error: Can't open display: %s
xterm: DISPLAY is not set</pre></div><p>
    YaST will pick the ncurses interface instead of the graphical one.
   </p><p>
    To use X.Org in applications started with <code class="command">sudo</code>, the environment
    variables <code class="envar">DISPLAY</code> and <code class="envar">XAUTHORITY</code> need to be
    propagated. To configure this, create the file
    <code class="filename">/etc/sudoers.d/xorg</code>, (see
    <a class="xref" href="cha.adm.sudo.html#sec.sudo.conf.edit" title="2.2.1. Editing the Configuration Files">Section 2.2.1, “Editing the Configuration Files”</a>) and add the following line:
   </p><div class="verbatim-wrap"><pre class="screen">Defaults env_keep += "DISPLAY XAUTHORITY"</pre></div><p>
    If not set already, set the <code class="envar">XAUTHORITY</code> variable as follows:
   </p><div class="verbatim-wrap"><pre class="screen">export XAUTHORITY=~/.Xauthority</pre></div><p>
    Now X.Org applications can be run as usual:
   </p><div class="verbatim-wrap"><pre class="screen">sudo yast2</pre></div></div></div><div class="sect1 " id="sec.adm.sudo.moreinfo"><div class="titlepage"><div><div><h2 class="title" id="sec.adm.sudo.moreinfo"><span class="number">2.4 </span><span class="name">More Information</span> <a title="Permalink" class="permalink" href="cha.adm.sudo.html#sec.adm.sudo.moreinfo">#</a></h2></div></div></div><p>
   A quick overview about the available command line switches can be retrieved
   by <code class="command">sudo --help</code>. An explanation and other important
   information can be found in the man page: <code class="command">man 8 sudo</code>,
   while the configuration is documented in <code class="command">man 5 sudoers</code>.
  </p></div></div></div><div class="page-bottom"><div id="_bottom-navigation"><a class="nav-link" href="cha.onlineupdate.you.html"><span class="next-icon">→</span><span class="nav-label"><span class="number">Chapter 3 </span>YaST Online Update</span></a><a class="nav-link" href="cha.adm.shell.html"><span class="prev-icon">←</span><span class="nav-label"><span class="number">Chapter 1 </span>Bash and Bash Scripts</span></a></div><div id="_share-print"><div class="online-contents share"><strong>Share this page: </strong><span class="share-buttons"><span id="_share-fb" class="bottom-button">Facebook</span><span class="spacer"> • </span><span id="_share-gp" class="bottom-button">Google+</span><span class="spacer"> • </span><span id="_share-tw" class="bottom-button">Twitter</span><span class="spacer"> • </span><span id="_share-mail" class="bottom-button">E-Mail</span></span></div><div class="print"><span id="_print-button" class="bottom-button">Print this page</span></div><div class="clearme"></div></div></div></div><div id="_inward"></div></div><div id="_footer-wrap"><div id="_footer"><p>©
        2018 
        SUSE</p><ul><li><a href="http://www.suse.com/company/careers/" target="_top">Careers</a></li><li><a href="http://www.suse.com/company/legal/" target="_top">Legal</a></li><li><a href="http://www.suse.com/company/" target="_top">About</a></li><li><a href="http://www.suse.com/ContactsOffices/contacts_offices.jsp" target="_top">Contact Us</a></li></ul></div></div></body></html>