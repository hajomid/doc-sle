<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang=""><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Authorization with PolKit | Security Guide | openSUSE Leap 42.2</title><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" /><link rel="stylesheet" type="text/css" href="static/css/style.css" /><link rel="stylesheet" type="text/css" href="static/css/highlight.css" /><link rel="stylesheet" type="text/css" href="static/css/brand.css" /><meta name="generator" content="DAPS 2.4.0 using openSUSE XSL Stylesheets 2.0.8 (based on DocBook XSL Stylesheets 1.78.1) - chunked" /><meta name="product-name" content="openSUSE Leap" /><meta name="product-number" content="42.2" /><meta name="book-title" content="Security Guide" /><meta name="chapter-title" content="Chapter 9. Authorization with PolKit" /><meta name="description" content="PolKit (formerly known as PolicyKit) is an application framework that acts as a negotiator between the unprivileged user session and the privileged system context. Whenever a process from the user session tries to carry out an action in the system context, PolKit is queried. Based on its configuration—specified in a so-called policy—the answer could be yes, no, or needs authentication. Unlike classical privilege authorization programs such as sudo, PolKit does not grant root permissions to an entire session, but only to the action in question." /><meta name="tracker-url" content="https://bugzilla.opensuse.org/enter_bug.cgi" /><meta name="tracker-type" content="bsc" /><meta name="tracker-bsc-assignee" content="fs@suse.com" /><meta name="tracker-bsc-component" content="Documentation" /><meta name="tracker-bsc-product" content="openSUSE Distribution" /><meta name="tracker-bsc-version" content="Leap 42.2" /><link rel="home" href="index.html" title="openSUSE Leap Documentation" /><link rel="up" href="part.local_security.html" title="Part II. Local Security" /><link rel="prev" href="cha.security.yast_security.html" title="Chapter 8. Configuring Security Settings with YaST" /><link rel="next" href="cha.security.acls.html" title="Chapter 10. Access Control Lists in Linux" /><script type="text/javascript">

var protocol = window.location.protocol.toLowerCase();
if ( protocol != 'file:' ) {
  var agent = navigator.userAgent.toLowerCase();
  var wanted = ( protocol == 'https:') ? 'https' : 'http';
  var file = 'fonts.css';
  document.write('<link rel="stylesheet" type="text/css" href="' + wanted + '://static.opensuse.org/fonts/'+ file +'"></link>');
}
else {
   document.write('<link rel="stylesheet" type="text/css" href="static/css/fonts-onlylocal.css"></link>');
}

</script><noscript><link rel="stylesheet" type="text/css" href="http://static.opensuse.org/fonts/fonts.css" /></noscript><script src="static/js/jquery-1.10.2.min.js" type="text/javascript"></script><script src="static/js/script.js" type="text/javascript"></script><script src="static/js/highlight.min.js" type="text/javascript"></script><script>

$(document).ready(function() {
  $('.verbatim-wrap.highlight').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});
hljs.configure({
  useBR: false
});

</script></head><body class="draft offline js-off"><div id="_outer-wrap"><div id="_white-bg"><div id="_header"><div id="_logo"><img src="static/images/logo.png" alt="Logo" /></div><div class="crumbs"><a class="book-link" href="index.html" title="openSUSE Leap Documentation"><span class="book-icon">openSUSE Leap Documentation</span></a><span> › </span><a class="crumb" href="book.security.html">Security Guide</a><span> › </span><a class="crumb" href="part.local_security.html">Local Security</a><span> › </span><a class="crumb" href="cha.security.policykit.html">Authorization with PolKit</a></div><div class="clearme"></div></div></div><div id="_toolbar-wrap"><div id="_toolbar"><div id="_toc-area" class="inactive"><a id="_toc-area-button" class="tool" title="Contents" accesskey="c" href="index.html"><span class="tool-spacer"><span class="toc-icon">Contents</span><span class="clearme"></span></span><span class="tool-label">Contents</span></a><div class="active-contents bubble-corner"></div><div class="active-contents bubble"><div class="bubble-container"><h6>Security Guide</h6><div id="_bubble-toc"><ol><li class="inactive"><a href="preface.security.html"><span class="number"> </span><span class="name">About This Guide</span></a></li><li class="inactive"><a href="cha.security.html"><span class="number">1 </span><span class="name">Security and Confidentiality</span></a></li><li class="inactive"><a href="part.auth.html"><span class="number">I </span><span class="name">Authentication</span></a><ol><li class="inactive"><a href="cha.pam.html"><span class="number">2 </span><span class="name">Authentication with PAM</span></a></li><li class="inactive"><a href="cha.nis.html"><span class="number">3 </span><span class="name">Using NIS</span></a></li><li class="inactive"><a href="cha.security.auth.html"><span class="number">4 </span><span class="name">Setting Up Authentication Servers and Clients Using YaST</span></a></li><li class="inactive"><a href="cha.security.ldap.html"><span class="number">5 </span><span class="name">LDAP—A Directory Service</span></a></li><li class="inactive"><a href="cha.security.ad.html"><span class="number">6 </span><span class="name">Active Directory Support</span></a></li><li class="inactive"><a href="cha.security.kerberos.html"><span class="number">7 </span><span class="name">Network Authentication with Kerberos</span></a></li></ol></li><li class="inactive"><a href="part.local_security.html"><span class="number">II </span><span class="name">Local Security</span></a><ol><li class="inactive"><a href="cha.security.yast_security.html"><span class="number">8 </span><span class="name">Configuring Security Settings with YaST</span></a></li><li class="inactive"><a href="cha.security.policykit.html"><span class="number">9 </span><span class="name">Authorization with PolKit</span></a></li><li class="inactive"><a href="cha.security.acls.html"><span class="number">10 </span><span class="name">Access Control Lists in Linux</span></a></li><li class="inactive"><a href="cha.security.cryptofs.html"><span class="number">11 </span><span class="name">Encrypting Partitions and Files</span></a></li><li class="inactive"><a href="cha.certstore.html"><span class="number">12 </span><span class="name">Certificate Store</span></a></li><li class="inactive"><a href="cha.aide.html"><span class="number">13 </span><span class="name">Intrusion Detection with AIDE</span></a></li></ol></li><li class="inactive"><a href="part.network_security.html"><span class="number">III </span><span class="name">Network Security</span></a><ol><li class="inactive"><a href="cha.ssh.html"><span class="number">14 </span><span class="name">SSH: Secure Network Operations</span></a></li><li class="inactive"><a href="cha.security.firewall.html"><span class="number">15 </span><span class="name">Masquerading and Firewalls</span></a></li><li class="inactive"><a href="cha.security.vpnserver.html"><span class="number">16 </span><span class="name">Configuring a VPN Server</span></a></li><li class="inactive"><a href="cha.security.yast_ca.html"><span class="number">17 </span><span class="name">Managing X.509 Certification</span></a></li></ol></li><li class="inactive"><a href="part.apparmor.html"><span class="number">IV </span><span class="name">Confining Privileges with <span class="phrase">AppArmor</span></span></a><ol><li class="inactive"><a href="cha.apparmor.intro.html"><span class="number">18 </span><span class="name">Introducing <span class="phrase">AppArmor</span></span></a></li><li class="inactive"><a href="cha.apparmor.start.html"><span class="number">19 </span><span class="name">Getting Started</span></a></li><li class="inactive"><a href="cha.apparmor.concept.html"><span class="number">20 </span><span class="name">Immunizing Programs</span></a></li><li class="inactive"><a href="cha.apparmor.profiles.html"><span class="number">21 </span><span class="name">Profile Components and Syntax</span></a></li><li class="inactive"><a href="cha.apparmor.repos.html"><span class="number">22 </span><span class="name"><span class="phrase">AppArmor</span> Profile Repositories</span></a></li><li class="inactive"><a href="cha.apparmor.yast.html"><span class="number">23 </span><span class="name">Building and Managing Profiles with YaST</span></a></li><li class="inactive"><a href="cha.apparmor.commandline.html"><span class="number">24 </span><span class="name">Building Profiles from the Command Line</span></a></li><li class="inactive"><a href="cha.apparmor.hat.html"><span class="number">25 </span><span class="name">Profiling Your Web Applications Using ChangeHat</span></a></li><li class="inactive"><a href="cha.apparmor.pam.html"><span class="number">26 </span><span class="name">Confining Users with <code class="systemitem">pam_apparmor</code></span></a></li><li class="inactive"><a href="cha.apparmor.managing.html"><span class="number">27 </span><span class="name">Managing Profiled Applications</span></a></li><li class="inactive"><a href="cha.apparmor.support.html"><span class="number">28 </span><span class="name">Support</span></a></li><li class="inactive"><a href="cha.apparmor.glossary.html"><span class="number">29 </span><span class="name"><span class="phrase">AppArmor</span> Glossary</span></a></li></ol></li><li class="inactive"><a href="bk04pt05.html"><span class="number">V </span><span class="name">SELinux</span></a><ol><li class="inactive"><a href="cha.selinux.html"><span class="number">30 </span><span class="name">Configuring SELinux</span></a></li></ol></li><li class="inactive"><a href="part.audit.html"><span class="number">VI </span><span class="name"><em class="citetitle ">The Linux Audit Framework</em></span></a><ol><li class="inactive"><a href="cha.audit.comp.html"><span class="number">31 </span><span class="name">Understanding Linux Audit</span></a></li><li class="inactive"><a href="cha.audit.setup.html"><span class="number">32 </span><span class="name">Setting Up the Linux Audit Framework</span></a></li><li class="inactive"><a href="cha.audit.scenarios.html"><span class="number">33 </span><span class="name">Introducing an Audit Rule Set</span></a></li><li class="inactive"><a href="cha.audit.moreinfo.html"><span class="number">34 </span><span class="name">Useful Resources</span></a></li></ol></li><li class="inactive"><a href="bk04apa.html"><span class="number">A </span><span class="name">GNU Licenses</span></a></li></ol></div><div class="clearme"></div></div></div></div><div id="_nav-area" class="inactive"><div class="tool"><span class="nav-inner"><span class="tool-label">Navigation</span><a accesskey="p" class="tool-spacer" title="Chapter 8. Configuring Security Settings with YaST" href="cha.security.yast_security.html"><span class="prev-icon">←</span></a><a accesskey="n" class="tool-spacer" title="Chapter 10. Access Control Lists in Linux" href="cha.security.acls.html"><span class="next-icon">→</span></a></span></div></div></div></div><div id="_fixed-header-wrap" class="inactive"><div id="_fixed-header"><div class="crumbs"><a class="book-link" href="index.html" title="openSUSE Leap Documentation"><span class="book-icon">openSUSE Leap Documentation</span></a><span> › </span><a class="crumb" href="book.security.html">Security Guide</a><span> › </span><a class="crumb" href="part.local_security.html">Local Security</a><span> › </span><a class="crumb" href="cha.security.policykit.html">Authorization with PolKit</a></div><div class="buttons"><a class="top-button button" href="#">Top</a><div class="button"><a accesskey="p" class="tool-spacer" title="Chapter 8. Configuring Security Settings with YaST" href="cha.security.yast_security.html"><span class="prev-icon">←</span></a><a accesskey="n" class="tool-spacer" title="Chapter 10. Access Control Lists in Linux" href="cha.security.acls.html"><span class="next-icon">→</span></a></div><div class="clearme"></div></div><div class="clearme"></div></div></div><div id="_content" class="draft "><div class="documentation"><div class="chapter " id="cha.security.policykit"><div class="titlepage"><div><div class="version-info">Applies to  <span class="productname"><span class="productname"><span class="phrase">openSUSE Leap</span></span></span> <span class="productnumber"><span class="productnumber"><span class="phrase">42.2</span></span></span></div><div><h2 class="title"><span class="number">9 </span><span class="name">Authorization with PolKit</span> </h2><div class="doc-status"><ul><li><span class="ds-label">Filename: </span>security_policy_kit.xml</li><li><span class="ds-label">ID: </span>cha.security.policykit</li></ul></div></div><div><div class="abstract"><div class="abstract-title-wrap"><h6 class="abstract-title">Abstract<a title="Permalink" class="permalink" href="cha.security.policykit.html#idm140088860233760">#</a></h6></div><p>
    PolKit (formerly known as PolicyKit) is an application framework that
    acts as a negotiator between the unprivileged user session and the
    privileged system context. Whenever a process from the user session
    tries to carry out an action in the system context, PolKit is queried.
    Based on its configuration—specified in a so-called
    <span class="quote">“<span class="quote">policy</span>”</span>—the answer could be <span class="quote">“<span class="quote">yes</span>”</span>,
    <span class="quote">“<span class="quote">no</span>”</span>, or <span class="quote">“<span class="quote">needs authentication</span>”</span>. Unlike
    classical privilege authorization programs such as sudo, PolKit does
    not grant <code class="systemitem">root</code> permissions to an entire session, but only to
    the action in question.
   </p></div></div></div></div><div class="line"><div class="toc"><dl><dt><span class="sect1"><a href="cha.security.policykit.html#sec.security.policykit.oview"><span class="number">9.1 </span><span class="name">Conceptual Overview</span></a></span></dt><dt><span class="sect1"><a href="cha.security.policykit.html#sec.security.policykit.types"><span class="number">9.2 </span><span class="name">Authorization Types</span></a></span></dt><dt><span class="sect1"><a href="cha.security.policykit.html#sec.security.security.policykit.query"><span class="number">9.3 </span><span class="name">Querying Privileges</span></a></span></dt><dt><span class="sect1"><a href="cha.security.policykit.html#sec.security.policykit.change.modify_config"><span class="number">9.4 </span><span class="name">Modifying Configuration Files</span></a></span></dt><dt><span class="sect1"><a href="cha.security.policykit.html#sec.security.policykit.change.defaults"><span class="number">9.5 </span><span class="name">Restoring the Default Privileges</span></a></span></dt></dl></div></div><div class="sect1 " id="sec.security.policykit.oview"><div class="titlepage"><div><div><h2 class="title" id="sec.security.policykit.oview"><span class="number">9.1 </span><span class="name">Conceptual Overview</span> <a title="Permalink" class="permalink" href="cha.security.policykit.html#sec.security.policykit.oview">#</a></h2></div></div></div><p>

   PolKit works by limiting specific actions by users, by group, or by
   name. It then defines how those users are allowed to perform this
   action.
  </p><div class="sect2 " id="sec.security.policykit.agents"><div class="titlepage"><div><div><h3 class="title" id="sec.security.policykit.agents"><span class="number">9.1.1 </span><span class="name">Available Authentication Agents</span> <a title="Permalink" class="permalink" href="cha.security.policykit.html#sec.security.policykit.agents">#</a></h3></div></div></div><p>
    When a user starts a session (using the graphical environment or on the
    console), each session consists of the
    <span class="emphasis"><em>authority</em></span> and an <span class="emphasis"><em>authentication
    agent</em></span>. The authority is implemented as a service on the
    system message bus, whereas the authentication agent is used to
    authenticate the current user, which started the session. The current
    user needs to prove their authenticity, for example, using a passphrase.
   </p><p>
    Each desktop environment has its own authentication agent. Usually it is
    started automatically, whatever environment you choose.
   </p></div><div class="sect2 " id="sec.security.policykit.structure"><div class="titlepage"><div><div><h3 class="title" id="sec.security.policykit.structure"><span class="number">9.1.2 </span><span class="name">Structure of PolKit</span> <a title="Permalink" class="permalink" href="cha.security.policykit.html#sec.security.policykit.structure">#</a></h3></div></div></div><p>
    PolKit's configuration depends on <span class="emphasis"><em>actions</em></span> and
    <span class="emphasis"><em>authorization rules</em></span>:
   </p><div class="variablelist "><dl class="variablelist"><dt id="idm140088860220064"><span class="term ">Actions (file extension <code class="filename">*.policy</code>)</span></dt><dd><p>
       Written as XML files and located in
       <code class="filename">/usr/share/polkit-1/actions</code>. Each file defines
       one or more actions, and each action contains descriptions and
       default permissions. Although a system administrator can write their
       own rules, PolKit's files must not be edited.
      </p></dd><dt id="idm140088860217104"><span class="term ">Authorization Rules (file extension <code class="filename">*.rules</code>)</span></dt><dd><p>
       Written as JavaScript files and located in two places:
       <code class="filename">/usr/share/polkit-1/rules.d </code> is used for third
       party packages and <code class="filename">/etc/polkit-1/rules.d</code> for
       local configurations. Each rule file refers to the action specified
       in the action file. A rule determines what restrictions are allowed
       to a subset of users. For example, a rule file could overrule a
       restrictive permission and allow some users to allow it.
      </p></dd></dl></div></div><div class="sect2 " id="sec.security.policykit.oview.commands"><div class="titlepage"><div><div><h3 class="title" id="sec.security.policykit.oview.commands"><span class="number">9.1.3 </span><span class="name">Available Commands</span> <a title="Permalink" class="permalink" href="cha.security.policykit.html#sec.security.policykit.oview.commands">#</a></h3></div></div></div><p>
    PolKit contains several commands for specific tasks (see also the
    specific man page for further details):
   </p><div class="variablelist "><dl class="variablelist"><dt id="idm140088860211168"><span class="term "><code class="command">pkaction</code>
     </span></dt><dd><p>
       Get details about a defined action. See
       <a class="xref" href="cha.security.policykit.html#sec.security.security.policykit.query" title="9.3. Querying Privileges">Section 9.3, “Querying Privileges”</a> for more
       information.
      </p></dd><dt id="idm140088860208512"><span class="term "><code class="command">pkcheck</code>
     </span></dt><dd><p>
       Checks whether a process is authorized, specified by either
       <code class="option">--process</code> or <code class="option">--system-bus-name</code>.
      </p></dd><dt id="idm140088860205472"><span class="term "><code class="command">pkexec</code>
     </span></dt><dd><p>
       Allows an authorized user to execute the specific program as another
       user.
      </p></dd><dt id="idm140088860203312"><span class="term "><code class="command">pkttyagent</code>
     </span></dt><dd><p>
       Starts a textual authentication agent. This agent is used if a
       desktop environment does not have its own authentication agent.
      </p></dd></dl></div></div><div class="sect2 " id="sec.security.policykit.oview.authorizations"><div class="titlepage"><div><div><h3 class="title" id="sec.security.policykit.oview.authorizations"><span class="number">9.1.4 </span><span class="name">Available Policies and Supported Applications</span> <a title="Permalink" class="permalink" href="cha.security.policykit.html#sec.security.policykit.oview.authorizations">#</a></h3></div></div></div><p>
    At the moment, not all applications requiring privileges use
    PolKit. Find the most important policies available on
    <span class="productname"><span class="phrase">openSUSE® Leap</span></span> below, sorted into the categories where they are
    used.
   </p><div class="variablelist "><dl class="variablelist"><dt id="idm140088860197504"><span class="term ">PulseAudio</span></dt><dd><table border="0" summary="Simple list" class="simplelist "><tr><td>Set scheduling priorities for the PulseAudio daemon</td></tr></table></dd><dt id="idm140088860195232"><span class="term ">CUPS</span></dt><dd><table border="0" summary="Simple list" class="simplelist "><tr><td>Add, remove, edit, enable or disable printers</td></tr></table></dd><dt id="idm140088860192960"><span class="term ">Backup Manager</span></dt><dd><table border="0" summary="Simple list" class="simplelist "><tr><td>Modify schedule</td></tr></table></dd><dt id="idm140088860190448"><span class="term ">GNOME</span></dt><dd><table border="0" summary="Simple list" class="simplelist "><tr><td>Modify system and mandatory values with GConf</td></tr><tr><td>Change the system time</td></tr></table></dd><dt id="idm140088860187728"><span class="term ">libvirt</span></dt><dd><table border="0" summary="Simple list" class="simplelist "><tr><td>Manage and monitor local virtualized systems</td></tr></table></dd><dt id="idm140088860185184"><span class="term ">NetworkManager</span></dt><dd><table border="0" summary="Simple list" class="simplelist "><tr><td>Apply and modify connections</td></tr></table></dd><dt id="idm140088860182656"><span class="term ">PolKit</span></dt><dd><table border="0" summary="Simple list" class="simplelist "><tr><td>Read and change privileges for other users</td></tr><tr><td>Modify defaults</td></tr></table></dd><dt id="idm140088860179936"><span class="term ">PackageKit</span></dt><dd><table border="0" summary="Simple list" class="simplelist "><tr><td>Update and remove packages</td></tr><tr><td>Change and refresh repositories</td></tr><tr><td>Install local files</td></tr><tr><td>Rollback</td></tr><tr><td>Import repository keys</td></tr><tr><td>Accepting EULAs</td></tr><tr><td>Setting the network proxy</td></tr></table></dd><dt id="idm140088860174960"><span class="term ">System</span></dt><dd><table border="0" summary="Simple list" class="simplelist "><tr><td>Wake on LAN</td></tr><tr><td>Mount or unmount fixed, hotpluggable and encrypted
       devices</td></tr><tr><td>Eject and decrypt removable media</td></tr><tr><td>Enable or disable WLAN</td></tr><tr><td>Enable or disable Bluetooth</td></tr><tr><td>Device access</td></tr><tr><td>Stop, suspend, hibernate and restart the system</td></tr><tr><td>Undock a docking station</td></tr><tr><td>Change power-management settings</td></tr></table></dd><dt id="idm140088860168992"><span class="term ">YaST</span></dt><dd><table border="0" summary="Simple list" class="simplelist "><tr><td>Register product</td></tr><tr><td>Change the system time and language</td></tr></table></dd></dl></div></div></div><div class="sect1 " id="sec.security.policykit.types"><div class="titlepage"><div><div><h2 class="title" id="sec.security.policykit.types"><span class="number">9.2 </span><span class="name">Authorization Types</span> <a title="Permalink" class="permalink" href="cha.security.policykit.html#sec.security.policykit.types">#</a></h2></div></div></div><p>
   Every time a PolKit-enabled process carries out a privileged operation,
   PolKit is asked whether this process is entitled to do so. PolKit
   answers according to the policy defined for this process. The answers can
   be <code class="literal">yes</code>, <code class="literal">no</code>, or
   <code class="literal">authentication needed</code>. By default, a policy contains
   <code class="literal">implicit</code> privileges, which automatically apply to all
   users. It is also possible to specify <code class="literal">explicit</code>
   privileges which apply to a specific user.
  </p><div class="sect2 " id="sec.security.policykit.policies.implicit"><div class="titlepage"><div><div><h3 class="title" id="sec.security.policykit.policies.implicit"><span class="number">9.2.1 </span><span class="name">Implicit Privileges</span> <a title="Permalink" class="permalink" href="cha.security.policykit.html#sec.security.policykit.policies.implicit">#</a></h3></div></div></div><p>
    Implicit privileges can be defined for any active and inactive sessions.
    An active session is the one in which you are currently working. It
    becomes inactive when you switch to another console for example. When
    setting implicit privileges to <span class="quote">“<span class="quote">no</span>”</span>, no user is authorized,
    whereas <span class="quote">“<span class="quote">yes</span>”</span> authorizes all users. However, usually
    it is useful to demand authentication.
   </p><p>
    A user can either authorize by authenticating as <code class="systemitem">root</code> or by
    authenticating as self. Both authentication methods exist in four
    variants:
   </p><div class="variablelist "><dl class="variablelist"><dt id="idm140088860157200"><span class="term ">Authentication</span></dt><dd><p>
       The user always needs to authenticate.
      </p></dd><dt id="idm140088860155376"><span class="term ">One Shot Authentication</span></dt><dd><p>
       The authentication is bound to the instance of the program currently
       running. After the program is restarted, the user is required to
       authenticate again.
      </p></dd><dt id="idm140088860153424"><span class="term ">Keep Session Authentication</span></dt><dd><p>
       The authentication dialog offers a check button <span class="guimenu">Remember
       authorization for this session</span>. If checked, the
       authentication is valid until the user logs out.
      </p></dd><dt id="idm140088860151024"><span class="term ">Keep Indefinitely Authentication</span></dt><dd><p>
       The authentication dialog offers a check button <span class="guimenu">Remember
       authorization</span>. If checked, the user needs to authenticate
       only once.
      </p></dd></dl></div></div><div class="sect2 " id="sec.security.policykit.policies.explicit"><div class="titlepage"><div><div><h3 class="title" id="sec.security.policykit.policies.explicit"><span class="number">9.2.2 </span><span class="name">Explicit Privileges</span> <a title="Permalink" class="permalink" href="cha.security.policykit.html#sec.security.policykit.policies.explicit">#</a></h3></div></div></div><p>
    Explicit privileges can be granted to specific users. They can either be
    granted without limitations, or, when using constraints, limited to an
    active session and/or a local console.
   </p><p>
    It is not only possible to grant privileges to a user, a user can also
    be blocked. Blocked users cannot carry out an action
    requiring authorization, even though the default implicit policy allows
    authorization by authentication.
   </p></div><div class="sect2 " id="sec.security.policykit.policies.default"><div class="titlepage"><div><div><h3 class="title" id="sec.security.policykit.policies.default"><span class="number">9.2.3 </span><span class="name">Default Privileges</span> <a title="Permalink" class="permalink" href="cha.security.policykit.html#sec.security.policykit.policies.default">#</a></h3></div></div></div><p>
    Each application supporting PolKit comes with a default set of implicit
    policies defined by the application's developers. Those policies are the
    so-called <span class="quote">“<span class="quote">upstream defaults</span>”</span>. The privileges defined by
    the upstream defaults are not necessarily the ones that are activated by
    default on SUSE systems. <span class="productname"><span class="phrase">openSUSE Leap</span></span> comes with a predefined
    set of privileges that override the upstream defaults:
   </p><div class="variablelist "><dl class="variablelist"><dt id="idm140088860141808"><span class="term "><code class="filename">/etc/polkit-default-privs.standard</code>
     </span></dt><dd><p>
       Defines privileges suitable for most desktop
       systems
      </p></dd><dt id="idm140088860139696"><span class="term "><code class="filename">/etc/polkit-default-privs.restrictive</code>
     </span></dt><dd><p>
       Designed for machines administrated centrally
      </p></dd></dl></div><p>
    To switch between the two sets of default privileges, adjust the value
    of <code class="varname">POLKIT_DEFAULT_PRIVS</code> to either
    <code class="literal">restrictive</code> or <code class="literal">standard</code> in
    <code class="filename">/etc/sysconfig/security</code>. Then run the command
    <code class="command">set_polkit_default_privs</code> as <code class="systemitem">root</code>.
   </p><p>
    Do not modify the two files in the list above. To define your
    own custom set of privileges, use
    <code class="filename">/etc/polkit-default-privs.local</code>. For details, refer
    to
    <a class="xref" href="cha.security.policykit.html#sec.security.policykit.change.modify_config.implicit" title="9.4.3. Modifying Configuration Files for Implicit Privileges">Section 9.4.3, “Modifying Configuration Files for Implicit Privileges”</a>.
   </p></div></div><div class="sect1 " id="sec.security.security.policykit.query"><div class="titlepage"><div><div><h2 class="title" id="sec.security.security.policykit.query"><span class="number">9.3 </span><span class="name">Querying Privileges</span> <a title="Permalink" class="permalink" href="cha.security.policykit.html#sec.security.security.policykit.query">#</a></h2></div></div></div><p>
   To query privileges use the command <code class="command">pkaction</code> included
   in PolKit.
  </p><p>
   PolKit comes with command line tools for changing privileges and
   executing commands as another user (see
   <a class="xref" href="cha.security.policykit.html#sec.security.policykit.oview.commands" title="9.1.3. Available Commands">Section 9.1.3, “Available Commands”</a> for a short
   overview). Each existing policy has a speaking, unique name with which it
   can be identified. List all available policies with the command
   <code class="command">pkaction</code>.
  </p><p>
   When invoked with no parameters, the command <code class="command">pkaction</code>
   lists all policies. By adding the
   <code class="option">--show-overrides</code> option, you can list all policies that
   differ from the default values. To reset the privileges for a given
   action to the (upstream) defaults, use the option
   <code class="option">--reset-defaults <em class="replaceable ">ACTION</em></code>.
   See <code class="command">man pkaction</code> for more information.
  </p><p>
   If you want to display the needed authorization for a given policy (for
   example, <code class="literal">org.freedesktop.login1.reboot</code>) use
   <code class="command">pkaction</code> as follows:
  </p><div class="verbatim-wrap"><pre class="screen">pkaction -v --action-id org.freedesktop.login1.reboot
org.freedesktop.login1.reboot:
  description:       Reboot the system
  message:           Authentication is required to allow rebooting the system
  vendor:            The systemd Project
  vendor_url:        http://www.freedesktop.org/wiki/Software/systemd
  icon:
  implicit any:      auth_admin_keep
  implicit inactive: auth_admin_keep
  implicit active:   yes</pre></div><p>
   The keyword <code class="literal">auth_admin_keep</code> means that users need to
   enter a passphrase.
  </p><div id="idm140088860122128" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note: Restrictions of <code class="command">pkaction</code> on <span class="productname"><span class="phrase">openSUSE Leap</span></span></h6><p>
    <code class="command">pkaction</code> always operates on the upstream defaults.
    Therefore it cannot be used to list or restore the defaults shipped with
    <span class="productname"><span class="phrase">openSUSE Leap</span></span>. To do so, refer to
    <a class="xref" href="cha.security.policykit.html#sec.security.policykit.change.defaults" title="9.5. Restoring the Default Privileges">Section 9.5, “Restoring the Default Privileges”</a>.
   </p></div></div><div class="sect1 " id="sec.security.policykit.change.modify_config"><div class="titlepage"><div><div><h2 class="title" id="sec.security.policykit.change.modify_config"><span class="number">9.4 </span><span class="name">Modifying Configuration Files</span> <a title="Permalink" class="permalink" href="cha.security.policykit.html#sec.security.policykit.change.modify_config">#</a></h2></div></div></div><p>
   Adjusting privileges by modifying configuration files is useful when you
   want to deploy the same set of policies to different machines, for
   example to the computers of a specific team. It is possible to change
   implicit and explicit privileges by modifying configuration files.
  </p><div class="sect2 " id="sec.security.policykit.change.modify_config.actions"><div class="titlepage"><div><div><h3 class="title" id="sec.security.policykit.change.modify_config.actions"><span class="number">9.4.1 </span><span class="name">Adding Action Rules</span> <a title="Permalink" class="permalink" href="cha.security.policykit.html#sec.security.policykit.change.modify_config.actions">#</a></h3></div></div></div><p>
    The available actions depend on what additional packages you have
    installed on your system. For a quick overview, use
    <code class="command">pkaction</code> to list all defined rules.
   </p><p>
    To get an idea, the following example describes how the command
    <code class="command">gparted</code> (<span class="quote">“<span class="quote">GNOME Partition Editor</span>”</span>)
    is integrated into PolKit.
   </p><p>
    The file
    <code class="filename">/usr/share/polkit-1/actions/org.opensuse.policykit.gparted.policy</code>
    contains the following content:
   </p><div class="verbatim-wrap"><pre class="screen">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE policyconfig PUBLIC
 "-//freedesktop//DTD PolicyKit Policy Configuration 1.0//EN"
 "http://www.freedesktop.org/standards/PolicyKit/1.0/policyconfig.dtd"&gt;
&lt;policyconfig&gt; <span id="co.polkit.actions.policyconfig"></span><span class="callout">1</span>

  &lt;action id="org.opensuse.policykit.gparted"&gt; <span id="co.polkit.actions.action"></span><span class="callout">2</span>
    &lt;message&gt;Authentication is required to run the GParted Partition Editor&lt;/message&gt;
    &lt;icon_name&gt;gparted&lt;/icon_name&gt;
    &lt;defaults&gt; <span id="co.polkit.actions.defaults"></span><span class="callout">3</span>
      &lt;allow_any&gt;auth_admin&lt;/allow_any&gt;
      &lt;allow_inactive&gt;auth_admin&lt;/allow_inactive&gt;
     &lt; allow_active&gt;auth_admin&lt;/allow_active&gt;
    &lt;/defaults&gt;
    &lt;annotate <span id="co.polkit.actions.annotate"></span><span class="callout">4</span>
      key="org.freedesktop.policykit.exec.path"&gt;/usr/sbin/gparted&lt;/annotate&gt;
    &lt;annotate <a class="xref" href="cha.security.policykit.html#co.polkit.actions.annotate"><span class="callout">4</span></a>
      key="org.freedesktop.policykit.exec.allow_gui"&gt;true&lt;/annotate&gt;
  &lt;/action&gt;

&lt;/policyconfig&gt;</pre></div><div class="calloutlist "><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#co.polkit.actions.policyconfig"><span class="callout">1</span></a> </p></td><td valign="top" align="left"><p>
      Root element of the policy file.
     </p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#co.polkit.actions.action"><span class="callout">2</span></a> </p></td><td valign="top" align="left"><p>
      Contains one single action.
     </p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#co.polkit.actions.defaults"><span class="callout">3</span></a> </p></td><td valign="top" align="left"><p>
      The <code class="literal">defaults</code> element contains several permissions
      used in remote sessions like SSH, VNC (element
      <code class="literal">allow_inactive</code>), when logged directly into the
      machine on a TTY or X display (element
      <code class="literal">allow_active</code>), or for both (element
      <code class="literal">allow_any</code>). The value <code class="literal">auth_admin</code>
      indicates authentication is required as an administrative user.
     </p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#co.polkit.actions.annotate"><span class="callout">4</span></a> </p></td><td valign="top" align="left"><p>
      The <code class="literal">annotate</code> element contains specific information
      regarding how PolKit performs an action. In this case, it contains
      the path to the executable and states whether a GUI is allowed to open
      a X display.
     </p></td></tr></table></div><p>
    To add your own policy, create a <code class="filename">.policy</code> file with
    the structure above, add the appropriate value into the
    <code class="literal">id</code> attribute, and define the default permissions.
   </p></div><div class="sect2 " id="sec.security.policykit.change.modify_config.authrules"><div class="titlepage"><div><div><h3 class="title" id="sec.security.policykit.change.modify_config.authrules"><span class="number">9.4.2 </span><span class="name">Adding Authorization Rules</span> <a title="Permalink" class="permalink" href="cha.security.policykit.html#sec.security.policykit.change.modify_config.authrules">#</a></h3></div></div></div><p>
    Your own authorization rules overrule the default settings. To add your
    own settings, store your files under
    <code class="filename">/etc/polkit-1/rules.d/</code>.
   </p><p>
    The files in this directory start with a two-digit number, followed by a
    descriptive name, and end with <code class="filename">.rules</code>. Functions
    inside these files are executed in the order they have been sorted in.
    For example, <code class="filename">00-foo.rules</code> is sorted (and hence
    executed) before <code class="filename">60-bar.rules</code> or even
    <code class="filename">90-default-privs.rules</code>.
   </p><p>
    Inside the file, the script checks for the specified action ID, which is
    defined in the <code class="filename">.policy</code> file. For example, if you
    want to allow the command <code class="command">gparted</code> to be executed by
    any member of the <code class="systemitem">admin</code>
    group, check for the action ID
    <code class="literal">org.opensuse.policykit.gparted</code>:
   </p><div class="verbatim-wrap"><pre class="screen">/* Allow users in admin group to run GParted without authentication */
polkit.addRule(function(action, subject) {
    if (action.id == "org.opensuse.policykit.gparted" &amp;&amp;
        subject.isInGroup("admin")) {
        return polkit.Result.YES;
    }
});</pre></div><p>
    Find the description of all classes and methods of the functions in the
    PolKit API at
    <a class="link" href="http://www.freedesktop.org/software/polkit/docs/latest/ref-api.html" target="_blank">http://www.freedesktop.org/software/polkit/docs/latest/ref-api.html</a>.
   </p></div><div class="sect2 " id="sec.security.policykit.change.modify_config.implicit"><div class="titlepage"><div><div><h3 class="title" id="sec.security.policykit.change.modify_config.implicit"><span class="number">9.4.3 </span><span class="name">Modifying Configuration Files for Implicit Privileges</span> <a title="Permalink" class="permalink" href="cha.security.policykit.html#sec.security.policykit.change.modify_config.implicit">#</a></h3></div></div></div><p>
    <span class="productname"><span class="phrase">openSUSE Leap</span></span> ships with two sets of default authorizations, located
    in <code class="filename">/etc/polkit-default-privs.standard</code> and
    <code class="filename">/etc/polkit-default-privs.restrictive</code>. For more
    information, refer to
    <a class="xref" href="cha.security.policykit.html#sec.security.policykit.policies.default" title="9.2.3. Default Privileges">Section 9.2.3, “Default Privileges”</a>.
   </p><p>
    Custom privileges are defined in
    <code class="filename">/etc/polkit-default-privs.local</code>. Privileges defined
    here will always take precedence over the ones defined in the other
    configuration files. To define your custom set of privileges,
    do the following:
   </p><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
      Open <code class="filename">/etc/polkit-default-privs.local</code>. To define a
      privilege, add a line for each policy with the following format:
     </p><div class="verbatim-wrap"><pre class="screen"><em class="replaceable ">&lt;privilege_identifier&gt;</em>     <em class="replaceable ">&lt;any session&gt;</em>:<em class="replaceable ">&lt;inactive session&gt;</em>:<em class="replaceable ">&lt;active session&gt;</em></pre></div><p>
      For example:
     </p><div class="verbatim-wrap"><pre class="screen">org.freedesktop.policykit.modify-defaults     auth_admin_keep_always</pre></div><p>
      The following values are valid for the
      <em class="replaceable ">session</em> placeholders:
     </p><div class="variablelist "><dl class="variablelist"><dt id="idm140088860075136"><span class="term "><code class="literal">yes</code>
       </span></dt><dd><p>
         grant privilege
        </p></dd><dt id="idm140088860073040"><span class="term "><code class="literal">no</code>
       </span></dt><dd><p>
         block
        </p></dd><dt id="idm140088860070944"><span class="term "><code class="literal">auth_self</code>
       </span></dt><dd><p>
         user needs to authenticate with own password every time the
         privilege is requested
        </p></dd><dt id="idm140088860068768"><span class="term "><code class="literal">auth_self_keep_session</code>
       </span></dt><dd><p>
         user needs to authenticate with own password once per session,
         privilege is granted for the whole session
        </p></dd><dt id="idm140088860066576"><span class="term "><code class="literal">auth_self_keep_always</code>
       </span></dt><dd><p>
         user needs to authenticate with own password once, privilege is
         granted for the current and for future sessions
        </p></dd><dt id="idm140088860064368"><span class="term "><code class="literal">auth_admin</code>
       </span></dt><dd><p>
         user needs to authenticate with <code class="systemitem">root</code> password every time
         the privilege is requested
        </p></dd><dt id="idm140088860061488"><span class="term "><code class="literal">auth_admin_keep_session</code>
       </span></dt><dd><p>
         user needs to authenticate with <code class="systemitem">root</code> password once per
         session, privilege is granted for the whole session
        </p></dd><dt id="idm140088860058576"><span class="term "><code class="literal">auth_admin_keep_always</code>
       </span></dt><dd><p>
         user needs to authenticate with <code class="systemitem">root</code> password once,
         privilege is granted for the current and for future sessions
        </p></dd></dl></div></li><li class="step "><p>
      Run as <code class="systemitem">root</code> for changes to take effect:
     </p><div class="verbatim-wrap"><pre class="screen"># /sbin/set_polkit_default_privs</pre></div></li><li class="step "><p>
      Optionally check the list of all privilege identifiers with the
      command <code class="command">pkaction</code>.
     </p></li></ol></div></div></div></div><div class="sect1 " id="sec.security.policykit.change.defaults"><div class="titlepage"><div><div><h2 class="title" id="sec.security.policykit.change.defaults"><span class="number">9.5 </span><span class="name">Restoring the Default Privileges</span> <a title="Permalink" class="permalink" href="cha.security.policykit.html#sec.security.policykit.change.defaults">#</a></h2></div></div></div><p>
   <span class="productname"><span class="phrase">openSUSE Leap</span></span> comes with a predefined set of privileges that is
   activated by default and thus overrides the upstream defaults. For
   details, refer to
   <a class="xref" href="cha.security.policykit.html#sec.security.policykit.policies.default" title="9.2.3. Default Privileges">Section 9.2.3, “Default Privileges”</a>.
  </p><p>
   Since the graphical PolKit tools and the command line tools always
   operate on the upstream defaults, <span class="productname"><span class="phrase">openSUSE Leap</span></span> includes an additional
   command-line tool, <code class="command">set_polkit_default_privs</code>. It resets
   privileges to the values defined in
   <code class="filename">/etc/polkit-default-privs.*</code>. However, the command
   <code class="command">set_polkit_default_privs</code> will only reset policies that
   are set to the upstream defaults.
  </p><div class="procedure " id="idm140088860044688"><div class="procedure-title-wrap"><h6 class="procedure-title"><span class="number">Procedure 9.1: </span><span class="name">Restoring the <span class="productname"><span class="phrase">openSUSE Leap</span></span> Defaults </span><a title="Permalink" class="permalink" href="cha.security.policykit.html#idm140088860044688">#</a></h6></div><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
     Make sure <code class="filename">/etc/polkit-default-privs.local</code> does not
     contain any overrides of the default policies.
    </p><div id="idm140088860041584" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.png" /><h6>Important: Custom Policy Configuration</h6><p>
      Policies defined in
      <code class="filename">/etc/polkit-default-privs.local</code> will be applied
      on top of the defaults during the next step.
     </p></div></li><li class="step "><p>
     To reset all policies to the upstream defaults first and then apply the
     <span class="productname"><span class="phrase">openSUSE Leap</span></span> defaults:
    </p><div class="verbatim-wrap"><pre class="screen">rm -f /var/lib/polkit/* &amp;&amp; set_polkit_default_privs</pre></div></li></ol></div></div></div></div></div><div class="page-bottom"><div id="_bottom-navigation"><a class="nav-link" href="cha.security.acls.html"><span class="next-icon">→</span><span class="nav-label"><span class="number">Chapter 10 </span>Access Control Lists in Linux</span></a><a class="nav-link" href="cha.security.yast_security.html"><span class="prev-icon">←</span><span class="nav-label"><span class="number">Chapter 8 </span>Configuring Security Settings with YaST</span></a></div><div id="_share-print"><div class="online-contents share"><strong>Share this page: </strong><span class="share-buttons"><span id="_share-fb" class="bottom-button">Facebook</span><span class="spacer"> • </span><span id="_share-gp" class="bottom-button">Google+</span><span class="spacer"> • </span><span id="_share-tw" class="bottom-button">Twitter</span></span></div><div class="print"><span id="_print-button" class="bottom-button">Print this page</span></div><div class="clearme"></div></div></div></div><div id="_inward"></div></div><div id="_footer-wrap"><div id="_footer"><p>©
        2018 
        SUSE</p></div></div></body></html>