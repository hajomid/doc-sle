<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang=""><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>NVMe over Fabric | Storage Administration Guide | SUSE Linux Enterprise Server 12 SP3</title><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" /><link rel="stylesheet" type="text/css" href="static/css/style.css" /><link rel="stylesheet" type="text/css" href="static/css/highlight.css" /><meta name="generator" content="DAPS 2.4.0 using SUSE XSL Stylesheets 2.0.8 (based on DocBook XSL Stylesheets 1.78.1) - chunked" /><meta name="product-name" content="SUSE Linux Enterprise Server" /><meta name="product-number" content="12 SP3" /><meta name="book-title" content="Storage Administration Guide" /><meta name="chapter-title" content="Chapter 16. NVMe over Fabric" /><meta name="description" content="This chapter describes how to set up an NVMe over Fabric host and target." /><meta name="tracker-url" content="https://bugzilla.suse.com/enter_bug.cgi" /><meta name="tracker-type" content="bsc" /><meta name="tracker-bsc-assignee" content="fs@suse.com" /><meta name="tracker-bsc-component" content="Documentation" /><meta name="tracker-bsc-product" content="SUSE Linux Enterprise Server 12 SP3" /><link rel="home" href="index.html" title="SUSE Linux Enterprise Server Documentation" /><link rel="up" href="part.net_storage.html" title="Part IV. Network Storage" /><link rel="prev" href="cha.fcoe.html" title="Chapter 15. Fibre Channel Storage over Ethernet Networks: FCoE" /><link rel="next" href="cha.multipath.html" title="Chapter 17. Managing Multipath I/O for Devices" /><script type="text/javascript">

var protocol = window.location.protocol.toLowerCase();
if ( protocol != 'file:' ) {
  var agent = navigator.userAgent.toLowerCase();
  var wanted = ( protocol == 'https:') ? 'https' : 'http';
  var file = 'fonts.css';
  document.write('<link rel="stylesheet" type="text/css" href="' + wanted + '://static.opensuse.org/fonts/'+ file +'"></link>');
}
else {
   document.write('<link rel="stylesheet" type="text/css" href="static/css/fonts-onlylocal.css"></link>');
}

</script><noscript><link rel="stylesheet" type="text/css" href="http://static.opensuse.org/fonts/fonts.css" /></noscript><script src="static/js/jquery-1.10.2.min.js" type="text/javascript"></script><script src="static/js/script.js" type="text/javascript"></script><script src="static/js/highlight.min.js" type="text/javascript"></script><script>

$(document).ready(function() {
  $('.verbatim-wrap.highlight').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});
hljs.configure({
  useBR: false
});

</script></head><body class="draft offline js-off"><div id="_outer-wrap"><div id="_white-bg"><div id="_header"><div id="_logo"><img src="static/images/logo.png" alt="Logo" /></div><div class="crumbs"><a class="book-link" href="index.html" title="SUSE Linux Enterprise Server Documentation"><span class="book-icon">SUSE Linux Enterprise Server Documentation</span></a><span> › </span><a class="crumb" href="stor_admin.html">Storage Administration Guide</a><span> › </span><a class="crumb" href="part.net_storage.html">Network Storage</a><span> › </span><a class="crumb" href="cha.nvmeof.html">NVMe over Fabric</a></div><div class="clearme"></div></div></div><div id="_toolbar-wrap"><div id="_toolbar"><div id="_toc-area" class="inactive"><a id="_toc-area-button" class="tool" title="Contents" accesskey="c" href="index.html"><span class="tool-spacer"><span class="toc-icon">Contents</span><span class="clearme"></span></span><span class="tool-label">Contents</span></a><div class="active-contents bubble-corner"></div><div class="active-contents bubble"><div class="bubble-container"><h6>Storage Administration Guide</h6><div id="_bubble-toc"><ol><li class="inactive"><a href="storage.preface.html"><span class="number"> </span><span class="name">About This Guide</span></a></li><li class="inactive"><a href="part.filesystems.html"><span class="number">I </span><span class="name">File Systems and Mounting</span></a><ol><li class="inactive"><a href="cha.filesystems.html"><span class="number">1 </span><span class="name">Overview of File Systems in Linux</span></a></li><li class="inactive"><a href="cha.resize_fs.html"><span class="number">2 </span><span class="name">Resizing File Systems</span></a></li><li class="inactive"><a href="cha.uuid.html"><span class="number">3 </span><span class="name">Using UUIDs to Mount Devices</span></a></li><li class="inactive"><a href="cha.multitiercache.html"><span class="number">4 </span><span class="name">Multi-tier Caching for Block Device Operations</span></a></li></ol></li><li class="inactive"><a href="part.lvm.html"><span class="number">II </span><span class="name">Logical Volumes (LVM)</span></a><ol><li class="inactive"><a href="cha.lvm.html"><span class="number">5 </span><span class="name">LVM Configuration</span></a></li><li class="inactive"><a href="cha.lvm_snapshots.html"><span class="number">6 </span><span class="name">LVM Volume Snapshots</span></a></li></ol></li><li class="inactive"><a href="part.software_raid.html"><span class="number">III </span><span class="name">Software RAID</span></a><ol><li class="inactive"><a href="cha.raid.html"><span class="number">7 </span><span class="name">Software RAID Configuration</span></a></li><li class="inactive"><a href="cha.raidroot.html"><span class="number">8 </span><span class="name">Configuring Software RAID for the Root Partition</span></a></li><li class="inactive"><a href="cha.raid10.html"><span class="number">9 </span><span class="name">Creating Software RAID 10 Devices</span></a></li><li class="inactive"><a href="cha.raid_degraded.html"><span class="number">10 </span><span class="name">Creating a Degraded RAID Array</span></a></li><li class="inactive"><a href="cha.raid_resize.html"><span class="number">11 </span><span class="name">Resizing Software RAID Arrays with mdadm</span></a></li><li class="inactive"><a href="cha.raid_leds.html"><span class="number">12 </span><span class="name">Storage Enclosure LED Utilities for MD Software RAIDs</span></a></li></ol></li><li class="inactive"><a href="part.net_storage.html"><span class="number">IV </span><span class="name">Network Storage</span></a><ol><li class="inactive"><a href="cha.isns.html"><span class="number">13 </span><span class="name">iSNS for Linux</span></a></li><li class="inactive"><a href="cha.iscsi.html"><span class="number">14 </span><span class="name">Mass Storage over IP Networks: iSCSI</span></a></li><li class="inactive"><a href="cha.fcoe.html"><span class="number">15 </span><span class="name">Fibre Channel Storage over Ethernet Networks: FCoE</span></a></li><li class="inactive"><a href="cha.nvmeof.html"><span class="number">16 </span><span class="name">NVMe over Fabric</span></a></li><li class="inactive"><a href="cha.multipath.html"><span class="number">17 </span><span class="name">Managing Multipath I/O for Devices</span></a></li><li class="inactive"><a href="cha.nfs4_acls.html"><span class="number">18 </span><span class="name">Managing Access Control Lists over NFSv4</span></a></li></ol></li><li class="inactive"><a href="app.storage.docupdates.html"><span class="number">A </span><span class="name">Documentation Updates</span></a></li><li class="inactive"><a href="bk08apb.html"><span class="number">B </span><span class="name">GNU Licenses</span></a></li></ol></div><div class="clearme"></div></div></div></div><div id="_nav-area" class="inactive"><div class="tool"><span class="nav-inner"><span class="tool-label">Navigation</span><a accesskey="p" class="tool-spacer" title="Chapter 15. Fibre Channel Storage over Ethernet Networks: FCoE" href="cha.fcoe.html"><span class="prev-icon">←</span></a><a accesskey="n" class="tool-spacer" title="Chapter 17. Managing Multipath I/O for Devices" href="cha.multipath.html"><span class="next-icon">→</span></a></span></div></div></div></div><div id="_fixed-header-wrap" class="inactive"><div id="_fixed-header"><div class="crumbs"><a class="book-link" href="index.html" title="SUSE Linux Enterprise Server Documentation"><span class="book-icon">SUSE Linux Enterprise Server Documentation</span></a><span> › </span><a class="crumb" href="stor_admin.html">Storage Administration Guide</a><span> › </span><a class="crumb" href="part.net_storage.html">Network Storage</a><span> › </span><a class="crumb" href="cha.nvmeof.html">NVMe over Fabric</a></div><div class="buttons"><a class="top-button button" href="#">Top</a><div class="button"><a accesskey="p" class="tool-spacer" title="Chapter 15. Fibre Channel Storage over Ethernet Networks: FCoE" href="cha.fcoe.html"><span class="prev-icon">←</span></a><a accesskey="n" class="tool-spacer" title="Chapter 17. Managing Multipath I/O for Devices" href="cha.multipath.html"><span class="next-icon">→</span></a></div><div class="clearme"></div></div><div class="clearme"></div></div></div><div id="_content" class="draft "><div class="documentation"><div xml:lang="en" class="chapter " id="cha.nvmeof" lang="en"><div class="titlepage"><div><div class="version-info">Applies to  <span class="productname"><span class="productname"><span class="phrase">SUSE Linux Enterprise Server</span></span></span> <span class="productnumber"><span class="productnumber"><span class="phrase">12 SP3</span></span></span></div><div><h2 class="title"><span class="number">16 </span><span class="name">NVMe over Fabric</span> </h2><div class="doc-status"><ul><li><span class="ds-label">Filename: </span>storage_nvmeof.xml</li><li><span class="ds-label">ID: </span>cha.nvmeof</li></ul></div></div><div><div class="abstract"><div class="abstract-title-wrap"><h6 class="abstract-title">Abstract<a title="Permalink" class="permalink" href="cha.nvmeof.html#idm140568425798992">#</a></h6></div><p>
    This chapter describes how to set up an NVMe over Fabric host and target.
   </p></div></div></div></div><div class="line"><div class="toc"><dl><dt><span class="sect1"><a href="cha.nvmeof.html#cha.nvmeof.overview"><span class="number">16.1 </span><span class="name">Overview</span></a></span></dt><dt><span class="sect1"><a href="cha.nvmeof.html#sec.nvmeof.host_configuration"><span class="number">16.2 </span><span class="name">Setting Up an NVMe over Fabric Host</span></a></span></dt><dt><span class="sect1"><a href="cha.nvmeof.html#sec.nvmeof.target_configuration"><span class="number">16.3 </span><span class="name">Setting Up an NVMe over Fabric Target</span></a></span></dt><dt><span class="sect1"><a href="cha.nvmeof.html#cha.nvmeof.hardware"><span class="number">16.4 </span><span class="name">Special Hardware Configuration</span></a></span></dt><dt><span class="sect1"><a href="cha.nvmeof.html#cha.nvmeof.more_information"><span class="number">16.5 </span><span class="name">More Information</span></a></span></dt></dl></div></div><div class="sect1 " id="cha.nvmeof.overview"><div class="titlepage"><div><div><h2 class="title" id="cha.nvmeof.overview"><span class="number">16.1 </span><span class="name">Overview</span> <a title="Permalink" class="permalink" href="cha.nvmeof.html#cha.nvmeof.overview">#</a></h2></div></div></div><p>
   <span class="emphasis"><em>NVM Express</em></span> (<span class="emphasis"><em>NVMe</em></span>) is an
   interface standard for accessing non-volatile storage, commonly SSD
   disks. NVMe supports much higher speeds and has a lower latency
   than SATA.
  </p><p>
   <span class="emphasis"><em>NVMe over Fabric</em></span> is an architecture to access NVMe
   storage over different networking fabrics, for example
   <span class="emphasis"><em>RDMA</em></span> or <span class="emphasis"><em>NVMe over Fibre
   Channel</em></span> (<span class="emphasis"><em>FC-NVMe</em></span>). The role of
   NVMe over Fabric is similar to iSCSI. To increase the fault-tolerance,
   NVMe over Fabric has a built-in support for multipathing. The NVMe over Fabric
   multipathing is not based on the traditional DM-Multipathing.
  </p><p>
   The <span class="emphasis"><em>NVMe host</em></span> is the machine that connects to
   an NVMe target. The <span class="emphasis"><em>NVMe target</em></span> is the
   machine that shares it's NVMe block devices.
  </p><p>
   NVMe is supported on SUSE Linux Enterprise Server <span class="productnumber"><span class="phrase">12 SP3</span></span>. There are Kernel
   modules available for the NVMe block storage and NVMe over Fabric target
   and host.
  </p><p>
   To see if your hardware requires any special consideration, refer to
   <a class="xref" href="cha.nvmeof.html#cha.nvmeof.hardware" title="16.4. Special Hardware Configuration">Section 16.4, “Special Hardware Configuration”</a>.
  </p></div><div class="sect1 " id="sec.nvmeof.host_configuration"><div class="titlepage"><div><div><h2 class="title" id="sec.nvmeof.host_configuration"><span class="number">16.2 </span><span class="name">Setting Up an NVMe over Fabric Host</span> <a title="Permalink" class="permalink" href="cha.nvmeof.html#sec.nvmeof.host_configuration">#</a></h2></div></div></div><p>
   To use NVMe over Fabric, a target must be available with one of the
   supported networking methods. Supported are NVMe over Fibre
   Channel and RDMA. The following sections describe how to connect a
   host to a NVMe target.
  </p><div class="sect2 " id="sec.nvmeof.host_configuration.cli"><div class="titlepage"><div><div><h3 class="title" id="sec.nvmeof.host_configuration.cli"><span class="number">16.2.1 </span><span class="name">Installing Command Line Client</span> <a title="Permalink" class="permalink" href="cha.nvmeof.html#sec.nvmeof.host_configuration.cli">#</a></h3></div></div></div><p>
    To use NVMe over Fabric, you need the <code class="command">nvme</code> command line
    tool. Install it with <code class="command">zypper</code>:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> <code class="command">zypper in nvme-cli</code></pre></div><p>
    Use <code class="command">nvme --help</code> to list all available
    subcommands. Man pages are available for <code class="command">nvme</code>
    subcommands. Consult them by executing <code class="command">man
    nvme-<em class="replaceable ">SUBCOMMAND</em></code>. For example,
    to view the man page for the <code class="option">discover</code> subcommand,
    execute <code class="command">man nvme-discover</code>.
   </p></div><div class="sect2 " id="sec.nvmeof.host_configuration.target_discovery"><div class="titlepage"><div><div><h3 class="title" id="sec.nvmeof.host_configuration.target_discovery"><span class="number">16.2.2 </span><span class="name">Discovering NVMe over Fabric Targets</span> <a title="Permalink" class="permalink" href="cha.nvmeof.html#sec.nvmeof.host_configuration.target_discovery">#</a></h3></div></div></div><p>
    To list available NVMe subsystems on the NVMe over Fabric target, you need
    the discovery controller address and service ID.
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> <code class="command">nvme discover -t <em class="replaceable ">TRANSPORT</em> -a <em class="replaceable ">DISCOVERY_CONTROLLER_ADDRESS</em> -s <em class="replaceable ">SERVICE_ID</em></code></pre></div><p>
    Replace <em class="replaceable ">TRANSPORT</em> with the underlying
    transport medium: <code class="option">loop</code>, <code class="option">rdma</code> or
    <code class="option">fc</code>. Replace
    <em class="replaceable ">DISCOVERY_CONTROLLER_ADDRESS</em> with the
    address of the discovery controller. For RDMA this should be an
    IPv4 address. Replace <em class="replaceable ">SERVICE_ID</em> with
    the transport service ID. If the service is IP based, like RDMA,
    service ID specifies the port number. For Fibre Channel, the service
    ID is not required.
   </p><p>
    The NVMe hosts only see the subsystems they are allowed to connect
    to.
   </p><p>
    Example:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> <code class="command">nvme discover -t rdma -a 10.0.0.1 -s 4420</code></pre></div><p>
    For more details, see <code class="command">man nvme-discover</code>.
   </p></div><div class="sect2 " id="sec.nvmeof.host_configuration.connect_target"><div class="titlepage"><div><div><h3 class="title" id="sec.nvmeof.host_configuration.connect_target"><span class="number">16.2.3 </span><span class="name">Connecting to NVMe over Fabric Targets</span> <a title="Permalink" class="permalink" href="cha.nvmeof.html#sec.nvmeof.host_configuration.connect_target">#</a></h3></div></div></div><p>
    After you have identified the NVMe subsystem, you can connect it
    with the <code class="command">nvme connect</code> command.
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> <code class="command">nvme connect -t <em class="replaceable ">transport</em> -a <em class="replaceable ">DISCOVERY_CONTROLLER_ADDRESS</em> -s <em class="replaceable ">SERVICE_ID</em> -n <em class="replaceable ">SUBSYSTTEM_NQN</em></code></pre></div><p>
    Replace <em class="replaceable ">TRANSPORT</em> with the underlying
    transport medium: <code class="option">loop</code>, <code class="option">rdma</code> or
    <code class="option">fc</code>.
    Replace <em class="replaceable ">DISCOVERY_CONTROLLER_ADDRESS</em> with
    the address of the discovery controller. For RDMA this should be an
    IPv4 address.
    Replace <em class="replaceable ">SERVICE_ID</em> with the transport
    service ID. If the service is IP based, like RDMA, this specifies
    the port number.
    Replace <em class="replaceable ">SUBSYSTTEM_NQN</em> with the NVMe
    qualified name of the desired subsystem as found by the discovery
    command. <span class="emphasis"><em>NQN</em></span> is the abbreviation for <span class="emphasis"><em>
    NVMe Qualified Name</em></span>. The NQN must be unique.
   </p><p>Example:</p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> <code class="command">nvme connect -t rdma -a 10.0.0.1 -s 4420 -n nqn.2014-08.com.example:nvme:nvm-subsystem-sn-d78432</code></pre></div><p>
    Alternatively, use <code class="command">nvme connect-all</code> to connect
    to all discovered namespaces. For advanced usage please see
    <code class="command">man nvme-connect</code> and <code class="command">man
    nvme-connect-all</code>.
   </p></div><div class="sect2 " id="sec.nvmeof.host_configuration.multipathing"><div class="titlepage"><div><div><h3 class="title" id="sec.nvmeof.host_configuration.multipathing"><span class="number">16.2.4 </span><span class="name">Multipathing</span> <a title="Permalink" class="permalink" href="cha.nvmeof.html#sec.nvmeof.host_configuration.multipathing">#</a></h3></div></div></div><p>
    NVMe native multipathing is enabled by default. To
    print the layout of the multipath devices, use the command
    <code class="command">nvme list-subsys</code>. To disable NVMe native
    multipathing, add <code class="option">nvme-core.multipath=N</code> as a boot
    parameter.
   </p></div></div><div class="sect1 " id="sec.nvmeof.target_configuration"><div class="titlepage"><div><div><h2 class="title" id="sec.nvmeof.target_configuration"><span class="number">16.3 </span><span class="name">Setting Up an NVMe over Fabric Target</span> <a title="Permalink" class="permalink" href="cha.nvmeof.html#sec.nvmeof.target_configuration">#</a></h2></div></div></div><div class="sect2 " id="sec.nvmeof.target_configuration.cli"><div class="titlepage"><div><div><h3 class="title" id="sec.nvmeof.target_configuration.cli"><span class="number">16.3.1 </span><span class="name">Installing Command Line Client</span> <a title="Permalink" class="permalink" href="cha.nvmeof.html#sec.nvmeof.target_configuration.cli">#</a></h3></div></div></div><p>
    To configure a NVMe over Fabric target, you need the <code class="command">nvmetcli</code> command line
    tool. Install it with <code class="command">zypper</code>:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> <code class="command">zypper in nvmetcli</code></pre></div><p>
    The current documentation for <code class="command">nvmetcli</code> is
    available at <a class="link" href="http://git.infradead.org/users/hch/nvmetcli.git/blob_plain/HEAD:/Documentation/nvmetcli.txt" target="_blank">http://git.infradead.org/users/hch/nvmetcli.git/blob_plain/HEAD:/Documentation/nvmetcli.txt</a>
   </p></div><div class="sect2 " id="sec.nvmeof.target_configuration.steps"><div class="titlepage"><div><div><h3 class="title" id="sec.nvmeof.target_configuration.steps"><span class="number">16.3.2 </span><span class="name">Configuration Steps</span> <a title="Permalink" class="permalink" href="cha.nvmeof.html#sec.nvmeof.target_configuration.steps">#</a></h3></div></div></div><p>
    The following procedure provides an example how to set up an
    NVMe over Fabric target.
   </p><p>
    The configuration is stored in a tree structure. Use the command
    <code class="command">cd</code> to navigate. Use <code class="command">ls</code> to
    list objects. You can create new objects with
    <code class="command">create</code>.
   </p><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
      Start the <code class="command">nvmectli</code> interactive shell.
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> <code class="command">nvmetcli</code></pre></div></li><li class="step "><p>
      Create a new port.
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">(nvmetcli)&gt; </code><code class="command">cd ports</code>
<code class="prompt user">(nvmetcli)&gt; </code><code class="command">create 1</code>
<code class="prompt user">(nvmetcli)&gt; </code><code class="command">ls 1/</code>
o- 1
  o- referrals
  o- subsystems</pre></div></li><li class="step "><p>Create an NVMe subsystem.</p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">(nvmetcli)&gt; </code><code class="command">cd /subsystems</code>
<code class="prompt user">(nvmetcli)&gt; </code><code class="command">create nqn.2014-08.org.nvmexpress:NVMf:uuid:c36f2c23-354d-416c-95de-f2b8ec353a82</code>
<code class="prompt user">(nvmetcli)&gt; </code><code class="command">cd nqn.2014-08.org.nvmexpress:NVMf:uuid:c36f2c23-354d-416c-95de-f2b8ec353a82/</code>
<code class="prompt user">(nvmetcli)&gt; </code><code class="command">ls</code>
o- nqn.2014-08.org.nvmexpress:NVMf:uuid:c36f2c23-354d-416c-95de-f2b8ec353a82
  o- allowed_hosts
  o- namespaces</pre></div></li><li class="step "><p>
      Create a new namespace and set an NVMe device to it.
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">(nvmetcli)&gt; </code><code class="command">cd namespaces</code>
<code class="prompt user">(nvmetcli)&gt; </code><code class="command">create 1</code>
<code class="prompt user">(nvmetcli)&gt; </code><code class="command">cd 1</code>
<code class="prompt user">(nvmetcli)&gt; </code><code class="command">set device path=/dev/nvme0n1</code>
Parameter path is now '/dev/nvme0n1'.</pre></div></li><li class="step "><p>
      Enable the previously created namespace.
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">(nvmetcli)&gt; </code><code class="command">cd ..</code>
<code class="prompt user">(nvmetcli)&gt; </code><code class="command">enable</code>
The Namespace has been enabled.</pre></div></li><li class="step "><p>
      Display the created namespace.
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">(nvmetcli)&gt; </code><code class="command">cd ..</code>
<code class="prompt user">(nvmetcli)&gt; </code><code class="command">ls</code>
o- nqn.2014-08.org.nvmexpress:NVMf:uuid:c36f2c23-354d-416c-95de-f2b8ec353a82
  o- allowed_hosts
  o- namespaces
    o- 1</pre></div></li><li class="step "><p>
      Allow all hosts to use the subsystem. Only do this in secure
      environments.
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">(nvmetcli)&gt; </code><code class="command">set attr allow_any_host=1</code>
Parameter allow_any_host is now '1'.</pre></div><p>
      Alternatively, you can allow only specific hosts to connect:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">(nvmetcli)&gt; </code><code class="command">cd nqn.2014-08.org.nvmexpress:NVMf:uuid:c36f2c23-354d-416c-95de-f2b8ec353a82/allowed_hosts/</code>
<code class="prompt user">(nvmetcli)&gt; </code><code class="command">create hostnqn</code></pre></div></li><li class="step "><p>
      List all created objects:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">(nvmetcli)&gt; </code><code class="command">cd /</code>
<code class="prompt user">(nvmetcli)&gt; </code><code class="command">ls</code>
o- /
  o- hosts
  o- ports
  | o- 1
  |   o- referrals
  |   o- subsystems
  o- subsystems
    o- nqn.2014-08.org.nvmexpress:NVMf:uuid:c36f2c23-354d-416c-95de-f2b8ec353a82
      o- allowed_hosts
      o- namespaces
        o- 1</pre></div></li><li class="step "><p>
      Make the target available via RDMA:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">(nvmetcli)&gt; </code><code class="command">cd ports/1/</code>
<code class="prompt user">(nvmetcli)&gt; </code><code class="command">set addr adrfam=ipv4 trtype=rdma traddr=10.0.0.1 trsvcid=4420</code>
Parameter trtype is now 'rdma'.
Parameter adrfam is now 'ipv4'.
Parameter trsvcid is now '4420'.
Parameter traddr is now '10.0.0.1'.</pre></div><p>
      Alternatively, you can make it available with Fibre Channel:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">(nvmetcli)&gt; </code><code class="command">cd ports/1/</code>
<code class="prompt user">(nvmetcli)&gt; </code><code class="command">set addr adrfam=fc trtype=fc traddr=nn-0x1000000044001123:pn-0x2000000055001123 trsvcid=none</code></pre></div></li></ol></div></div></div><div class="sect2 " id="sec.nvmeof.target_configuration.backup_configuration"><div class="titlepage"><div><div><h3 class="title" id="sec.nvmeof.target_configuration.backup_configuration"><span class="number">16.3.3 </span><span class="name">Back Up and Restore Target Configuration</span> <a title="Permalink" class="permalink" href="cha.nvmeof.html#sec.nvmeof.target_configuration.backup_configuration">#</a></h3></div></div></div><p>
    You can save the target configuration in a JSON file with the
    following commands:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> <code class="command">nvmetcli</code>
<code class="prompt user">(nvmetcli)&gt; </code><code class="command">saveconfig nvme-target-backup.json</code></pre></div><p>
     To restore the configuration, use:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">(nvmetcli)&gt; </code><code class="command">restore nvme-target-backup.json</code></pre></div><p>
     You can also wipe the current configuration:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">(nvmetcli)&gt; </code><code class="command">clear</code></pre></div></div></div><div class="sect1 " id="cha.nvmeof.hardware"><div class="titlepage"><div><div><h2 class="title" id="cha.nvmeof.hardware"><span class="number">16.4 </span><span class="name">Special Hardware Configuration</span> <a title="Permalink" class="permalink" href="cha.nvmeof.html#cha.nvmeof.hardware">#</a></h2></div></div></div><div class="sect2 " id="cha.nvmeof.hardware.overview"><div class="titlepage"><div><div><h3 class="title" id="cha.nvmeof.hardware.overview"><span class="number">16.4.1 </span><span class="name">Overview</span> <a title="Permalink" class="permalink" href="cha.nvmeof.html#cha.nvmeof.hardware.overview">#</a></h3></div></div></div><p>
    Some hardware needs special configuration to work correctly. Skim
    the titles of the following sections to see if you are using any of
    the mentioned devices or vendors.
   </p></div><div class="sect2 " id="cha.nvmeof.hardware.broadcom"><div class="titlepage"><div><div><h3 class="title" id="cha.nvmeof.hardware.broadcom"><span class="number">16.4.2 </span><span class="name">Broadcom</span> <a title="Permalink" class="permalink" href="cha.nvmeof.html#cha.nvmeof.hardware.broadcom">#</a></h3></div></div></div><p>
    If you are using the <span class="emphasis"><em>Broadcom Emulex LightPulse Fibre
    Channel SCSI</em></span> driver, add a Kernel configuration
    parameter on the target and host for the <code class="literal">lpfc</code>
    module:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> <code class="command">echo "options lpfc lpfc_enable_fc4_type=3" &gt; /etc/modprobe.d/lpfc.conf</code></pre></div><p>
    Make sure that the Broadcom adapter firmware has at least version
    11.2.156.27. Also make sure that you have the current versions of
    <span class="package">nvme-cli</span>, <span class="package">nvmetlci</span> and the
    Kernel installed.
   </p><p>
    For more details, also refer to <a class="link" href="https://docs.broadcom.com/docs/12379413" target="_blank">https://docs.broadcom.com/docs/12379413</a>.
   </p></div></div><div class="sect1 " id="cha.nvmeof.more_information"><div class="titlepage"><div><div><h2 class="title" id="cha.nvmeof.more_information"><span class="number">16.5 </span><span class="name">More Information</span> <a title="Permalink" class="permalink" href="cha.nvmeof.html#cha.nvmeof.more_information">#</a></h2></div></div></div><p>
   For more details about the abilities of <code class="command">nvme</code>,
   refer to <code class="command">nvme nvme-help</code>.
  </p><p>
   The following links provide a basic introduction to NVMe and
   NVMe over Fabric:
  </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p><a class="link" href="http://nvmexpress.org/" target="_blank">http://nvmexpress.org/</a></p></li><li class="listitem "><p><a class="link" href="http://www.nvmexpress.org/wp-content/uploads/NVMe_Over_Fabrics.pdf" target="_blank">http://www.nvmexpress.org/wp-content/uploads/NVMe_Over_Fabrics.pdf</a></p></li><li class="listitem "><p><a class="link" href="https://storpool.com/blog/demystifying-what-is-nvmeof" target="_blank">https://storpool.com/blog/demystifying-what-is-nvmeof</a></p></li><li class="listitem "><p><a class="link" href="https://medium.com/@metebalci/a-quick-tour-of-nvm-express-nvme-3da2246ce4ef" target="_blank">https://medium.com/@metebalci/a-quick-tour-of-nvm-express-nvme-3da2246ce4ef</a></p></li></ul></div></div></div></div><div class="page-bottom"><div id="_bottom-navigation"><a class="nav-link" href="cha.multipath.html"><span class="next-icon">→</span><span class="nav-label"><span class="number">Chapter 17 </span>Managing Multipath I/O for Devices</span></a><a class="nav-link" href="cha.fcoe.html"><span class="prev-icon">←</span><span class="nav-label"><span class="number">Chapter 15 </span>Fibre Channel Storage over Ethernet Networks: FCoE</span></a></div><div id="_share-print"><div class="online-contents share"><strong>Share this page: </strong><span class="share-buttons"><span id="_share-fb" class="bottom-button">Facebook</span><span class="spacer"> • </span><span id="_share-gp" class="bottom-button">Google+</span><span class="spacer"> • </span><span id="_share-tw" class="bottom-button">Twitter</span><span class="spacer"> • </span><span id="_share-mail" class="bottom-button">E-Mail</span></span></div><div class="print"><span id="_print-button" class="bottom-button">Print this page</span></div><div class="clearme"></div></div></div></div><div id="_inward"></div></div><div id="_footer-wrap"><div id="_footer"><p>©
        2018 
        SUSE</p><ul><li><a href="http://www.suse.com/company/careers/" target="_top">Careers</a></li><li><a href="http://www.suse.com/company/legal/" target="_top">Legal</a></li><li><a href="http://www.suse.com/company/" target="_top">About</a></li><li><a href="http://www.suse.com/ContactsOffices/contacts_offices.jsp" target="_top">Contact Us</a></li></ul></div></div></body></html>