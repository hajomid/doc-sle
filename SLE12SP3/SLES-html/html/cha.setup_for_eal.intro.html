<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang=""><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Overview and rationale | Security and Hardening Guide | SUSE Linux Enterprise Server 12 SP3</title><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" /><link rel="stylesheet" type="text/css" href="static/css/style.css" /><link rel="stylesheet" type="text/css" href="static/css/highlight.css" /><meta name="generator" content="DAPS 2.4.0 using SUSE XSL Stylesheets 2.0.8 (based on DocBook XSL Stylesheets 1.78.1) - chunked" /><meta name="product-name" content="SUSE Linux Enterprise Server" /><meta name="product-number" content="12 SP3" /><meta name="book-title" content="Security and Hardening Guide" /><meta name="chapter-title" content="Chapter 1. Overview and rationale" /><meta name="description" content="sknorr, 2014-07-14: update necessary, we are past Q2/2012" /><meta name="tracker-url" content="https://bugzilla.suse.com/enter_bug.cgi" /><meta name="tracker-type" content="bsc" /><meta name="tracker-bsc-assignee" content="fs@suse.com" /><meta name="tracker-bsc-component" content="Documentation" /><meta name="tracker-bsc-product" content="SUSE Linux Enterprise Server 12 SP3" /><link rel="home" href="index.html" title="SUSE Linux Enterprise Server Documentation" /><link rel="up" href="part.setup_for_eal.html" title="Part I. Common Criteria" /><link rel="prev" href="part.setup_for_eal.html" title="Part I. Common Criteria" /><link rel="next" href="part.sec_prot.html" title="Part II. General System Security and Service Protection Methods" /><script type="text/javascript">

var protocol = window.location.protocol.toLowerCase();
if ( protocol != 'file:' ) {
  var agent = navigator.userAgent.toLowerCase();
  var wanted = ( protocol == 'https:') ? 'https' : 'http';
  var file = 'fonts.css';
  document.write('<link rel="stylesheet" type="text/css" href="' + wanted + '://static.opensuse.org/fonts/'+ file +'"></link>');
}
else {
   document.write('<link rel="stylesheet" type="text/css" href="static/css/fonts-onlylocal.css"></link>');
}

</script><noscript><link rel="stylesheet" type="text/css" href="http://static.opensuse.org/fonts/fonts.css" /></noscript><script src="static/js/jquery-1.10.2.min.js" type="text/javascript"></script><script src="static/js/script.js" type="text/javascript"></script><script src="static/js/highlight.min.js" type="text/javascript"></script><script>

$(document).ready(function() {
  $('.verbatim-wrap.highlight').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});
hljs.configure({
  useBR: false
});

</script></head><body class="draft offline js-off"><div id="_outer-wrap"><div id="_white-bg"><div id="_header"><div id="_logo"><img src="static/images/logo.png" alt="Logo" /></div><div class="crumbs"><a class="book-link" href="index.html" title="SUSE Linux Enterprise Server Documentation"><span class="book-icon">SUSE Linux Enterprise Server Documentation</span></a><span> › </span><a class="crumb" href="book.hardening.html">Security and Hardening Guide</a><span> › </span><a class="crumb" href="part.setup_for_eal.html">Common Criteria</a><span> › </span><a class="crumb" href="cha.setup_for_eal.intro.html">Overview and rationale</a></div><div class="clearme"></div></div></div><div id="_toolbar-wrap"><div id="_toolbar"><div id="_toc-area" class="inactive"><a id="_toc-area-button" class="tool" title="Contents" accesskey="c" href="index.html"><span class="tool-spacer"><span class="toc-icon">Contents</span><span class="clearme"></span></span><span class="tool-label">Contents</span></a><div class="active-contents bubble-corner"></div><div class="active-contents bubble"><div class="bubble-container"><h6>Security and Hardening Guide</h6><div id="_bubble-toc"><ol><li class="inactive"><a href="pre.hardening.about.html"><span class="number"> </span><span class="name">About This Guide</span></a></li><li class="inactive"><a href="part.setup_for_eal.html"><span class="number">I </span><span class="name">Common Criteria</span></a><ol><li class="inactive"><a href="cha.setup_for_eal.intro.html"><span class="number">1 </span><span class="name">Overview and rationale</span></a></li></ol></li><li class="inactive"><a href="part.sec_prot.html"><span class="number">II </span><span class="name">General System Security and Service Protection Methods</span></a><ol><li class="inactive"><a href="cha.sec_prot.intro.html"><span class="number">2 </span><span class="name">Introduction</span></a></li><li class="inactive"><a href="cha.sec_prot.general.html"><span class="number">3 </span><span class="name">Linux Security in General</span></a></li></ol></li><li class="inactive"><a href="app.hardening.docupdates.html"><span class="number">A </span><span class="name">Documentation Updates</span></a></li></ol></div><div class="clearme"></div></div></div></div><div id="_nav-area" class="inactive"><div class="tool"><span class="nav-inner"><span class="tool-label">Navigation</span><a accesskey="p" class="tool-spacer" title="Part I. Common Criteria" href="part.setup_for_eal.html"><span class="prev-icon">←</span></a><a accesskey="n" class="tool-spacer" title="Part II. General System Security and Service Protection Methods" href="part.sec_prot.html"><span class="next-icon">→</span></a></span></div></div></div></div><div id="_fixed-header-wrap" class="inactive"><div id="_fixed-header"><div class="crumbs"><a class="book-link" href="index.html" title="SUSE Linux Enterprise Server Documentation"><span class="book-icon">SUSE Linux Enterprise Server Documentation</span></a><span> › </span><a class="crumb" href="book.hardening.html">Security and Hardening Guide</a><span> › </span><a class="crumb" href="part.setup_for_eal.html">Common Criteria</a><span> › </span><a class="crumb" href="cha.setup_for_eal.intro.html">Overview and rationale</a></div><div class="buttons"><a class="top-button button" href="#">Top</a><div class="button"><a accesskey="p" class="tool-spacer" title="Part I. Common Criteria" href="part.setup_for_eal.html"><span class="prev-icon">←</span></a><a accesskey="n" class="tool-spacer" title="Part II. General System Security and Service Protection Methods" href="part.sec_prot.html"><span class="next-icon">→</span></a></div><div class="clearme"></div></div><div class="clearme"></div></div></div><div id="_content" class="draft "><div class="documentation"><div class="chapter " id="cha.setup_for_eal.intro"><div class="titlepage"><div><div class="version-info">Applies to  <span class="productname"><span class="productname"><span class="phrase">SUSE Linux Enterprise Server</span></span></span> <span class="productnumber"><span class="productnumber"><span class="phrase">12 SP3</span></span></span></div><div><h2 class="title"><span class="number">1 </span><span class="name">Overview and rationale</span> </h2></div><div><div class="abstract"><div class="abstract-title-wrap"><h6 class="abstract-title">Abstract<a title="Permalink" class="permalink" href="cha.setup_for_eal.intro.html#idm139967442777088">#</a></h6></div><p>
      

     </p></div></div></div></div><div class="line"><div class="toc"><dl><dt><span class="sect1"><a href="cha.setup_for_eal.intro.html#sec.setup_for_eal.intro.generic"><span class="number">1.1 </span><span class="name">What is the Common Criteria Certification?</span></a></span></dt><dt><span class="sect1"><a href="cha.setup_for_eal.intro.html#sec.setup_for_eal.intro.principals"><span class="number">1.2 </span><span class="name">Generic Guiding Principles</span></a></span></dt></dl></div></div><div class="sect1 " id="sec.setup_for_eal.intro.generic"><div class="titlepage"><div><div><h2 class="title" id="sec.setup_for_eal.intro.generic"><span class="number">1.1 </span><span class="name">What is the Common Criteria Certification?</span> <a title="Permalink" class="permalink" href="cha.setup_for_eal.intro.html#sec.setup_for_eal.intro.generic">#</a></h2></div></div></div><p>
     Common Criteria is the best known and most widely used methodology to
     evaluate and measure the security value of an IT product. The
     methodology aims to be independent, as an independent laboratory
     conducts the evaluation, which a certification body will certify
     afterward. Security Functional Requirements (SFR) are summarized in
     so-called Protection Profiles (PP), which allows the comparison of
     security functions of different products if the definition of the
     Security Target (ST) (which typically uses a reference to the PP if one
     exists that fits the purpose of the product) and the Evaluation
     Assurance Levels are comparable.
    </p><p>
     A clear definition of security in IT products is challenging. Security
     should be considered a process that never ends, not a static condition
     that can be met or not. A Common Criteria certificate (below EA7) does
     not make a clear statement about error proneness of the system (while
     many of the flaws that exist specifically in operating systems are
     security-relevant), but it adds an important value to the product that
     cannot be described with the presence of technology alone: That someone
     has independently inspected the design of the system in such way that
     it corresponds to the claims that are made, and that explicit care has
     been taken in producing and maintaining the product.
    </p><p>
     The certificate states a degree of maturity of both the product with
     its security functions and the processes of the company that has
     designed, built and engineered the product, and that will maintain the
     product across its life cycle. As such, Common Criteria aims to be
     fairly holistic with its approach to take everything into account that
     is relevant for the security of an IT product.
    </p><p>
     The Evaluation Assurance Level (EAL) shall denote the degree of
     confidence that the product fulfills the described claims. The levels
     are from 1 through 7:
    </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
       EAL1: Functionally tested
      </p></li><li class="listitem "><p>
       EAL2: Structurally tested
      </p></li><li class="listitem "><p>
       EAL3: Methodically tested and checked
      </p></li><li class="listitem "><p>
       EAL4: Methodically designed, tested and reviewed
      </p></li><li class="listitem "><p>
       EAL5: Semi-formally designed and tested
      </p></li><li class="listitem "><p>
       EAL6: Semi-formally verified design and tested
      </p></li><li class="listitem "><p>
       EAL7: Formally verified design and tested
      </p></li></ul></div><p>
     While EAL1 only provides basic assurance for products to meet security
     requirements, EAL2 to 4 are medium assurance levels. EAL5-EAL7 describe
     medium-to-high and high assurance; EAL4 is expected to be the highest
     level of assurance that a product can have if it has not been designed
     from the start to achieve a higher level of assurance.
    </p><p>
     Many commonly known General Purpose/Utility Computing operating systems
     have been awarded a Common Criteria certificate at EAL4. A "+" after
     the assurance level denotes an augmentation to the EAL, an addition
     that is useful for the articulation of security value, but formally not
     needed at the corresponding EAL.
    </p><p>
     The <span class="productname"><span class="phrase">SUSE Linux Enterprise Server</span></span> version 8 was the first Linux system to achieve
     EAL3+ (Augmentation: Basic Flaw Remediation) in 2003; Version 9 of SLES
     was the first Linux based operating system to reach EAL4+ in 2004. More
     certifications and re-certifications have followed targeting SLES 9 and
     SLES 10-SP1, until the <span class="productname"><span class="phrase">SUSE Linux Enterprise Server</span></span> version Service Pack 2 was
     evaluated in 2011/2012.
    </p><p>
     The Common Criteria evaluations inspect a specific configuration of the
     product in an evaluated setup. The <span class="quote">“<span class="quote">Administrator's Guide</span>”</span>
     is a document that comes with a Common Criteria certified product and
     describes the individual steps that need to be taken to install and
     configure the product to a state like it was evaluated.
    </p><p>
     Very often, the evaluated configuration is used as a reference for the
     secure installation of the <span class="productname"><span class="phrase">SUSE Linux Enterprise Server</span></span>. It is however incorrect to
     understand the evaluated configuration as a hardened configuration: the
     removal of setuid bits and the prescription of administrative
     procedures after installation is there to reach a specific
     configuration that is sane, but this process is clearly insufficient
     for a hardening claim.
    </p><p>
     Earlier versions of this document have contained a substantial part
     that links to Common Criteria evaluated configurations. For clarity and
     to avoid confusion these chapters have been removed.
    </p><p>
     Instead, this guide recommends the lecture the documentation that comes
     with the Common Criteria certificate to understand the Common Criteria
     evaluation of <span class="productname"><span class="phrase">SUSE Linux Enterprise Server</span></span> in general, the security functions that
     are in place within the operating system and how these security
     functions are relevant for the mitigation of threats. The High Level
     Design documentation encompasses the design specifics of the
     <span class="productname"><span class="phrase">SUSE Linux Enterprise Server</span></span>: Authentication mechanisms, access controls, audit
     subsystem and system log files, to name a few of them. The accumulated
     knowledge contained in the documentation allows decision making for
     hardening purposes at an informed level—find it at
     <a class="link" href="http://www.suse.com/security/" target="_blank">http://www.suse.com/security/</a>.
    </p><p>
     Apart from the valuable documentation that comes with the Common
     Criteria effort, the following manual pages may be of greater interest
     to the inclined reader:
    </p><p>
     <span class="quote">“<span class="quote">pam(8), pam(5)</span>”</span>
    </p><p>
     <span class="quote">“<span class="quote">apparmor(7)</span>”</span> and referred man pages
    </p><p>
     <span class="quote">“<span class="quote">rsyslogd(8), syslog(8), syslogd(8)</span>”</span>
    </p><p>
     <span class="quote">“<span class="quote">fstab(5), mount(8), losetup(8), cryptsetup(8)</span>”</span>
    </p><p>
     <span class="quote">“<span class="quote">haveged(8), random(4)</span>”</span>
    </p><p>
     <span class="quote">“<span class="quote">ssh(1), sshd(8), ssh_config(5), sshd_config(5), ssh-agent(1),
     ssh-add(1), ssh-keygen(1)</span>”</span>
    </p><p>
     <span class="quote">“<span class="quote">cron(1), crontab(5), at(1), atd(8)</span>”</span>
    </p><p>
     <span class="quote">“<span class="quote">systemctl(1), daemon(7), systemd.unit(5), systemd.special(5),
     kernel-command-line(7), bootup(7), systemd.directives</span>”</span>
    </p></div><div class="sect1 " id="sec.setup_for_eal.intro.principals"><div class="titlepage"><div><div><h2 class="title" id="sec.setup_for_eal.intro.principals"><span class="number">1.2 </span><span class="name">Generic Guiding Principles</span> <a title="Permalink" class="permalink" href="cha.setup_for_eal.intro.html#sec.setup_for_eal.intro.principals">#</a></h2></div></div></div><p>
     The following guiding principles motivate much of the advice in this
     guide, and security processes in general, and should also influence any
     configuration decisions that are not explicitly covered.
    </p><div class="variablelist "><dl class="variablelist"><dt id="idm139967414386144"><span class="term ">Use Data Encryption Whenever Possible</span></dt><dd><p>
        Refer to the <a class="xref" href="pre.hardening.about.html" title="About This Guide">About This Guide</a> section of this
        guide. In <a class="xref" href="pre.hardening.about.html#pre.hardening.about.assumptions" title="1. Assumptions and Scope">Section 1, “Assumptions and Scope”</a>, the
        limitations of cryptography are briefly outlined.
       </p><p>
        Be aware that cryptography is certainly useful, but only for the
        specific purposes that it is good for. It is not a generic recipe
        for better security in a system, its use may even impose additional
        risk on the system. Make informed decisions about the use of
        cryptography, and feel obliged to have a reason for your decisions,
        no matter if they are for or against cryptography. A false sense of
        security can be more harmful than the weakness itself.

        <span class="productname"><span class="phrase">SUSE Linux Enterprise Server</span></span> supports encryption for generic network connections
        (the <code class="command">openssl</code> command,
        <code class="command">stunnel</code>), for remote login
        (<code class="command">openssh</code>, <code class="command">man ssh(1)</code>), for
        generic file encryption (<code class="command">gpg</code>), for entire file
        systems at block layer (<code class="command">dm_crypt</code>,
        <code class="command">cryptsetup</code>) and for VPN
        (<code class="command">iipsec</code>, <code class="command">openvpn</code>).
       </p></dd><dt id="idm139967442561600"><span class="term ">Minimal Package Installation</span></dt><dd><p>
        Generally, an RPM software package consists of the package's meta
        data that is written to the RPM database upon installation, the
        package's files and directories and scripts that are being executed
        before and after installation and removal.
       </p><p>
        If the package does NOT contain
       </p><div class="orderedlist "><ol class="orderedlist" type="1"><li class="listitem "><p>
          setuid- or setgid bits on any of the installed files
         </p></li><li class="listitem "><p>
          group- or world-writable files or directories
         </p></li><li class="listitem "><p>
          a service that is activated upon installation/activated by
          default.
         </p></li></ol></div><p>
        then the said package generally does not impose any security risk to
        the system. Under the above condition, the package is merely a
        collection of files, and their use shall not be automatically
        assumed if you do not have any local users on your system. Since the
        installation of such packages does not have any influence on the
        security value of the system, the uninstallation of them should not
        either.
       </p><p>
        However, a fairly simple reason to keep to a minimal set of packages
        in your installation is that something that is not present cannot
        get used. Binaries not installed cannot be executed.
       </p><p>
        A straight forward way of keeping to a minimal set of packages
        begins with the installation of the system. You can start the
        installation of your system by deselecting all packages and then
        select only those that you want to use. As an example, the selection
        of the apache2-mod_perl package in YaST would automatically
        cause all packages to be selected for installation that are needed
        for the Apache package to operate. Dependencies have often been
        artificially cut down to be able to handle the system's dependency
        tree more flexibly. You should be safe if you chose the minimal
        system, and build the dependency tree from there with your (leaf)
        package selection.
       </p></dd><dt id="idm139967438352064"><span class="term ">Service Isolation—Run Different Services on Separate
      Systems</span></dt><dd><p>
        Whenever possible, a server should be dedicated to serving exactly
        one service or application. This limits the number of other services
        that could be compromised in the event an attacker can successfully
        exploit a software flaw in one service (assuming that flaw allows
        access to others).
       </p><p>
        This point can lead to healthy and robust dialog on system sizing
        and even further to consolidation or virtualization. The intent with
        this guidance is to reduce the fault domain and risk where possible.
       </p><p>
        The use of AppArmor for services that are provided on a system is an
        effective means of containment. Refer to the AppArmor documentation
        on your system to learn more. <code class="command">man apparmor</code> is a
        good starting point.
       </p><p>
        The use of virtualization technology with KVM or with Xen
        is supported with the <span class="productname"><span class="phrase">SUSE Linux Enterprise Server</span></span> version <span class="productnumber"><span class="phrase">12 SP3</span></span>.
        While virtualization is generally designed for server consolidation
        purposes, its usefulness for service isolation is another good
        argument. Be aware that the capability of the hypervisor to separate
        virtual machines is not higher or stronger than the Linux kernel's
        capability to separate processes and their address spaces. The
        granularity at which virtualization technology tackles separation
        may however come with its benefits, being resource-hungry and
        somewhat clumsy on the other hand.
       </p><div id="idm139967439410960" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note</h6><p>
         Virtualization technology cannot match or substitute the separation
         strength that is given by running services on different physical
         machines!
        </p></div></dd><dt id="idm139967439409584"><span class="term ">
       System fingerprinting and backups
      </span></dt><dd><p>
        In the case of the suspicion of an attack against the system,
        nothing can provide more comfort than
       </p><div class="orderedlist "><ol class="orderedlist" type="1"><li class="listitem "><p>
          a backup
         </p></li><li class="listitem "><p>
          a fingerprint of your system to detect modifications
         </p></li><li class="listitem "><p>
          having done your homework.
         </p></li></ol></div><p>
        Several tools exist on <span class="productname"><span class="phrase">SUSE Linux Enterprise Server</span></span> <span class="productnumber"><span class="phrase">12 SP3</span></span> which can
        be effectively used for the detection of unknown, but yet successful
        attacks. These tools come at the cost of relatively little
        configuration effort, but with the benefit of being able to actually
        know what has been changed in your system.
       </p><p>
        In particular, the use of
        <code class="systemitem">AIDE</code> is strongly
        encouraged. <code class="systemitem">AIDE</code>, when run
        for initialization, creates a hash database of all files in the
        system that are listed in its configuration file. This allows to
        verify the integrity of all cataloged files at a later time.
       </p><div id="idm139967442461072" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note</h6><p>
         You need to copy the hash database that AIDE creates to a place
         that is inaccessible for potential attackers. Otherwise, the
         attacker may modify the integrity database after planting a
         backdoor, thereby defeating the purpose of the integrity
         measurement.
        </p></div><div id="idm139967442459888" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note</h6><p>
         An attacker may have planted a backdoor in the kernel. This has an
         entire variety of consequences: Apart from being very hard to
         detect, the kernel-based backdoor can effectively remove all traces
         of the system compromise to the degree that system alterations are
         almost invisible. By consequence, an integrity check needs to be
         done from a rescue system (or any other system where an independent
         system runs, and the target system's file systems are mounted
         manually).
        </p></div><div id="idm139967442458464" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note</h6><p>
         Security is a lively process. Essentially, in this context, this
         means that the application of security updates invalidates the
         integrity database. <code class="command">rpm</code> <code class="option">-qlv
         packagename</code> lists the files that are contained in a
         package. Generally spoken, the RPM subsystem is very powerful with
         the data that it maintains, and that is accessible with the
         <code class="option">--queryformat</code> command line option. A differential
         update of integrity database with the changed files becomes more
         manageable with some fine-grained usage of RPM.
        </p></div><p>
        A fast and directly accessible backup adds distinct confidence about
        the integrity of your system and can substitute an integrity check
        such as described above with AIDE. It is important, though, that the
        backup mechanism/solution has adequate versioning support so that
        you can trace changes in the system. As an example: The installation
        times of packages (<code class="command">rpm</code> <code class="option">-q</code>
        <code class="option">--queryformat='%{INSTALLTIME} %{NAME}\n'</code>
        <em class="replaceable ">PACKAGE NAME</em>) must correspond to the changed files in the backup log
        files.
       </p><div id="idm139967442586016" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note</h6><p>
         Make it an integral part of your security routine to verify that
         your backups work.
        </p></div></dd></dl></div></div></div></div><div class="page-bottom"><div id="_bottom-navigation"><a class="nav-link" href="part.sec_prot.html"><span class="next-icon">→</span><span class="nav-label"><span class="number">Part II </span>General System Security and Service Protection Methods</span></a><a class="nav-link" href="part.setup_for_eal.html"><span class="prev-icon">←</span><span class="nav-label"><span class="number">Part I </span>Common Criteria</span></a></div><div id="_share-print"><div class="online-contents share"><strong>Share this page: </strong><span class="share-buttons"><span id="_share-fb" class="bottom-button">Facebook</span><span class="spacer"> • </span><span id="_share-gp" class="bottom-button">Google+</span><span class="spacer"> • </span><span id="_share-tw" class="bottom-button">Twitter</span><span class="spacer"> • </span><span id="_share-mail" class="bottom-button">E-Mail</span></span></div><div class="print"><span id="_print-button" class="bottom-button">Print this page</span></div><div class="clearme"></div></div></div></div><div id="_inward"></div></div><div id="_footer-wrap"><div id="_footer"><p>©
        2018 
        SUSE</p><ul><li><a href="http://www.suse.com/company/careers/" target="_top">Careers</a></li><li><a href="http://www.suse.com/company/legal/" target="_top">Legal</a></li><li><a href="http://www.suse.com/company/" target="_top">About</a></li><li><a href="http://www.suse.com/ContactsOffices/contacts_offices.jsp" target="_top">Contact Us</a></li></ul></div></div></body></html>