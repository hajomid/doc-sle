<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang=""><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Linux Security in General | Security and Hardening Guide | SUSE Linux Enterprise Server 12 SP3</title><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" /><link rel="stylesheet" type="text/css" href="static/css/style.css" /><link rel="stylesheet" type="text/css" href="static/css/highlight.css" /><meta name="generator" content="DAPS 2.4.0 using SUSE XSL Stylesheets 2.0.8 (based on DocBook XSL Stylesheets 1.78.1) - chunked" /><meta name="product-name" content="SUSE Linux Enterprise Server" /><meta name="product-number" content="12 SP3" /><meta name="book-title" content="Security and Hardening Guide" /><meta name="chapter-title" content="Chapter 3. Linux Security in General" /><meta name="tracker-url" content="https://bugzilla.suse.com/enter_bug.cgi" /><meta name="tracker-type" content="bsc" /><meta name="tracker-bsc-assignee" content="fs@suse.com" /><meta name="tracker-bsc-component" content="Documentation" /><meta name="tracker-bsc-product" content="SUSE Linux Enterprise Server 12 SP3" /><link rel="home" href="index.html" title="SUSE Linux Enterprise Server Documentation" /><link rel="up" href="part.sec_prot.html" title="Part II. General System Security and Service Protection Methods" /><link rel="prev" href="cha.sec_prot.intro.html" title="Chapter 2. Introduction" /><link rel="next" href="app.hardening.docupdates.html" title="Appendix A. Documentation Updates" /><script type="text/javascript">

var protocol = window.location.protocol.toLowerCase();
if ( protocol != 'file:' ) {
  var agent = navigator.userAgent.toLowerCase();
  var wanted = ( protocol == 'https:') ? 'https' : 'http';
  var file = 'fonts.css';
  document.write('<link rel="stylesheet" type="text/css" href="' + wanted + '://static.opensuse.org/fonts/'+ file +'"></link>');
}
else {
   document.write('<link rel="stylesheet" type="text/css" href="static/css/fonts-onlylocal.css"></link>');
}

</script><noscript><link rel="stylesheet" type="text/css" href="http://static.opensuse.org/fonts/fonts.css" /></noscript><script src="static/js/jquery-1.10.2.min.js" type="text/javascript"></script><script src="static/js/script.js" type="text/javascript"></script><script src="static/js/highlight.min.js" type="text/javascript"></script><script>

$(document).ready(function() {
  $('.verbatim-wrap.highlight').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});
hljs.configure({
  useBR: false
});

</script></head><body class="draft offline js-off"><div id="_outer-wrap"><div id="_white-bg"><div id="_header"><div id="_logo"><img src="static/images/logo.png" alt="Logo" /></div><div class="crumbs"><a class="book-link" href="index.html" title="SUSE Linux Enterprise Server Documentation"><span class="book-icon">SUSE Linux Enterprise Server Documentation</span></a><span> › </span><a class="crumb" href="book.hardening.html">Security and Hardening Guide</a><span> › </span><a class="crumb" href="part.sec_prot.html">General System Security and Service Protection Methods</a><span> › </span><a class="crumb" href="cha.sec_prot.general.html">Linux Security in General</a></div><div class="clearme"></div></div></div><div id="_toolbar-wrap"><div id="_toolbar"><div id="_toc-area" class="inactive"><a id="_toc-area-button" class="tool" title="Contents" accesskey="c" href="index.html"><span class="tool-spacer"><span class="toc-icon">Contents</span><span class="clearme"></span></span><span class="tool-label">Contents</span></a><div class="active-contents bubble-corner"></div><div class="active-contents bubble"><div class="bubble-container"><h6>Security and Hardening Guide</h6><div id="_bubble-toc"><ol><li class="inactive"><a href="pre.hardening.about.html"><span class="number"> </span><span class="name">About This Guide</span></a></li><li class="inactive"><a href="part.setup_for_eal.html"><span class="number">I </span><span class="name">Common Criteria</span></a><ol><li class="inactive"><a href="cha.setup_for_eal.intro.html"><span class="number">1 </span><span class="name">Overview and rationale</span></a></li></ol></li><li class="inactive"><a href="part.sec_prot.html"><span class="number">II </span><span class="name">General System Security and Service Protection Methods</span></a><ol><li class="inactive"><a href="cha.sec_prot.intro.html"><span class="number">2 </span><span class="name">Introduction</span></a></li><li class="inactive"><a href="cha.sec_prot.general.html"><span class="number">3 </span><span class="name">Linux Security in General</span></a></li></ol></li><li class="inactive"><a href="app.hardening.docupdates.html"><span class="number">A </span><span class="name">Documentation Updates</span></a></li></ol></div><div class="clearme"></div></div></div></div><div id="_nav-area" class="inactive"><div class="tool"><span class="nav-inner"><span class="tool-label">Navigation</span><a accesskey="p" class="tool-spacer" title="Chapter 2. Introduction" href="cha.sec_prot.intro.html"><span class="prev-icon">←</span></a><a accesskey="n" class="tool-spacer" title="Appendix A. Documentation Updates" href="app.hardening.docupdates.html"><span class="next-icon">→</span></a></span></div></div></div></div><div id="_fixed-header-wrap" class="inactive"><div id="_fixed-header"><div class="crumbs"><a class="book-link" href="index.html" title="SUSE Linux Enterprise Server Documentation"><span class="book-icon">SUSE Linux Enterprise Server Documentation</span></a><span> › </span><a class="crumb" href="book.hardening.html">Security and Hardening Guide</a><span> › </span><a class="crumb" href="part.sec_prot.html">General System Security and Service Protection Methods</a><span> › </span><a class="crumb" href="cha.sec_prot.general.html">Linux Security in General</a></div><div class="buttons"><a class="top-button button" href="#">Top</a><div class="button"><a accesskey="p" class="tool-spacer" title="Chapter 2. Introduction" href="cha.sec_prot.intro.html"><span class="prev-icon">←</span></a><a accesskey="n" class="tool-spacer" title="Appendix A. Documentation Updates" href="app.hardening.docupdates.html"><span class="next-icon">→</span></a></div><div class="clearme"></div></div><div class="clearme"></div></div></div><div id="_content" class="draft "><div class="documentation"><div class="chapter " id="cha.sec_prot.general"><div class="titlepage"><div><div class="version-info">Applies to  <span class="productname"><span class="productname"><span class="phrase">SUSE Linux Enterprise Server</span></span></span> <span class="productnumber"><span class="productnumber"><span class="phrase">12 SP3</span></span></span></div><div><h2 class="title"><span class="number">3 </span><span class="name">Linux Security in General</span> </h2></div></div></div><div class="line"><div class="toc"><dl><dt><span class="sect1"><a href="cha.sec_prot.general.html#sec.sec_prot.general.physical"><span class="number">3.1 </span><span class="name">Physical Security</span></a></span></dt><dt><span class="sect1"><a href="cha.sec_prot.general.html#sec.sec_prot.general.bios"><span class="number">3.2 </span><span class="name">Locking Down the BIOS</span></a></span></dt><dt><span class="sect1"><a href="cha.sec_prot.general.html#sec.sec_prot.general.bootloader"><span class="number">3.3 </span><span class="name">Security via the Boot Loaders</span></a></span></dt><dt><span class="sect1"><a href="cha.sec_prot.general.html#sec.sec_prot.general.seccheck"><span class="number">3.4 </span><span class="name">Verifying Security Action with <code class="command">seccheck</code></span></a></span></dt><dt><span class="sect1"><a href="cha.sec_prot.general.html#sec.sec_prot.general.retiring"><span class="number">3.5 </span><span class="name">Retiring Linux Servers with Sensitive Data</span></a></span></dt><dt><span class="sect1"><a href="cha.sec_prot.general.html#sec.sec_prot.general.backups"><span class="number">3.6 </span><span class="name">Backups</span></a></span></dt><dt><span class="sect1"><a href="cha.sec_prot.general.html#sec.sec_prot.general.partitions"><span class="number">3.7 </span><span class="name">Disk Partitions</span></a></span></dt><dt><span class="sect1"><a href="cha.sec_prot.general.html#sec.sec_prot.general.firewall"><span class="number">3.8 </span><span class="name">Firewall (iptables)</span></a></span></dt><dt><span class="sect1"><a href="cha.sec_prot.general.html#sec.sec_prot.general.kernel"><span class="number">3.9 </span><span class="name">Security Features in the Kernel</span></a></span></dt><dt><span class="sect1"><a href="cha.sec_prot.general.html#sec.sec_prot.general.aa"><span class="number">3.10 </span><span class="name"><span class="phrase">AppArmor</span></span></a></span></dt><dt><span class="sect1"><a href="cha.sec_prot.general.html#sec.sec_prot.general.selinux"><span class="number">3.11 </span><span class="name">SELinux</span></a></span></dt><dt><span class="sect1"><a href="cha.sec_prot.general.html#sec.sec_prot.general.remote"><span class="number">3.12 </span><span class="name">FTP, <code class="command">telnet</code>, and <code class="command">rlogin</code> (rsh)</span></a></span></dt><dt><span class="sect1"><a href="cha.sec_prot.general.html#sec.sec_prot.general.remove_packs"><span class="number">3.13 </span><span class="name">Removing Unnecessary Software Packages (RPMs)</span></a></span></dt><dt><span class="sect1"><a href="cha.sec_prot.general.html#sec.sec_prot.general.patching"><span class="number">3.14 </span><span class="name">Patching Linux Systems</span></a></span></dt><dt><span class="sect1"><a href="cha.sec_prot.general.html#sec.sec_prot.general.ports"><span class="number">3.15 </span><span class="name">Securing the Network—Open Network Ports Detection</span></a></span></dt><dt><span class="sect1"><a href="cha.sec_prot.general.html#sec.sec_prot.general.disable_xinetd_services"><span class="number">3.16 </span><span class="name"><code class="systemitem">xinetd</code> Services - Disabling</span></a></span></dt><dt><span class="sect1"><a href="cha.sec_prot.general.html#sec.sec_prot.general.postfix"><span class="number">3.17 </span><span class="name">Securing Postfix</span></a></span></dt><dt><span class="sect1"><a href="cha.sec_prot.general.html#sec.sec_prot.general.nfs"><span class="number">3.18 </span><span class="name">File Systems: Securing NFS</span></a></span></dt><dt><span class="sect1"><a href="cha.sec_prot.general.html#sec.sec_prot.general.scp"><span class="number">3.19 </span><span class="name">Copying Files Using SSH Without Providing Login Prompts</span></a></span></dt><dt><span class="sect1"><a href="cha.sec_prot.general.html#sec.sec_prot.general.check_perms"><span class="number">3.20 </span><span class="name">Checking File Permissions and Ownership</span></a></span></dt><dt><span class="sect1"><a href="cha.sec_prot.general.html#sec.sec_prot.general.umask"><span class="number">3.21 </span><span class="name">Default umask</span></a></span></dt><dt><span class="sect1"><a href="cha.sec_prot.general.html#sec.sec_prot.general.s-bit"><span class="number">3.22 </span><span class="name">SUID/SGID Files</span></a></span></dt><dt><span class="sect1"><a href="cha.sec_prot.general.html#sec.sec_prot.general.filepermissions"><span class="number">3.23 </span><span class="name">World-Writable Files</span></a></span></dt><dt><span class="sect1"><a href="cha.sec_prot.general.html#sec.sec_prot.general.orphaned"><span class="number">3.24 </span><span class="name">Orphaned or Unowned Files</span></a></span></dt><dt><span class="sect1"><a href="cha.sec_prot.general.html#sec.sec_prot.general.removable_media"><span class="number">3.25 </span><span class="name">Restricting Access to Removable Media</span></a></span></dt><dt><span class="sect1"><a href="cha.sec_prot.general.html#sec.sec_prot.general.accounts"><span class="number">3.26 </span><span class="name">Various Account Checks</span></a></span></dt><dt><span class="sect1"><a href="cha.sec_prot.general.html#sec.sec_prot.general.pw_aging"><span class="number">3.27 </span><span class="name">Enabling Password Aging</span></a></span></dt><dt><span class="sect1"><a href="cha.sec_prot.general.html#sec.sec_prot.general.pw_strength"><span class="number">3.28 </span><span class="name">Stronger Password Enforcement</span></a></span></dt><dt><span class="sect1"><a href="cha.sec_prot.general.html#sec.sec_prot.general.pam"><span class="number">3.29 </span><span class="name">Leveraging an Effective PAM stack</span></a></span></dt><dt><span class="sect1"><a href="cha.sec_prot.general.html#sec.sec_prot.dos"><span class="number">3.30 </span><span class="name">Preventing Accidental Denial of Service</span></a></span></dt><dt><span class="sect1"><a href="cha.sec_prot.general.html#sec.sec_prot.banners"><span class="number">3.31 </span><span class="name">Displaying Login Banners</span></a></span></dt><dt><span class="sect1"><a href="cha.sec_prot.general.html#sec.sec_prot.misc"><span class="number">3.32 </span><span class="name">Miscellaneous</span></a></span></dt></dl></div></div><p>
    This portion of the guide will only give basic recommendations instead
    of strict rules. The procedures and examples here should give you the
    ability to apply security enhancement techniques to a wider variety of
    server-based services and programs.
   </p><p>
    Some subjects of this chapter have been discussed before. However, you
    will find more details and explanations in this chapter. Selected
    general topics are:
   </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
      Physical Security – Protection of the server from environmental
      threats (people, places, things).
     </p></li><li class="listitem "><p>
      Security Policies and Procedures – Server life cycle management,
      disk/media reclamation, backup and archive security.
     </p></li><li class="listitem "><p>
      Systems Monitoring – Procedures around event
      notification/management.
     </p></li><li class="listitem "><p>
      Systems Automation – Mechanisms and/or procedures for automatic
      security measures. Heuristics, account control, security reporting and
      remediation, automated shutdown, etc.
     </p></li><li class="listitem "><p>
      Systems Management – Methods to obtaining packages, verification and
      signing keys, patching procedures and recommendations.
     </p></li><li class="listitem "><p>
      Securing Network – Addition programs, ports and service wrappers –
      iptables, tcpwrappers, services.
     </p></li><li class="listitem "><p>
      Remote Access – extra SSH information and key federation. CA
      integration.
     </p></li><li class="listitem "><p>
      Common Services – mail, NFS and automount.
     </p></li><li class="listitem "><p>
      Securing the kernel and Init Process – parameters, systemd targets,
      and boot scripts.
     </p></li><li class="listitem "><p>
      Access Control – user/groups/permissions.
     </p></li><li class="listitem "><p>
      Password Security and Warnings – Proper setup of passwords, banners
      and <code class="systemitem">xinetd</code>.
     </p></li><li class="listitem "><p>
      Miscellaneous Security – Assorted security settings and miscellany.
     </p></li><li class="listitem "><p>
      Resources – Web links, documentation and example references, howtos
      and general information, product links.
     </p></li></ul></div><p>
    The sections will again be organized by a topical hierarchy for
    continuity-sake. Refer to the main table of contents for easy reference.
   </p><div class="sect1 " id="sec.sec_prot.general.physical"><div class="titlepage"><div><div><h2 class="title" id="sec.sec_prot.general.physical"><span class="number">3.1 </span><span class="name">Physical Security</span> <a title="Permalink" class="permalink" href="cha.sec_prot.general.html#sec.sec_prot.general.physical">#</a></h2></div></div></div><p>
     Physical security should be one of the utmost concerns. Linux
     production servers should be in locked data centers where only people
     have access that have passed security checks. Depending on the
     environment and circumstances, you can also consider boot loader
     passwords.
    </p><p>
     Additionally, consider questions like:
    </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
       Who has direct physical access to the host?
      </p></li><li class="listitem "><p>
       Of those that do, should they?
      </p></li><li class="listitem "><p>
       Can the host be protected from tampering and should it be?
      </p></li></ul></div><p>
     The amount of physical security needed on a particular system depends
     on the situation, and can also vary widely by available funds.
    </p><div class="sect2 " id="sec.sec_prot.general.physical.locks"><div class="titlepage"><div><div><h3 class="title" id="sec.sec_prot.general.physical.locks"><span class="number">3.1.1 </span><span class="name">System Locks</span> <a title="Permalink" class="permalink" href="cha.sec_prot.general.html#sec.sec_prot.general.physical.locks">#</a></h3></div></div></div><p>
      Most server racks in data centers include a locking feature. Usually
      this will be a hasp/cylinder lock on the front of the rack that allows
      you to turn an included key to a locked or unlocked position –
      granting or denying entry. Cage locks can help prevent someone from
      tampering or stealing devices/media from the servers, or opening
      the cases and directly manipulating/sabotaging the hardware.
      Preventing system reboots or the booting from alternate devices is
      also important (for example CD/DVDs/USB drives/etc.).
     </p><p>
      Some servers also have case locks. These locks can do different things
      according to the designs of the system vendor and construction. Many
      systems are designed to self-disable if attempts are made to open the
      system without unlocking. Others have device covers that will not let
      you plug in or unplug keyboards or mice. While locks are sometimes a
      useful feature, they are usually lower quality and easily defeated by
      attackers with ill intent.
     </p></div></div><div class="sect1 " id="sec.sec_prot.general.bios"><div class="titlepage"><div><div><h2 class="title" id="sec.sec_prot.general.bios"><span class="number">3.2 </span><span class="name">Locking Down the BIOS</span> <a title="Permalink" class="permalink" href="cha.sec_prot.general.html#sec.sec_prot.general.bios">#</a></h2></div></div></div><div id="idm139924419415440" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.png" /><h6>Tip: Secure Boot</h6><p>
      This section describes only basic methods to secure the boot process.
      To find out more about UEFI and the secure boot feature, see
      <a class="xref" href="cha.uefi.html#sec.uefi.secboot" title="11.1. Secure Boot">Section 11.1, “Secure Boot”</a>.
     </p></div><p>
     The BIOS (Basic Input/Output System) or its successor UEFI (Unified
     Extensible Firmware Interface) is the lowest level of
     software/firmware that dictates system configuration and low-level
     hardware. When this document references the BIOS, it usually means
     BIOS and/or UEFI. GRUB 2 and other Linux boot loaders access the
     BIOS to determine how to boot the host. Other hardware types
     (POWER/z Systems) that run Linux also have low-level
     software/firmware. Typically the BIOS can be configured to help prevent
     attackers from being able to reboot the host and manipulate the system.
    </p><p>
     Most BIOS varieties allow the setting of a boot password. While this
     does not provide a high level of security (a BIOS can be reset, removed
     or modified – assuming case access), it can be another deterrent.
    </p><p>
     Many BIOS capabilities have other various security settings –
     checking with the system vendor, the system documentation or examine
     the BIOS during a system boot.
    </p><div id="idm139924411594000" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.png" /><h6>Important: Booting when a BIOS Password is Set</h6><p>
      If a system host has been set up with a boot password, the host will
      not boot up unattended (for example a system reboot, power failure,
      etc.). This is a trade-off.
     </p></div></div><div class="sect1 " id="sec.sec_prot.general.bootloader"><div class="titlepage"><div><div><h2 class="title" id="sec.sec_prot.general.bootloader"><span class="number">3.3 </span><span class="name">Security via the Boot Loaders</span> <a title="Permalink" class="permalink" href="cha.sec_prot.general.html#sec.sec_prot.general.bootloader">#</a></h2></div></div></div><p>
     The Linux boot loader GRUB 2, which is used by default in
     <span class="productname"><span class="phrase">SUSE Linux Enterprise Server</span></span>, can have a boot passwords set. It also provides a
     password feature, so that only administrators can start the interactive
     operations (for example editing menu entries and entering the command
     line interface). If a password is specified, GRUB 2 will disallow
     any interactive control until you press the key <span class="keycap">C</span> and
     <span class="keycap">E</span> and enter a correct password.
    </p><p>
     You can refer to the GRUB 2 man page for examples.
    </p><p>
     It is very important to keep in mind that when setting these passwords
     they will need to be remembered! Also, enabling these passwords might
     merely slow an intrusion, not necessarily prevent it. Again, someone
     could boot from a removable device, and mount your root partition. If
     you are using BIOS-level security and a boot loader, it is a good
     practice to disable the ability to boot from removable devices in your
     computer's BIOS, and then also password-protecting the BIOS itself.
    </p><p>
     Also keep in mind that the boot loader configuration files will need to
     be protected by changing their mode to <code class="literal">600</code>
     (read/write for <code class="systemitem">root</code> only), or others will be able to read
     your passwords or hashes!
    </p></div><div class="sect1 " id="sec.sec_prot.general.seccheck"><div class="titlepage"><div><div><h2 class="title" id="sec.sec_prot.general.seccheck"><span class="number">3.4 </span><span class="name">Verifying Security Action with <code class="command">seccheck</code></span> <a title="Permalink" class="permalink" href="cha.sec_prot.general.html#sec.sec_prot.general.seccheck">#</a></h2></div></div></div><p>
     It is highly recommended to have scripts in place which can verify that
     security actions or procedures have been run. Even the best systems
     administrators can make errors or forget something. If you have a small
     or large Linux installation or environment, you should consider the use
     of the <code class="command">seccheck</code> scripts.
    </p><p>
     <code class="command">seccheck</code> is the SUSE Security Checker. It is a
     set of several shell scripts designed to check the local security of
     the system on a regular basis. There are three main scripts that are
     executed at different time intervals. They are
     <code class="literal">security-daily,</code> <code class="literal">security-weekly</code>
     and <code class="literal">security-monthly</code>. If <code class="command">seccheck</code>
     is not installed on your system, install it with <code class="command">sudo zypper
     in seccheck</code>. These scripts all have schedule entries that get
     placed in cron that determine when they run. Although cron scheduling
     is the default behavior, this can be controlled via configuration
     settings (see next section). The daily script runs at midnight, and if
     changes are detected since the last run (the night before), an e-mail
     noting the differences will be sent. The weekly script runs every
     Monday at 1:00 am, and only if changes to the last run (the week
     before) are found, a mail with the differences will be sent. The
     monthly script runs every on every 1st of the month and sends the full
     last daily and weekly report via e-mail.
    </p><div class="sect2 " id="sec.sec_prot.general.seccheck.config"><div class="titlepage"><div><div><h3 class="title" id="sec.sec_prot.general.seccheck.config"><span class="number">3.4.1 </span><span class="name">Seccheck Configuration</span> <a title="Permalink" class="permalink" href="cha.sec_prot.general.html#sec.sec_prot.general.seccheck.config">#</a></h3></div></div></div><p>
      Note that you can change the receiver of the seccheck mails from root
      to anyone else if you add an entry like this one to
      <code class="filename">/etc/sysconfig/seccheck</code>:
     </p><div class="verbatim-wrap"><pre class="screen">SECCHK_USER="firewall" # exchange firewall is an admin user's account name</pre></div><p>
      Also note that the <code class="envar">START_SECCHK</code> variable from
      <code class="filename">/etc/sysconfig/seccheck</code> controls whether the
      security check will be run from cron. (It is ignored if you call
      <code class="command">security-control</code> manually.)
     </p><p>
      The following daily checks are done:
     </p><div class="informaltable"><table border="1"><colgroup><col class="c1" /><col class="c2" /></colgroup><tbody><tr><td>
          <p>
           <code class="filename">/etc/passwd</code> check
          </p>
         </td><td>
          <p>
           length/number/contents of fields, accounts with same uid accounts
           with uid/gid of 0 or 1 beside root and bin
          </p>
         </td></tr><tr><td>
          <p>
           <code class="filename">/etc/shadow</code> check
          </p>
         </td><td>
          <p>
           length/number/contents of fields, accounts with no password
          </p>
         </td></tr><tr><td>
          <p>
           <code class="filename">/etc/group</code> check
          </p>
         </td><td>
          <p>
           length/number/contents of fields
          </p>
         </td></tr><tr><td>
          <p>
           user root checks
          </p>
         </td><td>
          <p>
           secure umask and <code class="envar">PATH</code>
          </p>
         </td></tr><tr><td>
          <p>
           <code class="filename">/etc/ftpusers</code>
          </p>
         </td><td>
          <p>
           checks if important system users are put there
          </p>
         </td></tr><tr><td>
          <p>
           <code class="filename">/etc/aliases</code>
          </p>
         </td><td>
          <p>
           checks for mail aliases which execute programs
          </p>
         </td></tr><tr><td>
          <p>
           <code class="filename">.rhosts</code> check
          </p>
         </td><td>
          <p>
           checks if users' <code class="filename">.rhosts</code> file contain +
           signs
          </p>
         </td></tr><tr><td>
          <p>
           homedirectory
          </p>
         </td><td>
          <p>
           checks if home directories are writable or owned by someone else
          </p>
         </td></tr><tr><td>
          <p>
           dot-files check
          </p>
         </td><td>
          <p>
           checks many dot-files in the home directories if they are
           writable or owned by someone else
          </p>
         </td></tr><tr><td>
          <p>
           mailbox check
          </p>
         </td><td>
          <p>
           checks if user mailboxes are owned by user and are readable
          </p>
         </td></tr><tr><td>
          <p>
           NFS export check
          </p>
         </td><td>
          <p>
           exports should not be exported globally
          </p>
         </td></tr><tr><td>
          <p>
           NFS import check
          </p>
         </td><td>
          <p>
           NFS mounts should have the <code class="option">nosuid</code> option set
          </p>
         </td></tr><tr><td>
          <p>
           promisc check
          </p>
         </td><td>
          <p>
           checks if network cards are in promiscuous mode
          </p>
         </td></tr><tr><td>
          <p>
           list modules
          </p>
         </td><td>
          <p>
           lists loaded modules
          </p>
         </td></tr><tr><td>
          <p>
           list sockets
          </p>
         </td><td>
          <p>
           lists open ports
          </p>
         </td></tr><tr><td colspan="2">
          <p>
           Weekly Checks are as follows:
          </p>
         </td></tr><tr><td>
          <p>
           password check
          </p>
         </td><td>
          <p>
           runs <code class="command">john</code> to crack the password file, user
           will get an e-mail notice to change his password
          </p>
         </td></tr><tr><td>
          <p>
           RPM md5 check
          </p>
         </td><td>
          <p>
           checks for changed files via RPM's MD5 checksum feature
          </p>
         </td></tr><tr><td>
          <p>
           suid/sgid check
          </p>
         </td><td>
          <p>
           lists all suid and sgid files
          </p>
         </td></tr><tr><td>
          <p>
           exec group write
          </p>
         </td><td>
          <p>
           lists all executables which are group/world-writable
          </p>
         </td></tr><tr><td>
          <p>
           writable check
          </p>
         </td><td>
          <p>
           lists all files which are world-writable (including executables)
          </p>
         </td></tr><tr><td>
          <p>
           device check
          </p>
         </td><td>
          <p>
           lists all devices
          </p>
         </td></tr></tbody></table></div><p>
      Additional monthly checks are also run, however the key difference is
      mainly that the monthly file is not a diff like the daily/weekly ones
      but the full reports in one file.
     </p></div><div class="sect2 " id="sec.sec_prot.general.seccheck.autologout"><div class="titlepage"><div><div><h3 class="title" id="sec.sec_prot.general.seccheck.autologout"><span class="number">3.4.2 </span><span class="name">Automatic Logout</span> <a title="Permalink" class="permalink" href="cha.sec_prot.general.html#sec.sec_prot.general.seccheck.autologout">#</a></h3></div></div></div><p>
      The <code class="systemitem">seccheck</code> package provides an automatic
      logout feature. It is a script that runs every 10 minutes and checks
      both remote or local terminal sessions for inactivity, and terminates
      them if an idle time is exceeded.
     </p><p>
      You can configure the functionality in the
      <code class="filename">/etc/security/autologout.conf</code> file. Parameters
      include default idle and logout delay times, and the configuration for
      limiting maximum idle times specific to users, groups, TTY devices and
      SSH sessions. <code class="filename">/etc/security/autologout.conf</code> also
      includes several configuration examples.
     </p><div id="idm139924376456992" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.png" /><h6>Tip</h6><p>
       The automatic logout feature is not enabled by default. To enable it,
       edit <code class="filename">/etc/cron.d/autologout</code> and uncomment the
       example cron line.
      </p></div></div></div><div class="sect1 " id="sec.sec_prot.general.retiring"><div class="titlepage"><div><div><h2 class="title" id="sec.sec_prot.general.retiring"><span class="number">3.5 </span><span class="name">Retiring Linux Servers with Sensitive Data</span> <a title="Permalink" class="permalink" href="cha.sec_prot.general.html#sec.sec_prot.general.retiring">#</a></h2></div></div></div><p>

     Security policies usually contain some procedures for the treatment of
     storage media that is going to be retired or disposed of. Disk and
     media wipe procedures are frequently prescribed as is complete
     destruction of the media. You can find several free tools on the
     Internet. A search of <span class="quote">“<span class="quote">dod disk wipe utility</span>”</span> will yield
     several variants. To retire servers with sensitive data, it is
     important to ensure that data cannot be recovered from the hard disks.
     To ensure that all traces of data are removed, a wipe
     utility—such as <code class="command">scrub</code>—can be used.
     Many wipe utilities overwrite the data several times. This
     assures that even sophisticated methods are not able to retrieve
     any parts of the wiped data. Some tools can even be operated from a
     bootable removable device and remove data according to the U.S.
     Department of Defense (DoD) standards. Note that many government
     agencies specify their own standards for data security. Some
     standards are stronger than others, yet may require more time to
     implement.
    </p><div id="idm139924376451696" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.png" /><h6>Important: Wiping Wear Leveling Devices</h6><p>
      Some devices, like SSDs, use wear leveling and do not necessarily
      write new data in the same physical locations. Such devices
      usually provide their own erasing functionality.
     </p></div><div class="sect2 " id="sec.sec_prot.general.retiring.scrub"><div class="titlepage"><div><div><h3 class="title" id="sec.sec_prot.general.retiring.scrub"><span class="number">3.5.1 </span><span class="name">scrub: Disk Overwrite Utility</span> <a title="Permalink" class="permalink" href="cha.sec_prot.general.html#sec.sec_prot.general.retiring.scrub">#</a></h3></div></div></div><p>
      <code class="command">scrub</code> overwrites hard disks, files, and other
      devices with repeating patterns intended to make recovering data from
      these devices more difficult. It operates in three basic modes: on a
      character or block device, on a file, or on a directory specified. For
      more information, set the manual page <code class="command">man 1 scrub</code>.
     </p><div class="variablelist "><div class="variablelist-title-wrap"><h6 class="variablelist-title"><span class="name">Supported Scrub Methods </span><a title="Permalink" class="permalink" href="cha.sec_prot.general.html#idm139924417326976">#</a></h6></div><dl class="variablelist"><dt id="idm139924417326240"><span class="term ">nnsa</span></dt><dd><p>
         4-pass NNSA Policy Letter NAP-14.1-C (XVI-8) for sanitizing
         removable and non-removable hard disks, which requires overwriting
         all locations with a pseudo random pattern twice and then with a
         known pattern: ran- dom(x2), 0x00, verify.
        </p></dd><dt id="idm139924417324176"><span class="term ">dod</span></dt><dd><p>
         4-pass DoD 5220.22-M section 8-306 procedure (d) for sanitizing
         removable and non-removable rigid disks which requires overwriting
         all addressable locations with a character, its complement, a
         random character, then verify. NOTE: scrub performs the random pass
         first to make verification easier: random, 0x00, 0xff, verify.
        </p></dd><dt id="idm139924420321392"><span class="term ">bsi</span></dt><dd><p>
         9-pass method recommended by the German Center of Security in
         Information Technologies
         (<a class="link" href="http://www.bsi.bund.de" target="_blank">http://www.bsi.bund.de</a>): 0xff, 0xfe, 0xfd,
         0xfb, 0xf7, 0xef, 0xdf, 0xbf, 0x7f.
        </p></dd><dt id="idm139924420318880"><span class="term ">gutmann</span></dt><dd><p>
         The canonical 35-pass sequence described in Gutmann's paper cited
         below.
        </p></dd><dt id="idm139924420317008"><span class="term ">schneier</span></dt><dd><p>
         7-pass method described by Bruce Schneier in "Applied Cryptography"
         (1996): 0x00, 0xff, random(x5)
        </p></dd><dt id="idm139924417322896"><span class="term ">pfitzner7</span></dt><dd><p>
         Roy Pfitzner's 7-random-pass method: random(x7).
        </p></dd><dt id="idm139924419853040"><span class="term ">pfitzner33</span></dt><dd><p>
         Roy Pfitzner's 33-random-pass method: random(x33).
        </p></dd><dt id="idm139924419851200"><span class="term ">usarmy</span></dt><dd><p>
         US Army AR380-19 method: 0x00, 0xff, random. (Note: identical to
         DoD 522.22-M section 8-306 procedure (e) for sanitizing magnetic
         core memory).
        </p></dd><dt id="idm139924419849248"><span class="term ">fillzero</span></dt><dd><p>
         1-pass pattern: 0x00.
        </p></dd><dt id="idm139924419847424"><span class="term ">fillff</span></dt><dd><p>
         1-pass pattern: 0xff.
        </p></dd><dt id="idm139924415013072"><span class="term ">random</span></dt><dd><p>
         1-pass pattern: random(x1).
        </p></dd><dt id="idm139924415011248"><span class="term ">random2</span></dt><dd><p>
         2-pass pattern: random(x2).
        </p></dd><dt id="idm139924415009424"><span class="term ">old</span></dt><dd><p>
         6-pass pre-version 1.7 scrub method: 0x00, 0xff, 0xaa, 0x00, 0x55,
         verify.
        </p></dd><dt id="idm139924415007344"><span class="term ">fastold</span></dt><dd><p>
         5-pass pattern: 0x00, 0xff, 0xaa, 0x55, verify.
        </p></dd><dt id="idm139924415005584"><span class="term ">custom=string</span></dt><dd><p>
         1-pass custom pattern. String may contain C-style numerical
         escapes: \nnn (octal) or \xnn (hex).
        </p></dd></dl></div></div></div><div class="sect1 " id="sec.sec_prot.general.backups"><div class="titlepage"><div><div><h2 class="title" id="sec.sec_prot.general.backups"><span class="number">3.6 </span><span class="name">Backups</span> <a title="Permalink" class="permalink" href="cha.sec_prot.general.html#sec.sec_prot.general.backups">#</a></h2></div></div></div><p>
     If your system is compromised, backups can be used to restore a prior
     system state. When bugs or accidents occur, backups can also be used to
     compare the current system against an older version. For production
     systems, it is very important to take some backups off-site for cases
     like disasters (for example off-site storage of tapes/recordable media,
     or off-site initiated).
    </p><p>
     For legal reasons, some firms and organizations must be careful about
     backing up too much information and holding it too long. If your
     environment has a policy regarding the destruction of old paper files,
     you might need to extend this policy to Linux backup tapes as well.
    </p><p>
     The rules about physical security of servers apply on backups as well.
    </p></div><div class="sect1 " id="sec.sec_prot.general.partitions"><div class="titlepage"><div><div><h2 class="title" id="sec.sec_prot.general.partitions"><span class="number">3.7 </span><span class="name">Disk Partitions</span> <a title="Permalink" class="permalink" href="cha.sec_prot.general.html#sec.sec_prot.general.partitions">#</a></h2></div></div></div><p>
     Servers should have separate file systems for at least
     <code class="filename">/</code>, <code class="filename">/boot</code>,
     <code class="filename">/usr</code>, <code class="filename">/var</code>,
     <code class="filename">/tmp</code>, and <code class="filename">/home</code>. You do not
     want that for example logging and temporary space under
     <code class="filename">/var</code> and <code class="filename">/tmp</code> fill up the
     root partition. Third-party applications should be on separate file
     systems as well, for example under <code class="filename">/opt</code>.
    </p><p>
     You are advised to review <a class="xref" href="part.setup_for_eal.html" title="Part I. Common Criteria">Part I, “Common Criteria”</a>. It is
     important to understand the need to separate the partitions that could
     impact a running system (for example, log files filling up
     <code class="filename">/var/log</code> are a good reason to separate
     <code class="filename">/var</code> from the <code class="filename">/</code> partition).
     Another thing to keep in mind is that you will likely need to leverage
     LVM or another volume manager or at the very least the extended
     partition type to work around the limitations of primary partitions (4
     partitions).
    </p><p>
     Another capability in <span class="productname"><span class="phrase">SUSE Linux Enterprise Server</span></span> is encrypting a partition or
     even a single directory or file as a container. Refer to
     <a class="xref" href="cha.security.cryptofs.html" title="Chapter 11. Encrypting Partitions and Files">Chapter 11, <em>Encrypting Partitions and Files</em></a> for details.
    </p></div><div class="sect1 " id="sec.sec_prot.general.firewall"><div class="titlepage"><div><div><h2 class="title" id="sec.sec_prot.general.firewall"><span class="number">3.8 </span><span class="name">Firewall (iptables)</span> <a title="Permalink" class="permalink" href="cha.sec_prot.general.html#sec.sec_prot.general.firewall">#</a></h2></div></div></div><p>
     iptables will not be covered in detail in this guide. Most companies
     use dedicated firewalls or appliances to protect their servers in a
     production network. This is strongly recommended for secure
     environments. <span class="productname"><span class="phrase">SUSE Linux Enterprise Server</span></span> also includes SuSEFirewall2 which is
     a wrapper for iptables and is enabled by default as a simple and
     layered protection.
    </p><p>
     If you are also interested in Linux stateful firewalls using iptables,
     there are many guides on the Internet. See the Appendix for resources.
     For lots of iptables tutorials and examples, see
     <a class="link" href="http://www.linuxguruz.com/iptables/" target="_blank">http://www.linuxguruz.com/iptables/</a>.

    </p></div><div class="sect1 " id="sec.sec_prot.general.kernel"><div class="titlepage"><div><div><h2 class="title" id="sec.sec_prot.general.kernel"><span class="number">3.9 </span><span class="name">Security Features in the Kernel</span> <a title="Permalink" class="permalink" href="cha.sec_prot.general.html#sec.sec_prot.general.kernel">#</a></h2></div></div></div><p>
     The following list shows tunable kernel parameters you can use to
     secure your Linux server against attacks. Some are defaults
     already within the SLE distributions. To check the current status of
     any of these settings, you can query the kernel
     (<code class="filename">/proc/sys/...</code> contents). For example, the Source
     Routing setting is located in the
     <code class="filename">/proc/sys/net/ipv4/conf/all/accept_source_route</code>
     file. Simply display the contents of a file to see how the current
     running kernel is set up.
    </p><p>
     For each tunable kernel parameter shown, the change to the entry that
     needs to be affected can be modified or added to the
     <code class="filename">/etc/sysctl.conf</code> configuration file to make the
     change persistent after a reboots.
    </p><p>
     You can get a list of current kernel settings by using the command:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>sysctl -a</pre></div><p>
     It is even a very good idea to store the output of the kernel settings
     (for comparison or reference) by redirecting the output of the sysctl
     command to a file, for example
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>sysctl -A &gt; /root/sysctl.settings.store</pre></div><p>
     Because <span class="productname"><span class="phrase">SUSE Linux Enterprise Server</span></span> includes, by default, security-focused kernel
     tuning parameters, you will find the existing
     <code class="filename">/etc/sysctl.conf</code> file to be sparsely populated.
     You may choose to use the above mentioned <span class="quote">“<span class="quote">catalog</span>”</span> method
     of storing the complete gamut of kernel settings and then choose those
     parameters you want to be reset at reboot. You can place these in the
     <code class="filename">/etc/sysctl.conf</code> file where they will be picked up
     upon a reboot or they can be inserted immediately (into the running
     kernel) by running the command <code class="command">sysctl</code>
     <code class="option">-p</code>.
    </p><p>
     Many third-party applications like Oracle, SAP, DB2, Websphere, etc.
     recommend changing kernel parameters to ensure high performance for I/O
     or CPU processing. Having a full list of current settings can be
     helpful for reference.
    </p><div class="sect2 " id="sec.sec_prot.general.kernel_syn_cookie"><div class="titlepage"><div><div><h3 class="title" id="sec.sec_prot.general.kernel_syn_cookie"><span class="number">3.9.1 </span><span class="name">Enable TCP SYN Cookie Protection (default in <span class="productname"><span class="phrase">SUSE Linux Enterprise Server</span></span> <span class="productnumber"><span class="phrase">12 SP3</span></span>)</span> <a title="Permalink" class="permalink" href="cha.sec_prot.general.html#sec.sec_prot.general.kernel_syn_cookie">#</a></h3></div></div></div><p>
      A SYN attack is a denial of service attack that consumes all the
      resources on a machine. Any server that is connected to a network is
      potentially subject to this attack. To enable TCP SYN Cookie
      Protection, edit the <code class="filename">/etc/sysctl.conf</code> file and
      ensure the following line and value exists:
     </p><div class="verbatim-wrap"><pre class="screen">net.ipv4.tcp_syncookies = 1</pre></div><div id="idm139924416082496" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note</h6><p>
       Despite the name of the configuration option, it applies to IP
       version 6 as well.
      </p></div></div><div class="sect2 " id="sec.sec_prot.general.route"><div class="titlepage"><div><div><h3 class="title" id="sec.sec_prot.general.route"><span class="number">3.9.2 </span><span class="name">Disable IP Source Routing (default in <span class="productname"><span class="phrase">SUSE Linux Enterprise Server</span></span> <span class="productnumber"><span class="phrase">12 SP3</span></span>)</span> <a title="Permalink" class="permalink" href="cha.sec_prot.general.html#sec.sec_prot.general.route">#</a></h3></div></div></div><p>
      Source Routing is used to specify a path or route through the network
      from source to destination. This feature can be used by network people
      for diagnosing problems. However, if an intruder was able to send a
      source routed packet into the network, then he could intercept the
      replies and your server might not know that it is not communicating
      with a trusted server.
     </p><div class="verbatim-wrap"><pre class="screen">net.ipv4.conf.all.accept_source_route = 0</pre></div><p>
      or
     </p><div class="verbatim-wrap"><pre class="screen">net.ipv6.conf.all.accept_source_route = 0</pre></div></div><div class="sect2 " id="sec.sec_prot.general.icpm_redirect"><div class="titlepage"><div><div><h3 class="title" id="sec.sec_prot.general.icpm_redirect"><span class="number">3.9.3 </span><span class="name">Disable ICMP Redirect Acceptance</span> <a title="Permalink" class="permalink" href="cha.sec_prot.general.html#sec.sec_prot.general.icpm_redirect">#</a></h3></div></div></div><p>
      ICMP redirects are used by routers to tell the server that there is a
      better path to other networks than the one chosen by the server.
      However, an intruder could potentially use ICMP redirect packets to
      alter the host's routing table by causing traffic to use a path you
      did not intend. To disable ICMP Redirect Acceptance, edit the
      <code class="filename">/etc/sysctl.conf</code> file and add the following line:
     </p><div class="verbatim-wrap"><pre class="screen">net.ipv4.conf.all.accept_redirects = 0</pre></div><p>
      or
     </p><div class="verbatim-wrap"><pre class="screen">net.ipv6.conf.all.accept_redirects = 0</pre></div></div><div class="sect2 " id="sec.sec_prot.general.ip_spoofing"><div class="titlepage"><div><div><h3 class="title" id="sec.sec_prot.general.ip_spoofing"><span class="number">3.9.4 </span><span class="name">Enable IP Spoofing Protection (default in <span class="productname"><span class="phrase">SUSE Linux Enterprise Server</span></span> <span class="productnumber"><span class="phrase">12 SP3</span></span>)</span> <a title="Permalink" class="permalink" href="cha.sec_prot.general.html#sec.sec_prot.general.ip_spoofing">#</a></h3></div></div></div><p>
      IP spoofing is a technique where an intruder sends out packets which
      claim to be from another host by manipulating the source address. IP
      spoofing is very often used for denial of service attacks. For more
      information on IP Spoofing, see
      <a class="link" href="http://en.wikipedia.org/wiki/IP_address_spoofing" target="_blank">http://en.wikipedia.org/wiki/IP_address_spoofing</a>
     </p><div class="verbatim-wrap"><pre class="screen">net.ipv4.conf.all.rp_filter = 1</pre></div></div><div class="sect2 " id="sec.sec_prot.general.icpm_ignore"><div class="titlepage"><div><div><h3 class="title" id="sec.sec_prot.general.icpm_ignore"><span class="number">3.9.5 </span><span class="name">Enable Ignoring to ICMP Requests</span> <a title="Permalink" class="permalink" href="cha.sec_prot.general.html#sec.sec_prot.general.icpm_ignore">#</a></h3></div></div></div><p>
      If you want or need Linux to ignore <code class="command">ping</code> requests,
      edit the <code class="filename">/etc/sysctl.conf</code> file and add the
      following line:
     </p><div class="verbatim-wrap"><pre class="screen">net.ipv4.icmp_echo_ignore_all = 1</pre></div><p>
      This cannot be done in many environments, as some monitoring systems
      use a rudimentary ICMP (ping) to determine the health of the device on
      the network (or at least its ability to respond).
     </p></div><div class="sect2 " id="sec.sec_prot.general.broadcast"><div class="titlepage"><div><div><h3 class="title" id="sec.sec_prot.general.broadcast"><span class="number">3.9.6 </span><span class="name">Enable Ignoring Broadcasts Request (default in <span class="productname"><span class="phrase">SUSE Linux Enterprise Server</span></span> <span class="productnumber"><span class="phrase">12 SP3</span></span>)</span> <a title="Permalink" class="permalink" href="cha.sec_prot.general.html#sec.sec_prot.general.broadcast">#</a></h3></div></div></div><p>
      If you want or need Linux to ignore broadcast requests.
     </p><div class="verbatim-wrap"><pre class="screen">net.ipv4.icmp_echo_ignore_broadcasts = 1</pre></div></div><div class="sect2 " id="sec.sec_prot.general.errormsg"><div class="titlepage"><div><div><h3 class="title" id="sec.sec_prot.general.errormsg"><span class="number">3.9.7 </span><span class="name">Enable Bad Error Message Protection (default in <span class="productname"><span class="phrase">SUSE Linux Enterprise Server</span></span> <span class="productnumber"><span class="phrase">12 SP3</span></span>)</span> <a title="Permalink" class="permalink" href="cha.sec_prot.general.html#sec.sec_prot.general.errormsg">#</a></h3></div></div></div><p>
      To alert you about bad error messages in the network.
     </p><div class="verbatim-wrap"><pre class="screen">net.ipv4.icmp_ignore_bogus_error_responses = 1</pre></div></div><div class="sect2 " id="sec.sec_prot.general.logging"><div class="titlepage"><div><div><h3 class="title" id="sec.sec_prot.general.logging"><span class="number">3.9.8 </span><span class="name">Enable Logging of Spoofed Packets, Source Routed Packets, Redirect Packets</span> <a title="Permalink" class="permalink" href="cha.sec_prot.general.html#sec.sec_prot.general.logging">#</a></h3></div></div></div><p>
      To turn on logging for Spoofed Packets, Source Routed Packets, and
      Redirect Packets, edit the <code class="filename">/etc/sysctl.conf</code> file
      and add the following line:
     </p><div class="verbatim-wrap"><pre class="screen">net.ipv4.conf.all.log_martians = 1</pre></div><div id="idm139924412279152" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note</h6><p>
       Because of the way <span class="productname"><span class="phrase">SUSE Linux Enterprise Server</span></span> is set up (with rsyslog) for
       network event tracking, keep in mind that this can cause a large
       amount of messages to be logged.
      </p></div></div><div class="sect2 " id="sec.sec_prot.general.add_random"><div class="titlepage"><div><div><h3 class="title" id="sec.sec_prot.general.add_random"><span class="number">3.9.9 </span><span class="name">Buffer Overflow Attack Mitigation</span> <a title="Permalink" class="permalink" href="cha.sec_prot.general.html#sec.sec_prot.general.add_random">#</a></h3></div></div></div><p>
      Starting with the 2.6.x kernel releases, Linux offers
      <span class="emphasis"><em>Address Space Layout Randomization</em></span> (ASLR) and
      the <span class="emphasis"><em>No-eXecute</em></span> (NX bit) for mitigation of
      buffer overflow attacks. For more information, see:
     </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
        <a class="link" href="http://searchenterpriselinux.techtarget.com/tip/Linux-virtual-address-randomization-and-impacting-buffer-overflows" target="_blank">http://searchenterpriselinux.techtarget.com/tip/Linux-virtual-address-randomization-and-impacting-buffer-overflows</a>
       </p></li><li class="listitem "><p>
        <a class="link" href="https://en.wikipedia.org/wiki/Address_space_layout_randomization" target="_blank">https://en.wikipedia.org/wiki/Address_space_layout_randomization</a>
       </p></li><li class="listitem "><p>
        <a class="link" href="https://en.wikipedia.org/wiki/NX_bit" target="_blank">https://en.wikipedia.org/wiki/NX_bit</a>
       </p></li></ul></div><p>
      Since version 12, <span class="productname"><span class="phrase">SUSE Linux Enterprise Server</span></span> already comes with some buffer
      overflow attack mitigation techniques being enabled by default.
     </p><p>
      ASLR is enabled by default. This can be verified with the output
      of the following command. The expected result is 2:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>cat /proc/sys/kernel/randomize_va_space
2</pre></div><p>
      This randomizes the heap, stack, and load addresses of dynamically
      linked libraries. Programs that run privileged or process network data
      are already built using special compiler flags (PIE and
      _FORTIFY_SOURCE) to take even more advantage of randomizing the text
      and data segments as well.
     </p><p>
      Executable space protection prevents the execution of memory space
      that is not intended for execution. Linux makes use of the
      <span class="emphasis"><em>No eXecute bit</em></span>. This is enabled by default on
      the <span class="productname"><span class="phrase">SUSE Linux Enterprise Server</span></span> kernel for the x86 and AMD64/Intel 64 architecture.
      Use of the NX bit has to be supported by each individual
      program. You can check if your system supports the NX bit:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>dmesg | grep '[NX|DX]*protection'
[    0.000000] NX (Execute Disable) protection: active</pre></div><p>If NX is disabled, check your BIOS or UEFI for a setting that
      enables it and make sure that it is supported by your CPU.</p><p>
      Furthermore, since version 12, <span class="productname"><span class="phrase">SUSE Linux Enterprise Server</span></span> prevents leaking of
      internal kernel addresses to make kernel exploits harder by setting
      the <code class="literal">kptr_restrict</code>:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>cat /proc/sys/kernel/kptr_restrict
1</pre></div><p>
      On CPU's that support it (newer AMD64/Intel 64 CPUs) the kernel also uses the
      SMEP protection by default that prevents direct execution of user space
      code from inside the kernel. This is often used by kernel exploits and
      therefore a good hardening measure.
     </p></div><div class="sect2 " id="sec.sec_prot.general.file_system"><div class="titlepage"><div><div><h3 class="title" id="sec.sec_prot.general.file_system"><span class="number">3.9.10 </span><span class="name">File system hardening</span> <a title="Permalink" class="permalink" href="cha.sec_prot.general.html#sec.sec_prot.general.file_system">#</a></h3></div></div></div><p>
      To mitigate vulnerabilities based on insecure file system access by
      privileged programs (tmp-races, TOCTOU) the Linux kernel offers two
      <code class="command">sysctl</code> variables which should already be enabled by
      default on <span class="productname"><span class="phrase">SUSE Linux Enterprise Server</span></span> <span class="productnumber"><span class="phrase">12 SP3</span></span>:
      <code class="literal">fs.protected_hardlinks</code> and
      <code class="literal">fs.protected_symlinks</code> or their corresponding
      <code class="filename">/proc</code> entries:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>cat /proc/sys/fs/protected_hardlinks
1</pre></div><p>
      By setting this to <code class="literal">1</code>, users can no longer create soft
      or hard links to files which they do not own. This mitigates a commonly
      used exploitation vector for programs which call open(2), creat(2) or
      similar functions without care.
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>cat /proc/sys/fs/protected_symlinks
1</pre></div><p>
      By setting this to <code class="literal">1</code>, symbolic links are permitted to
      be followed only when outside a sticky world-writable directory, or when
      the uid of the link and follower match, or when the directory owner
      matches the symlink's owner.
     </p></div><div class="sect2 " id="sec.sec_prot.general.dmesg"><div class="titlepage"><div><div><h3 class="title" id="sec.sec_prot.general.dmesg"><span class="number">3.9.11 </span><span class="name">Increased <code class="command">dmesg</code> Restrictions</span> <a title="Permalink" class="permalink" href="cha.sec_prot.general.html#sec.sec_prot.general.dmesg">#</a></h3></div></div></div><p>
      <code class="command">dmesg</code> provides all kinds of system internal
      information, such as kernel addresses, crashes of services, and
      similar things that could be used by local attackers. This is why the
      access to <code class="command">dmesg</code> is restricted to <code class="systemitem">root</code> by
      default. The behavior is controlled by the
      <code class="literal">kernel.dmesg_restrict</code> option (defaults to 1). If
      set to 0, any user can view the output of <code class="command">dmesg</code>.
     </p></div><div class="sect2 " id="sec.sec_prot.general.devmem"><div class="titlepage"><div><div><h3 class="title" id="sec.sec_prot.general.devmem"><span class="number">3.9.12 </span><span class="name">
      Filter access to <code class="filename">/dev/mem</code> (default in
      <span class="productname"><span class="phrase">SUSE Linux Enterprise Server</span></span> 12)
     </span> <a title="Permalink" class="permalink" href="cha.sec_prot.general.html#sec.sec_prot.general.devmem">#</a></h3></div></div></div><p>
      <code class="filename">/dev/mem</code> hosts an image of the system's main
      memory, including kernel and user space memory. Allowing unfiltered
      access to this information is dangerous and therefore the kernel on
      <span class="productname"><span class="phrase">SUSE Linux Enterprise Server</span></span> has been compiled with <code class="envar">CONFIG_STRICT_DEVMEM</code>
      enabled. This setting restricts user space access to
      <code class="filename">/dev/mem</code> to memory mapped peripherals.
     </p></div></div><div class="sect1 " id="sec.sec_prot.general.aa"><div class="titlepage"><div><div><h2 class="title" id="sec.sec_prot.general.aa"><span class="number">3.10 </span><span class="name"><span class="phrase">AppArmor</span></span> <a title="Permalink" class="permalink" href="cha.sec_prot.general.html#sec.sec_prot.general.aa">#</a></h2></div></div></div><p>
     Included with <span class="productname"><span class="phrase">SUSE Linux Enterprise Server</span></span>, <span class="phrase">AppArmor</span> is an application security tool
     designed to provide an easy-to-use security framework for your
     applications. <span class="phrase">AppArmor</span> proactively protects the operating system and
     applications from external or internal threats, even zero-day
     attacks, by enforcing a specified behavior and preventing some
     unknown application flaws from being exploited. <span class="phrase">AppArmor</span> security
     policies, called <span class="quote">“<span class="quote">profiles</span>”</span>, completely define which system
     resources and files can be accessed by each application. The
     profiles also define the access mode, for example read or write.
     Several default profiles are included with <span class="phrase">AppArmor</span>, and using a
     combination of advanced static analysis and learning-based tools,
     <span class="phrase">AppArmor</span> profiles for even very complex applications can be deployed
     successfully in a matter of hours.
    </p><p>
     <span class="phrase">AppArmor</span> consists of:
    </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
       A kernel extension which enforces the security profiles.
      </p></li><li class="listitem "><p>
       A collection of RPMs, also shipped with <span class="productname"><span class="phrase">SUSE Linux Enterprise Server</span></span> that
       provides:
      </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
         A set of <span class="phrase">AppArmor</span> profiles for numerous programs that ship with
         <span class="productname"><span class="phrase">SUSE Linux Enterprise Server</span></span>.
        </p></li><li class="listitem "><p>
         Tools to create and manage new and existing <span class="phrase">AppArmor</span> profiles.
        </p></li><li class="listitem "><p>
         A YaST user interface to manage reports and notification of
         security events.
        </p></li><li class="listitem "><p>
         Documentation about the <span class="phrase">AppArmor</span> tools.
        </p></li></ul></div></li></ul></div><p>
     It is best to reboot a system after completing installation, so that
     <span class="phrase">AppArmor</span> can confine all system daemons.
    </p><p>
     The <span class="phrase">AppArmor</span> quick-start and administrative guides are available online
     here:
    </p><p>
     <a class="link" href="http://www.suse.com/documentation/apparmor/" target="_blank">http://www.suse.com/documentation/apparmor/</a>
    </p><p>
     For additional details and step-by-step instructions on the usage and
     configuration of <span class="phrase">AppArmor</span> you can also refer to
     <a class="xref" href="part.apparmor.html" title="Part IV. Confining Privileges with AppArmor">Part IV, “Confining Privileges with <span class="phrase">AppArmor</span>”</a>.
    </p></div><div class="sect1 " id="sec.sec_prot.general.selinux"><div class="titlepage"><div><div><h2 class="title" id="sec.sec_prot.general.selinux"><span class="number">3.11 </span><span class="name">SELinux</span> <a title="Permalink" class="permalink" href="cha.sec_prot.general.html#sec.sec_prot.general.selinux">#</a></h2></div></div></div><p>
     SELinux is an advanced technology for securing Linux systems. It is
     included with <span class="quote">“<span class="quote">basic enablement</span>”</span> in <span class="productname"><span class="phrase">SUSE Linux Enterprise Server</span></span>
     <span class="productnumber"><span class="phrase">12 SP3</span></span>, and is included with some other distributions by
     default. Hardening Linux using SELinux technology, on its own, warrants
     its own security HOWTO and is out of scope for this guide. The book <a class="link" href="http://shop.oreilly.com/product/9780596007164.do" target="_blank">SELinux:
     NSA's Open Source Security Enhanced Linux</a> contains a very good
     description of its setup and usage. As part of the <span class="quote">“<span class="quote">basic
     enablement</span>”</span>, SELinux will not be officially supported, but
     packages have now been added to <span class="productname"><span class="phrase">SUSE Linux Enterprise Server</span></span> <span class="productnumber"><span class="phrase">12 SP3</span></span> to enable
     its usage with minimal effort. While <span class="phrase">AppArmor</span> is much easier to use and has a
     similar feature set, knowing both will most certainly be beneficial.
    </p></div><div class="sect1 " id="sec.sec_prot.general.remote"><div class="titlepage"><div><div><h2 class="title" id="sec.sec_prot.general.remote"><span class="number">3.12 </span><span class="name">FTP, <code class="command">telnet</code>, and <code class="command">rlogin</code> (rsh)</span> <a title="Permalink" class="permalink" href="cha.sec_prot.general.html#sec.sec_prot.general.remote">#</a></h2></div></div></div><p>
     The programs/protocols of FTP, <code class="command">telnet</code>, and
     <code class="command">rlogin</code> (<code class="command">rsh</code>) are vulnerable to
     eavesdropping, which is one of the main reasons secure alternatives
     such as <code class="command">ssh</code>, <code class="command">scp</code> or
     <code class="command">sftp</code> should be used instead. It is highly
     recommended not to run the insecure services. Because of the high risk,
     this guide does not cover these services (other than vsftp). It would
     also be a good idea (and part of our guidance, see next section) not to
     have FTP and Telnet server RPMs installed on the system. Note that the
     EAL 4+ evaluation had vsftp installed. The <span class="quote">“<span class="quote">vs</span>”</span> stands for
     <span class="quote">“<span class="quote">very secure</span>”</span>—which is a differentiator here when
     compared to normal FTP.
    </p></div><div class="sect1 " id="sec.sec_prot.general.remove_packs"><div class="titlepage"><div><div><h2 class="title" id="sec.sec_prot.general.remove_packs"><span class="number">3.13 </span><span class="name">Removing Unnecessary Software Packages (RPMs)</span> <a title="Permalink" class="permalink" href="cha.sec_prot.general.html#sec.sec_prot.general.remove_packs">#</a></h2></div></div></div><p>
     A very important step in securing a Linux system is to determine the
     primary function(s) or role(s) of the Linux server. Otherwise, it can
     be difficult to understand what needs to be secured and securing these
     Linux systems can prove ineffective. Therefore, it is critical to look
     at the default list of software packages and remove any unnecessary
     packages or packages that do not comply with your defined security
     policies.
    </p><p>
     Doing this will result in fewer packages that require updates and will
     simplify maintenance efforts when security alerts and patches are
     released. It is a best practice not to install, among others,
     development packages or desktop software packages (for example, an X
     Server) on production servers. If you do not need them, you should also
     uninstall, for example, the Apache Web server or Samba file sharing
     server.
    </p><div id="idm139924410093888" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.png" /><h6>Important: Requirements of Third-party Installers</h6><p>
      Many third-party vendors like Oracle and IBM require a desktop
      environment and development libraries to run installers. To avoid this
      from having an impact on the security of their production servers,
      many organizations work around this by creating a silent installation
      (response file) in a development lab.
     </p></div><p>
     Also, other packages like FTP and Telnet daemons should not be
     installed as well unless there is a justified business reason for it
     (again, <code class="command">ssh</code>, <code class="command">scp</code> or
     <code class="command">sftp</code> should be used as replacements).
    </p><p>
     One of the first action items should be to create a Linux image that
     <span class="emphasis"><em>only</em></span> contains RPMs needed by the system and
     applications, and those needed for maintenance and troubleshooting
     purposes. A good approach is to start with a minimum list of RPMs and
     then add packages as needed. This process is time-consuming but usually
     worth the effort.
    </p><div id="idm139924389556000" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.png" /><h6>Tip: Just Enough Operating System (JeOS)</h6><p>
      The SUSE Appliance Program includes a component called JeOS (Just
      Enough Operating System). JeOS has a very small footprint and can be
      customized to fit the specific needs of a system developer. Main uses
      of JeOS are for hardware/software appliance or virtual machine
      development. Key benefits of JeOS are efficiency, higher performance,
      increased security and simplified management.
     </p><p>
      If JeOS is not an option for you, a good choice is the minimal
      installation pattern.
     </p></div><p>
     To generate a list of all installed RPMs, use the following command:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>rpm -qa</pre></div><p>
     To retrieve details about a particular RPM (from the RPM itself), run:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>rpm -qi <em class="replaceable ">PACKAGE_NAME</em></pre></div><p>
     To check for and report potential conflicts and dependencies when
     deleting an RPM, run:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>rpm -e --test <em class="replaceable ">PACKAGE_NAME</em></pre></div><p>
     This can be very useful, as running the removal command without a test
     can often yield a mass of complaints and require manual recursive
     dependency hunting.
    </p></div><div class="sect1 " id="sec.sec_prot.general.patching"><div class="titlepage"><div><div><h2 class="title" id="sec.sec_prot.general.patching"><span class="number">3.14 </span><span class="name">Patching Linux Systems</span> <a title="Permalink" class="permalink" href="cha.sec_prot.general.html#sec.sec_prot.general.patching">#</a></h2></div></div></div><p>
     Building an infrastructure for patch management is another very
     important part of a proactive and secure production Linux environment.
    </p><p>
     It is recommended to have a written security policy and procedure to
     handle Linux security updates and issues. For example, a security
     policy should detail the time frame for assessment, testing, and roll
     out of patches. Network related security vulnerabilities should get the
     highest priority and should be addressed immediately within a short
     time frame. The assessment phase should occur within a testing lab, and
     initial roll out should occur on development systems first
    </p><p>
     A separate security log file should contain details on which Linux
     security announcements have been received, which patches have been
     researched and assessed, when patches have been applied, etc.
    </p><p>
     SUSE releases their patches in three categories, security,
     recommended and optional. There are a few options that can be used to
     keep systems patched, up to date and secure. Each system can register
     and then retrieve updates via the SUSE Update Web site using the
     included YaST tool—YaST Online Update. SUSE has also
     created the Subscription Management Tool (SMT), an efficient way to maintain a
     local repository of available/released patches/updates/fixes that
     systems can then pull from (reducing Internet traffic). SUSE also
     offers SUSE Manager for the maintenance, patching, reporting and
     centralized management of Linux systems, not only SUSE, but other
     distributions as well.
    </p><div class="sect2 " id="sec.sec_prot.general.patching.you"><div class="titlepage"><div><div><h3 class="title" id="sec.sec_prot.general.patching.you"><span class="number">3.14.1 </span><span class="name">YaST Online Update</span> <a title="Permalink" class="permalink" href="cha.sec_prot.general.html#sec.sec_prot.general.patching.you">#</a></h3></div></div></div><p>
      On a per-server basis, installation of important updates and
      improvements is possible using the YaST Online Update tool.
      Current updates for the SUSE Linux Enterprise family are available from the product
      specific update catalogs containing patches. Installation of updates
      and improvements is accomplished using YaST and selecting
      <span class="guimenu">Online Update</span> in the <span class="guimenu">Software</span>
      Group. All new patches (except the optional ones) that are currently
      available for your system will already be marked for installation.
      Clicking <span class="guimenu">Accept</span> will then automatically install
      these patches.
     </p></div><div class="sect2 " id="sec.sec_prot.general.patching.auto"><div class="titlepage"><div><div><h3 class="title" id="sec.sec_prot.general.patching.auto"><span class="number">3.14.2 </span><span class="name">Automatic Online Update</span> <a title="Permalink" class="permalink" href="cha.sec_prot.general.html#sec.sec_prot.general.patching.auto">#</a></h3></div></div></div><p>
      YaST also offers the possibility to set up an automatic update.
      Select <span class="guimenu">Software</span> › <span class="guimenu"> Automatic
      Online Update</span>. Configure a Daily or a Weekly
      update. Some patches, such as kernel updates, require user
      interaction, which would cause the automatic update procedure to stop.
      Check <span class="guimenu">Skip Interactive Patches</span> for the update
      procedure to proceed automatically.
     </p><p>
      In this case, run a manual Online Update from time to install patches
      that require interaction.
     </p><p>
      When <span class="guimenu">Only Download Patches</span> is checked, the patches
      are downloaded at the specified time but not installed. They must be
      installed manually using <code class="command">rpm</code>or
      <code class="command">zypper</code>.
     </p></div><div class="sect2 " id="sec.sec_prot.general.patching.smt"><div class="titlepage"><div><div><h3 class="title" id="sec.sec_prot.general.patching.smt"><span class="number">3.14.3 </span><span class="name">Subscription Management Tool—SMT</span> <a title="Permalink" class="permalink" href="cha.sec_prot.general.html#sec.sec_prot.general.patching.smt">#</a></h3></div></div></div><p>
      The Subscription Management Tool for SUSE Linux Enterprise goes one step further than the Online
      Update process by establishing a proxy system with repository and
      registration targets. This helps customers centrally manage software
      updates within the firewall on a per-system basis, while maintaining
      their corporate security policies and regulatory compliance.
     </p><p>
      The downloadable SMT
      (<a class="link" href="http://download.suse.com/" target="_blank">http://download.suse.com/</a>) is integrated with
      SUSE Customer Center (<a class="link" href="https://scc.suse.com/" target="_blank">https://scc.suse.com/</a>) and provides a repository
      and registration target that is synchronized with it. This can be very
      helpful in tracking entitlements in large deployments. The SMT
      maintains all the capabilities of SUSE Customer Center, while allowing a more
      secure centralized deployment. It is included with every SUSE Linux Enterprise
      subscription and is therefore fully supported.
     </p><p>
      The SMT provides an alternative to the default configuration,
      which requires opening the firewall to outbound connections for each
      device to receive updates. That requirement often violates corporate
      security policies and can be seen as a threat to regulatory compliance
      by some organizations. Through its integration with SUSE Customer Center, the
      SMT ensures that each device can receive its appropriate updates
      without the need to open the firewall, and without any redundant
      bandwidth requirements.
     </p><p>
      The SMT also enables customers to locally track their SUSE Linux Enterprise
      devices (that is servers, desktops, or Point of Service terminals)
      throughout their enterprise. Now they can easily determine how many
      entitlements are in need of renewal at the end of a billing cycle
      without having to physically walk through the data center to manually
      update spreadsheets.
     </p><p>
      The SMT informs the SUSE Linux Enterprise devices of any available software
      updates. Each device then obtains the required software updates from
      the SMT. The introduction of the SMT improves the
      interaction among SUSE Linux Enterprise devices within the network and simplifies
      how they receive their system updates. The SMT enables an
      infrastructure for several hundred SUSE Linux Enterprise devices per instance of
      each installation (depending on the specific usage profile). This
      offers more accurate and efficient server tracking.
     </p><p>
      In a nutshell, the Subscription Management Tool for SUSE Linux Enterprise provides customers with:
     </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
        Assurance of firewall and regulatory compliance
       </p></li><li class="listitem "><p>
        Reduced bandwidth usage during software updates
       </p></li><li class="listitem "><p>
        Full support under active subscription from SUSE
       </p></li><li class="listitem "><p>
        Maintenance of existing customer interface with SUSE Customer Center
       </p></li><li class="listitem "><p>
        Accurate server entitlement tracking and effective measurement of
        subscription usage
       </p></li><li class="listitem "><p>
        Automated process to easily tally entitlement totals (no more
        spreadsheets!)
       </p></li><li class="listitem "><p>
        Simple installation process that automatically synchronizes server
        entitlement with SUSE Customer Center
       </p></li></ul></div></div><div class="sect2 " id="sec.sec_prot.general.patching.suma"><div class="titlepage"><div><div><h3 class="title" id="sec.sec_prot.general.patching.suma"><span class="number">3.14.4 </span><span class="name">SUSE Manager</span> <a title="Permalink" class="permalink" href="cha.sec_prot.general.html#sec.sec_prot.general.patching.suma">#</a></h3></div></div></div><p>
      SUSE Manager automates Linux server management, allowing you to provision
      and maintain your servers faster and more accurately. It monitors the
      health of each Linux server from a single console so you can identify
      server performance issues before they impact your business. And it lets
      you comprehensively manage your Linux servers across physical, virtual
      and cloud environments while improving data center efficiency. SUSE Manager
      delivers complete life cycle management for Linux:
     </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
        Asset management
       </p></li><li class="listitem "><p>
        Provisioning
       </p></li><li class="listitem "><p>
        Package management
       </p></li><li class="listitem "><p>
        Patch management
       </p></li><li class="listitem "><p>
        Configuration management
       </p></li><li class="listitem "><p>
        Redeployment
       </p></li></ul></div><p>
      For more information on SUSE Manager refer to <a class="link" href="https://www.suse.com/products/suse-manager/" target="_blank">https://www.suse.com/products/suse-manager/</a>.
     </p></div></div><div class="sect1 " id="sec.sec_prot.general.ports"><div class="titlepage"><div><div><h2 class="title" id="sec.sec_prot.general.ports"><span class="number">3.15 </span><span class="name">Securing the Network—Open Network Ports Detection</span> <a title="Permalink" class="permalink" href="cha.sec_prot.general.html#sec.sec_prot.general.ports">#</a></h2></div></div></div><p>
     Securing a server requires that you know what it is serving; what
     services are running. Default server installations may have services
     running that aren't self apparent and open network ports that they are
     using. So, one of the most important tasks is to detect and close
     network ports that are not needed. To get a list of listening network
     ports (TCP and UDP sockets), you can use the <code class="command">netstat</code>
     service run the following command:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>netstat -tulp</pre></div><p>
     Be aware that <code class="command">netstat</code> output can be wider than a
     default terminal screen. If the screen is too narrow, the options
     described above will likely cause the output to wrap and be less
     legible.
    </p><p>
     Below is an example of output from the above command:
    </p><div class="verbatim-wrap"><pre class="screen">Proto Recv-Q Send-Q Local            Foreign         State   PID/Program
                    Address          Address                 name
tcp   0      0      *:auth           *.*             LISTEN  2328/xinetd
tcp   0      0      local[...].:smtp *.*             LISTEN  2360/sendmail:acce
tcp   0      0      *:ssh            *.*             LISTEN  2317/sshd</pre></div><p>
     From the output above you can see that three TCP-based services are
     running and listening: xinetd, sendmail, and sshd. Sendmail should not
     be configured to listen for incoming network connections unless the
     server running it is a designated as a mail or relay server. Running a
     port scan from another server can confirm that, but make sure to obtain
     proper permissions to scan/probe a machine on a production network.
    </p><div id="idm139924388718576" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.png" /><h6>Important</h6><p>
      Some organizations consider port scans without permission a security
      offense.
     </p></div><p>
     Using the Nmap tool, such a probe/scan can be run:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>nmap -sTU <em class="replaceable ">REMOTE_HOST</em>
Starting nmap 3.70 ( http://www.insecure.org/nmap/ ) at 2004-12-10 22:51 CST
Interesting ports on venus (192.168.2.101):
(The 3131 ports scanned but not shown below are in state: closed)
PORT     STATE         SERVICE
22/tcp   open          ssh
113/tcp  open          auth

Nmap run completed -- 1 IP address (1 host up) scanned in 221.669 seconds</pre></div><p>
     Note that running the <code class="command">nmap</code> command can take quite a
     while (in this example almost 4 minutes) depending on the options used.
     If you remove the UDP port scan (leave out the <code class="option">-U</code>
     option), then <code class="command">nmap</code> will finish the port scan nearly
     immediately. The results of <code class="command">nmap</code> can vary widely and
     might not show all listening network sockets depending on the status of
     the SuSEFirewall2 (or other) and if it has been set up to block any
     ports.
    </p><p>
     From the sample run above, you see that the
     <code class="systemitem">xinetd</code> daemon is listening on
     port auth (port 113) for <code class="literal">IDENT</code> (for more information
     on this service, see
     <a class="xref" href="cha.sec_prot.general.html#sec.sec_prot.general.disable_xinetd_services" title="3.16. xinetd Services - Disabling">Section 3.16, “<code class="systemitem">xinetd</code> Services - Disabling”</a>). You
     can also see that sendmail is not listening for remote incoming network
     connections.
    </p><p>
     Another method to list all of the TCP and UDP sockets to which programs
     are listening (on a host) is to use the <code class="command">lsof</code> command –
     which lists open files:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>lsof -i -n | egrep 'COMMAND|LISTEN|UDP'
COMMAND  PID   USER   FD   TYPE    DEVICE SIZE/OFF NODE NAME
sshd     2317  root   3u   IPv6    6579   0t0      TCP *:ssh (LISTEN)
xinetd   2328  root   5u   IPv4    6698   0t0      TCP *:auth (LISTEN)
sendmail 2360  root   3u   IPv4    6729   0t0      TCP 127.0.0.1:smtp (LISTEN)</pre></div></div><div class="sect1 " id="sec.sec_prot.general.disable_xinetd_services"><div class="titlepage"><div><div><h2 class="title" id="sec.sec_prot.general.disable_xinetd_services"><span class="number">3.16 </span><span class="name"><code class="systemitem">xinetd</code> Services - Disabling</span> <a title="Permalink" class="permalink" href="cha.sec_prot.general.html#sec.sec_prot.general.disable_xinetd_services">#</a></h2></div></div></div><p>
     The <code class="systemitem">xinetd</code> daemon is a
     replacement for inetd, the Internet services daemon. It monitors the
     ports for all network services configured in
     <code class="filename">/etc/xinetd.d</code>, and starts the services in response
     to incoming connections. To check if
     <code class="systemitem">xinetd</code> is enabled and running,
     execute:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>systemctl status xinetd</pre></div><p>
     To check the current status of the
     <code class="systemitem">xinetd</code> service, execute:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>systemctl status xinetd</pre></div><p>
     If <code class="systemitem">xinetd</code> is active, it is very
     important to see which services are active and being controlled by
     <code class="systemitem">xinetd</code>. The following command
     will list all services configured in <code class="filename">/etc/xinetd.d</code>
     and whether <code class="systemitem">xinetd</code> monitors the
     ports for these services:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>chkconfig -list | awk '/xinetd based services/,/""/'
xinetd based services:

  chargen:     off
  chargen-udp: off
  cups-lpd:    off
  cvs:         off
  daytime:     off
  daytime-udp: off
  discard:     off
  discard-udp: off
  echo:        off
  echo-udp:    off
  netstat:     off
  rsync:       off
  sane-port:   off
  servers:     off
  services:    off
  svnserve:    off
  swat:        off
  systat:      off
  tftp:        on
  time:        off
  time-udp:    off
  vnc:         off</pre></div><p>
     To get a list of only active services for which xinetd monitors the
     ports, you could run (where the <code class="option">-v</code> option of grep does
     an inverse-match) :
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>chkconfig --list | awk '/xinetd based services/,/""/' | grep -v off
xinetd based services:

  tftp:        on</pre></div><p>
     In the above example you can see that the
     <code class="systemitem">telnet-server</code> package is not
     installed on the system. If the Telnet Server package
     <code class="systemitem">telnet-server</code> would be
     installed, it would show up on the list whether it is active. Here is
     an example how to disable a service. Assuming the
     <code class="systemitem">tftp</code> service is active, run
     the following commands to disable it and to see how the telnet service
     entries are being updated:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>sudo systemctl status tftp
tftp.service - Tftp Server
Loaded: loaded (/usr/lib/systemd/system/tftp.service; static)
Active: active (running) since Fri 2014-09-05 07:56:23 CEST; 2h 1min ago

# sudo cat /etc/xinetd.d/tftp | grep disable
   disable = no

# sudo systemctl disable tftp

# systemctl status tftp
tftp.service - Tftp Server
Loaded: loaded (/usr/lib/systemd/system/tftp.service; static)
Active: inactive (dead)

# sudo cat /etc/xinetd.d/tftp | grep disable
      disable = yes</pre></div><p>
     For the TFTP service it would be better to remove the package from the
     system since removal is always safer than disabling (when possible):
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>rpm -e tftp</pre></div><div class="sect2 " id="sec.sec_prot.general.disable_xinetd_services.inventory"><div class="titlepage"><div><div><h3 class="title" id="sec.sec_prot.general.disable_xinetd_services.inventory"><span class="number">3.16.1 </span><span class="name">Inventory <code class="systemitem">xinetd</code> services</span> <a title="Permalink" class="permalink" href="cha.sec_prot.general.html#sec.sec_prot.general.disable_xinetd_services.inventory">#</a></h3></div></div></div><p>
      It is important to investigate <span class="emphasis"><em>all</em></span> active
      <code class="systemitem">xinetd</code> services and to disable
      them (or remove their packages) if they are not needed. To find out
      what a service does, here is a viable approach. Using the
      <code class="systemitem">tftp</code> service as an example
      and assuming its function is unknown and it is listed as an active
      service. Execute the following commands:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>grep " server" /etc/xinetd.d/tftp
  server = /usr/sbin/in.tftpd
  server_args = -s /tftpboot</pre></div><p>
      To read the manual:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>man in.tftpd
TFTPD(8)               System Manager's Manual              TFTPD(8)



NAME
       tftpd - IPv4 Trivial File Transfer Protocol server

SYNOPSIS
       in.tftpd [options...]  directory...

DESCRIPTION
       tftpd  is  a  server  for the Trivial File Transfer Protocol.
       The TFTP protocol is extensively used to support remote boot-
       ing  of  diskless devices.  The server is normally started by
       inetd, but can also run stand-alone.
[...]</pre></div><p>
      To determine what package supplies the in.tftpd binary:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>rpm -qf /usr/sbin/in.tftpd
tftp-0.48-101.16</pre></div><p>
      To get a description of TFTP and its usage, etc:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>rpm -qi tftp-0.48-101.16| awk '/Description/,/""/'
Description :
The Trivial File Transfer Protocol (TFTP) is normally used only for
booting diskless workstations and for getting or saving network
component configuration files.</pre></div><p>
      To get a list of what files are installed via the TFTP package (RPM),
      execute the <code class="command">rpm</code> command with the following options:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>rpm -ql tftp-0.48-101.16
/etc/xinetd.d/tftp
/usr/bin/tftp
/usr/sbin/in.tftpd
/usr/share/doc/packages/tftp
/usr/share/doc/packages/tftp/README
/usr/share/doc/packages/tftp/README.security
/usr/share/doc/packages/tftp/sample.rules
/usr/share/man/man1/tftp.1.gz
/usr/share/man/man8/in.tftpd.8.gz
/usr/share/man/man8/tftpd.8.gz</pre></div><p>
      This example described what could be done to find out information
      about services (specifically ones started by
      <code class="systemitem">xinetd</code>) even if an online
      manual did not exist for the binary <code class="filename">in.ftpd</code>. This
      example yielded a man page – but you may not always find one. The
      RPM commands in the example are very commonly used for a variety of
      reasons. It is also possible to use the YaST software management
      interface to retrieve all of the resultant information – however
      having a knowledge of RPM command syntax can save quite a bit of time.
      Again to disable the TFTP service, execute the following command:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>systemctl disable tftp</pre></div><p>
      The <code class="systemitem">xinetd</code> daemon is quite
      flexible and has many features. Here are a few functionalities of
      <code class="systemitem">xinetd</code>:
     </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
        Access control for TCP, UDP, and RPC services.
       </p></li><li class="listitem "><p>
        Access limitations based on time.
       </p></li><li class="listitem "><p>
        Provides mechanisms to prevent DoS attacks.
       </p></li></ul></div><p>
      For more specific information on Xinetd, review the documentation and
      usage examples at the xinetd GitHub page
      <a class="link" href="https://github.com/xinetd-org/xinetd" target="_blank">https://github.com/xinetd-org/xinetd</a>.
     </p></div></div><div class="sect1 " id="sec.sec_prot.general.postfix"><div class="titlepage"><div><div><h2 class="title" id="sec.sec_prot.general.postfix"><span class="number">3.17 </span><span class="name">Securing Postfix</span> <a title="Permalink" class="permalink" href="cha.sec_prot.general.html#sec.sec_prot.general.postfix">#</a></h2></div></div></div><p>
     Postfix is a replacement for Sendmail and has several security
     advantages over Sendmail. Postfix is the default mail system in
     <span class="productname"><span class="phrase">SUSE Linux Enterprise Server</span></span> and consists of several small programs that each
     perform their own small task—most of these programs run in a chroot
     jail. This is one of the reasons Postfix is recommended over Sendmail.
    </p><p>
     Linux servers that are not dedicated mail or relay servers should not
     accept external e-mails. However, it is important for production
     servers to send local e-mails to a relay server—some security
     setups (for example the seccheck scripts) can be configured to send
     e-mails to someone other than <code class="systemitem">root</code>, even off the local system.
    </p><p>
     Verify the following parameters in
     <code class="filename">/etc/postfix/main.cf</code> are set to ensure that
     Postfix accepts only local e-mails for delivery (look toward the
     bottom of the file as the top portion is mostly commented-out example
     entries and explanations):
    </p><div class="verbatim-wrap"><pre class="screen">mydestination = $myhostname, localhost.$mydomain, localhost
inet_interfaces = localhost</pre></div><p>
     The <code class="literal">mydestination</code> parameter lists all domains to
     receive e-mails for. The <code class="literal">inet_interfaces</code> parameter
     specifies the network to listen on. After reconfiguring Postfix, a
     restart of the mail system is necessary:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>systemctl restart postfix</pre></div><p>
     Verify that Postfix is not listening for network requests (incoming) by
     running one of these commands from another host:
    </p><div class="verbatim-wrap"><pre class="screen">nmap -sT -p 25 <em class="replaceable ">REMOTE_HOST</em>
telnet &lt;remote_host&gt; 25</pre></div><div id="idm139924415104160" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note</h6><p>
      Running these commands on the local host will provide inaccurate
      results because Postfix is supposed to accept connections from the local
      node.  Use an external host for correct results.
     </p></div></div><div class="sect1 " id="sec.sec_prot.general.nfs"><div class="titlepage"><div><div><h2 class="title" id="sec.sec_prot.general.nfs"><span class="number">3.18 </span><span class="name">File Systems: Securing NFS</span> <a title="Permalink" class="permalink" href="cha.sec_prot.general.html#sec.sec_prot.general.nfs">#</a></h2></div></div></div><p>
     NFS (Network File System) allows servers to share files over a network.
     But like all network services using NFS involves risks.
    </p><p>
     Here are some basic rules:
    </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
       NFS should not be enabled if not needed.
      </p></li><li class="listitem "><p>
       If NFS is truly needed, use a TCP wrapper to restrict remote access.
      </p></li><li class="listitem "><p>
       Ensure to export only to those hosts that really need access.
      </p></li><li class="listitem "><p>
       Use a fully qualified domain name to diminish any spoofing attempts.
      </p></li><li class="listitem "><p>
       Export only as read-only whenever possible.
      </p></li><li class="listitem "><p>
       Use NFS only over TCP.
      </p></li></ul></div><p>
     If you do not have shared directories to export, then ensure that the
     NFS service is <span class="emphasis"><em>not</em></span> enabled nor running on the
     system:
    </p><p>
     Check the NFS service status:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>systemctl status nfsserver</pre></div><p>
     Check the current targets:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>ls /etc/systemd/system/*.wants/nfsserver.service</pre></div><div class="sect2 " id="sec.sec_prot.general.nfs.start"><div class="titlepage"><div><div><h3 class="title" id="sec.sec_prot.general.nfs.start"><span class="number">3.18.1 </span><span class="name">Enabling and Starting NFS Server</span> <a title="Permalink" class="permalink" href="cha.sec_prot.general.html#sec.sec_prot.general.nfs.start">#</a></h3></div></div></div><p>
      If NFS must be used, it can be activated using the following commands
      on <span class="productname"><span class="phrase">SUSE Linux Enterprise Server</span></span> or more simply and securely with the YaST
      plug-in (ncurses). Access it directly from command line with
      <code class="command">yast nfs_server</code> or <code class="command">yast
      nfs_client</code> – or manually:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>systemctl enable nfs
systemctl start nfs</pre></div><p>
      Portmapper information:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>rpcinfo -p <em class="replaceable ">SERVERNAME</em>
   program vers proto   port
    100000    2   tcp    111  portmapper
    100000    2   udp    111  portmapper
    100003    2   udp   2049  nfs
    100003    3   udp   2049  nfs
    100003    2   tcp   2049  nfs
    100003    3   tcp   2049  nfs
    100005    1   udp    623  mountd
    100005    1   tcp    626  mountd
    100005    2   udp    623  mountd
    100005    2   tcp    626  mountd
    100005    3   udp    623  mountd
    100005    3   tcp    626  mountd</pre></div><p>
      If you run it from an "untrusted" server or network, you should get
      the following output:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>rpcinfo -p <em class="replaceable ">SERVERNAME</em>
No remote programs registered.</pre></div></div><div class="sect2 " id="sec.sec_prot.general.nfs.export"><div class="titlepage"><div><div><h3 class="title" id="sec.sec_prot.general.nfs.export"><span class="number">3.18.2 </span><span class="name">Exporting NFS</span> <a title="Permalink" class="permalink" href="cha.sec_prot.general.html#sec.sec_prot.general.nfs.export">#</a></h3></div></div></div><p>
      To allow a client access to a file system or directory, the
      <code class="filename">/etc/exports</code> file serves as the access control
      list. To give the network "network.example.com" read-only
      access to <code class="filename">/pub</code>, the entries in
      <code class="filename">/etc/exports</code> would look like as follows:
     </p><div class="verbatim-wrap"><pre class="screen">      /pub *.network.example.com(ro,sync)</pre></div><p>
      It is very important <span class="emphasis"><em>not</em></span> to give write access to
      NFS clients if not absolutely needed! Entries in
      <code class="filename">/etc/exports</code> are exported read-only
      (<code class="option">ro</code> option) by default. To allow servers
      <code class="systemitem">sles-ha1</code>,
      <code class="systemitem">sles-ha2</code> and
      <code class="systemitem">sles-ha3</code> read-write access
      to the <code class="filename">/data/MYSQL</code> directory, the entries in
      <code class="filename">/etc/exports</code> would look like as follows:
     </p><div class="verbatim-wrap"><pre class="screen">/data/MYSQL sles-ha1.example.com(rw,sync) sles-ha2.example.com(rw,sync) sles-ha3.example.com(rw,sync)</pre></div><p>
      Note that the options <span class="emphasis"><em>must not</em></span> be separated from
      the host names or networks with whitespace(s). Also, fully qualified
      domain names should <span class="emphasis"><em>always</em></span> be used to diminish
      spoofing attempts. All entries in <code class="filename">/etc/exports</code>
      are exported with the <code class="option">root_squash</code> option (<span class="quote">“<span class="quote">root
      squashing</span>”</span>) by default. This means that a root user on a client
      machine does not have root privileges (root access) to files on
      exported NFS. It is not recommended to turn <span class="quote">“<span class="quote">root
      squashing</span>”</span> off using the <code class="option">no_root_squash</code>
      option! After you have made all your entries in
      <code class="filename">/etc/exports</code>, you can export all file
      systems/directories using the following command:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>exportfs -a</pre></div><p>
      To unexport all shared file systems/directories, run:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>exportfs -ua</pre></div><p>
      To see all shared file systems/directories, run:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>showmount -e localhost
Export list for localhost:

/pub *.network.example.com/data/MYSQL
sles-ha1.example.com,sles-ha2.example.com,sles-ha3.example.com</pre></div></div><div class="sect2 " id="sec.sec_prot.general.nfs.tcp"><div class="titlepage"><div><div><h3 class="title" id="sec.sec_prot.general.nfs.tcp"><span class="number">3.18.3 </span><span class="name">Using NFS over TCP</span> <a title="Permalink" class="permalink" href="cha.sec_prot.general.html#sec.sec_prot.general.nfs.tcp">#</a></h3></div></div></div><p>
      If you need NFS, it is recommended to use NFS only over TCP since NFS
      over UDP is not secure. All 2.4 and later kernels support NFS over TCP
      on the client side. Server support for TCP appeared in later 2.4
      kernels and beyond. To mount a shared directory using NFS over TCP, it
      is necessary to use the <code class="option">proto=tcp</code> mount option:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>mount -o proto=tcp <em class="replaceable ">SERVERNAME</em>:/pub /usr/local/pub</pre></div><p>
      Verify that the target directory, in this case
      <code class="filename">/usr/local/pub</code>, exists on the client:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>mount [...] <em class="replaceable ">SERVERNAME</em>:/pub on
/usr/local/pub type nfs (rw,proto=tcp,addr=192.168.1.110)</pre></div><p>
      To have the shared directory mounted on the client at boot time, use
      the <code class="filename">/etc/fstab</code> file. For the above example, the
      <code class="filename">/etc/fstab</code> entry could look like this:
     </p><div class="verbatim-wrap"><pre class="screen"><em class="replaceable ">SERVERNAME</em>:/pub /usr/local/pub nfs rsize=8192,wsize=8192,timeo=14,intr,tcp 0 0</pre></div></div></div><div class="sect1 " id="sec.sec_prot.general.scp"><div class="titlepage"><div><div><h2 class="title" id="sec.sec_prot.general.scp"><span class="number">3.19 </span><span class="name">Copying Files Using SSH Without Providing Login Prompts</span> <a title="Permalink" class="permalink" href="cha.sec_prot.general.html#sec.sec_prot.general.scp">#</a></h2></div></div></div><p>
     This example is needed in some cases to enable files to be copied over
     the network using SSH without providing an interactive login prompt.
     This allows trusted hosts to be set up—an example of federation.
    </p><p>
     SSH can allow a forced command using the <span class="quote">“<span class="quote">command</span>”</span> option.
     Using this option it is possible to disable scp (secure copy) and
     enforce every passed <code class="command">ssh</code> command to be ignored. On
     the server side where you want to retrieve the file from, add the
     following entry to the beginning of the SSH key in the
     <code class="filename">~/.ssh/authorized_keys</code> file (the
     <code class="filename">~</code> represents a particular users home directory –
     <code class="systemitem">root</code>'s home directory is <code class="filename">/root</code> – other
     users typically reside in
     <code class="filename">/home/<em class="replaceable ">USERNAME</em></code>):
    </p><div class="verbatim-wrap"><pre class="screen">command="/bin/cat ~/&lt;file_name&gt;" ssh-rsa AAAAB3N...{etc}</pre></div><p>
     To copy now the file from the remote server, run the following command:
    </p><p>
     ssh <em class="replaceable ">USER</em>@<em class="replaceable ">SERVERNAME</em>
     <em class="replaceable ">LOCAL_FILE</em>
    </p><p>
     Since <code class="command">/bin/cat</code> is run on the server side, its output
     needs to be redirected to the local file.
    </p><p>
     Another approach is to replace the <code class="command">/bin/cat</code>
     (referenced above) with your own script that checks the passed SSH
     commands by reading the environment variable
     <code class="envar">$SSH_ORIGINAL_COMMAND</code>. For example:
    </p><div class="verbatim-wrap"><pre class="screen">#!/bin/ksh
 if [[ $SSH_ORIGINAL_COMMAND = "File1" ||
       $SSH_ORIGINAL_COMMAND = "File2" ]]
 then
     /bin/cat $SSH_ORIGINAL_COMMAND
 else
     echo "Invalid file name!"
     exit 1
 fi</pre></div><p>
     So you replace the <code class="command">/bin/cat</code> portion with the script
     name in <code class="filename">~/.ssh/authorized_keys</code>, and run the
     following command to copy <code class="filename">Foo1</code>:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>ssh <em class="replaceable ">USER</em>@<em class="replaceable ">SERVERNAME</em> Foo1 &gt; <em class="replaceable ">LOCAL_FILE</em></pre></div><p>
     To copy <code class="filename">Foo 2</code>, run:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>ssh <em class="replaceable ">USER</em>@<em class="replaceable ">SERVERNAME</em> Foo2 &gt; <em class="replaceable ">LOCAL_FILE</em></pre></div><p>
     With the modifications above, every other variety of passed parameters
     will return errors.
    </p></div><div class="sect1 " id="sec.sec_prot.general.check_perms"><div class="titlepage"><div><div><h2 class="title" id="sec.sec_prot.general.check_perms"><span class="number">3.20 </span><span class="name">Checking File Permissions and Ownership</span> <a title="Permalink" class="permalink" href="cha.sec_prot.general.html#sec.sec_prot.general.check_perms">#</a></h2></div></div></div><p>
     The following sections deal with some ways the default permissions and
     file settings can be modified to enhance the security of a host. It is
     important to note that the use of the default <span class="productname"><span class="phrase">SUSE Linux Enterprise Server</span></span>
     utilities like <code class="command">seccheck</code> - can be run to lock down
     and improve the general file security and user environment. However, it
     is beneficial to understand how to modify these things.
    </p><p>
     <span class="productname"><span class="phrase">SUSE Linux Enterprise Server</span></span> hosts include 3 defaults settings for file
     permissions: <code class="filename">permissions.easy</code>,
     <code class="filename">permissions.secure</code>, and
     <code class="filename">permissions.paranoid</code>, all located in the
     <code class="filename">/etc</code> directory. The purpose of these files is to
     define special permissions, such as world-writable directories or, for
     files, the setuser ID bit (programs with the setuser ID bit set do not
     run with the permissions of the user that has launched it, but with the
     permissions of the file owner, usually <code class="systemitem">root</code>).
    </p><p>
     Administrators can use the file
     <code class="filename">/etc/permissions.local</code> to add their own settings.
     The easiest way to implement one of the default permission rule-sets
     above is to use the <span class="guimenu">Local Security</span> module in
     YaST.
    </p><p>
     Each of the following topics will be modified by a selected rule-set,
     but the information is important to understand on its own.
    </p></div><div class="sect1 " id="sec.sec_prot.general.umask"><div class="titlepage"><div><div><h2 class="title" id="sec.sec_prot.general.umask"><span class="number">3.21 </span><span class="name">Default umask</span> <a title="Permalink" class="permalink" href="cha.sec_prot.general.html#sec.sec_prot.general.umask">#</a></h2></div></div></div><p>
     The <code class="command">umask</code> (user file-creation mode mask) command is
     a shell built-in command which determines the default file permissions
     for newly created files. This can be overwritten by system calls but
     many programs and utilities use <code class="command">umask</code>. By default,
     SUSE sets <code class="command">umask</code> to <code class="literal">022</code>. You
     can modify this by changing the value in
     <code class="filename">/etc/profile</code>.
    </p><p>
     The <code class="command">id</code> command will print out the current user
     identity information. Example from a non-root prompt:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>id
uid=1000(ne0) gid=100(users) groups=16(dialout),33(video),100(users)</pre></div><p>
     And to determine the active umask, use the <code class="command">umask</code>
     command:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>umask
0022</pre></div><p>
     Now, for comparison's sake, the same commands from the root user:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>id
uid=0(root) gid=0(root) groups=0(root)
<code class="prompt root">root # </code>umask
0022</pre></div></div><div class="sect1 " id="sec.sec_prot.general.s-bit"><div class="titlepage"><div><div><h2 class="title" id="sec.sec_prot.general.s-bit"><span class="number">3.22 </span><span class="name">SUID/SGID Files</span> <a title="Permalink" class="permalink" href="cha.sec_prot.general.html#sec.sec_prot.general.s-bit">#</a></h2></div></div></div><p>
     When the SUID (set user ID) or SGID (set group ID) bits are set on an
     executable, it executes with the UID or GID of the owner of the
     executable rather than that of the person executing it. This means
     that, for example, all executables that have the SUID bit set and are
     owned by root are executed with the UID of root. A good example is the
     passwd command that allows ordinary users to update the password field
     in the /etc/shadow file which is owned by root.
    </p><p>
     But SUID/SGID bits can be misused when the SUID/SGID executable has a
     security hole. Therefore, you should search the entire system for
     SUID/SGID executables and document it. For example, ensure that code
     developers do not set SUID/SGID bits on their programs if it is not an
     absolute requirement. Very often you can use workarounds like removing
     the executable bit for world/others. However, a better approach is to
     change the design of the software if possible.
    </p><p>
     To search the entire system for SUID or SGID files, you can run the
     following command:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>find / -path /proc -prune -o -type f -perm '/6000' -ls</pre></div><p>
     The <code class="option">-prune</code> option in this example is used to skip the
     /proc file system.
    </p></div><div class="sect1 " id="sec.sec_prot.general.filepermissions"><div class="titlepage"><div><div><h2 class="title" id="sec.sec_prot.general.filepermissions"><span class="number">3.23 </span><span class="name">World-Writable Files</span> <a title="Permalink" class="permalink" href="cha.sec_prot.general.html#sec.sec_prot.general.filepermissions">#</a></h2></div></div></div><p>
     World-writable files are a security risk since it allows anyone to
     modify them. Additionally, world-writable directories allow anyone to
     add or delete files. To locate world-writable files and directories,
     you can use the following command:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>find / -path /proc -prune -o -perm -2 ! -type l -ls</pre></div><p>
     The <code class="option">! -type l</code> parameter skips all symbolic links since
     symbolic links are always world-writable. However, this is not a
     problem as long as the target of the link is not world-writable, which
     is checked by the above find command.
    </p><p>
     World-writable directories with sticky bit—directory or file
     ownership where only the item's owner, the directory's owner, or
     <code class="systemitem">root</code> can rename or delete files—such as the
     <code class="filename">/tmp</code> directory do not allow anyone except the
     owner of a file to delete or modify it in this directory. The sticky
     bit makes files stick to the user who created it and it prevents other
     users from deleting and renaming the files. Therefore, depending on the
     purpose of the directory world-writable directories with sticky are
     usually not an issue. An example is the <code class="filename">/tmp</code>
     directory:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>ls -ld /tmp
drwxrwxrwt 18 root root 16384 Dec 23 22:20 /tmp</pre></div><p>
     The <code class="literal">t</code> mode, which denotes the sticky bit, allows
     files to be deleted and renamed only if the user is the owner of this
     file or the owner of the directory.
    </p><p>
     <span class="productname"><span class="phrase">SUSE Linux Enterprise Server</span></span> supports file capabilities to allow more fine grained
     privileges to be given to programs rather than the full power of root:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>getcap -v /usr/bin/ping
      /usr/bin/ping = cap_new_raw+eip</pre></div><p>
     The previous command only grants the CAP_NET_RAW capability to whoever
     executes ping. In case of vulnerabilities inside ping, an attacker can
     gain at most this capability in contrast to full root when granting the
     ping binary suid root rights. Whenever possible, file capabilities
     should be chosen in favor of the suid-to-root bit. But this only
     applies when the binary is suid to root, not to other users such as
     <code class="literal">news</code>, <code class="literal">lp</code> and alike.
    </p></div><div class="sect1 " id="sec.sec_prot.general.orphaned"><div class="titlepage"><div><div><h2 class="title" id="sec.sec_prot.general.orphaned"><span class="number">3.24 </span><span class="name">Orphaned or Unowned Files</span> <a title="Permalink" class="permalink" href="cha.sec_prot.general.html#sec.sec_prot.general.orphaned">#</a></h2></div></div></div><p>
     Files not owned by any user or group might not necessarily be a
     security problem in itself. However, unowned files could pose a
     security problem in the future. For example, if a new user is created
     and the new users happens to get the same UID as the unowned files
     have, then this new user will automatically become the owner of these
     files.
    </p><p>
     To locate files not owned by any user or group, use the following
     command:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>find / -path /proc -prune -o -nouser -o -nogroup</pre></div></div><div class="sect1 " id="sec.sec_prot.general.removable_media"><div class="titlepage"><div><div><h2 class="title" id="sec.sec_prot.general.removable_media"><span class="number">3.25 </span><span class="name">Restricting Access to Removable Media</span> <a title="Permalink" class="permalink" href="cha.sec_prot.general.html#sec.sec_prot.general.removable_media">#</a></h2></div></div></div><p>
     In some environments it is required to restrict access to removable
     media such as USB storage or optical devices. The tools coming with the
     <code class="systemitem">udisks2</code> package help with such a
     configuration.
    </p><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
       Create a rules file
       <code class="filename">/etc/polkit-1/rules.d/01-restrict-removable-media.rules</code>
       similar to the following:
      </p><div class="verbatim-wrap"><pre class="screen">// Allow users in group 'mmedia_all' to mount/unmount all type of drives
// Allow users in group 'mmedia_removable' to mount/umount USB storage drives
// Allow users in group 'mmedia_optical' to mount/unmount Optical drives
polkit.addRule(function(action, subject) {
  if (/^org\.freedesktop\.udisks2\.filesystem-.*mount.*$/.test(action.id) &amp;&amp;
  action.lookup("drive.removable") == "true") {
    if (subject.isInGroup("mmedia_all")) {
      return polkit.Result.YES;
    } else {
      if (/.*optical.*/.test(action.lookup("drive.removable.media"))) {
        if (subject.isInGroup("mmedia_optical"))
        return polkit.Result.YES;
      } else if (/.*floppy.*/.test(action.lookup("drive.removable.media"))) {
        return polkit.Result.NO;
      } else if (action.lookup("drive.removable.bus") == "usb") {
        if (subject.isInGroup("mmedia_removable"))
        return polkit.Result.YES;
      }
      return polkit.Result.NO;
    }
  }
});</pre></div><div id="idm139924414894352" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.png" /><h6>Important: Naming of the Rules File</h6><p>
        Rules files are processed in alphabetical order. Functions are called
        in the order they were added until one of the functions returns a
        value. Hence, to add an authorization rule that is processed before
        other rules, put it in a file in /etc/polkit-1/rules.d with a name
        that sorts before other rules files, for example
        <code class="filename">01-restrict-removable-media.rules</code>. Each function
        should return a value from <code class="literal">polkit.Result</code>.
       </p><p>
        
        The name of a rules file must start with a digit, otherwise it
        will be ignored.
       </p></div></li><li class="step "><p>
       Restart <code class="systemitem">udisks2</code>:
      </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>systemctl restart udisks2</pre></div></li><li class="step "><p>
       Restart <code class="systemitem">polkit</code>
      </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>systemctl restart polkit</pre></div></li><li class="step "><p>
       In YaST, click <span class="guimenu">Security and
       Users</span> › <span class="guimenu">User and Group
       Management</span> › <span class="guimenu">Groups</span> to create
       the three groups <code class="literal">mmedia_all</code>,
       <code class="literal">mmedia_optical</code>, and
       <code class="literal">mmedia_removable</code>. Then add the users to these
       groups as wanted.
      </p></li></ol></div></div></div><div class="sect1 " id="sec.sec_prot.general.accounts"><div class="titlepage"><div><div><h2 class="title" id="sec.sec_prot.general.accounts"><span class="number">3.26 </span><span class="name">Various Account Checks</span> <a title="Permalink" class="permalink" href="cha.sec_prot.general.html#sec.sec_prot.general.accounts">#</a></h2></div></div></div><div class="sect2 " id="sec.sec_prot.general.accounts.unlocked"><div class="titlepage"><div><div><h3 class="title" id="sec.sec_prot.general.accounts.unlocked"><span class="number">3.26.1 </span><span class="name">Unlocked Accounts</span> <a title="Permalink" class="permalink" href="cha.sec_prot.general.html#sec.sec_prot.general.accounts.unlocked">#</a></h3></div></div></div><p>
      It is important that all system and vendor accounts that are not used
      for logins are locked. To get a list of unlocked accounts on your
      system, you can check for accounts that do <span class="emphasis"><em>not</em></span>
      have an encrypted password string starting with <code class="literal">!</code>
      or <code class="literal">*</code> in the <code class="filename">/etc/shadow</code> file.
      If you lock an account using <code class="command">passwd</code>
      <code class="option">-l</code>, it will put a <code class="literal">!!</code> in front of
      the encrypted password, effectively disabling the password. If you
      lock an account using <code class="command">usermod</code> <code class="option">-L</code>,
      it will put a <code class="literal">!</code> in front of the encrypted password.
      Many system and shared accounts are usually locked by default by
      having a <code class="literal">*</code> or <code class="literal">!!</code> in the password
      field which renders the encrypted password into an invalid string.
      Hence, to get a list of all unlocked (encryptable) accounts, run
      (<code class="command">egrep</code> is used to allow use of
      regular-expressions):
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>egrep -v ':\*|:\!' /etc/shadow | awk -F: '{print $1}'</pre></div><p>
      Also make sure all accounts have a <code class="literal">x</code> in the
      password field in <code class="filename">/etc/passwd</code>. The following
      command lists all accounts that do not have a <code class="literal">x</code> in
      the password field:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>grep -v ':x:' /etc/passwd</pre></div><p>
      An <code class="literal">x</code> in the password fields means that the password
      has been shadowed, for example the encrypted password needs to be
      looked up in the <code class="filename">/etc/shadow</code> file. If the
      password field in <code class="filename">/etc/passwd</code> is empty, then the
      system will not look up the shadow file and it will not prompt the user
      for a password at the login prompt.
     </p></div><div class="sect2 " id="sec.sec_prot.general.accounts.unused"><div class="titlepage"><div><div><h3 class="title" id="sec.sec_prot.general.accounts.unused"><span class="number">3.26.2 </span><span class="name">Unused Accounts</span> <a title="Permalink" class="permalink" href="cha.sec_prot.general.html#sec.sec_prot.general.accounts.unused">#</a></h3></div></div></div><p>
      All system or vendor accounts that are not being used by users,
      applications, by the system or by daemons should be removed from the
      system. You can use the following command to find out if there are any
      files owned by a specific account:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>find / -path /proc -prune -o -user <em class="replaceable ">ACCOUNT</em> -ls</pre></div><p>
      The <code class="option">-prune</code> option in this example is used to skip the
      /proc file system. If you are sure that an account can be deleted, you
      can remove the account using the following command:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>userdel -r <em class="replaceable ">ACCOUNT</em></pre></div><p>
      Without the <code class="option">-r</code> option <code class="command">userdel</code> will not delete the
      user's home directory and mail spool
      (<code class="filename">/var/spool/mail/<em class="replaceable ">USER</em></code>).
      Note that many system accounts have no home directory.
     </p></div></div><div class="sect1 " id="sec.sec_prot.general.pw_aging"><div class="titlepage"><div><div><h2 class="title" id="sec.sec_prot.general.pw_aging"><span class="number">3.27 </span><span class="name">Enabling Password Aging</span> <a title="Permalink" class="permalink" href="cha.sec_prot.general.html#sec.sec_prot.general.pw_aging">#</a></h2></div></div></div><p>
     Password expirations are a general best practice—but might
     need to be excluded for some system and shared accounts (for example
     Oracle, etc.). Expiring password on those accounts could lead to system
     outages if the application account expires.
    </p><p>
     Typically a corporate policy should be developed that dictates
     rules/procedures regarding password changes for system and shared
     accounts. However, normal user account passwords should expire
     automatically. The following example shows how password expiration can
     be set up for individual user accounts.
    </p><p>
     The following files and parameters in the table can be used when a new
     account is created with the <code class="command">useradd</code> command.
     Settings such as these are stored for each user account in the
     <code class="filename">/etc/shadow</code> file. If using the YaST tool
     (<span class="guimenu">User and Group Management</span>) to add users, the
     settings are available on a per-user basis. Here are the various
     settings—some of which can also be system-wide (for example
     modification of <code class="filename">/etc/login.defs</code> and
     <code class="filename">/etc/default/useradd</code>):
    </p><div class="informaltable"><table border="1"><colgroup><col /><col /><col /></colgroup><tbody><tr><td>
         <p>
          <code class="filename">/etc/login.defs</code>
         </p>
        </td><td>
         <p>
          <code class="literal">PASS_MAX_DAYS</code>
         </p>
        </td><td>
         <p>
          Maximum number of days a password is valid.
         </p>
        </td></tr><tr><td>
         <p>
          <code class="filename">/etc/login.defs</code>
         </p>
        </td><td>
         <p>
          <code class="literal">PASS_MIN_DAYS</code>
         </p>
        </td><td>
         <p>
          Minimum number of days before a user can change the password since
          the last change.
         </p>
        </td></tr><tr><td>
         <p>
          <code class="filename">/etc/login.defs</code>
         </p>
        </td><td>
         <p>
          <code class="literal">PASS_WARN_AGE</code>
         </p>
        </td><td>
         <p>
          Number of days when the password change reminder starts.
         </p>
        </td></tr><tr><td>
         <p>
          <code class="filename">/etc/default/useradd</code>
         </p>
        </td><td>
         <p>
          <code class="literal">INACTIVE</code>
         </p>
        </td><td>
         <p>
          Number of days after password expiration that account is disabled.
         </p>
        </td></tr><tr><td>
         <p>
          <code class="filename">/etc/default/useradd</code>
         </p>
        </td><td>
         <p>
          <code class="literal">EXPIRE</code>
         </p>
        </td><td>
         <p>
          Account expiration date in the format YYYY-MM-DD.
         </p>
        </td></tr></tbody></table></div><div id="idm139924389488768" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note</h6><p>
      Users created prior to these modifications will not be affected.
     </p></div><p>
     Ensure that the above parameters are changed in the
     <code class="filename">/etc/login.defs</code> and
     <code class="filename">/etc/default/useradd</code> files. Review of the
     <code class="filename">/etc/shadow</code> file will show how these settings get
     stored after adding a user.
    </p><p>
     To create a new user account, execute the following command:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>useradd -c "<em class="replaceable ">TEST_USER</em>" -g <em class="replaceable ">USERS</em> <em class="replaceable ">TEST</em></pre></div><p>
     The <code class="option">-g</code> option specifies the primary group for this
     account:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>id <em class="replaceable ">TEST</em>
uid=509(test) gid=100(users) groups=100(users)</pre></div><p>
     The settings in <code class="filename">/etc/login.defs</code> and
     <code class="filename">/etc/default/useradd</code> are recorded for the test
     user in the <code class="filename">/etc/shadow</code> file as follows:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>grep <em class="replaceable ">TEST</em> /etc/shadow
test:!!:12742:7:60:7:14::</pre></div><p>
     Password aging can be modified at any time by use of the
     <code class="command">chage</code> command. To disable password aging for system
     and shared accounts, you can run the following <code class="command">chage</code> command:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>chage -M -1 <em class="replaceable ">SYSTEM_ACCOUNT_NAME</em></pre></div><p>
     To get password expiration information:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>chage -l <em class="replaceable ">SYSTEM_ACCOUNT_NAME</em></pre></div><p>
     For example:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>chage -l <em class="replaceable ">TEST</em>
Minimum: 7
Maximum: 60
Warning: 7
Inactive: 14
Last Change: Jan 11, 2015
Password Expires: Mar 12, 2015
Password Inactive: Mar 26, 2015
Account Expires: Never</pre></div></div><div class="sect1 " id="sec.sec_prot.general.pw_strength"><div class="titlepage"><div><div><h2 class="title" id="sec.sec_prot.general.pw_strength"><span class="number">3.28 </span><span class="name">Stronger Password Enforcement</span> <a title="Permalink" class="permalink" href="cha.sec_prot.general.html#sec.sec_prot.general.pw_strength">#</a></h2></div></div></div><p>
     On an audited system it is important to restrict people from using
     simple passwords that can be cracked too easily. Writing down complex
     passwords is all right as long as they are stored securely. Some will
     argue that strong passwords protect you against dictionary attacks and
     those type of attacks can be defeated by locking accounts after a few
     failed attempts. However, this is not always an option. If set up like
     this, locking system accounts could bring down your applications and
     systems which would be nothing short of a denial of service attack –
     another issue.
    </p><p>
     At any rate, it is important to practice effective password management
     safety. Most companies require that passwords have at the very least a
     number, one lowercase letter, and one uppercase letter. Policies vary,
     but maintaining a balance between password strength/complexity and
     management is sometimes difficult.
    </p></div><div class="sect1 " id="sec.sec_prot.general.pam"><div class="titlepage"><div><div><h2 class="title" id="sec.sec_prot.general.pam"><span class="number">3.29 </span><span class="name">Leveraging an Effective PAM stack</span> <a title="Permalink" class="permalink" href="cha.sec_prot.general.html#sec.sec_prot.general.pam">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">Filename: </span>hardening_pam_stack.xml</li><li><span class="ds-label">ID: </span>sec.sec_prot.general.pam</li></ul></div></div></div></div><p>
     Linux-PAM (Pluggable Authentication Modules for Linux) is a suite of
     shared libraries that enable the local system administrator to choose
     how applications authenticate users.
    </p><p>
     It is strongly recommended to familiarize oneself with the capabilities
     of PAM and how this architecture can be leveraged to provide the
     best authentication setup for an environment. This configuration can be
     done once – and implemented across all systems (a standard) or can be
     enhanced for individual hosts (enhanced security – by host / service
     / application). The key is to realize how flexible the architecture is.
    </p><p>
     To learn more about the PAM architecture, find PAM documentation in
     the <code class="filename">/usr/share/doc/packages/pam</code> directory (in
     a variety of formats).
    </p><p>
     The following discussions are examples of how to modify the default PAM
     stacks—specifically around password policies—for
     example password strength, password re-use and account locking. While
     these are only a few of the possibilities, they serve as a good start
     and demonstrate PAM's flexibility.
    </p><div class="sect2 " id="sec.sec_prot.general.pam.pw_strength"><div class="titlepage"><div><div><h3 class="title" id="sec.sec_prot.general.pam.pw_strength"><span class="number">3.29.1 </span><span class="name">Password Strength</span> <a title="Permalink" class="permalink" href="cha.sec_prot.general.html#sec.sec_prot.general.pam.pw_strength">#</a></h3></div></div></div><p>
      <span class="productname"><span class="phrase">SUSE Linux Enterprise Server</span></span> can leverage the
      <code class="systemitem">pam_cracklib</code> library to test
      for weak passwords – and to suggest using a stronger one if it
      determines obvious weakness. The following parameters represent an
      example that could be part of a corporate password policy or something
      required because of audit constraints.
     </p><p>
      The PAM libraries follow a defined flow. The best way to design the
      perfect stack usually is to consider all of the requirements and
      policies and draw out a flow chart.
     </p><div class="table" id="idm139924375958224"><div class="table-title-wrap"><h6 class="table-title"><span class="number">Table 3.1: </span><span class="name">Sample rules/constraints for password enforcement </span><a title="Permalink" class="permalink" href="cha.sec_prot.general.html#idm139924375958224">#</a></h6></div><div class="table-contents"><table summary="Sample rules/constraints for password enforcement" border="1"><colgroup><col /><col /><col /></colgroup><tbody><tr><td>
          <p>
           <code class="systemitem">pam_cracklib.so</code>
          </p>
         </td><td>
          <p>
           <code class="literal">minlen=8</code>
          </p>
         </td><td>
          <p>
           Minimum length of password is 8
          </p>
         </td></tr><tr><td>
          <p>
           <code class="systemitem">pam_cracklib.so</code>
          </p>
         </td><td>
          <p>
           <code class="literal">lcredit=-1</code>
          </p>
         </td><td>
          <p>
           Minimum number of lowercase letters is 1
          </p>
         </td></tr><tr><td>
          <p>
           <code class="systemitem">pam_cracklib.so</code>
          </p>
         </td><td>
          <p>
           <code class="literal">ucredit=-1</code>
          </p>
         </td><td>
          <p>
           Minimum number of uppercase letters is 1
          </p>
         </td></tr><tr><td>
          <p>
           <code class="systemitem">pam_cracklib.so</code>
          </p>
         </td><td>
          <p>
           <code class="literal">dcredit=-1</code>
          </p>
         </td><td>
          <p>
           Minimum number of digits is 1
          </p>
         </td></tr><tr><td>
          <p>
           <code class="systemitem">pam_cracklib.so</code>
          </p>
         </td><td>
          <p>
           <code class="literal">ocredit=-1</code>
          </p>
         </td><td>
          <p>
           Minimum number of other characters is 1
          </p>
         </td></tr></tbody></table></div></div><p>
      To set up these password restrictions, use the
      <code class="command">pam-config</code> tool and specify the parameters you want
      to configure. For example, the minimum length parameter could be
      modified like this:
     </p><div class="verbatim-wrap"><pre class="screen">sudo pam-config -a --cracklib-minlen=8 --cracklib-retry=3 \
--cracklib-lcredit=-1 --cracklib-ucredit=-1 --cracklib-dcredit=-1 \
--cracklib-ocredit=-1 --cracklib</pre></div><p>
      Now verify that the new password restrictions work for new passwords.
      Simply login to a non-root account and change the password using the
      <code class="command">passwd</code> command. Note that the above requirements
      are not enforced if you run the <code class="command">passwd</code> command
      under root.
     </p></div><div class="sect2 " id="sec.sec_prot.general.pam.pw_previous"><div class="titlepage"><div><div><h3 class="title" id="sec.sec_prot.general.pam.pw_previous"><span class="number">3.29.2 </span><span class="name">Restricting Use of Previous Passwords</span> <a title="Permalink" class="permalink" href="cha.sec_prot.general.html#sec.sec_prot.general.pam.pw_previous">#</a></h3></div></div></div><p>
      The pam_pwhistory module can be used to configure the number of
      previous passwords that cannot be reused. The following command
      implements password restrictions on a system so that a password cannot
      be reused for at least 6 months:
     </p><div class="verbatim-wrap"><pre class="screen">sudo pam-config -a --pwhistory --pwhistory-remember=26</pre></div><p>
      Recall that in the section
      <a class="xref" href="cha.sec_prot.general.html#sec.sec_prot.general.pw_aging" title="3.27. Enabling Password Aging">Section 3.27, “Enabling Password Aging”</a> we set
      <code class="literal">PASS_MIN_DAYS</code> to <code class="literal">7</code>, which
      specifies the minimum number of days allowed between password changes.
      Therefore, if <code class="systemitem">pam_unix</code> is configured to
      remember <code class="literal">26</code> passwords, then the previously used
      passwords cannot be reused for at least 6 months (26*7 days).
     </p><p>
      The PAM configuration (<code class="filename">/etc/pam.d/common-auth</code>)
      resulting from the <code class="command">pam-config</code> command looks like the
      following:
     </p><div class="verbatim-wrap"><pre class="screen">auth      required   pam_env.so
auth      required   pam_unix.so     try_first_pass
account   required   pam_unix.so     try_first_pass
password  requisit   pam_cracklib.so
password  required   pam_pwhistory.so        remember=26
password  optional   pam_gnome_keyring.so    use_authtok
password  required   pam_unix.so     use_authtok nullok shadow try_first_pass
session   required   pam_limits.so
session   required   pam_unix.so     try_first_pass
session   optional   pam_umask.so</pre></div><div id="idm139924378041904" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.png" /><h6>Tip</h6><p>
       Editing the PAM configuration files directly is not recommended. Use
       the <code class="command">pam-config</code> command as shown above to fine-tune
       PAM. For more information see <code class="command">man 8 pam-config</code>.
      </p></div></div><div class="sect2 " id="sec.sec_prot.general.pam.lock_accounts"><div class="titlepage"><div><div><h3 class="title" id="sec.sec_prot.general.pam.lock_accounts"><span class="number">3.29.3 </span><span class="name">Locking User Accounts After Too Many Login Failures</span> <a title="Permalink" class="permalink" href="cha.sec_prot.general.html#sec.sec_prot.general.pam.lock_accounts">#</a></h3></div></div></div><p>
      It is not generally recommend that a host automatically locks system
      and shared accounts after too many failed login or su attempts. This
      could lead to outages if the application's account gets locked because
      of too many login failures like in this example for an Oracle shared
      account:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code> su oracle -c id
su: incorrect password</pre></div><p>
      This could be an easy target for a denial of service attack. The
      following example shows how to lock only individual user accounts
      after too many failed su or login attempts. Add the following line
      to the service files (such as <code class="filename">/etc/pam.d/su</code>
      or <code class="filename">/etc/pam.d/login</code>) that you want to
      configure (but not to
      <code class="filename">/etc/pam.d/common-auth</code>!):
     </p><div class="verbatim-wrap"><pre class="screen">auth      required     pam_tally2.so deny=5 unlock_time=1200
[...]</pre></div><p>
      The line counts failed login and failed su attempts for
      all user accounts except the root account. The accounts will
      be automatically unlocked after 1200 seconds.

      The default location for attempted accesses is recorded in
      <code class="filename">/var/log/tallylog</code>.
     </p><p>
      If the user is authenticated and the login process continues on
      call to pam_setcred(3) it resets the attempts counter to 0.
     </p><p>
      It is also possible to add the
      <code class="literal">lock_time=<em class="replaceable ">N</em></code> parameter,
      and then optionally the
      <code class="literal">unlock_time=<em class="replaceable ">N</em></code>
      parameter.

      For example, setting the <code class="literal">lock_time=60</code> would
      deny access for 60 seconds after a failed attempt. The
      <code class="literal">unlock_time=<em class="replaceable ">N</em></code> option
      would then allow access after
      <code class="literal"><em class="replaceable ">N</em></code> seconds after an
      account has been locked. If this option is used the user will be
      locked out for the specified amount of time after he exceeded his
      maximum allowed attempts. Otherwise the account is locked until
      the lock is removed by a manual intervention of the system
      administrator. See the <code class="literal">pam_tally2</code> man page for
      more information.
     </p><p>
      To exempt system and shared accounts from the
      <code class="literal">deny=<em class="replaceable ">N</em></code> parameter,
      the <code class="literal">per_user</code> parameter was added to the
      module. The <code class="literal">per_user</code> parameter instructs the module
      <span class="emphasis"><em>not</em></span> to use the
      <code class="literal">deny=<em class="replaceable ">N</em></code> limit for
      accounts where the maximum number of login failures is set
      explicitly.  For example:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code> pam_tally2 -u oracle
Login      Failures Latest failure                 From
oracle     0        Fri Dec 10 23:57:55 -0600 2005 on unknown</pre></div><p>
      To instruct the module to activate the
      <code class="literal">deny=<em class="replaceable ">N</em></code> limit for this
      account again, run:
     </p><div class="verbatim-wrap"><pre class="screen">pam_tally2 -u oracle deny=n</pre></div><p>
      By default, the maximum number of login failures for each account is
      set to zero (0) which instructs pam_tally2 to leverage the
      <code class="literal">deny=<em class="replaceable ">N</em></code> parameter. To see
      failed login attempts, run:
     </p><div class="verbatim-wrap"><pre class="screen">pam_tally2</pre></div><p>
      Test these changes thoroughly on your system using
      <code class="command">ssh</code> and <code class="command">su</code>, and make sure
      the <code class="systemitem">root</code> id does not get locked! To lock or unlock accounts
      manually, run one of the following commands:
     </p><div class="variablelist "><dl class="variablelist"><dt id="idm139924377187280"><span class="term ">Locking</span></dt><dd><div class="verbatim-wrap"><pre class="screen">passwd -l <em class="replaceable ">USER</em>
usermod -L <em class="replaceable ">USER</em></pre></div></dd><dt id="idm139924377184752"><span class="term ">Unlocking</span></dt><dd><div class="verbatim-wrap"><pre class="screen">passwd -u <em class="replaceable ">USER</em>
usermod -U <em class="replaceable ">USER</em></pre></div></dd></dl></div></div></div><div class="sect1 " id="sec.sec_prot.dos"><div class="titlepage"><div><div><h2 class="title" id="sec.sec_prot.dos"><span class="number">3.30 </span><span class="name">Preventing Accidental Denial of Service</span> <a title="Permalink" class="permalink" href="cha.sec_prot.general.html#sec.sec_prot.dos">#</a></h2></div></div></div><p>
     Linux allows you to set limits on the amount of system resources that
     users and groups can consume. This is also very handy if bugs in
     programs cause them to use up too much resources (for example memory
     leaks), slow down the machine, or even render the system unusable.
     Incorrect settings can allow programs to use too many resources which
     may make the server unresponsive to new connections or even local
     logins (for example if a program uses up all available file handles on
     the host). This can also be a security concern if someone is allowed to
     consume all system resources and therefore cause a denial of service
     attack – either unplanned or worse, planned. Setting resource limits
     for users and groups may be an effective way to protect systems,
     depending on the environment.
    </p><div class="sect2 " id="sec.sec_prot.dos_restrict_ressources"><div class="titlepage"><div><div><h3 class="title" id="sec.sec_prot.dos_restrict_ressources"><span class="number">3.30.1 </span><span class="name">Example for Restricting System Resources</span> <a title="Permalink" class="permalink" href="cha.sec_prot.general.html#sec.sec_prot.dos_restrict_ressources">#</a></h3></div></div></div><p>
      The following example demonstrates the practical usage of setting or
      restricting system resource consumption for an Oracle user account.
      For a list of system resource settings, see
      <code class="filename">/etc/security/limits.conf</code> or <code class="command">man
      limits.conf</code>.
     </p><p>
      Most shells like Bash provide control over various resources (for
      example the maximum allowable number of open file descriptors or the
      maximum number of processes) that are available on a per/user basis.
      To examine all current limits in the shell execute:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>ulimit -a</pre></div><p>
      For more information on <code class="command">ulimit</code> for the Bash shell,
      examine the Bash man pages.
     </p><div id="idm139924376566928" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.png" /><h6>Important: Setting Limits for SSH Sessions</h6><p>
       Setting "hard" and "soft" limits might not behave as expected when
       using an SSH session. To see valid behavior it may be necessary to
       login as root and then su to the id with limits (for example,
       <code class="literal">oracle</code> in these examples). Resource limits should
       also work assuming the application has been started automatically
       during the boot process. It may be necessary to set
       <code class="option">UsePrivilegeSeparation</code> in
       <code class="filename">/etc/ssh/sshd_config</code> to "no" and restart the SSH
       daemon (<code class="command">systemctl restart sshd</code>) if it
       seems that the changes to resource limits are not working (via SSH).
       However this is not generally recommended – as it weakens a systems
       security.
      </p></div><div id="idm139924376563200" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.png" /><h6>Tip: Disabling Password Logins via <code class="command">ssh</code></h6><p>
       You can add some extra security to your server by disabling password
       authentication for SSH. Remember that you need to have SSH keys
       configured, otherwise you cannot access the server. To disable
       password login, add the following lines to
       <code class="filename">/etc/ssh/sshd_config</code>:
      </p><div class="verbatim-wrap"><pre class="screen">UseLogin no
UsePAM no
PasswordAuthentication no
PubkeyAuthentication yes</pre></div></div><p>
      In this example, a change to the number of file handles or open files
      that the user <code class="literal">oracle</code> can use is made by editing
      <code class="filename">/etc/security/limits.conf</code> as <code class="systemitem">root</code> making
      the following changes:
     </p><div class="verbatim-wrap"><pre class="screen">oracle           soft    nofile          4096
oracle           hard    nofile          63536</pre></div><p>
      The soft limit in the first line defines the limit on the number of
      file handles (open files) that the
      <code class="systemitem">oracle</code> user will have after
      login. If the user sees error messages about running out of file
      handles, then the user can increase the number of file handles like in
      this example up to the hard limit (in this example 63536) by
      executing:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>ulimit -n 63536</pre></div><p>
      You can set the soft and hard limits higher if necessary.
     </p><div id="idm139924376554576" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note</h6><p>
       It is important to be judicious with the usage of ulimits.
       Allowing a "hard" limit for <span class="quote">“<span class="quote">nofile</span>”</span> for a user that
       equals the kernel limit (<code class="filename">/proc/sys/fs/file-max</code>)
       is very bad! If the user consumes all the available file handles,
       the system cannot initiate new logins as accessing (opening) PAM
       modules which are required for performing a login will not be
       possible.
      </p></div><p>
      You also need to ensure that <code class="literal">pam_limits</code> is either
      configured globally in <code class="filename">/etc/pam.d/common-auth</code>, or
      for individual services like SSH, su, login, and telnet in:
     </p><table border="0" summary="Simple list" class="simplelist "><tr><td><code class="filename">/etc/pam.d/sshd</code> (for SSH)</td></tr><tr><td><code class="filename">/etc/pam.d/su</code> (for su)</td></tr><tr><td><code class="filename">/etc/pam.d/login</code> (local logins and telnet)</td></tr></table><p>
      If you do not want to enable it for all logins, there is a specific PAM
      module that will read the
      <code class="filename">/etc/security/limits.conf</code> file. Entries in pam
      configuration directives will have entries like:
     </p><div class="verbatim-wrap"><pre class="screen">session     required      /lib/security/pam_limits.so
session     required      /lib/security/pam_unix.so</pre></div><p>
      It is important to note that changes are not immediate and require a
      new login session:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>su – oracle
<code class="prompt user">tux &gt; </code>ulimit -n
4096</pre></div><p>
      Note that these examples are specific to the Bash shell -
      <code class="command">ulimit</code> options are different for other shells. The
      default limit for the user <code class="literal">oracle</code> is
      <code class="literal">4096</code>. To increase the number of file handles the
      user <code class="literal">oracle</code> can use to <code class="literal">63536</code>,
      do:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>su – oracle
<code class="prompt user">tux &gt; </code>ulimit -n
4096
<code class="prompt user">tux &gt; </code>ulimit -n 63536
<code class="prompt user">tux &gt; </code>ulimit -n
63536</pre></div><p>
      Making this permanent requires the addition of the setting,
      <code class="literal">ulimit -n 63536</code>, (again, for Bash) to the users
      profile (<code class="filename">~/.bashrc</code> or
      <code class="filename">~/.profile</code> file) which is the user start-up file
      for the Bash shell on <span class="productname"><span class="phrase">SUSE Linux Enterprise Server</span></span> (to verify your shell run: echo
      <code class="envar">$SHELL</code>). To do this you could simply type (or
      copy/paste – if you are reading this on the system) the following
      commands for the Bash shell of the user <code class="literal">oracle</code>:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>su - oracle
<code class="prompt user">tux &gt; </code>cat &gt;&gt; ~oracle/.bash_profile &lt;&lt; EOF
ulimit -n 63536
EOF</pre></div></div></div><div class="sect1 " id="sec.sec_prot.banners"><div class="titlepage"><div><div><h2 class="title" id="sec.sec_prot.banners"><span class="number">3.31 </span><span class="name">Displaying Login Banners</span> <a title="Permalink" class="permalink" href="cha.sec_prot.general.html#sec.sec_prot.banners">#</a></h2></div></div></div><p>
     It is often necessary to place a banner on login screens on all servers
     for legal/audit policy reasons and to deter intruders, etc.
    </p><p>
     If you want to print a legal banner after a user logs in using SSH,
     local console, etc., you can leverage the <code class="filename">/etc/motd</code>
     (motd = message of the day) file. The file exists on SUSE,
     however it is empty. Simply add content to the file that is
     applicable/required by the organization.
    </p><div id="idm139924375967232" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note: Banner Length</h6><p>
      Try to keep the content to a single page (or less), as it will
      scroll the screen if it does not fit.
     </p></div><p>
     For SSH you can edit the <span class="quote">“<span class="quote">Banner</span>”</span> parameter in the
     <code class="filename">/etc/ssh/sshd_config</code> file which will then
     appropriately display the banner text before the login prompt. For
     local console logins you can edit the <code class="filename">/etc/issue</code>
     file which will display the banner before the login prompt. For GDM,
     you could make the following changes to require a user to acknowledge
     the legal banner by selecting <span class="guimenu">Yes</span> or
     <span class="guimenu">No</span>. Edit the
     <code class="filename">/etc/gdm/PreSession/Default</code> file and add the
     following lines at the beginning of the script:
    </p><div class="verbatim-wrap"><pre class="screen">if ! gdialog --yesno '\n<em class="replaceable ">This system is classified...</em>\n' 10 10; then
    sleep 10
    exit 1;
fi</pre></div><p>
     The <em class="replaceable ">This system is classified...</em> test should
     be replaced with the valid text. It is important to note that this
     dialog will not prevent a login from progressing.
    </p></div><div class="sect1 " id="sec.sec_prot.misc"><div class="titlepage"><div><div><h2 class="title" id="sec.sec_prot.misc"><span class="number">3.32 </span><span class="name">Miscellaneous</span> <a title="Permalink" class="permalink" href="cha.sec_prot.general.html#sec.sec_prot.misc">#</a></h2></div></div></div><div class="sect2 " id="sec.sec_prot.misc.aide"><div class="titlepage"><div><div><h3 class="title" id="sec.sec_prot.misc.aide"><span class="number">3.32.1 </span><span class="name">Host-Based Linux Monitoring and Intrusion Detection</span> <a title="Permalink" class="permalink" href="cha.sec_prot.general.html#sec.sec_prot.misc.aide">#</a></h3></div></div></div><p>
      Before you place a host into production or even on a network, consider
      the use of a system integrity checker, like
      <code class="command">seccheck</code> (already discussed in
      <a class="xref" href="cha.sec_prot.general.html#sec.sec_prot.general.seccheck" title="3.4. Verifying Security Action with seccheck">Section 3.4, “Verifying Security Action with <code class="command">seccheck</code>”</a>), so in case
      of unauthorized changes, notifications will be issued. Also consider
      the use of an intrusion detection environment, like AIDE, the
      Advanced Intrusion Detection Environment.
     </p><p>
      AIDE is a GPL licensed and open source intrusion detection system. It
      could be considered a system fingerprinting mechanism. AIDE works by
      creating a database containing information about the files on your
      system. The database is created from rules laid out in the
      configuration file aide.conf. When AIDE is run, this database is
      referenced to check for changes (or created for the first time).
      Assuming a comparison check is being run, any changes not permitted by
      the configuration file are reported.
     </p><p>
      By leveraging AIDE—storing a copy of the host's database in a
      secure location—and comparing it (on a scheduled basis or as
      part of a forensic effort), system integrity/insurance can be a matter
      of heuristics and procedure. If an intruder compromises your system,
      the comparison effort will enable an administrator or security officer
      to know what has changed on the host. The initial database should be
      created as a final step—<span class="emphasis"><em>before</em></span> a system gets
      deployed into production.
     </p><p>
      It is outside the scope of this article to cover Linux Monitoring and
      detailed Intrusion Detection systems (IDS) or solutions, however
      there is a plethora of information about configuring AIDE or other
      solutions and many informative articles on the Web.
     </p></div><div class="sect2 " id="sec.sec_prot.misc.account_utils"><div class="titlepage"><div><div><h3 class="title" id="sec.sec_prot.misc.account_utils"><span class="number">3.32.2 </span><span class="name">Connect Accounting Utilities</span> <a title="Permalink" class="permalink" href="cha.sec_prot.general.html#sec.sec_prot.misc.account_utils">#</a></h3></div></div></div><p>
      Here is a list of commands you can use to get data about user logins:
     </p><p><span class="formalpara-title"><code class="command">who</code>. </span>
       Lists currently logged in users.
      </p><p><span class="formalpara-title"><code class="command">w</code>. </span>
       Shows who is logged in and what they are doing.
      </p><p><span class="formalpara-title"><code class="command">last</code>. </span>
       Shows a list of last logged in users, including login time, logout
       time, login IP address, etc.
      </p><p><span class="formalpara-title"><code class="command">lastb</code>. </span>
       Same as <code class="command">last</code>, except that by default it shows
       <code class="filename">/var/log/btmp</code>, which contains all the bad login
       attempts.
      </p><p><span class="formalpara-title"><code class="command">lastlog</code>. </span>
       
       This command reports data maintained in
       <code class="filename">/var/log/lastlog</code>, which is a record of the last
       time a user logged in.
      </p><p><span class="formalpara-title"><code class="command">ac</code>. </span>
       Available after installing the <code class="systemitem">acct</code> package.
       Prints the connect time in hours on a per-user basis or daily basis,
       etc. This command reads <code class="filename">/var/log/wtmp</code>.
      </p><p><span class="formalpara-title"><code class="command">dump-utmp</code>. </span>
       Converts raw data from /var/run/utmp or
       <code class="filename">/var/log/wtmp</code> into ASCII-parsable format.
      </p><p>
      Also check the <code class="filename">/var/log/messages</code> file, or the
      output of <code class="command">journalctl</code> if no logging facility is
      running. See <a class="xref" href="cha.journalctl.html" title="Chapter 15. journalctl: Query the systemd Journal">Chapter 15, <em><code class="command">journalctl</code>: Query the <code class="systemitem">systemd</code> Journal</em></a> for more information on
      the <code class="systemitem">systemd</code> journal.
     </p></div><div class="sect2 " id="sec.sec_prot.misc.other"><div class="titlepage"><div><div><h3 class="title" id="sec.sec_prot.misc.other"><span class="number">3.32.3 </span><span class="name">Other</span> <a title="Permalink" class="permalink" href="cha.sec_prot.general.html#sec.sec_prot.misc.other">#</a></h3></div></div></div><p>
      Finally, the following items are relevant to the system security as
      well, and misconfiguration can cause many problems – and should be
      reviewed:
     </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
        Resolver (<code class="filename">/etc/hosts</code>,
        <code class="filename">/etc/resolv.conf</code>,
        <code class="filename">/etc/nsswitch.conf</code>).
       </p></li><li class="listitem "><p>
        NTP configuration (<code class="filename">/etc/ntp.conf</code>).
       </p></li></ul></div></div></div></div></div><div class="page-bottom"><div id="_bottom-navigation"><a class="nav-link" href="app.hardening.docupdates.html"><span class="next-icon">→</span><span class="nav-label"><span class="number">Appendix A </span>Documentation Updates</span></a><a class="nav-link" href="cha.sec_prot.intro.html"><span class="prev-icon">←</span><span class="nav-label"><span class="number">Chapter 2 </span>Introduction</span></a></div><div id="_share-print"><div class="online-contents share"><strong>Share this page: </strong><span class="share-buttons"><span id="_share-fb" class="bottom-button">Facebook</span><span class="spacer"> • </span><span id="_share-gp" class="bottom-button">Google+</span><span class="spacer"> • </span><span id="_share-tw" class="bottom-button">Twitter</span><span class="spacer"> • </span><span id="_share-mail" class="bottom-button">E-Mail</span></span></div><div class="print"><span id="_print-button" class="bottom-button">Print this page</span></div><div class="clearme"></div></div></div></div><div id="_inward"></div></div><div id="_footer-wrap"><div id="_footer"><p>©
        2018 
        SUSE</p><ul><li><a href="http://www.suse.com/company/careers/" target="_top">Careers</a></li><li><a href="http://www.suse.com/company/legal/" target="_top">Legal</a></li><li><a href="http://www.suse.com/company/" target="_top">About</a></li><li><a href="http://www.suse.com/ContactsOffices/contacts_offices.jsp" target="_top">Contact Us</a></li></ul></div></div></body></html>