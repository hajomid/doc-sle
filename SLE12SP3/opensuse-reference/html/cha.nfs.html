<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang=""><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Sharing File Systems with NFS | Reference | openSUSE Leap 42.3</title><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" /><link rel="stylesheet" type="text/css" href="static/css/style.css" /><link rel="stylesheet" type="text/css" href="static/css/highlight.css" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><meta name="product-name" content="openSUSE Leap" /><meta name="product-number" content="42.3" /><meta name="book-title" content="Reference" /><meta name="chapter-title" content="Chapter 22. Sharing File Systems with NFS" /><meta name="description" content="Distributing and sharing file systems over a network is a common task in corporate environments. The well-proven network file system (NFS) works with NIS, the yellow pages protocol. For a more secure protocol that works with LDAP and Kerberos, check NFSv4 (default). Combined with pNFS, you can eliminate performance bottlenecks. NFS with NIS makes a network transparent to the user. With NFS, it is possible to distribute arbitrary file systems over the network. With an appropriate setup, users always find themselves in the same environment regardless of the terminal they currently use." /><meta name="tracker-url" content="https://bugzilla.opensuse.org/enter_bug.cgi" /><meta name="tracker-type" content="bsc" /><meta name="tracker-bsc-assignee" content="fs@suse.com" /><meta name="tracker-bsc-component" content="Documentation" /><meta name="tracker-bsc-product" content="openSUSE Distribution" /><meta name="tracker-bsc-version" content="Leap 42.2" /><link rel="home" href="index.html" title="openSUSE Leap Documentation" /><link rel="up" href="part.reference.services.html" title="Part III. Services" /><link rel="prev" href="cha.samba.html" title="Chapter 21. Samba" /><link rel="next" href="cha.autofs.html" title="Chapter 23. On-Demand Mounting with Autofs" /><script type="text/javascript">

var protocol = window.location.protocol.toLowerCase();
if ( protocol != 'file:' ) {
  var agent = navigator.userAgent.toLowerCase();
  var wanted = ( protocol == 'https:') ? 'https' : 'http';
  var file = 'fonts.css';
  document.write('<link rel="stylesheet" type="text/css" href="' + wanted + '://static.opensuse.org/fonts/'+ file +'"></link>');
}
else {
   document.write('<link rel="stylesheet" type="text/css" href="static/css/fonts-onlylocal.css"></link>');
}

</script><noscript><link rel="stylesheet" type="text/css" href="http://static.opensuse.org/fonts/fonts.css" /></noscript><script src="static/js/jquery-1.10.2.min.js" type="text/javascript"></script><script src="static/js/script.js" type="text/javascript"></script><script src="static/js/highlight.min.js" type="text/javascript"></script><script>

$(document).ready(function() {
  $('.verbatim-wrap.highlight').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});
hljs.configure({
  useBR: false
});

</script></head><body class="draft offline js-off"><div id="_outer-wrap"><div id="_white-bg"><div id="_header"><div id="_logo"><img src="static/images/logo.png" alt="Logo" /></div><div class="crumbs"><a class="book-link" href="index.html" title="openSUSE Leap Documentation"><span class="book-icon">openSUSE Leap Documentation</span></a><span> › </span><a class="crumb" href="book.opensuse.reference.html">Reference</a><span> › </span><a class="crumb" href="part.reference.services.html">Services</a><span> › </span><a class="crumb" href="cha.nfs.html">Sharing File Systems with NFS</a></div><div class="clearme"></div></div></div><div id="_toolbar-wrap"><div id="_toolbar"><div id="_toc-area" class="inactive"><a id="_toc-area-button" class="tool" title="Contents" accesskey="c" href="index.html"><span class="tool-spacer"><span class="toc-icon">Contents</span><span class="clearme"></span></span><span class="tool-label">Contents</span></a><div class="active-contents bubble-corner"></div><div class="active-contents bubble"><div class="bubble-container"><h6>Reference</h6><div id="_bubble-toc"><ol><li class="inactive"><a href="preface.reference.html"><span class="number"> </span><span class="name">About This Guide</span></a></li><li class="inactive"><a href="part.reference.adv_admin.html"><span class="number">I </span><span class="name">Advanced Administration</span></a><ol><li class="inactive"><a href="cha.yast.text.html"><span class="number">1 </span><span class="name">YaST in Text Mode</span></a></li><li class="inactive"><a href="cha.sw_cl.html"><span class="number">2 </span><span class="name">Managing Software with Command Line Tools</span></a></li><li class="inactive"><a href="cha.snapper.html"><span class="number">3 </span><span class="name">System Recovery and Snapshot Management with Snapper</span></a></li><li class="inactive"><a href="cha.vnc.html"><span class="number">4 </span><span class="name">Remote Access with VNC</span></a></li><li class="inactive"><a href="cha.advdisk.html"><span class="number">5 </span><span class="name">Advanced Disk Setup</span></a></li><li class="inactive"><a href="cha.tuning.multikernel.html"><span class="number">6 </span><span class="name">Installing Multiple Kernel Versions</span></a></li><li class="inactive"><a href="cha.gnome.gconf.html"><span class="number">7 </span><span class="name">GNOME Configuration for Administrators</span></a></li></ol></li><li class="inactive"><a href="part.reference.system.html"><span class="number">II </span><span class="name">System</span></a><ol><li class="inactive"><a href="cha.64bit.html"><span class="number">8 </span><span class="name">32-Bit and 64-Bit Applications in a 64-Bit System Environment</span></a></li><li class="inactive"><a href="cha.boot.html"><span class="number">9 </span><span class="name">Introduction to the Booting Process</span></a></li><li class="inactive"><a href="cha.systemd.html"><span class="number">10 </span><span class="name">The <code class="systemitem">systemd</code> Daemon</span></a></li><li class="inactive"><a href="cha.journalctl.html"><span class="number">11 </span><span class="name"><code class="command">journalctl</code>: Query the <code class="systemitem">systemd</code> Journal</span></a></li><li class="inactive"><a href="cha.grub2.html"><span class="number">12 </span><span class="name">The Boot Loader GRUB 2</span></a></li><li class="inactive"><a href="cha.basicnet.html"><span class="number">13 </span><span class="name">Basic Networking</span></a></li><li class="inactive"><a href="cha.uefi.html"><span class="number">14 </span><span class="name">UEFI (Unified Extensible Firmware Interface)</span></a></li><li class="inactive"><a href="cha.suse.html"><span class="number">15 </span><span class="name">Special System Features</span></a></li><li class="inactive"><a href="cha.udev.html"><span class="number">16 </span><span class="name">Dynamic Kernel Device Management with <code class="systemitem">udev</code></span></a></li></ol></li><li class="inactive"><a href="part.reference.services.html"><span class="number">III </span><span class="name">Services</span></a><ol><li class="inactive"><a href="cha.slp.html"><span class="number">17 </span><span class="name">SLP</span></a></li><li class="inactive"><a href="cha.netz.xntp.html"><span class="number">18 </span><span class="name">Time Synchronization with NTP</span></a></li><li class="inactive"><a href="cha.dns.html"><span class="number">19 </span><span class="name">The Domain Name System</span></a></li><li class="inactive"><a href="cha.dhcp.html"><span class="number">20 </span><span class="name">DHCP</span></a></li><li class="inactive"><a href="cha.samba.html"><span class="number">21 </span><span class="name">Samba</span></a></li><li class="inactive"><a href="cha.nfs.html"><span class="number">22 </span><span class="name">Sharing File Systems with NFS</span></a></li><li class="inactive"><a href="cha.autofs.html"><span class="number">23 </span><span class="name">On-Demand Mounting with Autofs</span></a></li><li class="inactive"><a href="cha.apache2.html"><span class="number">24 </span><span class="name">The Apache HTTP Server</span></a></li><li class="inactive"><a href="cha.ftp.html"><span class="number">25 </span><span class="name">Setting Up an FTP Server with YaST</span></a></li><li class="inactive"><a href="cha.squid.html"><span class="number">26 </span><span class="name">The Proxy Server Squid</span></a></li></ol></li><li class="inactive"><a href="part.reference.mobility.html"><span class="number">IV </span><span class="name">Mobile Computers</span></a><ol><li class="inactive"><a href="cha.mobile.html"><span class="number">27 </span><span class="name">Mobile Computing with Linux</span></a></li><li class="inactive"><a href="cha.nm.html"><span class="number">28 </span><span class="name">Using NetworkManager</span></a></li><li class="inactive"><a href="cha.pmanage.html"><span class="number">29 </span><span class="name">Power Management</span></a></li></ol></li><li class="inactive"><a href="app.nwscheme.html"><span class="number">A </span><span class="name">An Example Network</span></a></li><li class="inactive"><a href="bk02apb.html"><span class="number">B </span><span class="name">GNU Licenses</span></a></li></ol></div><div class="clearme"></div></div></div></div><div id="_nav-area" class="inactive"><div class="tool"><span class="nav-inner"><span class="tool-label">Navigation</span><a accesskey="p" class="tool-spacer" title="Chapter 21. Samba" href="cha.samba.html"><span class="prev-icon">←</span></a><a accesskey="n" class="tool-spacer" title="Chapter 23. On-Demand Mounting with Autofs" href="cha.autofs.html"><span class="next-icon">→</span></a></span></div></div></div></div><div id="_fixed-header-wrap" class="inactive"><div id="_fixed-header"><div class="crumbs"><a class="book-link" href="index.html" title="openSUSE Leap Documentation"><span class="book-icon">openSUSE Leap Documentation</span></a><span> › </span><a class="crumb" href="book.opensuse.reference.html">Reference</a><span> › </span><a class="crumb" href="part.reference.services.html">Services</a><span> › </span><a class="crumb" href="cha.nfs.html">Sharing File Systems with NFS</a></div><div class="buttons"><a class="top-button button" href="#">Top</a><div class="button"><a accesskey="p" class="tool-spacer" title="Chapter 21. Samba" href="cha.samba.html"><span class="prev-icon">←</span></a><a accesskey="n" class="tool-spacer" title="Chapter 23. On-Demand Mounting with Autofs" href="cha.autofs.html"><span class="next-icon">→</span></a></div><div class="clearme"></div></div><div class="clearme"></div></div></div><div id="_content" class="draft "><div class="documentation"><div class="chapter " id="cha.nfs"><div class="titlepage"><div><div class="version-info">Applies to  <span class="productname"><span class="productname"><span class="phrase">openSUSE Leap</span></span></span> <span class="productnumber"><span class="productnumber"><span class="phrase">42.3</span></span></span></div><div><h2 class="title"><span class="number">22 </span><span class="name">Sharing File Systems with NFS</span> </h2><div class="doc-status"><ul><li><span class="ds-label">Filename: </span>net_nfs.xml</li><li><span class="ds-label">ID: </span>cha.nfs</li></ul></div></div><div><div class="abstract"><div class="abstract-title-wrap"><h6 class="abstract-title">Abstract<a title="Permalink" class="permalink" href="cha.nfs.html#idm139777696274624">#</a></h6></div><p>
    Distributing and sharing file systems over a network is a common task in
    corporate environments. The well-proven network file system
    (<span class="emphasis"><em>NFS</em></span>) works with <span class="emphasis"><em>NIS</em></span>, the yellow
    pages protocol. For a more secure protocol that works with
    <span class="emphasis"><em>LDAP</em></span> and Kerberos, check <span class="emphasis"><em>NFSv4</em></span>
    (default). Combined with pNFS, you can eliminate performance bottlenecks.
   </p><p>
    NFS with NIS makes a network transparent to the user. With NFS, it is
    possible to distribute arbitrary file systems over the network. With an
    appropriate setup, users always find themselves in the same environment
    regardless of the terminal they currently use.
   </p></div></div></div></div><div class="line"><div class="toc"><dl><dt><span class="sect1"><a href="cha.nfs.html#sec.nfs.term"><span class="number">22.1 </span><span class="name">Terminology</span></a></span></dt><dt><span class="sect1"><a href="cha.nfs.html#sec.nfs.installation"><span class="number">22.2 </span><span class="name">Installing NFS Server</span></a></span></dt><dt><span class="sect1"><a href="cha.nfs.html#sec.nfs.configuring-nfs-server"><span class="number">22.3 </span><span class="name">Configuring NFS Server</span></a></span></dt><dt><span class="sect1"><a href="cha.nfs.html#sec.nfs.configuring-nfs-clients"><span class="number">22.4 </span><span class="name">Configuring Clients</span></a></span></dt><dt><span class="sect1"><a href="cha.nfs.html#sec.nfs.info"><span class="number">22.5 </span><span class="name">For More Information</span></a></span></dt></dl></div></div><a id="idm139777696269472" class="indexterm"></a><a id="idm139777696268896" class="indexterm"></a><div id="idm139777696267712" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.png" /><h6>Important: Need for DNS</h6><p>
   In principle, all exports can be made using IP addresses only. To avoid
   time-outs, you need a working DNS system. DNS is necessary at least for
   logging purposes, because the mountd daemon does reverse lookups.
  </p></div><div class="sect1 " id="sec.nfs.term"><div class="titlepage"><div><div><h2 class="title" id="sec.nfs.term"><span class="number">22.1 </span><span class="name">Terminology</span> <a title="Permalink" class="permalink" href="cha.nfs.html#sec.nfs.term">#</a></h2></div></div></div><p>
   The following are terms used in the YaST module.
  </p><div class="variablelist "><dl class="variablelist"><dt id="idm139777696264016"><span class="term ">Exports</span></dt><dd><p>
      A directory <span class="emphasis"><em>exported</em></span> by an NFS server, which clients
      can integrate it into their system.
     </p></dd><dt id="idm139777696261712"><span class="term ">NFS Client</span></dt><dd><p>
      The NFS client is a system that uses NFS services from an NFS server over
      the Network File System protocol. The TCP/IP protocol is already
      integrated into the Linux kernel; there is no need to install any
      additional software.
     </p></dd><dt id="idm139777696259680"><span class="term ">NFS Server</span></dt><dd><p>
      The NFS server provides NFS services to clients. A running server depends
      on the following daemons: <code class="systemitem">nfsd</code>
      (worker), <code class="systemitem">idmapd</code> (ID-to-name
      mapping for NFSv4, needed for certain scenarios only), <code class="systemitem">statd</code> (file locking), and <code class="systemitem">mountd</code> (mount requests).
     </p></dd><dt id="idm139777696254832"><span class="term ">NFSv3</span></dt><dd><p>
      NFSv3 is the version 3 implementation, the <span class="quote">“<span class="quote">old</span>”</span> stateless
      NFS that supports client authentication.
     </p></dd><dt id="idm139777696252512"><span class="term ">NFSv4</span></dt><dd><p>
      NFSv4 is the new version 4 implementation that supports secure user
      authentication via kerberos. NFSv4 requires one single port only and thus
      is better suited for environments behind a firewall than NFSv3.
     </p><p>
      The protocol is specified as
      <a class="link" href="http://tools.ietf.org/html/rfc3530" target="_blank">http://tools.ietf.org/html/rfc3530</a>.
     </p></dd><dt id="idm139777696249456"><span class="term ">pNFS</span></dt><dd><p>
      Parallel NFS, a protocol extension of NFSv4. Any pNFS clients can
      directly access the data on an NFS server.
     </p></dd></dl></div></div><div class="sect1 " id="sec.nfs.installation"><div class="titlepage"><div><div><h2 class="title" id="sec.nfs.installation"><span class="number">22.2 </span><span class="name">Installing NFS Server</span> <a title="Permalink" class="permalink" href="cha.nfs.html#sec.nfs.installation">#</a></h2></div></div></div><p>
   The NFS server is not part of the default installation. To install the NFS
   server using YaST, choose <span class="guimenu">Software</span> › <span class="guimenu">Software Management</span>, select
   <span class="guimenu">Patterns</span>, and enable the <span class="guimenu">File Server</span>
   option in the <span class="guimenu">Server Functions</span> section. Press
   <span class="guimenu">Accept</span> to install the required packages.
  </p><p>
   Like NIS, NFS is a client/server system. However, a machine can be
   both—it can supply file systems over the network (export) and mount
   file systems from other hosts (import).
  </p><div id="idm139777696241696" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note: Mounting NFS Volumes Locally on the Exporting Server</h6><p>
    Mounting NFS volumes locally on the exporting server is not supported on
    <span class="productname"><span class="phrase">openSUSE Leap</span></span>.
   </p></div></div><div class="sect1 " id="sec.nfs.configuring-nfs-server"><div class="titlepage"><div><div><h2 class="title" id="sec.nfs.configuring-nfs-server"><span class="number">22.3 </span><span class="name">Configuring NFS Server</span> <a title="Permalink" class="permalink" href="cha.nfs.html#sec.nfs.configuring-nfs-server">#</a></h2></div></div></div><p>
   Configuring an NFS server can be done either through YaST or manually. For
   authentication, NFS can also be combined with Kerberos.
  </p><div class="sect2 " id="sec.nfs.export-yast2"><div class="titlepage"><div><div><h3 class="title" id="sec.nfs.export-yast2"><span class="number">22.3.1 </span><span class="name">Exporting File Systems with YaST</span> <a title="Permalink" class="permalink" href="cha.nfs.html#sec.nfs.export-yast2">#</a></h3></div></div></div><a id="idm139777696235968" class="indexterm"></a><p>
    With YaST, turn a host in your network into an NFS server—a server
    that exports directories and files to all hosts granted access to it or to
    all members of a group. Thus, the server can also provide applications
    without installing the applications locally on every host.
   </p><p>
    To set up such a server, proceed as follows:
   </p><div class="procedure " id="pro.nfs.export-yast2.nfs"><div class="procedure-title-wrap"><h6 class="procedure-title"><span class="number">Procedure 22.1: </span><span class="name">Setting Up an NFS Server </span><a title="Permalink" class="permalink" href="cha.nfs.html#pro.nfs.export-yast2.nfs">#</a></h6></div><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
      Start YaST and select <span class="guimenu">Network Services</span> › <span class="guimenu">NFS Server</span>; see
      <a class="xref" href="cha.nfs.html#fig.inst.nfsserver1" title="NFS Server Configuration Tool">Figure 22.1, “NFS Server Configuration Tool”</a>. You may be prompted to install
      additional software.
     </p><div class="figure" id="fig.inst.nfsserver1"><div class="figure-contents"><div class="mediaobject"><a xmlns="" href="images/yast2_inst_nfsserver1_kde.png"><img src="images/yast2_inst_nfsserver1_kde.png" width="" alt="NFS Server Configuration Tool" /></a></div></div><div class="figure-title-wrap"><h6 class="figure-title"><span class="number">Figure 22.1: </span><span class="name">NFS Server Configuration Tool </span><a title="Permalink" class="permalink" href="cha.nfs.html#fig.inst.nfsserver1">#</a></h6></div></div></li><li class="step "><p>
      Activate the <span class="guimenu">Start</span> radio button.
     </p></li><li class="step "><p>
      If a firewall is active on your system (SuSEFirewall2), check
      <span class="guimenu">Open Ports in Firewall</span>. YaST adapts its
      configuration for the NFS server by enabling the
      <code class="systemitem">nfs</code> service.
     </p></li><li class="step "><p>
      Check whether you want to <span class="guimenu">Enable NFSv4</span>. If you
      deactivate NFSv4, YaST will only support NFSv3. For information about
      enabling NFSv2, see <a class="xref" href="cha.nfs.html#sec.nfs.export.manual.nsfv2" title="Note: NFSv2">Note: NFSv2</a>.
     </p><ol type="a" class="substeps "><li class="step "><p>
        If NFSv4 is selected, additionally enter the appropriate NFSv4 domain
        name. This parameter is used by the <code class="systemitem">idmapd</code> daemon that is required for Kerberos
        setups or if clients cannot work with numeric user names. Leave it as
        <code class="literal">localdomain</code> (the default) if you do not run
        <code class="systemitem">idmapd</code> or do not have any
        special requirements. For more information on the <code class="systemitem">idmapd</code> daemon see <a class="xref" href="cha.nfs.html#var.nfs.export.manual.idmapd"><code class="filename">/etc/idmapd.conf</code></a>.
       </p></li></ol></li><li class="step "><p>
      Click <span class="guimenu">Enable GSS Security</span> if you need secure access to
      the server. A prerequisite for this is to have Kerberos installed on your
      domain and to have both the server and the clients kerberized.
      
      Click <span class="guimenu">Next</span> to proceed with the next configuration
      dialog.
     </p></li><li class="step "><p>
      Click <span class="guimenu">Add Directory</span> in the upper half of the dialog to
      export your directory.
     </p></li><li class="step "><p>
      If you have not configured the allowed hosts already, another dialog for
      entering the client information and options pops up automatically. Enter
      the host wild card (usually you can leave the default settings as they
      are).
     </p><p>
      There are four possible types of host wild cards that can be set for each
      host: a single host (name or IP address), netgroups, wild cards (such as
      <code class="literal">*</code> indicating all machines can access the server), and
      IP networks.
     </p><p>
      For more information about these options, see the
      <code class="literal">exports</code> man page.
     </p></li><li class="step "><p>
      Click <span class="guimenu">Finish</span> to complete the configuration.
     </p></li></ol></div></div></div><div class="sect2 " id="sec.nfs.export.manual"><div class="titlepage"><div><div><h3 class="title" id="sec.nfs.export.manual"><span class="number">22.3.2 </span><span class="name">Exporting File Systems Manually</span> <a title="Permalink" class="permalink" href="cha.nfs.html#sec.nfs.export.manual">#</a></h3></div></div></div><a id="idm139777696202800" class="indexterm"></a><p>
    The configuration files for the NFS export service are
    <code class="filename">/etc/exports</code> and
    <code class="filename">/etc/sysconfig/nfs</code>. In addition to these files,
    <code class="filename">/etc/idmapd.conf</code> is needed for the NFSv4 server
    configuration with kerberized NFS or if the clients cannot work with
    numeric user names.
   </p><p>
    To start or restart the services, run the command
    <code class="command">systemctl restart nfsserver</code>. This also restarts the
    RPC portmapper that is required by the NFS server.
   </p><p>
    To make sure the NFS server always starts at boot time, run <code class="command">sudo
    systemctl enable nfsserver</code>.
   </p><div id="idm139777696197664" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note: NFSv4</h6><p>
     NFSv4 is the latest version of NFS protocol available on <span class="productname"><span class="phrase">openSUSE Leap</span></span>.
     Configuring directories for export with NFSv4 is now the same as with
     NFSv3.
    </p><p>
     On <span class="phrase">openSUSE
     prior to Leap</span>, the bind mount in
     <code class="filename">/etc/exports</code> was mandatory. It is still supported,
     but now deprecated.
    </p></div><div class="variablelist "><dl class="variablelist"><dt id="idm139777696193088"><span class="term "><code class="filename">/etc/exports</code></span></dt><dd><p>
       The <code class="filename">/etc/exports</code> file contains a list of entries.
       Each entry indicates a directory that is shared and how it is shared. A
       typical entry in <code class="filename">/etc/exports</code> consists of:
      </p><div class="verbatim-wrap"><pre class="screen">/<em class="replaceable ">SHARED</em>/<em class="replaceable ">DIRECTORY</em>   <em class="replaceable ">HOST</em>(<em class="replaceable ">OPTION_LIST</em>)</pre></div><p>
       For example:
      </p><div class="verbatim-wrap"><pre class="screen">/export/data   192.168.1.2(rw,sync)</pre></div><p>
       Here the IP address <code class="literal">192.168.1.2</code> is used to identify
       the allowed client. You can also use the name of the host, a wild card
       indicating a set of hosts (<code class="literal">*.abc.com</code>,
       <code class="literal">*</code>, etc.), or netgroups
       (<code class="literal">@my-hosts</code>).
      </p><p>
       For a detailed explanation of all options and their meaning, refer to
       the man page of <code class="command">exports</code> (<code class="command">man
       exports</code>).
      </p><p>
       In case you have modified <code class="filename">/etc/exports</code> while the
       NFS server was running, you need to restart it for the changes to become
       active: <code class="command">sudo systemctl restart nfsserver</code>.
      </p></dd><dt id="idm139777696181696"><span class="term "><code class="filename">/etc/sysconfig/nfs</code></span></dt><dd><p>
       The <code class="filename">/etc/sysconfig/nfs</code> file contains a few
       parameters that determine NFSv4 server daemon behavior. It is important
       to set the parameter <code class="systemitem">NFS4_SUPPORT</code> to
       <code class="literal">yes</code> (default). <code class="systemitem">NFS4_SUPPORT</code>
       determines whether the NFS server supports NFSv4 exports and clients.
      </p><p>
       In case you have modified <code class="filename">/etc/sysconfig/nfs</code> while
       the NFS server was running, you need to restart it for the changes to
       become active: <code class="command">sudo systemctl restart nfsserver</code>.
      </p><div id="idm139777696176656" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.png" /><h6>Tip: Mount Options</h6><p>
        On <span class="phrase">openSUSE prior to Leap</span>, the
        <code class="option">--bind</code> mount in <code class="filename">/etc/exports</code> was
        mandatory. It is still supported, but now deprecated. Configuring
        directories for export with NFSv4 is now the same as with NFSv3.
       </p></div><div id="sec.nfs.export.manual.nsfv2" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note: NFSv2</h6><p>
        If NFS clients still depend on NFSv2, enable it on the server in
        <code class="filename">/etc/sysconfig/nfs</code> by setting:
       </p><div class="verbatim-wrap"><pre class="screen">NFSD_OPTIONS="-V2"
MOUNTD_OPTIONS="-V2"</pre></div><p>
        After restarting the service, check whether version 2 is available
        with the command:
       </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>cat /proc/fs/nfsd/versions
+2 +3 +4 +4.1 -4.2</pre></div></div></dd><dt id="var.nfs.export.manual.idmapd"><span class="term "><code class="filename">/etc/idmapd.conf</code></span></dt><dd><p>
       Starting with SLE 12 SP1, the <code class="systemitem">idmapd</code> daemon is only required if Kerberos
       authentication is used, or if clients cannot work with numeric user
       names. Linux clients can work with numeric user names since Linux kernel
       2.6.39. The <code class="systemitem">idmapd</code> daemon does
       the name-to-ID mapping for NFSv4 requests to the server and replies to
       the client.
      </p><p>
       If required, <code class="systemitem">idmapd</code>
       needs to run on the NFSv4 server. Name-to-ID mapping on the client will
       be done by <code class="command">nfsidmap</code> provided by the package
       <span class="package">nfs-client</span>.
      </p><p>
       Make sure that there is a uniform way in which user names and IDs (uid)
       are assigned to users across machines that might probably be sharing
       file systems using NFS. This can be achieved by using NIS, LDAP, or any
       uniform domain authentication mechanism in your domain.
      </p><p>
       The parameter <code class="literal">Domain</code> must be set the same for both,
       client and server in the <code class="filename">/etc/idmapd.conf</code> file. If
       you are not sure, leave the domain as <code class="literal">localdomain</code> in
       the server and client files. A sample configuration file looks like the
       following:
      </p><div class="verbatim-wrap"><pre class="screen">[General]
Verbosity = 0
Pipefs-Directory = /var/lib/nfs/rpc_pipefs
Domain = localdomain

[Mapping]
Nobody-User = nobody
Nobody-Group = nobody</pre></div><p>
       To start the <code class="systemitem">idmapd</code> daemon, run
       <code class="command">systemctl start nfs-idmapd</code>. In case you have modified
       <code class="filename">/etc/idmapd.conf</code> while the daemon was running, you
       need to restart it for the changes to become active: <code class="command">systemctl
       start nfs-idmapd</code>.
      </p><p>
       For more information, see the man pages of <code class="literal">idmapd</code> and
       <code class="literal">idmapd.conf</code> (<code class="literal">man idmapd</code> and
       <code class="literal">man idmapd.conf</code>).
      </p></dd></dl></div></div><div class="sect2 " id="sec.nfs.kerberos"><div class="titlepage"><div><div><h3 class="title" id="sec.nfs.kerberos"><span class="number">22.3.3 </span><span class="name">NFS with Kerberos</span> <a title="Permalink" class="permalink" href="cha.nfs.html#sec.nfs.kerberos">#</a></h3></div></div></div><p>
    To use Kerberos authentication for NFS, GSS security must be enabled.
    Select <span class="guimenu">Enable GSS Security</span> in the initial YaST NFS
    Server dialog. You must have a working Kerberos server to use this feature.
    YaST does not set up the server but only uses the provided functionality.
    If you want to use Kerberos authentication in addition to the YaST
    configuration, complete at least the following steps before running the NFS
    configuration:
   </p><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
      Make sure that both the server and the client are in the same Kerberos
      domain. They must access the same KDC (Key Distribution Center) server
      and share their <code class="filename">krb5.keytab</code> file (the default
      location on any machine is <code class="filename">/etc/krb5.keytab</code>). For
      more information about Kerberos, see
      <span class="intraxref">Book “<em class="citetitle ">Security Guide</em>”, Chapter 6 “Network Authentication with Kerberos”</span>.
     </p></li><li class="step "><p>
      Start the gssd service on the client with <code class="command">systemctl start
      rpc-gssd.service</code>.
     </p></li><li class="step "><p>
      Start the svcgssd service on the server with <code class="command">systemctl start
      rpc-svcgssd.service</code>.
     </p></li></ol></div></div><p>
    Kerberos authentication also requires the <code class="systemitem">idmapd</code> daemon to run on the server. For more
    information refer to <a class="xref" href="cha.nfs.html#var.nfs.export.manual.idmapd"><code class="filename">/etc/idmapd.conf</code></a>.
   </p><p>
    For more information about configuring kerberized NFS, refer to the links
    in <a class="xref" href="cha.nfs.html#sec.nfs.info" title="22.5. For More Information">Section 22.5, “For More Information”</a>.
   </p></div></div><div class="sect1 " id="sec.nfs.configuring-nfs-clients"><div class="titlepage"><div><div><h2 class="title" id="sec.nfs.configuring-nfs-clients"><span class="number">22.4 </span><span class="name">Configuring Clients</span> <a title="Permalink" class="permalink" href="cha.nfs.html#sec.nfs.configuring-nfs-clients">#</a></h2></div></div></div><p>
   To configure your host as an NFS client, you do not need to install
   additional software. All needed packages are installed by default.
  </p><div class="sect2 " id="sec.nfs.import-yast2"><div class="titlepage"><div><div><h3 class="title" id="sec.nfs.import-yast2"><span class="number">22.4.1 </span><span class="name">Importing File Systems with YaST</span> <a title="Permalink" class="permalink" href="cha.nfs.html#sec.nfs.import-yast2">#</a></h3></div></div></div><a id="idm139777696139536" class="indexterm"></a><p>
    Authorized users can mount NFS directories from an NFS server into the
    local file tree using the YaST NFS client module. Proceed as follows:
   </p><div class="procedure " id="pro.nfs.import-yast2"><div class="procedure-title-wrap"><h6 class="procedure-title"><span class="number">Procedure 22.2: </span><span class="name">Importing NFS Directories </span><a title="Permalink" class="permalink" href="cha.nfs.html#pro.nfs.import-yast2">#</a></h6></div><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
      Start the YaST NFS client module.
     </p></li><li class="step "><p>
      Click <span class="guimenu">Add</span> in the <span class="guimenu">NFS Shares</span> tab.
      Enter the host name of the NFS server, the directory to import, and the
      mount point at which to mount this directory locally.
     </p></li><li class="step "><p>
      When using NFSv4, select <span class="guimenu">Enable NFSv4</span> in the
      <span class="guimenu">NFS Settings</span> tab. Additionally, the <span class="guimenu">NFSv4
      Domain Name</span> must contain the same value as used by the NFSv4
      server. The default domain is <code class="literal">localdomain</code>.
     </p></li><li class="step "><p>
      To use Kerberos authentication for NFS, GSS security must be enabled.
      Select <span class="guimenu">Enable GSS Security</span>.
     </p></li><li class="step "><p>
      Enable <span class="guimenu">Open Port in Firewall</span> in the <span class="guimenu">NFS
      Settings</span> tab if you use a Firewall and want to allow access to
      the service from remote computers. The firewall status is displayed next
      to the check box.
     </p></li><li class="step "><p>
      Click <span class="guimenu">OK</span> to save your changes.
     </p></li></ol></div></div><p>
    The configuration is written to <code class="filename">/etc/fstab</code> and the
    specified file systems are mounted. When you start the YaST configuration
    client at a later time, it also reads the existing configuration from this
    file.
   </p><div id="idm139777696125056" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.png" /><h6>Tip: NFS as a Root File System</h6><p>
     On (diskless) systems, where the root partition is mounted via network as
     an NFS share, you need to be careful when configuring the network device
     with which the NFS share is accessible.
    </p><p>
     When shutting down or rebooting the system, the default processing order
     is to turn off network connections, then unmount the root partition. With
     NFS root, this order causes problems as the root partition cannot be
     cleanly unmounted as the network connection to the NFS share is already
     not activated. To prevent the system from deactivating the relevant
     network device, open the network device configuration tab as described in
     <a class="xref" href="cha.basicnet.html#sec.basicnet.yast.change.start" title="13.4.1.2.5. Activating the Network Device">Section 13.4.1.2.5, “Activating the Network Device”</a> and choose <span class="guimenu">On
     NFSroot</span> in the <span class="guimenu">Device Activation</span> pane.
    </p></div></div><div class="sect2 " id="sec.nfs.import"><div class="titlepage"><div><div><h3 class="title" id="sec.nfs.import"><span class="number">22.4.2 </span><span class="name">Importing File Systems Manually</span> <a title="Permalink" class="permalink" href="cha.nfs.html#sec.nfs.import">#</a></h3></div></div></div><a id="idm139777696119856" class="indexterm"></a><a id="idm139777696118832" class="indexterm"></a><p>
    The prerequisite for importing file systems manually from an NFS server is
    a running RPC port mapper. The <code class="option">nfs</code> service takes care to
    start it properly; thus, start it by entering <code class="command">systemctl start
    nfs</code> as <code class="systemitem">root</code>. Then
    remote file systems can be mounted in the file system like local partitions
    using <code class="command">mount</code>:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>sudo mount <em class="replaceable ">HOST</em>:<em class="replaceable ">REMOTE-PATH</em><em class="replaceable ">LOCAL-PATH</em></pre></div><p>
    To import user directories from the <code class="systemitem">nfs.example.com</code>
    machine, for example, use:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>sudo mount nfs.example.com:/home /home</pre></div><div class="sect3 " id="sec.nfs.automount"><div class="titlepage"><div><div><h4 class="title" id="sec.nfs.automount"><span class="number">22.4.2.1 </span><span class="name">Using the Automount Service</span> <a title="Permalink" class="permalink" href="cha.nfs.html#sec.nfs.automount">#</a></h4></div></div></div><p>
     The autofs daemon can be used to mount remote file systems automatically.
     Add the following entry to the <code class="filename">/etc/auto.master</code> file:
    </p><div class="verbatim-wrap"><pre class="screen">/nfsmounts /etc/auto.nfs</pre></div><p>
     Now the <code class="filename">/nfsmounts</code> directory acts as the root for all
     the NFS mounts on the client if the <code class="filename">auto.nfs</code> file is
     filled appropriately. The name <code class="filename">auto.nfs</code> is chosen for
     the sake of convenience—you can choose any name. In
     <code class="filename">auto.nfs</code> add entries for all the NFS mounts as
     follows:
    </p><div class="verbatim-wrap"><pre class="screen">localdata -fstype=nfs server1:/data
nfs4mount -fstype=nfs4 server2:/</pre></div><p>
     Activate the settings with <code class="command">systemctl start autofs</code> as
     <code class="systemitem">root</code>. In this example, <code class="filename">/nfsmounts/localdata</code>,
     the <code class="filename">/data</code> directory of
     <code class="systemitem">server1</code>, is mounted with NFS and
     <code class="filename">/nfsmounts/nfs4mount</code> from
     <code class="systemitem">server2</code> is mounted with NFSv4.
    </p><p>
     If the <code class="filename">/etc/auto.master</code> file is edited while the
     service autofs is running, the automounter must be restarted for the
     changes to take effect with <code class="command">systemctl restart autofs</code>.
    </p></div><div class="sect3 " id="sec.nfs.fstab"><div class="titlepage"><div><div><h4 class="title" id="sec.nfs.fstab"><span class="number">22.4.2.2 </span><span class="name">Manually Editing <code class="filename">/etc/fstab</code></span> <a title="Permalink" class="permalink" href="cha.nfs.html#sec.nfs.fstab">#</a></h4></div></div></div><p>
     A typical NFSv3 mount entry in <code class="filename">/etc/fstab</code> looks like
     this:
    </p><div class="verbatim-wrap"><pre class="screen">nfs.example.com:/data /local/path nfs rw,noauto 0 0</pre></div><p>
     For NFSv4 mounts, use <code class="literal">nfs4</code> instead of
     <code class="literal">nfs</code> in the third column:
    </p><div class="verbatim-wrap"><pre class="screen">nfs.example.com:/data /local/pathv4 nfs4 rw,noauto 0 0</pre></div><p>
     The <code class="literal">noauto</code> option prevents the file system from being
     mounted automatically at start-up. If you want to mount the respective
     file system manually, it is possible to shorten the mount command
     specifying the mount point only:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>sudo mount /local/path</pre></div><div id="idm139777696093872" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note: Mounting at Start-Up</h6><p>
      If you do not enter the <code class="literal">noauto</code> option, the init
      scripts of the system will handle the mount of those file systems at
      start-up.
     </p></div></div></div><div class="sect2 " id="sec.nfs.pnfs"><div class="titlepage"><div><div><h3 class="title" id="sec.nfs.pnfs"><span class="number">22.4.3 </span><span class="name">Parallel NFS (pNFS)</span> <a title="Permalink" class="permalink" href="cha.nfs.html#sec.nfs.pnfs">#</a></h3></div></div></div><p>
    NFS is one of the oldest protocols, developed in the '80s. As such, NFS is
    usually sufficient if you want to share small files. However, when you want
    to transfer big files or large numbers of clients want to access data, an
    NFS server becomes a bottleneck and has a significant impact on the system
    performance. This is because of files quickly getting bigger, whereas the
    relative speed of your Ethernet has not fully kept up.
   </p><p>
    When you request a file from a regular NFS server, the server
    looks up the file metadata, collects all the data and transfers it over the
    network to your client. However, the performance bottleneck becomes
    apparent no matter how small or big the files are:
   </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
      With small files most of the time is spent collecting the metadata.
     </p></li><li class="listitem "><p>
      With big files most of the time is spent on transferring the data from
      server to client.
     </p></li></ul></div><p>
    pNFS, or parallel NFS, overcomes this limitation as it separates the file
    system metadata from the location of the data. As such, pNFS requires two
    types of servers:
   </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
      A <span class="emphasis"><em>metadata</em></span> or <span class="emphasis"><em>control server</em></span>
      that handles all the non-data traffic
     </p></li><li class="listitem "><p>
      One or more <span class="emphasis"><em>storage server(s)</em></span> that hold(s) the data
     </p></li></ul></div><p>
    The metadata and the storage servers form a single, logical NFS server.
    When a client wants to read or write, the metadata server tells the NFSv4
    client which storage server to use to access the file chunks. The client
    can access the data directly on the server.
   </p><p>
    <span class="productname"><span class="phrase">openSUSE Leap</span></span> supports pNFS on the client side only.
   </p><div class="sect3 " id="sec.nfs.pnfs.yast"><div class="titlepage"><div><div><h4 class="title" id="sec.nfs.pnfs.yast"><span class="number">22.4.3.1 </span><span class="name">Configuring pNFS Client With YaST</span> <a title="Permalink" class="permalink" href="cha.nfs.html#sec.nfs.pnfs.yast">#</a></h4></div></div></div><p>
     Proceed as described in <a class="xref" href="cha.nfs.html#pro.nfs.import-yast2" title="Importing NFS Directories">Procedure 22.2, “Importing NFS Directories”</a>, but click
     the <span class="guimenu">pNFS (v4.1)</span> check box and optionally <span class="guimenu">NFSv4
     share</span>. YaST will do all the necessary steps and will write all
     the required options in the file <code class="filename">/etc/exports</code>.
     
    </p></div><div class="sect3 " id="sec.nfs.pnfs.manual"><div class="titlepage"><div><div><h4 class="title" id="sec.nfs.pnfs.manual"><span class="number">22.4.3.2 </span><span class="name">Configuring pNFS Client Manually</span> <a title="Permalink" class="permalink" href="cha.nfs.html#sec.nfs.pnfs.manual">#</a></h4></div></div></div><p>
     Refer to <a class="xref" href="cha.nfs.html#sec.nfs.import" title="22.4.2. Importing File Systems Manually">Section 22.4.2, “Importing File Systems Manually”</a> to start. Most of the
     configuration is done by the NFSv4 server. For pNFS, the only difference
     is to add the <code class="option">minorversion</code> option and the metadata server
     <em class="replaceable ">MDS_SERVER</em> to your <code class="command">mount</code>
     command:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>sudo mount -t nfs4 -o minorversion=1 <em class="replaceable ">MDS_SERVER</em> <em class="replaceable ">MOUNTPOINT</em></pre></div><p>
     To help with debugging, change the value in the <code class="filename">/proc</code>
     file system:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>sudo echo 32767 &gt; /proc/sys/sunrpc/nfsd_debug
<code class="prompt user">tux &gt; </code>sudo echo 32767 &gt; /proc/sys/sunrpc/nfs_debug</pre></div></div></div></div><div class="sect1 " id="sec.nfs.info"><div class="titlepage"><div><div><h2 class="title" id="sec.nfs.info"><span class="number">22.5 </span><span class="name">For More Information</span> <a title="Permalink" class="permalink" href="cha.nfs.html#sec.nfs.info">#</a></h2></div></div></div><p>
   In addition to the man pages of <code class="command">exports</code>,
   <code class="command">nfs</code>, and <code class="command">mount</code>, information about
   configuring an NFS server and client is available in
   <code class="filename">/usr/share/doc/packages/nfsidmap/README</code>. For further
   documentation online refer to the following Web sites:
  </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
     Find the detailed technical documentation online at
     <a class="link" href="http://nfs.sourceforge.net/" target="_blank">SourceForge</a>.
    </p></li><li class="listitem "><p>
     For instructions for setting up kerberized NFS, refer to
     <a class="link" href="http://www.citi.umich.edu/projects/nfsv4/linux/krb5-setup.html" target="_blank">NFS
     Version 4 Open Source Reference Implementation</a>.
    </p></li><li class="listitem "><p>
     If you have questions on NFSv4, refer to the
     <a class="link" href="http://www.citi.umich.edu/projects/nfsv4/linux/faq/" target="_blank">Linux
     NFSv4 FAQ</a>.
    </p></li></ul></div></div></div></div><div class="page-bottom"><div id="_bottom-navigation"><a class="nav-link" href="cha.autofs.html"><span class="next-icon">→</span><span class="nav-label"><span class="number">Chapter 23 </span>On-Demand Mounting with Autofs</span></a><a class="nav-link" href="cha.samba.html"><span class="prev-icon">←</span><span class="nav-label"><span class="number">Chapter 21 </span>Samba</span></a></div><div id="_share-print"><div class="online-contents share"><strong>Share this page: </strong><span class="share-buttons"><span id="_share-fb" class="bottom-button">Facebook</span><span class="spacer"> • </span><span id="_share-gp" class="bottom-button">Google+</span><span class="spacer"> • </span><span id="_share-tw" class="bottom-button">Twitter</span><span class="spacer"> • </span><span id="_share-mail" class="bottom-button">E-Mail</span></span></div><div class="print"><span id="_print-button" class="bottom-button">Print this page</span></div><div class="clearme"></div></div></div></div><div id="_inward"></div></div><div id="_footer-wrap"><div id="_footer"><p>©
        2018 
        SUSE</p><ul><li><a href="http://www.suse.com/company/careers/" target="_top">Careers</a></li><li><a href="http://www.suse.com/company/legal/" target="_top">Legal</a></li><li><a href="http://www.suse.com/company/" target="_top">About</a></li><li><a href="http://www.suse.com/ContactsOffices/contacts_offices.jsp" target="_top">Contact Us</a></li></ul></div></div></body></html>